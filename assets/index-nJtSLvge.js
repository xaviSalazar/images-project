var zw=(d,g,b)=>{if(!g.has(d))throw TypeError("Cannot "+b)};var X0=(d,g,b)=>(zw(d,g,"read from private field"),b?b.call(d):g.get(d)),rv=(d,g,b)=>{if(g.has(d))throw TypeError("Cannot add the same private member more than once");g instanceof WeakSet?g.add(d):g.set(d,b)},F1=(d,g,b,et)=>(zw(d,g,"write to private field"),et?et.call(d,b):g.set(d,b),b);var V2=(d,g,b,et)=>({set _(st){F1(d,g,st,b)},get _(){return X0(d,g,et)}}),zv=(d,g,b)=>(zw(d,g,"access private method"),b);function _mergeNamespaces(d,g){for(var b=0;b<g.length;b++){const et=g[b];if(typeof et!="string"&&!Array.isArray(et)){for(const st in et)if(st!=="default"&&!(st in d)){const at=Object.getOwnPropertyDescriptor(et,st);at&&Object.defineProperty(d,st,at.get?at:{enumerable:!0,get:()=>et[st]})}}}return Object.freeze(Object.defineProperty(d,Symbol.toStringTag,{value:"Module"}))}(function(){const g=document.createElement("link").relList;if(g&&g.supports&&g.supports("modulepreload"))return;for(const st of document.querySelectorAll('link[rel="modulepreload"]'))et(st);new MutationObserver(st=>{for(const at of st)if(at.type==="childList")for(const vt of at.addedNodes)vt.tagName==="LINK"&&vt.rel==="modulepreload"&&et(vt)}).observe(document,{childList:!0,subtree:!0});function b(st){const at={};return st.integrity&&(at.integrity=st.integrity),st.referrerPolicy&&(at.referrerPolicy=st.referrerPolicy),st.crossOrigin==="use-credentials"?at.credentials="include":st.crossOrigin==="anonymous"?at.credentials="omit":at.credentials="same-origin",at}function et(st){if(st.ep)return;st.ep=!0;const at=b(st);fetch(st.href,at)}})();function getDefaultExportFromCjs(d){return d&&d.__esModule&&Object.prototype.hasOwnProperty.call(d,"default")?d.default:d}function getAugmentedNamespace(d){if(d.__esModule)return d;var g=d.default;if(typeof g=="function"){var b=function et(){return this instanceof et?Reflect.construct(g,arguments,this.constructor):g.apply(this,arguments)};b.prototype=g.prototype}else b={};return Object.defineProperty(b,"__esModule",{value:!0}),Object.keys(d).forEach(function(et){var st=Object.getOwnPropertyDescriptor(d,et);Object.defineProperty(b,et,st.get?st:{enumerable:!0,get:function(){return d[et]}})}),b}var jsxRuntime={exports:{}},reactJsxRuntime_production_min={},react={exports:{}},react_production_min={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var l$3=Symbol.for("react.element"),n$5=Symbol.for("react.portal"),p$5=Symbol.for("react.fragment"),q$3=Symbol.for("react.strict_mode"),r$5=Symbol.for("react.profiler"),t$5=Symbol.for("react.provider"),u$3=Symbol.for("react.context"),v$2=Symbol.for("react.forward_ref"),w$1=Symbol.for("react.suspense"),x=Symbol.for("react.memo"),y=Symbol.for("react.lazy"),z$3=Symbol.iterator;function A$1(d){return d===null||typeof d!="object"?null:(d=z$3&&d[z$3]||d["@@iterator"],typeof d=="function"?d:null)}var B$3={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},C$1=Object.assign,D$3={};function E$2(d,g,b){this.props=d,this.context=g,this.refs=D$3,this.updater=b||B$3}E$2.prototype.isReactComponent={};E$2.prototype.setState=function(d,g){if(typeof d!="object"&&typeof d!="function"&&d!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,d,g,"setState")};E$2.prototype.forceUpdate=function(d){this.updater.enqueueForceUpdate(this,d,"forceUpdate")};function F$1(){}F$1.prototype=E$2.prototype;function G$3(d,g,b){this.props=d,this.context=g,this.refs=D$3,this.updater=b||B$3}var H$3=G$3.prototype=new F$1;H$3.constructor=G$3;C$1(H$3,E$2.prototype);H$3.isPureReactComponent=!0;var I$1=Array.isArray,J$1=Object.prototype.hasOwnProperty,K$3={current:null},L$3={key:!0,ref:!0,__self:!0,__source:!0};function M$4(d,g,b){var et,st={},at=null,vt=null;if(g!=null)for(et in g.ref!==void 0&&(vt=g.ref),g.key!==void 0&&(at=""+g.key),g)J$1.call(g,et)&&!L$3.hasOwnProperty(et)&&(st[et]=g[et]);var Tt=arguments.length-2;if(Tt===1)st.children=b;else if(1<Tt){for(var Ct=Array(Tt),pt=0;pt<Tt;pt++)Ct[pt]=arguments[pt+2];st.children=Ct}if(d&&d.defaultProps)for(et in Tt=d.defaultProps,Tt)st[et]===void 0&&(st[et]=Tt[et]);return{$$typeof:l$3,type:d,key:at,ref:vt,props:st,_owner:K$3.current}}function N$3(d,g){return{$$typeof:l$3,type:d.type,key:g,ref:d.ref,props:d.props,_owner:d._owner}}function O$2(d){return typeof d=="object"&&d!==null&&d.$$typeof===l$3}function escape$1(d){var g={"=":"=0",":":"=2"};return"$"+d.replace(/[=:]/g,function(b){return g[b]})}var P$2=/\/+/g;function Q$4(d,g){return typeof d=="object"&&d!==null&&d.key!=null?escape$1(""+d.key):g.toString(36)}function R$2(d,g,b,et,st){var at=typeof d;(at==="undefined"||at==="boolean")&&(d=null);var vt=!1;if(d===null)vt=!0;else switch(at){case"string":case"number":vt=!0;break;case"object":switch(d.$$typeof){case l$3:case n$5:vt=!0}}if(vt)return vt=d,st=st(vt),d=et===""?"."+Q$4(vt,0):et,I$1(st)?(b="",d!=null&&(b=d.replace(P$2,"$&/")+"/"),R$2(st,g,b,"",function(pt){return pt})):st!=null&&(O$2(st)&&(st=N$3(st,b+(!st.key||vt&&vt.key===st.key?"":(""+st.key).replace(P$2,"$&/")+"/")+d)),g.push(st)),1;if(vt=0,et=et===""?".":et+":",I$1(d))for(var Tt=0;Tt<d.length;Tt++){at=d[Tt];var Ct=et+Q$4(at,Tt);vt+=R$2(at,g,b,Ct,st)}else if(Ct=A$1(d),typeof Ct=="function")for(d=Ct.call(d),Tt=0;!(at=d.next()).done;)at=at.value,Ct=et+Q$4(at,Tt++),vt+=R$2(at,g,b,Ct,st);else if(at==="object")throw g=String(d),Error("Objects are not valid as a React child (found: "+(g==="[object Object]"?"object with keys {"+Object.keys(d).join(", ")+"}":g)+"). If you meant to render a collection of children, use an array instead.");return vt}function S$1(d,g,b){if(d==null)return d;var et=[],st=0;return R$2(d,et,"","",function(at){return g.call(b,at,st++)}),et}function T$3(d){if(d._status===-1){var g=d._result;g=g(),g.then(function(b){(d._status===0||d._status===-1)&&(d._status=1,d._result=b)},function(b){(d._status===0||d._status===-1)&&(d._status=2,d._result=b)}),d._status===-1&&(d._status=0,d._result=g)}if(d._status===1)return d._result.default;throw d._result}var U$5={current:null},V$3={transition:null},W$2={ReactCurrentDispatcher:U$5,ReactCurrentBatchConfig:V$3,ReactCurrentOwner:K$3};function X$4(){throw Error("act(...) is not supported in production builds of React.")}react_production_min.Children={map:S$1,forEach:function(d,g,b){S$1(d,function(){g.apply(this,arguments)},b)},count:function(d){var g=0;return S$1(d,function(){g++}),g},toArray:function(d){return S$1(d,function(g){return g})||[]},only:function(d){if(!O$2(d))throw Error("React.Children.only expected to receive a single React element child.");return d}};react_production_min.Component=E$2;react_production_min.Fragment=p$5;react_production_min.Profiler=r$5;react_production_min.PureComponent=G$3;react_production_min.StrictMode=q$3;react_production_min.Suspense=w$1;react_production_min.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=W$2;react_production_min.act=X$4;react_production_min.cloneElement=function(d,g,b){if(d==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+d+".");var et=C$1({},d.props),st=d.key,at=d.ref,vt=d._owner;if(g!=null){if(g.ref!==void 0&&(at=g.ref,vt=K$3.current),g.key!==void 0&&(st=""+g.key),d.type&&d.type.defaultProps)var Tt=d.type.defaultProps;for(Ct in g)J$1.call(g,Ct)&&!L$3.hasOwnProperty(Ct)&&(et[Ct]=g[Ct]===void 0&&Tt!==void 0?Tt[Ct]:g[Ct])}var Ct=arguments.length-2;if(Ct===1)et.children=b;else if(1<Ct){Tt=Array(Ct);for(var pt=0;pt<Ct;pt++)Tt[pt]=arguments[pt+2];et.children=Tt}return{$$typeof:l$3,type:d.type,key:st,ref:at,props:et,_owner:vt}};react_production_min.createContext=function(d){return d={$$typeof:u$3,_currentValue:d,_currentValue2:d,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},d.Provider={$$typeof:t$5,_context:d},d.Consumer=d};react_production_min.createElement=M$4;react_production_min.createFactory=function(d){var g=M$4.bind(null,d);return g.type=d,g};react_production_min.createRef=function(){return{current:null}};react_production_min.forwardRef=function(d){return{$$typeof:v$2,render:d}};react_production_min.isValidElement=O$2;react_production_min.lazy=function(d){return{$$typeof:y,_payload:{_status:-1,_result:d},_init:T$3}};react_production_min.memo=function(d,g){return{$$typeof:x,type:d,compare:g===void 0?null:g}};react_production_min.startTransition=function(d){var g=V$3.transition;V$3.transition={};try{d()}finally{V$3.transition=g}};react_production_min.unstable_act=X$4;react_production_min.useCallback=function(d,g){return U$5.current.useCallback(d,g)};react_production_min.useContext=function(d){return U$5.current.useContext(d)};react_production_min.useDebugValue=function(){};react_production_min.useDeferredValue=function(d){return U$5.current.useDeferredValue(d)};react_production_min.useEffect=function(d,g){return U$5.current.useEffect(d,g)};react_production_min.useId=function(){return U$5.current.useId()};react_production_min.useImperativeHandle=function(d,g,b){return U$5.current.useImperativeHandle(d,g,b)};react_production_min.useInsertionEffect=function(d,g){return U$5.current.useInsertionEffect(d,g)};react_production_min.useLayoutEffect=function(d,g){return U$5.current.useLayoutEffect(d,g)};react_production_min.useMemo=function(d,g){return U$5.current.useMemo(d,g)};react_production_min.useReducer=function(d,g,b){return U$5.current.useReducer(d,g,b)};react_production_min.useRef=function(d){return U$5.current.useRef(d)};react_production_min.useState=function(d){return U$5.current.useState(d)};react_production_min.useSyncExternalStore=function(d,g,b){return U$5.current.useSyncExternalStore(d,g,b)};react_production_min.useTransition=function(){return U$5.current.useTransition()};react_production_min.version="18.3.1";react.exports=react_production_min;var reactExports=react.exports;const React=getDefaultExportFromCjs(reactExports),React$1=_mergeNamespaces({__proto__:null,default:React},[reactExports]);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var f$1=reactExports,k$3=Symbol.for("react.element"),l$2=Symbol.for("react.fragment"),m$3=Object.prototype.hasOwnProperty,n$4=f$1.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,p$4={key:!0,ref:!0,__self:!0,__source:!0};function q$2(d,g,b){var et,st={},at=null,vt=null;b!==void 0&&(at=""+b),g.key!==void 0&&(at=""+g.key),g.ref!==void 0&&(vt=g.ref);for(et in g)m$3.call(g,et)&&!p$4.hasOwnProperty(et)&&(st[et]=g[et]);if(d&&d.defaultProps)for(et in g=d.defaultProps,g)st[et]===void 0&&(st[et]=g[et]);return{$$typeof:k$3,type:d,key:at,ref:vt,props:st,_owner:n$4.current}}reactJsxRuntime_production_min.Fragment=l$2;reactJsxRuntime_production_min.jsx=q$2;reactJsxRuntime_production_min.jsxs=q$2;jsxRuntime.exports=reactJsxRuntime_production_min;var jsxRuntimeExports=jsxRuntime.exports,client={},reactDom={exports:{}},reactDom_production_min={},scheduler={exports:{}},scheduler_production_min={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(d){function g(e0,Zr){var Ro=e0.length;e0.push(Zr);e:for(;0<Ro;){var Sn=Ro-1>>>1,Tn=e0[Sn];if(0<st(Tn,Zr))e0[Sn]=Zr,e0[Ro]=Tn,Ro=Sn;else break e}}function b(e0){return e0.length===0?null:e0[0]}function et(e0){if(e0.length===0)return null;var Zr=e0[0],Ro=e0.pop();if(Ro!==Zr){e0[0]=Ro;e:for(var Sn=0,Tn=e0.length,n0=Tn>>>1;Sn<n0;){var Go=2*(Sn+1)-1,An=e0[Go],a0=Go+1,u0=e0[a0];if(0>st(An,Ro))a0<Tn&&0>st(u0,An)?(e0[Sn]=u0,e0[a0]=Ro,Sn=a0):(e0[Sn]=An,e0[Go]=Ro,Sn=Go);else if(a0<Tn&&0>st(u0,Ro))e0[Sn]=u0,e0[a0]=Ro,Sn=a0;else break e}}return Zr}function st(e0,Zr){var Ro=e0.sortIndex-Zr.sortIndex;return Ro!==0?Ro:e0.id-Zr.id}if(typeof performance=="object"&&typeof performance.now=="function"){var at=performance;d.unstable_now=function(){return at.now()}}else{var vt=Date,Tt=vt.now();d.unstable_now=function(){return vt.now()-Tt}}var Ct=[],pt=[],wt=1,$t=null,Lt=3,jt=!1,Ft=!1,Gt=!1,Ht=typeof setTimeout=="function"?setTimeout:null,qt=typeof clearTimeout=="function"?clearTimeout:null,Kt=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function rr(e0){for(var Zr=b(pt);Zr!==null;){if(Zr.callback===null)et(pt);else if(Zr.startTime<=e0)et(pt),Zr.sortIndex=Zr.expirationTime,g(Ct,Zr);else break;Zr=b(pt)}}function ir(e0){if(Gt=!1,rr(e0),!Ft)if(b(Ct)!==null)Ft=!0,_n(or);else{var Zr=b(pt);Zr!==null&&Kr(ir,Zr.startTime-e0)}}function or(e0,Zr){Ft=!1,Gt&&(Gt=!1,qt(Yr),Yr=-1),jt=!0;var Ro=Lt;try{for(rr(Zr),$t=b(Ct);$t!==null&&(!($t.expirationTime>Zr)||e0&&!Xo());){var Sn=$t.callback;if(typeof Sn=="function"){$t.callback=null,Lt=$t.priorityLevel;var Tn=Sn($t.expirationTime<=Zr);Zr=d.unstable_now(),typeof Tn=="function"?$t.callback=Tn:$t===b(Ct)&&et(Ct),rr(Zr)}else et(Ct);$t=b(Ct)}if($t!==null)var n0=!0;else{var Go=b(pt);Go!==null&&Kr(ir,Go.startTime-Zr),n0=!1}return n0}finally{$t=null,Lt=Ro,jt=!1}}var jr=!1,qr=null,Yr=-1,vn=5,ko=-1;function Xo(){return!(d.unstable_now()-ko<vn)}function zo(){if(qr!==null){var e0=d.unstable_now();ko=e0;var Zr=!0;try{Zr=qr(!0,e0)}finally{Zr?t0():(jr=!1,qr=null)}}else jr=!1}var t0;if(typeof Kt=="function")t0=function(){Kt(zo)};else if(typeof MessageChannel<"u"){var Uo=new MessageChannel,No=Uo.port2;Uo.port1.onmessage=zo,t0=function(){No.postMessage(null)}}else t0=function(){Ht(zo,0)};function _n(e0){qr=e0,jr||(jr=!0,t0())}function Kr(e0,Zr){Yr=Ht(function(){e0(d.unstable_now())},Zr)}d.unstable_IdlePriority=5,d.unstable_ImmediatePriority=1,d.unstable_LowPriority=4,d.unstable_NormalPriority=3,d.unstable_Profiling=null,d.unstable_UserBlockingPriority=2,d.unstable_cancelCallback=function(e0){e0.callback=null},d.unstable_continueExecution=function(){Ft||jt||(Ft=!0,_n(or))},d.unstable_forceFrameRate=function(e0){0>e0||125<e0?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):vn=0<e0?Math.floor(1e3/e0):5},d.unstable_getCurrentPriorityLevel=function(){return Lt},d.unstable_getFirstCallbackNode=function(){return b(Ct)},d.unstable_next=function(e0){switch(Lt){case 1:case 2:case 3:var Zr=3;break;default:Zr=Lt}var Ro=Lt;Lt=Zr;try{return e0()}finally{Lt=Ro}},d.unstable_pauseExecution=function(){},d.unstable_requestPaint=function(){},d.unstable_runWithPriority=function(e0,Zr){switch(e0){case 1:case 2:case 3:case 4:case 5:break;default:e0=3}var Ro=Lt;Lt=e0;try{return Zr()}finally{Lt=Ro}},d.unstable_scheduleCallback=function(e0,Zr,Ro){var Sn=d.unstable_now();switch(typeof Ro=="object"&&Ro!==null?(Ro=Ro.delay,Ro=typeof Ro=="number"&&0<Ro?Sn+Ro:Sn):Ro=Sn,e0){case 1:var Tn=-1;break;case 2:Tn=250;break;case 5:Tn=1073741823;break;case 4:Tn=1e4;break;default:Tn=5e3}return Tn=Ro+Tn,e0={id:wt++,callback:Zr,priorityLevel:e0,startTime:Ro,expirationTime:Tn,sortIndex:-1},Ro>Sn?(e0.sortIndex=Ro,g(pt,e0),b(Ct)===null&&e0===b(pt)&&(Gt?(qt(Yr),Yr=-1):Gt=!0,Kr(ir,Ro-Sn))):(e0.sortIndex=Tn,g(Ct,e0),Ft||jt||(Ft=!0,_n(or))),e0},d.unstable_shouldYield=Xo,d.unstable_wrapCallback=function(e0){var Zr=Lt;return function(){var Ro=Lt;Lt=Zr;try{return e0.apply(this,arguments)}finally{Lt=Ro}}}})(scheduler_production_min);scheduler.exports=scheduler_production_min;var schedulerExports=scheduler.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var aa$2=reactExports,ca$2=schedulerExports;function p$3(d){for(var g="https://reactjs.org/docs/error-decoder.html?invariant="+d,b=1;b<arguments.length;b++)g+="&args[]="+encodeURIComponent(arguments[b]);return"Minified React error #"+d+"; visit "+g+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var da$2=new Set,ea$1={};function fa$2(d,g){ha$1(d,g),ha$1(d+"Capture",g)}function ha$1(d,g){for(ea$1[d]=g,d=0;d<g.length;d++)da$2.add(g[d])}var ia$2=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),ja$2=Object.prototype.hasOwnProperty,ka$1=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,la$2={},ma$1={};function oa$2(d){return ja$2.call(ma$1,d)?!0:ja$2.call(la$2,d)?!1:ka$1.test(d)?ma$1[d]=!0:(la$2[d]=!0,!1)}function pa$2(d,g,b,et){if(b!==null&&b.type===0)return!1;switch(typeof g){case"function":case"symbol":return!0;case"boolean":return et?!1:b!==null?!b.acceptsBooleans:(d=d.toLowerCase().slice(0,5),d!=="data-"&&d!=="aria-");default:return!1}}function qa$2(d,g,b,et){if(g===null||typeof g>"u"||pa$2(d,g,b,et))return!0;if(et)return!1;if(b!==null)switch(b.type){case 3:return!g;case 4:return g===!1;case 5:return isNaN(g);case 6:return isNaN(g)||1>g}return!1}function v$1(d,g,b,et,st,at,vt){this.acceptsBooleans=g===2||g===3||g===4,this.attributeName=et,this.attributeNamespace=st,this.mustUseProperty=b,this.propertyName=d,this.type=g,this.sanitizeURL=at,this.removeEmptyString=vt}var z$2={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(d){z$2[d]=new v$1(d,0,!1,d,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(d){var g=d[0];z$2[g]=new v$1(g,1,!1,d[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(d){z$2[d]=new v$1(d,2,!1,d.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(d){z$2[d]=new v$1(d,2,!1,d,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(d){z$2[d]=new v$1(d,3,!1,d.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(d){z$2[d]=new v$1(d,3,!0,d,null,!1,!1)});["capture","download"].forEach(function(d){z$2[d]=new v$1(d,4,!1,d,null,!1,!1)});["cols","rows","size","span"].forEach(function(d){z$2[d]=new v$1(d,6,!1,d,null,!1,!1)});["rowSpan","start"].forEach(function(d){z$2[d]=new v$1(d,5,!1,d.toLowerCase(),null,!1,!1)});var ra$1=/[\-:]([a-z])/g;function sa$2(d){return d[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(d){var g=d.replace(ra$1,sa$2);z$2[g]=new v$1(g,1,!1,d,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(d){var g=d.replace(ra$1,sa$2);z$2[g]=new v$1(g,1,!1,d,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(d){var g=d.replace(ra$1,sa$2);z$2[g]=new v$1(g,1,!1,d,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(d){z$2[d]=new v$1(d,1,!1,d.toLowerCase(),null,!1,!1)});z$2.xlinkHref=new v$1("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(d){z$2[d]=new v$1(d,1,!1,d.toLowerCase(),null,!0,!0)});function ta$1(d,g,b,et){var st=z$2.hasOwnProperty(g)?z$2[g]:null;(st!==null?st.type!==0:et||!(2<g.length)||g[0]!=="o"&&g[0]!=="O"||g[1]!=="n"&&g[1]!=="N")&&(qa$2(g,b,st,et)&&(b=null),et||st===null?oa$2(g)&&(b===null?d.removeAttribute(g):d.setAttribute(g,""+b)):st.mustUseProperty?d[st.propertyName]=b===null?st.type===3?!1:"":b:(g=st.attributeName,et=st.attributeNamespace,b===null?d.removeAttribute(g):(st=st.type,b=st===3||st===4&&b===!0?"":""+b,et?d.setAttributeNS(et,g,b):d.setAttribute(g,b))))}var ua$2=aa$2.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,va$1=Symbol.for("react.element"),wa$1=Symbol.for("react.portal"),ya$1=Symbol.for("react.fragment"),za$1=Symbol.for("react.strict_mode"),Aa$1=Symbol.for("react.profiler"),Ba$1=Symbol.for("react.provider"),Ca$1=Symbol.for("react.context"),Da$1=Symbol.for("react.forward_ref"),Ea$1=Symbol.for("react.suspense"),Fa$1=Symbol.for("react.suspense_list"),Ga$1=Symbol.for("react.memo"),Ha$2=Symbol.for("react.lazy"),Ia$1=Symbol.for("react.offscreen"),Ja$2=Symbol.iterator;function Ka$2(d){return d===null||typeof d!="object"?null:(d=Ja$2&&d[Ja$2]||d["@@iterator"],typeof d=="function"?d:null)}var A=Object.assign,La$1;function Ma$1(d){if(La$1===void 0)try{throw Error()}catch(b){var g=b.stack.trim().match(/\n( *(at )?)/);La$1=g&&g[1]||""}return`
`+La$1+d}var Na=!1;function Oa$1(d,g){if(!d||Na)return"";Na=!0;var b=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(g)if(g=function(){throw Error()},Object.defineProperty(g.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(g,[])}catch(pt){var et=pt}Reflect.construct(d,[],g)}else{try{g.call()}catch(pt){et=pt}d.call(g.prototype)}else{try{throw Error()}catch(pt){et=pt}d()}}catch(pt){if(pt&&et&&typeof pt.stack=="string"){for(var st=pt.stack.split(`
`),at=et.stack.split(`
`),vt=st.length-1,Tt=at.length-1;1<=vt&&0<=Tt&&st[vt]!==at[Tt];)Tt--;for(;1<=vt&&0<=Tt;vt--,Tt--)if(st[vt]!==at[Tt]){if(vt!==1||Tt!==1)do if(vt--,Tt--,0>Tt||st[vt]!==at[Tt]){var Ct=`
`+st[vt].replace(" at new "," at ");return d.displayName&&Ct.includes("<anonymous>")&&(Ct=Ct.replace("<anonymous>",d.displayName)),Ct}while(1<=vt&&0<=Tt);break}}}finally{Na=!1,Error.prepareStackTrace=b}return(d=d?d.displayName||d.name:"")?Ma$1(d):""}function Pa(d){switch(d.tag){case 5:return Ma$1(d.type);case 16:return Ma$1("Lazy");case 13:return Ma$1("Suspense");case 19:return Ma$1("SuspenseList");case 0:case 2:case 15:return d=Oa$1(d.type,!1),d;case 11:return d=Oa$1(d.type.render,!1),d;case 1:return d=Oa$1(d.type,!0),d;default:return""}}function Qa$2(d){if(d==null)return null;if(typeof d=="function")return d.displayName||d.name||null;if(typeof d=="string")return d;switch(d){case ya$1:return"Fragment";case wa$1:return"Portal";case Aa$1:return"Profiler";case za$1:return"StrictMode";case Ea$1:return"Suspense";case Fa$1:return"SuspenseList"}if(typeof d=="object")switch(d.$$typeof){case Ca$1:return(d.displayName||"Context")+".Consumer";case Ba$1:return(d._context.displayName||"Context")+".Provider";case Da$1:var g=d.render;return d=d.displayName,d||(d=g.displayName||g.name||"",d=d!==""?"ForwardRef("+d+")":"ForwardRef"),d;case Ga$1:return g=d.displayName||null,g!==null?g:Qa$2(d.type)||"Memo";case Ha$2:g=d._payload,d=d._init;try{return Qa$2(d(g))}catch{}}return null}function Ra(d){var g=d.type;switch(d.tag){case 24:return"Cache";case 9:return(g.displayName||"Context")+".Consumer";case 10:return(g._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return d=g.render,d=d.displayName||d.name||"",g.displayName||(d!==""?"ForwardRef("+d+")":"ForwardRef");case 7:return"Fragment";case 5:return g;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Qa$2(g);case 8:return g===za$1?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof g=="function")return g.displayName||g.name||null;if(typeof g=="string")return g}return null}function Sa$1(d){switch(typeof d){case"boolean":case"number":case"string":case"undefined":return d;case"object":return d;default:return""}}function Ta$1(d){var g=d.type;return(d=d.nodeName)&&d.toLowerCase()==="input"&&(g==="checkbox"||g==="radio")}function Ua$1(d){var g=Ta$1(d)?"checked":"value",b=Object.getOwnPropertyDescriptor(d.constructor.prototype,g),et=""+d[g];if(!d.hasOwnProperty(g)&&typeof b<"u"&&typeof b.get=="function"&&typeof b.set=="function"){var st=b.get,at=b.set;return Object.defineProperty(d,g,{configurable:!0,get:function(){return st.call(this)},set:function(vt){et=""+vt,at.call(this,vt)}}),Object.defineProperty(d,g,{enumerable:b.enumerable}),{getValue:function(){return et},setValue:function(vt){et=""+vt},stopTracking:function(){d._valueTracker=null,delete d[g]}}}}function Va$2(d){d._valueTracker||(d._valueTracker=Ua$1(d))}function Wa$1(d){if(!d)return!1;var g=d._valueTracker;if(!g)return!0;var b=g.getValue(),et="";return d&&(et=Ta$1(d)?d.checked?"true":"false":d.value),d=et,d!==b?(g.setValue(d),!0):!1}function Xa$2(d){if(d=d||(typeof document<"u"?document:void 0),typeof d>"u")return null;try{return d.activeElement||d.body}catch{return d.body}}function Ya$2(d,g){var b=g.checked;return A({},g,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:b??d._wrapperState.initialChecked})}function Za$2(d,g){var b=g.defaultValue==null?"":g.defaultValue,et=g.checked!=null?g.checked:g.defaultChecked;b=Sa$1(g.value!=null?g.value:b),d._wrapperState={initialChecked:et,initialValue:b,controlled:g.type==="checkbox"||g.type==="radio"?g.checked!=null:g.value!=null}}function ab$1(d,g){g=g.checked,g!=null&&ta$1(d,"checked",g,!1)}function bb$1(d,g){ab$1(d,g);var b=Sa$1(g.value),et=g.type;if(b!=null)et==="number"?(b===0&&d.value===""||d.value!=b)&&(d.value=""+b):d.value!==""+b&&(d.value=""+b);else if(et==="submit"||et==="reset"){d.removeAttribute("value");return}g.hasOwnProperty("value")?cb$1(d,g.type,b):g.hasOwnProperty("defaultValue")&&cb$1(d,g.type,Sa$1(g.defaultValue)),g.checked==null&&g.defaultChecked!=null&&(d.defaultChecked=!!g.defaultChecked)}function db$1(d,g,b){if(g.hasOwnProperty("value")||g.hasOwnProperty("defaultValue")){var et=g.type;if(!(et!=="submit"&&et!=="reset"||g.value!==void 0&&g.value!==null))return;g=""+d._wrapperState.initialValue,b||g===d.value||(d.value=g),d.defaultValue=g}b=d.name,b!==""&&(d.name=""),d.defaultChecked=!!d._wrapperState.initialChecked,b!==""&&(d.name=b)}function cb$1(d,g,b){(g!=="number"||Xa$2(d.ownerDocument)!==d)&&(b==null?d.defaultValue=""+d._wrapperState.initialValue:d.defaultValue!==""+b&&(d.defaultValue=""+b))}var eb$1=Array.isArray;function fb$1(d,g,b,et){if(d=d.options,g){g={};for(var st=0;st<b.length;st++)g["$"+b[st]]=!0;for(b=0;b<d.length;b++)st=g.hasOwnProperty("$"+d[b].value),d[b].selected!==st&&(d[b].selected=st),st&&et&&(d[b].defaultSelected=!0)}else{for(b=""+Sa$1(b),g=null,st=0;st<d.length;st++){if(d[st].value===b){d[st].selected=!0,et&&(d[st].defaultSelected=!0);return}g!==null||d[st].disabled||(g=d[st])}g!==null&&(g.selected=!0)}}function gb$1(d,g){if(g.dangerouslySetInnerHTML!=null)throw Error(p$3(91));return A({},g,{value:void 0,defaultValue:void 0,children:""+d._wrapperState.initialValue})}function hb$1(d,g){var b=g.value;if(b==null){if(b=g.children,g=g.defaultValue,b!=null){if(g!=null)throw Error(p$3(92));if(eb$1(b)){if(1<b.length)throw Error(p$3(93));b=b[0]}g=b}g==null&&(g=""),b=g}d._wrapperState={initialValue:Sa$1(b)}}function ib$1(d,g){var b=Sa$1(g.value),et=Sa$1(g.defaultValue);b!=null&&(b=""+b,b!==d.value&&(d.value=b),g.defaultValue==null&&d.defaultValue!==b&&(d.defaultValue=b)),et!=null&&(d.defaultValue=""+et)}function jb$1(d){var g=d.textContent;g===d._wrapperState.initialValue&&g!==""&&g!==null&&(d.value=g)}function kb$1(d){switch(d){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function lb$1(d,g){return d==null||d==="http://www.w3.org/1999/xhtml"?kb$1(g):d==="http://www.w3.org/2000/svg"&&g==="foreignObject"?"http://www.w3.org/1999/xhtml":d}var mb$1,nb$1=function(d){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(g,b,et,st){MSApp.execUnsafeLocalFunction(function(){return d(g,b,et,st)})}:d}(function(d,g){if(d.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in d)d.innerHTML=g;else{for(mb$1=mb$1||document.createElement("div"),mb$1.innerHTML="<svg>"+g.valueOf().toString()+"</svg>",g=mb$1.firstChild;d.firstChild;)d.removeChild(d.firstChild);for(;g.firstChild;)d.appendChild(g.firstChild)}});function ob$1(d,g){if(g){var b=d.firstChild;if(b&&b===d.lastChild&&b.nodeType===3){b.nodeValue=g;return}}d.textContent=g}var pb$1={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},qb$1=["Webkit","ms","Moz","O"];Object.keys(pb$1).forEach(function(d){qb$1.forEach(function(g){g=g+d.charAt(0).toUpperCase()+d.substring(1),pb$1[g]=pb$1[d]})});function rb$1(d,g,b){return g==null||typeof g=="boolean"||g===""?"":b||typeof g!="number"||g===0||pb$1.hasOwnProperty(d)&&pb$1[d]?(""+g).trim():g+"px"}function sb$1(d,g){d=d.style;for(var b in g)if(g.hasOwnProperty(b)){var et=b.indexOf("--")===0,st=rb$1(b,g[b],et);b==="float"&&(b="cssFloat"),et?d.setProperty(b,st):d[b]=st}}var tb$1=A({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function ub$1(d,g){if(g){if(tb$1[d]&&(g.children!=null||g.dangerouslySetInnerHTML!=null))throw Error(p$3(137,d));if(g.dangerouslySetInnerHTML!=null){if(g.children!=null)throw Error(p$3(60));if(typeof g.dangerouslySetInnerHTML!="object"||!("__html"in g.dangerouslySetInnerHTML))throw Error(p$3(61))}if(g.style!=null&&typeof g.style!="object")throw Error(p$3(62))}}function vb$1(d,g){if(d.indexOf("-")===-1)return typeof g.is=="string";switch(d){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var wb$1=null;function xb$1(d){return d=d.target||d.srcElement||window,d.correspondingUseElement&&(d=d.correspondingUseElement),d.nodeType===3?d.parentNode:d}var yb$1=null,zb$1=null,Ab$1=null;function Bb$1(d){if(d=Cb$1(d)){if(typeof yb$1!="function")throw Error(p$3(280));var g=d.stateNode;g&&(g=Db$1(g),yb$1(d.stateNode,d.type,g))}}function Eb$1(d){zb$1?Ab$1?Ab$1.push(d):Ab$1=[d]:zb$1=d}function Fb$1(){if(zb$1){var d=zb$1,g=Ab$1;if(Ab$1=zb$1=null,Bb$1(d),g)for(d=0;d<g.length;d++)Bb$1(g[d])}}function Gb$1(d,g){return d(g)}function Hb(){}var Ib$1=!1;function Jb$1(d,g,b){if(Ib$1)return d(g,b);Ib$1=!0;try{return Gb$1(d,g,b)}finally{Ib$1=!1,(zb$1!==null||Ab$1!==null)&&(Hb(),Fb$1())}}function Kb$1(d,g){var b=d.stateNode;if(b===null)return null;var et=Db$1(b);if(et===null)return null;b=et[g];e:switch(g){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(et=!et.disabled)||(d=d.type,et=!(d==="button"||d==="input"||d==="select"||d==="textarea")),d=!et;break e;default:d=!1}if(d)return null;if(b&&typeof b!="function")throw Error(p$3(231,g,typeof b));return b}var Lb$1=!1;if(ia$2)try{var Mb$1={};Object.defineProperty(Mb$1,"passive",{get:function(){Lb$1=!0}}),window.addEventListener("test",Mb$1,Mb$1),window.removeEventListener("test",Mb$1,Mb$1)}catch{Lb$1=!1}function Nb$1(d,g,b,et,st,at,vt,Tt,Ct){var pt=Array.prototype.slice.call(arguments,3);try{g.apply(b,pt)}catch(wt){this.onError(wt)}}var Ob$1=!1,Pb$1=null,Qb$1=!1,Rb$1=null,Sb$1={onError:function(d){Ob$1=!0,Pb$1=d}};function Tb$1(d,g,b,et,st,at,vt,Tt,Ct){Ob$1=!1,Pb$1=null,Nb$1.apply(Sb$1,arguments)}function Ub$1(d,g,b,et,st,at,vt,Tt,Ct){if(Tb$1.apply(this,arguments),Ob$1){if(Ob$1){var pt=Pb$1;Ob$1=!1,Pb$1=null}else throw Error(p$3(198));Qb$1||(Qb$1=!0,Rb$1=pt)}}function Vb$1(d){var g=d,b=d;if(d.alternate)for(;g.return;)g=g.return;else{d=g;do g=d,g.flags&4098&&(b=g.return),d=g.return;while(d)}return g.tag===3?b:null}function Wb(d){if(d.tag===13){var g=d.memoizedState;if(g===null&&(d=d.alternate,d!==null&&(g=d.memoizedState)),g!==null)return g.dehydrated}return null}function Xb$1(d){if(Vb$1(d)!==d)throw Error(p$3(188))}function Yb$1(d){var g=d.alternate;if(!g){if(g=Vb$1(d),g===null)throw Error(p$3(188));return g!==d?null:d}for(var b=d,et=g;;){var st=b.return;if(st===null)break;var at=st.alternate;if(at===null){if(et=st.return,et!==null){b=et;continue}break}if(st.child===at.child){for(at=st.child;at;){if(at===b)return Xb$1(st),d;if(at===et)return Xb$1(st),g;at=at.sibling}throw Error(p$3(188))}if(b.return!==et.return)b=st,et=at;else{for(var vt=!1,Tt=st.child;Tt;){if(Tt===b){vt=!0,b=st,et=at;break}if(Tt===et){vt=!0,et=st,b=at;break}Tt=Tt.sibling}if(!vt){for(Tt=at.child;Tt;){if(Tt===b){vt=!0,b=at,et=st;break}if(Tt===et){vt=!0,et=at,b=st;break}Tt=Tt.sibling}if(!vt)throw Error(p$3(189))}}if(b.alternate!==et)throw Error(p$3(190))}if(b.tag!==3)throw Error(p$3(188));return b.stateNode.current===b?d:g}function Zb$1(d){return d=Yb$1(d),d!==null?$b$1(d):null}function $b$1(d){if(d.tag===5||d.tag===6)return d;for(d=d.child;d!==null;){var g=$b$1(d);if(g!==null)return g;d=d.sibling}return null}var ac$2=ca$2.unstable_scheduleCallback,bc$2=ca$2.unstable_cancelCallback,cc$2=ca$2.unstable_shouldYield,dc$2=ca$2.unstable_requestPaint,B$2=ca$2.unstable_now,ec$1=ca$2.unstable_getCurrentPriorityLevel,fc$2=ca$2.unstable_ImmediatePriority,gc$2=ca$2.unstable_UserBlockingPriority,hc$1=ca$2.unstable_NormalPriority,ic$2=ca$2.unstable_LowPriority,jc$2=ca$2.unstable_IdlePriority,kc$2=null,lc$2=null;function mc$2(d){if(lc$2&&typeof lc$2.onCommitFiberRoot=="function")try{lc$2.onCommitFiberRoot(kc$2,d,void 0,(d.current.flags&128)===128)}catch{}}var oc$2=Math.clz32?Math.clz32:nc$2,pc$2=Math.log,qc$2=Math.LN2;function nc$2(d){return d>>>=0,d===0?32:31-(pc$2(d)/qc$2|0)|0}var rc$1=64,sc$2=4194304;function tc$1(d){switch(d&-d){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return d&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return d&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return d}}function uc$2(d,g){var b=d.pendingLanes;if(b===0)return 0;var et=0,st=d.suspendedLanes,at=d.pingedLanes,vt=b&268435455;if(vt!==0){var Tt=vt&~st;Tt!==0?et=tc$1(Tt):(at&=vt,at!==0&&(et=tc$1(at)))}else vt=b&~st,vt!==0?et=tc$1(vt):at!==0&&(et=tc$1(at));if(et===0)return 0;if(g!==0&&g!==et&&!(g&st)&&(st=et&-et,at=g&-g,st>=at||st===16&&(at&4194240)!==0))return g;if(et&4&&(et|=b&16),g=d.entangledLanes,g!==0)for(d=d.entanglements,g&=et;0<g;)b=31-oc$2(g),st=1<<b,et|=d[b],g&=~st;return et}function vc$2(d,g){switch(d){case 1:case 2:case 4:return g+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return g+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function wc$2(d,g){for(var b=d.suspendedLanes,et=d.pingedLanes,st=d.expirationTimes,at=d.pendingLanes;0<at;){var vt=31-oc$2(at),Tt=1<<vt,Ct=st[vt];Ct===-1?(!(Tt&b)||Tt&et)&&(st[vt]=vc$2(Tt,g)):Ct<=g&&(d.expiredLanes|=Tt),at&=~Tt}}function xc$2(d){return d=d.pendingLanes&-1073741825,d!==0?d:d&1073741824?1073741824:0}function yc$2(){var d=rc$1;return rc$1<<=1,!(rc$1&4194240)&&(rc$1=64),d}function zc$2(d){for(var g=[],b=0;31>b;b++)g.push(d);return g}function Ac$2(d,g,b){d.pendingLanes|=g,g!==536870912&&(d.suspendedLanes=0,d.pingedLanes=0),d=d.eventTimes,g=31-oc$2(g),d[g]=b}function Bc$2(d,g){var b=d.pendingLanes&~g;d.pendingLanes=g,d.suspendedLanes=0,d.pingedLanes=0,d.expiredLanes&=g,d.mutableReadLanes&=g,d.entangledLanes&=g,g=d.entanglements;var et=d.eventTimes;for(d=d.expirationTimes;0<b;){var st=31-oc$2(b),at=1<<st;g[st]=0,et[st]=-1,d[st]=-1,b&=~at}}function Cc$2(d,g){var b=d.entangledLanes|=g;for(d=d.entanglements;b;){var et=31-oc$2(b),st=1<<et;st&g|d[et]&g&&(d[et]|=g),b&=~st}}var C=0;function Dc$2(d){return d&=-d,1<d?4<d?d&268435455?16:536870912:4:1}var Ec$2,Fc$2,Gc$2,Hc$2,Ic$2,Jc$2=!1,Kc$2=[],Lc$2=null,Mc$2=null,Nc$2=null,Oc$2=new Map,Pc$2=new Map,Qc$2=[],Rc$2="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Sc$2(d,g){switch(d){case"focusin":case"focusout":Lc$2=null;break;case"dragenter":case"dragleave":Mc$2=null;break;case"mouseover":case"mouseout":Nc$2=null;break;case"pointerover":case"pointerout":Oc$2.delete(g.pointerId);break;case"gotpointercapture":case"lostpointercapture":Pc$2.delete(g.pointerId)}}function Tc$2(d,g,b,et,st,at){return d===null||d.nativeEvent!==at?(d={blockedOn:g,domEventName:b,eventSystemFlags:et,nativeEvent:at,targetContainers:[st]},g!==null&&(g=Cb$1(g),g!==null&&Fc$2(g)),d):(d.eventSystemFlags|=et,g=d.targetContainers,st!==null&&g.indexOf(st)===-1&&g.push(st),d)}function Uc$2(d,g,b,et,st){switch(g){case"focusin":return Lc$2=Tc$2(Lc$2,d,g,b,et,st),!0;case"dragenter":return Mc$2=Tc$2(Mc$2,d,g,b,et,st),!0;case"mouseover":return Nc$2=Tc$2(Nc$2,d,g,b,et,st),!0;case"pointerover":var at=st.pointerId;return Oc$2.set(at,Tc$2(Oc$2.get(at)||null,d,g,b,et,st)),!0;case"gotpointercapture":return at=st.pointerId,Pc$2.set(at,Tc$2(Pc$2.get(at)||null,d,g,b,et,st)),!0}return!1}function Vc$2(d){var g=Wc$2(d.target);if(g!==null){var b=Vb$1(g);if(b!==null){if(g=b.tag,g===13){if(g=Wb(b),g!==null){d.blockedOn=g,Ic$2(d.priority,function(){Gc$2(b)});return}}else if(g===3&&b.stateNode.current.memoizedState.isDehydrated){d.blockedOn=b.tag===3?b.stateNode.containerInfo:null;return}}}d.blockedOn=null}function Xc$2(d){if(d.blockedOn!==null)return!1;for(var g=d.targetContainers;0<g.length;){var b=Yc$2(d.domEventName,d.eventSystemFlags,g[0],d.nativeEvent);if(b===null){b=d.nativeEvent;var et=new b.constructor(b.type,b);wb$1=et,b.target.dispatchEvent(et),wb$1=null}else return g=Cb$1(b),g!==null&&Fc$2(g),d.blockedOn=b,!1;g.shift()}return!0}function Zc$2(d,g,b){Xc$2(d)&&b.delete(g)}function $c$2(){Jc$2=!1,Lc$2!==null&&Xc$2(Lc$2)&&(Lc$2=null),Mc$2!==null&&Xc$2(Mc$2)&&(Mc$2=null),Nc$2!==null&&Xc$2(Nc$2)&&(Nc$2=null),Oc$2.forEach(Zc$2),Pc$2.forEach(Zc$2)}function ad$2(d,g){d.blockedOn===g&&(d.blockedOn=null,Jc$2||(Jc$2=!0,ca$2.unstable_scheduleCallback(ca$2.unstable_NormalPriority,$c$2)))}function bd$1(d){function g(st){return ad$2(st,d)}if(0<Kc$2.length){ad$2(Kc$2[0],d);for(var b=1;b<Kc$2.length;b++){var et=Kc$2[b];et.blockedOn===d&&(et.blockedOn=null)}}for(Lc$2!==null&&ad$2(Lc$2,d),Mc$2!==null&&ad$2(Mc$2,d),Nc$2!==null&&ad$2(Nc$2,d),Oc$2.forEach(g),Pc$2.forEach(g),b=0;b<Qc$2.length;b++)et=Qc$2[b],et.blockedOn===d&&(et.blockedOn=null);for(;0<Qc$2.length&&(b=Qc$2[0],b.blockedOn===null);)Vc$2(b),b.blockedOn===null&&Qc$2.shift()}var cd$2=ua$2.ReactCurrentBatchConfig,dd$2=!0;function ed$2(d,g,b,et){var st=C,at=cd$2.transition;cd$2.transition=null;try{C=1,fd$2(d,g,b,et)}finally{C=st,cd$2.transition=at}}function gd$1(d,g,b,et){var st=C,at=cd$2.transition;cd$2.transition=null;try{C=4,fd$2(d,g,b,et)}finally{C=st,cd$2.transition=at}}function fd$2(d,g,b,et){if(dd$2){var st=Yc$2(d,g,b,et);if(st===null)hd$2(d,g,et,id$2,b),Sc$2(d,et);else if(Uc$2(st,d,g,b,et))et.stopPropagation();else if(Sc$2(d,et),g&4&&-1<Rc$2.indexOf(d)){for(;st!==null;){var at=Cb$1(st);if(at!==null&&Ec$2(at),at=Yc$2(d,g,b,et),at===null&&hd$2(d,g,et,id$2,b),at===st)break;st=at}st!==null&&et.stopPropagation()}else hd$2(d,g,et,null,b)}}var id$2=null;function Yc$2(d,g,b,et){if(id$2=null,d=xb$1(et),d=Wc$2(d),d!==null)if(g=Vb$1(d),g===null)d=null;else if(b=g.tag,b===13){if(d=Wb(g),d!==null)return d;d=null}else if(b===3){if(g.stateNode.current.memoizedState.isDehydrated)return g.tag===3?g.stateNode.containerInfo:null;d=null}else g!==d&&(d=null);return id$2=d,null}function jd$2(d){switch(d){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(ec$1()){case fc$2:return 1;case gc$2:return 4;case hc$1:case ic$2:return 16;case jc$2:return 536870912;default:return 16}default:return 16}}var kd$2=null,ld$2=null,md$2=null;function nd$2(){if(md$2)return md$2;var d,g=ld$2,b=g.length,et,st="value"in kd$2?kd$2.value:kd$2.textContent,at=st.length;for(d=0;d<b&&g[d]===st[d];d++);var vt=b-d;for(et=1;et<=vt&&g[b-et]===st[at-et];et++);return md$2=st.slice(d,1<et?1-et:void 0)}function od$2(d){var g=d.keyCode;return"charCode"in d?(d=d.charCode,d===0&&g===13&&(d=13)):d=g,d===10&&(d=13),32<=d||d===13?d:0}function pd$2(){return!0}function qd$2(){return!1}function rd$2(d){function g(b,et,st,at,vt){this._reactName=b,this._targetInst=st,this.type=et,this.nativeEvent=at,this.target=vt,this.currentTarget=null;for(var Tt in d)d.hasOwnProperty(Tt)&&(b=d[Tt],this[Tt]=b?b(at):at[Tt]);return this.isDefaultPrevented=(at.defaultPrevented!=null?at.defaultPrevented:at.returnValue===!1)?pd$2:qd$2,this.isPropagationStopped=qd$2,this}return A(g.prototype,{preventDefault:function(){this.defaultPrevented=!0;var b=this.nativeEvent;b&&(b.preventDefault?b.preventDefault():typeof b.returnValue!="unknown"&&(b.returnValue=!1),this.isDefaultPrevented=pd$2)},stopPropagation:function(){var b=this.nativeEvent;b&&(b.stopPropagation?b.stopPropagation():typeof b.cancelBubble!="unknown"&&(b.cancelBubble=!0),this.isPropagationStopped=pd$2)},persist:function(){},isPersistent:pd$2}),g}var sd$2={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(d){return d.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},td$2=rd$2(sd$2),ud$2=A({},sd$2,{view:0,detail:0}),vd$2=rd$2(ud$2),wd$1,xd$1,yd$1,Ad$2=A({},ud$2,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:zd$1,button:0,buttons:0,relatedTarget:function(d){return d.relatedTarget===void 0?d.fromElement===d.srcElement?d.toElement:d.fromElement:d.relatedTarget},movementX:function(d){return"movementX"in d?d.movementX:(d!==yd$1&&(yd$1&&d.type==="mousemove"?(wd$1=d.screenX-yd$1.screenX,xd$1=d.screenY-yd$1.screenY):xd$1=wd$1=0,yd$1=d),wd$1)},movementY:function(d){return"movementY"in d?d.movementY:xd$1}}),Bd$1=rd$2(Ad$2),Cd$2=A({},Ad$2,{dataTransfer:0}),Dd$2=rd$2(Cd$2),Ed$2=A({},ud$2,{relatedTarget:0}),Fd$2=rd$2(Ed$2),Gd$1=A({},sd$2,{animationName:0,elapsedTime:0,pseudoElement:0}),Hd$2=rd$2(Gd$1),Id$2=A({},sd$2,{clipboardData:function(d){return"clipboardData"in d?d.clipboardData:window.clipboardData}}),Jd$1=rd$2(Id$2),Kd$2=A({},sd$2,{data:0}),Ld$2=rd$2(Kd$2),Md$1={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Nd$1={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Od$2={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Pd$2(d){var g=this.nativeEvent;return g.getModifierState?g.getModifierState(d):(d=Od$2[d])?!!g[d]:!1}function zd$1(){return Pd$2}var Qd$1=A({},ud$2,{key:function(d){if(d.key){var g=Md$1[d.key]||d.key;if(g!=="Unidentified")return g}return d.type==="keypress"?(d=od$2(d),d===13?"Enter":String.fromCharCode(d)):d.type==="keydown"||d.type==="keyup"?Nd$1[d.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:zd$1,charCode:function(d){return d.type==="keypress"?od$2(d):0},keyCode:function(d){return d.type==="keydown"||d.type==="keyup"?d.keyCode:0},which:function(d){return d.type==="keypress"?od$2(d):d.type==="keydown"||d.type==="keyup"?d.keyCode:0}}),Rd$1=rd$2(Qd$1),Sd$2=A({},Ad$2,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Td$1=rd$2(Sd$2),Ud$1=A({},ud$2,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:zd$1}),Vd$1=rd$2(Ud$1),Wd$1=A({},sd$2,{propertyName:0,elapsedTime:0,pseudoElement:0}),Xd$2=rd$2(Wd$1),Yd$2=A({},Ad$2,{deltaX:function(d){return"deltaX"in d?d.deltaX:"wheelDeltaX"in d?-d.wheelDeltaX:0},deltaY:function(d){return"deltaY"in d?d.deltaY:"wheelDeltaY"in d?-d.wheelDeltaY:"wheelDelta"in d?-d.wheelDelta:0},deltaZ:0,deltaMode:0}),Zd$1=rd$2(Yd$2),$d$1=[9,13,27,32],ae$1=ia$2&&"CompositionEvent"in window,be$2=null;ia$2&&"documentMode"in document&&(be$2=document.documentMode);var ce$1=ia$2&&"TextEvent"in window&&!be$2,de$1=ia$2&&(!ae$1||be$2&&8<be$2&&11>=be$2),ee=" ",fe$3=!1;function ge$1(d,g){switch(d){case"keyup":return $d$1.indexOf(g.keyCode)!==-1;case"keydown":return g.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function he$1(d){return d=d.detail,typeof d=="object"&&"data"in d?d.data:null}var ie=!1;function je(d,g){switch(d){case"compositionend":return he$1(g);case"keypress":return g.which!==32?null:(fe$3=!0,ee);case"textInput":return d=g.data,d===ee&&fe$3?null:d;default:return null}}function ke$1(d,g){if(ie)return d==="compositionend"||!ae$1&&ge$1(d,g)?(d=nd$2(),md$2=ld$2=kd$2=null,ie=!1,d):null;switch(d){case"paste":return null;case"keypress":if(!(g.ctrlKey||g.altKey||g.metaKey)||g.ctrlKey&&g.altKey){if(g.char&&1<g.char.length)return g.char;if(g.which)return String.fromCharCode(g.which)}return null;case"compositionend":return de$1&&g.locale!=="ko"?null:g.data;default:return null}}var le$2={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function me$2(d){var g=d&&d.nodeName&&d.nodeName.toLowerCase();return g==="input"?!!le$2[d.type]:g==="textarea"}function ne$1(d,g,b,et){Eb$1(et),g=oe$1(g,"onChange"),0<g.length&&(b=new td$2("onChange","change",null,b,et),d.push({event:b,listeners:g}))}var pe$1=null,qe$1=null;function re(d){se(d,0)}function te(d){var g=ue$1(d);if(Wa$1(g))return d}function ve$2(d,g){if(d==="change")return g}var we$3=!1;if(ia$2){var xe$2;if(ia$2){var ye$3="oninput"in document;if(!ye$3){var ze=document.createElement("div");ze.setAttribute("oninput","return;"),ye$3=typeof ze.oninput=="function"}xe$2=ye$3}else xe$2=!1;we$3=xe$2&&(!document.documentMode||9<document.documentMode)}function Ae(){pe$1&&(pe$1.detachEvent("onpropertychange",Be),qe$1=pe$1=null)}function Be(d){if(d.propertyName==="value"&&te(qe$1)){var g=[];ne$1(g,qe$1,d,xb$1(d)),Jb$1(re,g)}}function Ce$1(d,g,b){d==="focusin"?(Ae(),pe$1=g,qe$1=b,pe$1.attachEvent("onpropertychange",Be)):d==="focusout"&&Ae()}function De$3(d){if(d==="selectionchange"||d==="keyup"||d==="keydown")return te(qe$1)}function Ee$2(d,g){if(d==="click")return te(g)}function Fe$1(d,g){if(d==="input"||d==="change")return te(g)}function Ge(d,g){return d===g&&(d!==0||1/d===1/g)||d!==d&&g!==g}var He$1=typeof Object.is=="function"?Object.is:Ge;function Ie$1(d,g){if(He$1(d,g))return!0;if(typeof d!="object"||d===null||typeof g!="object"||g===null)return!1;var b=Object.keys(d),et=Object.keys(g);if(b.length!==et.length)return!1;for(et=0;et<b.length;et++){var st=b[et];if(!ja$2.call(g,st)||!He$1(d[st],g[st]))return!1}return!0}function Je$1(d){for(;d&&d.firstChild;)d=d.firstChild;return d}function Ke(d,g){var b=Je$1(d);d=0;for(var et;b;){if(b.nodeType===3){if(et=d+b.textContent.length,d<=g&&et>=g)return{node:b,offset:g-d};d=et}e:{for(;b;){if(b.nextSibling){b=b.nextSibling;break e}b=b.parentNode}b=void 0}b=Je$1(b)}}function Le(d,g){return d&&g?d===g?!0:d&&d.nodeType===3?!1:g&&g.nodeType===3?Le(d,g.parentNode):"contains"in d?d.contains(g):d.compareDocumentPosition?!!(d.compareDocumentPosition(g)&16):!1:!1}function Me$2(){for(var d=window,g=Xa$2();g instanceof d.HTMLIFrameElement;){try{var b=typeof g.contentWindow.location.href=="string"}catch{b=!1}if(b)d=g.contentWindow;else break;g=Xa$2(d.document)}return g}function Ne$1(d){var g=d&&d.nodeName&&d.nodeName.toLowerCase();return g&&(g==="input"&&(d.type==="text"||d.type==="search"||d.type==="tel"||d.type==="url"||d.type==="password")||g==="textarea"||d.contentEditable==="true")}function Oe(d){var g=Me$2(),b=d.focusedElem,et=d.selectionRange;if(g!==b&&b&&b.ownerDocument&&Le(b.ownerDocument.documentElement,b)){if(et!==null&&Ne$1(b)){if(g=et.start,d=et.end,d===void 0&&(d=g),"selectionStart"in b)b.selectionStart=g,b.selectionEnd=Math.min(d,b.value.length);else if(d=(g=b.ownerDocument||document)&&g.defaultView||window,d.getSelection){d=d.getSelection();var st=b.textContent.length,at=Math.min(et.start,st);et=et.end===void 0?at:Math.min(et.end,st),!d.extend&&at>et&&(st=et,et=at,at=st),st=Ke(b,at);var vt=Ke(b,et);st&&vt&&(d.rangeCount!==1||d.anchorNode!==st.node||d.anchorOffset!==st.offset||d.focusNode!==vt.node||d.focusOffset!==vt.offset)&&(g=g.createRange(),g.setStart(st.node,st.offset),d.removeAllRanges(),at>et?(d.addRange(g),d.extend(vt.node,vt.offset)):(g.setEnd(vt.node,vt.offset),d.addRange(g)))}}for(g=[],d=b;d=d.parentNode;)d.nodeType===1&&g.push({element:d,left:d.scrollLeft,top:d.scrollTop});for(typeof b.focus=="function"&&b.focus(),b=0;b<g.length;b++)d=g[b],d.element.scrollLeft=d.left,d.element.scrollTop=d.top}}var Pe$2=ia$2&&"documentMode"in document&&11>=document.documentMode,Qe$1=null,Re$1=null,Se$1=null,Te$1=!1;function Ue$2(d,g,b){var et=b.window===b?b.document:b.nodeType===9?b:b.ownerDocument;Te$1||Qe$1==null||Qe$1!==Xa$2(et)||(et=Qe$1,"selectionStart"in et&&Ne$1(et)?et={start:et.selectionStart,end:et.selectionEnd}:(et=(et.ownerDocument&&et.ownerDocument.defaultView||window).getSelection(),et={anchorNode:et.anchorNode,anchorOffset:et.anchorOffset,focusNode:et.focusNode,focusOffset:et.focusOffset}),Se$1&&Ie$1(Se$1,et)||(Se$1=et,et=oe$1(Re$1,"onSelect"),0<et.length&&(g=new td$2("onSelect","select",null,g,b),d.push({event:g,listeners:et}),g.target=Qe$1)))}function Ve(d,g){var b={};return b[d.toLowerCase()]=g.toLowerCase(),b["Webkit"+d]="webkit"+g,b["Moz"+d]="moz"+g,b}var We$2={animationend:Ve("Animation","AnimationEnd"),animationiteration:Ve("Animation","AnimationIteration"),animationstart:Ve("Animation","AnimationStart"),transitionend:Ve("Transition","TransitionEnd")},Xe$1={},Ye={};ia$2&&(Ye=document.createElement("div").style,"AnimationEvent"in window||(delete We$2.animationend.animation,delete We$2.animationiteration.animation,delete We$2.animationstart.animation),"TransitionEvent"in window||delete We$2.transitionend.transition);function Ze$2(d){if(Xe$1[d])return Xe$1[d];if(!We$2[d])return d;var g=We$2[d],b;for(b in g)if(g.hasOwnProperty(b)&&b in Ye)return Xe$1[d]=g[b];return d}var $e$1=Ze$2("animationend"),af$2=Ze$2("animationiteration"),bf$1=Ze$2("animationstart"),cf$1=Ze$2("transitionend"),df$1=new Map,ef$2="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function ff$2(d,g){df$1.set(d,g),fa$2(g,[d])}for(var gf$1=0;gf$1<ef$2.length;gf$1++){var hf$2=ef$2[gf$1],jf$1=hf$2.toLowerCase(),kf$1=hf$2[0].toUpperCase()+hf$2.slice(1);ff$2(jf$1,"on"+kf$1)}ff$2($e$1,"onAnimationEnd");ff$2(af$2,"onAnimationIteration");ff$2(bf$1,"onAnimationStart");ff$2("dblclick","onDoubleClick");ff$2("focusin","onFocus");ff$2("focusout","onBlur");ff$2(cf$1,"onTransitionEnd");ha$1("onMouseEnter",["mouseout","mouseover"]);ha$1("onMouseLeave",["mouseout","mouseover"]);ha$1("onPointerEnter",["pointerout","pointerover"]);ha$1("onPointerLeave",["pointerout","pointerover"]);fa$2("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));fa$2("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));fa$2("onBeforeInput",["compositionend","keypress","textInput","paste"]);fa$2("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));fa$2("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));fa$2("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var lf$2="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),mf$2=new Set("cancel close invalid load scroll toggle".split(" ").concat(lf$2));function nf$2(d,g,b){var et=d.type||"unknown-event";d.currentTarget=b,Ub$1(et,g,void 0,d),d.currentTarget=null}function se(d,g){g=(g&4)!==0;for(var b=0;b<d.length;b++){var et=d[b],st=et.event;et=et.listeners;e:{var at=void 0;if(g)for(var vt=et.length-1;0<=vt;vt--){var Tt=et[vt],Ct=Tt.instance,pt=Tt.currentTarget;if(Tt=Tt.listener,Ct!==at&&st.isPropagationStopped())break e;nf$2(st,Tt,pt),at=Ct}else for(vt=0;vt<et.length;vt++){if(Tt=et[vt],Ct=Tt.instance,pt=Tt.currentTarget,Tt=Tt.listener,Ct!==at&&st.isPropagationStopped())break e;nf$2(st,Tt,pt),at=Ct}}}if(Qb$1)throw d=Rb$1,Qb$1=!1,Rb$1=null,d}function D$2(d,g){var b=g[of$2];b===void 0&&(b=g[of$2]=new Set);var et=d+"__bubble";b.has(et)||(pf$2(g,d,2,!1),b.add(et))}function qf$1(d,g,b){var et=0;g&&(et|=4),pf$2(b,d,et,g)}var rf$2="_reactListening"+Math.random().toString(36).slice(2);function sf$2(d){if(!d[rf$2]){d[rf$2]=!0,da$2.forEach(function(b){b!=="selectionchange"&&(mf$2.has(b)||qf$1(b,!1,d),qf$1(b,!0,d))});var g=d.nodeType===9?d:d.ownerDocument;g===null||g[rf$2]||(g[rf$2]=!0,qf$1("selectionchange",!1,g))}}function pf$2(d,g,b,et){switch(jd$2(g)){case 1:var st=ed$2;break;case 4:st=gd$1;break;default:st=fd$2}b=st.bind(null,g,b,d),st=void 0,!Lb$1||g!=="touchstart"&&g!=="touchmove"&&g!=="wheel"||(st=!0),et?st!==void 0?d.addEventListener(g,b,{capture:!0,passive:st}):d.addEventListener(g,b,!0):st!==void 0?d.addEventListener(g,b,{passive:st}):d.addEventListener(g,b,!1)}function hd$2(d,g,b,et,st){var at=et;if(!(g&1)&&!(g&2)&&et!==null)e:for(;;){if(et===null)return;var vt=et.tag;if(vt===3||vt===4){var Tt=et.stateNode.containerInfo;if(Tt===st||Tt.nodeType===8&&Tt.parentNode===st)break;if(vt===4)for(vt=et.return;vt!==null;){var Ct=vt.tag;if((Ct===3||Ct===4)&&(Ct=vt.stateNode.containerInfo,Ct===st||Ct.nodeType===8&&Ct.parentNode===st))return;vt=vt.return}for(;Tt!==null;){if(vt=Wc$2(Tt),vt===null)return;if(Ct=vt.tag,Ct===5||Ct===6){et=at=vt;continue e}Tt=Tt.parentNode}}et=et.return}Jb$1(function(){var pt=at,wt=xb$1(b),$t=[];e:{var Lt=df$1.get(d);if(Lt!==void 0){var jt=td$2,Ft=d;switch(d){case"keypress":if(od$2(b)===0)break e;case"keydown":case"keyup":jt=Rd$1;break;case"focusin":Ft="focus",jt=Fd$2;break;case"focusout":Ft="blur",jt=Fd$2;break;case"beforeblur":case"afterblur":jt=Fd$2;break;case"click":if(b.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":jt=Bd$1;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":jt=Dd$2;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":jt=Vd$1;break;case $e$1:case af$2:case bf$1:jt=Hd$2;break;case cf$1:jt=Xd$2;break;case"scroll":jt=vd$2;break;case"wheel":jt=Zd$1;break;case"copy":case"cut":case"paste":jt=Jd$1;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":jt=Td$1}var Gt=(g&4)!==0,Ht=!Gt&&d==="scroll",qt=Gt?Lt!==null?Lt+"Capture":null:Lt;Gt=[];for(var Kt=pt,rr;Kt!==null;){rr=Kt;var ir=rr.stateNode;if(rr.tag===5&&ir!==null&&(rr=ir,qt!==null&&(ir=Kb$1(Kt,qt),ir!=null&&Gt.push(tf$2(Kt,ir,rr)))),Ht)break;Kt=Kt.return}0<Gt.length&&(Lt=new jt(Lt,Ft,null,b,wt),$t.push({event:Lt,listeners:Gt}))}}if(!(g&7)){e:{if(Lt=d==="mouseover"||d==="pointerover",jt=d==="mouseout"||d==="pointerout",Lt&&b!==wb$1&&(Ft=b.relatedTarget||b.fromElement)&&(Wc$2(Ft)||Ft[uf$2]))break e;if((jt||Lt)&&(Lt=wt.window===wt?wt:(Lt=wt.ownerDocument)?Lt.defaultView||Lt.parentWindow:window,jt?(Ft=b.relatedTarget||b.toElement,jt=pt,Ft=Ft?Wc$2(Ft):null,Ft!==null&&(Ht=Vb$1(Ft),Ft!==Ht||Ft.tag!==5&&Ft.tag!==6)&&(Ft=null)):(jt=null,Ft=pt),jt!==Ft)){if(Gt=Bd$1,ir="onMouseLeave",qt="onMouseEnter",Kt="mouse",(d==="pointerout"||d==="pointerover")&&(Gt=Td$1,ir="onPointerLeave",qt="onPointerEnter",Kt="pointer"),Ht=jt==null?Lt:ue$1(jt),rr=Ft==null?Lt:ue$1(Ft),Lt=new Gt(ir,Kt+"leave",jt,b,wt),Lt.target=Ht,Lt.relatedTarget=rr,ir=null,Wc$2(wt)===pt&&(Gt=new Gt(qt,Kt+"enter",Ft,b,wt),Gt.target=rr,Gt.relatedTarget=Ht,ir=Gt),Ht=ir,jt&&Ft)t:{for(Gt=jt,qt=Ft,Kt=0,rr=Gt;rr;rr=vf$1(rr))Kt++;for(rr=0,ir=qt;ir;ir=vf$1(ir))rr++;for(;0<Kt-rr;)Gt=vf$1(Gt),Kt--;for(;0<rr-Kt;)qt=vf$1(qt),rr--;for(;Kt--;){if(Gt===qt||qt!==null&&Gt===qt.alternate)break t;Gt=vf$1(Gt),qt=vf$1(qt)}Gt=null}else Gt=null;jt!==null&&wf$1($t,Lt,jt,Gt,!1),Ft!==null&&Ht!==null&&wf$1($t,Ht,Ft,Gt,!0)}}e:{if(Lt=pt?ue$1(pt):window,jt=Lt.nodeName&&Lt.nodeName.toLowerCase(),jt==="select"||jt==="input"&&Lt.type==="file")var or=ve$2;else if(me$2(Lt))if(we$3)or=Fe$1;else{or=De$3;var jr=Ce$1}else(jt=Lt.nodeName)&&jt.toLowerCase()==="input"&&(Lt.type==="checkbox"||Lt.type==="radio")&&(or=Ee$2);if(or&&(or=or(d,pt))){ne$1($t,or,b,wt);break e}jr&&jr(d,Lt,pt),d==="focusout"&&(jr=Lt._wrapperState)&&jr.controlled&&Lt.type==="number"&&cb$1(Lt,"number",Lt.value)}switch(jr=pt?ue$1(pt):window,d){case"focusin":(me$2(jr)||jr.contentEditable==="true")&&(Qe$1=jr,Re$1=pt,Se$1=null);break;case"focusout":Se$1=Re$1=Qe$1=null;break;case"mousedown":Te$1=!0;break;case"contextmenu":case"mouseup":case"dragend":Te$1=!1,Ue$2($t,b,wt);break;case"selectionchange":if(Pe$2)break;case"keydown":case"keyup":Ue$2($t,b,wt)}var qr;if(ae$1)e:{switch(d){case"compositionstart":var Yr="onCompositionStart";break e;case"compositionend":Yr="onCompositionEnd";break e;case"compositionupdate":Yr="onCompositionUpdate";break e}Yr=void 0}else ie?ge$1(d,b)&&(Yr="onCompositionEnd"):d==="keydown"&&b.keyCode===229&&(Yr="onCompositionStart");Yr&&(de$1&&b.locale!=="ko"&&(ie||Yr!=="onCompositionStart"?Yr==="onCompositionEnd"&&ie&&(qr=nd$2()):(kd$2=wt,ld$2="value"in kd$2?kd$2.value:kd$2.textContent,ie=!0)),jr=oe$1(pt,Yr),0<jr.length&&(Yr=new Ld$2(Yr,d,null,b,wt),$t.push({event:Yr,listeners:jr}),qr?Yr.data=qr:(qr=he$1(b),qr!==null&&(Yr.data=qr)))),(qr=ce$1?je(d,b):ke$1(d,b))&&(pt=oe$1(pt,"onBeforeInput"),0<pt.length&&(wt=new Ld$2("onBeforeInput","beforeinput",null,b,wt),$t.push({event:wt,listeners:pt}),wt.data=qr))}se($t,g)})}function tf$2(d,g,b){return{instance:d,listener:g,currentTarget:b}}function oe$1(d,g){for(var b=g+"Capture",et=[];d!==null;){var st=d,at=st.stateNode;st.tag===5&&at!==null&&(st=at,at=Kb$1(d,b),at!=null&&et.unshift(tf$2(d,at,st)),at=Kb$1(d,g),at!=null&&et.push(tf$2(d,at,st))),d=d.return}return et}function vf$1(d){if(d===null)return null;do d=d.return;while(d&&d.tag!==5);return d||null}function wf$1(d,g,b,et,st){for(var at=g._reactName,vt=[];b!==null&&b!==et;){var Tt=b,Ct=Tt.alternate,pt=Tt.stateNode;if(Ct!==null&&Ct===et)break;Tt.tag===5&&pt!==null&&(Tt=pt,st?(Ct=Kb$1(b,at),Ct!=null&&vt.unshift(tf$2(b,Ct,Tt))):st||(Ct=Kb$1(b,at),Ct!=null&&vt.push(tf$2(b,Ct,Tt)))),b=b.return}vt.length!==0&&d.push({event:g,listeners:vt})}var xf$1=/\r\n?/g,yf$1=/\u0000|\uFFFD/g;function zf$1(d){return(typeof d=="string"?d:""+d).replace(xf$1,`
`).replace(yf$1,"")}function Af$1(d,g,b){if(g=zf$1(g),zf$1(d)!==g&&b)throw Error(p$3(425))}function Bf$1(){}var Cf$1=null,Df$1=null;function Ef$1(d,g){return d==="textarea"||d==="noscript"||typeof g.children=="string"||typeof g.children=="number"||typeof g.dangerouslySetInnerHTML=="object"&&g.dangerouslySetInnerHTML!==null&&g.dangerouslySetInnerHTML.__html!=null}var Ff$1=typeof setTimeout=="function"?setTimeout:void 0,Gf$1=typeof clearTimeout=="function"?clearTimeout:void 0,Hf$1=typeof Promise=="function"?Promise:void 0,Jf$1=typeof queueMicrotask=="function"?queueMicrotask:typeof Hf$1<"u"?function(d){return Hf$1.resolve(null).then(d).catch(If$1)}:Ff$1;function If$1(d){setTimeout(function(){throw d})}function Kf$1(d,g){var b=g,et=0;do{var st=b.nextSibling;if(d.removeChild(b),st&&st.nodeType===8)if(b=st.data,b==="/$"){if(et===0){d.removeChild(st),bd$1(g);return}et--}else b!=="$"&&b!=="$?"&&b!=="$!"||et++;b=st}while(b);bd$1(g)}function Lf$1(d){for(;d!=null;d=d.nextSibling){var g=d.nodeType;if(g===1||g===3)break;if(g===8){if(g=d.data,g==="$"||g==="$!"||g==="$?")break;if(g==="/$")return null}}return d}function Mf$1(d){d=d.previousSibling;for(var g=0;d;){if(d.nodeType===8){var b=d.data;if(b==="$"||b==="$!"||b==="$?"){if(g===0)return d;g--}else b==="/$"&&g++}d=d.previousSibling}return null}var Nf$1=Math.random().toString(36).slice(2),Of$1="__reactFiber$"+Nf$1,Pf$1="__reactProps$"+Nf$1,uf$2="__reactContainer$"+Nf$1,of$2="__reactEvents$"+Nf$1,Qf$1="__reactListeners$"+Nf$1,Rf$1="__reactHandles$"+Nf$1;function Wc$2(d){var g=d[Of$1];if(g)return g;for(var b=d.parentNode;b;){if(g=b[uf$2]||b[Of$1]){if(b=g.alternate,g.child!==null||b!==null&&b.child!==null)for(d=Mf$1(d);d!==null;){if(b=d[Of$1])return b;d=Mf$1(d)}return g}d=b,b=d.parentNode}return null}function Cb$1(d){return d=d[Of$1]||d[uf$2],!d||d.tag!==5&&d.tag!==6&&d.tag!==13&&d.tag!==3?null:d}function ue$1(d){if(d.tag===5||d.tag===6)return d.stateNode;throw Error(p$3(33))}function Db$1(d){return d[Pf$1]||null}var Sf$1=[],Tf$1=-1;function Uf$1(d){return{current:d}}function E$1(d){0>Tf$1||(d.current=Sf$1[Tf$1],Sf$1[Tf$1]=null,Tf$1--)}function G$2(d,g){Tf$1++,Sf$1[Tf$1]=d.current,d.current=g}var Vf$1={},H$2=Uf$1(Vf$1),Wf$1=Uf$1(!1),Xf$1=Vf$1;function Yf$1(d,g){var b=d.type.contextTypes;if(!b)return Vf$1;var et=d.stateNode;if(et&&et.__reactInternalMemoizedUnmaskedChildContext===g)return et.__reactInternalMemoizedMaskedChildContext;var st={},at;for(at in b)st[at]=g[at];return et&&(d=d.stateNode,d.__reactInternalMemoizedUnmaskedChildContext=g,d.__reactInternalMemoizedMaskedChildContext=st),st}function Zf$1(d){return d=d.childContextTypes,d!=null}function $f$1(){E$1(Wf$1),E$1(H$2)}function ag(d,g,b){if(H$2.current!==Vf$1)throw Error(p$3(168));G$2(H$2,g),G$2(Wf$1,b)}function bg$1(d,g,b){var et=d.stateNode;if(g=g.childContextTypes,typeof et.getChildContext!="function")return b;et=et.getChildContext();for(var st in et)if(!(st in g))throw Error(p$3(108,Ra(d)||"Unknown",st));return A({},b,et)}function cg$1(d){return d=(d=d.stateNode)&&d.__reactInternalMemoizedMergedChildContext||Vf$1,Xf$1=H$2.current,G$2(H$2,d),G$2(Wf$1,Wf$1.current),!0}function dg$1(d,g,b){var et=d.stateNode;if(!et)throw Error(p$3(169));b?(d=bg$1(d,g,Xf$1),et.__reactInternalMemoizedMergedChildContext=d,E$1(Wf$1),E$1(H$2),G$2(H$2,d)):E$1(Wf$1),G$2(Wf$1,b)}var eg=null,fg$1=!1,gg=!1;function hg$1(d){eg===null?eg=[d]:eg.push(d)}function ig$1(d){fg$1=!0,hg$1(d)}function jg(){if(!gg&&eg!==null){gg=!0;var d=0,g=C;try{var b=eg;for(C=1;d<b.length;d++){var et=b[d];do et=et(!0);while(et!==null)}eg=null,fg$1=!1}catch(st){throw eg!==null&&(eg=eg.slice(d+1)),ac$2(fc$2,jg),st}finally{C=g,gg=!1}}return null}var kg=[],lg$1=0,mg$1=null,ng$1=0,og$1=[],pg$1=0,qg=null,rg$1=1,sg$1="";function tg$1(d,g){kg[lg$1++]=ng$1,kg[lg$1++]=mg$1,mg$1=d,ng$1=g}function ug$1(d,g,b){og$1[pg$1++]=rg$1,og$1[pg$1++]=sg$1,og$1[pg$1++]=qg,qg=d;var et=rg$1;d=sg$1;var st=32-oc$2(et)-1;et&=~(1<<st),b+=1;var at=32-oc$2(g)+st;if(30<at){var vt=st-st%5;at=(et&(1<<vt)-1).toString(32),et>>=vt,st-=vt,rg$1=1<<32-oc$2(g)+st|b<<st|et,sg$1=at+d}else rg$1=1<<at|b<<st|et,sg$1=d}function vg$1(d){d.return!==null&&(tg$1(d,1),ug$1(d,1,0))}function wg$1(d){for(;d===mg$1;)mg$1=kg[--lg$1],kg[lg$1]=null,ng$1=kg[--lg$1],kg[lg$1]=null;for(;d===qg;)qg=og$1[--pg$1],og$1[pg$1]=null,sg$1=og$1[--pg$1],og$1[pg$1]=null,rg$1=og$1[--pg$1],og$1[pg$1]=null}var xg$1=null,yg=null,I=!1,zg=null;function Ag(d,g){var b=Bg(5,null,null,0);b.elementType="DELETED",b.stateNode=g,b.return=d,g=d.deletions,g===null?(d.deletions=[b],d.flags|=16):g.push(b)}function Cg(d,g){switch(d.tag){case 5:var b=d.type;return g=g.nodeType!==1||b.toLowerCase()!==g.nodeName.toLowerCase()?null:g,g!==null?(d.stateNode=g,xg$1=d,yg=Lf$1(g.firstChild),!0):!1;case 6:return g=d.pendingProps===""||g.nodeType!==3?null:g,g!==null?(d.stateNode=g,xg$1=d,yg=null,!0):!1;case 13:return g=g.nodeType!==8?null:g,g!==null?(b=qg!==null?{id:rg$1,overflow:sg$1}:null,d.memoizedState={dehydrated:g,treeContext:b,retryLane:1073741824},b=Bg(18,null,null,0),b.stateNode=g,b.return=d,d.child=b,xg$1=d,yg=null,!0):!1;default:return!1}}function Dg(d){return(d.mode&1)!==0&&(d.flags&128)===0}function Eg(d){if(I){var g=yg;if(g){var b=g;if(!Cg(d,g)){if(Dg(d))throw Error(p$3(418));g=Lf$1(b.nextSibling);var et=xg$1;g&&Cg(d,g)?Ag(et,b):(d.flags=d.flags&-4097|2,I=!1,xg$1=d)}}else{if(Dg(d))throw Error(p$3(418));d.flags=d.flags&-4097|2,I=!1,xg$1=d}}}function Fg(d){for(d=d.return;d!==null&&d.tag!==5&&d.tag!==3&&d.tag!==13;)d=d.return;xg$1=d}function Gg(d){if(d!==xg$1)return!1;if(!I)return Fg(d),I=!0,!1;var g;if((g=d.tag!==3)&&!(g=d.tag!==5)&&(g=d.type,g=g!=="head"&&g!=="body"&&!Ef$1(d.type,d.memoizedProps)),g&&(g=yg)){if(Dg(d))throw Hg(),Error(p$3(418));for(;g;)Ag(d,g),g=Lf$1(g.nextSibling)}if(Fg(d),d.tag===13){if(d=d.memoizedState,d=d!==null?d.dehydrated:null,!d)throw Error(p$3(317));e:{for(d=d.nextSibling,g=0;d;){if(d.nodeType===8){var b=d.data;if(b==="/$"){if(g===0){yg=Lf$1(d.nextSibling);break e}g--}else b!=="$"&&b!=="$!"&&b!=="$?"||g++}d=d.nextSibling}yg=null}}else yg=xg$1?Lf$1(d.stateNode.nextSibling):null;return!0}function Hg(){for(var d=yg;d;)d=Lf$1(d.nextSibling)}function Ig(){yg=xg$1=null,I=!1}function Jg(d){zg===null?zg=[d]:zg.push(d)}var Kg=ua$2.ReactCurrentBatchConfig;function Lg(d,g,b){if(d=b.ref,d!==null&&typeof d!="function"&&typeof d!="object"){if(b._owner){if(b=b._owner,b){if(b.tag!==1)throw Error(p$3(309));var et=b.stateNode}if(!et)throw Error(p$3(147,d));var st=et,at=""+d;return g!==null&&g.ref!==null&&typeof g.ref=="function"&&g.ref._stringRef===at?g.ref:(g=function(vt){var Tt=st.refs;vt===null?delete Tt[at]:Tt[at]=vt},g._stringRef=at,g)}if(typeof d!="string")throw Error(p$3(284));if(!b._owner)throw Error(p$3(290,d))}return d}function Mg(d,g){throw d=Object.prototype.toString.call(g),Error(p$3(31,d==="[object Object]"?"object with keys {"+Object.keys(g).join(", ")+"}":d))}function Ng(d){var g=d._init;return g(d._payload)}function Og(d){function g(qt,Kt){if(d){var rr=qt.deletions;rr===null?(qt.deletions=[Kt],qt.flags|=16):rr.push(Kt)}}function b(qt,Kt){if(!d)return null;for(;Kt!==null;)g(qt,Kt),Kt=Kt.sibling;return null}function et(qt,Kt){for(qt=new Map;Kt!==null;)Kt.key!==null?qt.set(Kt.key,Kt):qt.set(Kt.index,Kt),Kt=Kt.sibling;return qt}function st(qt,Kt){return qt=Pg(qt,Kt),qt.index=0,qt.sibling=null,qt}function at(qt,Kt,rr){return qt.index=rr,d?(rr=qt.alternate,rr!==null?(rr=rr.index,rr<Kt?(qt.flags|=2,Kt):rr):(qt.flags|=2,Kt)):(qt.flags|=1048576,Kt)}function vt(qt){return d&&qt.alternate===null&&(qt.flags|=2),qt}function Tt(qt,Kt,rr,ir){return Kt===null||Kt.tag!==6?(Kt=Qg(rr,qt.mode,ir),Kt.return=qt,Kt):(Kt=st(Kt,rr),Kt.return=qt,Kt)}function Ct(qt,Kt,rr,ir){var or=rr.type;return or===ya$1?wt(qt,Kt,rr.props.children,ir,rr.key):Kt!==null&&(Kt.elementType===or||typeof or=="object"&&or!==null&&or.$$typeof===Ha$2&&Ng(or)===Kt.type)?(ir=st(Kt,rr.props),ir.ref=Lg(qt,Kt,rr),ir.return=qt,ir):(ir=Rg(rr.type,rr.key,rr.props,null,qt.mode,ir),ir.ref=Lg(qt,Kt,rr),ir.return=qt,ir)}function pt(qt,Kt,rr,ir){return Kt===null||Kt.tag!==4||Kt.stateNode.containerInfo!==rr.containerInfo||Kt.stateNode.implementation!==rr.implementation?(Kt=Sg(rr,qt.mode,ir),Kt.return=qt,Kt):(Kt=st(Kt,rr.children||[]),Kt.return=qt,Kt)}function wt(qt,Kt,rr,ir,or){return Kt===null||Kt.tag!==7?(Kt=Tg$1(rr,qt.mode,ir,or),Kt.return=qt,Kt):(Kt=st(Kt,rr),Kt.return=qt,Kt)}function $t(qt,Kt,rr){if(typeof Kt=="string"&&Kt!==""||typeof Kt=="number")return Kt=Qg(""+Kt,qt.mode,rr),Kt.return=qt,Kt;if(typeof Kt=="object"&&Kt!==null){switch(Kt.$$typeof){case va$1:return rr=Rg(Kt.type,Kt.key,Kt.props,null,qt.mode,rr),rr.ref=Lg(qt,null,Kt),rr.return=qt,rr;case wa$1:return Kt=Sg(Kt,qt.mode,rr),Kt.return=qt,Kt;case Ha$2:var ir=Kt._init;return $t(qt,ir(Kt._payload),rr)}if(eb$1(Kt)||Ka$2(Kt))return Kt=Tg$1(Kt,qt.mode,rr,null),Kt.return=qt,Kt;Mg(qt,Kt)}return null}function Lt(qt,Kt,rr,ir){var or=Kt!==null?Kt.key:null;if(typeof rr=="string"&&rr!==""||typeof rr=="number")return or!==null?null:Tt(qt,Kt,""+rr,ir);if(typeof rr=="object"&&rr!==null){switch(rr.$$typeof){case va$1:return rr.key===or?Ct(qt,Kt,rr,ir):null;case wa$1:return rr.key===or?pt(qt,Kt,rr,ir):null;case Ha$2:return or=rr._init,Lt(qt,Kt,or(rr._payload),ir)}if(eb$1(rr)||Ka$2(rr))return or!==null?null:wt(qt,Kt,rr,ir,null);Mg(qt,rr)}return null}function jt(qt,Kt,rr,ir,or){if(typeof ir=="string"&&ir!==""||typeof ir=="number")return qt=qt.get(rr)||null,Tt(Kt,qt,""+ir,or);if(typeof ir=="object"&&ir!==null){switch(ir.$$typeof){case va$1:return qt=qt.get(ir.key===null?rr:ir.key)||null,Ct(Kt,qt,ir,or);case wa$1:return qt=qt.get(ir.key===null?rr:ir.key)||null,pt(Kt,qt,ir,or);case Ha$2:var jr=ir._init;return jt(qt,Kt,rr,jr(ir._payload),or)}if(eb$1(ir)||Ka$2(ir))return qt=qt.get(rr)||null,wt(Kt,qt,ir,or,null);Mg(Kt,ir)}return null}function Ft(qt,Kt,rr,ir){for(var or=null,jr=null,qr=Kt,Yr=Kt=0,vn=null;qr!==null&&Yr<rr.length;Yr++){qr.index>Yr?(vn=qr,qr=null):vn=qr.sibling;var ko=Lt(qt,qr,rr[Yr],ir);if(ko===null){qr===null&&(qr=vn);break}d&&qr&&ko.alternate===null&&g(qt,qr),Kt=at(ko,Kt,Yr),jr===null?or=ko:jr.sibling=ko,jr=ko,qr=vn}if(Yr===rr.length)return b(qt,qr),I&&tg$1(qt,Yr),or;if(qr===null){for(;Yr<rr.length;Yr++)qr=$t(qt,rr[Yr],ir),qr!==null&&(Kt=at(qr,Kt,Yr),jr===null?or=qr:jr.sibling=qr,jr=qr);return I&&tg$1(qt,Yr),or}for(qr=et(qt,qr);Yr<rr.length;Yr++)vn=jt(qr,qt,Yr,rr[Yr],ir),vn!==null&&(d&&vn.alternate!==null&&qr.delete(vn.key===null?Yr:vn.key),Kt=at(vn,Kt,Yr),jr===null?or=vn:jr.sibling=vn,jr=vn);return d&&qr.forEach(function(Xo){return g(qt,Xo)}),I&&tg$1(qt,Yr),or}function Gt(qt,Kt,rr,ir){var or=Ka$2(rr);if(typeof or!="function")throw Error(p$3(150));if(rr=or.call(rr),rr==null)throw Error(p$3(151));for(var jr=or=null,qr=Kt,Yr=Kt=0,vn=null,ko=rr.next();qr!==null&&!ko.done;Yr++,ko=rr.next()){qr.index>Yr?(vn=qr,qr=null):vn=qr.sibling;var Xo=Lt(qt,qr,ko.value,ir);if(Xo===null){qr===null&&(qr=vn);break}d&&qr&&Xo.alternate===null&&g(qt,qr),Kt=at(Xo,Kt,Yr),jr===null?or=Xo:jr.sibling=Xo,jr=Xo,qr=vn}if(ko.done)return b(qt,qr),I&&tg$1(qt,Yr),or;if(qr===null){for(;!ko.done;Yr++,ko=rr.next())ko=$t(qt,ko.value,ir),ko!==null&&(Kt=at(ko,Kt,Yr),jr===null?or=ko:jr.sibling=ko,jr=ko);return I&&tg$1(qt,Yr),or}for(qr=et(qt,qr);!ko.done;Yr++,ko=rr.next())ko=jt(qr,qt,Yr,ko.value,ir),ko!==null&&(d&&ko.alternate!==null&&qr.delete(ko.key===null?Yr:ko.key),Kt=at(ko,Kt,Yr),jr===null?or=ko:jr.sibling=ko,jr=ko);return d&&qr.forEach(function(zo){return g(qt,zo)}),I&&tg$1(qt,Yr),or}function Ht(qt,Kt,rr,ir){if(typeof rr=="object"&&rr!==null&&rr.type===ya$1&&rr.key===null&&(rr=rr.props.children),typeof rr=="object"&&rr!==null){switch(rr.$$typeof){case va$1:e:{for(var or=rr.key,jr=Kt;jr!==null;){if(jr.key===or){if(or=rr.type,or===ya$1){if(jr.tag===7){b(qt,jr.sibling),Kt=st(jr,rr.props.children),Kt.return=qt,qt=Kt;break e}}else if(jr.elementType===or||typeof or=="object"&&or!==null&&or.$$typeof===Ha$2&&Ng(or)===jr.type){b(qt,jr.sibling),Kt=st(jr,rr.props),Kt.ref=Lg(qt,jr,rr),Kt.return=qt,qt=Kt;break e}b(qt,jr);break}else g(qt,jr);jr=jr.sibling}rr.type===ya$1?(Kt=Tg$1(rr.props.children,qt.mode,ir,rr.key),Kt.return=qt,qt=Kt):(ir=Rg(rr.type,rr.key,rr.props,null,qt.mode,ir),ir.ref=Lg(qt,Kt,rr),ir.return=qt,qt=ir)}return vt(qt);case wa$1:e:{for(jr=rr.key;Kt!==null;){if(Kt.key===jr)if(Kt.tag===4&&Kt.stateNode.containerInfo===rr.containerInfo&&Kt.stateNode.implementation===rr.implementation){b(qt,Kt.sibling),Kt=st(Kt,rr.children||[]),Kt.return=qt,qt=Kt;break e}else{b(qt,Kt);break}else g(qt,Kt);Kt=Kt.sibling}Kt=Sg(rr,qt.mode,ir),Kt.return=qt,qt=Kt}return vt(qt);case Ha$2:return jr=rr._init,Ht(qt,Kt,jr(rr._payload),ir)}if(eb$1(rr))return Ft(qt,Kt,rr,ir);if(Ka$2(rr))return Gt(qt,Kt,rr,ir);Mg(qt,rr)}return typeof rr=="string"&&rr!==""||typeof rr=="number"?(rr=""+rr,Kt!==null&&Kt.tag===6?(b(qt,Kt.sibling),Kt=st(Kt,rr),Kt.return=qt,qt=Kt):(b(qt,Kt),Kt=Qg(rr,qt.mode,ir),Kt.return=qt,qt=Kt),vt(qt)):b(qt,Kt)}return Ht}var Ug=Og(!0),Vg=Og(!1),Wg=Uf$1(null),Xg=null,Yg=null,Zg=null;function $g(){Zg=Yg=Xg=null}function ah(d){var g=Wg.current;E$1(Wg),d._currentValue=g}function bh$1(d,g,b){for(;d!==null;){var et=d.alternate;if((d.childLanes&g)!==g?(d.childLanes|=g,et!==null&&(et.childLanes|=g)):et!==null&&(et.childLanes&g)!==g&&(et.childLanes|=g),d===b)break;d=d.return}}function ch$1(d,g){Xg=d,Zg=Yg=null,d=d.dependencies,d!==null&&d.firstContext!==null&&(d.lanes&g&&(dh$1=!0),d.firstContext=null)}function eh$1(d){var g=d._currentValue;if(Zg!==d)if(d={context:d,memoizedValue:g,next:null},Yg===null){if(Xg===null)throw Error(p$3(308));Yg=d,Xg.dependencies={lanes:0,firstContext:d}}else Yg=Yg.next=d;return g}var fh=null;function gh$1(d){fh===null?fh=[d]:fh.push(d)}function hh$1(d,g,b,et){var st=g.interleaved;return st===null?(b.next=b,gh$1(g)):(b.next=st.next,st.next=b),g.interleaved=b,ih$1(d,et)}function ih$1(d,g){d.lanes|=g;var b=d.alternate;for(b!==null&&(b.lanes|=g),b=d,d=d.return;d!==null;)d.childLanes|=g,b=d.alternate,b!==null&&(b.childLanes|=g),b=d,d=d.return;return b.tag===3?b.stateNode:null}var jh$1=!1;function kh$1(d){d.updateQueue={baseState:d.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function lh$1(d,g){d=d.updateQueue,g.updateQueue===d&&(g.updateQueue={baseState:d.baseState,firstBaseUpdate:d.firstBaseUpdate,lastBaseUpdate:d.lastBaseUpdate,shared:d.shared,effects:d.effects})}function mh$1(d,g){return{eventTime:d,lane:g,tag:0,payload:null,callback:null,next:null}}function nh$1(d,g,b){var et=d.updateQueue;if(et===null)return null;if(et=et.shared,K$2&2){var st=et.pending;return st===null?g.next=g:(g.next=st.next,st.next=g),et.pending=g,ih$1(d,b)}return st=et.interleaved,st===null?(g.next=g,gh$1(et)):(g.next=st.next,st.next=g),et.interleaved=g,ih$1(d,b)}function oh$1(d,g,b){if(g=g.updateQueue,g!==null&&(g=g.shared,(b&4194240)!==0)){var et=g.lanes;et&=d.pendingLanes,b|=et,g.lanes=b,Cc$2(d,b)}}function ph$1(d,g){var b=d.updateQueue,et=d.alternate;if(et!==null&&(et=et.updateQueue,b===et)){var st=null,at=null;if(b=b.firstBaseUpdate,b!==null){do{var vt={eventTime:b.eventTime,lane:b.lane,tag:b.tag,payload:b.payload,callback:b.callback,next:null};at===null?st=at=vt:at=at.next=vt,b=b.next}while(b!==null);at===null?st=at=g:at=at.next=g}else st=at=g;b={baseState:et.baseState,firstBaseUpdate:st,lastBaseUpdate:at,shared:et.shared,effects:et.effects},d.updateQueue=b;return}d=b.lastBaseUpdate,d===null?b.firstBaseUpdate=g:d.next=g,b.lastBaseUpdate=g}function qh$1(d,g,b,et){var st=d.updateQueue;jh$1=!1;var at=st.firstBaseUpdate,vt=st.lastBaseUpdate,Tt=st.shared.pending;if(Tt!==null){st.shared.pending=null;var Ct=Tt,pt=Ct.next;Ct.next=null,vt===null?at=pt:vt.next=pt,vt=Ct;var wt=d.alternate;wt!==null&&(wt=wt.updateQueue,Tt=wt.lastBaseUpdate,Tt!==vt&&(Tt===null?wt.firstBaseUpdate=pt:Tt.next=pt,wt.lastBaseUpdate=Ct))}if(at!==null){var $t=st.baseState;vt=0,wt=pt=Ct=null,Tt=at;do{var Lt=Tt.lane,jt=Tt.eventTime;if((et&Lt)===Lt){wt!==null&&(wt=wt.next={eventTime:jt,lane:0,tag:Tt.tag,payload:Tt.payload,callback:Tt.callback,next:null});e:{var Ft=d,Gt=Tt;switch(Lt=g,jt=b,Gt.tag){case 1:if(Ft=Gt.payload,typeof Ft=="function"){$t=Ft.call(jt,$t,Lt);break e}$t=Ft;break e;case 3:Ft.flags=Ft.flags&-65537|128;case 0:if(Ft=Gt.payload,Lt=typeof Ft=="function"?Ft.call(jt,$t,Lt):Ft,Lt==null)break e;$t=A({},$t,Lt);break e;case 2:jh$1=!0}}Tt.callback!==null&&Tt.lane!==0&&(d.flags|=64,Lt=st.effects,Lt===null?st.effects=[Tt]:Lt.push(Tt))}else jt={eventTime:jt,lane:Lt,tag:Tt.tag,payload:Tt.payload,callback:Tt.callback,next:null},wt===null?(pt=wt=jt,Ct=$t):wt=wt.next=jt,vt|=Lt;if(Tt=Tt.next,Tt===null){if(Tt=st.shared.pending,Tt===null)break;Lt=Tt,Tt=Lt.next,Lt.next=null,st.lastBaseUpdate=Lt,st.shared.pending=null}}while(!0);if(wt===null&&(Ct=$t),st.baseState=Ct,st.firstBaseUpdate=pt,st.lastBaseUpdate=wt,g=st.shared.interleaved,g!==null){st=g;do vt|=st.lane,st=st.next;while(st!==g)}else at===null&&(st.shared.lanes=0);rh$1|=vt,d.lanes=vt,d.memoizedState=$t}}function sh$1(d,g,b){if(d=g.effects,g.effects=null,d!==null)for(g=0;g<d.length;g++){var et=d[g],st=et.callback;if(st!==null){if(et.callback=null,et=b,typeof st!="function")throw Error(p$3(191,st));st.call(et)}}}var th$1={},uh$1=Uf$1(th$1),vh$1=Uf$1(th$1),wh$1=Uf$1(th$1);function xh$1(d){if(d===th$1)throw Error(p$3(174));return d}function yh$1(d,g){switch(G$2(wh$1,g),G$2(vh$1,d),G$2(uh$1,th$1),d=g.nodeType,d){case 9:case 11:g=(g=g.documentElement)?g.namespaceURI:lb$1(null,"");break;default:d=d===8?g.parentNode:g,g=d.namespaceURI||null,d=d.tagName,g=lb$1(g,d)}E$1(uh$1),G$2(uh$1,g)}function zh$1(){E$1(uh$1),E$1(vh$1),E$1(wh$1)}function Ah$1(d){xh$1(wh$1.current);var g=xh$1(uh$1.current),b=lb$1(g,d.type);g!==b&&(G$2(vh$1,d),G$2(uh$1,b))}function Bh$1(d){vh$1.current===d&&(E$1(uh$1),E$1(vh$1))}var L$2=Uf$1(0);function Ch$1(d){for(var g=d;g!==null;){if(g.tag===13){var b=g.memoizedState;if(b!==null&&(b=b.dehydrated,b===null||b.data==="$?"||b.data==="$!"))return g}else if(g.tag===19&&g.memoizedProps.revealOrder!==void 0){if(g.flags&128)return g}else if(g.child!==null){g.child.return=g,g=g.child;continue}if(g===d)break;for(;g.sibling===null;){if(g.return===null||g.return===d)return null;g=g.return}g.sibling.return=g.return,g=g.sibling}return null}var Dh$1=[];function Eh$1(){for(var d=0;d<Dh$1.length;d++)Dh$1[d]._workInProgressVersionPrimary=null;Dh$1.length=0}var Fh$1=ua$2.ReactCurrentDispatcher,Gh$1=ua$2.ReactCurrentBatchConfig,Hh$1=0,M$3=null,N$2=null,O$1=null,Ih=!1,Jh$1=!1,Kh$1=0,Lh$1=0;function P$1(){throw Error(p$3(321))}function Mh$1(d,g){if(g===null)return!1;for(var b=0;b<g.length&&b<d.length;b++)if(!He$1(d[b],g[b]))return!1;return!0}function Nh$1(d,g,b,et,st,at){if(Hh$1=at,M$3=g,g.memoizedState=null,g.updateQueue=null,g.lanes=0,Fh$1.current=d===null||d.memoizedState===null?Oh$1:Ph$1,d=b(et,st),Jh$1){at=0;do{if(Jh$1=!1,Kh$1=0,25<=at)throw Error(p$3(301));at+=1,O$1=N$2=null,g.updateQueue=null,Fh$1.current=Qh$1,d=b(et,st)}while(Jh$1)}if(Fh$1.current=Rh$1,g=N$2!==null&&N$2.next!==null,Hh$1=0,O$1=N$2=M$3=null,Ih=!1,g)throw Error(p$3(300));return d}function Sh$1(){var d=Kh$1!==0;return Kh$1=0,d}function Th$1(){var d={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return O$1===null?M$3.memoizedState=O$1=d:O$1=O$1.next=d,O$1}function Uh$1(){if(N$2===null){var d=M$3.alternate;d=d!==null?d.memoizedState:null}else d=N$2.next;var g=O$1===null?M$3.memoizedState:O$1.next;if(g!==null)O$1=g,N$2=d;else{if(d===null)throw Error(p$3(310));N$2=d,d={memoizedState:N$2.memoizedState,baseState:N$2.baseState,baseQueue:N$2.baseQueue,queue:N$2.queue,next:null},O$1===null?M$3.memoizedState=O$1=d:O$1=O$1.next=d}return O$1}function Vh$1(d,g){return typeof g=="function"?g(d):g}function Wh$1(d){var g=Uh$1(),b=g.queue;if(b===null)throw Error(p$3(311));b.lastRenderedReducer=d;var et=N$2,st=et.baseQueue,at=b.pending;if(at!==null){if(st!==null){var vt=st.next;st.next=at.next,at.next=vt}et.baseQueue=st=at,b.pending=null}if(st!==null){at=st.next,et=et.baseState;var Tt=vt=null,Ct=null,pt=at;do{var wt=pt.lane;if((Hh$1&wt)===wt)Ct!==null&&(Ct=Ct.next={lane:0,action:pt.action,hasEagerState:pt.hasEagerState,eagerState:pt.eagerState,next:null}),et=pt.hasEagerState?pt.eagerState:d(et,pt.action);else{var $t={lane:wt,action:pt.action,hasEagerState:pt.hasEagerState,eagerState:pt.eagerState,next:null};Ct===null?(Tt=Ct=$t,vt=et):Ct=Ct.next=$t,M$3.lanes|=wt,rh$1|=wt}pt=pt.next}while(pt!==null&&pt!==at);Ct===null?vt=et:Ct.next=Tt,He$1(et,g.memoizedState)||(dh$1=!0),g.memoizedState=et,g.baseState=vt,g.baseQueue=Ct,b.lastRenderedState=et}if(d=b.interleaved,d!==null){st=d;do at=st.lane,M$3.lanes|=at,rh$1|=at,st=st.next;while(st!==d)}else st===null&&(b.lanes=0);return[g.memoizedState,b.dispatch]}function Xh$1(d){var g=Uh$1(),b=g.queue;if(b===null)throw Error(p$3(311));b.lastRenderedReducer=d;var et=b.dispatch,st=b.pending,at=g.memoizedState;if(st!==null){b.pending=null;var vt=st=st.next;do at=d(at,vt.action),vt=vt.next;while(vt!==st);He$1(at,g.memoizedState)||(dh$1=!0),g.memoizedState=at,g.baseQueue===null&&(g.baseState=at),b.lastRenderedState=at}return[at,et]}function Yh$1(){}function Zh$1(d,g){var b=M$3,et=Uh$1(),st=g(),at=!He$1(et.memoizedState,st);if(at&&(et.memoizedState=st,dh$1=!0),et=et.queue,$h$1(ai$1.bind(null,b,et,d),[d]),et.getSnapshot!==g||at||O$1!==null&&O$1.memoizedState.tag&1){if(b.flags|=2048,bi$1(9,ci$1.bind(null,b,et,st,g),void 0,null),Q$3===null)throw Error(p$3(349));Hh$1&30||di$2(b,g,st)}return st}function di$2(d,g,b){d.flags|=16384,d={getSnapshot:g,value:b},g=M$3.updateQueue,g===null?(g={lastEffect:null,stores:null},M$3.updateQueue=g,g.stores=[d]):(b=g.stores,b===null?g.stores=[d]:b.push(d))}function ci$1(d,g,b,et){g.value=b,g.getSnapshot=et,ei$1(g)&&fi$2(d)}function ai$1(d,g,b){return b(function(){ei$1(g)&&fi$2(d)})}function ei$1(d){var g=d.getSnapshot;d=d.value;try{var b=g();return!He$1(d,b)}catch{return!0}}function fi$2(d){var g=ih$1(d,1);g!==null&&gi$1(g,d,1,-1)}function hi$2(d){var g=Th$1();return typeof d=="function"&&(d=d()),g.memoizedState=g.baseState=d,d={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Vh$1,lastRenderedState:d},g.queue=d,d=d.dispatch=ii$1.bind(null,M$3,d),[g.memoizedState,d]}function bi$1(d,g,b,et){return d={tag:d,create:g,destroy:b,deps:et,next:null},g=M$3.updateQueue,g===null?(g={lastEffect:null,stores:null},M$3.updateQueue=g,g.lastEffect=d.next=d):(b=g.lastEffect,b===null?g.lastEffect=d.next=d:(et=b.next,b.next=d,d.next=et,g.lastEffect=d)),d}function ji$2(){return Uh$1().memoizedState}function ki$1(d,g,b,et){var st=Th$1();M$3.flags|=d,st.memoizedState=bi$1(1|g,b,void 0,et===void 0?null:et)}function li$1(d,g,b,et){var st=Uh$1();et=et===void 0?null:et;var at=void 0;if(N$2!==null){var vt=N$2.memoizedState;if(at=vt.destroy,et!==null&&Mh$1(et,vt.deps)){st.memoizedState=bi$1(g,b,at,et);return}}M$3.flags|=d,st.memoizedState=bi$1(1|g,b,at,et)}function mi$2(d,g){return ki$1(8390656,8,d,g)}function $h$1(d,g){return li$1(2048,8,d,g)}function ni$1(d,g){return li$1(4,2,d,g)}function oi$1(d,g){return li$1(4,4,d,g)}function pi$2(d,g){if(typeof g=="function")return d=d(),g(d),function(){g(null)};if(g!=null)return d=d(),g.current=d,function(){g.current=null}}function qi$2(d,g,b){return b=b!=null?b.concat([d]):null,li$1(4,4,pi$2.bind(null,g,d),b)}function ri$1(){}function si$2(d,g){var b=Uh$1();g=g===void 0?null:g;var et=b.memoizedState;return et!==null&&g!==null&&Mh$1(g,et[1])?et[0]:(b.memoizedState=[d,g],d)}function ti$1(d,g){var b=Uh$1();g=g===void 0?null:g;var et=b.memoizedState;return et!==null&&g!==null&&Mh$1(g,et[1])?et[0]:(d=d(),b.memoizedState=[d,g],d)}function ui$1(d,g,b){return Hh$1&21?(He$1(b,g)||(b=yc$2(),M$3.lanes|=b,rh$1|=b,d.baseState=!0),g):(d.baseState&&(d.baseState=!1,dh$1=!0),d.memoizedState=b)}function vi$1(d,g){var b=C;C=b!==0&&4>b?b:4,d(!0);var et=Gh$1.transition;Gh$1.transition={};try{d(!1),g()}finally{C=b,Gh$1.transition=et}}function wi$1(){return Uh$1().memoizedState}function xi$1(d,g,b){var et=yi$1(d);if(b={lane:et,action:b,hasEagerState:!1,eagerState:null,next:null},zi$2(d))Ai$1(g,b);else if(b=hh$1(d,g,b,et),b!==null){var st=R$1();gi$1(b,d,et,st),Bi$2(b,g,et)}}function ii$1(d,g,b){var et=yi$1(d),st={lane:et,action:b,hasEagerState:!1,eagerState:null,next:null};if(zi$2(d))Ai$1(g,st);else{var at=d.alternate;if(d.lanes===0&&(at===null||at.lanes===0)&&(at=g.lastRenderedReducer,at!==null))try{var vt=g.lastRenderedState,Tt=at(vt,b);if(st.hasEagerState=!0,st.eagerState=Tt,He$1(Tt,vt)){var Ct=g.interleaved;Ct===null?(st.next=st,gh$1(g)):(st.next=Ct.next,Ct.next=st),g.interleaved=st;return}}catch{}finally{}b=hh$1(d,g,st,et),b!==null&&(st=R$1(),gi$1(b,d,et,st),Bi$2(b,g,et))}}function zi$2(d){var g=d.alternate;return d===M$3||g!==null&&g===M$3}function Ai$1(d,g){Jh$1=Ih=!0;var b=d.pending;b===null?g.next=g:(g.next=b.next,b.next=g),d.pending=g}function Bi$2(d,g,b){if(b&4194240){var et=g.lanes;et&=d.pendingLanes,b|=et,g.lanes=b,Cc$2(d,b)}}var Rh$1={readContext:eh$1,useCallback:P$1,useContext:P$1,useEffect:P$1,useImperativeHandle:P$1,useInsertionEffect:P$1,useLayoutEffect:P$1,useMemo:P$1,useReducer:P$1,useRef:P$1,useState:P$1,useDebugValue:P$1,useDeferredValue:P$1,useTransition:P$1,useMutableSource:P$1,useSyncExternalStore:P$1,useId:P$1,unstable_isNewReconciler:!1},Oh$1={readContext:eh$1,useCallback:function(d,g){return Th$1().memoizedState=[d,g===void 0?null:g],d},useContext:eh$1,useEffect:mi$2,useImperativeHandle:function(d,g,b){return b=b!=null?b.concat([d]):null,ki$1(4194308,4,pi$2.bind(null,g,d),b)},useLayoutEffect:function(d,g){return ki$1(4194308,4,d,g)},useInsertionEffect:function(d,g){return ki$1(4,2,d,g)},useMemo:function(d,g){var b=Th$1();return g=g===void 0?null:g,d=d(),b.memoizedState=[d,g],d},useReducer:function(d,g,b){var et=Th$1();return g=b!==void 0?b(g):g,et.memoizedState=et.baseState=g,d={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:d,lastRenderedState:g},et.queue=d,d=d.dispatch=xi$1.bind(null,M$3,d),[et.memoizedState,d]},useRef:function(d){var g=Th$1();return d={current:d},g.memoizedState=d},useState:hi$2,useDebugValue:ri$1,useDeferredValue:function(d){return Th$1().memoizedState=d},useTransition:function(){var d=hi$2(!1),g=d[0];return d=vi$1.bind(null,d[1]),Th$1().memoizedState=d,[g,d]},useMutableSource:function(){},useSyncExternalStore:function(d,g,b){var et=M$3,st=Th$1();if(I){if(b===void 0)throw Error(p$3(407));b=b()}else{if(b=g(),Q$3===null)throw Error(p$3(349));Hh$1&30||di$2(et,g,b)}st.memoizedState=b;var at={value:b,getSnapshot:g};return st.queue=at,mi$2(ai$1.bind(null,et,at,d),[d]),et.flags|=2048,bi$1(9,ci$1.bind(null,et,at,b,g),void 0,null),b},useId:function(){var d=Th$1(),g=Q$3.identifierPrefix;if(I){var b=sg$1,et=rg$1;b=(et&~(1<<32-oc$2(et)-1)).toString(32)+b,g=":"+g+"R"+b,b=Kh$1++,0<b&&(g+="H"+b.toString(32)),g+=":"}else b=Lh$1++,g=":"+g+"r"+b.toString(32)+":";return d.memoizedState=g},unstable_isNewReconciler:!1},Ph$1={readContext:eh$1,useCallback:si$2,useContext:eh$1,useEffect:$h$1,useImperativeHandle:qi$2,useInsertionEffect:ni$1,useLayoutEffect:oi$1,useMemo:ti$1,useReducer:Wh$1,useRef:ji$2,useState:function(){return Wh$1(Vh$1)},useDebugValue:ri$1,useDeferredValue:function(d){var g=Uh$1();return ui$1(g,N$2.memoizedState,d)},useTransition:function(){var d=Wh$1(Vh$1)[0],g=Uh$1().memoizedState;return[d,g]},useMutableSource:Yh$1,useSyncExternalStore:Zh$1,useId:wi$1,unstable_isNewReconciler:!1},Qh$1={readContext:eh$1,useCallback:si$2,useContext:eh$1,useEffect:$h$1,useImperativeHandle:qi$2,useInsertionEffect:ni$1,useLayoutEffect:oi$1,useMemo:ti$1,useReducer:Xh$1,useRef:ji$2,useState:function(){return Xh$1(Vh$1)},useDebugValue:ri$1,useDeferredValue:function(d){var g=Uh$1();return N$2===null?g.memoizedState=d:ui$1(g,N$2.memoizedState,d)},useTransition:function(){var d=Xh$1(Vh$1)[0],g=Uh$1().memoizedState;return[d,g]},useMutableSource:Yh$1,useSyncExternalStore:Zh$1,useId:wi$1,unstable_isNewReconciler:!1};function Ci$1(d,g){if(d&&d.defaultProps){g=A({},g),d=d.defaultProps;for(var b in d)g[b]===void 0&&(g[b]=d[b]);return g}return g}function Di$2(d,g,b,et){g=d.memoizedState,b=b(et,g),b=b==null?g:A({},g,b),d.memoizedState=b,d.lanes===0&&(d.updateQueue.baseState=b)}var Ei$1={isMounted:function(d){return(d=d._reactInternals)?Vb$1(d)===d:!1},enqueueSetState:function(d,g,b){d=d._reactInternals;var et=R$1(),st=yi$1(d),at=mh$1(et,st);at.payload=g,b!=null&&(at.callback=b),g=nh$1(d,at,st),g!==null&&(gi$1(g,d,st,et),oh$1(g,d,st))},enqueueReplaceState:function(d,g,b){d=d._reactInternals;var et=R$1(),st=yi$1(d),at=mh$1(et,st);at.tag=1,at.payload=g,b!=null&&(at.callback=b),g=nh$1(d,at,st),g!==null&&(gi$1(g,d,st,et),oh$1(g,d,st))},enqueueForceUpdate:function(d,g){d=d._reactInternals;var b=R$1(),et=yi$1(d),st=mh$1(b,et);st.tag=2,g!=null&&(st.callback=g),g=nh$1(d,st,et),g!==null&&(gi$1(g,d,et,b),oh$1(g,d,et))}};function Fi$2(d,g,b,et,st,at,vt){return d=d.stateNode,typeof d.shouldComponentUpdate=="function"?d.shouldComponentUpdate(et,at,vt):g.prototype&&g.prototype.isPureReactComponent?!Ie$1(b,et)||!Ie$1(st,at):!0}function Gi$2(d,g,b){var et=!1,st=Vf$1,at=g.contextType;return typeof at=="object"&&at!==null?at=eh$1(at):(st=Zf$1(g)?Xf$1:H$2.current,et=g.contextTypes,at=(et=et!=null)?Yf$1(d,st):Vf$1),g=new g(b,at),d.memoizedState=g.state!==null&&g.state!==void 0?g.state:null,g.updater=Ei$1,d.stateNode=g,g._reactInternals=d,et&&(d=d.stateNode,d.__reactInternalMemoizedUnmaskedChildContext=st,d.__reactInternalMemoizedMaskedChildContext=at),g}function Hi$2(d,g,b,et){d=g.state,typeof g.componentWillReceiveProps=="function"&&g.componentWillReceiveProps(b,et),typeof g.UNSAFE_componentWillReceiveProps=="function"&&g.UNSAFE_componentWillReceiveProps(b,et),g.state!==d&&Ei$1.enqueueReplaceState(g,g.state,null)}function Ii$1(d,g,b,et){var st=d.stateNode;st.props=b,st.state=d.memoizedState,st.refs={},kh$1(d);var at=g.contextType;typeof at=="object"&&at!==null?st.context=eh$1(at):(at=Zf$1(g)?Xf$1:H$2.current,st.context=Yf$1(d,at)),st.state=d.memoizedState,at=g.getDerivedStateFromProps,typeof at=="function"&&(Di$2(d,g,at,b),st.state=d.memoizedState),typeof g.getDerivedStateFromProps=="function"||typeof st.getSnapshotBeforeUpdate=="function"||typeof st.UNSAFE_componentWillMount!="function"&&typeof st.componentWillMount!="function"||(g=st.state,typeof st.componentWillMount=="function"&&st.componentWillMount(),typeof st.UNSAFE_componentWillMount=="function"&&st.UNSAFE_componentWillMount(),g!==st.state&&Ei$1.enqueueReplaceState(st,st.state,null),qh$1(d,b,st,et),st.state=d.memoizedState),typeof st.componentDidMount=="function"&&(d.flags|=4194308)}function Ji$2(d,g){try{var b="",et=g;do b+=Pa(et),et=et.return;while(et);var st=b}catch(at){st=`
Error generating stack: `+at.message+`
`+at.stack}return{value:d,source:g,stack:st,digest:null}}function Ki$2(d,g,b){return{value:d,source:null,stack:b??null,digest:g??null}}function Li$2(d,g){try{console.error(g.value)}catch(b){setTimeout(function(){throw b})}}var Mi$2=typeof WeakMap=="function"?WeakMap:Map;function Ni$1(d,g,b){b=mh$1(-1,b),b.tag=3,b.payload={element:null};var et=g.value;return b.callback=function(){Oi$2||(Oi$2=!0,Pi$2=et),Li$2(d,g)},b}function Qi$2(d,g,b){b=mh$1(-1,b),b.tag=3;var et=d.type.getDerivedStateFromError;if(typeof et=="function"){var st=g.value;b.payload=function(){return et(st)},b.callback=function(){Li$2(d,g)}}var at=d.stateNode;return at!==null&&typeof at.componentDidCatch=="function"&&(b.callback=function(){Li$2(d,g),typeof et!="function"&&(Ri$2===null?Ri$2=new Set([this]):Ri$2.add(this));var vt=g.stack;this.componentDidCatch(g.value,{componentStack:vt!==null?vt:""})}),b}function Si$1(d,g,b){var et=d.pingCache;if(et===null){et=d.pingCache=new Mi$2;var st=new Set;et.set(g,st)}else st=et.get(g),st===void 0&&(st=new Set,et.set(g,st));st.has(b)||(st.add(b),d=Ti$1.bind(null,d,g,b),g.then(d,d))}function Ui$2(d){do{var g;if((g=d.tag===13)&&(g=d.memoizedState,g=g!==null?g.dehydrated!==null:!0),g)return d;d=d.return}while(d!==null);return null}function Vi$1(d,g,b,et,st){return d.mode&1?(d.flags|=65536,d.lanes=st,d):(d===g?d.flags|=65536:(d.flags|=128,b.flags|=131072,b.flags&=-52805,b.tag===1&&(b.alternate===null?b.tag=17:(g=mh$1(-1,1),g.tag=2,nh$1(b,g,1))),b.lanes|=1),d)}var Wi$2=ua$2.ReactCurrentOwner,dh$1=!1;function Xi$2(d,g,b,et){g.child=d===null?Vg(g,null,b,et):Ug(g,d.child,b,et)}function Yi$2(d,g,b,et,st){b=b.render;var at=g.ref;return ch$1(g,st),et=Nh$1(d,g,b,et,at,st),b=Sh$1(),d!==null&&!dh$1?(g.updateQueue=d.updateQueue,g.flags&=-2053,d.lanes&=~st,Zi$2(d,g,st)):(I&&b&&vg$1(g),g.flags|=1,Xi$2(d,g,et,st),g.child)}function $i$1(d,g,b,et,st){if(d===null){var at=b.type;return typeof at=="function"&&!aj(at)&&at.defaultProps===void 0&&b.compare===null&&b.defaultProps===void 0?(g.tag=15,g.type=at,bj(d,g,at,et,st)):(d=Rg(b.type,null,et,g,g.mode,st),d.ref=g.ref,d.return=g,g.child=d)}if(at=d.child,!(d.lanes&st)){var vt=at.memoizedProps;if(b=b.compare,b=b!==null?b:Ie$1,b(vt,et)&&d.ref===g.ref)return Zi$2(d,g,st)}return g.flags|=1,d=Pg(at,et),d.ref=g.ref,d.return=g,g.child=d}function bj(d,g,b,et,st){if(d!==null){var at=d.memoizedProps;if(Ie$1(at,et)&&d.ref===g.ref)if(dh$1=!1,g.pendingProps=et=at,(d.lanes&st)!==0)d.flags&131072&&(dh$1=!0);else return g.lanes=d.lanes,Zi$2(d,g,st)}return cj(d,g,b,et,st)}function dj(d,g,b){var et=g.pendingProps,st=et.children,at=d!==null?d.memoizedState:null;if(et.mode==="hidden")if(!(g.mode&1))g.memoizedState={baseLanes:0,cachePool:null,transitions:null},G$2(ej,fj),fj|=b;else{if(!(b&1073741824))return d=at!==null?at.baseLanes|b:b,g.lanes=g.childLanes=1073741824,g.memoizedState={baseLanes:d,cachePool:null,transitions:null},g.updateQueue=null,G$2(ej,fj),fj|=d,null;g.memoizedState={baseLanes:0,cachePool:null,transitions:null},et=at!==null?at.baseLanes:b,G$2(ej,fj),fj|=et}else at!==null?(et=at.baseLanes|b,g.memoizedState=null):et=b,G$2(ej,fj),fj|=et;return Xi$2(d,g,st,b),g.child}function gj(d,g){var b=g.ref;(d===null&&b!==null||d!==null&&d.ref!==b)&&(g.flags|=512,g.flags|=2097152)}function cj(d,g,b,et,st){var at=Zf$1(b)?Xf$1:H$2.current;return at=Yf$1(g,at),ch$1(g,st),b=Nh$1(d,g,b,et,at,st),et=Sh$1(),d!==null&&!dh$1?(g.updateQueue=d.updateQueue,g.flags&=-2053,d.lanes&=~st,Zi$2(d,g,st)):(I&&et&&vg$1(g),g.flags|=1,Xi$2(d,g,b,st),g.child)}function hj(d,g,b,et,st){if(Zf$1(b)){var at=!0;cg$1(g)}else at=!1;if(ch$1(g,st),g.stateNode===null)ij(d,g),Gi$2(g,b,et),Ii$1(g,b,et,st),et=!0;else if(d===null){var vt=g.stateNode,Tt=g.memoizedProps;vt.props=Tt;var Ct=vt.context,pt=b.contextType;typeof pt=="object"&&pt!==null?pt=eh$1(pt):(pt=Zf$1(b)?Xf$1:H$2.current,pt=Yf$1(g,pt));var wt=b.getDerivedStateFromProps,$t=typeof wt=="function"||typeof vt.getSnapshotBeforeUpdate=="function";$t||typeof vt.UNSAFE_componentWillReceiveProps!="function"&&typeof vt.componentWillReceiveProps!="function"||(Tt!==et||Ct!==pt)&&Hi$2(g,vt,et,pt),jh$1=!1;var Lt=g.memoizedState;vt.state=Lt,qh$1(g,et,vt,st),Ct=g.memoizedState,Tt!==et||Lt!==Ct||Wf$1.current||jh$1?(typeof wt=="function"&&(Di$2(g,b,wt,et),Ct=g.memoizedState),(Tt=jh$1||Fi$2(g,b,Tt,et,Lt,Ct,pt))?($t||typeof vt.UNSAFE_componentWillMount!="function"&&typeof vt.componentWillMount!="function"||(typeof vt.componentWillMount=="function"&&vt.componentWillMount(),typeof vt.UNSAFE_componentWillMount=="function"&&vt.UNSAFE_componentWillMount()),typeof vt.componentDidMount=="function"&&(g.flags|=4194308)):(typeof vt.componentDidMount=="function"&&(g.flags|=4194308),g.memoizedProps=et,g.memoizedState=Ct),vt.props=et,vt.state=Ct,vt.context=pt,et=Tt):(typeof vt.componentDidMount=="function"&&(g.flags|=4194308),et=!1)}else{vt=g.stateNode,lh$1(d,g),Tt=g.memoizedProps,pt=g.type===g.elementType?Tt:Ci$1(g.type,Tt),vt.props=pt,$t=g.pendingProps,Lt=vt.context,Ct=b.contextType,typeof Ct=="object"&&Ct!==null?Ct=eh$1(Ct):(Ct=Zf$1(b)?Xf$1:H$2.current,Ct=Yf$1(g,Ct));var jt=b.getDerivedStateFromProps;(wt=typeof jt=="function"||typeof vt.getSnapshotBeforeUpdate=="function")||typeof vt.UNSAFE_componentWillReceiveProps!="function"&&typeof vt.componentWillReceiveProps!="function"||(Tt!==$t||Lt!==Ct)&&Hi$2(g,vt,et,Ct),jh$1=!1,Lt=g.memoizedState,vt.state=Lt,qh$1(g,et,vt,st);var Ft=g.memoizedState;Tt!==$t||Lt!==Ft||Wf$1.current||jh$1?(typeof jt=="function"&&(Di$2(g,b,jt,et),Ft=g.memoizedState),(pt=jh$1||Fi$2(g,b,pt,et,Lt,Ft,Ct)||!1)?(wt||typeof vt.UNSAFE_componentWillUpdate!="function"&&typeof vt.componentWillUpdate!="function"||(typeof vt.componentWillUpdate=="function"&&vt.componentWillUpdate(et,Ft,Ct),typeof vt.UNSAFE_componentWillUpdate=="function"&&vt.UNSAFE_componentWillUpdate(et,Ft,Ct)),typeof vt.componentDidUpdate=="function"&&(g.flags|=4),typeof vt.getSnapshotBeforeUpdate=="function"&&(g.flags|=1024)):(typeof vt.componentDidUpdate!="function"||Tt===d.memoizedProps&&Lt===d.memoizedState||(g.flags|=4),typeof vt.getSnapshotBeforeUpdate!="function"||Tt===d.memoizedProps&&Lt===d.memoizedState||(g.flags|=1024),g.memoizedProps=et,g.memoizedState=Ft),vt.props=et,vt.state=Ft,vt.context=Ct,et=pt):(typeof vt.componentDidUpdate!="function"||Tt===d.memoizedProps&&Lt===d.memoizedState||(g.flags|=4),typeof vt.getSnapshotBeforeUpdate!="function"||Tt===d.memoizedProps&&Lt===d.memoizedState||(g.flags|=1024),et=!1)}return jj(d,g,b,et,at,st)}function jj(d,g,b,et,st,at){gj(d,g);var vt=(g.flags&128)!==0;if(!et&&!vt)return st&&dg$1(g,b,!1),Zi$2(d,g,at);et=g.stateNode,Wi$2.current=g;var Tt=vt&&typeof b.getDerivedStateFromError!="function"?null:et.render();return g.flags|=1,d!==null&&vt?(g.child=Ug(g,d.child,null,at),g.child=Ug(g,null,Tt,at)):Xi$2(d,g,Tt,at),g.memoizedState=et.state,st&&dg$1(g,b,!0),g.child}function kj(d){var g=d.stateNode;g.pendingContext?ag(d,g.pendingContext,g.pendingContext!==g.context):g.context&&ag(d,g.context,!1),yh$1(d,g.containerInfo)}function lj(d,g,b,et,st){return Ig(),Jg(st),g.flags|=256,Xi$2(d,g,b,et),g.child}var mj={dehydrated:null,treeContext:null,retryLane:0};function nj(d){return{baseLanes:d,cachePool:null,transitions:null}}function oj(d,g,b){var et=g.pendingProps,st=L$2.current,at=!1,vt=(g.flags&128)!==0,Tt;if((Tt=vt)||(Tt=d!==null&&d.memoizedState===null?!1:(st&2)!==0),Tt?(at=!0,g.flags&=-129):(d===null||d.memoizedState!==null)&&(st|=1),G$2(L$2,st&1),d===null)return Eg(g),d=g.memoizedState,d!==null&&(d=d.dehydrated,d!==null)?(g.mode&1?d.data==="$!"?g.lanes=8:g.lanes=1073741824:g.lanes=1,null):(vt=et.children,d=et.fallback,at?(et=g.mode,at=g.child,vt={mode:"hidden",children:vt},!(et&1)&&at!==null?(at.childLanes=0,at.pendingProps=vt):at=pj(vt,et,0,null),d=Tg$1(d,et,b,null),at.return=g,d.return=g,at.sibling=d,g.child=at,g.child.memoizedState=nj(b),g.memoizedState=mj,d):qj(g,vt));if(st=d.memoizedState,st!==null&&(Tt=st.dehydrated,Tt!==null))return rj(d,g,vt,et,Tt,st,b);if(at){at=et.fallback,vt=g.mode,st=d.child,Tt=st.sibling;var Ct={mode:"hidden",children:et.children};return!(vt&1)&&g.child!==st?(et=g.child,et.childLanes=0,et.pendingProps=Ct,g.deletions=null):(et=Pg(st,Ct),et.subtreeFlags=st.subtreeFlags&14680064),Tt!==null?at=Pg(Tt,at):(at=Tg$1(at,vt,b,null),at.flags|=2),at.return=g,et.return=g,et.sibling=at,g.child=et,et=at,at=g.child,vt=d.child.memoizedState,vt=vt===null?nj(b):{baseLanes:vt.baseLanes|b,cachePool:null,transitions:vt.transitions},at.memoizedState=vt,at.childLanes=d.childLanes&~b,g.memoizedState=mj,et}return at=d.child,d=at.sibling,et=Pg(at,{mode:"visible",children:et.children}),!(g.mode&1)&&(et.lanes=b),et.return=g,et.sibling=null,d!==null&&(b=g.deletions,b===null?(g.deletions=[d],g.flags|=16):b.push(d)),g.child=et,g.memoizedState=null,et}function qj(d,g){return g=pj({mode:"visible",children:g},d.mode,0,null),g.return=d,d.child=g}function sj(d,g,b,et){return et!==null&&Jg(et),Ug(g,d.child,null,b),d=qj(g,g.pendingProps.children),d.flags|=2,g.memoizedState=null,d}function rj(d,g,b,et,st,at,vt){if(b)return g.flags&256?(g.flags&=-257,et=Ki$2(Error(p$3(422))),sj(d,g,vt,et)):g.memoizedState!==null?(g.child=d.child,g.flags|=128,null):(at=et.fallback,st=g.mode,et=pj({mode:"visible",children:et.children},st,0,null),at=Tg$1(at,st,vt,null),at.flags|=2,et.return=g,at.return=g,et.sibling=at,g.child=et,g.mode&1&&Ug(g,d.child,null,vt),g.child.memoizedState=nj(vt),g.memoizedState=mj,at);if(!(g.mode&1))return sj(d,g,vt,null);if(st.data==="$!"){if(et=st.nextSibling&&st.nextSibling.dataset,et)var Tt=et.dgst;return et=Tt,at=Error(p$3(419)),et=Ki$2(at,et,void 0),sj(d,g,vt,et)}if(Tt=(vt&d.childLanes)!==0,dh$1||Tt){if(et=Q$3,et!==null){switch(vt&-vt){case 4:st=2;break;case 16:st=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:st=32;break;case 536870912:st=268435456;break;default:st=0}st=st&(et.suspendedLanes|vt)?0:st,st!==0&&st!==at.retryLane&&(at.retryLane=st,ih$1(d,st),gi$1(et,d,st,-1))}return tj(),et=Ki$2(Error(p$3(421))),sj(d,g,vt,et)}return st.data==="$?"?(g.flags|=128,g.child=d.child,g=uj.bind(null,d),st._reactRetry=g,null):(d=at.treeContext,yg=Lf$1(st.nextSibling),xg$1=g,I=!0,zg=null,d!==null&&(og$1[pg$1++]=rg$1,og$1[pg$1++]=sg$1,og$1[pg$1++]=qg,rg$1=d.id,sg$1=d.overflow,qg=g),g=qj(g,et.children),g.flags|=4096,g)}function vj(d,g,b){d.lanes|=g;var et=d.alternate;et!==null&&(et.lanes|=g),bh$1(d.return,g,b)}function wj(d,g,b,et,st){var at=d.memoizedState;at===null?d.memoizedState={isBackwards:g,rendering:null,renderingStartTime:0,last:et,tail:b,tailMode:st}:(at.isBackwards=g,at.rendering=null,at.renderingStartTime=0,at.last=et,at.tail=b,at.tailMode=st)}function xj(d,g,b){var et=g.pendingProps,st=et.revealOrder,at=et.tail;if(Xi$2(d,g,et.children,b),et=L$2.current,et&2)et=et&1|2,g.flags|=128;else{if(d!==null&&d.flags&128)e:for(d=g.child;d!==null;){if(d.tag===13)d.memoizedState!==null&&vj(d,b,g);else if(d.tag===19)vj(d,b,g);else if(d.child!==null){d.child.return=d,d=d.child;continue}if(d===g)break e;for(;d.sibling===null;){if(d.return===null||d.return===g)break e;d=d.return}d.sibling.return=d.return,d=d.sibling}et&=1}if(G$2(L$2,et),!(g.mode&1))g.memoizedState=null;else switch(st){case"forwards":for(b=g.child,st=null;b!==null;)d=b.alternate,d!==null&&Ch$1(d)===null&&(st=b),b=b.sibling;b=st,b===null?(st=g.child,g.child=null):(st=b.sibling,b.sibling=null),wj(g,!1,st,b,at);break;case"backwards":for(b=null,st=g.child,g.child=null;st!==null;){if(d=st.alternate,d!==null&&Ch$1(d)===null){g.child=st;break}d=st.sibling,st.sibling=b,b=st,st=d}wj(g,!0,b,null,at);break;case"together":wj(g,!1,null,null,void 0);break;default:g.memoizedState=null}return g.child}function ij(d,g){!(g.mode&1)&&d!==null&&(d.alternate=null,g.alternate=null,g.flags|=2)}function Zi$2(d,g,b){if(d!==null&&(g.dependencies=d.dependencies),rh$1|=g.lanes,!(b&g.childLanes))return null;if(d!==null&&g.child!==d.child)throw Error(p$3(153));if(g.child!==null){for(d=g.child,b=Pg(d,d.pendingProps),g.child=b,b.return=g;d.sibling!==null;)d=d.sibling,b=b.sibling=Pg(d,d.pendingProps),b.return=g;b.sibling=null}return g.child}function yj(d,g,b){switch(g.tag){case 3:kj(g),Ig();break;case 5:Ah$1(g);break;case 1:Zf$1(g.type)&&cg$1(g);break;case 4:yh$1(g,g.stateNode.containerInfo);break;case 10:var et=g.type._context,st=g.memoizedProps.value;G$2(Wg,et._currentValue),et._currentValue=st;break;case 13:if(et=g.memoizedState,et!==null)return et.dehydrated!==null?(G$2(L$2,L$2.current&1),g.flags|=128,null):b&g.child.childLanes?oj(d,g,b):(G$2(L$2,L$2.current&1),d=Zi$2(d,g,b),d!==null?d.sibling:null);G$2(L$2,L$2.current&1);break;case 19:if(et=(b&g.childLanes)!==0,d.flags&128){if(et)return xj(d,g,b);g.flags|=128}if(st=g.memoizedState,st!==null&&(st.rendering=null,st.tail=null,st.lastEffect=null),G$2(L$2,L$2.current),et)break;return null;case 22:case 23:return g.lanes=0,dj(d,g,b)}return Zi$2(d,g,b)}var zj,Aj,Bj,Cj;zj=function(d,g){for(var b=g.child;b!==null;){if(b.tag===5||b.tag===6)d.appendChild(b.stateNode);else if(b.tag!==4&&b.child!==null){b.child.return=b,b=b.child;continue}if(b===g)break;for(;b.sibling===null;){if(b.return===null||b.return===g)return;b=b.return}b.sibling.return=b.return,b=b.sibling}};Aj=function(){};Bj=function(d,g,b,et){var st=d.memoizedProps;if(st!==et){d=g.stateNode,xh$1(uh$1.current);var at=null;switch(b){case"input":st=Ya$2(d,st),et=Ya$2(d,et),at=[];break;case"select":st=A({},st,{value:void 0}),et=A({},et,{value:void 0}),at=[];break;case"textarea":st=gb$1(d,st),et=gb$1(d,et),at=[];break;default:typeof st.onClick!="function"&&typeof et.onClick=="function"&&(d.onclick=Bf$1)}ub$1(b,et);var vt;b=null;for(pt in st)if(!et.hasOwnProperty(pt)&&st.hasOwnProperty(pt)&&st[pt]!=null)if(pt==="style"){var Tt=st[pt];for(vt in Tt)Tt.hasOwnProperty(vt)&&(b||(b={}),b[vt]="")}else pt!=="dangerouslySetInnerHTML"&&pt!=="children"&&pt!=="suppressContentEditableWarning"&&pt!=="suppressHydrationWarning"&&pt!=="autoFocus"&&(ea$1.hasOwnProperty(pt)?at||(at=[]):(at=at||[]).push(pt,null));for(pt in et){var Ct=et[pt];if(Tt=st!=null?st[pt]:void 0,et.hasOwnProperty(pt)&&Ct!==Tt&&(Ct!=null||Tt!=null))if(pt==="style")if(Tt){for(vt in Tt)!Tt.hasOwnProperty(vt)||Ct&&Ct.hasOwnProperty(vt)||(b||(b={}),b[vt]="");for(vt in Ct)Ct.hasOwnProperty(vt)&&Tt[vt]!==Ct[vt]&&(b||(b={}),b[vt]=Ct[vt])}else b||(at||(at=[]),at.push(pt,b)),b=Ct;else pt==="dangerouslySetInnerHTML"?(Ct=Ct?Ct.__html:void 0,Tt=Tt?Tt.__html:void 0,Ct!=null&&Tt!==Ct&&(at=at||[]).push(pt,Ct)):pt==="children"?typeof Ct!="string"&&typeof Ct!="number"||(at=at||[]).push(pt,""+Ct):pt!=="suppressContentEditableWarning"&&pt!=="suppressHydrationWarning"&&(ea$1.hasOwnProperty(pt)?(Ct!=null&&pt==="onScroll"&&D$2("scroll",d),at||Tt===Ct||(at=[])):(at=at||[]).push(pt,Ct))}b&&(at=at||[]).push("style",b);var pt=at;(g.updateQueue=pt)&&(g.flags|=4)}};Cj=function(d,g,b,et){b!==et&&(g.flags|=4)};function Dj(d,g){if(!I)switch(d.tailMode){case"hidden":g=d.tail;for(var b=null;g!==null;)g.alternate!==null&&(b=g),g=g.sibling;b===null?d.tail=null:b.sibling=null;break;case"collapsed":b=d.tail;for(var et=null;b!==null;)b.alternate!==null&&(et=b),b=b.sibling;et===null?g||d.tail===null?d.tail=null:d.tail.sibling=null:et.sibling=null}}function S(d){var g=d.alternate!==null&&d.alternate.child===d.child,b=0,et=0;if(g)for(var st=d.child;st!==null;)b|=st.lanes|st.childLanes,et|=st.subtreeFlags&14680064,et|=st.flags&14680064,st.return=d,st=st.sibling;else for(st=d.child;st!==null;)b|=st.lanes|st.childLanes,et|=st.subtreeFlags,et|=st.flags,st.return=d,st=st.sibling;return d.subtreeFlags|=et,d.childLanes=b,g}function Ej(d,g,b){var et=g.pendingProps;switch(wg$1(g),g.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return S(g),null;case 1:return Zf$1(g.type)&&$f$1(),S(g),null;case 3:return et=g.stateNode,zh$1(),E$1(Wf$1),E$1(H$2),Eh$1(),et.pendingContext&&(et.context=et.pendingContext,et.pendingContext=null),(d===null||d.child===null)&&(Gg(g)?g.flags|=4:d===null||d.memoizedState.isDehydrated&&!(g.flags&256)||(g.flags|=1024,zg!==null&&(Fj(zg),zg=null))),Aj(d,g),S(g),null;case 5:Bh$1(g);var st=xh$1(wh$1.current);if(b=g.type,d!==null&&g.stateNode!=null)Bj(d,g,b,et,st),d.ref!==g.ref&&(g.flags|=512,g.flags|=2097152);else{if(!et){if(g.stateNode===null)throw Error(p$3(166));return S(g),null}if(d=xh$1(uh$1.current),Gg(g)){et=g.stateNode,b=g.type;var at=g.memoizedProps;switch(et[Of$1]=g,et[Pf$1]=at,d=(g.mode&1)!==0,b){case"dialog":D$2("cancel",et),D$2("close",et);break;case"iframe":case"object":case"embed":D$2("load",et);break;case"video":case"audio":for(st=0;st<lf$2.length;st++)D$2(lf$2[st],et);break;case"source":D$2("error",et);break;case"img":case"image":case"link":D$2("error",et),D$2("load",et);break;case"details":D$2("toggle",et);break;case"input":Za$2(et,at),D$2("invalid",et);break;case"select":et._wrapperState={wasMultiple:!!at.multiple},D$2("invalid",et);break;case"textarea":hb$1(et,at),D$2("invalid",et)}ub$1(b,at),st=null;for(var vt in at)if(at.hasOwnProperty(vt)){var Tt=at[vt];vt==="children"?typeof Tt=="string"?et.textContent!==Tt&&(at.suppressHydrationWarning!==!0&&Af$1(et.textContent,Tt,d),st=["children",Tt]):typeof Tt=="number"&&et.textContent!==""+Tt&&(at.suppressHydrationWarning!==!0&&Af$1(et.textContent,Tt,d),st=["children",""+Tt]):ea$1.hasOwnProperty(vt)&&Tt!=null&&vt==="onScroll"&&D$2("scroll",et)}switch(b){case"input":Va$2(et),db$1(et,at,!0);break;case"textarea":Va$2(et),jb$1(et);break;case"select":case"option":break;default:typeof at.onClick=="function"&&(et.onclick=Bf$1)}et=st,g.updateQueue=et,et!==null&&(g.flags|=4)}else{vt=st.nodeType===9?st:st.ownerDocument,d==="http://www.w3.org/1999/xhtml"&&(d=kb$1(b)),d==="http://www.w3.org/1999/xhtml"?b==="script"?(d=vt.createElement("div"),d.innerHTML="<script><\/script>",d=d.removeChild(d.firstChild)):typeof et.is=="string"?d=vt.createElement(b,{is:et.is}):(d=vt.createElement(b),b==="select"&&(vt=d,et.multiple?vt.multiple=!0:et.size&&(vt.size=et.size))):d=vt.createElementNS(d,b),d[Of$1]=g,d[Pf$1]=et,zj(d,g,!1,!1),g.stateNode=d;e:{switch(vt=vb$1(b,et),b){case"dialog":D$2("cancel",d),D$2("close",d),st=et;break;case"iframe":case"object":case"embed":D$2("load",d),st=et;break;case"video":case"audio":for(st=0;st<lf$2.length;st++)D$2(lf$2[st],d);st=et;break;case"source":D$2("error",d),st=et;break;case"img":case"image":case"link":D$2("error",d),D$2("load",d),st=et;break;case"details":D$2("toggle",d),st=et;break;case"input":Za$2(d,et),st=Ya$2(d,et),D$2("invalid",d);break;case"option":st=et;break;case"select":d._wrapperState={wasMultiple:!!et.multiple},st=A({},et,{value:void 0}),D$2("invalid",d);break;case"textarea":hb$1(d,et),st=gb$1(d,et),D$2("invalid",d);break;default:st=et}ub$1(b,st),Tt=st;for(at in Tt)if(Tt.hasOwnProperty(at)){var Ct=Tt[at];at==="style"?sb$1(d,Ct):at==="dangerouslySetInnerHTML"?(Ct=Ct?Ct.__html:void 0,Ct!=null&&nb$1(d,Ct)):at==="children"?typeof Ct=="string"?(b!=="textarea"||Ct!=="")&&ob$1(d,Ct):typeof Ct=="number"&&ob$1(d,""+Ct):at!=="suppressContentEditableWarning"&&at!=="suppressHydrationWarning"&&at!=="autoFocus"&&(ea$1.hasOwnProperty(at)?Ct!=null&&at==="onScroll"&&D$2("scroll",d):Ct!=null&&ta$1(d,at,Ct,vt))}switch(b){case"input":Va$2(d),db$1(d,et,!1);break;case"textarea":Va$2(d),jb$1(d);break;case"option":et.value!=null&&d.setAttribute("value",""+Sa$1(et.value));break;case"select":d.multiple=!!et.multiple,at=et.value,at!=null?fb$1(d,!!et.multiple,at,!1):et.defaultValue!=null&&fb$1(d,!!et.multiple,et.defaultValue,!0);break;default:typeof st.onClick=="function"&&(d.onclick=Bf$1)}switch(b){case"button":case"input":case"select":case"textarea":et=!!et.autoFocus;break e;case"img":et=!0;break e;default:et=!1}}et&&(g.flags|=4)}g.ref!==null&&(g.flags|=512,g.flags|=2097152)}return S(g),null;case 6:if(d&&g.stateNode!=null)Cj(d,g,d.memoizedProps,et);else{if(typeof et!="string"&&g.stateNode===null)throw Error(p$3(166));if(b=xh$1(wh$1.current),xh$1(uh$1.current),Gg(g)){if(et=g.stateNode,b=g.memoizedProps,et[Of$1]=g,(at=et.nodeValue!==b)&&(d=xg$1,d!==null))switch(d.tag){case 3:Af$1(et.nodeValue,b,(d.mode&1)!==0);break;case 5:d.memoizedProps.suppressHydrationWarning!==!0&&Af$1(et.nodeValue,b,(d.mode&1)!==0)}at&&(g.flags|=4)}else et=(b.nodeType===9?b:b.ownerDocument).createTextNode(et),et[Of$1]=g,g.stateNode=et}return S(g),null;case 13:if(E$1(L$2),et=g.memoizedState,d===null||d.memoizedState!==null&&d.memoizedState.dehydrated!==null){if(I&&yg!==null&&g.mode&1&&!(g.flags&128))Hg(),Ig(),g.flags|=98560,at=!1;else if(at=Gg(g),et!==null&&et.dehydrated!==null){if(d===null){if(!at)throw Error(p$3(318));if(at=g.memoizedState,at=at!==null?at.dehydrated:null,!at)throw Error(p$3(317));at[Of$1]=g}else Ig(),!(g.flags&128)&&(g.memoizedState=null),g.flags|=4;S(g),at=!1}else zg!==null&&(Fj(zg),zg=null),at=!0;if(!at)return g.flags&65536?g:null}return g.flags&128?(g.lanes=b,g):(et=et!==null,et!==(d!==null&&d.memoizedState!==null)&&et&&(g.child.flags|=8192,g.mode&1&&(d===null||L$2.current&1?T$2===0&&(T$2=3):tj())),g.updateQueue!==null&&(g.flags|=4),S(g),null);case 4:return zh$1(),Aj(d,g),d===null&&sf$2(g.stateNode.containerInfo),S(g),null;case 10:return ah(g.type._context),S(g),null;case 17:return Zf$1(g.type)&&$f$1(),S(g),null;case 19:if(E$1(L$2),at=g.memoizedState,at===null)return S(g),null;if(et=(g.flags&128)!==0,vt=at.rendering,vt===null)if(et)Dj(at,!1);else{if(T$2!==0||d!==null&&d.flags&128)for(d=g.child;d!==null;){if(vt=Ch$1(d),vt!==null){for(g.flags|=128,Dj(at,!1),et=vt.updateQueue,et!==null&&(g.updateQueue=et,g.flags|=4),g.subtreeFlags=0,et=b,b=g.child;b!==null;)at=b,d=et,at.flags&=14680066,vt=at.alternate,vt===null?(at.childLanes=0,at.lanes=d,at.child=null,at.subtreeFlags=0,at.memoizedProps=null,at.memoizedState=null,at.updateQueue=null,at.dependencies=null,at.stateNode=null):(at.childLanes=vt.childLanes,at.lanes=vt.lanes,at.child=vt.child,at.subtreeFlags=0,at.deletions=null,at.memoizedProps=vt.memoizedProps,at.memoizedState=vt.memoizedState,at.updateQueue=vt.updateQueue,at.type=vt.type,d=vt.dependencies,at.dependencies=d===null?null:{lanes:d.lanes,firstContext:d.firstContext}),b=b.sibling;return G$2(L$2,L$2.current&1|2),g.child}d=d.sibling}at.tail!==null&&B$2()>Gj&&(g.flags|=128,et=!0,Dj(at,!1),g.lanes=4194304)}else{if(!et)if(d=Ch$1(vt),d!==null){if(g.flags|=128,et=!0,b=d.updateQueue,b!==null&&(g.updateQueue=b,g.flags|=4),Dj(at,!0),at.tail===null&&at.tailMode==="hidden"&&!vt.alternate&&!I)return S(g),null}else 2*B$2()-at.renderingStartTime>Gj&&b!==1073741824&&(g.flags|=128,et=!0,Dj(at,!1),g.lanes=4194304);at.isBackwards?(vt.sibling=g.child,g.child=vt):(b=at.last,b!==null?b.sibling=vt:g.child=vt,at.last=vt)}return at.tail!==null?(g=at.tail,at.rendering=g,at.tail=g.sibling,at.renderingStartTime=B$2(),g.sibling=null,b=L$2.current,G$2(L$2,et?b&1|2:b&1),g):(S(g),null);case 22:case 23:return Hj(),et=g.memoizedState!==null,d!==null&&d.memoizedState!==null!==et&&(g.flags|=8192),et&&g.mode&1?fj&1073741824&&(S(g),g.subtreeFlags&6&&(g.flags|=8192)):S(g),null;case 24:return null;case 25:return null}throw Error(p$3(156,g.tag))}function Ij(d,g){switch(wg$1(g),g.tag){case 1:return Zf$1(g.type)&&$f$1(),d=g.flags,d&65536?(g.flags=d&-65537|128,g):null;case 3:return zh$1(),E$1(Wf$1),E$1(H$2),Eh$1(),d=g.flags,d&65536&&!(d&128)?(g.flags=d&-65537|128,g):null;case 5:return Bh$1(g),null;case 13:if(E$1(L$2),d=g.memoizedState,d!==null&&d.dehydrated!==null){if(g.alternate===null)throw Error(p$3(340));Ig()}return d=g.flags,d&65536?(g.flags=d&-65537|128,g):null;case 19:return E$1(L$2),null;case 4:return zh$1(),null;case 10:return ah(g.type._context),null;case 22:case 23:return Hj(),null;case 24:return null;default:return null}}var Jj=!1,U$4=!1,Kj=typeof WeakSet=="function"?WeakSet:Set,V$2=null;function Lj(d,g){var b=d.ref;if(b!==null)if(typeof b=="function")try{b(null)}catch(et){W$1(d,g,et)}else b.current=null}function Mj(d,g,b){try{b()}catch(et){W$1(d,g,et)}}var Nj=!1;function Oj(d,g){if(Cf$1=dd$2,d=Me$2(),Ne$1(d)){if("selectionStart"in d)var b={start:d.selectionStart,end:d.selectionEnd};else e:{b=(b=d.ownerDocument)&&b.defaultView||window;var et=b.getSelection&&b.getSelection();if(et&&et.rangeCount!==0){b=et.anchorNode;var st=et.anchorOffset,at=et.focusNode;et=et.focusOffset;try{b.nodeType,at.nodeType}catch{b=null;break e}var vt=0,Tt=-1,Ct=-1,pt=0,wt=0,$t=d,Lt=null;t:for(;;){for(var jt;$t!==b||st!==0&&$t.nodeType!==3||(Tt=vt+st),$t!==at||et!==0&&$t.nodeType!==3||(Ct=vt+et),$t.nodeType===3&&(vt+=$t.nodeValue.length),(jt=$t.firstChild)!==null;)Lt=$t,$t=jt;for(;;){if($t===d)break t;if(Lt===b&&++pt===st&&(Tt=vt),Lt===at&&++wt===et&&(Ct=vt),(jt=$t.nextSibling)!==null)break;$t=Lt,Lt=$t.parentNode}$t=jt}b=Tt===-1||Ct===-1?null:{start:Tt,end:Ct}}else b=null}b=b||{start:0,end:0}}else b=null;for(Df$1={focusedElem:d,selectionRange:b},dd$2=!1,V$2=g;V$2!==null;)if(g=V$2,d=g.child,(g.subtreeFlags&1028)!==0&&d!==null)d.return=g,V$2=d;else for(;V$2!==null;){g=V$2;try{var Ft=g.alternate;if(g.flags&1024)switch(g.tag){case 0:case 11:case 15:break;case 1:if(Ft!==null){var Gt=Ft.memoizedProps,Ht=Ft.memoizedState,qt=g.stateNode,Kt=qt.getSnapshotBeforeUpdate(g.elementType===g.type?Gt:Ci$1(g.type,Gt),Ht);qt.__reactInternalSnapshotBeforeUpdate=Kt}break;case 3:var rr=g.stateNode.containerInfo;rr.nodeType===1?rr.textContent="":rr.nodeType===9&&rr.documentElement&&rr.removeChild(rr.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(p$3(163))}}catch(ir){W$1(g,g.return,ir)}if(d=g.sibling,d!==null){d.return=g.return,V$2=d;break}V$2=g.return}return Ft=Nj,Nj=!1,Ft}function Pj(d,g,b){var et=g.updateQueue;if(et=et!==null?et.lastEffect:null,et!==null){var st=et=et.next;do{if((st.tag&d)===d){var at=st.destroy;st.destroy=void 0,at!==void 0&&Mj(g,b,at)}st=st.next}while(st!==et)}}function Qj(d,g){if(g=g.updateQueue,g=g!==null?g.lastEffect:null,g!==null){var b=g=g.next;do{if((b.tag&d)===d){var et=b.create;b.destroy=et()}b=b.next}while(b!==g)}}function Rj(d){var g=d.ref;if(g!==null){var b=d.stateNode;switch(d.tag){case 5:d=b;break;default:d=b}typeof g=="function"?g(d):g.current=d}}function Sj(d){var g=d.alternate;g!==null&&(d.alternate=null,Sj(g)),d.child=null,d.deletions=null,d.sibling=null,d.tag===5&&(g=d.stateNode,g!==null&&(delete g[Of$1],delete g[Pf$1],delete g[of$2],delete g[Qf$1],delete g[Rf$1])),d.stateNode=null,d.return=null,d.dependencies=null,d.memoizedProps=null,d.memoizedState=null,d.pendingProps=null,d.stateNode=null,d.updateQueue=null}function Tj(d){return d.tag===5||d.tag===3||d.tag===4}function Uj(d){e:for(;;){for(;d.sibling===null;){if(d.return===null||Tj(d.return))return null;d=d.return}for(d.sibling.return=d.return,d=d.sibling;d.tag!==5&&d.tag!==6&&d.tag!==18;){if(d.flags&2||d.child===null||d.tag===4)continue e;d.child.return=d,d=d.child}if(!(d.flags&2))return d.stateNode}}function Vj(d,g,b){var et=d.tag;if(et===5||et===6)d=d.stateNode,g?b.nodeType===8?b.parentNode.insertBefore(d,g):b.insertBefore(d,g):(b.nodeType===8?(g=b.parentNode,g.insertBefore(d,b)):(g=b,g.appendChild(d)),b=b._reactRootContainer,b!=null||g.onclick!==null||(g.onclick=Bf$1));else if(et!==4&&(d=d.child,d!==null))for(Vj(d,g,b),d=d.sibling;d!==null;)Vj(d,g,b),d=d.sibling}function Wj(d,g,b){var et=d.tag;if(et===5||et===6)d=d.stateNode,g?b.insertBefore(d,g):b.appendChild(d);else if(et!==4&&(d=d.child,d!==null))for(Wj(d,g,b),d=d.sibling;d!==null;)Wj(d,g,b),d=d.sibling}var X$3=null,Xj=!1;function Yj(d,g,b){for(b=b.child;b!==null;)Zj(d,g,b),b=b.sibling}function Zj(d,g,b){if(lc$2&&typeof lc$2.onCommitFiberUnmount=="function")try{lc$2.onCommitFiberUnmount(kc$2,b)}catch{}switch(b.tag){case 5:U$4||Lj(b,g);case 6:var et=X$3,st=Xj;X$3=null,Yj(d,g,b),X$3=et,Xj=st,X$3!==null&&(Xj?(d=X$3,b=b.stateNode,d.nodeType===8?d.parentNode.removeChild(b):d.removeChild(b)):X$3.removeChild(b.stateNode));break;case 18:X$3!==null&&(Xj?(d=X$3,b=b.stateNode,d.nodeType===8?Kf$1(d.parentNode,b):d.nodeType===1&&Kf$1(d,b),bd$1(d)):Kf$1(X$3,b.stateNode));break;case 4:et=X$3,st=Xj,X$3=b.stateNode.containerInfo,Xj=!0,Yj(d,g,b),X$3=et,Xj=st;break;case 0:case 11:case 14:case 15:if(!U$4&&(et=b.updateQueue,et!==null&&(et=et.lastEffect,et!==null))){st=et=et.next;do{var at=st,vt=at.destroy;at=at.tag,vt!==void 0&&(at&2||at&4)&&Mj(b,g,vt),st=st.next}while(st!==et)}Yj(d,g,b);break;case 1:if(!U$4&&(Lj(b,g),et=b.stateNode,typeof et.componentWillUnmount=="function"))try{et.props=b.memoizedProps,et.state=b.memoizedState,et.componentWillUnmount()}catch(Tt){W$1(b,g,Tt)}Yj(d,g,b);break;case 21:Yj(d,g,b);break;case 22:b.mode&1?(U$4=(et=U$4)||b.memoizedState!==null,Yj(d,g,b),U$4=et):Yj(d,g,b);break;default:Yj(d,g,b)}}function ak(d){var g=d.updateQueue;if(g!==null){d.updateQueue=null;var b=d.stateNode;b===null&&(b=d.stateNode=new Kj),g.forEach(function(et){var st=bk.bind(null,d,et);b.has(et)||(b.add(et),et.then(st,st))})}}function ck(d,g){var b=g.deletions;if(b!==null)for(var et=0;et<b.length;et++){var st=b[et];try{var at=d,vt=g,Tt=vt;e:for(;Tt!==null;){switch(Tt.tag){case 5:X$3=Tt.stateNode,Xj=!1;break e;case 3:X$3=Tt.stateNode.containerInfo,Xj=!0;break e;case 4:X$3=Tt.stateNode.containerInfo,Xj=!0;break e}Tt=Tt.return}if(X$3===null)throw Error(p$3(160));Zj(at,vt,st),X$3=null,Xj=!1;var Ct=st.alternate;Ct!==null&&(Ct.return=null),st.return=null}catch(pt){W$1(st,g,pt)}}if(g.subtreeFlags&12854)for(g=g.child;g!==null;)dk(g,d),g=g.sibling}function dk(d,g){var b=d.alternate,et=d.flags;switch(d.tag){case 0:case 11:case 14:case 15:if(ck(g,d),ek(d),et&4){try{Pj(3,d,d.return),Qj(3,d)}catch(Gt){W$1(d,d.return,Gt)}try{Pj(5,d,d.return)}catch(Gt){W$1(d,d.return,Gt)}}break;case 1:ck(g,d),ek(d),et&512&&b!==null&&Lj(b,b.return);break;case 5:if(ck(g,d),ek(d),et&512&&b!==null&&Lj(b,b.return),d.flags&32){var st=d.stateNode;try{ob$1(st,"")}catch(Gt){W$1(d,d.return,Gt)}}if(et&4&&(st=d.stateNode,st!=null)){var at=d.memoizedProps,vt=b!==null?b.memoizedProps:at,Tt=d.type,Ct=d.updateQueue;if(d.updateQueue=null,Ct!==null)try{Tt==="input"&&at.type==="radio"&&at.name!=null&&ab$1(st,at),vb$1(Tt,vt);var pt=vb$1(Tt,at);for(vt=0;vt<Ct.length;vt+=2){var wt=Ct[vt],$t=Ct[vt+1];wt==="style"?sb$1(st,$t):wt==="dangerouslySetInnerHTML"?nb$1(st,$t):wt==="children"?ob$1(st,$t):ta$1(st,wt,$t,pt)}switch(Tt){case"input":bb$1(st,at);break;case"textarea":ib$1(st,at);break;case"select":var Lt=st._wrapperState.wasMultiple;st._wrapperState.wasMultiple=!!at.multiple;var jt=at.value;jt!=null?fb$1(st,!!at.multiple,jt,!1):Lt!==!!at.multiple&&(at.defaultValue!=null?fb$1(st,!!at.multiple,at.defaultValue,!0):fb$1(st,!!at.multiple,at.multiple?[]:"",!1))}st[Pf$1]=at}catch(Gt){W$1(d,d.return,Gt)}}break;case 6:if(ck(g,d),ek(d),et&4){if(d.stateNode===null)throw Error(p$3(162));st=d.stateNode,at=d.memoizedProps;try{st.nodeValue=at}catch(Gt){W$1(d,d.return,Gt)}}break;case 3:if(ck(g,d),ek(d),et&4&&b!==null&&b.memoizedState.isDehydrated)try{bd$1(g.containerInfo)}catch(Gt){W$1(d,d.return,Gt)}break;case 4:ck(g,d),ek(d);break;case 13:ck(g,d),ek(d),st=d.child,st.flags&8192&&(at=st.memoizedState!==null,st.stateNode.isHidden=at,!at||st.alternate!==null&&st.alternate.memoizedState!==null||(fk=B$2())),et&4&&ak(d);break;case 22:if(wt=b!==null&&b.memoizedState!==null,d.mode&1?(U$4=(pt=U$4)||wt,ck(g,d),U$4=pt):ck(g,d),ek(d),et&8192){if(pt=d.memoizedState!==null,(d.stateNode.isHidden=pt)&&!wt&&d.mode&1)for(V$2=d,wt=d.child;wt!==null;){for($t=V$2=wt;V$2!==null;){switch(Lt=V$2,jt=Lt.child,Lt.tag){case 0:case 11:case 14:case 15:Pj(4,Lt,Lt.return);break;case 1:Lj(Lt,Lt.return);var Ft=Lt.stateNode;if(typeof Ft.componentWillUnmount=="function"){et=Lt,b=Lt.return;try{g=et,Ft.props=g.memoizedProps,Ft.state=g.memoizedState,Ft.componentWillUnmount()}catch(Gt){W$1(et,b,Gt)}}break;case 5:Lj(Lt,Lt.return);break;case 22:if(Lt.memoizedState!==null){gk($t);continue}}jt!==null?(jt.return=Lt,V$2=jt):gk($t)}wt=wt.sibling}e:for(wt=null,$t=d;;){if($t.tag===5){if(wt===null){wt=$t;try{st=$t.stateNode,pt?(at=st.style,typeof at.setProperty=="function"?at.setProperty("display","none","important"):at.display="none"):(Tt=$t.stateNode,Ct=$t.memoizedProps.style,vt=Ct!=null&&Ct.hasOwnProperty("display")?Ct.display:null,Tt.style.display=rb$1("display",vt))}catch(Gt){W$1(d,d.return,Gt)}}}else if($t.tag===6){if(wt===null)try{$t.stateNode.nodeValue=pt?"":$t.memoizedProps}catch(Gt){W$1(d,d.return,Gt)}}else if(($t.tag!==22&&$t.tag!==23||$t.memoizedState===null||$t===d)&&$t.child!==null){$t.child.return=$t,$t=$t.child;continue}if($t===d)break e;for(;$t.sibling===null;){if($t.return===null||$t.return===d)break e;wt===$t&&(wt=null),$t=$t.return}wt===$t&&(wt=null),$t.sibling.return=$t.return,$t=$t.sibling}}break;case 19:ck(g,d),ek(d),et&4&&ak(d);break;case 21:break;default:ck(g,d),ek(d)}}function ek(d){var g=d.flags;if(g&2){try{e:{for(var b=d.return;b!==null;){if(Tj(b)){var et=b;break e}b=b.return}throw Error(p$3(160))}switch(et.tag){case 5:var st=et.stateNode;et.flags&32&&(ob$1(st,""),et.flags&=-33);var at=Uj(d);Wj(d,at,st);break;case 3:case 4:var vt=et.stateNode.containerInfo,Tt=Uj(d);Vj(d,Tt,vt);break;default:throw Error(p$3(161))}}catch(Ct){W$1(d,d.return,Ct)}d.flags&=-3}g&4096&&(d.flags&=-4097)}function hk(d,g,b){V$2=d,ik(d)}function ik(d,g,b){for(var et=(d.mode&1)!==0;V$2!==null;){var st=V$2,at=st.child;if(st.tag===22&&et){var vt=st.memoizedState!==null||Jj;if(!vt){var Tt=st.alternate,Ct=Tt!==null&&Tt.memoizedState!==null||U$4;Tt=Jj;var pt=U$4;if(Jj=vt,(U$4=Ct)&&!pt)for(V$2=st;V$2!==null;)vt=V$2,Ct=vt.child,vt.tag===22&&vt.memoizedState!==null?jk(st):Ct!==null?(Ct.return=vt,V$2=Ct):jk(st);for(;at!==null;)V$2=at,ik(at),at=at.sibling;V$2=st,Jj=Tt,U$4=pt}kk(d)}else st.subtreeFlags&8772&&at!==null?(at.return=st,V$2=at):kk(d)}}function kk(d){for(;V$2!==null;){var g=V$2;if(g.flags&8772){var b=g.alternate;try{if(g.flags&8772)switch(g.tag){case 0:case 11:case 15:U$4||Qj(5,g);break;case 1:var et=g.stateNode;if(g.flags&4&&!U$4)if(b===null)et.componentDidMount();else{var st=g.elementType===g.type?b.memoizedProps:Ci$1(g.type,b.memoizedProps);et.componentDidUpdate(st,b.memoizedState,et.__reactInternalSnapshotBeforeUpdate)}var at=g.updateQueue;at!==null&&sh$1(g,at,et);break;case 3:var vt=g.updateQueue;if(vt!==null){if(b=null,g.child!==null)switch(g.child.tag){case 5:b=g.child.stateNode;break;case 1:b=g.child.stateNode}sh$1(g,vt,b)}break;case 5:var Tt=g.stateNode;if(b===null&&g.flags&4){b=Tt;var Ct=g.memoizedProps;switch(g.type){case"button":case"input":case"select":case"textarea":Ct.autoFocus&&b.focus();break;case"img":Ct.src&&(b.src=Ct.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(g.memoizedState===null){var pt=g.alternate;if(pt!==null){var wt=pt.memoizedState;if(wt!==null){var $t=wt.dehydrated;$t!==null&&bd$1($t)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(p$3(163))}U$4||g.flags&512&&Rj(g)}catch(Lt){W$1(g,g.return,Lt)}}if(g===d){V$2=null;break}if(b=g.sibling,b!==null){b.return=g.return,V$2=b;break}V$2=g.return}}function gk(d){for(;V$2!==null;){var g=V$2;if(g===d){V$2=null;break}var b=g.sibling;if(b!==null){b.return=g.return,V$2=b;break}V$2=g.return}}function jk(d){for(;V$2!==null;){var g=V$2;try{switch(g.tag){case 0:case 11:case 15:var b=g.return;try{Qj(4,g)}catch(Ct){W$1(g,b,Ct)}break;case 1:var et=g.stateNode;if(typeof et.componentDidMount=="function"){var st=g.return;try{et.componentDidMount()}catch(Ct){W$1(g,st,Ct)}}var at=g.return;try{Rj(g)}catch(Ct){W$1(g,at,Ct)}break;case 5:var vt=g.return;try{Rj(g)}catch(Ct){W$1(g,vt,Ct)}}}catch(Ct){W$1(g,g.return,Ct)}if(g===d){V$2=null;break}var Tt=g.sibling;if(Tt!==null){Tt.return=g.return,V$2=Tt;break}V$2=g.return}}var lk=Math.ceil,mk=ua$2.ReactCurrentDispatcher,nk=ua$2.ReactCurrentOwner,ok=ua$2.ReactCurrentBatchConfig,K$2=0,Q$3=null,Y$2=null,Z$2=0,fj=0,ej=Uf$1(0),T$2=0,pk=null,rh$1=0,qk=0,rk=0,sk=null,tk=null,fk=0,Gj=1/0,uk=null,Oi$2=!1,Pi$2=null,Ri$2=null,vk=!1,wk=null,xk=0,yk=0,zk=null,Ak=-1,Bk=0;function R$1(){return K$2&6?B$2():Ak!==-1?Ak:Ak=B$2()}function yi$1(d){return d.mode&1?K$2&2&&Z$2!==0?Z$2&-Z$2:Kg.transition!==null?(Bk===0&&(Bk=yc$2()),Bk):(d=C,d!==0||(d=window.event,d=d===void 0?16:jd$2(d.type)),d):1}function gi$1(d,g,b,et){if(50<yk)throw yk=0,zk=null,Error(p$3(185));Ac$2(d,b,et),(!(K$2&2)||d!==Q$3)&&(d===Q$3&&(!(K$2&2)&&(qk|=b),T$2===4&&Ck(d,Z$2)),Dk(d,et),b===1&&K$2===0&&!(g.mode&1)&&(Gj=B$2()+500,fg$1&&jg()))}function Dk(d,g){var b=d.callbackNode;wc$2(d,g);var et=uc$2(d,d===Q$3?Z$2:0);if(et===0)b!==null&&bc$2(b),d.callbackNode=null,d.callbackPriority=0;else if(g=et&-et,d.callbackPriority!==g){if(b!=null&&bc$2(b),g===1)d.tag===0?ig$1(Ek.bind(null,d)):hg$1(Ek.bind(null,d)),Jf$1(function(){!(K$2&6)&&jg()}),b=null;else{switch(Dc$2(et)){case 1:b=fc$2;break;case 4:b=gc$2;break;case 16:b=hc$1;break;case 536870912:b=jc$2;break;default:b=hc$1}b=Fk(b,Gk.bind(null,d))}d.callbackPriority=g,d.callbackNode=b}}function Gk(d,g){if(Ak=-1,Bk=0,K$2&6)throw Error(p$3(327));var b=d.callbackNode;if(Hk()&&d.callbackNode!==b)return null;var et=uc$2(d,d===Q$3?Z$2:0);if(et===0)return null;if(et&30||et&d.expiredLanes||g)g=Ik(d,et);else{g=et;var st=K$2;K$2|=2;var at=Jk();(Q$3!==d||Z$2!==g)&&(uk=null,Gj=B$2()+500,Kk(d,g));do try{Lk();break}catch(Tt){Mk(d,Tt)}while(!0);$g(),mk.current=at,K$2=st,Y$2!==null?g=0:(Q$3=null,Z$2=0,g=T$2)}if(g!==0){if(g===2&&(st=xc$2(d),st!==0&&(et=st,g=Nk(d,st))),g===1)throw b=pk,Kk(d,0),Ck(d,et),Dk(d,B$2()),b;if(g===6)Ck(d,et);else{if(st=d.current.alternate,!(et&30)&&!Ok(st)&&(g=Ik(d,et),g===2&&(at=xc$2(d),at!==0&&(et=at,g=Nk(d,at))),g===1))throw b=pk,Kk(d,0),Ck(d,et),Dk(d,B$2()),b;switch(d.finishedWork=st,d.finishedLanes=et,g){case 0:case 1:throw Error(p$3(345));case 2:Pk(d,tk,uk);break;case 3:if(Ck(d,et),(et&130023424)===et&&(g=fk+500-B$2(),10<g)){if(uc$2(d,0)!==0)break;if(st=d.suspendedLanes,(st&et)!==et){R$1(),d.pingedLanes|=d.suspendedLanes&st;break}d.timeoutHandle=Ff$1(Pk.bind(null,d,tk,uk),g);break}Pk(d,tk,uk);break;case 4:if(Ck(d,et),(et&4194240)===et)break;for(g=d.eventTimes,st=-1;0<et;){var vt=31-oc$2(et);at=1<<vt,vt=g[vt],vt>st&&(st=vt),et&=~at}if(et=st,et=B$2()-et,et=(120>et?120:480>et?480:1080>et?1080:1920>et?1920:3e3>et?3e3:4320>et?4320:1960*lk(et/1960))-et,10<et){d.timeoutHandle=Ff$1(Pk.bind(null,d,tk,uk),et);break}Pk(d,tk,uk);break;case 5:Pk(d,tk,uk);break;default:throw Error(p$3(329))}}}return Dk(d,B$2()),d.callbackNode===b?Gk.bind(null,d):null}function Nk(d,g){var b=sk;return d.current.memoizedState.isDehydrated&&(Kk(d,g).flags|=256),d=Ik(d,g),d!==2&&(g=tk,tk=b,g!==null&&Fj(g)),d}function Fj(d){tk===null?tk=d:tk.push.apply(tk,d)}function Ok(d){for(var g=d;;){if(g.flags&16384){var b=g.updateQueue;if(b!==null&&(b=b.stores,b!==null))for(var et=0;et<b.length;et++){var st=b[et],at=st.getSnapshot;st=st.value;try{if(!He$1(at(),st))return!1}catch{return!1}}}if(b=g.child,g.subtreeFlags&16384&&b!==null)b.return=g,g=b;else{if(g===d)break;for(;g.sibling===null;){if(g.return===null||g.return===d)return!0;g=g.return}g.sibling.return=g.return,g=g.sibling}}return!0}function Ck(d,g){for(g&=~rk,g&=~qk,d.suspendedLanes|=g,d.pingedLanes&=~g,d=d.expirationTimes;0<g;){var b=31-oc$2(g),et=1<<b;d[b]=-1,g&=~et}}function Ek(d){if(K$2&6)throw Error(p$3(327));Hk();var g=uc$2(d,0);if(!(g&1))return Dk(d,B$2()),null;var b=Ik(d,g);if(d.tag!==0&&b===2){var et=xc$2(d);et!==0&&(g=et,b=Nk(d,et))}if(b===1)throw b=pk,Kk(d,0),Ck(d,g),Dk(d,B$2()),b;if(b===6)throw Error(p$3(345));return d.finishedWork=d.current.alternate,d.finishedLanes=g,Pk(d,tk,uk),Dk(d,B$2()),null}function Qk(d,g){var b=K$2;K$2|=1;try{return d(g)}finally{K$2=b,K$2===0&&(Gj=B$2()+500,fg$1&&jg())}}function Rk(d){wk!==null&&wk.tag===0&&!(K$2&6)&&Hk();var g=K$2;K$2|=1;var b=ok.transition,et=C;try{if(ok.transition=null,C=1,d)return d()}finally{C=et,ok.transition=b,K$2=g,!(K$2&6)&&jg()}}function Hj(){fj=ej.current,E$1(ej)}function Kk(d,g){d.finishedWork=null,d.finishedLanes=0;var b=d.timeoutHandle;if(b!==-1&&(d.timeoutHandle=-1,Gf$1(b)),Y$2!==null)for(b=Y$2.return;b!==null;){var et=b;switch(wg$1(et),et.tag){case 1:et=et.type.childContextTypes,et!=null&&$f$1();break;case 3:zh$1(),E$1(Wf$1),E$1(H$2),Eh$1();break;case 5:Bh$1(et);break;case 4:zh$1();break;case 13:E$1(L$2);break;case 19:E$1(L$2);break;case 10:ah(et.type._context);break;case 22:case 23:Hj()}b=b.return}if(Q$3=d,Y$2=d=Pg(d.current,null),Z$2=fj=g,T$2=0,pk=null,rk=qk=rh$1=0,tk=sk=null,fh!==null){for(g=0;g<fh.length;g++)if(b=fh[g],et=b.interleaved,et!==null){b.interleaved=null;var st=et.next,at=b.pending;if(at!==null){var vt=at.next;at.next=st,et.next=vt}b.pending=et}fh=null}return d}function Mk(d,g){do{var b=Y$2;try{if($g(),Fh$1.current=Rh$1,Ih){for(var et=M$3.memoizedState;et!==null;){var st=et.queue;st!==null&&(st.pending=null),et=et.next}Ih=!1}if(Hh$1=0,O$1=N$2=M$3=null,Jh$1=!1,Kh$1=0,nk.current=null,b===null||b.return===null){T$2=1,pk=g,Y$2=null;break}e:{var at=d,vt=b.return,Tt=b,Ct=g;if(g=Z$2,Tt.flags|=32768,Ct!==null&&typeof Ct=="object"&&typeof Ct.then=="function"){var pt=Ct,wt=Tt,$t=wt.tag;if(!(wt.mode&1)&&($t===0||$t===11||$t===15)){var Lt=wt.alternate;Lt?(wt.updateQueue=Lt.updateQueue,wt.memoizedState=Lt.memoizedState,wt.lanes=Lt.lanes):(wt.updateQueue=null,wt.memoizedState=null)}var jt=Ui$2(vt);if(jt!==null){jt.flags&=-257,Vi$1(jt,vt,Tt,at,g),jt.mode&1&&Si$1(at,pt,g),g=jt,Ct=pt;var Ft=g.updateQueue;if(Ft===null){var Gt=new Set;Gt.add(Ct),g.updateQueue=Gt}else Ft.add(Ct);break e}else{if(!(g&1)){Si$1(at,pt,g),tj();break e}Ct=Error(p$3(426))}}else if(I&&Tt.mode&1){var Ht=Ui$2(vt);if(Ht!==null){!(Ht.flags&65536)&&(Ht.flags|=256),Vi$1(Ht,vt,Tt,at,g),Jg(Ji$2(Ct,Tt));break e}}at=Ct=Ji$2(Ct,Tt),T$2!==4&&(T$2=2),sk===null?sk=[at]:sk.push(at),at=vt;do{switch(at.tag){case 3:at.flags|=65536,g&=-g,at.lanes|=g;var qt=Ni$1(at,Ct,g);ph$1(at,qt);break e;case 1:Tt=Ct;var Kt=at.type,rr=at.stateNode;if(!(at.flags&128)&&(typeof Kt.getDerivedStateFromError=="function"||rr!==null&&typeof rr.componentDidCatch=="function"&&(Ri$2===null||!Ri$2.has(rr)))){at.flags|=65536,g&=-g,at.lanes|=g;var ir=Qi$2(at,Tt,g);ph$1(at,ir);break e}}at=at.return}while(at!==null)}Sk(b)}catch(or){g=or,Y$2===b&&b!==null&&(Y$2=b=b.return);continue}break}while(!0)}function Jk(){var d=mk.current;return mk.current=Rh$1,d===null?Rh$1:d}function tj(){(T$2===0||T$2===3||T$2===2)&&(T$2=4),Q$3===null||!(rh$1&268435455)&&!(qk&268435455)||Ck(Q$3,Z$2)}function Ik(d,g){var b=K$2;K$2|=2;var et=Jk();(Q$3!==d||Z$2!==g)&&(uk=null,Kk(d,g));do try{Tk();break}catch(st){Mk(d,st)}while(!0);if($g(),K$2=b,mk.current=et,Y$2!==null)throw Error(p$3(261));return Q$3=null,Z$2=0,T$2}function Tk(){for(;Y$2!==null;)Uk(Y$2)}function Lk(){for(;Y$2!==null&&!cc$2();)Uk(Y$2)}function Uk(d){var g=Vk(d.alternate,d,fj);d.memoizedProps=d.pendingProps,g===null?Sk(d):Y$2=g,nk.current=null}function Sk(d){var g=d;do{var b=g.alternate;if(d=g.return,g.flags&32768){if(b=Ij(b,g),b!==null){b.flags&=32767,Y$2=b;return}if(d!==null)d.flags|=32768,d.subtreeFlags=0,d.deletions=null;else{T$2=6,Y$2=null;return}}else if(b=Ej(b,g,fj),b!==null){Y$2=b;return}if(g=g.sibling,g!==null){Y$2=g;return}Y$2=g=d}while(g!==null);T$2===0&&(T$2=5)}function Pk(d,g,b){var et=C,st=ok.transition;try{ok.transition=null,C=1,Wk(d,g,b,et)}finally{ok.transition=st,C=et}return null}function Wk(d,g,b,et){do Hk();while(wk!==null);if(K$2&6)throw Error(p$3(327));b=d.finishedWork;var st=d.finishedLanes;if(b===null)return null;if(d.finishedWork=null,d.finishedLanes=0,b===d.current)throw Error(p$3(177));d.callbackNode=null,d.callbackPriority=0;var at=b.lanes|b.childLanes;if(Bc$2(d,at),d===Q$3&&(Y$2=Q$3=null,Z$2=0),!(b.subtreeFlags&2064)&&!(b.flags&2064)||vk||(vk=!0,Fk(hc$1,function(){return Hk(),null})),at=(b.flags&15990)!==0,b.subtreeFlags&15990||at){at=ok.transition,ok.transition=null;var vt=C;C=1;var Tt=K$2;K$2|=4,nk.current=null,Oj(d,b),dk(b,d),Oe(Df$1),dd$2=!!Cf$1,Df$1=Cf$1=null,d.current=b,hk(b),dc$2(),K$2=Tt,C=vt,ok.transition=at}else d.current=b;if(vk&&(vk=!1,wk=d,xk=st),at=d.pendingLanes,at===0&&(Ri$2=null),mc$2(b.stateNode),Dk(d,B$2()),g!==null)for(et=d.onRecoverableError,b=0;b<g.length;b++)st=g[b],et(st.value,{componentStack:st.stack,digest:st.digest});if(Oi$2)throw Oi$2=!1,d=Pi$2,Pi$2=null,d;return xk&1&&d.tag!==0&&Hk(),at=d.pendingLanes,at&1?d===zk?yk++:(yk=0,zk=d):yk=0,jg(),null}function Hk(){if(wk!==null){var d=Dc$2(xk),g=ok.transition,b=C;try{if(ok.transition=null,C=16>d?16:d,wk===null)var et=!1;else{if(d=wk,wk=null,xk=0,K$2&6)throw Error(p$3(331));var st=K$2;for(K$2|=4,V$2=d.current;V$2!==null;){var at=V$2,vt=at.child;if(V$2.flags&16){var Tt=at.deletions;if(Tt!==null){for(var Ct=0;Ct<Tt.length;Ct++){var pt=Tt[Ct];for(V$2=pt;V$2!==null;){var wt=V$2;switch(wt.tag){case 0:case 11:case 15:Pj(8,wt,at)}var $t=wt.child;if($t!==null)$t.return=wt,V$2=$t;else for(;V$2!==null;){wt=V$2;var Lt=wt.sibling,jt=wt.return;if(Sj(wt),wt===pt){V$2=null;break}if(Lt!==null){Lt.return=jt,V$2=Lt;break}V$2=jt}}}var Ft=at.alternate;if(Ft!==null){var Gt=Ft.child;if(Gt!==null){Ft.child=null;do{var Ht=Gt.sibling;Gt.sibling=null,Gt=Ht}while(Gt!==null)}}V$2=at}}if(at.subtreeFlags&2064&&vt!==null)vt.return=at,V$2=vt;else e:for(;V$2!==null;){if(at=V$2,at.flags&2048)switch(at.tag){case 0:case 11:case 15:Pj(9,at,at.return)}var qt=at.sibling;if(qt!==null){qt.return=at.return,V$2=qt;break e}V$2=at.return}}var Kt=d.current;for(V$2=Kt;V$2!==null;){vt=V$2;var rr=vt.child;if(vt.subtreeFlags&2064&&rr!==null)rr.return=vt,V$2=rr;else e:for(vt=Kt;V$2!==null;){if(Tt=V$2,Tt.flags&2048)try{switch(Tt.tag){case 0:case 11:case 15:Qj(9,Tt)}}catch(or){W$1(Tt,Tt.return,or)}if(Tt===vt){V$2=null;break e}var ir=Tt.sibling;if(ir!==null){ir.return=Tt.return,V$2=ir;break e}V$2=Tt.return}}if(K$2=st,jg(),lc$2&&typeof lc$2.onPostCommitFiberRoot=="function")try{lc$2.onPostCommitFiberRoot(kc$2,d)}catch{}et=!0}return et}finally{C=b,ok.transition=g}}return!1}function Xk(d,g,b){g=Ji$2(b,g),g=Ni$1(d,g,1),d=nh$1(d,g,1),g=R$1(),d!==null&&(Ac$2(d,1,g),Dk(d,g))}function W$1(d,g,b){if(d.tag===3)Xk(d,d,b);else for(;g!==null;){if(g.tag===3){Xk(g,d,b);break}else if(g.tag===1){var et=g.stateNode;if(typeof g.type.getDerivedStateFromError=="function"||typeof et.componentDidCatch=="function"&&(Ri$2===null||!Ri$2.has(et))){d=Ji$2(b,d),d=Qi$2(g,d,1),g=nh$1(g,d,1),d=R$1(),g!==null&&(Ac$2(g,1,d),Dk(g,d));break}}g=g.return}}function Ti$1(d,g,b){var et=d.pingCache;et!==null&&et.delete(g),g=R$1(),d.pingedLanes|=d.suspendedLanes&b,Q$3===d&&(Z$2&b)===b&&(T$2===4||T$2===3&&(Z$2&130023424)===Z$2&&500>B$2()-fk?Kk(d,0):rk|=b),Dk(d,g)}function Yk(d,g){g===0&&(d.mode&1?(g=sc$2,sc$2<<=1,!(sc$2&130023424)&&(sc$2=4194304)):g=1);var b=R$1();d=ih$1(d,g),d!==null&&(Ac$2(d,g,b),Dk(d,b))}function uj(d){var g=d.memoizedState,b=0;g!==null&&(b=g.retryLane),Yk(d,b)}function bk(d,g){var b=0;switch(d.tag){case 13:var et=d.stateNode,st=d.memoizedState;st!==null&&(b=st.retryLane);break;case 19:et=d.stateNode;break;default:throw Error(p$3(314))}et!==null&&et.delete(g),Yk(d,b)}var Vk;Vk=function(d,g,b){if(d!==null)if(d.memoizedProps!==g.pendingProps||Wf$1.current)dh$1=!0;else{if(!(d.lanes&b)&&!(g.flags&128))return dh$1=!1,yj(d,g,b);dh$1=!!(d.flags&131072)}else dh$1=!1,I&&g.flags&1048576&&ug$1(g,ng$1,g.index);switch(g.lanes=0,g.tag){case 2:var et=g.type;ij(d,g),d=g.pendingProps;var st=Yf$1(g,H$2.current);ch$1(g,b),st=Nh$1(null,g,et,d,st,b);var at=Sh$1();return g.flags|=1,typeof st=="object"&&st!==null&&typeof st.render=="function"&&st.$$typeof===void 0?(g.tag=1,g.memoizedState=null,g.updateQueue=null,Zf$1(et)?(at=!0,cg$1(g)):at=!1,g.memoizedState=st.state!==null&&st.state!==void 0?st.state:null,kh$1(g),st.updater=Ei$1,g.stateNode=st,st._reactInternals=g,Ii$1(g,et,d,b),g=jj(null,g,et,!0,at,b)):(g.tag=0,I&&at&&vg$1(g),Xi$2(null,g,st,b),g=g.child),g;case 16:et=g.elementType;e:{switch(ij(d,g),d=g.pendingProps,st=et._init,et=st(et._payload),g.type=et,st=g.tag=Zk(et),d=Ci$1(et,d),st){case 0:g=cj(null,g,et,d,b);break e;case 1:g=hj(null,g,et,d,b);break e;case 11:g=Yi$2(null,g,et,d,b);break e;case 14:g=$i$1(null,g,et,Ci$1(et.type,d),b);break e}throw Error(p$3(306,et,""))}return g;case 0:return et=g.type,st=g.pendingProps,st=g.elementType===et?st:Ci$1(et,st),cj(d,g,et,st,b);case 1:return et=g.type,st=g.pendingProps,st=g.elementType===et?st:Ci$1(et,st),hj(d,g,et,st,b);case 3:e:{if(kj(g),d===null)throw Error(p$3(387));et=g.pendingProps,at=g.memoizedState,st=at.element,lh$1(d,g),qh$1(g,et,null,b);var vt=g.memoizedState;if(et=vt.element,at.isDehydrated)if(at={element:et,isDehydrated:!1,cache:vt.cache,pendingSuspenseBoundaries:vt.pendingSuspenseBoundaries,transitions:vt.transitions},g.updateQueue.baseState=at,g.memoizedState=at,g.flags&256){st=Ji$2(Error(p$3(423)),g),g=lj(d,g,et,b,st);break e}else if(et!==st){st=Ji$2(Error(p$3(424)),g),g=lj(d,g,et,b,st);break e}else for(yg=Lf$1(g.stateNode.containerInfo.firstChild),xg$1=g,I=!0,zg=null,b=Vg(g,null,et,b),g.child=b;b;)b.flags=b.flags&-3|4096,b=b.sibling;else{if(Ig(),et===st){g=Zi$2(d,g,b);break e}Xi$2(d,g,et,b)}g=g.child}return g;case 5:return Ah$1(g),d===null&&Eg(g),et=g.type,st=g.pendingProps,at=d!==null?d.memoizedProps:null,vt=st.children,Ef$1(et,st)?vt=null:at!==null&&Ef$1(et,at)&&(g.flags|=32),gj(d,g),Xi$2(d,g,vt,b),g.child;case 6:return d===null&&Eg(g),null;case 13:return oj(d,g,b);case 4:return yh$1(g,g.stateNode.containerInfo),et=g.pendingProps,d===null?g.child=Ug(g,null,et,b):Xi$2(d,g,et,b),g.child;case 11:return et=g.type,st=g.pendingProps,st=g.elementType===et?st:Ci$1(et,st),Yi$2(d,g,et,st,b);case 7:return Xi$2(d,g,g.pendingProps,b),g.child;case 8:return Xi$2(d,g,g.pendingProps.children,b),g.child;case 12:return Xi$2(d,g,g.pendingProps.children,b),g.child;case 10:e:{if(et=g.type._context,st=g.pendingProps,at=g.memoizedProps,vt=st.value,G$2(Wg,et._currentValue),et._currentValue=vt,at!==null)if(He$1(at.value,vt)){if(at.children===st.children&&!Wf$1.current){g=Zi$2(d,g,b);break e}}else for(at=g.child,at!==null&&(at.return=g);at!==null;){var Tt=at.dependencies;if(Tt!==null){vt=at.child;for(var Ct=Tt.firstContext;Ct!==null;){if(Ct.context===et){if(at.tag===1){Ct=mh$1(-1,b&-b),Ct.tag=2;var pt=at.updateQueue;if(pt!==null){pt=pt.shared;var wt=pt.pending;wt===null?Ct.next=Ct:(Ct.next=wt.next,wt.next=Ct),pt.pending=Ct}}at.lanes|=b,Ct=at.alternate,Ct!==null&&(Ct.lanes|=b),bh$1(at.return,b,g),Tt.lanes|=b;break}Ct=Ct.next}}else if(at.tag===10)vt=at.type===g.type?null:at.child;else if(at.tag===18){if(vt=at.return,vt===null)throw Error(p$3(341));vt.lanes|=b,Tt=vt.alternate,Tt!==null&&(Tt.lanes|=b),bh$1(vt,b,g),vt=at.sibling}else vt=at.child;if(vt!==null)vt.return=at;else for(vt=at;vt!==null;){if(vt===g){vt=null;break}if(at=vt.sibling,at!==null){at.return=vt.return,vt=at;break}vt=vt.return}at=vt}Xi$2(d,g,st.children,b),g=g.child}return g;case 9:return st=g.type,et=g.pendingProps.children,ch$1(g,b),st=eh$1(st),et=et(st),g.flags|=1,Xi$2(d,g,et,b),g.child;case 14:return et=g.type,st=Ci$1(et,g.pendingProps),st=Ci$1(et.type,st),$i$1(d,g,et,st,b);case 15:return bj(d,g,g.type,g.pendingProps,b);case 17:return et=g.type,st=g.pendingProps,st=g.elementType===et?st:Ci$1(et,st),ij(d,g),g.tag=1,Zf$1(et)?(d=!0,cg$1(g)):d=!1,ch$1(g,b),Gi$2(g,et,st),Ii$1(g,et,st,b),jj(null,g,et,!0,d,b);case 19:return xj(d,g,b);case 22:return dj(d,g,b)}throw Error(p$3(156,g.tag))};function Fk(d,g){return ac$2(d,g)}function $k(d,g,b,et){this.tag=d,this.key=b,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=g,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=et,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Bg(d,g,b,et){return new $k(d,g,b,et)}function aj(d){return d=d.prototype,!(!d||!d.isReactComponent)}function Zk(d){if(typeof d=="function")return aj(d)?1:0;if(d!=null){if(d=d.$$typeof,d===Da$1)return 11;if(d===Ga$1)return 14}return 2}function Pg(d,g){var b=d.alternate;return b===null?(b=Bg(d.tag,g,d.key,d.mode),b.elementType=d.elementType,b.type=d.type,b.stateNode=d.stateNode,b.alternate=d,d.alternate=b):(b.pendingProps=g,b.type=d.type,b.flags=0,b.subtreeFlags=0,b.deletions=null),b.flags=d.flags&14680064,b.childLanes=d.childLanes,b.lanes=d.lanes,b.child=d.child,b.memoizedProps=d.memoizedProps,b.memoizedState=d.memoizedState,b.updateQueue=d.updateQueue,g=d.dependencies,b.dependencies=g===null?null:{lanes:g.lanes,firstContext:g.firstContext},b.sibling=d.sibling,b.index=d.index,b.ref=d.ref,b}function Rg(d,g,b,et,st,at){var vt=2;if(et=d,typeof d=="function")aj(d)&&(vt=1);else if(typeof d=="string")vt=5;else e:switch(d){case ya$1:return Tg$1(b.children,st,at,g);case za$1:vt=8,st|=8;break;case Aa$1:return d=Bg(12,b,g,st|2),d.elementType=Aa$1,d.lanes=at,d;case Ea$1:return d=Bg(13,b,g,st),d.elementType=Ea$1,d.lanes=at,d;case Fa$1:return d=Bg(19,b,g,st),d.elementType=Fa$1,d.lanes=at,d;case Ia$1:return pj(b,st,at,g);default:if(typeof d=="object"&&d!==null)switch(d.$$typeof){case Ba$1:vt=10;break e;case Ca$1:vt=9;break e;case Da$1:vt=11;break e;case Ga$1:vt=14;break e;case Ha$2:vt=16,et=null;break e}throw Error(p$3(130,d==null?d:typeof d,""))}return g=Bg(vt,b,g,st),g.elementType=d,g.type=et,g.lanes=at,g}function Tg$1(d,g,b,et){return d=Bg(7,d,et,g),d.lanes=b,d}function pj(d,g,b,et){return d=Bg(22,d,et,g),d.elementType=Ia$1,d.lanes=b,d.stateNode={isHidden:!1},d}function Qg(d,g,b){return d=Bg(6,d,null,g),d.lanes=b,d}function Sg(d,g,b){return g=Bg(4,d.children!==null?d.children:[],d.key,g),g.lanes=b,g.stateNode={containerInfo:d.containerInfo,pendingChildren:null,implementation:d.implementation},g}function al$2(d,g,b,et,st){this.tag=g,this.containerInfo=d,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=zc$2(0),this.expirationTimes=zc$2(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=zc$2(0),this.identifierPrefix=et,this.onRecoverableError=st,this.mutableSourceEagerHydrationData=null}function bl$2(d,g,b,et,st,at,vt,Tt,Ct){return d=new al$2(d,g,b,Tt,Ct),g===1?(g=1,at===!0&&(g|=8)):g=0,at=Bg(3,null,null,g),d.current=at,at.stateNode=d,at.memoizedState={element:et,isDehydrated:b,cache:null,transitions:null,pendingSuspenseBoundaries:null},kh$1(at),d}function cl$2(d,g,b){var et=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:wa$1,key:et==null?null:""+et,children:d,containerInfo:g,implementation:b}}function dl$2(d){if(!d)return Vf$1;d=d._reactInternals;e:{if(Vb$1(d)!==d||d.tag!==1)throw Error(p$3(170));var g=d;do{switch(g.tag){case 3:g=g.stateNode.context;break e;case 1:if(Zf$1(g.type)){g=g.stateNode.__reactInternalMemoizedMergedChildContext;break e}}g=g.return}while(g!==null);throw Error(p$3(171))}if(d.tag===1){var b=d.type;if(Zf$1(b))return bg$1(d,b,g)}return g}function el$2(d,g,b,et,st,at,vt,Tt,Ct){return d=bl$2(b,et,!0,d,st,at,vt,Tt,Ct),d.context=dl$2(null),b=d.current,et=R$1(),st=yi$1(b),at=mh$1(et,st),at.callback=g??null,nh$1(b,at,st),d.current.lanes=st,Ac$2(d,st,et),Dk(d,et),d}function fl$2(d,g,b,et){var st=g.current,at=R$1(),vt=yi$1(st);return b=dl$2(b),g.context===null?g.context=b:g.pendingContext=b,g=mh$1(at,vt),g.payload={element:d},et=et===void 0?null:et,et!==null&&(g.callback=et),d=nh$1(st,g,vt),d!==null&&(gi$1(d,st,vt,at),oh$1(d,st,vt)),vt}function gl$2(d){if(d=d.current,!d.child)return null;switch(d.child.tag){case 5:return d.child.stateNode;default:return d.child.stateNode}}function hl$2(d,g){if(d=d.memoizedState,d!==null&&d.dehydrated!==null){var b=d.retryLane;d.retryLane=b!==0&&b<g?b:g}}function il$2(d,g){hl$2(d,g),(d=d.alternate)&&hl$2(d,g)}function jl$2(){return null}var kl$2=typeof reportError=="function"?reportError:function(d){console.error(d)};function ll$2(d){this._internalRoot=d}ml$2.prototype.render=ll$2.prototype.render=function(d){var g=this._internalRoot;if(g===null)throw Error(p$3(409));fl$2(d,g,null,null)};ml$2.prototype.unmount=ll$2.prototype.unmount=function(){var d=this._internalRoot;if(d!==null){this._internalRoot=null;var g=d.containerInfo;Rk(function(){fl$2(null,d,null,null)}),g[uf$2]=null}};function ml$2(d){this._internalRoot=d}ml$2.prototype.unstable_scheduleHydration=function(d){if(d){var g=Hc$2();d={blockedOn:null,target:d,priority:g};for(var b=0;b<Qc$2.length&&g!==0&&g<Qc$2[b].priority;b++);Qc$2.splice(b,0,d),b===0&&Vc$2(d)}};function nl$2(d){return!(!d||d.nodeType!==1&&d.nodeType!==9&&d.nodeType!==11)}function ol$2(d){return!(!d||d.nodeType!==1&&d.nodeType!==9&&d.nodeType!==11&&(d.nodeType!==8||d.nodeValue!==" react-mount-point-unstable "))}function pl$2(){}function ql$2(d,g,b,et,st){if(st){if(typeof et=="function"){var at=et;et=function(){var pt=gl$2(vt);at.call(pt)}}var vt=el$2(g,et,d,0,null,!1,!1,"",pl$2);return d._reactRootContainer=vt,d[uf$2]=vt.current,sf$2(d.nodeType===8?d.parentNode:d),Rk(),vt}for(;st=d.lastChild;)d.removeChild(st);if(typeof et=="function"){var Tt=et;et=function(){var pt=gl$2(Ct);Tt.call(pt)}}var Ct=bl$2(d,0,!1,null,null,!1,!1,"",pl$2);return d._reactRootContainer=Ct,d[uf$2]=Ct.current,sf$2(d.nodeType===8?d.parentNode:d),Rk(function(){fl$2(g,Ct,b,et)}),Ct}function rl$2(d,g,b,et,st){var at=b._reactRootContainer;if(at){var vt=at;if(typeof st=="function"){var Tt=st;st=function(){var Ct=gl$2(vt);Tt.call(Ct)}}fl$2(g,vt,d,st)}else vt=ql$2(b,g,d,st,et);return gl$2(vt)}Ec$2=function(d){switch(d.tag){case 3:var g=d.stateNode;if(g.current.memoizedState.isDehydrated){var b=tc$1(g.pendingLanes);b!==0&&(Cc$2(g,b|1),Dk(g,B$2()),!(K$2&6)&&(Gj=B$2()+500,jg()))}break;case 13:Rk(function(){var et=ih$1(d,1);if(et!==null){var st=R$1();gi$1(et,d,1,st)}}),il$2(d,1)}};Fc$2=function(d){if(d.tag===13){var g=ih$1(d,134217728);if(g!==null){var b=R$1();gi$1(g,d,134217728,b)}il$2(d,134217728)}};Gc$2=function(d){if(d.tag===13){var g=yi$1(d),b=ih$1(d,g);if(b!==null){var et=R$1();gi$1(b,d,g,et)}il$2(d,g)}};Hc$2=function(){return C};Ic$2=function(d,g){var b=C;try{return C=d,g()}finally{C=b}};yb$1=function(d,g,b){switch(g){case"input":if(bb$1(d,b),g=b.name,b.type==="radio"&&g!=null){for(b=d;b.parentNode;)b=b.parentNode;for(b=b.querySelectorAll("input[name="+JSON.stringify(""+g)+'][type="radio"]'),g=0;g<b.length;g++){var et=b[g];if(et!==d&&et.form===d.form){var st=Db$1(et);if(!st)throw Error(p$3(90));Wa$1(et),bb$1(et,st)}}}break;case"textarea":ib$1(d,b);break;case"select":g=b.value,g!=null&&fb$1(d,!!b.multiple,g,!1)}};Gb$1=Qk;Hb=Rk;var sl$2={usingClientEntryPoint:!1,Events:[Cb$1,ue$1,Db$1,Eb$1,Fb$1,Qk]},tl$2={findFiberByHostInstance:Wc$2,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},ul$2={bundleType:tl$2.bundleType,version:tl$2.version,rendererPackageName:tl$2.rendererPackageName,rendererConfig:tl$2.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:ua$2.ReactCurrentDispatcher,findHostInstanceByFiber:function(d){return d=Zb$1(d),d===null?null:d.stateNode},findFiberByHostInstance:tl$2.findFiberByHostInstance||jl$2,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var vl$2=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!vl$2.isDisabled&&vl$2.supportsFiber)try{kc$2=vl$2.inject(ul$2),lc$2=vl$2}catch{}}reactDom_production_min.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=sl$2;reactDom_production_min.createPortal=function(d,g){var b=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!nl$2(g))throw Error(p$3(200));return cl$2(d,g,null,b)};reactDom_production_min.createRoot=function(d,g){if(!nl$2(d))throw Error(p$3(299));var b=!1,et="",st=kl$2;return g!=null&&(g.unstable_strictMode===!0&&(b=!0),g.identifierPrefix!==void 0&&(et=g.identifierPrefix),g.onRecoverableError!==void 0&&(st=g.onRecoverableError)),g=bl$2(d,1,!1,null,null,b,!1,et,st),d[uf$2]=g.current,sf$2(d.nodeType===8?d.parentNode:d),new ll$2(g)};reactDom_production_min.findDOMNode=function(d){if(d==null)return null;if(d.nodeType===1)return d;var g=d._reactInternals;if(g===void 0)throw typeof d.render=="function"?Error(p$3(188)):(d=Object.keys(d).join(","),Error(p$3(268,d)));return d=Zb$1(g),d=d===null?null:d.stateNode,d};reactDom_production_min.flushSync=function(d){return Rk(d)};reactDom_production_min.hydrate=function(d,g,b){if(!ol$2(g))throw Error(p$3(200));return rl$2(null,d,g,!0,b)};reactDom_production_min.hydrateRoot=function(d,g,b){if(!nl$2(d))throw Error(p$3(405));var et=b!=null&&b.hydratedSources||null,st=!1,at="",vt=kl$2;if(b!=null&&(b.unstable_strictMode===!0&&(st=!0),b.identifierPrefix!==void 0&&(at=b.identifierPrefix),b.onRecoverableError!==void 0&&(vt=b.onRecoverableError)),g=el$2(g,null,d,1,b??null,st,!1,at,vt),d[uf$2]=g.current,sf$2(d),et)for(d=0;d<et.length;d++)b=et[d],st=b._getVersion,st=st(b._source),g.mutableSourceEagerHydrationData==null?g.mutableSourceEagerHydrationData=[b,st]:g.mutableSourceEagerHydrationData.push(b,st);return new ml$2(g)};reactDom_production_min.render=function(d,g,b){if(!ol$2(g))throw Error(p$3(200));return rl$2(null,d,g,!1,b)};reactDom_production_min.unmountComponentAtNode=function(d){if(!ol$2(d))throw Error(p$3(40));return d._reactRootContainer?(Rk(function(){rl$2(null,null,d,!1,function(){d._reactRootContainer=null,d[uf$2]=null})}),!0):!1};reactDom_production_min.unstable_batchedUpdates=Qk;reactDom_production_min.unstable_renderSubtreeIntoContainer=function(d,g,b,et){if(!ol$2(b))throw Error(p$3(200));if(d==null||d._reactInternals===void 0)throw Error(p$3(38));return rl$2(d,g,b,!1,et)};reactDom_production_min.version="18.3.1-next-f1338f8080-20240426";function checkDCE(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(checkDCE)}catch(d){console.error(d)}}checkDCE(),reactDom.exports=reactDom_production_min;var reactDomExports=reactDom.exports;const $7SXl2$reactdom=getDefaultExportFromCjs(reactDomExports);var m$2=reactDomExports;client.createRoot=m$2.createRoot,client.hydrateRoot=m$2.hydrateRoot;var Subscribable=class{constructor(){this.listeners=new Set,this.subscribe=this.subscribe.bind(this)}subscribe(d){return this.listeners.add(d),this.onSubscribe(),()=>{this.listeners.delete(d),this.onUnsubscribe()}}hasListeners(){return this.listeners.size>0}onSubscribe(){}onUnsubscribe(){}},isServer=typeof window>"u"||"Deno"in globalThis;function noop$3(){}function functionalUpdate(d,g){return typeof d=="function"?d(g):d}function isValidTimeout(d){return typeof d=="number"&&d>=0&&d!==1/0}function timeUntilStale(d,g){return Math.max(d+(g||0)-Date.now(),0)}function matchQuery(d,g){const{type:b="all",exact:et,fetchStatus:st,predicate:at,queryKey:vt,stale:Tt}=d;if(vt){if(et){if(g.queryHash!==hashQueryKeyByOptions(vt,g.options))return!1}else if(!partialMatchKey(g.queryKey,vt))return!1}if(b!=="all"){const Ct=g.isActive();if(b==="active"&&!Ct||b==="inactive"&&Ct)return!1}return!(typeof Tt=="boolean"&&g.isStale()!==Tt||st&&st!==g.state.fetchStatus||at&&!at(g))}function matchMutation(d,g){const{exact:b,status:et,predicate:st,mutationKey:at}=d;if(at){if(!g.options.mutationKey)return!1;if(b){if(hashKey(g.options.mutationKey)!==hashKey(at))return!1}else if(!partialMatchKey(g.options.mutationKey,at))return!1}return!(et&&g.state.status!==et||st&&!st(g))}function hashQueryKeyByOptions(d,g){return((g==null?void 0:g.queryKeyHashFn)||hashKey)(d)}function hashKey(d){return JSON.stringify(d,(g,b)=>isPlainObject$3(b)?Object.keys(b).sort().reduce((et,st)=>(et[st]=b[st],et),{}):b)}function partialMatchKey(d,g){return d===g?!0:typeof d!=typeof g?!1:d&&g&&typeof d=="object"&&typeof g=="object"?!Object.keys(g).some(b=>!partialMatchKey(d[b],g[b])):!1}function replaceEqualDeep(d,g){if(d===g)return d;const b=isPlainArray(d)&&isPlainArray(g);if(b||isPlainObject$3(d)&&isPlainObject$3(g)){const et=b?d:Object.keys(d),st=et.length,at=b?g:Object.keys(g),vt=at.length,Tt=b?[]:{};let Ct=0;for(let pt=0;pt<vt;pt++){const wt=b?pt:at[pt];(!b&&et.includes(wt)||b)&&d[wt]===void 0&&g[wt]===void 0?(Tt[wt]=void 0,Ct++):(Tt[wt]=replaceEqualDeep(d[wt],g[wt]),Tt[wt]===d[wt]&&d[wt]!==void 0&&Ct++)}return st===vt&&Ct===st?d:Tt}return g}function isPlainArray(d){return Array.isArray(d)&&d.length===Object.keys(d).length}function isPlainObject$3(d){if(!hasObjectPrototype(d))return!1;const g=d.constructor;if(g===void 0)return!0;const b=g.prototype;return!(!hasObjectPrototype(b)||!b.hasOwnProperty("isPrototypeOf")||Object.getPrototypeOf(d)!==Object.prototype)}function hasObjectPrototype(d){return Object.prototype.toString.call(d)==="[object Object]"}function sleep(d){return new Promise(g=>{setTimeout(g,d)})}function replaceData(d,g,b){return typeof b.structuralSharing=="function"?b.structuralSharing(d,g):b.structuralSharing!==!1?replaceEqualDeep(d,g):g}function addToEnd(d,g,b=0){const et=[...d,g];return b&&et.length>b?et.slice(1):et}function addToStart(d,g,b=0){const et=[g,...d];return b&&et.length>b?et.slice(0,-1):et}var skipToken=Symbol(),L$,_$,ix,MS,FocusManager=(MS=class extends Subscribable{constructor(){super();rv(this,L$,void 0);rv(this,_$,void 0);rv(this,ix,void 0);F1(this,ix,g=>{if(!isServer&&window.addEventListener){const b=()=>g();return window.addEventListener("visibilitychange",b,!1),()=>{window.removeEventListener("visibilitychange",b)}}})}onSubscribe(){X0(this,_$)||this.setEventListener(X0(this,ix))}onUnsubscribe(){var g;this.hasListeners()||((g=X0(this,_$))==null||g.call(this),F1(this,_$,void 0))}setEventListener(g){var b;F1(this,ix,g),(b=X0(this,_$))==null||b.call(this),F1(this,_$,g(et=>{typeof et=="boolean"?this.setFocused(et):this.onFocus()}))}setFocused(g){X0(this,L$)!==g&&(F1(this,L$,g),this.onFocus())}onFocus(){const g=this.isFocused();this.listeners.forEach(b=>{b(g)})}isFocused(){var g;return typeof X0(this,L$)=="boolean"?X0(this,L$):((g=globalThis.document)==null?void 0:g.visibilityState)!=="hidden"}},L$=new WeakMap,_$=new WeakMap,ix=new WeakMap,MS),focusManager=new FocusManager,ox,S$,ax,NS,OnlineManager=(NS=class extends Subscribable{constructor(){super();rv(this,ox,!0);rv(this,S$,void 0);rv(this,ax,void 0);F1(this,ax,g=>{if(!isServer&&window.addEventListener){const b=()=>g(!0),et=()=>g(!1);return window.addEventListener("online",b,!1),window.addEventListener("offline",et,!1),()=>{window.removeEventListener("online",b),window.removeEventListener("offline",et)}}})}onSubscribe(){X0(this,S$)||this.setEventListener(X0(this,ax))}onUnsubscribe(){var g;this.hasListeners()||((g=X0(this,S$))==null||g.call(this),F1(this,S$,void 0))}setEventListener(g){var b;F1(this,ax,g),(b=X0(this,S$))==null||b.call(this),F1(this,S$,g(this.setOnline.bind(this)))}setOnline(g){X0(this,ox)!==g&&(F1(this,ox,g),this.listeners.forEach(et=>{et(g)}))}isOnline(){return X0(this,ox)}},ox=new WeakMap,S$=new WeakMap,ax=new WeakMap,NS),onlineManager=new OnlineManager;function defaultRetryDelay(d){return Math.min(1e3*2**d,3e4)}function canFetch(d){return(d??"online")==="online"?onlineManager.isOnline():!0}var CancelledError=class{constructor(d){this.revert=d==null?void 0:d.revert,this.silent=d==null?void 0:d.silent}};function isCancelledError(d){return d instanceof CancelledError}function createRetryer(d){let g=!1,b=0,et=!1,st,at,vt;const Tt=new Promise((qt,Kt)=>{at=qt,vt=Kt}),Ct=qt=>{var Kt;et||(Ft(new CancelledError(qt)),(Kt=d.abort)==null||Kt.call(d))},pt=()=>{g=!0},wt=()=>{g=!1},$t=()=>focusManager.isFocused()&&(d.networkMode==="always"||onlineManager.isOnline())&&d.canRun(),Lt=()=>canFetch(d.networkMode)&&d.canRun(),jt=qt=>{var Kt;et||(et=!0,(Kt=d.onSuccess)==null||Kt.call(d,qt),st==null||st(),at(qt))},Ft=qt=>{var Kt;et||(et=!0,(Kt=d.onError)==null||Kt.call(d,qt),st==null||st(),vt(qt))},Gt=()=>new Promise(qt=>{var Kt;st=rr=>{(et||$t())&&qt(rr)},(Kt=d.onPause)==null||Kt.call(d)}).then(()=>{var qt;st=void 0,et||(qt=d.onContinue)==null||qt.call(d)}),Ht=()=>{if(et)return;let qt;try{qt=d.fn()}catch(Kt){qt=Promise.reject(Kt)}Promise.resolve(qt).then(jt).catch(Kt=>{var qr;if(et)return;const rr=d.retry??(isServer?0:3),ir=d.retryDelay??defaultRetryDelay,or=typeof ir=="function"?ir(b,Kt):ir,jr=rr===!0||typeof rr=="number"&&b<rr||typeof rr=="function"&&rr(b,Kt);if(g||!jr){Ft(Kt);return}b++,(qr=d.onFail)==null||qr.call(d,b,Kt),sleep(or).then(()=>$t()?void 0:Gt()).then(()=>{g?Ft(Kt):Ht()})})};return{promise:Tt,cancel:Ct,continue:()=>(st==null||st(),Tt),cancelRetry:pt,continueRetry:wt,canStart:Lt,start:()=>(Lt()?Ht():Gt().then(Ht),Tt)}}function createNotifyManager(){let d=[],g=0,b=Lt=>{Lt()},et=Lt=>{Lt()},st=Lt=>setTimeout(Lt,0);const at=Lt=>{st=Lt},vt=Lt=>{let jt;g++;try{jt=Lt()}finally{g--,g||pt()}return jt},Tt=Lt=>{g?d.push(Lt):st(()=>{b(Lt)})},Ct=Lt=>(...jt)=>{Tt(()=>{Lt(...jt)})},pt=()=>{const Lt=d;d=[],Lt.length&&st(()=>{et(()=>{Lt.forEach(jt=>{b(jt)})})})};return{batch:vt,batchCalls:Ct,schedule:Tt,setNotifyFunction:Lt=>{b=Lt},setBatchNotifyFunction:Lt=>{et=Lt},setScheduler:at}}var notifyManager=createNotifyManager(),j$,LS,Removable=(LS=class{constructor(){rv(this,j$,void 0)}destroy(){this.clearGcTimeout()}scheduleGc(){this.clearGcTimeout(),isValidTimeout(this.gcTime)&&F1(this,j$,setTimeout(()=>{this.optionalRemove()},this.gcTime))}updateGcTime(d){this.gcTime=Math.max(this.gcTime||0,d??(isServer?1/0:5*60*1e3))}clearGcTimeout(){X0(this,j$)&&(clearTimeout(X0(this,j$)),F1(this,j$,void 0))}},j$=new WeakMap,LS),sx,lx,_y,Kv,Yx,F$,jy,c$,jS,Query=(jS=class extends Removable{constructor(g){super();rv(this,jy);rv(this,sx,void 0);rv(this,lx,void 0);rv(this,_y,void 0);rv(this,Kv,void 0);rv(this,Yx,void 0);rv(this,F$,void 0);F1(this,F$,!1),F1(this,Yx,g.defaultOptions),this.setOptions(g.options),this.observers=[],F1(this,_y,g.cache),this.queryKey=g.queryKey,this.queryHash=g.queryHash,F1(this,sx,g.state||getDefaultState$1(this.options)),this.state=X0(this,sx),this.scheduleGc()}get meta(){return this.options.meta}setOptions(g){this.options={...X0(this,Yx),...g},this.updateGcTime(this.options.gcTime)}optionalRemove(){!this.observers.length&&this.state.fetchStatus==="idle"&&X0(this,_y).remove(this)}setData(g,b){const et=replaceData(this.state.data,g,this.options);return zv(this,jy,c$).call(this,{data:et,type:"success",dataUpdatedAt:b==null?void 0:b.updatedAt,manual:b==null?void 0:b.manual}),et}setState(g,b){zv(this,jy,c$).call(this,{type:"setState",state:g,setStateOptions:b})}cancel(g){var et,st;const b=(et=X0(this,Kv))==null?void 0:et.promise;return(st=X0(this,Kv))==null||st.cancel(g),b?b.then(noop$3).catch(noop$3):Promise.resolve()}destroy(){super.destroy(),this.cancel({silent:!0})}reset(){this.destroy(),this.setState(X0(this,sx))}isActive(){return this.observers.some(g=>g.options.enabled!==!1)}isDisabled(){return this.getObserversCount()>0&&!this.isActive()}isStale(){return this.state.isInvalidated?!0:this.getObserversCount()>0?this.observers.some(g=>g.getCurrentResult().isStale):this.state.data===void 0}isStaleByTime(g=0){return this.state.isInvalidated||this.state.data===void 0||!timeUntilStale(this.state.dataUpdatedAt,g)}onFocus(){var b;const g=this.observers.find(et=>et.shouldFetchOnWindowFocus());g==null||g.refetch({cancelRefetch:!1}),(b=X0(this,Kv))==null||b.continue()}onOnline(){var b;const g=this.observers.find(et=>et.shouldFetchOnReconnect());g==null||g.refetch({cancelRefetch:!1}),(b=X0(this,Kv))==null||b.continue()}addObserver(g){this.observers.includes(g)||(this.observers.push(g),this.clearGcTimeout(),X0(this,_y).notify({type:"observerAdded",query:this,observer:g}))}removeObserver(g){this.observers.includes(g)&&(this.observers=this.observers.filter(b=>b!==g),this.observers.length||(X0(this,Kv)&&(X0(this,F$)?X0(this,Kv).cancel({revert:!0}):X0(this,Kv).cancelRetry()),this.scheduleGc()),X0(this,_y).notify({type:"observerRemoved",query:this,observer:g}))}getObserversCount(){return this.observers.length}invalidate(){this.state.isInvalidated||zv(this,jy,c$).call(this,{type:"invalidate"})}fetch(g,b){var pt,wt,$t;if(this.state.fetchStatus!=="idle"){if(this.state.data!==void 0&&(b!=null&&b.cancelRefetch))this.cancel({silent:!0});else if(X0(this,Kv))return X0(this,Kv).continueRetry(),X0(this,Kv).promise}if(g&&this.setOptions(g),!this.options.queryFn){const Lt=this.observers.find(jt=>jt.options.queryFn);Lt&&this.setOptions(Lt.options)}const et=new AbortController,st={queryKey:this.queryKey,meta:this.meta},at=Lt=>{Object.defineProperty(Lt,"signal",{enumerable:!0,get:()=>(F1(this,F$,!0),et.signal)})};at(st);const vt=()=>!this.options.queryFn||this.options.queryFn===skipToken?Promise.reject(new Error(`Missing queryFn: '${this.options.queryHash}'`)):(F1(this,F$,!1),this.options.persister?this.options.persister(this.options.queryFn,st,this):this.options.queryFn(st)),Tt={fetchOptions:b,options:this.options,queryKey:this.queryKey,state:this.state,fetchFn:vt};at(Tt),(pt=this.options.behavior)==null||pt.onFetch(Tt,this),F1(this,lx,this.state),(this.state.fetchStatus==="idle"||this.state.fetchMeta!==((wt=Tt.fetchOptions)==null?void 0:wt.meta))&&zv(this,jy,c$).call(this,{type:"fetch",meta:($t=Tt.fetchOptions)==null?void 0:$t.meta});const Ct=Lt=>{var jt,Ft,Gt,Ht;isCancelledError(Lt)&&Lt.silent||zv(this,jy,c$).call(this,{type:"error",error:Lt}),isCancelledError(Lt)||((Ft=(jt=X0(this,_y).config).onError)==null||Ft.call(jt,Lt,this),(Ht=(Gt=X0(this,_y).config).onSettled)==null||Ht.call(Gt,this.state.data,Lt,this)),this.isFetchingOptimistic||this.scheduleGc(),this.isFetchingOptimistic=!1};return F1(this,Kv,createRetryer({fn:Tt.fetchFn,abort:et.abort.bind(et),onSuccess:Lt=>{var jt,Ft,Gt,Ht;if(Lt===void 0){Ct(new Error(`${this.queryHash} data is undefined`));return}this.setData(Lt),(Ft=(jt=X0(this,_y).config).onSuccess)==null||Ft.call(jt,Lt,this),(Ht=(Gt=X0(this,_y).config).onSettled)==null||Ht.call(Gt,Lt,this.state.error,this),this.isFetchingOptimistic||this.scheduleGc(),this.isFetchingOptimistic=!1},onError:Ct,onFail:(Lt,jt)=>{zv(this,jy,c$).call(this,{type:"failed",failureCount:Lt,error:jt})},onPause:()=>{zv(this,jy,c$).call(this,{type:"pause"})},onContinue:()=>{zv(this,jy,c$).call(this,{type:"continue"})},retry:Tt.options.retry,retryDelay:Tt.options.retryDelay,networkMode:Tt.options.networkMode,canRun:()=>!0})),X0(this,Kv).start()}},sx=new WeakMap,lx=new WeakMap,_y=new WeakMap,Kv=new WeakMap,Yx=new WeakMap,F$=new WeakMap,jy=new WeakSet,c$=function(g){const b=et=>{switch(g.type){case"failed":return{...et,fetchFailureCount:g.failureCount,fetchFailureReason:g.error};case"pause":return{...et,fetchStatus:"paused"};case"continue":return{...et,fetchStatus:"fetching"};case"fetch":return{...et,...fetchState(et.data,this.options),fetchMeta:g.meta??null};case"success":return{...et,data:g.data,dataUpdateCount:et.dataUpdateCount+1,dataUpdatedAt:g.dataUpdatedAt??Date.now(),error:null,isInvalidated:!1,status:"success",...!g.manual&&{fetchStatus:"idle",fetchFailureCount:0,fetchFailureReason:null}};case"error":const st=g.error;return isCancelledError(st)&&st.revert&&X0(this,lx)?{...X0(this,lx),fetchStatus:"idle"}:{...et,error:st,errorUpdateCount:et.errorUpdateCount+1,errorUpdatedAt:Date.now(),fetchFailureCount:et.fetchFailureCount+1,fetchFailureReason:st,fetchStatus:"idle",status:"error"};case"invalidate":return{...et,isInvalidated:!0};case"setState":return{...et,...g.state}}};this.state=b(this.state),notifyManager.batch(()=>{this.observers.forEach(et=>{et.onQueryUpdate()}),X0(this,_y).notify({query:this,type:"updated",action:g})})},jS);function fetchState(d,g){return{fetchFailureCount:0,fetchFailureReason:null,fetchStatus:canFetch(g.networkMode)?"fetching":"paused",...d===void 0&&{error:null,status:"pending"}}}function getDefaultState$1(d){const g=typeof d.initialData=="function"?d.initialData():d.initialData,b=g!==void 0,et=b?typeof d.initialDataUpdatedAt=="function"?d.initialDataUpdatedAt():d.initialDataUpdatedAt:0;return{data:g,dataUpdateCount:0,dataUpdatedAt:b?et??Date.now():0,error:null,errorUpdateCount:0,errorUpdatedAt:0,fetchFailureCount:0,fetchFailureReason:null,fetchMeta:null,isInvalidated:!1,status:b?"success":"pending",fetchStatus:"idle"}}var qy,FS,QueryCache=(FS=class extends Subscribable{constructor(g={}){super();rv(this,qy,void 0);this.config=g,F1(this,qy,new Map)}build(g,b,et){const st=b.queryKey,at=b.queryHash??hashQueryKeyByOptions(st,b);let vt=this.get(at);return vt||(vt=new Query({cache:this,queryKey:st,queryHash:at,options:g.defaultQueryOptions(b),state:et,defaultOptions:g.getQueryDefaults(st)}),this.add(vt)),vt}add(g){X0(this,qy).has(g.queryHash)||(X0(this,qy).set(g.queryHash,g),this.notify({type:"added",query:g}))}remove(g){const b=X0(this,qy).get(g.queryHash);b&&(g.destroy(),b===g&&X0(this,qy).delete(g.queryHash),this.notify({type:"removed",query:g}))}clear(){notifyManager.batch(()=>{this.getAll().forEach(g=>{this.remove(g)})})}get(g){return X0(this,qy).get(g)}getAll(){return[...X0(this,qy).values()]}find(g){const b={exact:!0,...g};return this.getAll().find(et=>matchQuery(b,et))}findAll(g={}){const b=this.getAll();return Object.keys(g).length>0?b.filter(et=>matchQuery(g,et)):b}notify(g){notifyManager.batch(()=>{this.listeners.forEach(b=>{b(g)})})}onFocus(){notifyManager.batch(()=>{this.getAll().forEach(g=>{g.onFocus()})})}onOnline(){notifyManager.batch(()=>{this.getAll().forEach(g=>{g.onOnline()})})}},qy=new WeakMap,FS),Yy,Zv,B$,Xy,x$,BS,Mutation=(BS=class extends Removable{constructor(g){super();rv(this,Xy);rv(this,Yy,void 0);rv(this,Zv,void 0);rv(this,B$,void 0);this.mutationId=g.mutationId,F1(this,Zv,g.mutationCache),F1(this,Yy,[]),this.state=g.state||getDefaultState(),this.setOptions(g.options),this.scheduleGc()}setOptions(g){this.options=g,this.updateGcTime(this.options.gcTime)}get meta(){return this.options.meta}addObserver(g){X0(this,Yy).includes(g)||(X0(this,Yy).push(g),this.clearGcTimeout(),X0(this,Zv).notify({type:"observerAdded",mutation:this,observer:g}))}removeObserver(g){F1(this,Yy,X0(this,Yy).filter(b=>b!==g)),this.scheduleGc(),X0(this,Zv).notify({type:"observerRemoved",mutation:this,observer:g})}optionalRemove(){X0(this,Yy).length||(this.state.status==="pending"?this.scheduleGc():X0(this,Zv).remove(this))}continue(){var g;return((g=X0(this,B$))==null?void 0:g.continue())??this.execute(this.state.variables)}async execute(g){var st,at,vt,Tt,Ct,pt,wt,$t,Lt,jt,Ft,Gt,Ht,qt,Kt,rr,ir,or,jr,qr;F1(this,B$,createRetryer({fn:()=>this.options.mutationFn?this.options.mutationFn(g):Promise.reject(new Error("No mutationFn found")),onFail:(Yr,vn)=>{zv(this,Xy,x$).call(this,{type:"failed",failureCount:Yr,error:vn})},onPause:()=>{zv(this,Xy,x$).call(this,{type:"pause"})},onContinue:()=>{zv(this,Xy,x$).call(this,{type:"continue"})},retry:this.options.retry??0,retryDelay:this.options.retryDelay,networkMode:this.options.networkMode,canRun:()=>X0(this,Zv).canRun(this)}));const b=this.state.status==="pending",et=!X0(this,B$).canStart();try{if(!b){zv(this,Xy,x$).call(this,{type:"pending",variables:g,isPaused:et}),await((at=(st=X0(this,Zv).config).onMutate)==null?void 0:at.call(st,g,this));const vn=await((Tt=(vt=this.options).onMutate)==null?void 0:Tt.call(vt,g));vn!==this.state.context&&zv(this,Xy,x$).call(this,{type:"pending",context:vn,variables:g,isPaused:et})}const Yr=await X0(this,B$).start();return await((pt=(Ct=X0(this,Zv).config).onSuccess)==null?void 0:pt.call(Ct,Yr,g,this.state.context,this)),await(($t=(wt=this.options).onSuccess)==null?void 0:$t.call(wt,Yr,g,this.state.context)),await((jt=(Lt=X0(this,Zv).config).onSettled)==null?void 0:jt.call(Lt,Yr,null,this.state.variables,this.state.context,this)),await((Gt=(Ft=this.options).onSettled)==null?void 0:Gt.call(Ft,Yr,null,g,this.state.context)),zv(this,Xy,x$).call(this,{type:"success",data:Yr}),Yr}catch(Yr){try{throw await((qt=(Ht=X0(this,Zv).config).onError)==null?void 0:qt.call(Ht,Yr,g,this.state.context,this)),await((rr=(Kt=this.options).onError)==null?void 0:rr.call(Kt,Yr,g,this.state.context)),await((or=(ir=X0(this,Zv).config).onSettled)==null?void 0:or.call(ir,void 0,Yr,this.state.variables,this.state.context,this)),await((qr=(jr=this.options).onSettled)==null?void 0:qr.call(jr,void 0,Yr,g,this.state.context)),Yr}finally{zv(this,Xy,x$).call(this,{type:"error",error:Yr})}}finally{X0(this,Zv).runNext(this)}}},Yy=new WeakMap,Zv=new WeakMap,B$=new WeakMap,Xy=new WeakSet,x$=function(g){const b=et=>{switch(g.type){case"failed":return{...et,failureCount:g.failureCount,failureReason:g.error};case"pause":return{...et,isPaused:!0};case"continue":return{...et,isPaused:!1};case"pending":return{...et,context:g.context,data:void 0,failureCount:0,failureReason:null,error:null,isPaused:g.isPaused,status:"pending",variables:g.variables,submittedAt:Date.now()};case"success":return{...et,data:g.data,failureCount:0,failureReason:null,error:null,status:"success",isPaused:!1};case"error":return{...et,data:void 0,error:g.error,failureCount:et.failureCount+1,failureReason:g.error,isPaused:!1,status:"error"}}};this.state=b(this.state),notifyManager.batch(()=>{X0(this,Yy).forEach(et=>{et.onMutationUpdate(g)}),X0(this,Zv).notify({mutation:this,type:"updated",action:g})})},BS);function getDefaultState(){return{context:void 0,data:void 0,error:null,failureCount:0,failureReason:null,isPaused:!1,status:"idle",variables:void 0,submittedAt:0}}var fy,Xx,zS,MutationCache=(zS=class extends Subscribable{constructor(g={}){super();rv(this,fy,void 0);rv(this,Xx,void 0);this.config=g,F1(this,fy,new Map),F1(this,Xx,Date.now())}build(g,b,et){const st=new Mutation({mutationCache:this,mutationId:++V2(this,Xx)._,options:g.defaultMutationOptions(b),state:et});return this.add(st),st}add(g){const b=scopeFor(g),et=X0(this,fy).get(b)??[];et.push(g),X0(this,fy).set(b,et),this.notify({type:"added",mutation:g})}remove(g){var et;const b=scopeFor(g);if(X0(this,fy).has(b)){const st=(et=X0(this,fy).get(b))==null?void 0:et.filter(at=>at!==g);st&&(st.length===0?X0(this,fy).delete(b):X0(this,fy).set(b,st))}this.notify({type:"removed",mutation:g})}canRun(g){var et;const b=(et=X0(this,fy).get(scopeFor(g)))==null?void 0:et.find(st=>st.state.status==="pending");return!b||b===g}runNext(g){var et;const b=(et=X0(this,fy).get(scopeFor(g)))==null?void 0:et.find(st=>st!==g&&st.state.isPaused);return(b==null?void 0:b.continue())??Promise.resolve()}clear(){notifyManager.batch(()=>{this.getAll().forEach(g=>{this.remove(g)})})}getAll(){return[...X0(this,fy).values()].flat()}find(g){const b={exact:!0,...g};return this.getAll().find(et=>matchMutation(b,et))}findAll(g={}){return this.getAll().filter(b=>matchMutation(g,b))}notify(g){notifyManager.batch(()=>{this.listeners.forEach(b=>{b(g)})})}resumePausedMutations(){const g=this.getAll().filter(b=>b.state.isPaused);return notifyManager.batch(()=>Promise.all(g.map(b=>b.continue().catch(noop$3))))}},fy=new WeakMap,Xx=new WeakMap,zS);function scopeFor(d){var g;return((g=d.options.scope)==null?void 0:g.id)??String(d.mutationId)}function infiniteQueryBehavior(d){return{onFetch:(g,b)=>{const et=async()=>{var Ft,Gt,Ht,qt,Kt;const st=g.options,at=(Ht=(Gt=(Ft=g.fetchOptions)==null?void 0:Ft.meta)==null?void 0:Gt.fetchMore)==null?void 0:Ht.direction,vt=((qt=g.state.data)==null?void 0:qt.pages)||[],Tt=((Kt=g.state.data)==null?void 0:Kt.pageParams)||[],Ct={pages:[],pageParams:[]};let pt=!1;const wt=rr=>{Object.defineProperty(rr,"signal",{enumerable:!0,get:()=>(g.signal.aborted?pt=!0:g.signal.addEventListener("abort",()=>{pt=!0}),g.signal)})},$t=g.options.queryFn&&g.options.queryFn!==skipToken?g.options.queryFn:()=>Promise.reject(new Error(`Missing queryFn: '${g.options.queryHash}'`)),Lt=async(rr,ir,or)=>{if(pt)return Promise.reject();if(ir==null&&rr.pages.length)return Promise.resolve(rr);const jr={queryKey:g.queryKey,pageParam:ir,direction:or?"backward":"forward",meta:g.options.meta};wt(jr);const qr=await $t(jr),{maxPages:Yr}=g.options,vn=or?addToStart:addToEnd;return{pages:vn(rr.pages,qr,Yr),pageParams:vn(rr.pageParams,ir,Yr)}};let jt;if(at&&vt.length){const rr=at==="backward",ir=rr?getPreviousPageParam:getNextPageParam,or={pages:vt,pageParams:Tt},jr=ir(st,or);jt=await Lt(or,jr,rr)}else{jt=await Lt(Ct,Tt[0]??st.initialPageParam);const rr=d??vt.length;for(let ir=1;ir<rr;ir++){const or=getNextPageParam(st,jt);jt=await Lt(jt,or)}}return jt};g.options.persister?g.fetchFn=()=>{var st,at;return(at=(st=g.options).persister)==null?void 0:at.call(st,et,{queryKey:g.queryKey,meta:g.options.meta,signal:g.signal},b)}:g.fetchFn=et}}}function getNextPageParam(d,{pages:g,pageParams:b}){const et=g.length-1;return d.getNextPageParam(g[et],g,b[et],b)}function getPreviousPageParam(d,{pages:g,pageParams:b}){var et;return(et=d.getPreviousPageParam)==null?void 0:et.call(d,g[0],g,b[0],b)}var vv,E$,T$,ux,dx,C$,fx,px,US,QueryClient=(US=class{constructor(d={}){rv(this,vv,void 0);rv(this,E$,void 0);rv(this,T$,void 0);rv(this,ux,void 0);rv(this,dx,void 0);rv(this,C$,void 0);rv(this,fx,void 0);rv(this,px,void 0);F1(this,vv,d.queryCache||new QueryCache),F1(this,E$,d.mutationCache||new MutationCache),F1(this,T$,d.defaultOptions||{}),F1(this,ux,new Map),F1(this,dx,new Map),F1(this,C$,0)}mount(){V2(this,C$)._++,X0(this,C$)===1&&(F1(this,fx,focusManager.subscribe(async d=>{d&&(await this.resumePausedMutations(),X0(this,vv).onFocus())})),F1(this,px,onlineManager.subscribe(async d=>{d&&(await this.resumePausedMutations(),X0(this,vv).onOnline())})))}unmount(){var d,g;V2(this,C$)._--,X0(this,C$)===0&&((d=X0(this,fx))==null||d.call(this),F1(this,fx,void 0),(g=X0(this,px))==null||g.call(this),F1(this,px,void 0))}isFetching(d){return X0(this,vv).findAll({...d,fetchStatus:"fetching"}).length}isMutating(d){return X0(this,E$).findAll({...d,status:"pending"}).length}getQueryData(d){var b;const g=this.defaultQueryOptions({queryKey:d});return(b=X0(this,vv).get(g.queryHash))==null?void 0:b.state.data}ensureQueryData(d){const g=this.getQueryData(d.queryKey);if(g===void 0)return this.fetchQuery(d);{const b=this.defaultQueryOptions(d),et=X0(this,vv).build(this,b);return d.revalidateIfStale&&et.isStaleByTime(b.staleTime)&&this.prefetchQuery(b),Promise.resolve(g)}}getQueriesData(d){return X0(this,vv).findAll(d).map(({queryKey:g,state:b})=>{const et=b.data;return[g,et]})}setQueryData(d,g,b){const et=this.defaultQueryOptions({queryKey:d}),st=X0(this,vv).get(et.queryHash),at=st==null?void 0:st.state.data,vt=functionalUpdate(g,at);if(vt!==void 0)return X0(this,vv).build(this,et).setData(vt,{...b,manual:!0})}setQueriesData(d,g,b){return notifyManager.batch(()=>X0(this,vv).findAll(d).map(({queryKey:et})=>[et,this.setQueryData(et,g,b)]))}getQueryState(d){var b;const g=this.defaultQueryOptions({queryKey:d});return(b=X0(this,vv).get(g.queryHash))==null?void 0:b.state}removeQueries(d){const g=X0(this,vv);notifyManager.batch(()=>{g.findAll(d).forEach(b=>{g.remove(b)})})}resetQueries(d,g){const b=X0(this,vv),et={type:"active",...d};return notifyManager.batch(()=>(b.findAll(d).forEach(st=>{st.reset()}),this.refetchQueries(et,g)))}cancelQueries(d={},g={}){const b={revert:!0,...g},et=notifyManager.batch(()=>X0(this,vv).findAll(d).map(st=>st.cancel(b)));return Promise.all(et).then(noop$3).catch(noop$3)}invalidateQueries(d={},g={}){return notifyManager.batch(()=>{if(X0(this,vv).findAll(d).forEach(et=>{et.invalidate()}),d.refetchType==="none")return Promise.resolve();const b={...d,type:d.refetchType??d.type??"active"};return this.refetchQueries(b,g)})}refetchQueries(d={},g){const b={...g,cancelRefetch:(g==null?void 0:g.cancelRefetch)??!0},et=notifyManager.batch(()=>X0(this,vv).findAll(d).filter(st=>!st.isDisabled()).map(st=>{let at=st.fetch(void 0,b);return b.throwOnError||(at=at.catch(noop$3)),st.state.fetchStatus==="paused"?Promise.resolve():at}));return Promise.all(et).then(noop$3)}fetchQuery(d){const g=this.defaultQueryOptions(d);g.retry===void 0&&(g.retry=!1);const b=X0(this,vv).build(this,g);return b.isStaleByTime(g.staleTime)?b.fetch(g):Promise.resolve(b.state.data)}prefetchQuery(d){return this.fetchQuery(d).then(noop$3).catch(noop$3)}fetchInfiniteQuery(d){return d.behavior=infiniteQueryBehavior(d.pages),this.fetchQuery(d)}prefetchInfiniteQuery(d){return this.fetchInfiniteQuery(d).then(noop$3).catch(noop$3)}resumePausedMutations(){return onlineManager.isOnline()?X0(this,E$).resumePausedMutations():Promise.resolve()}getQueryCache(){return X0(this,vv)}getMutationCache(){return X0(this,E$)}getDefaultOptions(){return X0(this,T$)}setDefaultOptions(d){F1(this,T$,d)}setQueryDefaults(d,g){X0(this,ux).set(hashKey(d),{queryKey:d,defaultOptions:g})}getQueryDefaults(d){const g=[...X0(this,ux).values()];let b={};return g.forEach(et=>{partialMatchKey(d,et.queryKey)&&(b={...b,...et.defaultOptions})}),b}setMutationDefaults(d,g){X0(this,dx).set(hashKey(d),{mutationKey:d,defaultOptions:g})}getMutationDefaults(d){const g=[...X0(this,dx).values()];let b={};return g.forEach(et=>{partialMatchKey(d,et.mutationKey)&&(b={...b,...et.defaultOptions})}),b}defaultQueryOptions(d){if(d._defaulted)return d;const g={...X0(this,T$).queries,...this.getQueryDefaults(d.queryKey),...d,_defaulted:!0};return g.queryHash||(g.queryHash=hashQueryKeyByOptions(g.queryKey,g)),g.refetchOnReconnect===void 0&&(g.refetchOnReconnect=g.networkMode!=="always"),g.throwOnError===void 0&&(g.throwOnError=!!g.suspense),!g.networkMode&&g.persister&&(g.networkMode="offlineFirst"),g.enabled!==!0&&g.queryFn===skipToken&&(g.enabled=!1),g}defaultMutationOptions(d){return d!=null&&d._defaulted?d:{...X0(this,T$).mutations,...(d==null?void 0:d.mutationKey)&&this.getMutationDefaults(d.mutationKey),...d,_defaulted:!0}}clear(){X0(this,vv).clear(),X0(this,E$).clear()}},vv=new WeakMap,E$=new WeakMap,T$=new WeakMap,ux=new WeakMap,dx=new WeakMap,C$=new WeakMap,fx=new WeakMap,px=new WeakMap,US),QueryClientContext=reactExports.createContext(void 0),QueryClientProvider=({client:d,children:g})=>(reactExports.useEffect(()=>(d.mount(),()=>{d.unmount()}),[d]),jsxRuntimeExports.jsx(QueryClientContext.Provider,{value:d,children:g}));function _objectWithoutPropertiesLoose(d,g){if(d==null)return{};var b={},et=Object.keys(d),st,at;for(at=0;at<et.length;at++)st=et[at],!(g.indexOf(st)>=0)&&(b[st]=d[st]);return b}var _excluded$e=["color"],ArrowDownIcon=reactExports.forwardRef(function(d,g){var b=d.color,et=b===void 0?"currentColor":b,st=_objectWithoutPropertiesLoose(d,_excluded$e);return reactExports.createElement("svg",Object.assign({width:"15",height:"15",viewBox:"0 0 15 15",fill:"none",xmlns:"http://www.w3.org/2000/svg"},st,{ref:g}),reactExports.createElement("path",{d:"M7.5 2C7.77614 2 8 2.22386 8 2.5L8 11.2929L11.1464 8.14645C11.3417 7.95118 11.6583 7.95118 11.8536 8.14645C12.0488 8.34171 12.0488 8.65829 11.8536 8.85355L7.85355 12.8536C7.75979 12.9473 7.63261 13 7.5 13C7.36739 13 7.24021 12.9473 7.14645 12.8536L3.14645 8.85355C2.95118 8.65829 2.95118 8.34171 3.14645 8.14645C3.34171 7.95118 3.65829 7.95118 3.85355 8.14645L7 11.2929L7 2.5C7 2.22386 7.22386 2 7.5 2Z",fill:et,fillRule:"evenodd",clipRule:"evenodd"}))}),_excluded$j=["color"],ArrowUpIcon=reactExports.forwardRef(function(d,g){var b=d.color,et=b===void 0?"currentColor":b,st=_objectWithoutPropertiesLoose(d,_excluded$j);return reactExports.createElement("svg",Object.assign({width:"15",height:"15",viewBox:"0 0 15 15",fill:"none",xmlns:"http://www.w3.org/2000/svg"},st,{ref:g}),reactExports.createElement("path",{d:"M7.14645 2.14645C7.34171 1.95118 7.65829 1.95118 7.85355 2.14645L11.8536 6.14645C12.0488 6.34171 12.0488 6.65829 11.8536 6.85355C11.6583 7.04882 11.3417 7.04882 11.1464 6.85355L8 3.70711L8 12.5C8 12.7761 7.77614 13 7.5 13C7.22386 13 7 12.7761 7 12.5L7 3.70711L3.85355 6.85355C3.65829 7.04882 3.34171 7.04882 3.14645 6.85355C2.95118 6.65829 2.95118 6.34171 3.14645 6.14645L7.14645 2.14645Z",fill:et,fillRule:"evenodd",clipRule:"evenodd"}))}),_excluded$Q=["color"],CaretSortIcon=reactExports.forwardRef(function(d,g){var b=d.color,et=b===void 0?"currentColor":b,st=_objectWithoutPropertiesLoose(d,_excluded$Q);return reactExports.createElement("svg",Object.assign({width:"15",height:"15",viewBox:"0 0 15 15",fill:"none",xmlns:"http://www.w3.org/2000/svg"},st,{ref:g}),reactExports.createElement("path",{d:"M4.93179 5.43179C4.75605 5.60753 4.75605 5.89245 4.93179 6.06819C5.10753 6.24392 5.39245 6.24392 5.56819 6.06819L7.49999 4.13638L9.43179 6.06819C9.60753 6.24392 9.89245 6.24392 10.0682 6.06819C10.2439 5.89245 10.2439 5.60753 10.0682 5.43179L7.81819 3.18179C7.73379 3.0974 7.61933 3.04999 7.49999 3.04999C7.38064 3.04999 7.26618 3.0974 7.18179 3.18179L4.93179 5.43179ZM10.0682 9.56819C10.2439 9.39245 10.2439 9.10753 10.0682 8.93179C9.89245 8.75606 9.60753 8.75606 9.43179 8.93179L7.49999 10.8636L5.56819 8.93179C5.39245 8.75606 5.10753 8.75606 4.93179 8.93179C4.75605 9.10753 4.75605 9.39245 4.93179 9.56819L7.18179 11.8182C7.35753 11.9939 7.64245 11.9939 7.81819 11.8182L10.0682 9.56819Z",fill:et,fillRule:"evenodd",clipRule:"evenodd"}))}),_excluded$T=["color"],CheckIcon=reactExports.forwardRef(function(d,g){var b=d.color,et=b===void 0?"currentColor":b,st=_objectWithoutPropertiesLoose(d,_excluded$T);return reactExports.createElement("svg",Object.assign({width:"15",height:"15",viewBox:"0 0 15 15",fill:"none",xmlns:"http://www.w3.org/2000/svg"},st,{ref:g}),reactExports.createElement("path",{d:"M11.4669 3.72684C11.7558 3.91574 11.8369 4.30308 11.648 4.59198L7.39799 11.092C7.29783 11.2452 7.13556 11.3467 6.95402 11.3699C6.77247 11.3931 6.58989 11.3355 6.45446 11.2124L3.70446 8.71241C3.44905 8.48022 3.43023 8.08494 3.66242 7.82953C3.89461 7.57412 4.28989 7.55529 4.5453 7.78749L6.75292 9.79441L10.6018 3.90792C10.7907 3.61902 11.178 3.53795 11.4669 3.72684Z",fill:et,fillRule:"evenodd",clipRule:"evenodd"}))}),_excluded$W=["color"],ChevronDownIcon=reactExports.forwardRef(function(d,g){var b=d.color,et=b===void 0?"currentColor":b,st=_objectWithoutPropertiesLoose(d,_excluded$W);return reactExports.createElement("svg",Object.assign({width:"15",height:"15",viewBox:"0 0 15 15",fill:"none",xmlns:"http://www.w3.org/2000/svg"},st,{ref:g}),reactExports.createElement("path",{d:"M3.13523 6.15803C3.3241 5.95657 3.64052 5.94637 3.84197 6.13523L7.5 9.56464L11.158 6.13523C11.3595 5.94637 11.6759 5.95657 11.8648 6.15803C12.0536 6.35949 12.0434 6.67591 11.842 6.86477L7.84197 10.6148C7.64964 10.7951 7.35036 10.7951 7.15803 10.6148L3.15803 6.86477C2.95657 6.67591 2.94637 6.35949 3.13523 6.15803Z",fill:et,fillRule:"evenodd",clipRule:"evenodd"}))}),_excluded$Z=["color"],ChevronUpIcon=reactExports.forwardRef(function(d,g){var b=d.color,et=b===void 0?"currentColor":b,st=_objectWithoutPropertiesLoose(d,_excluded$Z);return reactExports.createElement("svg",Object.assign({width:"15",height:"15",viewBox:"0 0 15 15",fill:"none",xmlns:"http://www.w3.org/2000/svg"},st,{ref:g}),reactExports.createElement("path",{d:"M3.13523 8.84197C3.3241 9.04343 3.64052 9.05363 3.84197 8.86477L7.5 5.43536L11.158 8.86477C11.3595 9.05363 11.6759 9.04343 11.8648 8.84197C12.0536 8.64051 12.0434 8.32409 11.842 8.13523L7.84197 4.38523C7.64964 4.20492 7.35036 4.20492 7.15803 4.38523L3.15803 8.13523C2.95657 8.32409 2.94637 8.64051 3.13523 8.84197Z",fill:et,fillRule:"evenodd",clipRule:"evenodd"}))}),_excluded$1r=["color"],Cross2Icon=reactExports.forwardRef(function(d,g){var b=d.color,et=b===void 0?"currentColor":b,st=_objectWithoutPropertiesLoose(d,_excluded$1r);return reactExports.createElement("svg",Object.assign({width:"15",height:"15",viewBox:"0 0 15 15",fill:"none",xmlns:"http://www.w3.org/2000/svg"},st,{ref:g}),reactExports.createElement("path",{d:"M11.7816 4.03157C12.0062 3.80702 12.0062 3.44295 11.7816 3.2184C11.5571 2.99385 11.193 2.99385 10.9685 3.2184L7.50005 6.68682L4.03164 3.2184C3.80708 2.99385 3.44301 2.99385 3.21846 3.2184C2.99391 3.44295 2.99391 3.80702 3.21846 4.03157L6.68688 7.49999L3.21846 10.9684C2.99391 11.193 2.99391 11.557 3.21846 11.7816C3.44301 12.0061 3.80708 12.0061 4.03164 11.7816L7.50005 8.31316L10.9685 11.7816C11.193 12.0061 11.5571 12.0061 11.7816 11.7816C12.0062 11.557 12.0062 11.193 11.7816 10.9684L8.31322 7.49999L11.7816 4.03157Z",fill:et,fillRule:"evenodd",clipRule:"evenodd"}))}),_excluded$1L=["color"],DoubleArrowDownIcon=reactExports.forwardRef(function(d,g){var b=d.color,et=b===void 0?"currentColor":b,st=_objectWithoutPropertiesLoose(d,_excluded$1L);return reactExports.createElement("svg",Object.assign({width:"15",height:"15",viewBox:"0 0 15 15",fill:"none",xmlns:"http://www.w3.org/2000/svg"},st,{ref:g}),reactExports.createElement("path",{d:"M3.85355 2.14645C3.65829 1.95118 3.34171 1.95118 3.14645 2.14645C2.95118 2.34171 2.95118 2.65829 3.14645 2.85355L7.14645 6.85355C7.34171 7.04882 7.65829 7.04882 7.85355 6.85355L11.8536 2.85355C12.0488 2.65829 12.0488 2.34171 11.8536 2.14645C11.6583 1.95118 11.3417 1.95118 11.1464 2.14645L7.5 5.79289L3.85355 2.14645ZM3.85355 8.14645C3.65829 7.95118 3.34171 7.95118 3.14645 8.14645C2.95118 8.34171 2.95118 8.65829 3.14645 8.85355L7.14645 12.8536C7.34171 13.0488 7.65829 13.0488 7.85355 12.8536L11.8536 8.85355C12.0488 8.65829 12.0488 8.34171 11.8536 8.14645C11.6583 7.95118 11.3417 7.95118 11.1464 8.14645L7.5 11.7929L3.85355 8.14645Z",fill:et,fillRule:"evenodd",clipRule:"evenodd"}))}),_excluded$1O=["color"],DoubleArrowUpIcon=reactExports.forwardRef(function(d,g){var b=d.color,et=b===void 0?"currentColor":b,st=_objectWithoutPropertiesLoose(d,_excluded$1O);return reactExports.createElement("svg",Object.assign({width:"15",height:"15",viewBox:"0 0 15 15",fill:"none",xmlns:"http://www.w3.org/2000/svg"},st,{ref:g}),reactExports.createElement("path",{d:"M11.1464 6.85355C11.3417 7.04882 11.6583 7.04882 11.8536 6.85355C12.0488 6.65829 12.0488 6.34171 11.8536 6.14645L7.85355 2.14645C7.65829 1.95118 7.34171 1.95118 7.14645 2.14645L3.14645 6.14645C2.95118 6.34171 2.95118 6.65829 3.14645 6.85355C3.34171 7.04882 3.65829 7.04882 3.85355 6.85355L7.5 3.20711L11.1464 6.85355ZM11.1464 12.8536C11.3417 13.0488 11.6583 13.0488 11.8536 12.8536C12.0488 12.6583 12.0488 12.3417 11.8536 12.1464L7.85355 8.14645C7.65829 7.95118 7.34171 7.95118 7.14645 8.14645L3.14645 12.1464C2.95118 12.3417 2.95118 12.6583 3.14645 12.8536C3.34171 13.0488 3.65829 13.0488 3.85355 12.8536L7.5 9.20711L11.1464 12.8536Z",fill:et,fillRule:"evenodd",clipRule:"evenodd"}))});function _extends$1(){return _extends$1=Object.assign?Object.assign.bind():function(d){for(var g=1;g<arguments.length;g++){var b=arguments[g];for(var et in b)Object.prototype.hasOwnProperty.call(b,et)&&(d[et]=b[et])}return d},_extends$1.apply(this,arguments)}function $e42e1063c40fb3ef$export$b9ecd428b558ff10(d,g,{checkForDefaultPrevented:b=!0}={}){return function(st){if(d==null||d(st),b===!1||!st.defaultPrevented)return g==null?void 0:g(st)}}function $6ed0406888f73fc4$var$setRef(d,g){typeof d=="function"?d(g):d!=null&&(d.current=g)}function $6ed0406888f73fc4$export$43e446d32b3d21af(...d){return g=>d.forEach(b=>$6ed0406888f73fc4$var$setRef(b,g))}function $6ed0406888f73fc4$export$c7b2cbe3552a0d05(...d){return reactExports.useCallback($6ed0406888f73fc4$export$43e446d32b3d21af(...d),d)}function $c512c27ab02ef895$export$fd42f52fd3ae1109(d,g){const b=reactExports.createContext(g);function et(at){const{children:vt,...Tt}=at,Ct=reactExports.useMemo(()=>Tt,Object.values(Tt));return reactExports.createElement(b.Provider,{value:Ct},vt)}function st(at){const vt=reactExports.useContext(b);if(vt)return vt;if(g!==void 0)return g;throw new Error(`\`${at}\` must be used within \`${d}\``)}return et.displayName=d+"Provider",[et,st]}function $c512c27ab02ef895$export$50c7b4e9d9f19c1(d,g=[]){let b=[];function et(at,vt){const Tt=reactExports.createContext(vt),Ct=b.length;b=[...b,vt];function pt($t){const{scope:Lt,children:jt,...Ft}=$t,Gt=(Lt==null?void 0:Lt[d][Ct])||Tt,Ht=reactExports.useMemo(()=>Ft,Object.values(Ft));return reactExports.createElement(Gt.Provider,{value:Ht},jt)}function wt($t,Lt){const jt=(Lt==null?void 0:Lt[d][Ct])||Tt,Ft=reactExports.useContext(jt);if(Ft)return Ft;if(vt!==void 0)return vt;throw new Error(`\`${$t}\` must be used within \`${at}\``)}return pt.displayName=at+"Provider",[pt,wt]}const st=()=>{const at=b.map(vt=>reactExports.createContext(vt));return function(Tt){const Ct=(Tt==null?void 0:Tt[d])||at;return reactExports.useMemo(()=>({[`__scope${d}`]:{...Tt,[d]:Ct}}),[Tt,Ct])}};return st.scopeName=d,[et,$c512c27ab02ef895$var$composeContextScopes(st,...g)]}function $c512c27ab02ef895$var$composeContextScopes(...d){const g=d[0];if(d.length===1)return g;const b=()=>{const et=d.map(st=>({useScope:st(),scopeName:st.scopeName}));return function(at){const vt=et.reduce((Tt,{useScope:Ct,scopeName:pt})=>{const $t=Ct(at)[`__scope${pt}`];return{...Tt,...$t}},{});return reactExports.useMemo(()=>({[`__scope${g.scopeName}`]:vt}),[vt])}};return b.scopeName=g.scopeName,b}const $5e63c961fc1ce211$export$8c6ed5c666ac1360=reactExports.forwardRef((d,g)=>{const{children:b,...et}=d,st=reactExports.Children.toArray(b),at=st.find($5e63c961fc1ce211$var$isSlottable);if(at){const vt=at.props.children,Tt=st.map(Ct=>Ct===at?reactExports.Children.count(vt)>1?reactExports.Children.only(null):reactExports.isValidElement(vt)?vt.props.children:null:Ct);return reactExports.createElement($5e63c961fc1ce211$var$SlotClone,_extends$1({},et,{ref:g}),reactExports.isValidElement(vt)?reactExports.cloneElement(vt,void 0,Tt):null)}return reactExports.createElement($5e63c961fc1ce211$var$SlotClone,_extends$1({},et,{ref:g}),b)});$5e63c961fc1ce211$export$8c6ed5c666ac1360.displayName="Slot";const $5e63c961fc1ce211$var$SlotClone=reactExports.forwardRef((d,g)=>{const{children:b,...et}=d;return reactExports.isValidElement(b)?reactExports.cloneElement(b,{...$5e63c961fc1ce211$var$mergeProps(et,b.props),ref:g?$6ed0406888f73fc4$export$43e446d32b3d21af(g,b.ref):b.ref}):reactExports.Children.count(b)>1?reactExports.Children.only(null):null});$5e63c961fc1ce211$var$SlotClone.displayName="SlotClone";const $5e63c961fc1ce211$export$d9f1ccf0bdb05d45=({children:d})=>reactExports.createElement(reactExports.Fragment,null,d);function $5e63c961fc1ce211$var$isSlottable(d){return reactExports.isValidElement(d)&&d.type===$5e63c961fc1ce211$export$d9f1ccf0bdb05d45}function $5e63c961fc1ce211$var$mergeProps(d,g){const b={...g};for(const et in g){const st=d[et],at=g[et];/^on[A-Z]/.test(et)?st&&at?b[et]=(...Tt)=>{at(...Tt),st(...Tt)}:st&&(b[et]=st):et==="style"?b[et]={...st,...at}:et==="className"&&(b[et]=[st,at].filter(Boolean).join(" "))}return{...d,...b}}function $e02a7d9cb1dc128c$export$c74125a8e3af6bb2(d){const g=d+"CollectionProvider",[b,et]=$c512c27ab02ef895$export$50c7b4e9d9f19c1(g),[st,at]=b(g,{collectionRef:{current:null},itemMap:new Map}),vt=jt=>{const{scope:Ft,children:Gt}=jt,Ht=React.useRef(null),qt=React.useRef(new Map).current;return React.createElement(st,{scope:Ft,itemMap:qt,collectionRef:Ht},Gt)},Tt=d+"CollectionSlot",Ct=React.forwardRef((jt,Ft)=>{const{scope:Gt,children:Ht}=jt,qt=at(Tt,Gt),Kt=$6ed0406888f73fc4$export$c7b2cbe3552a0d05(Ft,qt.collectionRef);return React.createElement($5e63c961fc1ce211$export$8c6ed5c666ac1360,{ref:Kt},Ht)}),pt=d+"CollectionItemSlot",wt="data-radix-collection-item",$t=React.forwardRef((jt,Ft)=>{const{scope:Gt,children:Ht,...qt}=jt,Kt=React.useRef(null),rr=$6ed0406888f73fc4$export$c7b2cbe3552a0d05(Ft,Kt),ir=at(pt,Gt);return React.useEffect(()=>(ir.itemMap.set(Kt,{ref:Kt,...qt}),()=>void ir.itemMap.delete(Kt))),React.createElement($5e63c961fc1ce211$export$8c6ed5c666ac1360,{[wt]:"",ref:rr},Ht)});function Lt(jt){const Ft=at(d+"CollectionConsumer",jt);return React.useCallback(()=>{const Ht=Ft.collectionRef.current;if(!Ht)return[];const qt=Array.from(Ht.querySelectorAll(`[${wt}]`));return Array.from(Ft.itemMap.values()).sort((ir,or)=>qt.indexOf(ir.ref.current)-qt.indexOf(or.ref.current))},[Ft.collectionRef,Ft.itemMap])}return[{Provider:vt,Slot:Ct,ItemSlot:$t},Lt,et]}const $8927f6f2acc4f386$var$NODES=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","span","svg","ul"],$8927f6f2acc4f386$export$250ffa63cdc0d034=$8927f6f2acc4f386$var$NODES.reduce((d,g)=>{const b=reactExports.forwardRef((et,st)=>{const{asChild:at,...vt}=et,Tt=at?$5e63c961fc1ce211$export$8c6ed5c666ac1360:g;return reactExports.useEffect(()=>{window[Symbol.for("radix-ui")]=!0},[]),reactExports.createElement(Tt,_extends$1({},vt,{ref:st}))});return b.displayName=`Primitive.${g}`,{...d,[g]:b}},{});function $8927f6f2acc4f386$export$6d1a0317bde7de7f(d,g){d&&reactDomExports.flushSync(()=>d.dispatchEvent(g))}function $b1b2314f5f9a1d84$export$25bec8c6f54ee79a(d){const g=reactExports.useRef(d);return reactExports.useEffect(()=>{g.current=d}),reactExports.useMemo(()=>(...b)=>{var et;return(et=g.current)===null||et===void 0?void 0:et.call(g,...b)},[])}function $addc16e1bbe58fd0$export$3a72a57244d6e765(d,g=globalThis==null?void 0:globalThis.document){const b=$b1b2314f5f9a1d84$export$25bec8c6f54ee79a(d);reactExports.useEffect(()=>{const et=st=>{st.key==="Escape"&&b(st)};return g.addEventListener("keydown",et),()=>g.removeEventListener("keydown",et)},[b,g])}const $5cb92bef7577960e$var$CONTEXT_UPDATE="dismissableLayer.update",$5cb92bef7577960e$var$POINTER_DOWN_OUTSIDE="dismissableLayer.pointerDownOutside",$5cb92bef7577960e$var$FOCUS_OUTSIDE="dismissableLayer.focusOutside";let $5cb92bef7577960e$var$originalBodyPointerEvents;const $5cb92bef7577960e$var$DismissableLayerContext=reactExports.createContext({layers:new Set,layersWithOutsidePointerEventsDisabled:new Set,branches:new Set}),$5cb92bef7577960e$export$177fb62ff3ec1f22=reactExports.forwardRef((d,g)=>{var b;const{disableOutsidePointerEvents:et=!1,onEscapeKeyDown:st,onPointerDownOutside:at,onFocusOutside:vt,onInteractOutside:Tt,onDismiss:Ct,...pt}=d,wt=reactExports.useContext($5cb92bef7577960e$var$DismissableLayerContext),[$t,Lt]=reactExports.useState(null),jt=(b=$t==null?void 0:$t.ownerDocument)!==null&&b!==void 0?b:globalThis==null?void 0:globalThis.document,[,Ft]=reactExports.useState({}),Gt=$6ed0406888f73fc4$export$c7b2cbe3552a0d05(g,Yr=>Lt(Yr)),Ht=Array.from(wt.layers),[qt]=[...wt.layersWithOutsidePointerEventsDisabled].slice(-1),Kt=Ht.indexOf(qt),rr=$t?Ht.indexOf($t):-1,ir=wt.layersWithOutsidePointerEventsDisabled.size>0,or=rr>=Kt,jr=$5cb92bef7577960e$var$usePointerDownOutside(Yr=>{const vn=Yr.target,ko=[...wt.branches].some(Xo=>Xo.contains(vn));!or||ko||(at==null||at(Yr),Tt==null||Tt(Yr),Yr.defaultPrevented||Ct==null||Ct())},jt),qr=$5cb92bef7577960e$var$useFocusOutside(Yr=>{const vn=Yr.target;[...wt.branches].some(Xo=>Xo.contains(vn))||(vt==null||vt(Yr),Tt==null||Tt(Yr),Yr.defaultPrevented||Ct==null||Ct())},jt);return $addc16e1bbe58fd0$export$3a72a57244d6e765(Yr=>{rr===wt.layers.size-1&&(st==null||st(Yr),!Yr.defaultPrevented&&Ct&&(Yr.preventDefault(),Ct()))},jt),reactExports.useEffect(()=>{if($t)return et&&(wt.layersWithOutsidePointerEventsDisabled.size===0&&($5cb92bef7577960e$var$originalBodyPointerEvents=jt.body.style.pointerEvents,jt.body.style.pointerEvents="none"),wt.layersWithOutsidePointerEventsDisabled.add($t)),wt.layers.add($t),$5cb92bef7577960e$var$dispatchUpdate(),()=>{et&&wt.layersWithOutsidePointerEventsDisabled.size===1&&(jt.body.style.pointerEvents=$5cb92bef7577960e$var$originalBodyPointerEvents)}},[$t,jt,et,wt]),reactExports.useEffect(()=>()=>{$t&&(wt.layers.delete($t),wt.layersWithOutsidePointerEventsDisabled.delete($t),$5cb92bef7577960e$var$dispatchUpdate())},[$t,wt]),reactExports.useEffect(()=>{const Yr=()=>Ft({});return document.addEventListener($5cb92bef7577960e$var$CONTEXT_UPDATE,Yr),()=>document.removeEventListener($5cb92bef7577960e$var$CONTEXT_UPDATE,Yr)},[]),reactExports.createElement($8927f6f2acc4f386$export$250ffa63cdc0d034.div,_extends$1({},pt,{ref:Gt,style:{pointerEvents:ir?or?"auto":"none":void 0,...d.style},onFocusCapture:$e42e1063c40fb3ef$export$b9ecd428b558ff10(d.onFocusCapture,qr.onFocusCapture),onBlurCapture:$e42e1063c40fb3ef$export$b9ecd428b558ff10(d.onBlurCapture,qr.onBlurCapture),onPointerDownCapture:$e42e1063c40fb3ef$export$b9ecd428b558ff10(d.onPointerDownCapture,jr.onPointerDownCapture)}))}),$5cb92bef7577960e$export$4d5eb2109db14228=reactExports.forwardRef((d,g)=>{const b=reactExports.useContext($5cb92bef7577960e$var$DismissableLayerContext),et=reactExports.useRef(null),st=$6ed0406888f73fc4$export$c7b2cbe3552a0d05(g,et);return reactExports.useEffect(()=>{const at=et.current;if(at)return b.branches.add(at),()=>{b.branches.delete(at)}},[b.branches]),reactExports.createElement($8927f6f2acc4f386$export$250ffa63cdc0d034.div,_extends$1({},d,{ref:st}))});function $5cb92bef7577960e$var$usePointerDownOutside(d,g=globalThis==null?void 0:globalThis.document){const b=$b1b2314f5f9a1d84$export$25bec8c6f54ee79a(d),et=reactExports.useRef(!1),st=reactExports.useRef(()=>{});return reactExports.useEffect(()=>{const at=Tt=>{if(Tt.target&&!et.current){let wt=function(){$5cb92bef7577960e$var$handleAndDispatchCustomEvent($5cb92bef7577960e$var$POINTER_DOWN_OUTSIDE,b,pt,{discrete:!0})};var Ct=wt;const pt={originalEvent:Tt};Tt.pointerType==="touch"?(g.removeEventListener("click",st.current),st.current=wt,g.addEventListener("click",st.current,{once:!0})):wt()}else g.removeEventListener("click",st.current);et.current=!1},vt=window.setTimeout(()=>{g.addEventListener("pointerdown",at)},0);return()=>{window.clearTimeout(vt),g.removeEventListener("pointerdown",at),g.removeEventListener("click",st.current)}},[g,b]),{onPointerDownCapture:()=>et.current=!0}}function $5cb92bef7577960e$var$useFocusOutside(d,g=globalThis==null?void 0:globalThis.document){const b=$b1b2314f5f9a1d84$export$25bec8c6f54ee79a(d),et=reactExports.useRef(!1);return reactExports.useEffect(()=>{const st=at=>{at.target&&!et.current&&$5cb92bef7577960e$var$handleAndDispatchCustomEvent($5cb92bef7577960e$var$FOCUS_OUTSIDE,b,{originalEvent:at},{discrete:!1})};return g.addEventListener("focusin",st),()=>g.removeEventListener("focusin",st)},[g,b]),{onFocusCapture:()=>et.current=!0,onBlurCapture:()=>et.current=!1}}function $5cb92bef7577960e$var$dispatchUpdate(){const d=new CustomEvent($5cb92bef7577960e$var$CONTEXT_UPDATE);document.dispatchEvent(d)}function $5cb92bef7577960e$var$handleAndDispatchCustomEvent(d,g,b,{discrete:et}){const st=b.originalEvent.target,at=new CustomEvent(d,{bubbles:!1,cancelable:!0,detail:b});g&&st.addEventListener(d,g,{once:!0}),et?$8927f6f2acc4f386$export$6d1a0317bde7de7f(st,at):st.dispatchEvent(at)}const $5cb92bef7577960e$export$be92b6f5f03c0fe9=$5cb92bef7577960e$export$177fb62ff3ec1f22,$5cb92bef7577960e$export$aecb2ddcb55c95be=$5cb92bef7577960e$export$4d5eb2109db14228,$f1701beae083dbae$export$602eac185826482c=reactExports.forwardRef((d,g)=>{var b;const{container:et=globalThis==null||(b=globalThis.document)===null||b===void 0?void 0:b.body,...st}=d;return et?$7SXl2$reactdom.createPortal(reactExports.createElement($8927f6f2acc4f386$export$250ffa63cdc0d034.div,_extends$1({},st,{ref:g})),et):null}),$9f79659886946c16$export$e5c5a5f917a5871c=globalThis!=null&&globalThis.document?reactExports.useLayoutEffect:()=>{};function $fe963b355347cc68$export$3e6543de14f8614f(d,g){return reactExports.useReducer((b,et)=>{const st=g[b][et];return st??b},d)}const $921a889cee6df7e8$export$99c2b779aa4e8b8b=d=>{const{present:g,children:b}=d,et=$921a889cee6df7e8$var$usePresence(g),st=typeof b=="function"?b({present:et.isPresent}):reactExports.Children.only(b),at=$6ed0406888f73fc4$export$c7b2cbe3552a0d05(et.ref,st.ref);return typeof b=="function"||et.isPresent?reactExports.cloneElement(st,{ref:at}):null};$921a889cee6df7e8$export$99c2b779aa4e8b8b.displayName="Presence";function $921a889cee6df7e8$var$usePresence(d){const[g,b]=reactExports.useState(),et=reactExports.useRef({}),st=reactExports.useRef(d),at=reactExports.useRef("none"),vt=d?"mounted":"unmounted",[Tt,Ct]=$fe963b355347cc68$export$3e6543de14f8614f(vt,{mounted:{UNMOUNT:"unmounted",ANIMATION_OUT:"unmountSuspended"},unmountSuspended:{MOUNT:"mounted",ANIMATION_END:"unmounted"},unmounted:{MOUNT:"mounted"}});return reactExports.useEffect(()=>{const pt=$921a889cee6df7e8$var$getAnimationName(et.current);at.current=Tt==="mounted"?pt:"none"},[Tt]),$9f79659886946c16$export$e5c5a5f917a5871c(()=>{const pt=et.current,wt=st.current;if(wt!==d){const Lt=at.current,jt=$921a889cee6df7e8$var$getAnimationName(pt);d?Ct("MOUNT"):jt==="none"||(pt==null?void 0:pt.display)==="none"?Ct("UNMOUNT"):Ct(wt&&Lt!==jt?"ANIMATION_OUT":"UNMOUNT"),st.current=d}},[d,Ct]),$9f79659886946c16$export$e5c5a5f917a5871c(()=>{if(g){const pt=$t=>{const jt=$921a889cee6df7e8$var$getAnimationName(et.current).includes($t.animationName);$t.target===g&&jt&&reactDomExports.flushSync(()=>Ct("ANIMATION_END"))},wt=$t=>{$t.target===g&&(at.current=$921a889cee6df7e8$var$getAnimationName(et.current))};return g.addEventListener("animationstart",wt),g.addEventListener("animationcancel",pt),g.addEventListener("animationend",pt),()=>{g.removeEventListener("animationstart",wt),g.removeEventListener("animationcancel",pt),g.removeEventListener("animationend",pt)}}else Ct("ANIMATION_END")},[g,Ct]),{isPresent:["mounted","unmountSuspended"].includes(Tt),ref:reactExports.useCallback(pt=>{pt&&(et.current=getComputedStyle(pt)),b(pt)},[])}}function $921a889cee6df7e8$var$getAnimationName(d){return(d==null?void 0:d.animationName)||"none"}function $71cd76cc60e0454e$export$6f32135080cb4c3({prop:d,defaultProp:g,onChange:b=()=>{}}){const[et,st]=$71cd76cc60e0454e$var$useUncontrolledState({defaultProp:g,onChange:b}),at=d!==void 0,vt=at?d:et,Tt=$b1b2314f5f9a1d84$export$25bec8c6f54ee79a(b),Ct=reactExports.useCallback(pt=>{if(at){const $t=typeof pt=="function"?pt(d):pt;$t!==d&&Tt($t)}else st(pt)},[at,d,st,Tt]);return[vt,Ct]}function $71cd76cc60e0454e$var$useUncontrolledState({defaultProp:d,onChange:g}){const b=reactExports.useState(d),[et]=b,st=reactExports.useRef(et),at=$b1b2314f5f9a1d84$export$25bec8c6f54ee79a(g);return reactExports.useEffect(()=>{st.current!==et&&(at(et),st.current=et)},[et,st,at]),b}const $ea1ef594cf570d83$export$439d29a4e110a164=reactExports.forwardRef((d,g)=>reactExports.createElement($8927f6f2acc4f386$export$250ffa63cdc0d034.span,_extends$1({},d,{ref:g,style:{position:"absolute",border:0,width:1,height:1,padding:0,margin:-1,overflow:"hidden",clip:"rect(0, 0, 0, 0)",whiteSpace:"nowrap",wordWrap:"normal",...d.style}}))),$ea1ef594cf570d83$export$be92b6f5f03c0fe9=$ea1ef594cf570d83$export$439d29a4e110a164,$054eb8030ebde76e$var$PROVIDER_NAME="ToastProvider",[$054eb8030ebde76e$var$Collection,$054eb8030ebde76e$var$useCollection,$054eb8030ebde76e$var$createCollectionScope]=$e02a7d9cb1dc128c$export$c74125a8e3af6bb2("Toast"),[$054eb8030ebde76e$var$createToastContext,$054eb8030ebde76e$export$8a359da18fbc9073]=$c512c27ab02ef895$export$50c7b4e9d9f19c1("Toast",[$054eb8030ebde76e$var$createCollectionScope]),[$054eb8030ebde76e$var$ToastProviderProvider,$054eb8030ebde76e$var$useToastProviderContext]=$054eb8030ebde76e$var$createToastContext($054eb8030ebde76e$var$PROVIDER_NAME),$054eb8030ebde76e$export$f5d03d415824e0e=d=>{const{__scopeToast:g,label:b="Notification",duration:et=5e3,swipeDirection:st="right",swipeThreshold:at=50,children:vt}=d,[Tt,Ct]=reactExports.useState(null),[pt,wt]=reactExports.useState(0),$t=reactExports.useRef(!1),Lt=reactExports.useRef(!1);return reactExports.createElement($054eb8030ebde76e$var$Collection.Provider,{scope:g},reactExports.createElement($054eb8030ebde76e$var$ToastProviderProvider,{scope:g,label:b,duration:et,swipeDirection:st,swipeThreshold:at,toastCount:pt,viewport:Tt,onViewportChange:Ct,onToastAdd:reactExports.useCallback(()=>wt(jt=>jt+1),[]),onToastRemove:reactExports.useCallback(()=>wt(jt=>jt-1),[]),isFocusedToastEscapeKeyDownRef:$t,isClosePausedRef:Lt},vt))};$054eb8030ebde76e$export$f5d03d415824e0e.propTypes={label(d){if(d.label&&typeof d.label=="string"&&!d.label.trim()){const g=`Invalid prop \`label\` supplied to \`${$054eb8030ebde76e$var$PROVIDER_NAME}\`. Expected non-empty \`string\`.`;return new Error(g)}return null}};const $054eb8030ebde76e$var$VIEWPORT_NAME="ToastViewport",$054eb8030ebde76e$var$VIEWPORT_DEFAULT_HOTKEY=["F8"],$054eb8030ebde76e$var$VIEWPORT_PAUSE="toast.viewportPause",$054eb8030ebde76e$var$VIEWPORT_RESUME="toast.viewportResume",$054eb8030ebde76e$export$6192c2425ecfd989=reactExports.forwardRef((d,g)=>{const{__scopeToast:b,hotkey:et=$054eb8030ebde76e$var$VIEWPORT_DEFAULT_HOTKEY,label:st="Notifications ({hotkey})",...at}=d,vt=$054eb8030ebde76e$var$useToastProviderContext($054eb8030ebde76e$var$VIEWPORT_NAME,b),Tt=$054eb8030ebde76e$var$useCollection(b),Ct=reactExports.useRef(null),pt=reactExports.useRef(null),wt=reactExports.useRef(null),$t=reactExports.useRef(null),Lt=$6ed0406888f73fc4$export$c7b2cbe3552a0d05(g,$t,vt.onViewportChange),jt=et.join("+").replace(/Key/g,"").replace(/Digit/g,""),Ft=vt.toastCount>0;reactExports.useEffect(()=>{const Ht=qt=>{var Kt;et.every(ir=>qt[ir]||qt.code===ir)&&((Kt=$t.current)===null||Kt===void 0||Kt.focus())};return document.addEventListener("keydown",Ht),()=>document.removeEventListener("keydown",Ht)},[et]),reactExports.useEffect(()=>{const Ht=Ct.current,qt=$t.current;if(Ft&&Ht&&qt){const Kt=()=>{if(!vt.isClosePausedRef.current){const jr=new CustomEvent($054eb8030ebde76e$var$VIEWPORT_PAUSE);qt.dispatchEvent(jr),vt.isClosePausedRef.current=!0}},rr=()=>{if(vt.isClosePausedRef.current){const jr=new CustomEvent($054eb8030ebde76e$var$VIEWPORT_RESUME);qt.dispatchEvent(jr),vt.isClosePausedRef.current=!1}},ir=jr=>{!Ht.contains(jr.relatedTarget)&&rr()},or=()=>{Ht.contains(document.activeElement)||rr()};return Ht.addEventListener("focusin",Kt),Ht.addEventListener("focusout",ir),Ht.addEventListener("pointermove",Kt),Ht.addEventListener("pointerleave",or),window.addEventListener("blur",Kt),window.addEventListener("focus",rr),()=>{Ht.removeEventListener("focusin",Kt),Ht.removeEventListener("focusout",ir),Ht.removeEventListener("pointermove",Kt),Ht.removeEventListener("pointerleave",or),window.removeEventListener("blur",Kt),window.removeEventListener("focus",rr)}}},[Ft,vt.isClosePausedRef]);const Gt=reactExports.useCallback(({tabbingDirection:Ht})=>{const Kt=Tt().map(rr=>{const ir=rr.ref.current,or=[ir,...$054eb8030ebde76e$var$getTabbableCandidates(ir)];return Ht==="forwards"?or:or.reverse()});return(Ht==="forwards"?Kt.reverse():Kt).flat()},[Tt]);return reactExports.useEffect(()=>{const Ht=$t.current;if(Ht){const qt=Kt=>{const rr=Kt.altKey||Kt.ctrlKey||Kt.metaKey;if(Kt.key==="Tab"&&!rr){const Yr=document.activeElement,vn=Kt.shiftKey;if(Kt.target===Ht&&vn){var or;(or=pt.current)===null||or===void 0||or.focus();return}const zo=Gt({tabbingDirection:vn?"backwards":"forwards"}),t0=zo.findIndex(Uo=>Uo===Yr);if($054eb8030ebde76e$var$focusFirst(zo.slice(t0+1)))Kt.preventDefault();else{var jr,qr;vn?(jr=pt.current)===null||jr===void 0||jr.focus():(qr=wt.current)===null||qr===void 0||qr.focus()}}};return Ht.addEventListener("keydown",qt),()=>Ht.removeEventListener("keydown",qt)}},[Tt,Gt]),reactExports.createElement($5cb92bef7577960e$export$aecb2ddcb55c95be,{ref:Ct,role:"region","aria-label":st.replace("{hotkey}",jt),tabIndex:-1,style:{pointerEvents:Ft?void 0:"none"}},Ft&&reactExports.createElement($054eb8030ebde76e$var$FocusProxy,{ref:pt,onFocusFromOutsideViewport:()=>{const Ht=Gt({tabbingDirection:"forwards"});$054eb8030ebde76e$var$focusFirst(Ht)}}),reactExports.createElement($054eb8030ebde76e$var$Collection.Slot,{scope:b},reactExports.createElement($8927f6f2acc4f386$export$250ffa63cdc0d034.ol,_extends$1({tabIndex:-1},at,{ref:Lt}))),Ft&&reactExports.createElement($054eb8030ebde76e$var$FocusProxy,{ref:wt,onFocusFromOutsideViewport:()=>{const Ht=Gt({tabbingDirection:"backwards"});$054eb8030ebde76e$var$focusFirst(Ht)}}))}),$054eb8030ebde76e$var$FOCUS_PROXY_NAME="ToastFocusProxy",$054eb8030ebde76e$var$FocusProxy=reactExports.forwardRef((d,g)=>{const{__scopeToast:b,onFocusFromOutsideViewport:et,...st}=d,at=$054eb8030ebde76e$var$useToastProviderContext($054eb8030ebde76e$var$FOCUS_PROXY_NAME,b);return reactExports.createElement($ea1ef594cf570d83$export$439d29a4e110a164,_extends$1({"aria-hidden":!0,tabIndex:0},st,{ref:g,style:{position:"fixed"},onFocus:vt=>{var Tt;const Ct=vt.relatedTarget;!((Tt=at.viewport)!==null&&Tt!==void 0&&Tt.contains(Ct))&&et()}}))}),$054eb8030ebde76e$var$TOAST_NAME="Toast",$054eb8030ebde76e$var$TOAST_SWIPE_START="toast.swipeStart",$054eb8030ebde76e$var$TOAST_SWIPE_MOVE="toast.swipeMove",$054eb8030ebde76e$var$TOAST_SWIPE_CANCEL="toast.swipeCancel",$054eb8030ebde76e$var$TOAST_SWIPE_END="toast.swipeEnd",$054eb8030ebde76e$export$8d8dc7d5f743331b=reactExports.forwardRef((d,g)=>{const{forceMount:b,open:et,defaultOpen:st,onOpenChange:at,...vt}=d,[Tt=!0,Ct]=$71cd76cc60e0454e$export$6f32135080cb4c3({prop:et,defaultProp:st,onChange:at});return reactExports.createElement($921a889cee6df7e8$export$99c2b779aa4e8b8b,{present:b||Tt},reactExports.createElement($054eb8030ebde76e$var$ToastImpl,_extends$1({open:Tt},vt,{ref:g,onClose:()=>Ct(!1),onPause:$b1b2314f5f9a1d84$export$25bec8c6f54ee79a(d.onPause),onResume:$b1b2314f5f9a1d84$export$25bec8c6f54ee79a(d.onResume),onSwipeStart:$e42e1063c40fb3ef$export$b9ecd428b558ff10(d.onSwipeStart,pt=>{pt.currentTarget.setAttribute("data-swipe","start")}),onSwipeMove:$e42e1063c40fb3ef$export$b9ecd428b558ff10(d.onSwipeMove,pt=>{const{x:wt,y:$t}=pt.detail.delta;pt.currentTarget.setAttribute("data-swipe","move"),pt.currentTarget.style.setProperty("--radix-toast-swipe-move-x",`${wt}px`),pt.currentTarget.style.setProperty("--radix-toast-swipe-move-y",`${$t}px`)}),onSwipeCancel:$e42e1063c40fb3ef$export$b9ecd428b558ff10(d.onSwipeCancel,pt=>{pt.currentTarget.setAttribute("data-swipe","cancel"),pt.currentTarget.style.removeProperty("--radix-toast-swipe-move-x"),pt.currentTarget.style.removeProperty("--radix-toast-swipe-move-y"),pt.currentTarget.style.removeProperty("--radix-toast-swipe-end-x"),pt.currentTarget.style.removeProperty("--radix-toast-swipe-end-y")}),onSwipeEnd:$e42e1063c40fb3ef$export$b9ecd428b558ff10(d.onSwipeEnd,pt=>{const{x:wt,y:$t}=pt.detail.delta;pt.currentTarget.setAttribute("data-swipe","end"),pt.currentTarget.style.removeProperty("--radix-toast-swipe-move-x"),pt.currentTarget.style.removeProperty("--radix-toast-swipe-move-y"),pt.currentTarget.style.setProperty("--radix-toast-swipe-end-x",`${wt}px`),pt.currentTarget.style.setProperty("--radix-toast-swipe-end-y",`${$t}px`),Ct(!1)})})))}),[$054eb8030ebde76e$var$ToastInteractiveProvider,$054eb8030ebde76e$var$useToastInteractiveContext]=$054eb8030ebde76e$var$createToastContext($054eb8030ebde76e$var$TOAST_NAME,{onClose(){}}),$054eb8030ebde76e$var$ToastImpl=reactExports.forwardRef((d,g)=>{const{__scopeToast:b,type:et="foreground",duration:st,open:at,onClose:vt,onEscapeKeyDown:Tt,onPause:Ct,onResume:pt,onSwipeStart:wt,onSwipeMove:$t,onSwipeCancel:Lt,onSwipeEnd:jt,...Ft}=d,Gt=$054eb8030ebde76e$var$useToastProviderContext($054eb8030ebde76e$var$TOAST_NAME,b),[Ht,qt]=reactExports.useState(null),Kt=$6ed0406888f73fc4$export$c7b2cbe3552a0d05(g,Uo=>qt(Uo)),rr=reactExports.useRef(null),ir=reactExports.useRef(null),or=st||Gt.duration,jr=reactExports.useRef(0),qr=reactExports.useRef(or),Yr=reactExports.useRef(0),{onToastAdd:vn,onToastRemove:ko}=Gt,Xo=$b1b2314f5f9a1d84$export$25bec8c6f54ee79a(()=>{var Uo;(Ht==null?void 0:Ht.contains(document.activeElement))&&((Uo=Gt.viewport)===null||Uo===void 0||Uo.focus()),vt()}),zo=reactExports.useCallback(Uo=>{!Uo||Uo===1/0||(window.clearTimeout(Yr.current),jr.current=new Date().getTime(),Yr.current=window.setTimeout(Xo,Uo))},[Xo]);reactExports.useEffect(()=>{const Uo=Gt.viewport;if(Uo){const No=()=>{zo(qr.current),pt==null||pt()},_n=()=>{const Kr=new Date().getTime()-jr.current;qr.current=qr.current-Kr,window.clearTimeout(Yr.current),Ct==null||Ct()};return Uo.addEventListener($054eb8030ebde76e$var$VIEWPORT_PAUSE,_n),Uo.addEventListener($054eb8030ebde76e$var$VIEWPORT_RESUME,No),()=>{Uo.removeEventListener($054eb8030ebde76e$var$VIEWPORT_PAUSE,_n),Uo.removeEventListener($054eb8030ebde76e$var$VIEWPORT_RESUME,No)}}},[Gt.viewport,or,Ct,pt,zo]),reactExports.useEffect(()=>{at&&!Gt.isClosePausedRef.current&&zo(or)},[at,or,Gt.isClosePausedRef,zo]),reactExports.useEffect(()=>(vn(),()=>ko()),[vn,ko]);const t0=reactExports.useMemo(()=>Ht?$054eb8030ebde76e$var$getAnnounceTextContent(Ht):null,[Ht]);return Gt.viewport?reactExports.createElement(reactExports.Fragment,null,t0&&reactExports.createElement($054eb8030ebde76e$var$ToastAnnounce,{__scopeToast:b,role:"status","aria-live":et==="foreground"?"assertive":"polite","aria-atomic":!0},t0),reactExports.createElement($054eb8030ebde76e$var$ToastInteractiveProvider,{scope:b,onClose:Xo},reactDomExports.createPortal(reactExports.createElement($054eb8030ebde76e$var$Collection.ItemSlot,{scope:b},reactExports.createElement($5cb92bef7577960e$export$be92b6f5f03c0fe9,{asChild:!0,onEscapeKeyDown:$e42e1063c40fb3ef$export$b9ecd428b558ff10(Tt,()=>{Gt.isFocusedToastEscapeKeyDownRef.current||Xo(),Gt.isFocusedToastEscapeKeyDownRef.current=!1})},reactExports.createElement($8927f6f2acc4f386$export$250ffa63cdc0d034.li,_extends$1({role:"status","aria-live":"off","aria-atomic":!0,tabIndex:0,"data-state":at?"open":"closed","data-swipe-direction":Gt.swipeDirection},Ft,{ref:Kt,style:{userSelect:"none",touchAction:"none",...d.style},onKeyDown:$e42e1063c40fb3ef$export$b9ecd428b558ff10(d.onKeyDown,Uo=>{Uo.key==="Escape"&&(Tt==null||Tt(Uo.nativeEvent),Uo.nativeEvent.defaultPrevented||(Gt.isFocusedToastEscapeKeyDownRef.current=!0,Xo()))}),onPointerDown:$e42e1063c40fb3ef$export$b9ecd428b558ff10(d.onPointerDown,Uo=>{Uo.button===0&&(rr.current={x:Uo.clientX,y:Uo.clientY})}),onPointerMove:$e42e1063c40fb3ef$export$b9ecd428b558ff10(d.onPointerMove,Uo=>{if(!rr.current)return;const No=Uo.clientX-rr.current.x,_n=Uo.clientY-rr.current.y,Kr=!!ir.current,e0=["left","right"].includes(Gt.swipeDirection),Zr=["left","up"].includes(Gt.swipeDirection)?Math.min:Math.max,Ro=e0?Zr(0,No):0,Sn=e0?0:Zr(0,_n),Tn=Uo.pointerType==="touch"?10:2,n0={x:Ro,y:Sn},Go={originalEvent:Uo,delta:n0};Kr?(ir.current=n0,$054eb8030ebde76e$var$handleAndDispatchCustomEvent($054eb8030ebde76e$var$TOAST_SWIPE_MOVE,$t,Go,{discrete:!1})):$054eb8030ebde76e$var$isDeltaInDirection(n0,Gt.swipeDirection,Tn)?(ir.current=n0,$054eb8030ebde76e$var$handleAndDispatchCustomEvent($054eb8030ebde76e$var$TOAST_SWIPE_START,wt,Go,{discrete:!1}),Uo.target.setPointerCapture(Uo.pointerId)):(Math.abs(No)>Tn||Math.abs(_n)>Tn)&&(rr.current=null)}),onPointerUp:$e42e1063c40fb3ef$export$b9ecd428b558ff10(d.onPointerUp,Uo=>{const No=ir.current,_n=Uo.target;if(_n.hasPointerCapture(Uo.pointerId)&&_n.releasePointerCapture(Uo.pointerId),ir.current=null,rr.current=null,No){const Kr=Uo.currentTarget,e0={originalEvent:Uo,delta:No};$054eb8030ebde76e$var$isDeltaInDirection(No,Gt.swipeDirection,Gt.swipeThreshold)?$054eb8030ebde76e$var$handleAndDispatchCustomEvent($054eb8030ebde76e$var$TOAST_SWIPE_END,jt,e0,{discrete:!0}):$054eb8030ebde76e$var$handleAndDispatchCustomEvent($054eb8030ebde76e$var$TOAST_SWIPE_CANCEL,Lt,e0,{discrete:!0}),Kr.addEventListener("click",Zr=>Zr.preventDefault(),{once:!0})}})})))),Gt.viewport))):null});$054eb8030ebde76e$var$ToastImpl.propTypes={type(d){if(d.type&&!["foreground","background"].includes(d.type)){const g=`Invalid prop \`type\` supplied to \`${$054eb8030ebde76e$var$TOAST_NAME}\`. Expected \`foreground | background\`.`;return new Error(g)}return null}};const $054eb8030ebde76e$var$ToastAnnounce=d=>{const{__scopeToast:g,children:b,...et}=d,st=$054eb8030ebde76e$var$useToastProviderContext($054eb8030ebde76e$var$TOAST_NAME,g),[at,vt]=reactExports.useState(!1),[Tt,Ct]=reactExports.useState(!1);return $054eb8030ebde76e$var$useNextFrame(()=>vt(!0)),reactExports.useEffect(()=>{const pt=window.setTimeout(()=>Ct(!0),1e3);return()=>window.clearTimeout(pt)},[]),Tt?null:reactExports.createElement($f1701beae083dbae$export$602eac185826482c,{asChild:!0},reactExports.createElement($ea1ef594cf570d83$export$439d29a4e110a164,et,at&&reactExports.createElement(reactExports.Fragment,null,st.label," ",b)))},$054eb8030ebde76e$export$16d42d7c29b95a4=reactExports.forwardRef((d,g)=>{const{__scopeToast:b,...et}=d;return reactExports.createElement($8927f6f2acc4f386$export$250ffa63cdc0d034.div,_extends$1({},et,{ref:g}))}),$054eb8030ebde76e$export$ecddd96c53621d9a=reactExports.forwardRef((d,g)=>{const{__scopeToast:b,...et}=d;return reactExports.createElement($8927f6f2acc4f386$export$250ffa63cdc0d034.div,_extends$1({},et,{ref:g}))}),$054eb8030ebde76e$var$ACTION_NAME="ToastAction",$054eb8030ebde76e$export$3019feecfda683d2=reactExports.forwardRef((d,g)=>{const{altText:b,...et}=d;return b?reactExports.createElement($054eb8030ebde76e$var$ToastAnnounceExclude,{altText:b,asChild:!0},reactExports.createElement($054eb8030ebde76e$export$811e70f61c205839,_extends$1({},et,{ref:g}))):null});$054eb8030ebde76e$export$3019feecfda683d2.propTypes={altText(d){return d.altText?null:new Error(`Missing prop \`altText\` expected on \`${$054eb8030ebde76e$var$ACTION_NAME}\``)}};const $054eb8030ebde76e$var$CLOSE_NAME="ToastClose",$054eb8030ebde76e$export$811e70f61c205839=reactExports.forwardRef((d,g)=>{const{__scopeToast:b,...et}=d,st=$054eb8030ebde76e$var$useToastInteractiveContext($054eb8030ebde76e$var$CLOSE_NAME,b);return reactExports.createElement($054eb8030ebde76e$var$ToastAnnounceExclude,{asChild:!0},reactExports.createElement($8927f6f2acc4f386$export$250ffa63cdc0d034.button,_extends$1({type:"button"},et,{ref:g,onClick:$e42e1063c40fb3ef$export$b9ecd428b558ff10(d.onClick,st.onClose)})))}),$054eb8030ebde76e$var$ToastAnnounceExclude=reactExports.forwardRef((d,g)=>{const{__scopeToast:b,altText:et,...st}=d;return reactExports.createElement($8927f6f2acc4f386$export$250ffa63cdc0d034.div,_extends$1({"data-radix-toast-announce-exclude":"","data-radix-toast-announce-alt":et||void 0},st,{ref:g}))});function $054eb8030ebde76e$var$getAnnounceTextContent(d){const g=[];return Array.from(d.childNodes).forEach(et=>{if(et.nodeType===et.TEXT_NODE&&et.textContent&&g.push(et.textContent),$054eb8030ebde76e$var$isHTMLElement(et)){const st=et.ariaHidden||et.hidden||et.style.display==="none",at=et.dataset.radixToastAnnounceExclude==="";if(!st)if(at){const vt=et.dataset.radixToastAnnounceAlt;vt&&g.push(vt)}else g.push(...$054eb8030ebde76e$var$getAnnounceTextContent(et))}}),g}function $054eb8030ebde76e$var$handleAndDispatchCustomEvent(d,g,b,{discrete:et}){const st=b.originalEvent.currentTarget,at=new CustomEvent(d,{bubbles:!0,cancelable:!0,detail:b});g&&st.addEventListener(d,g,{once:!0}),et?$8927f6f2acc4f386$export$6d1a0317bde7de7f(st,at):st.dispatchEvent(at)}const $054eb8030ebde76e$var$isDeltaInDirection=(d,g,b=0)=>{const et=Math.abs(d.x),st=Math.abs(d.y),at=et>st;return g==="left"||g==="right"?at&&et>b:!at&&st>b};function $054eb8030ebde76e$var$useNextFrame(d=()=>{}){const g=$b1b2314f5f9a1d84$export$25bec8c6f54ee79a(d);$9f79659886946c16$export$e5c5a5f917a5871c(()=>{let b=0,et=0;return b=window.requestAnimationFrame(()=>et=window.requestAnimationFrame(g)),()=>{window.cancelAnimationFrame(b),window.cancelAnimationFrame(et)}},[g])}function $054eb8030ebde76e$var$isHTMLElement(d){return d.nodeType===d.ELEMENT_NODE}function $054eb8030ebde76e$var$getTabbableCandidates(d){const g=[],b=document.createTreeWalker(d,NodeFilter.SHOW_ELEMENT,{acceptNode:et=>{const st=et.tagName==="INPUT"&&et.type==="hidden";return et.disabled||et.hidden||st?NodeFilter.FILTER_SKIP:et.tabIndex>=0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});for(;b.nextNode();)g.push(b.currentNode);return g}function $054eb8030ebde76e$var$focusFirst(d){const g=document.activeElement;return d.some(b=>b===g?!0:(b.focus(),document.activeElement!==g))}const $054eb8030ebde76e$export$2881499e37b75b9a=$054eb8030ebde76e$export$f5d03d415824e0e,$054eb8030ebde76e$export$d5c6c08dc2d3ca7=$054eb8030ebde76e$export$6192c2425ecfd989,$054eb8030ebde76e$export$be92b6f5f03c0fe9=$054eb8030ebde76e$export$8d8dc7d5f743331b,$054eb8030ebde76e$export$f99233281efd08a0=$054eb8030ebde76e$export$16d42d7c29b95a4,$054eb8030ebde76e$export$393edc798c47379d=$054eb8030ebde76e$export$ecddd96c53621d9a,$054eb8030ebde76e$export$e19cd5f9376f8cee=$054eb8030ebde76e$export$3019feecfda683d2,$054eb8030ebde76e$export$f39c2d165cd861fe=$054eb8030ebde76e$export$811e70f61c205839;function r$4(d){var g,b,et="";if(typeof d=="string"||typeof d=="number")et+=d;else if(typeof d=="object")if(Array.isArray(d))for(g=0;g<d.length;g++)d[g]&&(b=r$4(d[g]))&&(et&&(et+=" "),et+=b);else for(g in d)d[g]&&(et&&(et+=" "),et+=g);return et}function clsx$1(){for(var d,g,b=0,et="";b<arguments.length;)(d=arguments[b++])&&(g=r$4(d))&&(et&&(et+=" "),et+=g);return et}const falsyToString=d=>typeof d=="boolean"?"".concat(d):d===0?"0":d,cx=clsx$1,cva=(d,g)=>b=>{var et;if((g==null?void 0:g.variants)==null)return cx(d,b==null?void 0:b.class,b==null?void 0:b.className);const{variants:st,defaultVariants:at}=g,vt=Object.keys(st).map(pt=>{const wt=b==null?void 0:b[pt],$t=at==null?void 0:at[pt];if(wt===null)return null;const Lt=falsyToString(wt)||falsyToString($t);return st[pt][Lt]}),Tt=b&&Object.entries(b).reduce((pt,wt)=>{let[$t,Lt]=wt;return Lt===void 0||(pt[$t]=Lt),pt},{}),Ct=g==null||(et=g.compoundVariants)===null||et===void 0?void 0:et.reduce((pt,wt)=>{let{class:$t,className:Lt,...jt}=wt;return Object.entries(jt).every(Ft=>{let[Gt,Ht]=Ft;return Array.isArray(Ht)?Ht.includes({...at,...Tt}[Gt]):{...at,...Tt}[Gt]===Ht})?[...pt,$t,Lt]:pt},[]);return cx(d,vt,Ct,b==null?void 0:b.class,b==null?void 0:b.className)};function r$3(d){var g,b,et="";if(typeof d=="string"||typeof d=="number")et+=d;else if(typeof d=="object")if(Array.isArray(d)){var st=d.length;for(g=0;g<st;g++)d[g]&&(b=r$3(d[g]))&&(et&&(et+=" "),et+=b)}else for(b in d)d[b]&&(et&&(et+=" "),et+=b);return et}function clsx(){for(var d,g,b=0,et="",st=arguments.length;b<st;b++)(d=arguments[b])&&(g=r$3(d))&&(et&&(et+=" "),et+=g);return et}const CLASS_PART_SEPARATOR="-";function createClassUtils(d){const g=createClassMap(d),{conflictingClassGroups:b,conflictingClassGroupModifiers:et}=d;function st(vt){const Tt=vt.split(CLASS_PART_SEPARATOR);return Tt[0]===""&&Tt.length!==1&&Tt.shift(),getGroupRecursive(Tt,g)||getGroupIdForArbitraryProperty(vt)}function at(vt,Tt){const Ct=b[vt]||[];return Tt&&et[vt]?[...Ct,...et[vt]]:Ct}return{getClassGroupId:st,getConflictingClassGroupIds:at}}function getGroupRecursive(d,g){var vt;if(d.length===0)return g.classGroupId;const b=d[0],et=g.nextPart.get(b),st=et?getGroupRecursive(d.slice(1),et):void 0;if(st)return st;if(g.validators.length===0)return;const at=d.join(CLASS_PART_SEPARATOR);return(vt=g.validators.find(({validator:Tt})=>Tt(at)))==null?void 0:vt.classGroupId}const arbitraryPropertyRegex=/^\[(.+)\]$/;function getGroupIdForArbitraryProperty(d){if(arbitraryPropertyRegex.test(d)){const g=arbitraryPropertyRegex.exec(d)[1],b=g==null?void 0:g.substring(0,g.indexOf(":"));if(b)return"arbitrary.."+b}}function createClassMap(d){const{theme:g,prefix:b}=d,et={nextPart:new Map,validators:[]};return getPrefixedClassGroupEntries(Object.entries(d.classGroups),b).forEach(([at,vt])=>{processClassesRecursively(vt,et,at,g)}),et}function processClassesRecursively(d,g,b,et){d.forEach(st=>{if(typeof st=="string"){const at=st===""?g:getPart(g,st);at.classGroupId=b;return}if(typeof st=="function"){if(isThemeGetter(st)){processClassesRecursively(st(et),g,b,et);return}g.validators.push({validator:st,classGroupId:b});return}Object.entries(st).forEach(([at,vt])=>{processClassesRecursively(vt,getPart(g,at),b,et)})})}function getPart(d,g){let b=d;return g.split(CLASS_PART_SEPARATOR).forEach(et=>{b.nextPart.has(et)||b.nextPart.set(et,{nextPart:new Map,validators:[]}),b=b.nextPart.get(et)}),b}function isThemeGetter(d){return d.isThemeGetter}function getPrefixedClassGroupEntries(d,g){return g?d.map(([b,et])=>{const st=et.map(at=>typeof at=="string"?g+at:typeof at=="object"?Object.fromEntries(Object.entries(at).map(([vt,Tt])=>[g+vt,Tt])):at);return[b,st]}):d}function createLruCache(d){if(d<1)return{get:()=>{},set:()=>{}};let g=0,b=new Map,et=new Map;function st(at,vt){b.set(at,vt),g++,g>d&&(g=0,et=b,b=new Map)}return{get(at){let vt=b.get(at);if(vt!==void 0)return vt;if((vt=et.get(at))!==void 0)return st(at,vt),vt},set(at,vt){b.has(at)?b.set(at,vt):st(at,vt)}}}const IMPORTANT_MODIFIER="!";function createSplitModifiers(d){const g=d.separator,b=g.length===1,et=g[0],st=g.length;return function(vt){const Tt=[];let Ct=0,pt=0,wt;for(let Gt=0;Gt<vt.length;Gt++){let Ht=vt[Gt];if(Ct===0){if(Ht===et&&(b||vt.slice(Gt,Gt+st)===g)){Tt.push(vt.slice(pt,Gt)),pt=Gt+st;continue}if(Ht==="/"){wt=Gt;continue}}Ht==="["?Ct++:Ht==="]"&&Ct--}const $t=Tt.length===0?vt:vt.substring(pt),Lt=$t.startsWith(IMPORTANT_MODIFIER),jt=Lt?$t.substring(1):$t,Ft=wt&&wt>pt?wt-pt:void 0;return{modifiers:Tt,hasImportantModifier:Lt,baseClassName:jt,maybePostfixModifierPosition:Ft}}}function sortModifiers(d){if(d.length<=1)return d;const g=[];let b=[];return d.forEach(et=>{et[0]==="["?(g.push(...b.sort(),et),b=[]):b.push(et)}),g.push(...b.sort()),g}function createConfigUtils(d){return{cache:createLruCache(d.cacheSize),splitModifiers:createSplitModifiers(d),...createClassUtils(d)}}const SPLIT_CLASSES_REGEX=/\s+/;function mergeClassList(d,g){const{splitModifiers:b,getClassGroupId:et,getConflictingClassGroupIds:st}=g,at=new Set;return d.trim().split(SPLIT_CLASSES_REGEX).map(vt=>{const{modifiers:Tt,hasImportantModifier:Ct,baseClassName:pt,maybePostfixModifierPosition:wt}=b(vt);let $t=et(wt?pt.substring(0,wt):pt),Lt=!!wt;if(!$t){if(!wt)return{isTailwindClass:!1,originalClassName:vt};if($t=et(pt),!$t)return{isTailwindClass:!1,originalClassName:vt};Lt=!1}const jt=sortModifiers(Tt).join(":");return{isTailwindClass:!0,modifierId:Ct?jt+IMPORTANT_MODIFIER:jt,classGroupId:$t,originalClassName:vt,hasPostfixModifier:Lt}}).reverse().filter(vt=>{if(!vt.isTailwindClass)return!0;const{modifierId:Tt,classGroupId:Ct,hasPostfixModifier:pt}=vt,wt=Tt+Ct;return at.has(wt)?!1:(at.add(wt),st(Ct,pt).forEach($t=>at.add(Tt+$t)),!0)}).reverse().map(vt=>vt.originalClassName).join(" ")}function twJoin(){let d=0,g,b,et="";for(;d<arguments.length;)(g=arguments[d++])&&(b=toValue(g))&&(et&&(et+=" "),et+=b);return et}function toValue(d){if(typeof d=="string")return d;let g,b="";for(let et=0;et<d.length;et++)d[et]&&(g=toValue(d[et]))&&(b&&(b+=" "),b+=g);return b}function createTailwindMerge(d,...g){let b,et,st,at=vt;function vt(Ct){const pt=g.reduce((wt,$t)=>$t(wt),d());return b=createConfigUtils(pt),et=b.cache.get,st=b.cache.set,at=Tt,Tt(Ct)}function Tt(Ct){const pt=et(Ct);if(pt)return pt;const wt=mergeClassList(Ct,b);return st(Ct,wt),wt}return function(){return at(twJoin.apply(null,arguments))}}function fromTheme(d){const g=b=>b[d]||[];return g.isThemeGetter=!0,g}const arbitraryValueRegex=/^\[(?:([a-z-]+):)?(.+)\]$/i,fractionRegex=/^\d+\/\d+$/,stringLengths=new Set(["px","full","screen"]),tshirtUnitRegex=/^(\d+(\.\d+)?)?(xs|sm|md|lg|xl)$/,lengthUnitRegex=/\d+(%|px|r?em|[sdl]?v([hwib]|min|max)|pt|pc|in|cm|mm|cap|ch|ex|r?lh|cq(w|h|i|b|min|max))|\b(calc|min|max|clamp)\(.+\)|^0$/,colorFunctionRegex=/^(rgba?|hsla?|hwb|(ok)?(lab|lch))\(.+\)$/,shadowRegex=/^(inset_)?-?((\d+)?\.?(\d+)[a-z]+|0)_-?((\d+)?\.?(\d+)[a-z]+|0)/,imageRegex=/^(url|image|image-set|cross-fade|element|(repeating-)?(linear|radial|conic)-gradient)\(.+\)$/;function isLength(d){return isNumber$1(d)||stringLengths.has(d)||fractionRegex.test(d)}function isArbitraryLength(d){return getIsArbitraryValue(d,"length",isLengthOnly)}function isNumber$1(d){return!!d&&!Number.isNaN(Number(d))}function isArbitraryNumber(d){return getIsArbitraryValue(d,"number",isNumber$1)}function isInteger(d){return!!d&&Number.isInteger(Number(d))}function isPercent(d){return d.endsWith("%")&&isNumber$1(d.slice(0,-1))}function isArbitraryValue(d){return arbitraryValueRegex.test(d)}function isTshirtSize(d){return tshirtUnitRegex.test(d)}const sizeLabels=new Set(["length","size","percentage"]);function isArbitrarySize(d){return getIsArbitraryValue(d,sizeLabels,isNever)}function isArbitraryPosition(d){return getIsArbitraryValue(d,"position",isNever)}const imageLabels=new Set(["image","url"]);function isArbitraryImage(d){return getIsArbitraryValue(d,imageLabels,isImage)}function isArbitraryShadow(d){return getIsArbitraryValue(d,"",isShadow)}function isAny(){return!0}function getIsArbitraryValue(d,g,b){const et=arbitraryValueRegex.exec(d);return et?et[1]?typeof g=="string"?et[1]===g:g.has(et[1]):b(et[2]):!1}function isLengthOnly(d){return lengthUnitRegex.test(d)&&!colorFunctionRegex.test(d)}function isNever(){return!1}function isShadow(d){return shadowRegex.test(d)}function isImage(d){return imageRegex.test(d)}function getDefaultConfig(){const d=fromTheme("colors"),g=fromTheme("spacing"),b=fromTheme("blur"),et=fromTheme("brightness"),st=fromTheme("borderColor"),at=fromTheme("borderRadius"),vt=fromTheme("borderSpacing"),Tt=fromTheme("borderWidth"),Ct=fromTheme("contrast"),pt=fromTheme("grayscale"),wt=fromTheme("hueRotate"),$t=fromTheme("invert"),Lt=fromTheme("gap"),jt=fromTheme("gradientColorStops"),Ft=fromTheme("gradientColorStopPositions"),Gt=fromTheme("inset"),Ht=fromTheme("margin"),qt=fromTheme("opacity"),Kt=fromTheme("padding"),rr=fromTheme("saturate"),ir=fromTheme("scale"),or=fromTheme("sepia"),jr=fromTheme("skew"),qr=fromTheme("space"),Yr=fromTheme("translate"),vn=()=>["auto","contain","none"],ko=()=>["auto","hidden","clip","visible","scroll"],Xo=()=>["auto",isArbitraryValue,g],zo=()=>[isArbitraryValue,g],t0=()=>["",isLength,isArbitraryLength],Uo=()=>["auto",isNumber$1,isArbitraryValue],No=()=>["bottom","center","left","left-bottom","left-top","right","right-bottom","right-top","top"],_n=()=>["solid","dashed","dotted","double","none"],Kr=()=>["normal","multiply","screen","overlay","darken","lighten","color-dodge","color-burn","hard-light","soft-light","difference","exclusion","hue","saturation","color","luminosity"],e0=()=>["start","end","center","between","around","evenly","stretch"],Zr=()=>["","0",isArbitraryValue],Ro=()=>["auto","avoid","all","avoid-page","page","left","right","column"],Sn=()=>[isNumber$1,isArbitraryNumber],Tn=()=>[isNumber$1,isArbitraryValue];return{cacheSize:500,separator:":",theme:{colors:[isAny],spacing:[isLength,isArbitraryLength],blur:["none","",isTshirtSize,isArbitraryValue],brightness:Sn(),borderColor:[d],borderRadius:["none","","full",isTshirtSize,isArbitraryValue],borderSpacing:zo(),borderWidth:t0(),contrast:Sn(),grayscale:Zr(),hueRotate:Tn(),invert:Zr(),gap:zo(),gradientColorStops:[d],gradientColorStopPositions:[isPercent,isArbitraryLength],inset:Xo(),margin:Xo(),opacity:Sn(),padding:zo(),saturate:Sn(),scale:Sn(),sepia:Zr(),skew:Tn(),space:zo(),translate:zo()},classGroups:{aspect:[{aspect:["auto","square","video",isArbitraryValue]}],container:["container"],columns:[{columns:[isTshirtSize]}],"break-after":[{"break-after":Ro()}],"break-before":[{"break-before":Ro()}],"break-inside":[{"break-inside":["auto","avoid","avoid-page","avoid-column"]}],"box-decoration":[{"box-decoration":["slice","clone"]}],box:[{box:["border","content"]}],display:["block","inline-block","inline","flex","inline-flex","table","inline-table","table-caption","table-cell","table-column","table-column-group","table-footer-group","table-header-group","table-row-group","table-row","flow-root","grid","inline-grid","contents","list-item","hidden"],float:[{float:["right","left","none","start","end"]}],clear:[{clear:["left","right","both","none","start","end"]}],isolation:["isolate","isolation-auto"],"object-fit":[{object:["contain","cover","fill","none","scale-down"]}],"object-position":[{object:[...No(),isArbitraryValue]}],overflow:[{overflow:ko()}],"overflow-x":[{"overflow-x":ko()}],"overflow-y":[{"overflow-y":ko()}],overscroll:[{overscroll:vn()}],"overscroll-x":[{"overscroll-x":vn()}],"overscroll-y":[{"overscroll-y":vn()}],position:["static","fixed","absolute","relative","sticky"],inset:[{inset:[Gt]}],"inset-x":[{"inset-x":[Gt]}],"inset-y":[{"inset-y":[Gt]}],start:[{start:[Gt]}],end:[{end:[Gt]}],top:[{top:[Gt]}],right:[{right:[Gt]}],bottom:[{bottom:[Gt]}],left:[{left:[Gt]}],visibility:["visible","invisible","collapse"],z:[{z:["auto",isInteger,isArbitraryValue]}],basis:[{basis:Xo()}],"flex-direction":[{flex:["row","row-reverse","col","col-reverse"]}],"flex-wrap":[{flex:["wrap","wrap-reverse","nowrap"]}],flex:[{flex:["1","auto","initial","none",isArbitraryValue]}],grow:[{grow:Zr()}],shrink:[{shrink:Zr()}],order:[{order:["first","last","none",isInteger,isArbitraryValue]}],"grid-cols":[{"grid-cols":[isAny]}],"col-start-end":[{col:["auto",{span:["full",isInteger,isArbitraryValue]},isArbitraryValue]}],"col-start":[{"col-start":Uo()}],"col-end":[{"col-end":Uo()}],"grid-rows":[{"grid-rows":[isAny]}],"row-start-end":[{row:["auto",{span:[isInteger,isArbitraryValue]},isArbitraryValue]}],"row-start":[{"row-start":Uo()}],"row-end":[{"row-end":Uo()}],"grid-flow":[{"grid-flow":["row","col","dense","row-dense","col-dense"]}],"auto-cols":[{"auto-cols":["auto","min","max","fr",isArbitraryValue]}],"auto-rows":[{"auto-rows":["auto","min","max","fr",isArbitraryValue]}],gap:[{gap:[Lt]}],"gap-x":[{"gap-x":[Lt]}],"gap-y":[{"gap-y":[Lt]}],"justify-content":[{justify:["normal",...e0()]}],"justify-items":[{"justify-items":["start","end","center","stretch"]}],"justify-self":[{"justify-self":["auto","start","end","center","stretch"]}],"align-content":[{content:["normal",...e0(),"baseline"]}],"align-items":[{items:["start","end","center","baseline","stretch"]}],"align-self":[{self:["auto","start","end","center","stretch","baseline"]}],"place-content":[{"place-content":[...e0(),"baseline"]}],"place-items":[{"place-items":["start","end","center","baseline","stretch"]}],"place-self":[{"place-self":["auto","start","end","center","stretch"]}],p:[{p:[Kt]}],px:[{px:[Kt]}],py:[{py:[Kt]}],ps:[{ps:[Kt]}],pe:[{pe:[Kt]}],pt:[{pt:[Kt]}],pr:[{pr:[Kt]}],pb:[{pb:[Kt]}],pl:[{pl:[Kt]}],m:[{m:[Ht]}],mx:[{mx:[Ht]}],my:[{my:[Ht]}],ms:[{ms:[Ht]}],me:[{me:[Ht]}],mt:[{mt:[Ht]}],mr:[{mr:[Ht]}],mb:[{mb:[Ht]}],ml:[{ml:[Ht]}],"space-x":[{"space-x":[qr]}],"space-x-reverse":["space-x-reverse"],"space-y":[{"space-y":[qr]}],"space-y-reverse":["space-y-reverse"],w:[{w:["auto","min","max","fit","svw","lvw","dvw",isArbitraryValue,g]}],"min-w":[{"min-w":[isArbitraryValue,g,"min","max","fit"]}],"max-w":[{"max-w":[isArbitraryValue,g,"none","full","min","max","fit","prose",{screen:[isTshirtSize]},isTshirtSize]}],h:[{h:[isArbitraryValue,g,"auto","min","max","fit","svh","lvh","dvh"]}],"min-h":[{"min-h":[isArbitraryValue,g,"min","max","fit","svh","lvh","dvh"]}],"max-h":[{"max-h":[isArbitraryValue,g,"min","max","fit","svh","lvh","dvh"]}],size:[{size:[isArbitraryValue,g,"auto","min","max","fit"]}],"font-size":[{text:["base",isTshirtSize,isArbitraryLength]}],"font-smoothing":["antialiased","subpixel-antialiased"],"font-style":["italic","not-italic"],"font-weight":[{font:["thin","extralight","light","normal","medium","semibold","bold","extrabold","black",isArbitraryNumber]}],"font-family":[{font:[isAny]}],"fvn-normal":["normal-nums"],"fvn-ordinal":["ordinal"],"fvn-slashed-zero":["slashed-zero"],"fvn-figure":["lining-nums","oldstyle-nums"],"fvn-spacing":["proportional-nums","tabular-nums"],"fvn-fraction":["diagonal-fractions","stacked-fractons"],tracking:[{tracking:["tighter","tight","normal","wide","wider","widest",isArbitraryValue]}],"line-clamp":[{"line-clamp":["none",isNumber$1,isArbitraryNumber]}],leading:[{leading:["none","tight","snug","normal","relaxed","loose",isLength,isArbitraryValue]}],"list-image":[{"list-image":["none",isArbitraryValue]}],"list-style-type":[{list:["none","disc","decimal",isArbitraryValue]}],"list-style-position":[{list:["inside","outside"]}],"placeholder-color":[{placeholder:[d]}],"placeholder-opacity":[{"placeholder-opacity":[qt]}],"text-alignment":[{text:["left","center","right","justify","start","end"]}],"text-color":[{text:[d]}],"text-opacity":[{"text-opacity":[qt]}],"text-decoration":["underline","overline","line-through","no-underline"],"text-decoration-style":[{decoration:[..._n(),"wavy"]}],"text-decoration-thickness":[{decoration:["auto","from-font",isLength,isArbitraryLength]}],"underline-offset":[{"underline-offset":["auto",isLength,isArbitraryValue]}],"text-decoration-color":[{decoration:[d]}],"text-transform":["uppercase","lowercase","capitalize","normal-case"],"text-overflow":["truncate","text-ellipsis","text-clip"],"text-wrap":[{text:["wrap","nowrap","balance","pretty"]}],indent:[{indent:zo()}],"vertical-align":[{align:["baseline","top","middle","bottom","text-top","text-bottom","sub","super",isArbitraryValue]}],whitespace:[{whitespace:["normal","nowrap","pre","pre-line","pre-wrap","break-spaces"]}],break:[{break:["normal","words","all","keep"]}],hyphens:[{hyphens:["none","manual","auto"]}],content:[{content:["none",isArbitraryValue]}],"bg-attachment":[{bg:["fixed","local","scroll"]}],"bg-clip":[{"bg-clip":["border","padding","content","text"]}],"bg-opacity":[{"bg-opacity":[qt]}],"bg-origin":[{"bg-origin":["border","padding","content"]}],"bg-position":[{bg:[...No(),isArbitraryPosition]}],"bg-repeat":[{bg:["no-repeat",{repeat:["","x","y","round","space"]}]}],"bg-size":[{bg:["auto","cover","contain",isArbitrarySize]}],"bg-image":[{bg:["none",{"gradient-to":["t","tr","r","br","b","bl","l","tl"]},isArbitraryImage]}],"bg-color":[{bg:[d]}],"gradient-from-pos":[{from:[Ft]}],"gradient-via-pos":[{via:[Ft]}],"gradient-to-pos":[{to:[Ft]}],"gradient-from":[{from:[jt]}],"gradient-via":[{via:[jt]}],"gradient-to":[{to:[jt]}],rounded:[{rounded:[at]}],"rounded-s":[{"rounded-s":[at]}],"rounded-e":[{"rounded-e":[at]}],"rounded-t":[{"rounded-t":[at]}],"rounded-r":[{"rounded-r":[at]}],"rounded-b":[{"rounded-b":[at]}],"rounded-l":[{"rounded-l":[at]}],"rounded-ss":[{"rounded-ss":[at]}],"rounded-se":[{"rounded-se":[at]}],"rounded-ee":[{"rounded-ee":[at]}],"rounded-es":[{"rounded-es":[at]}],"rounded-tl":[{"rounded-tl":[at]}],"rounded-tr":[{"rounded-tr":[at]}],"rounded-br":[{"rounded-br":[at]}],"rounded-bl":[{"rounded-bl":[at]}],"border-w":[{border:[Tt]}],"border-w-x":[{"border-x":[Tt]}],"border-w-y":[{"border-y":[Tt]}],"border-w-s":[{"border-s":[Tt]}],"border-w-e":[{"border-e":[Tt]}],"border-w-t":[{"border-t":[Tt]}],"border-w-r":[{"border-r":[Tt]}],"border-w-b":[{"border-b":[Tt]}],"border-w-l":[{"border-l":[Tt]}],"border-opacity":[{"border-opacity":[qt]}],"border-style":[{border:[..._n(),"hidden"]}],"divide-x":[{"divide-x":[Tt]}],"divide-x-reverse":["divide-x-reverse"],"divide-y":[{"divide-y":[Tt]}],"divide-y-reverse":["divide-y-reverse"],"divide-opacity":[{"divide-opacity":[qt]}],"divide-style":[{divide:_n()}],"border-color":[{border:[st]}],"border-color-x":[{"border-x":[st]}],"border-color-y":[{"border-y":[st]}],"border-color-t":[{"border-t":[st]}],"border-color-r":[{"border-r":[st]}],"border-color-b":[{"border-b":[st]}],"border-color-l":[{"border-l":[st]}],"divide-color":[{divide:[st]}],"outline-style":[{outline:["",..._n()]}],"outline-offset":[{"outline-offset":[isLength,isArbitraryValue]}],"outline-w":[{outline:[isLength,isArbitraryLength]}],"outline-color":[{outline:[d]}],"ring-w":[{ring:t0()}],"ring-w-inset":["ring-inset"],"ring-color":[{ring:[d]}],"ring-opacity":[{"ring-opacity":[qt]}],"ring-offset-w":[{"ring-offset":[isLength,isArbitraryLength]}],"ring-offset-color":[{"ring-offset":[d]}],shadow:[{shadow:["","inner","none",isTshirtSize,isArbitraryShadow]}],"shadow-color":[{shadow:[isAny]}],opacity:[{opacity:[qt]}],"mix-blend":[{"mix-blend":[...Kr(),"plus-lighter","plus-darker"]}],"bg-blend":[{"bg-blend":Kr()}],filter:[{filter:["","none"]}],blur:[{blur:[b]}],brightness:[{brightness:[et]}],contrast:[{contrast:[Ct]}],"drop-shadow":[{"drop-shadow":["","none",isTshirtSize,isArbitraryValue]}],grayscale:[{grayscale:[pt]}],"hue-rotate":[{"hue-rotate":[wt]}],invert:[{invert:[$t]}],saturate:[{saturate:[rr]}],sepia:[{sepia:[or]}],"backdrop-filter":[{"backdrop-filter":["","none"]}],"backdrop-blur":[{"backdrop-blur":[b]}],"backdrop-brightness":[{"backdrop-brightness":[et]}],"backdrop-contrast":[{"backdrop-contrast":[Ct]}],"backdrop-grayscale":[{"backdrop-grayscale":[pt]}],"backdrop-hue-rotate":[{"backdrop-hue-rotate":[wt]}],"backdrop-invert":[{"backdrop-invert":[$t]}],"backdrop-opacity":[{"backdrop-opacity":[qt]}],"backdrop-saturate":[{"backdrop-saturate":[rr]}],"backdrop-sepia":[{"backdrop-sepia":[or]}],"border-collapse":[{border:["collapse","separate"]}],"border-spacing":[{"border-spacing":[vt]}],"border-spacing-x":[{"border-spacing-x":[vt]}],"border-spacing-y":[{"border-spacing-y":[vt]}],"table-layout":[{table:["auto","fixed"]}],caption:[{caption:["top","bottom"]}],transition:[{transition:["none","all","","colors","opacity","shadow","transform",isArbitraryValue]}],duration:[{duration:Tn()}],ease:[{ease:["linear","in","out","in-out",isArbitraryValue]}],delay:[{delay:Tn()}],animate:[{animate:["none","spin","ping","pulse","bounce",isArbitraryValue]}],transform:[{transform:["","gpu","none"]}],scale:[{scale:[ir]}],"scale-x":[{"scale-x":[ir]}],"scale-y":[{"scale-y":[ir]}],rotate:[{rotate:[isInteger,isArbitraryValue]}],"translate-x":[{"translate-x":[Yr]}],"translate-y":[{"translate-y":[Yr]}],"skew-x":[{"skew-x":[jr]}],"skew-y":[{"skew-y":[jr]}],"transform-origin":[{origin:["center","top","top-right","right","bottom-right","bottom","bottom-left","left","top-left",isArbitraryValue]}],accent:[{accent:["auto",d]}],appearance:[{appearance:["none","auto"]}],cursor:[{cursor:["auto","default","pointer","wait","text","move","help","not-allowed","none","context-menu","progress","cell","crosshair","vertical-text","alias","copy","no-drop","grab","grabbing","all-scroll","col-resize","row-resize","n-resize","e-resize","s-resize","w-resize","ne-resize","nw-resize","se-resize","sw-resize","ew-resize","ns-resize","nesw-resize","nwse-resize","zoom-in","zoom-out",isArbitraryValue]}],"caret-color":[{caret:[d]}],"pointer-events":[{"pointer-events":["none","auto"]}],resize:[{resize:["none","y","x",""]}],"scroll-behavior":[{scroll:["auto","smooth"]}],"scroll-m":[{"scroll-m":zo()}],"scroll-mx":[{"scroll-mx":zo()}],"scroll-my":[{"scroll-my":zo()}],"scroll-ms":[{"scroll-ms":zo()}],"scroll-me":[{"scroll-me":zo()}],"scroll-mt":[{"scroll-mt":zo()}],"scroll-mr":[{"scroll-mr":zo()}],"scroll-mb":[{"scroll-mb":zo()}],"scroll-ml":[{"scroll-ml":zo()}],"scroll-p":[{"scroll-p":zo()}],"scroll-px":[{"scroll-px":zo()}],"scroll-py":[{"scroll-py":zo()}],"scroll-ps":[{"scroll-ps":zo()}],"scroll-pe":[{"scroll-pe":zo()}],"scroll-pt":[{"scroll-pt":zo()}],"scroll-pr":[{"scroll-pr":zo()}],"scroll-pb":[{"scroll-pb":zo()}],"scroll-pl":[{"scroll-pl":zo()}],"snap-align":[{snap:["start","end","center","align-none"]}],"snap-stop":[{snap:["normal","always"]}],"snap-type":[{snap:["none","x","y","both"]}],"snap-strictness":[{snap:["mandatory","proximity"]}],touch:[{touch:["auto","none","manipulation"]}],"touch-x":[{"touch-pan":["x","left","right"]}],"touch-y":[{"touch-pan":["y","up","down"]}],"touch-pz":["touch-pinch-zoom"],select:[{select:["none","text","all","auto"]}],"will-change":[{"will-change":["auto","scroll","contents","transform",isArbitraryValue]}],fill:[{fill:[d,"none"]}],"stroke-w":[{stroke:[isLength,isArbitraryLength,isArbitraryNumber]}],stroke:[{stroke:[d,"none"]}],sr:["sr-only","not-sr-only"],"forced-color-adjust":[{"forced-color-adjust":["auto","none"]}]},conflictingClassGroups:{overflow:["overflow-x","overflow-y"],overscroll:["overscroll-x","overscroll-y"],inset:["inset-x","inset-y","start","end","top","right","bottom","left"],"inset-x":["right","left"],"inset-y":["top","bottom"],flex:["basis","grow","shrink"],gap:["gap-x","gap-y"],p:["px","py","ps","pe","pt","pr","pb","pl"],px:["pr","pl"],py:["pt","pb"],m:["mx","my","ms","me","mt","mr","mb","ml"],mx:["mr","ml"],my:["mt","mb"],size:["w","h"],"font-size":["leading"],"fvn-normal":["fvn-ordinal","fvn-slashed-zero","fvn-figure","fvn-spacing","fvn-fraction"],"fvn-ordinal":["fvn-normal"],"fvn-slashed-zero":["fvn-normal"],"fvn-figure":["fvn-normal"],"fvn-spacing":["fvn-normal"],"fvn-fraction":["fvn-normal"],"line-clamp":["display","overflow"],rounded:["rounded-s","rounded-e","rounded-t","rounded-r","rounded-b","rounded-l","rounded-ss","rounded-se","rounded-ee","rounded-es","rounded-tl","rounded-tr","rounded-br","rounded-bl"],"rounded-s":["rounded-ss","rounded-es"],"rounded-e":["rounded-se","rounded-ee"],"rounded-t":["rounded-tl","rounded-tr"],"rounded-r":["rounded-tr","rounded-br"],"rounded-b":["rounded-br","rounded-bl"],"rounded-l":["rounded-tl","rounded-bl"],"border-spacing":["border-spacing-x","border-spacing-y"],"border-w":["border-w-s","border-w-e","border-w-t","border-w-r","border-w-b","border-w-l"],"border-w-x":["border-w-r","border-w-l"],"border-w-y":["border-w-t","border-w-b"],"border-color":["border-color-t","border-color-r","border-color-b","border-color-l"],"border-color-x":["border-color-r","border-color-l"],"border-color-y":["border-color-t","border-color-b"],"scroll-m":["scroll-mx","scroll-my","scroll-ms","scroll-me","scroll-mt","scroll-mr","scroll-mb","scroll-ml"],"scroll-mx":["scroll-mr","scroll-ml"],"scroll-my":["scroll-mt","scroll-mb"],"scroll-p":["scroll-px","scroll-py","scroll-ps","scroll-pe","scroll-pt","scroll-pr","scroll-pb","scroll-pl"],"scroll-px":["scroll-pr","scroll-pl"],"scroll-py":["scroll-pt","scroll-pb"],touch:["touch-x","touch-y","touch-pz"],"touch-x":["touch"],"touch-y":["touch"],"touch-pz":["touch"]},conflictingClassGroupModifiers:{"font-size":["leading"]}}}const twMerge=createTailwindMerge(getDefaultConfig),DEFAULT_BRUSH_SIZE=40,MIN_BRUSH_SIZE=3,MAX_BRUSH_SIZE=200,MODEL_TYPE_INPAINT="inpaint",MODEL_TYPE_DIFFUSERS_SD="diffusers_sd",MODEL_TYPE_DIFFUSERS_SDXL="diffusers_sdxl",MODEL_TYPE_DIFFUSERS_SD_INPAINT="diffusers_sd_inpaint",MODEL_TYPE_DIFFUSERS_SDXL_INPAINT="diffusers_sdxl_inpaint",MODEL_TYPE_OTHER="diffusers_other",BRUSH_COLOR="#ffcc00bb",LDM="ldm",CV2="cv2",PAINT_BY_EXAMPLE="Fantasy-Studio/Paint-by-Example",INSTRUCT_PIX2PIX="timbrooks/instruct-pix2pix",POWERPAINT="Sanster/PowerPaint-V1-stable-diffusion-inpainting",ANYTEXT="Sanster/AnyText",DEFAULT_NEGATIVE_PROMPT="out of frame, lowres, error, cropped, worst quality, low quality, jpeg artifacts, ugly, duplicate, morbid, mutilated, out of frame, mutation, deformed, blurry, dehydrated, bad anatomy, bad proportions, extra limbs, disfigured, gross proportions, malformed limbs, watermark, signature";var fabric={};const __viteBrowserExternal={},__viteBrowserExternal$1=Object.freeze(Object.defineProperty({__proto__:null,default:__viteBrowserExternal},Symbol.toStringTag,{value:"Module"})),require$$2=getAugmentedNamespace(__viteBrowserExternal$1);(function(d){/*! Fabric.js Copyright 2008-2015, Printio (Juriy Zaytsev, Maxim Chernyak) */var g=g||{version:"5.3.0"};if(d.fabric=g,typeof document<"u"&&typeof window<"u")document instanceof(typeof HTMLDocument<"u"?HTMLDocument:Document)?g.document=document:g.document=document.implementation.createHTMLDocument(""),g.window=window;else{var b=require$$2,et=new b.JSDOM(decodeURIComponent("%3C!DOCTYPE%20html%3E%3Chtml%3E%3Chead%3E%3C%2Fhead%3E%3Cbody%3E%3C%2Fbody%3E%3C%2Fhtml%3E"),{features:{FetchExternalResources:["img"]},resources:"usable"}).window;g.document=et.document,g.jsdomImplForWrapper=require$$2.implForWrapper,g.nodeCanvas=require$$2.Canvas,g.window=et,DOMParser=g.window.DOMParser}g.isTouchSupported="ontouchstart"in g.window||"ontouchstart"in g.document||g.window&&g.window.navigator&&g.window.navigator.maxTouchPoints>0,g.isLikelyNode=typeof Buffer<"u"&&typeof window>"u",g.SHARED_ATTRIBUTES=["display","transform","fill","fill-opacity","fill-rule","opacity","stroke","stroke-dasharray","stroke-linecap","stroke-dashoffset","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke-width","id","paint-order","vector-effect","instantiated_by_use","clip-path"],g.DPI=96,g.reNum="(?:[-+]?(?:\\d+|\\d*\\.\\d+)(?:[eE][-+]?\\d+)?)",g.commaWsp="(?:\\s+,?\\s*|,\\s*)",g.rePathCommand=/([-+]?((\d+\.\d+)|((\d+)|(\.\d+)))(?:[eE][-+]?\d+)?)/ig,g.reNonWord=/[ \n\.,;!\?\-]/,g.fontPaths={},g.iMatrix=[1,0,0,1,0,0],g.svgNS="http://www.w3.org/2000/svg",g.perfLimitSizeTotal=2097152,g.maxCacheSideLimit=4096,g.minCacheSideLimit=256,g.charWidthsCache={},g.textureSize=2048,g.disableStyleCopyPaste=!1,g.enableGLFiltering=!0,g.devicePixelRatio=g.window.devicePixelRatio||g.window.webkitDevicePixelRatio||g.window.mozDevicePixelRatio||1,g.browserShadowBlurConstant=1,g.arcToSegmentsCache={},g.boundsOfCurveCache={},g.cachesBoundsOfCurve=!0,g.forceGLPutImageData=!1,g.initFilterBackend=function(){if(g.enableGLFiltering&&g.isWebglSupported&&g.isWebglSupported(g.textureSize))return console.log("max texture size: "+g.maxTextureSize),new g.WebglFilterBackend({tileSize:g.textureSize});if(g.Canvas2dFilterBackend)return new g.Canvas2dFilterBackend},typeof document<"u"&&typeof window<"u"&&(window.fabric=g),function(){function Tt(jt,Ft){if(this.__eventListeners[jt]){var Gt=this.__eventListeners[jt];Ft?Gt[Gt.indexOf(Ft)]=!1:g.util.array.fill(Gt,!1)}}function Ct(jt,Ft){if(this.__eventListeners||(this.__eventListeners={}),arguments.length===1)for(var Gt in jt)this.on(Gt,jt[Gt]);else this.__eventListeners[jt]||(this.__eventListeners[jt]=[]),this.__eventListeners[jt].push(Ft);return this}function pt(jt,Ft){var Gt=(function(){Ft.apply(this,arguments),this.off(jt,Gt)}).bind(this);this.on(jt,Gt)}function wt(jt,Ft){if(arguments.length===1)for(var Gt in jt)pt.call(this,Gt,jt[Gt]);else pt.call(this,jt,Ft);return this}function $t(jt,Ft){if(!this.__eventListeners)return this;if(arguments.length===0)for(jt in this.__eventListeners)Tt.call(this,jt);else if(arguments.length===1&&typeof arguments[0]=="object")for(var Gt in jt)Tt.call(this,Gt,jt[Gt]);else Tt.call(this,jt,Ft);return this}function Lt(jt,Ft){if(!this.__eventListeners)return this;var Gt=this.__eventListeners[jt];if(!Gt)return this;for(var Ht=0,qt=Gt.length;Ht<qt;Ht++)Gt[Ht]&&Gt[Ht].call(this,Ft||{});return this.__eventListeners[jt]=Gt.filter(function(Kt){return Kt!==!1}),this}g.Observable={fire:Lt,on:Ct,once:wt,off:$t}}(),g.Collection={_objects:[],add:function(){if(this._objects.push.apply(this._objects,arguments),this._onObjectAdded)for(var Tt=0,Ct=arguments.length;Tt<Ct;Tt++)this._onObjectAdded(arguments[Tt]);return this.renderOnAddRemove&&this.requestRenderAll(),this},insertAt:function(Tt,Ct,pt){var wt=this._objects;return pt?wt[Ct]=Tt:wt.splice(Ct,0,Tt),this._onObjectAdded&&this._onObjectAdded(Tt),this.renderOnAddRemove&&this.requestRenderAll(),this},remove:function(){for(var Tt=this._objects,Ct,pt=!1,wt=0,$t=arguments.length;wt<$t;wt++)Ct=Tt.indexOf(arguments[wt]),Ct!==-1&&(pt=!0,Tt.splice(Ct,1),this._onObjectRemoved&&this._onObjectRemoved(arguments[wt]));return this.renderOnAddRemove&&pt&&this.requestRenderAll(),this},forEachObject:function(Tt,Ct){for(var pt=this.getObjects(),wt=0,$t=pt.length;wt<$t;wt++)Tt.call(Ct,pt[wt],wt,pt);return this},getObjects:function(Tt){return typeof Tt>"u"?this._objects.concat():this._objects.filter(function(Ct){return Ct.type===Tt})},item:function(Tt){return this._objects[Tt]},isEmpty:function(){return this._objects.length===0},size:function(){return this._objects.length},contains:function(Tt,Ct){return this._objects.indexOf(Tt)>-1?!0:Ct?this._objects.some(function(pt){return typeof pt.contains=="function"&&pt.contains(Tt,!0)}):!1},complexity:function(){return this._objects.reduce(function(Tt,Ct){return Tt+=Ct.complexity?Ct.complexity():0,Tt},0)}},g.CommonMethods={_setOptions:function(Tt){for(var Ct in Tt)this.set(Ct,Tt[Ct])},_initGradient:function(Tt,Ct){Tt&&Tt.colorStops&&!(Tt instanceof g.Gradient)&&this.set(Ct,new g.Gradient(Tt))},_initPattern:function(Tt,Ct,pt){Tt&&Tt.source&&!(Tt instanceof g.Pattern)?this.set(Ct,new g.Pattern(Tt,pt)):pt&&pt()},_setObject:function(Tt){for(var Ct in Tt)this._set(Ct,Tt[Ct])},set:function(Tt,Ct){return typeof Tt=="object"?this._setObject(Tt):this._set(Tt,Ct),this},_set:function(Tt,Ct){this[Tt]=Ct},toggle:function(Tt){var Ct=this.get(Tt);return typeof Ct=="boolean"&&this.set(Tt,!Ct),this},get:function(Tt){return this[Tt]}},function(Tt){var Ct=Math.sqrt,pt=Math.atan2,wt=Math.pow,$t=Math.PI/180,Lt=Math.PI/2;g.util={cos:function(jt){if(jt===0)return 1;jt<0&&(jt=-jt);var Ft=jt/Lt;switch(Ft){case 1:case 3:return 0;case 2:return-1}return Math.cos(jt)},sin:function(jt){if(jt===0)return 0;var Ft=jt/Lt,Gt=1;switch(jt<0&&(Gt=-1),Ft){case 1:return Gt;case 2:return 0;case 3:return-Gt}return Math.sin(jt)},removeFromArray:function(jt,Ft){var Gt=jt.indexOf(Ft);return Gt!==-1&&jt.splice(Gt,1),jt},getRandomInt:function(jt,Ft){return Math.floor(Math.random()*(Ft-jt+1))+jt},degreesToRadians:function(jt){return jt*$t},radiansToDegrees:function(jt){return jt/$t},rotatePoint:function(jt,Ft,Gt){var Ht=new g.Point(jt.x-Ft.x,jt.y-Ft.y),qt=g.util.rotateVector(Ht,Gt);return new g.Point(qt.x,qt.y).addEquals(Ft)},rotateVector:function(jt,Ft){var Gt=g.util.sin(Ft),Ht=g.util.cos(Ft),qt=jt.x*Ht-jt.y*Gt,Kt=jt.x*Gt+jt.y*Ht;return{x:qt,y:Kt}},createVector:function(jt,Ft){return new g.Point(Ft.x-jt.x,Ft.y-jt.y)},calcAngleBetweenVectors:function(jt,Ft){return Math.acos((jt.x*Ft.x+jt.y*Ft.y)/(Math.hypot(jt.x,jt.y)*Math.hypot(Ft.x,Ft.y)))},getHatVector:function(jt){return new g.Point(jt.x,jt.y).multiply(1/Math.hypot(jt.x,jt.y))},getBisector:function(jt,Ft,Gt){var Ht=g.util.createVector(jt,Ft),qt=g.util.createVector(jt,Gt),Kt=g.util.calcAngleBetweenVectors(Ht,qt),rr=g.util.calcAngleBetweenVectors(g.util.rotateVector(Ht,Kt),qt),ir=Kt*(rr===0?1:-1)/2;return{vector:g.util.getHatVector(g.util.rotateVector(Ht,ir)),angle:Kt}},projectStrokeOnPoints:function(jt,Ft,Gt){var Ht=[],qt=Ft.strokeWidth/2,Kt=Ft.strokeUniform?new g.Point(1/Ft.scaleX,1/Ft.scaleY):new g.Point(1,1),rr=function(ir){var or=qt/Math.hypot(ir.x,ir.y);return new g.Point(ir.x*or*Kt.x,ir.y*or*Kt.y)};return jt.length<=1||jt.forEach(function(ir,or){var jr=new g.Point(ir.x,ir.y),qr,Yr;or===0?(Yr=jt[or+1],qr=Gt?rr(g.util.createVector(Yr,jr)).addEquals(jr):jt[jt.length-1]):or===jt.length-1?(qr=jt[or-1],Yr=Gt?rr(g.util.createVector(qr,jr)).addEquals(jr):jt[0]):(qr=jt[or-1],Yr=jt[or+1]);var vn=g.util.getBisector(jr,qr,Yr),ko=vn.vector,Xo=vn.angle,zo,t0;if(Ft.strokeLineJoin==="miter"&&(zo=-qt/Math.sin(Xo/2),t0=new g.Point(ko.x*zo*Kt.x,ko.y*zo*Kt.y),Math.hypot(t0.x,t0.y)/qt<=Ft.strokeMiterLimit)){Ht.push(jr.add(t0)),Ht.push(jr.subtract(t0));return}zo=-qt*Math.SQRT2,t0=new g.Point(ko.x*zo*Kt.x,ko.y*zo*Kt.y),Ht.push(jr.add(t0)),Ht.push(jr.subtract(t0))}),Ht},transformPoint:function(jt,Ft,Gt){return Gt?new g.Point(Ft[0]*jt.x+Ft[2]*jt.y,Ft[1]*jt.x+Ft[3]*jt.y):new g.Point(Ft[0]*jt.x+Ft[2]*jt.y+Ft[4],Ft[1]*jt.x+Ft[3]*jt.y+Ft[5])},makeBoundingBoxFromPoints:function(jt,Ft){if(Ft)for(var Gt=0;Gt<jt.length;Gt++)jt[Gt]=g.util.transformPoint(jt[Gt],Ft);var Ht=[jt[0].x,jt[1].x,jt[2].x,jt[3].x],qt=g.util.array.min(Ht),Kt=g.util.array.max(Ht),rr=Kt-qt,ir=[jt[0].y,jt[1].y,jt[2].y,jt[3].y],or=g.util.array.min(ir),jr=g.util.array.max(ir),qr=jr-or;return{left:qt,top:or,width:rr,height:qr}},invertTransform:function(jt){var Ft=1/(jt[0]*jt[3]-jt[1]*jt[2]),Gt=[Ft*jt[3],-Ft*jt[1],-Ft*jt[2],Ft*jt[0]],Ht=g.util.transformPoint({x:jt[4],y:jt[5]},Gt,!0);return Gt[4]=-Ht.x,Gt[5]=-Ht.y,Gt},toFixed:function(jt,Ft){return parseFloat(Number(jt).toFixed(Ft))},parseUnit:function(jt,Ft){var Gt=/\D{0,2}$/.exec(jt),Ht=parseFloat(jt);switch(Ft||(Ft=g.Text.DEFAULT_SVG_FONT_SIZE),Gt[0]){case"mm":return Ht*g.DPI/25.4;case"cm":return Ht*g.DPI/2.54;case"in":return Ht*g.DPI;case"pt":return Ht*g.DPI/72;case"pc":return Ht*g.DPI/72*12;case"em":return Ht*Ft;default:return Ht}},falseFunction:function(){return!1},getKlass:function(jt,Ft){return jt=g.util.string.camelize(jt.charAt(0).toUpperCase()+jt.slice(1)),g.util.resolveNamespace(Ft)[jt]},getSvgAttributes:function(jt){var Ft=["instantiated_by_use","style","id","class"];switch(jt){case"linearGradient":Ft=Ft.concat(["x1","y1","x2","y2","gradientUnits","gradientTransform"]);break;case"radialGradient":Ft=Ft.concat(["gradientUnits","gradientTransform","cx","cy","r","fx","fy","fr"]);break;case"stop":Ft=Ft.concat(["offset","stop-color","stop-opacity"]);break}return Ft},resolveNamespace:function(jt){if(!jt)return g;var Ft=jt.split("."),Gt=Ft.length,Ht,qt=Tt||g.window;for(Ht=0;Ht<Gt;++Ht)qt=qt[Ft[Ht]];return qt},loadImage:function(jt,Ft,Gt,Ht){if(!jt){Ft&&Ft.call(Gt,jt);return}var qt=g.util.createImage(),Kt=function(){Ft&&Ft.call(Gt,qt,!1),qt=qt.onload=qt.onerror=null};qt.onload=Kt,qt.onerror=function(){g.log("Error loading "+qt.src),Ft&&Ft.call(Gt,null,!0),qt=qt.onload=qt.onerror=null},jt.indexOf("data")!==0&&Ht!==void 0&&Ht!==null&&(qt.crossOrigin=Ht),jt.substring(0,14)==="data:image/svg"&&(qt.onload=null,g.util.loadImageInDom(qt,Kt)),qt.src=jt},loadImageInDom:function(jt,Ft){var Gt=g.document.createElement("div");Gt.style.width=Gt.style.height="1px",Gt.style.left=Gt.style.top="-100%",Gt.style.position="absolute",Gt.appendChild(jt),g.document.querySelector("body").appendChild(Gt),jt.onload=function(){Ft(),Gt.parentNode.removeChild(Gt),Gt=null}},enlivenObjects:function(jt,Ft,Gt,Ht){jt=jt||[];var qt=[],Kt=0,rr=jt.length;function ir(){++Kt===rr&&Ft&&Ft(qt.filter(function(or){return or}))}if(!rr){Ft&&Ft(qt);return}jt.forEach(function(or,jr){if(!or||!or.type){ir();return}var qr=g.util.getKlass(or.type,Gt);qr.fromObject(or,function(Yr,vn){vn||(qt[jr]=Yr),Ht&&Ht(or,Yr,vn),ir()})})},enlivenObjectEnlivables:function(jt,Ft,Gt){var Ht=g.Object.ENLIVEN_PROPS.filter(function(qt){return!!jt[qt]});g.util.enlivenObjects(Ht.map(function(qt){return jt[qt]}),function(qt){var Kt={};Ht.forEach(function(rr,ir){Kt[rr]=qt[ir],Ft&&(Ft[rr]=qt[ir])}),Gt&&Gt(Kt)})},enlivenPatterns:function(jt,Ft){jt=jt||[];function Gt(){++qt===Kt&&Ft&&Ft(Ht)}var Ht=[],qt=0,Kt=jt.length;if(!Kt){Ft&&Ft(Ht);return}jt.forEach(function(rr,ir){rr&&rr.source?new g.Pattern(rr,function(or){Ht[ir]=or,Gt()}):(Ht[ir]=rr,Gt())})},groupSVGElements:function(jt,Ft,Gt){var Ht;return jt&&jt.length===1?(typeof Gt<"u"&&(jt[0].sourcePath=Gt),jt[0]):(Ft&&(Ft.width&&Ft.height?Ft.centerPoint={x:Ft.width/2,y:Ft.height/2}:(delete Ft.width,delete Ft.height)),Ht=new g.Group(jt,Ft),typeof Gt<"u"&&(Ht.sourcePath=Gt),Ht)},populateWithProperties:function(jt,Ft,Gt){if(Gt&&Array.isArray(Gt))for(var Ht=0,qt=Gt.length;Ht<qt;Ht++)Gt[Ht]in jt&&(Ft[Gt[Ht]]=jt[Gt[Ht]])},createCanvasElement:function(){return g.document.createElement("canvas")},copyCanvasElement:function(jt){var Ft=g.util.createCanvasElement();return Ft.width=jt.width,Ft.height=jt.height,Ft.getContext("2d").drawImage(jt,0,0),Ft},toDataURL:function(jt,Ft,Gt){return jt.toDataURL("image/"+Ft,Gt)},createImage:function(){return g.document.createElement("img")},multiplyTransformMatrices:function(jt,Ft,Gt){return[jt[0]*Ft[0]+jt[2]*Ft[1],jt[1]*Ft[0]+jt[3]*Ft[1],jt[0]*Ft[2]+jt[2]*Ft[3],jt[1]*Ft[2]+jt[3]*Ft[3],Gt?0:jt[0]*Ft[4]+jt[2]*Ft[5]+jt[4],Gt?0:jt[1]*Ft[4]+jt[3]*Ft[5]+jt[5]]},qrDecompose:function(jt){var Ft=pt(jt[1],jt[0]),Gt=wt(jt[0],2)+wt(jt[1],2),Ht=Ct(Gt),qt=(jt[0]*jt[3]-jt[2]*jt[1])/Ht,Kt=pt(jt[0]*jt[2]+jt[1]*jt[3],Gt);return{angle:Ft/$t,scaleX:Ht,scaleY:qt,skewX:Kt/$t,skewY:0,translateX:jt[4],translateY:jt[5]}},calcRotateMatrix:function(jt){if(!jt.angle)return g.iMatrix.concat();var Ft=g.util.degreesToRadians(jt.angle),Gt=g.util.cos(Ft),Ht=g.util.sin(Ft);return[Gt,Ht,-Ht,Gt,0,0]},calcDimensionsMatrix:function(jt){var Ft=typeof jt.scaleX>"u"?1:jt.scaleX,Gt=typeof jt.scaleY>"u"?1:jt.scaleY,Ht=[jt.flipX?-Ft:Ft,0,0,jt.flipY?-Gt:Gt,0,0],qt=g.util.multiplyTransformMatrices,Kt=g.util.degreesToRadians;return jt.skewX&&(Ht=qt(Ht,[1,0,Math.tan(Kt(jt.skewX)),1],!0)),jt.skewY&&(Ht=qt(Ht,[1,Math.tan(Kt(jt.skewY)),0,1],!0)),Ht},composeMatrix:function(jt){var Ft=[1,0,0,1,jt.translateX||0,jt.translateY||0],Gt=g.util.multiplyTransformMatrices;return jt.angle&&(Ft=Gt(Ft,g.util.calcRotateMatrix(jt))),(jt.scaleX!==1||jt.scaleY!==1||jt.skewX||jt.skewY||jt.flipX||jt.flipY)&&(Ft=Gt(Ft,g.util.calcDimensionsMatrix(jt))),Ft},resetObjectTransform:function(jt){jt.scaleX=1,jt.scaleY=1,jt.skewX=0,jt.skewY=0,jt.flipX=!1,jt.flipY=!1,jt.rotate(0)},saveObjectTransform:function(jt){return{scaleX:jt.scaleX,scaleY:jt.scaleY,skewX:jt.skewX,skewY:jt.skewY,angle:jt.angle,left:jt.left,flipX:jt.flipX,flipY:jt.flipY,top:jt.top}},isTransparent:function(jt,Ft,Gt,Ht){Ht>0&&(Ft>Ht?Ft-=Ht:Ft=0,Gt>Ht?Gt-=Ht:Gt=0);var qt=!0,Kt,rr,ir=jt.getImageData(Ft,Gt,Ht*2||1,Ht*2||1),or=ir.data.length;for(Kt=3;Kt<or&&(rr=ir.data[Kt],qt=rr<=0,qt!==!1);Kt+=4);return ir=null,qt},parsePreserveAspectRatioAttribute:function(jt){var Ft="meet",Gt="Mid",Ht="Mid",qt=jt.split(" "),Kt;return qt&&qt.length&&(Ft=qt.pop(),Ft!=="meet"&&Ft!=="slice"?(Kt=Ft,Ft="meet"):qt.length&&(Kt=qt.pop())),Gt=Kt!=="none"?Kt.slice(1,4):"none",Ht=Kt!=="none"?Kt.slice(5,8):"none",{meetOrSlice:Ft,alignX:Gt,alignY:Ht}},clearFabricFontCache:function(jt){jt=(jt||"").toLowerCase(),jt?g.charWidthsCache[jt]&&delete g.charWidthsCache[jt]:g.charWidthsCache={}},limitDimsByArea:function(jt,Ft){var Gt=Math.sqrt(Ft*jt),Ht=Math.floor(Ft/Gt);return{x:Math.floor(Gt),y:Ht}},capValue:function(jt,Ft,Gt){return Math.max(jt,Math.min(Ft,Gt))},findScaleToFit:function(jt,Ft){return Math.min(Ft.width/jt.width,Ft.height/jt.height)},findScaleToCover:function(jt,Ft){return Math.max(Ft.width/jt.width,Ft.height/jt.height)},matrixToSVG:function(jt){return"matrix("+jt.map(function(Ft){return g.util.toFixed(Ft,g.Object.NUM_FRACTION_DIGITS)}).join(" ")+")"},removeTransformFromObject:function(jt,Ft){var Gt=g.util.invertTransform(Ft),Ht=g.util.multiplyTransformMatrices(Gt,jt.calcOwnMatrix());g.util.applyTransformToObject(jt,Ht)},addTransformToObject:function(jt,Ft){g.util.applyTransformToObject(jt,g.util.multiplyTransformMatrices(Ft,jt.calcOwnMatrix()))},applyTransformToObject:function(jt,Ft){var Gt=g.util.qrDecompose(Ft),Ht=new g.Point(Gt.translateX,Gt.translateY);jt.flipX=!1,jt.flipY=!1,jt.set("scaleX",Gt.scaleX),jt.set("scaleY",Gt.scaleY),jt.skewX=Gt.skewX,jt.skewY=Gt.skewY,jt.angle=Gt.angle,jt.setPositionByOrigin(Ht,"center","center")},sizeAfterTransform:function(jt,Ft,Gt){var Ht=jt/2,qt=Ft/2,Kt=[{x:-Ht,y:-qt},{x:Ht,y:-qt},{x:-Ht,y:qt},{x:Ht,y:qt}],rr=g.util.calcDimensionsMatrix(Gt),ir=g.util.makeBoundingBoxFromPoints(Kt,rr);return{x:ir.width,y:ir.height}},mergeClipPaths:function(jt,Ft){var Gt=jt,Ht=Ft;Gt.inverted&&!Ht.inverted&&(Gt=Ft,Ht=jt),g.util.applyTransformToObject(Ht,g.util.multiplyTransformMatrices(g.util.invertTransform(Gt.calcTransformMatrix()),Ht.calcTransformMatrix()));var qt=Gt.inverted&&Ht.inverted;return qt&&(Gt.inverted=Ht.inverted=!1),new g.Group([Gt],{clipPath:Ht,inverted:qt})},hasStyleChanged:function(jt,Ft,Gt){return Gt=Gt||!1,jt.fill!==Ft.fill||jt.stroke!==Ft.stroke||jt.strokeWidth!==Ft.strokeWidth||jt.fontSize!==Ft.fontSize||jt.fontFamily!==Ft.fontFamily||jt.fontWeight!==Ft.fontWeight||jt.fontStyle!==Ft.fontStyle||jt.textBackgroundColor!==Ft.textBackgroundColor||jt.deltaY!==Ft.deltaY||Gt&&(jt.overline!==Ft.overline||jt.underline!==Ft.underline||jt.linethrough!==Ft.linethrough)},stylesToArray:function(Gt,Ft){for(var Gt=g.util.object.clone(Gt,!0),Ht=Ft.split(`
`),qt=-1,Kt={},rr=[],ir=0;ir<Ht.length;ir++){if(!Gt[ir]){qt+=Ht[ir].length;continue}for(var or=0;or<Ht[ir].length;or++){qt++;var jr=Gt[ir][or];if(jr&&Object.keys(jr).length>0){var qr=g.util.hasStyleChanged(Kt,jr,!0);qr?rr.push({start:qt,end:qt+1,style:jr}):rr[rr.length-1].end++}Kt=jr||{}}}return rr},stylesFromArray:function(jt,Ft){if(!Array.isArray(jt))return jt;for(var Gt=Ft.split(`
`),Ht=-1,qt=0,Kt={},rr=0;rr<Gt.length;rr++)for(var ir=0;ir<Gt[rr].length;ir++)Ht++,jt[qt]&&jt[qt].start<=Ht&&Ht<jt[qt].end&&(Kt[rr]=Kt[rr]||{},Kt[rr][ir]=Object.assign({},jt[qt].style),Ht===jt[qt].end-1&&qt++);return Kt}}}(d),function(){var Tt=Array.prototype.join,Ct={m:2,l:2,h:1,v:1,c:6,s:4,q:4,t:2,a:7},pt={m:"l",M:"L"};function wt(Zr,Ro,Sn,Tn,n0,Go,An,a0,u0,d0,f0){var y0=g.util.cos(Zr),b0=g.util.sin(Zr),O0=g.util.cos(Ro),C0=g.util.sin(Ro),v0=Sn*n0*O0-Tn*Go*C0+An,k0=Tn*n0*O0+Sn*Go*C0+a0,N0=d0+u0*(-Sn*n0*b0-Tn*Go*y0),w0=f0+u0*(-Tn*n0*b0+Sn*Go*y0),r0=v0+u0*(Sn*n0*C0+Tn*Go*O0),p0=k0+u0*(Tn*n0*C0-Sn*Go*O0);return["C",N0,w0,r0,p0,v0,k0]}function $t(Zr,Ro,Sn,Tn,n0,Go,An){var a0=Math.PI,u0=An*a0/180,d0=g.util.sin(u0),f0=g.util.cos(u0),y0=0,b0=0;Sn=Math.abs(Sn),Tn=Math.abs(Tn);var O0=-f0*Zr*.5-d0*Ro*.5,C0=-f0*Ro*.5+d0*Zr*.5,v0=Sn*Sn,k0=Tn*Tn,N0=C0*C0,w0=O0*O0,r0=v0*k0-v0*N0-k0*w0,p0=0;if(r0<0){var $0=Math.sqrt(1-r0/(v0*k0));Sn*=$0,Tn*=$0}else p0=(n0===Go?-1:1)*Math.sqrt(r0/(v0*N0+k0*w0));var A0=p0*Sn*C0/Tn,g0=-p0*Tn*O0/Sn,E0=f0*A0-d0*g0+Zr*.5,F0=d0*A0+f0*g0+Ro*.5,K0=Lt(1,0,(O0-A0)/Sn,(C0-g0)/Tn),l1=Lt((O0-A0)/Sn,(C0-g0)/Tn,(-O0-A0)/Sn,(-C0-g0)/Tn);Go===0&&l1>0?l1-=2*a0:Go===1&&l1<0&&(l1+=2*a0);for(var n1=Math.ceil(Math.abs(l1/a0*2)),x1=[],u1=l1/n1,P1=8/3*Math.sin(u1/4)*Math.sin(u1/4)/Math.sin(u1/2),i1=K0+u1,v1=0;v1<n1;v1++)x1[v1]=wt(K0,i1,f0,d0,Sn,Tn,E0,F0,P1,y0,b0),y0=x1[v1][5],b0=x1[v1][6],K0=i1,i1+=u1;return x1}function Lt(Zr,Ro,Sn,Tn){var n0=Math.atan2(Ro,Zr),Go=Math.atan2(Tn,Sn);return Go>=n0?Go-n0:2*Math.PI-(n0-Go)}function jt(Zr,Ro,Sn,Tn,n0,Go,An,a0){var u0;if(g.cachesBoundsOfCurve&&(u0=Tt.call(arguments),g.boundsOfCurveCache[u0]))return g.boundsOfCurveCache[u0];var d0=Math.sqrt,f0=Math.min,y0=Math.max,b0=Math.abs,O0=[],C0=[[],[]],v0,k0,N0,w0,r0,p0,$0,A0;k0=6*Zr-12*Sn+6*n0,v0=-3*Zr+9*Sn-9*n0+3*An,N0=3*Sn-3*Zr;for(var g0=0;g0<2;++g0){if(g0>0&&(k0=6*Ro-12*Tn+6*Go,v0=-3*Ro+9*Tn-9*Go+3*a0,N0=3*Tn-3*Ro),b0(v0)<1e-12){if(b0(k0)<1e-12)continue;w0=-N0/k0,0<w0&&w0<1&&O0.push(w0);continue}$0=k0*k0-4*N0*v0,!($0<0)&&(A0=d0($0),r0=(-k0+A0)/(2*v0),0<r0&&r0<1&&O0.push(r0),p0=(-k0-A0)/(2*v0),0<p0&&p0<1&&O0.push(p0))}for(var E0,F0,K0=O0.length,l1=K0,n1;K0--;)w0=O0[K0],n1=1-w0,E0=n1*n1*n1*Zr+3*n1*n1*w0*Sn+3*n1*w0*w0*n0+w0*w0*w0*An,C0[0][K0]=E0,F0=n1*n1*n1*Ro+3*n1*n1*w0*Tn+3*n1*w0*w0*Go+w0*w0*w0*a0,C0[1][K0]=F0;C0[0][l1]=Zr,C0[1][l1]=Ro,C0[0][l1+1]=An,C0[1][l1+1]=a0;var x1=[{x:f0.apply(null,C0[0]),y:f0.apply(null,C0[1])},{x:y0.apply(null,C0[0]),y:y0.apply(null,C0[1])}];return g.cachesBoundsOfCurve&&(g.boundsOfCurveCache[u0]=x1),x1}function Ft(Zr,Ro,Sn){for(var Tn=Sn[1],n0=Sn[2],Go=Sn[3],An=Sn[4],a0=Sn[5],u0=Sn[6],d0=Sn[7],f0=$t(u0-Zr,d0-Ro,Tn,n0,An,a0,Go),y0=0,b0=f0.length;y0<b0;y0++)f0[y0][1]+=Zr,f0[y0][2]+=Ro,f0[y0][3]+=Zr,f0[y0][4]+=Ro,f0[y0][5]+=Zr,f0[y0][6]+=Ro;return f0}function Gt(Zr){var Ro=0,Sn=0,Tn=Zr.length,n0=0,Go=0,An,a0,u0,d0=[],f0,y0,b0;for(a0=0;a0<Tn;++a0){switch(u0=!1,An=Zr[a0].slice(0),An[0]){case"l":An[0]="L",An[1]+=Ro,An[2]+=Sn;case"L":Ro=An[1],Sn=An[2];break;case"h":An[1]+=Ro;case"H":An[0]="L",An[2]=Sn,Ro=An[1];break;case"v":An[1]+=Sn;case"V":An[0]="L",Sn=An[1],An[1]=Ro,An[2]=Sn;break;case"m":An[0]="M",An[1]+=Ro,An[2]+=Sn;case"M":Ro=An[1],Sn=An[2],n0=An[1],Go=An[2];break;case"c":An[0]="C",An[1]+=Ro,An[2]+=Sn,An[3]+=Ro,An[4]+=Sn,An[5]+=Ro,An[6]+=Sn;case"C":y0=An[3],b0=An[4],Ro=An[5],Sn=An[6];break;case"s":An[0]="S",An[1]+=Ro,An[2]+=Sn,An[3]+=Ro,An[4]+=Sn;case"S":f0==="C"?(y0=2*Ro-y0,b0=2*Sn-b0):(y0=Ro,b0=Sn),Ro=An[3],Sn=An[4],An[0]="C",An[5]=An[3],An[6]=An[4],An[3]=An[1],An[4]=An[2],An[1]=y0,An[2]=b0,y0=An[3],b0=An[4];break;case"q":An[0]="Q",An[1]+=Ro,An[2]+=Sn,An[3]+=Ro,An[4]+=Sn;case"Q":y0=An[1],b0=An[2],Ro=An[3],Sn=An[4];break;case"t":An[0]="T",An[1]+=Ro,An[2]+=Sn;case"T":f0==="Q"?(y0=2*Ro-y0,b0=2*Sn-b0):(y0=Ro,b0=Sn),An[0]="Q",Ro=An[1],Sn=An[2],An[1]=y0,An[2]=b0,An[3]=Ro,An[4]=Sn;break;case"a":An[0]="A",An[6]+=Ro,An[7]+=Sn;case"A":u0=!0,d0=d0.concat(Ft(Ro,Sn,An)),Ro=An[6],Sn=An[7];break;case"z":case"Z":Ro=n0,Sn=Go;break}u0||d0.push(An),f0=An[0]}return d0}function Ht(Zr,Ro,Sn,Tn){return Math.sqrt((Sn-Zr)*(Sn-Zr)+(Tn-Ro)*(Tn-Ro))}function qt(Zr){return Zr*Zr*Zr}function Kt(Zr){return 3*Zr*Zr*(1-Zr)}function rr(Zr){return 3*Zr*(1-Zr)*(1-Zr)}function ir(Zr){return(1-Zr)*(1-Zr)*(1-Zr)}function or(Zr,Ro,Sn,Tn,n0,Go,An,a0){return function(u0){var d0=qt(u0),f0=Kt(u0),y0=rr(u0),b0=ir(u0);return{x:An*d0+n0*f0+Sn*y0+Zr*b0,y:a0*d0+Go*f0+Tn*y0+Ro*b0}}}function jr(Zr,Ro,Sn,Tn,n0,Go,An,a0){return function(u0){var d0=1-u0,f0=3*d0*d0*(Sn-Zr)+6*d0*u0*(n0-Sn)+3*u0*u0*(An-n0),y0=3*d0*d0*(Tn-Ro)+6*d0*u0*(Go-Tn)+3*u0*u0*(a0-Go);return Math.atan2(y0,f0)}}function qr(Zr){return Zr*Zr}function Yr(Zr){return 2*Zr*(1-Zr)}function vn(Zr){return(1-Zr)*(1-Zr)}function ko(Zr,Ro,Sn,Tn,n0,Go){return function(An){var a0=qr(An),u0=Yr(An),d0=vn(An);return{x:n0*a0+Sn*u0+Zr*d0,y:Go*a0+Tn*u0+Ro*d0}}}function Xo(Zr,Ro,Sn,Tn,n0,Go){return function(An){var a0=1-An,u0=2*a0*(Sn-Zr)+2*An*(n0-Sn),d0=2*a0*(Tn-Ro)+2*An*(Go-Tn);return Math.atan2(d0,u0)}}function zo(Zr,Ro,Sn){var Tn={x:Ro,y:Sn},n0,Go=0,An;for(An=1;An<=100;An+=1)n0=Zr(An/100),Go+=Ht(Tn.x,Tn.y,n0.x,n0.y),Tn=n0;return Go}function t0(Zr,Ro){for(var Sn=0,Tn=0,n0=Zr.iterator,Go={x:Zr.x,y:Zr.y},An,a0,u0=.01,d0=Zr.angleFinder,f0;Tn<Ro&&u0>1e-4;)An=n0(Sn),f0=Sn,a0=Ht(Go.x,Go.y,An.x,An.y),a0+Tn>Ro?(Sn-=u0,u0/=2):(Go=An,Sn+=u0,Tn+=a0);return An.angle=d0(f0),An}function Uo(Zr){for(var Ro=0,Sn=Zr.length,Tn,n0=0,Go=0,An=0,a0=0,u0=[],d0,f0,y0,b0=0;b0<Sn;b0++){switch(Tn=Zr[b0],f0={x:n0,y:Go,command:Tn[0]},Tn[0]){case"M":f0.length=0,An=n0=Tn[1],a0=Go=Tn[2];break;case"L":f0.length=Ht(n0,Go,Tn[1],Tn[2]),n0=Tn[1],Go=Tn[2];break;case"C":d0=or(n0,Go,Tn[1],Tn[2],Tn[3],Tn[4],Tn[5],Tn[6]),y0=jr(n0,Go,Tn[1],Tn[2],Tn[3],Tn[4],Tn[5],Tn[6]),f0.iterator=d0,f0.angleFinder=y0,f0.length=zo(d0,n0,Go),n0=Tn[5],Go=Tn[6];break;case"Q":d0=ko(n0,Go,Tn[1],Tn[2],Tn[3],Tn[4]),y0=Xo(n0,Go,Tn[1],Tn[2],Tn[3],Tn[4]),f0.iterator=d0,f0.angleFinder=y0,f0.length=zo(d0,n0,Go),n0=Tn[3],Go=Tn[4];break;case"Z":case"z":f0.destX=An,f0.destY=a0,f0.length=Ht(n0,Go,An,a0),n0=An,Go=a0;break}Ro+=f0.length,u0.push(f0)}return u0.push({length:Ro,x:n0,y:Go}),u0}function No(Zr,Ro,Sn){Sn||(Sn=Uo(Zr));for(var Tn=0;Ro-Sn[Tn].length>0&&Tn<Sn.length-2;)Ro-=Sn[Tn].length,Tn++;var n0=Sn[Tn],Go=Ro/n0.length,An=n0.command,a0=Zr[Tn],u0;switch(An){case"M":return{x:n0.x,y:n0.y,angle:0};case"Z":case"z":return u0=new g.Point(n0.x,n0.y).lerp(new g.Point(n0.destX,n0.destY),Go),u0.angle=Math.atan2(n0.destY-n0.y,n0.destX-n0.x),u0;case"L":return u0=new g.Point(n0.x,n0.y).lerp(new g.Point(a0[1],a0[2]),Go),u0.angle=Math.atan2(a0[2]-n0.y,a0[1]-n0.x),u0;case"C":return t0(n0,Ro);case"Q":return t0(n0,Ro)}}function _n(Zr){var Ro=[],Sn=[],Tn,n0,Go=g.rePathCommand,An="[-+]?(?:\\d*\\.\\d+|\\d+\\.?)(?:[eE][-+]?\\d+)?\\s*",a0="("+An+")"+g.commaWsp,u0="([01])"+g.commaWsp+"?",d0=a0+"?"+a0+"?"+a0+u0+u0+a0+"?("+An+")",f0=new RegExp(d0,"g"),y0,b0,O0;if(!Zr||!Zr.match)return Ro;O0=Zr.match(/[mzlhvcsqta][^mzlhvcsqta]*/gi);for(var C0=0,v0,k0=O0.length;C0<k0;C0++){Tn=O0[C0],b0=Tn.slice(1).trim(),Sn.length=0;var N0=Tn.charAt(0);if(v0=[N0],N0.toLowerCase()==="a")for(var w0;w0=f0.exec(b0);)for(var r0=1;r0<w0.length;r0++)Sn.push(w0[r0]);else for(;y0=Go.exec(b0);)Sn.push(y0[0]);for(var r0=0,p0=Sn.length;r0<p0;r0++)n0=parseFloat(Sn[r0]),isNaN(n0)||v0.push(n0);var $0=Ct[N0.toLowerCase()],A0=pt[N0]||N0;if(v0.length-1>$0)for(var g0=1,E0=v0.length;g0<E0;g0+=$0)Ro.push([N0].concat(v0.slice(g0,g0+$0))),N0=A0;else Ro.push(v0)}return Ro}function Kr(Zr,Ro){var Sn=[],Tn,n0=new g.Point(Zr[0].x,Zr[0].y),Go=new g.Point(Zr[1].x,Zr[1].y),An=Zr.length,a0=1,u0=0,d0=An>2;for(Ro=Ro||0,d0&&(a0=Zr[2].x<Go.x?-1:Zr[2].x===Go.x?0:1,u0=Zr[2].y<Go.y?-1:Zr[2].y===Go.y?0:1),Sn.push(["M",n0.x-a0*Ro,n0.y-u0*Ro]),Tn=1;Tn<An;Tn++){if(!n0.eq(Go)){var f0=n0.midPointFrom(Go);Sn.push(["Q",n0.x,n0.y,f0.x,f0.y])}n0=Zr[Tn],Tn+1<Zr.length&&(Go=Zr[Tn+1])}return d0&&(a0=n0.x>Zr[Tn-2].x?1:n0.x===Zr[Tn-2].x?0:-1,u0=n0.y>Zr[Tn-2].y?1:n0.y===Zr[Tn-2].y?0:-1),Sn.push(["L",n0.x+a0*Ro,n0.y+u0*Ro]),Sn}function e0(Zr,Ro,Sn){return Sn&&(Ro=g.util.multiplyTransformMatrices(Ro,[1,0,0,1,-Sn.x,-Sn.y])),Zr.map(function(Tn){for(var n0=Tn.slice(0),Go={},An=1;An<Tn.length-1;An+=2)Go.x=Tn[An],Go.y=Tn[An+1],Go=g.util.transformPoint(Go,Ro),n0[An]=Go.x,n0[An+1]=Go.y;return n0})}g.util.joinPath=function(Zr){return Zr.map(function(Ro){return Ro.join(" ")}).join(" ")},g.util.parsePath=_n,g.util.makePathSimpler=Gt,g.util.getSmoothPathFromPoints=Kr,g.util.getPathSegmentsInfo=Uo,g.util.getBoundsOfCurve=jt,g.util.getPointOnPath=No,g.util.transformPath=e0}(),function(){var Tt=Array.prototype.slice;function Ct(jt,Ft){for(var Gt=Tt.call(arguments,2),Ht=[],qt=0,Kt=jt.length;qt<Kt;qt++)Ht[qt]=Gt.length?jt[qt][Ft].apply(jt[qt],Gt):jt[qt][Ft].call(jt[qt]);return Ht}function pt(jt,Ft){return Lt(jt,Ft,function(Gt,Ht){return Gt>=Ht})}function wt(jt,Ft){return Lt(jt,Ft,function(Gt,Ht){return Gt<Ht})}function $t(jt,Ft){for(var Gt=jt.length;Gt--;)jt[Gt]=Ft;return jt}function Lt(jt,Ft,Gt){if(!(!jt||jt.length===0)){var Ht=jt.length-1,qt=Ft?jt[Ht][Ft]:jt[Ht];if(Ft)for(;Ht--;)Gt(jt[Ht][Ft],qt)&&(qt=jt[Ht][Ft]);else for(;Ht--;)Gt(jt[Ht],qt)&&(qt=jt[Ht]);return qt}}g.util.array={fill:$t,invoke:Ct,min:wt,max:pt}}(),function(){function Tt(pt,wt,$t){if($t)if(!g.isLikelyNode&&wt instanceof Element)pt=wt;else if(wt instanceof Array){pt=[];for(var Lt=0,jt=wt.length;Lt<jt;Lt++)pt[Lt]=Tt({},wt[Lt],$t)}else if(wt&&typeof wt=="object")for(var Ft in wt)Ft==="canvas"||Ft==="group"?pt[Ft]=null:wt.hasOwnProperty(Ft)&&(pt[Ft]=Tt({},wt[Ft],$t));else pt=wt;else for(var Ft in wt)pt[Ft]=wt[Ft];return pt}function Ct(pt,wt){return Tt({},pt,wt)}g.util.object={extend:Tt,clone:Ct},g.util.object.extend(g.util,g.Observable)}(),function(){function Tt(Lt){return Lt.replace(/-+(.)?/g,function(jt,Ft){return Ft?Ft.toUpperCase():""})}function Ct(Lt,jt){return Lt.charAt(0).toUpperCase()+(jt?Lt.slice(1):Lt.slice(1).toLowerCase())}function pt(Lt){return Lt.replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/'/g,"&apos;").replace(/</g,"&lt;").replace(/>/g,"&gt;")}function wt(Lt){var jt=0,Ft,Gt=[];for(jt=0,Ft;jt<Lt.length;jt++)(Ft=$t(Lt,jt))!==!1&&Gt.push(Ft);return Gt}function $t(Lt,jt){var Ft=Lt.charCodeAt(jt);if(isNaN(Ft))return"";if(Ft<55296||Ft>57343)return Lt.charAt(jt);if(55296<=Ft&&Ft<=56319){if(Lt.length<=jt+1)throw"High surrogate without following low surrogate";var Gt=Lt.charCodeAt(jt+1);if(56320>Gt||Gt>57343)throw"High surrogate without following low surrogate";return Lt.charAt(jt)+Lt.charAt(jt+1)}if(jt===0)throw"Low surrogate without preceding high surrogate";var Ht=Lt.charCodeAt(jt-1);if(55296>Ht||Ht>56319)throw"Low surrogate without preceding high surrogate";return!1}g.util.string={camelize:Tt,capitalize:Ct,escapeXml:pt,graphemeSplit:wt}}(),function(){var Tt=Array.prototype.slice,Ct=function(){},pt=function(){for(var Ft in{toString:1})if(Ft==="toString")return!1;return!0}(),wt=function(Ft,Gt,Ht){for(var qt in Gt)qt in Ft.prototype&&typeof Ft.prototype[qt]=="function"&&(Gt[qt]+"").indexOf("callSuper")>-1?Ft.prototype[qt]=function(Kt){return function(){var rr=this.constructor.superclass;this.constructor.superclass=Ht;var ir=Gt[Kt].apply(this,arguments);if(this.constructor.superclass=rr,Kt!=="initialize")return ir}}(qt):Ft.prototype[qt]=Gt[qt],pt&&(Gt.toString!==Object.prototype.toString&&(Ft.prototype.toString=Gt.toString),Gt.valueOf!==Object.prototype.valueOf&&(Ft.prototype.valueOf=Gt.valueOf))};function $t(){}function Lt(Ft){for(var Gt=null,Ht=this;Ht.constructor.superclass;){var qt=Ht.constructor.superclass.prototype[Ft];if(Ht[Ft]!==qt){Gt=qt;break}Ht=Ht.constructor.superclass.prototype}return Gt?arguments.length>1?Gt.apply(this,Tt.call(arguments,1)):Gt.call(this):console.log("tried to callSuper "+Ft+", method not found in prototype chain",this)}function jt(){var Ft=null,Gt=Tt.call(arguments,0);typeof Gt[0]=="function"&&(Ft=Gt.shift());function Ht(){this.initialize.apply(this,arguments)}Ht.superclass=Ft,Ht.subclasses=[],Ft&&($t.prototype=Ft.prototype,Ht.prototype=new $t,Ft.subclasses.push(Ht));for(var qt=0,Kt=Gt.length;qt<Kt;qt++)wt(Ht,Gt[qt],Ft);return Ht.prototype.initialize||(Ht.prototype.initialize=Ct),Ht.prototype.constructor=Ht,Ht.prototype.callSuper=Lt,Ht}g.util.createClass=jt}(),function(){var Tt=!!g.document.createElement("div").attachEvent,Ct=["touchstart","touchmove","touchend"];g.util.addListener=function(wt,$t,Lt,jt){wt&&wt.addEventListener($t,Lt,Tt?!1:jt)},g.util.removeListener=function(wt,$t,Lt,jt){wt&&wt.removeEventListener($t,Lt,Tt?!1:jt)};function pt(wt){var $t=wt.changedTouches;return $t&&$t[0]?$t[0]:wt}g.util.getPointer=function(wt){var $t=wt.target,Lt=g.util.getScrollLeftTop($t),jt=pt(wt);return{x:jt.clientX+Lt.left,y:jt.clientY+Lt.top}},g.util.isTouchEvent=function(wt){return Ct.indexOf(wt.type)>-1||wt.pointerType==="touch"}}(),function(){function Tt(jt,Ft){var Gt=jt.style;if(!Gt)return jt;if(typeof Ft=="string")return jt.style.cssText+=";"+Ft,Ft.indexOf("opacity")>-1?Lt(jt,Ft.match(/opacity:\s*(\d?\.?\d*)/)[1]):jt;for(var Ht in Ft)if(Ht==="opacity")Lt(jt,Ft[Ht]);else{var qt=Ht==="float"||Ht==="cssFloat"?typeof Gt.styleFloat>"u"?"cssFloat":"styleFloat":Ht;Gt.setProperty(qt,Ft[Ht])}return jt}var Ct=g.document.createElement("div"),pt=typeof Ct.style.opacity=="string",wt=typeof Ct.style.filter=="string",$t=/alpha\s*\(\s*opacity\s*=\s*([^\)]+)\)/,Lt=function(jt){return jt};pt?Lt=function(jt,Ft){return jt.style.opacity=Ft,jt}:wt&&(Lt=function(jt,Ft){var Gt=jt.style;return jt.currentStyle&&!jt.currentStyle.hasLayout&&(Gt.zoom=1),$t.test(Gt.filter)?(Ft=Ft>=.9999?"":"alpha(opacity="+Ft*100+")",Gt.filter=Gt.filter.replace($t,Ft)):Gt.filter+=" alpha(opacity="+Ft*100+")",jt}),g.util.setStyle=Tt}(),function(){var Tt=Array.prototype.slice;function Ct(ir){return typeof ir=="string"?g.document.getElementById(ir):ir}var pt,wt=function(ir){return Tt.call(ir,0)};try{pt=wt(g.document.childNodes)instanceof Array}catch{}pt||(wt=function(ir){for(var or=new Array(ir.length),jr=ir.length;jr--;)or[jr]=ir[jr];return or});function $t(ir,or){var jr=g.document.createElement(ir);for(var qr in or)qr==="class"?jr.className=or[qr]:qr==="for"?jr.htmlFor=or[qr]:jr.setAttribute(qr,or[qr]);return jr}function Lt(ir,or){ir&&(" "+ir.className+" ").indexOf(" "+or+" ")===-1&&(ir.className+=(ir.className?" ":"")+or)}function jt(ir,or,jr){return typeof or=="string"&&(or=$t(or,jr)),ir.parentNode&&ir.parentNode.replaceChild(or,ir),or.appendChild(ir),or}function Ft(ir){for(var or=0,jr=0,qr=g.document.documentElement,Yr=g.document.body||{scrollLeft:0,scrollTop:0};ir&&(ir.parentNode||ir.host)&&(ir=ir.parentNode||ir.host,ir===g.document?(or=Yr.scrollLeft||qr.scrollLeft||0,jr=Yr.scrollTop||qr.scrollTop||0):(or+=ir.scrollLeft||0,jr+=ir.scrollTop||0),!(ir.nodeType===1&&ir.style.position==="fixed")););return{left:or,top:jr}}function Gt(ir){var or,jr=ir&&ir.ownerDocument,qr={left:0,top:0},Yr={left:0,top:0},vn,ko={borderLeftWidth:"left",borderTopWidth:"top",paddingLeft:"left",paddingTop:"top"};if(!jr)return Yr;for(var Xo in ko)Yr[ko[Xo]]+=parseInt(Ht(ir,Xo),10)||0;return or=jr.documentElement,typeof ir.getBoundingClientRect<"u"&&(qr=ir.getBoundingClientRect()),vn=Ft(ir),{left:qr.left+vn.left-(or.clientLeft||0)+Yr.left,top:qr.top+vn.top-(or.clientTop||0)+Yr.top}}var Ht;g.document.defaultView&&g.document.defaultView.getComputedStyle?Ht=function(ir,or){var jr=g.document.defaultView.getComputedStyle(ir,null);return jr?jr[or]:void 0}:Ht=function(ir,or){var jr=ir.style[or];return!jr&&ir.currentStyle&&(jr=ir.currentStyle[or]),jr},function(){var ir=g.document.documentElement.style,or="userSelect"in ir?"userSelect":"MozUserSelect"in ir?"MozUserSelect":"WebkitUserSelect"in ir?"WebkitUserSelect":"KhtmlUserSelect"in ir?"KhtmlUserSelect":"";function jr(Yr){return typeof Yr.onselectstart<"u"&&(Yr.onselectstart=g.util.falseFunction),or?Yr.style[or]="none":typeof Yr.unselectable=="string"&&(Yr.unselectable="on"),Yr}function qr(Yr){return typeof Yr.onselectstart<"u"&&(Yr.onselectstart=null),or?Yr.style[or]="":typeof Yr.unselectable=="string"&&(Yr.unselectable=""),Yr}g.util.makeElementUnselectable=jr,g.util.makeElementSelectable=qr}();function qt(ir){var or=g.jsdomImplForWrapper(ir);return or._canvas||or._image}function Kt(ir){if(g.isLikelyNode){var or=g.jsdomImplForWrapper(ir);or&&(or._image=null,or._canvas=null,or._currentSrc=null,or._attributes=null,or._classList=null)}}function rr(ir,or){ir.imageSmoothingEnabled=ir.imageSmoothingEnabled||ir.webkitImageSmoothingEnabled||ir.mozImageSmoothingEnabled||ir.msImageSmoothingEnabled||ir.oImageSmoothingEnabled,ir.imageSmoothingEnabled=or}g.util.setImageSmoothing=rr,g.util.getById=Ct,g.util.toArray=wt,g.util.addClass=Lt,g.util.makeElement=$t,g.util.wrapElement=jt,g.util.getScrollLeftTop=Ft,g.util.getElementOffset=Gt,g.util.getNodeCanvas=qt,g.util.cleanUpJsdomNode=Kt}(),function(){function Tt(wt,$t){return wt+(/\?/.test(wt)?"&":"?")+$t}function Ct(){}function pt(wt,$t){$t||($t={});var Lt=$t.method?$t.method.toUpperCase():"GET",jt=$t.onComplete||function(){},Ft=new g.window.XMLHttpRequest,Gt=$t.body||$t.parameters;return Ft.onreadystatechange=function(){Ft.readyState===4&&(jt(Ft),Ft.onreadystatechange=Ct)},Lt==="GET"&&(Gt=null,typeof $t.parameters=="string"&&(wt=Tt(wt,$t.parameters))),Ft.open(Lt,wt,!0),(Lt==="POST"||Lt==="PUT")&&Ft.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),Ft.send(Gt),Ft}g.util.request=pt}(),g.log=console.log,g.warn=console.warn,function(){var Tt=g.util.object.extend,Ct=g.util.object.clone,pt=[];g.util.object.extend(pt,{cancelAll:function(){var qt=this.splice(0);return qt.forEach(function(Kt){Kt.cancel()}),qt},cancelByCanvas:function(qt){if(!qt)return[];var Kt=this.filter(function(rr){return typeof rr.target=="object"&&rr.target.canvas===qt});return Kt.forEach(function(rr){rr.cancel()}),Kt},cancelByTarget:function(qt){var Kt=this.findAnimationsByTarget(qt);return Kt.forEach(function(rr){rr.cancel()}),Kt},findAnimationIndex:function(qt){return this.indexOf(this.findAnimation(qt))},findAnimation:function(qt){return this.find(function(Kt){return Kt.cancel===qt})},findAnimationsByTarget:function(qt){return qt?this.filter(function(Kt){return Kt.target===qt}):[]}});function wt(){return!1}function $t(qt,Kt,rr,ir){return-rr*Math.cos(qt/ir*(Math.PI/2))+rr+Kt}function Lt(qt){qt||(qt={});var Kt=!1,rr,ir=function(){var or=g.runningAnimations.indexOf(rr);return or>-1&&g.runningAnimations.splice(or,1)[0]};return rr=Tt(Ct(qt),{cancel:function(){return Kt=!0,ir()},currentValue:"startValue"in qt?qt.startValue:0,completionRate:0,durationRate:0}),g.runningAnimations.push(rr),Gt(function(or){var jr=or||+new Date,qr=qt.duration||500,Yr=jr+qr,vn,ko=qt.onChange||wt,Xo=qt.abort||wt,zo=qt.onComplete||wt,t0=qt.easing||$t,Uo="startValue"in qt?qt.startValue.length>0:!1,No="startValue"in qt?qt.startValue:0,_n="endValue"in qt?qt.endValue:100,Kr=qt.byValue||(Uo?No.map(function(e0,Zr){return _n[Zr]-No[Zr]}):_n-No);qt.onStart&&qt.onStart(),function e0(Zr){vn=Zr||+new Date;var Ro=vn>Yr?qr:vn-jr,Sn=Ro/qr,Tn=Uo?No.map(function(Go,An){return t0(Ro,No[An],Kr[An],qr)}):t0(Ro,No,Kr,qr),n0=Math.abs(Uo?(Tn[0]-No[0])/Kr[0]:(Tn-No)/Kr);if(rr.currentValue=Uo?Tn.slice():Tn,rr.completionRate=n0,rr.durationRate=Sn,!Kt){if(Xo(Tn,n0,Sn)){ir();return}if(vn>Yr){rr.currentValue=Uo?_n.slice():_n,rr.completionRate=1,rr.durationRate=1,ko(Uo?_n.slice():_n,1,1),zo(_n,1,1),ir();return}else ko(Tn,n0,Sn),Gt(e0)}}(jr)}),rr.cancel}var jt=g.window.requestAnimationFrame||g.window.webkitRequestAnimationFrame||g.window.mozRequestAnimationFrame||g.window.oRequestAnimationFrame||g.window.msRequestAnimationFrame||function(qt){return g.window.setTimeout(qt,1e3/60)},Ft=g.window.cancelAnimationFrame||g.window.clearTimeout;function Gt(){return jt.apply(g.window,arguments)}function Ht(){return Ft.apply(g.window,arguments)}g.util.animate=Lt,g.util.requestAnimFrame=Gt,g.util.cancelAnimFrame=Ht,g.runningAnimations=pt}(),function(){function Tt(pt,wt,$t){var Lt="rgba("+parseInt(pt[0]+$t*(wt[0]-pt[0]),10)+","+parseInt(pt[1]+$t*(wt[1]-pt[1]),10)+","+parseInt(pt[2]+$t*(wt[2]-pt[2]),10);return Lt+=","+(pt&&wt?parseFloat(pt[3]+$t*(wt[3]-pt[3])):1),Lt+=")",Lt}function Ct(pt,wt,$t,Lt){var jt=new g.Color(pt).getSource(),Ft=new g.Color(wt).getSource(),Gt=Lt.onComplete,Ht=Lt.onChange;return Lt=Lt||{},g.util.animate(g.util.object.extend(Lt,{duration:$t||500,startValue:jt,endValue:Ft,byValue:Ft,easing:function(qt,Kt,rr,ir){var or=Lt.colorEasing?Lt.colorEasing(qt,ir):1-Math.cos(qt/ir*(Math.PI/2));return Tt(Kt,rr,or)},onComplete:function(qt,Kt,rr){if(Gt)return Gt(Tt(Ft,Ft,0),Kt,rr)},onChange:function(qt,Kt,rr){if(Ht){if(Array.isArray(qt))return Ht(Tt(qt,qt,0),Kt,rr);Ht(qt,Kt,rr)}}}))}g.util.animateColor=Ct}(),function(){function Tt(Zr,Ro,Sn,Tn){return Zr<Math.abs(Ro)?(Zr=Ro,Tn=Sn/4):Ro===0&&Zr===0?Tn=Sn/(2*Math.PI)*Math.asin(1):Tn=Sn/(2*Math.PI)*Math.asin(Ro/Zr),{a:Zr,c:Ro,p:Sn,s:Tn}}function Ct(Zr,Ro,Sn){return Zr.a*Math.pow(2,10*(Ro-=1))*Math.sin((Ro*Sn-Zr.s)*(2*Math.PI)/Zr.p)}function pt(Zr,Ro,Sn,Tn){return Sn*((Zr=Zr/Tn-1)*Zr*Zr+1)+Ro}function wt(Zr,Ro,Sn,Tn){return Zr/=Tn/2,Zr<1?Sn/2*Zr*Zr*Zr+Ro:Sn/2*((Zr-=2)*Zr*Zr+2)+Ro}function $t(Zr,Ro,Sn,Tn){return Sn*(Zr/=Tn)*Zr*Zr*Zr+Ro}function Lt(Zr,Ro,Sn,Tn){return-Sn*((Zr=Zr/Tn-1)*Zr*Zr*Zr-1)+Ro}function jt(Zr,Ro,Sn,Tn){return Zr/=Tn/2,Zr<1?Sn/2*Zr*Zr*Zr*Zr+Ro:-Sn/2*((Zr-=2)*Zr*Zr*Zr-2)+Ro}function Ft(Zr,Ro,Sn,Tn){return Sn*(Zr/=Tn)*Zr*Zr*Zr*Zr+Ro}function Gt(Zr,Ro,Sn,Tn){return Sn*((Zr=Zr/Tn-1)*Zr*Zr*Zr*Zr+1)+Ro}function Ht(Zr,Ro,Sn,Tn){return Zr/=Tn/2,Zr<1?Sn/2*Zr*Zr*Zr*Zr*Zr+Ro:Sn/2*((Zr-=2)*Zr*Zr*Zr*Zr+2)+Ro}function qt(Zr,Ro,Sn,Tn){return-Sn*Math.cos(Zr/Tn*(Math.PI/2))+Sn+Ro}function Kt(Zr,Ro,Sn,Tn){return Sn*Math.sin(Zr/Tn*(Math.PI/2))+Ro}function rr(Zr,Ro,Sn,Tn){return-Sn/2*(Math.cos(Math.PI*Zr/Tn)-1)+Ro}function ir(Zr,Ro,Sn,Tn){return Zr===0?Ro:Sn*Math.pow(2,10*(Zr/Tn-1))+Ro}function or(Zr,Ro,Sn,Tn){return Zr===Tn?Ro+Sn:Sn*(-Math.pow(2,-10*Zr/Tn)+1)+Ro}function jr(Zr,Ro,Sn,Tn){return Zr===0?Ro:Zr===Tn?Ro+Sn:(Zr/=Tn/2,Zr<1?Sn/2*Math.pow(2,10*(Zr-1))+Ro:Sn/2*(-Math.pow(2,-10*--Zr)+2)+Ro)}function qr(Zr,Ro,Sn,Tn){return-Sn*(Math.sqrt(1-(Zr/=Tn)*Zr)-1)+Ro}function Yr(Zr,Ro,Sn,Tn){return Sn*Math.sqrt(1-(Zr=Zr/Tn-1)*Zr)+Ro}function vn(Zr,Ro,Sn,Tn){return Zr/=Tn/2,Zr<1?-Sn/2*(Math.sqrt(1-Zr*Zr)-1)+Ro:Sn/2*(Math.sqrt(1-(Zr-=2)*Zr)+1)+Ro}function ko(Zr,Ro,Sn,Tn){var n0=1.70158,Go=0,An=Sn;if(Zr===0)return Ro;if(Zr/=Tn,Zr===1)return Ro+Sn;Go||(Go=Tn*.3);var a0=Tt(An,Sn,Go,n0);return-Ct(a0,Zr,Tn)+Ro}function Xo(Zr,Ro,Sn,Tn){var n0=1.70158,Go=0,An=Sn;if(Zr===0)return Ro;if(Zr/=Tn,Zr===1)return Ro+Sn;Go||(Go=Tn*.3);var a0=Tt(An,Sn,Go,n0);return a0.a*Math.pow(2,-10*Zr)*Math.sin((Zr*Tn-a0.s)*(2*Math.PI)/a0.p)+a0.c+Ro}function zo(Zr,Ro,Sn,Tn){var n0=1.70158,Go=0,An=Sn;if(Zr===0)return Ro;if(Zr/=Tn/2,Zr===2)return Ro+Sn;Go||(Go=Tn*(.3*1.5));var a0=Tt(An,Sn,Go,n0);return Zr<1?-.5*Ct(a0,Zr,Tn)+Ro:a0.a*Math.pow(2,-10*(Zr-=1))*Math.sin((Zr*Tn-a0.s)*(2*Math.PI)/a0.p)*.5+a0.c+Ro}function t0(Zr,Ro,Sn,Tn,n0){return n0===void 0&&(n0=1.70158),Sn*(Zr/=Tn)*Zr*((n0+1)*Zr-n0)+Ro}function Uo(Zr,Ro,Sn,Tn,n0){return n0===void 0&&(n0=1.70158),Sn*((Zr=Zr/Tn-1)*Zr*((n0+1)*Zr+n0)+1)+Ro}function No(Zr,Ro,Sn,Tn,n0){return n0===void 0&&(n0=1.70158),Zr/=Tn/2,Zr<1?Sn/2*(Zr*Zr*(((n0*=1.525)+1)*Zr-n0))+Ro:Sn/2*((Zr-=2)*Zr*(((n0*=1.525)+1)*Zr+n0)+2)+Ro}function _n(Zr,Ro,Sn,Tn){return Sn-Kr(Tn-Zr,0,Sn,Tn)+Ro}function Kr(Zr,Ro,Sn,Tn){return(Zr/=Tn)<1/2.75?Sn*(7.5625*Zr*Zr)+Ro:Zr<2/2.75?Sn*(7.5625*(Zr-=1.5/2.75)*Zr+.75)+Ro:Zr<2.5/2.75?Sn*(7.5625*(Zr-=2.25/2.75)*Zr+.9375)+Ro:Sn*(7.5625*(Zr-=2.625/2.75)*Zr+.984375)+Ro}function e0(Zr,Ro,Sn,Tn){return Zr<Tn/2?_n(Zr*2,0,Sn,Tn)*.5+Ro:Kr(Zr*2-Tn,0,Sn,Tn)*.5+Sn*.5+Ro}g.util.ease={easeInQuad:function(Zr,Ro,Sn,Tn){return Sn*(Zr/=Tn)*Zr+Ro},easeOutQuad:function(Zr,Ro,Sn,Tn){return-Sn*(Zr/=Tn)*(Zr-2)+Ro},easeInOutQuad:function(Zr,Ro,Sn,Tn){return Zr/=Tn/2,Zr<1?Sn/2*Zr*Zr+Ro:-Sn/2*(--Zr*(Zr-2)-1)+Ro},easeInCubic:function(Zr,Ro,Sn,Tn){return Sn*(Zr/=Tn)*Zr*Zr+Ro},easeOutCubic:pt,easeInOutCubic:wt,easeInQuart:$t,easeOutQuart:Lt,easeInOutQuart:jt,easeInQuint:Ft,easeOutQuint:Gt,easeInOutQuint:Ht,easeInSine:qt,easeOutSine:Kt,easeInOutSine:rr,easeInExpo:ir,easeOutExpo:or,easeInOutExpo:jr,easeInCirc:qr,easeOutCirc:Yr,easeInOutCirc:vn,easeInElastic:ko,easeOutElastic:Xo,easeInOutElastic:zo,easeInBack:t0,easeOutBack:Uo,easeInOutBack:No,easeInBounce:_n,easeOutBounce:Kr,easeInOutBounce:e0}}(),function(Tt){var Ct=Tt.fabric||(Tt.fabric={}),pt=Ct.util.object.extend,wt=Ct.util.object.clone,$t=Ct.util.toFixed,Lt=Ct.util.parseUnit,jt=Ct.util.multiplyTransformMatrices,Ft=["path","circle","polygon","polyline","ellipse","rect","line","image","text"],Gt=["symbol","image","marker","pattern","view","svg"],Ht=["pattern","defs","symbol","metadata","clipPath","mask","desc"],qt=["symbol","g","a","svg","clipPath","defs"],Kt={cx:"left",x:"left",r:"radius",cy:"top",y:"top",display:"visible",visibility:"visible",transform:"transformMatrix","fill-opacity":"fillOpacity","fill-rule":"fillRule","font-family":"fontFamily","font-size":"fontSize","font-style":"fontStyle","font-weight":"fontWeight","letter-spacing":"charSpacing","paint-order":"paintFirst","stroke-dasharray":"strokeDashArray","stroke-dashoffset":"strokeDashOffset","stroke-linecap":"strokeLineCap","stroke-linejoin":"strokeLineJoin","stroke-miterlimit":"strokeMiterLimit","stroke-opacity":"strokeOpacity","stroke-width":"strokeWidth","text-decoration":"textDecoration","text-anchor":"textAnchor",opacity:"opacity","clip-path":"clipPath","clip-rule":"clipRule","vector-effect":"strokeUniform","image-rendering":"imageSmoothing"},rr={stroke:"strokeOpacity",fill:"fillOpacity"},ir="font-size",or="clip-path";Ct.svgValidTagNamesRegEx=Yr(Ft),Ct.svgViewBoxElementsRegEx=Yr(Gt),Ct.svgInvalidAncestorsRegEx=Yr(Ht),Ct.svgValidParentsRegEx=Yr(qt),Ct.cssRules={},Ct.gradientDefs={},Ct.clipPaths={};function jr(Go){return Go in Kt?Kt[Go]:Go}function qr(Go,An,a0,u0){var d0=Array.isArray(An),f0;if((Go==="fill"||Go==="stroke")&&An==="none")An="";else{if(Go==="strokeUniform")return An==="non-scaling-stroke";if(Go==="strokeDashArray")An==="none"?An=null:An=An.replace(/,/g," ").split(/\s+/).map(parseFloat);else if(Go==="transformMatrix")a0&&a0.transformMatrix?An=jt(a0.transformMatrix,Ct.parseTransformAttribute(An)):An=Ct.parseTransformAttribute(An);else if(Go==="visible")An=An!=="none"&&An!=="hidden",a0&&a0.visible===!1&&(An=!1);else if(Go==="opacity")An=parseFloat(An),a0&&typeof a0.opacity<"u"&&(An*=a0.opacity);else if(Go==="textAnchor")An=An==="start"?"left":An==="end"?"right":"center";else if(Go==="charSpacing")f0=Lt(An,u0)/u0*1e3;else if(Go==="paintFirst"){var y0=An.indexOf("fill"),b0=An.indexOf("stroke"),An="fill";(y0>-1&&b0>-1&&b0<y0||y0===-1&&b0>-1)&&(An="stroke")}else{if(Go==="href"||Go==="xlink:href"||Go==="font")return An;if(Go==="imageSmoothing")return An==="optimizeQuality";f0=d0?An.map(Lt):Lt(An,u0)}}return!d0&&isNaN(f0)?An:f0}function Yr(Go){return new RegExp("^("+Go.join("|")+")\\b","i")}function vn(Go){for(var An in rr)if(!(typeof Go[rr[An]]>"u"||Go[An]==="")){if(typeof Go[An]>"u"){if(!Ct.Object.prototype[An])continue;Go[An]=Ct.Object.prototype[An]}if(Go[An].indexOf("url(")!==0){var a0=new Ct.Color(Go[An]);Go[An]=a0.setAlpha($t(a0.getAlpha()*Go[rr[An]],2)).toRgba()}}return Go}function ko(Go,An){var a0,u0=[],d0,f0,y0;for(f0=0,y0=An.length;f0<y0;f0++)a0=An[f0],d0=Go.getElementsByTagName(a0),u0=u0.concat(Array.prototype.slice.call(d0));return u0}Ct.parseTransformAttribute=function(){function Go(g0,E0){var F0=Ct.util.cos(E0[0]),K0=Ct.util.sin(E0[0]),l1=0,n1=0;E0.length===3&&(l1=E0[1],n1=E0[2]),g0[0]=F0,g0[1]=K0,g0[2]=-K0,g0[3]=F0,g0[4]=l1-(F0*l1-K0*n1),g0[5]=n1-(K0*l1+F0*n1)}function An(g0,E0){var F0=E0[0],K0=E0.length===2?E0[1]:E0[0];g0[0]=F0,g0[3]=K0}function a0(g0,E0,F0){g0[F0]=Math.tan(Ct.util.degreesToRadians(E0[0]))}function u0(g0,E0){g0[4]=E0[0],E0.length===2&&(g0[5]=E0[1])}var d0=Ct.iMatrix,f0=Ct.reNum,y0=Ct.commaWsp,b0="(?:(skewX)\\s*\\(\\s*("+f0+")\\s*\\))",O0="(?:(skewY)\\s*\\(\\s*("+f0+")\\s*\\))",C0="(?:(rotate)\\s*\\(\\s*("+f0+")(?:"+y0+"("+f0+")"+y0+"("+f0+"))?\\s*\\))",v0="(?:(scale)\\s*\\(\\s*("+f0+")(?:"+y0+"("+f0+"))?\\s*\\))",k0="(?:(translate)\\s*\\(\\s*("+f0+")(?:"+y0+"("+f0+"))?\\s*\\))",N0="(?:(matrix)\\s*\\(\\s*("+f0+")"+y0+"("+f0+")"+y0+"("+f0+")"+y0+"("+f0+")"+y0+"("+f0+")"+y0+"("+f0+")\\s*\\))",w0="(?:"+N0+"|"+k0+"|"+v0+"|"+C0+"|"+b0+"|"+O0+")",r0="(?:"+w0+"(?:"+y0+"*"+w0+")*)",p0="^\\s*(?:"+r0+"?)\\s*$",$0=new RegExp(p0),A0=new RegExp(w0,"g");return function(g0){var E0=d0.concat(),F0=[];if(!g0||g0&&!$0.test(g0))return E0;g0.replace(A0,function(l1){var n1=new RegExp(w0).exec(l1).filter(function(P1){return!!P1}),x1=n1[1],u1=n1.slice(2).map(parseFloat);switch(x1){case"translate":u0(E0,u1);break;case"rotate":u1[0]=Ct.util.degreesToRadians(u1[0]),Go(E0,u1);break;case"scale":An(E0,u1);break;case"skewX":a0(E0,u1,2);break;case"skewY":a0(E0,u1,1);break;case"matrix":E0=u1;break}F0.push(E0.concat()),E0=d0.concat()});for(var K0=F0[0];F0.length>1;)F0.shift(),K0=Ct.util.multiplyTransformMatrices(K0,F0[0]);return K0}}();function Xo(Go,An){var a0,u0;Go.replace(/;\s*$/,"").split(";").forEach(function(d0){var f0=d0.split(":");a0=f0[0].trim().toLowerCase(),u0=f0[1].trim(),An[a0]=u0})}function zo(Go,An){var a0,u0;for(var d0 in Go)typeof Go[d0]>"u"||(a0=d0.toLowerCase(),u0=Go[d0],An[a0]=u0)}function t0(Go,An){var a0={};for(var u0 in Ct.cssRules[An])if(Uo(Go,u0.split(" ")))for(var d0 in Ct.cssRules[An][u0])a0[d0]=Ct.cssRules[An][u0][d0];return a0}function Uo(Go,An){var a0,u0=!0;return a0=_n(Go,An.pop()),a0&&An.length&&(u0=No(Go,An)),a0&&u0&&An.length===0}function No(Go,An){for(var a0,u0=!0;Go.parentNode&&Go.parentNode.nodeType===1&&An.length;)u0&&(a0=An.pop()),Go=Go.parentNode,u0=_n(Go,a0);return An.length===0}function _n(Go,An){var a0=Go.nodeName,u0=Go.getAttribute("class"),d0=Go.getAttribute("id"),f0,y0;if(f0=new RegExp("^"+a0,"i"),An=An.replace(f0,""),d0&&An.length&&(f0=new RegExp("#"+d0+"(?![a-zA-Z\\-]+)","i"),An=An.replace(f0,"")),u0&&An.length)for(u0=u0.split(" "),y0=u0.length;y0--;)f0=new RegExp("\\."+u0[y0]+"(?![a-zA-Z\\-]+)","i"),An=An.replace(f0,"");return An.length===0}function Kr(Go,An){var a0;if(Go.getElementById&&(a0=Go.getElementById(An)),a0)return a0;var u0,d0,f0,y0=Go.getElementsByTagName("*");for(d0=0,f0=y0.length;d0<f0;d0++)if(u0=y0[d0],An===u0.getAttribute("id"))return u0}function e0(Go){for(var An=ko(Go,["use","svg:use"]),a0=0;An.length&&a0<An.length;){var u0=An[a0],d0=u0.getAttribute("xlink:href")||u0.getAttribute("href");if(d0===null)return;var f0=d0.slice(1),y0=u0.getAttribute("x")||0,b0=u0.getAttribute("y")||0,O0=Kr(Go,f0).cloneNode(!0),C0=(O0.getAttribute("transform")||"")+" translate("+y0+", "+b0+")",v0,k0=An.length,N0,w0,r0,p0,$0=Ct.svgNS;if(Ro(O0),/^svg$/i.test(O0.nodeName)){var A0=O0.ownerDocument.createElementNS($0,"g");for(w0=0,r0=O0.attributes,p0=r0.length;w0<p0;w0++)N0=r0.item(w0),A0.setAttributeNS($0,N0.nodeName,N0.nodeValue);for(;O0.firstChild;)A0.appendChild(O0.firstChild);O0=A0}for(w0=0,r0=u0.attributes,p0=r0.length;w0<p0;w0++)N0=r0.item(w0),!(N0.nodeName==="x"||N0.nodeName==="y"||N0.nodeName==="xlink:href"||N0.nodeName==="href")&&(N0.nodeName==="transform"?C0=N0.nodeValue+" "+C0:O0.setAttribute(N0.nodeName,N0.nodeValue));O0.setAttribute("transform",C0),O0.setAttribute("instantiated_by_use","1"),O0.removeAttribute("id"),v0=u0.parentNode,v0.replaceChild(O0,u0),An.length===k0&&a0++}}var Zr=new RegExp("^\\s*("+Ct.reNum+"+)\\s*,?\\s*("+Ct.reNum+"+)\\s*,?\\s*("+Ct.reNum+"+)\\s*,?\\s*("+Ct.reNum+"+)\\s*$");function Ro(Go){if(!Ct.svgViewBoxElementsRegEx.test(Go.nodeName))return{};var An=Go.getAttribute("viewBox"),a0=1,u0=1,d0=0,f0=0,y0,b0,O0,C0,v0=Go.getAttribute("width"),k0=Go.getAttribute("height"),N0=Go.getAttribute("x")||0,w0=Go.getAttribute("y")||0,r0=Go.getAttribute("preserveAspectRatio")||"",p0=!An||!(An=An.match(Zr)),$0=!v0||!k0||v0==="100%"||k0==="100%",A0=p0&&$0,g0={},E0="",F0=0,K0=0;if(g0.width=0,g0.height=0,g0.toBeParsed=A0,p0&&(N0||w0)&&Go.parentNode&&Go.parentNode.nodeName!=="#document"&&(E0=" translate("+Lt(N0)+" "+Lt(w0)+") ",O0=(Go.getAttribute("transform")||"")+E0,Go.setAttribute("transform",O0),Go.removeAttribute("x"),Go.removeAttribute("y")),A0)return g0;if(p0)return g0.width=Lt(v0),g0.height=Lt(k0),g0;if(d0=-parseFloat(An[1]),f0=-parseFloat(An[2]),y0=parseFloat(An[3]),b0=parseFloat(An[4]),g0.minX=d0,g0.minY=f0,g0.viewBoxWidth=y0,g0.viewBoxHeight=b0,$0?(g0.width=y0,g0.height=b0):(g0.width=Lt(v0),g0.height=Lt(k0),a0=g0.width/y0,u0=g0.height/b0),r0=Ct.util.parsePreserveAspectRatioAttribute(r0),r0.alignX!=="none"&&(r0.meetOrSlice==="meet"&&(u0=a0=a0>u0?u0:a0),r0.meetOrSlice==="slice"&&(u0=a0=a0>u0?a0:u0),F0=g0.width-y0*a0,K0=g0.height-b0*a0,r0.alignX==="Mid"&&(F0/=2),r0.alignY==="Mid"&&(K0/=2),r0.alignX==="Min"&&(F0=0),r0.alignY==="Min"&&(K0=0)),a0===1&&u0===1&&d0===0&&f0===0&&N0===0&&w0===0)return g0;if((N0||w0)&&Go.parentNode.nodeName!=="#document"&&(E0=" translate("+Lt(N0)+" "+Lt(w0)+") "),O0=E0+" matrix("+a0+" 0 0 "+u0+" "+(d0*a0+F0)+" "+(f0*u0+K0)+") ",Go.nodeName==="svg"){for(C0=Go.ownerDocument.createElementNS(Ct.svgNS,"g");Go.firstChild;)C0.appendChild(Go.firstChild);Go.appendChild(C0)}else C0=Go,C0.removeAttribute("x"),C0.removeAttribute("y"),O0=C0.getAttribute("transform")+O0;return C0.setAttribute("transform",O0),g0}function Sn(Go,An){for(;Go&&(Go=Go.parentNode);)if(Go.nodeName&&An.test(Go.nodeName.replace("svg:",""))&&!Go.getAttribute("instantiated_by_use"))return!0;return!1}Ct.parseSVGDocument=function(Go,An,a0,u0){if(Go){e0(Go);var d0=Ct.Object.__uid++,f0,y0,b0=Ro(Go),O0=Ct.util.toArray(Go.getElementsByTagName("*"));if(b0.crossOrigin=u0&&u0.crossOrigin,b0.svgUid=d0,O0.length===0&&Ct.isLikelyNode){O0=Go.selectNodes('//*[name(.)!="svg"]');var C0=[];for(f0=0,y0=O0.length;f0<y0;f0++)C0[f0]=O0[f0];O0=C0}var v0=O0.filter(function(N0){return Ro(N0),Ct.svgValidTagNamesRegEx.test(N0.nodeName.replace("svg:",""))&&!Sn(N0,Ct.svgInvalidAncestorsRegEx)});if(!v0||v0&&!v0.length){An&&An([],{});return}var k0={};O0.filter(function(N0){return N0.nodeName.replace("svg:","")==="clipPath"}).forEach(function(N0){var w0=N0.getAttribute("id");k0[w0]=Ct.util.toArray(N0.getElementsByTagName("*")).filter(function(r0){return Ct.svgValidTagNamesRegEx.test(r0.nodeName.replace("svg:",""))})}),Ct.gradientDefs[d0]=Ct.getGradientDefs(Go),Ct.cssRules[d0]=Ct.getCSSRules(Go),Ct.clipPaths[d0]=k0,Ct.parseElements(v0,function(N0,w0){An&&(An(N0,b0,w0,O0),delete Ct.gradientDefs[d0],delete Ct.cssRules[d0],delete Ct.clipPaths[d0])},wt(b0),a0,u0)}};function Tn(Go,An){var a0=["gradientTransform","x1","x2","y1","y2","gradientUnits","cx","cy","r","fx","fy"],u0="xlink:href",d0=An.getAttribute(u0).slice(1),f0=Kr(Go,d0);if(f0&&f0.getAttribute(u0)&&Tn(Go,f0),a0.forEach(function(b0){f0&&!An.hasAttribute(b0)&&f0.hasAttribute(b0)&&An.setAttribute(b0,f0.getAttribute(b0))}),!An.children.length)for(var y0=f0.cloneNode(!0);y0.firstChild;)An.appendChild(y0.firstChild);An.removeAttribute(u0)}var n0=new RegExp("(normal|italic)?\\s*(normal|small-caps)?\\s*(normal|bold|bolder|lighter|100|200|300|400|500|600|700|800|900)?\\s*("+Ct.reNum+"(?:px|cm|mm|em|pt|pc|in)*)(?:\\/(normal|"+Ct.reNum+"))?\\s+(.*)");pt(Ct,{parseFontDeclaration:function(Go,An){var a0=Go.match(n0);if(a0){var u0=a0[1],d0=a0[3],f0=a0[4],y0=a0[5],b0=a0[6];u0&&(An.fontStyle=u0),d0&&(An.fontWeight=isNaN(parseFloat(d0))?d0:parseFloat(d0)),f0&&(An.fontSize=Lt(f0)),b0&&(An.fontFamily=b0),y0&&(An.lineHeight=y0==="normal"?1:y0)}},getGradientDefs:function(Go){var An=["linearGradient","radialGradient","svg:linearGradient","svg:radialGradient"],a0=ko(Go,An),u0,d0=0,f0={};for(d0=a0.length;d0--;)u0=a0[d0],u0.getAttribute("xlink:href")&&Tn(Go,u0),f0[u0.getAttribute("id")]=u0;return f0},parseAttributes:function(Go,An,a0){if(Go){var u0,d0={},f0,y0;typeof a0>"u"&&(a0=Go.getAttribute("svgUid")),Go.parentNode&&Ct.svgValidParentsRegEx.test(Go.parentNode.nodeName)&&(d0=Ct.parseAttributes(Go.parentNode,An,a0));var b0=An.reduce(function(r0,p0){return u0=Go.getAttribute(p0),u0&&(r0[p0]=u0),r0},{}),O0=pt(t0(Go,a0),Ct.parseStyleAttribute(Go));b0=pt(b0,O0),O0[or]&&Go.setAttribute(or,O0[or]),f0=y0=d0.fontSize||Ct.Text.DEFAULT_SVG_FONT_SIZE,b0[ir]&&(b0[ir]=f0=Lt(b0[ir],y0));var C0,v0,k0={};for(var N0 in b0)C0=jr(N0),v0=qr(C0,b0[N0],d0,f0),k0[C0]=v0;k0&&k0.font&&Ct.parseFontDeclaration(k0.font,k0);var w0=pt(d0,k0);return Ct.svgValidParentsRegEx.test(Go.nodeName)?w0:vn(w0)}},parseElements:function(Go,An,a0,u0,d0){new Ct.ElementsParser(Go,An,a0,u0,d0).parse()},parseStyleAttribute:function(Go){var An={},a0=Go.getAttribute("style");return a0&&(typeof a0=="string"?Xo(a0,An):zo(a0,An)),An},parsePointsAttribute:function(Go){if(!Go)return null;Go=Go.replace(/,/g," ").trim(),Go=Go.split(/\s+/);var An=[],a0,u0;for(a0=0,u0=Go.length;a0<u0;a0+=2)An.push({x:parseFloat(Go[a0]),y:parseFloat(Go[a0+1])});return An},getCSSRules:function(Go){var An=Go.getElementsByTagName("style"),a0,u0,d0={},f0;for(a0=0,u0=An.length;a0<u0;a0++){var y0=An[a0].textContent;y0=y0.replace(/\/\*[\s\S]*?\*\//g,""),y0.trim()!==""&&(f0=y0.split("}"),f0=f0.filter(function(b0){return b0.trim()}),f0.forEach(function(b0){var O0=b0.split("{"),C0={},v0=O0[1].trim(),k0=v0.split(";").filter(function(p0){return p0.trim()});for(a0=0,u0=k0.length;a0<u0;a0++){var N0=k0[a0].split(":"),w0=N0[0].trim(),r0=N0[1].trim();C0[w0]=r0}b0=O0[0].trim(),b0.split(",").forEach(function(p0){p0=p0.replace(/^svg/i,"").trim(),p0!==""&&(d0[p0]?Ct.util.object.extend(d0[p0],C0):d0[p0]=Ct.util.object.clone(C0))})}))}return d0},loadSVGFromURL:function(Go,An,a0,u0){Go=Go.replace(/^\n\s*/,"").trim(),new Ct.util.request(Go,{method:"get",onComplete:d0});function d0(f0){var y0=f0.responseXML;if(!y0||!y0.documentElement)return An&&An(null),!1;Ct.parseSVGDocument(y0.documentElement,function(b0,O0,C0,v0){An&&An(b0,O0,C0,v0)},a0,u0)}},loadSVGFromString:function(Go,An,a0,u0){var d0=new Ct.window.DOMParser,f0=d0.parseFromString(Go.trim(),"text/xml");Ct.parseSVGDocument(f0.documentElement,function(y0,b0,O0,C0){An(y0,b0,O0,C0)},a0,u0)}})}(d),g.ElementsParser=function(Tt,Ct,pt,wt,$t,Lt){this.elements=Tt,this.callback=Ct,this.options=pt,this.reviver=wt,this.svgUid=pt&&pt.svgUid||0,this.parsingOptions=$t,this.regexUrl=/^url\(['"]?#([^'"]+)['"]?\)/g,this.doc=Lt},function(Tt){Tt.parse=function(){this.instances=new Array(this.elements.length),this.numElements=this.elements.length,this.createObjects()},Tt.createObjects=function(){var Ct=this;this.elements.forEach(function(pt,wt){pt.setAttribute("svgUid",Ct.svgUid),Ct.createObject(pt,wt)})},Tt.findTag=function(Ct){return g[g.util.string.capitalize(Ct.tagName.replace("svg:",""))]},Tt.createObject=function(Ct,pt){var wt=this.findTag(Ct);if(wt&&wt.fromElement)try{wt.fromElement(Ct,this.createCallback(pt,Ct),this.options)}catch($t){g.log($t)}else this.checkIfDone()},Tt.createCallback=function(Ct,pt){var wt=this;return function($t){var Lt;wt.resolveGradient($t,pt,"fill"),wt.resolveGradient($t,pt,"stroke"),$t instanceof g.Image&&$t._originalElement&&(Lt=$t.parsePreserveAspectRatioAttribute(pt)),$t._removeTransformMatrix(Lt),wt.resolveClipPath($t,pt),wt.reviver&&wt.reviver(pt,$t),wt.instances[Ct]=$t,wt.checkIfDone()}},Tt.extractPropertyDefinition=function(Ct,pt,wt){var $t=Ct[pt],Lt=this.regexUrl;if(Lt.test($t)){Lt.lastIndex=0;var jt=Lt.exec($t)[1];return Lt.lastIndex=0,g[wt][this.svgUid][jt]}},Tt.resolveGradient=function(Ct,pt,wt){var $t=this.extractPropertyDefinition(Ct,wt,"gradientDefs");if($t){var Lt=pt.getAttribute(wt+"-opacity"),jt=g.Gradient.fromElement($t,Ct,Lt,this.options);Ct.set(wt,jt)}},Tt.createClipPathCallback=function(Ct,pt){return function(wt){wt._removeTransformMatrix(),wt.fillRule=wt.clipRule,pt.push(wt)}},Tt.resolveClipPath=function(Ct,pt){var wt=this.extractPropertyDefinition(Ct,"clipPath","clipPaths"),$t,Lt,jt,Ft,Gt,Ht;if(wt){Ft=[],jt=g.util.invertTransform(Ct.calcTransformMatrix());for(var qt=wt[0].parentNode,Kt=pt;Kt.parentNode&&Kt.getAttribute("clip-path")!==Ct.clipPath;)Kt=Kt.parentNode;Kt.parentNode.appendChild(qt);for(var rr=0;rr<wt.length;rr++)$t=wt[rr],Lt=this.findTag($t),Lt.fromElement($t,this.createClipPathCallback(Ct,Ft),this.options);Ft.length===1?wt=Ft[0]:wt=new g.Group(Ft),Gt=g.util.multiplyTransformMatrices(jt,wt.calcTransformMatrix()),wt.clipPath&&this.resolveClipPath(wt,Kt);var Ht=g.util.qrDecompose(Gt);wt.flipX=!1,wt.flipY=!1,wt.set("scaleX",Ht.scaleX),wt.set("scaleY",Ht.scaleY),wt.angle=Ht.angle,wt.skewX=Ht.skewX,wt.skewY=0,wt.setPositionByOrigin({x:Ht.translateX,y:Ht.translateY},"center","center"),Ct.clipPath=wt}else delete Ct.clipPath},Tt.checkIfDone=function(){--this.numElements===0&&(this.instances=this.instances.filter(function(Ct){return Ct!=null}),this.callback(this.instances,this.elements))}}(g.ElementsParser.prototype),function(Tt){var Ct=Tt.fabric||(Tt.fabric={});if(Ct.Point){Ct.warn("fabric.Point is already defined");return}Ct.Point=pt;function pt(wt,$t){this.x=wt,this.y=$t}pt.prototype={type:"point",constructor:pt,add:function(wt){return new pt(this.x+wt.x,this.y+wt.y)},addEquals:function(wt){return this.x+=wt.x,this.y+=wt.y,this},scalarAdd:function(wt){return new pt(this.x+wt,this.y+wt)},scalarAddEquals:function(wt){return this.x+=wt,this.y+=wt,this},subtract:function(wt){return new pt(this.x-wt.x,this.y-wt.y)},subtractEquals:function(wt){return this.x-=wt.x,this.y-=wt.y,this},scalarSubtract:function(wt){return new pt(this.x-wt,this.y-wt)},scalarSubtractEquals:function(wt){return this.x-=wt,this.y-=wt,this},multiply:function(wt){return new pt(this.x*wt,this.y*wt)},multiplyEquals:function(wt){return this.x*=wt,this.y*=wt,this},divide:function(wt){return new pt(this.x/wt,this.y/wt)},divideEquals:function(wt){return this.x/=wt,this.y/=wt,this},eq:function(wt){return this.x===wt.x&&this.y===wt.y},lt:function(wt){return this.x<wt.x&&this.y<wt.y},lte:function(wt){return this.x<=wt.x&&this.y<=wt.y},gt:function(wt){return this.x>wt.x&&this.y>wt.y},gte:function(wt){return this.x>=wt.x&&this.y>=wt.y},lerp:function(wt,$t){return typeof $t>"u"&&($t=.5),$t=Math.max(Math.min(1,$t),0),new pt(this.x+(wt.x-this.x)*$t,this.y+(wt.y-this.y)*$t)},distanceFrom:function(wt){var $t=this.x-wt.x,Lt=this.y-wt.y;return Math.sqrt($t*$t+Lt*Lt)},midPointFrom:function(wt){return this.lerp(wt)},min:function(wt){return new pt(Math.min(this.x,wt.x),Math.min(this.y,wt.y))},max:function(wt){return new pt(Math.max(this.x,wt.x),Math.max(this.y,wt.y))},toString:function(){return this.x+","+this.y},setXY:function(wt,$t){return this.x=wt,this.y=$t,this},setX:function(wt){return this.x=wt,this},setY:function(wt){return this.y=wt,this},setFromPoint:function(wt){return this.x=wt.x,this.y=wt.y,this},swap:function(wt){var $t=this.x,Lt=this.y;this.x=wt.x,this.y=wt.y,wt.x=$t,wt.y=Lt},clone:function(){return new pt(this.x,this.y)}}}(d),function(Tt){var Ct=Tt.fabric||(Tt.fabric={});if(Ct.Intersection){Ct.warn("fabric.Intersection is already defined");return}function pt(wt){this.status=wt,this.points=[]}Ct.Intersection=pt,Ct.Intersection.prototype={constructor:pt,appendPoint:function(wt){return this.points.push(wt),this},appendPoints:function(wt){return this.points=this.points.concat(wt),this}},Ct.Intersection.intersectLineLine=function(wt,$t,Lt,jt){var Ft,Gt=(jt.x-Lt.x)*(wt.y-Lt.y)-(jt.y-Lt.y)*(wt.x-Lt.x),Ht=($t.x-wt.x)*(wt.y-Lt.y)-($t.y-wt.y)*(wt.x-Lt.x),qt=(jt.y-Lt.y)*($t.x-wt.x)-(jt.x-Lt.x)*($t.y-wt.y);if(qt!==0){var Kt=Gt/qt,rr=Ht/qt;0<=Kt&&Kt<=1&&0<=rr&&rr<=1?(Ft=new pt("Intersection"),Ft.appendPoint(new Ct.Point(wt.x+Kt*($t.x-wt.x),wt.y+Kt*($t.y-wt.y)))):Ft=new pt}else Gt===0||Ht===0?Ft=new pt("Coincident"):Ft=new pt("Parallel");return Ft},Ct.Intersection.intersectLinePolygon=function(wt,$t,Lt){var jt=new pt,Ft=Lt.length,Gt,Ht,qt,Kt;for(Kt=0;Kt<Ft;Kt++)Gt=Lt[Kt],Ht=Lt[(Kt+1)%Ft],qt=pt.intersectLineLine(wt,$t,Gt,Ht),jt.appendPoints(qt.points);return jt.points.length>0&&(jt.status="Intersection"),jt},Ct.Intersection.intersectPolygonPolygon=function(wt,$t){var Lt=new pt,jt=wt.length,Ft;for(Ft=0;Ft<jt;Ft++){var Gt=wt[Ft],Ht=wt[(Ft+1)%jt],qt=pt.intersectLinePolygon(Gt,Ht,$t);Lt.appendPoints(qt.points)}return Lt.points.length>0&&(Lt.status="Intersection"),Lt},Ct.Intersection.intersectPolygonRectangle=function(wt,$t,Lt){var jt=$t.min(Lt),Ft=$t.max(Lt),Gt=new Ct.Point(Ft.x,jt.y),Ht=new Ct.Point(jt.x,Ft.y),qt=pt.intersectLinePolygon(jt,Gt,wt),Kt=pt.intersectLinePolygon(Gt,Ft,wt),rr=pt.intersectLinePolygon(Ft,Ht,wt),ir=pt.intersectLinePolygon(Ht,jt,wt),or=new pt;return or.appendPoints(qt.points),or.appendPoints(Kt.points),or.appendPoints(rr.points),or.appendPoints(ir.points),or.points.length>0&&(or.status="Intersection"),or}}(d),function(Tt){var Ct=Tt.fabric||(Tt.fabric={});if(Ct.Color){Ct.warn("fabric.Color is already defined.");return}function pt($t){$t?this._tryParsingColor($t):this.setSource([0,0,0,1])}Ct.Color=pt,Ct.Color.prototype={_tryParsingColor:function($t){var Lt;$t in pt.colorNameMap&&($t=pt.colorNameMap[$t]),$t==="transparent"&&(Lt=[255,255,255,0]),Lt||(Lt=pt.sourceFromHex($t)),Lt||(Lt=pt.sourceFromRgb($t)),Lt||(Lt=pt.sourceFromHsl($t)),Lt||(Lt=[0,0,0,1]),Lt&&this.setSource(Lt)},_rgbToHsl:function($t,Lt,jt){$t/=255,Lt/=255,jt/=255;var Ft,Gt,Ht,qt=Ct.util.array.max([$t,Lt,jt]),Kt=Ct.util.array.min([$t,Lt,jt]);if(Ht=(qt+Kt)/2,qt===Kt)Ft=Gt=0;else{var rr=qt-Kt;switch(Gt=Ht>.5?rr/(2-qt-Kt):rr/(qt+Kt),qt){case $t:Ft=(Lt-jt)/rr+(Lt<jt?6:0);break;case Lt:Ft=(jt-$t)/rr+2;break;case jt:Ft=($t-Lt)/rr+4;break}Ft/=6}return[Math.round(Ft*360),Math.round(Gt*100),Math.round(Ht*100)]},getSource:function(){return this._source},setSource:function($t){this._source=$t},toRgb:function(){var $t=this.getSource();return"rgb("+$t[0]+","+$t[1]+","+$t[2]+")"},toRgba:function(){var $t=this.getSource();return"rgba("+$t[0]+","+$t[1]+","+$t[2]+","+$t[3]+")"},toHsl:function(){var $t=this.getSource(),Lt=this._rgbToHsl($t[0],$t[1],$t[2]);return"hsl("+Lt[0]+","+Lt[1]+"%,"+Lt[2]+"%)"},toHsla:function(){var $t=this.getSource(),Lt=this._rgbToHsl($t[0],$t[1],$t[2]);return"hsla("+Lt[0]+","+Lt[1]+"%,"+Lt[2]+"%,"+$t[3]+")"},toHex:function(){var $t=this.getSource(),Lt,jt,Ft;return Lt=$t[0].toString(16),Lt=Lt.length===1?"0"+Lt:Lt,jt=$t[1].toString(16),jt=jt.length===1?"0"+jt:jt,Ft=$t[2].toString(16),Ft=Ft.length===1?"0"+Ft:Ft,Lt.toUpperCase()+jt.toUpperCase()+Ft.toUpperCase()},toHexa:function(){var $t=this.getSource(),Lt;return Lt=Math.round($t[3]*255),Lt=Lt.toString(16),Lt=Lt.length===1?"0"+Lt:Lt,this.toHex()+Lt.toUpperCase()},getAlpha:function(){return this.getSource()[3]},setAlpha:function($t){var Lt=this.getSource();return Lt[3]=$t,this.setSource(Lt),this},toGrayscale:function(){var $t=this.getSource(),Lt=parseInt(($t[0]*.3+$t[1]*.59+$t[2]*.11).toFixed(0),10),jt=$t[3];return this.setSource([Lt,Lt,Lt,jt]),this},toBlackWhite:function($t){var Lt=this.getSource(),jt=(Lt[0]*.3+Lt[1]*.59+Lt[2]*.11).toFixed(0),Ft=Lt[3];return $t=$t||127,jt=Number(jt)<Number($t)?0:255,this.setSource([jt,jt,jt,Ft]),this},overlayWith:function($t){$t instanceof pt||($t=new pt($t));var Lt=[],jt=this.getAlpha(),Ft=.5,Gt=this.getSource(),Ht=$t.getSource(),qt;for(qt=0;qt<3;qt++)Lt.push(Math.round(Gt[qt]*(1-Ft)+Ht[qt]*Ft));return Lt[3]=jt,this.setSource(Lt),this}},Ct.Color.reRGBa=/^rgba?\(\s*(\d{1,3}(?:\.\d+)?\%?)\s*,\s*(\d{1,3}(?:\.\d+)?\%?)\s*,\s*(\d{1,3}(?:\.\d+)?\%?)\s*(?:\s*,\s*((?:\d*\.?\d+)?)\s*)?\)$/i,Ct.Color.reHSLa=/^hsla?\(\s*(\d{1,3})\s*,\s*(\d{1,3}\%)\s*,\s*(\d{1,3}\%)\s*(?:\s*,\s*(\d+(?:\.\d+)?)\s*)?\)$/i,Ct.Color.reHex=/^#?([0-9a-f]{8}|[0-9a-f]{6}|[0-9a-f]{4}|[0-9a-f]{3})$/i,Ct.Color.colorNameMap={aliceblue:"#F0F8FF",antiquewhite:"#FAEBD7",aqua:"#00FFFF",aquamarine:"#7FFFD4",azure:"#F0FFFF",beige:"#F5F5DC",bisque:"#FFE4C4",black:"#000000",blanchedalmond:"#FFEBCD",blue:"#0000FF",blueviolet:"#8A2BE2",brown:"#A52A2A",burlywood:"#DEB887",cadetblue:"#5F9EA0",chartreuse:"#7FFF00",chocolate:"#D2691E",coral:"#FF7F50",cornflowerblue:"#6495ED",cornsilk:"#FFF8DC",crimson:"#DC143C",cyan:"#00FFFF",darkblue:"#00008B",darkcyan:"#008B8B",darkgoldenrod:"#B8860B",darkgray:"#A9A9A9",darkgrey:"#A9A9A9",darkgreen:"#006400",darkkhaki:"#BDB76B",darkmagenta:"#8B008B",darkolivegreen:"#556B2F",darkorange:"#FF8C00",darkorchid:"#9932CC",darkred:"#8B0000",darksalmon:"#E9967A",darkseagreen:"#8FBC8F",darkslateblue:"#483D8B",darkslategray:"#2F4F4F",darkslategrey:"#2F4F4F",darkturquoise:"#00CED1",darkviolet:"#9400D3",deeppink:"#FF1493",deepskyblue:"#00BFFF",dimgray:"#696969",dimgrey:"#696969",dodgerblue:"#1E90FF",firebrick:"#B22222",floralwhite:"#FFFAF0",forestgreen:"#228B22",fuchsia:"#FF00FF",gainsboro:"#DCDCDC",ghostwhite:"#F8F8FF",gold:"#FFD700",goldenrod:"#DAA520",gray:"#808080",grey:"#808080",green:"#008000",greenyellow:"#ADFF2F",honeydew:"#F0FFF0",hotpink:"#FF69B4",indianred:"#CD5C5C",indigo:"#4B0082",ivory:"#FFFFF0",khaki:"#F0E68C",lavender:"#E6E6FA",lavenderblush:"#FFF0F5",lawngreen:"#7CFC00",lemonchiffon:"#FFFACD",lightblue:"#ADD8E6",lightcoral:"#F08080",lightcyan:"#E0FFFF",lightgoldenrodyellow:"#FAFAD2",lightgray:"#D3D3D3",lightgrey:"#D3D3D3",lightgreen:"#90EE90",lightpink:"#FFB6C1",lightsalmon:"#FFA07A",lightseagreen:"#20B2AA",lightskyblue:"#87CEFA",lightslategray:"#778899",lightslategrey:"#778899",lightsteelblue:"#B0C4DE",lightyellow:"#FFFFE0",lime:"#00FF00",limegreen:"#32CD32",linen:"#FAF0E6",magenta:"#FF00FF",maroon:"#800000",mediumaquamarine:"#66CDAA",mediumblue:"#0000CD",mediumorchid:"#BA55D3",mediumpurple:"#9370DB",mediumseagreen:"#3CB371",mediumslateblue:"#7B68EE",mediumspringgreen:"#00FA9A",mediumturquoise:"#48D1CC",mediumvioletred:"#C71585",midnightblue:"#191970",mintcream:"#F5FFFA",mistyrose:"#FFE4E1",moccasin:"#FFE4B5",navajowhite:"#FFDEAD",navy:"#000080",oldlace:"#FDF5E6",olive:"#808000",olivedrab:"#6B8E23",orange:"#FFA500",orangered:"#FF4500",orchid:"#DA70D6",palegoldenrod:"#EEE8AA",palegreen:"#98FB98",paleturquoise:"#AFEEEE",palevioletred:"#DB7093",papayawhip:"#FFEFD5",peachpuff:"#FFDAB9",peru:"#CD853F",pink:"#FFC0CB",plum:"#DDA0DD",powderblue:"#B0E0E6",purple:"#800080",rebeccapurple:"#663399",red:"#FF0000",rosybrown:"#BC8F8F",royalblue:"#4169E1",saddlebrown:"#8B4513",salmon:"#FA8072",sandybrown:"#F4A460",seagreen:"#2E8B57",seashell:"#FFF5EE",sienna:"#A0522D",silver:"#C0C0C0",skyblue:"#87CEEB",slateblue:"#6A5ACD",slategray:"#708090",slategrey:"#708090",snow:"#FFFAFA",springgreen:"#00FF7F",steelblue:"#4682B4",tan:"#D2B48C",teal:"#008080",thistle:"#D8BFD8",tomato:"#FF6347",turquoise:"#40E0D0",violet:"#EE82EE",wheat:"#F5DEB3",white:"#FFFFFF",whitesmoke:"#F5F5F5",yellow:"#FFFF00",yellowgreen:"#9ACD32"};function wt($t,Lt,jt){return jt<0&&(jt+=1),jt>1&&(jt-=1),jt<1/6?$t+(Lt-$t)*6*jt:jt<1/2?Lt:jt<2/3?$t+(Lt-$t)*(2/3-jt)*6:$t}Ct.Color.fromRgb=function($t){return pt.fromSource(pt.sourceFromRgb($t))},Ct.Color.sourceFromRgb=function($t){var Lt=$t.match(pt.reRGBa);if(Lt){var jt=parseInt(Lt[1],10)/(/%$/.test(Lt[1])?100:1)*(/%$/.test(Lt[1])?255:1),Ft=parseInt(Lt[2],10)/(/%$/.test(Lt[2])?100:1)*(/%$/.test(Lt[2])?255:1),Gt=parseInt(Lt[3],10)/(/%$/.test(Lt[3])?100:1)*(/%$/.test(Lt[3])?255:1);return[parseInt(jt,10),parseInt(Ft,10),parseInt(Gt,10),Lt[4]?parseFloat(Lt[4]):1]}},Ct.Color.fromRgba=pt.fromRgb,Ct.Color.fromHsl=function($t){return pt.fromSource(pt.sourceFromHsl($t))},Ct.Color.sourceFromHsl=function($t){var Lt=$t.match(pt.reHSLa);if(Lt){var jt=(parseFloat(Lt[1])%360+360)%360/360,Ft=parseFloat(Lt[2])/(/%$/.test(Lt[2])?100:1),Gt=parseFloat(Lt[3])/(/%$/.test(Lt[3])?100:1),Ht,qt,Kt;if(Ft===0)Ht=qt=Kt=Gt;else{var rr=Gt<=.5?Gt*(Ft+1):Gt+Ft-Gt*Ft,ir=Gt*2-rr;Ht=wt(ir,rr,jt+1/3),qt=wt(ir,rr,jt),Kt=wt(ir,rr,jt-1/3)}return[Math.round(Ht*255),Math.round(qt*255),Math.round(Kt*255),Lt[4]?parseFloat(Lt[4]):1]}},Ct.Color.fromHsla=pt.fromHsl,Ct.Color.fromHex=function($t){return pt.fromSource(pt.sourceFromHex($t))},Ct.Color.sourceFromHex=function($t){if($t.match(pt.reHex)){var Lt=$t.slice($t.indexOf("#")+1),jt=Lt.length===3||Lt.length===4,Ft=Lt.length===8||Lt.length===4,Gt=jt?Lt.charAt(0)+Lt.charAt(0):Lt.substring(0,2),Ht=jt?Lt.charAt(1)+Lt.charAt(1):Lt.substring(2,4),qt=jt?Lt.charAt(2)+Lt.charAt(2):Lt.substring(4,6),Kt=Ft?jt?Lt.charAt(3)+Lt.charAt(3):Lt.substring(6,8):"FF";return[parseInt(Gt,16),parseInt(Ht,16),parseInt(qt,16),parseFloat((parseInt(Kt,16)/255).toFixed(2))]}},Ct.Color.fromSource=function($t){var Lt=new pt;return Lt.setSource($t),Lt}}(d),function(Tt){var Ct=Tt.fabric||(Tt.fabric={}),pt=["e","se","s","sw","w","nw","n","ne","e"],wt=["ns","nesw","ew","nwse"],$t={},Lt="left",jt="top",Ft="right",Gt="bottom",Ht="center",qt={top:Gt,bottom:jt,left:Ft,right:Lt,center:Ht},Kt=Ct.util.radiansToDegrees,rr=Math.sign||function(C0){return(C0>0)-(C0<0)||+C0};function ir(C0,v0){var k0=C0.angle+Kt(Math.atan2(v0.y,v0.x))+360;return Math.round(k0%360/45)}function or(C0,v0){var k0=v0.transform.target,N0=k0.canvas,w0=Ct.util.object.clone(v0);w0.target=k0,N0&&N0.fire("object:"+C0,w0),k0.fire(C0,v0)}function jr(C0,v0){var k0=v0.canvas,N0=k0.uniScaleKey,w0=C0[N0];return k0.uniformScaling&&!w0||!k0.uniformScaling&&w0}function qr(C0){return C0.originX===Ht&&C0.originY===Ht}function Yr(C0,v0,k0){var N0=C0.lockScalingX,w0=C0.lockScalingY;return!!(N0&&w0||!v0&&(N0||w0)&&k0||N0&&v0==="x"||w0&&v0==="y")}function vn(C0,v0,k0){var N0="not-allowed",w0=jr(C0,k0),r0="";if(v0.x!==0&&v0.y===0?r0="x":v0.x===0&&v0.y!==0&&(r0="y"),Yr(k0,r0,w0))return N0;var p0=ir(k0,v0);return pt[p0]+"-resize"}function ko(C0,v0,k0){var N0="not-allowed";if(v0.x!==0&&k0.lockSkewingY||v0.y!==0&&k0.lockSkewingX)return N0;var w0=ir(k0,v0)%4;return wt[w0]+"-resize"}function Xo(C0,v0,k0){return C0[k0.canvas.altActionKey]?$t.skewCursorStyleHandler(C0,v0,k0):$t.scaleCursorStyleHandler(C0,v0,k0)}function zo(C0,v0,k0){var N0=C0[k0.canvas.altActionKey];if(v0.x===0)return N0?"skewX":"scaleY";if(v0.y===0)return N0?"skewY":"scaleX"}function t0(C0,v0,k0){return k0.lockRotation?"not-allowed":v0.cursorStyle}function Uo(C0,v0,k0,N0){return{e:C0,transform:v0,pointer:{x:k0,y:N0}}}function No(C0){return function(v0,k0,N0,w0){var r0=k0.target,p0=r0.getCenterPoint(),$0=r0.translateToOriginPoint(p0,k0.originX,k0.originY),A0=C0(v0,k0,N0,w0);return r0.setPositionByOrigin($0,k0.originX,k0.originY),A0}}function _n(C0,v0){return function(k0,N0,w0,r0){var p0=v0(k0,N0,w0,r0);return p0&&or(C0,Uo(k0,N0,w0,r0)),p0}}function Kr(C0,v0,k0,N0,w0){var r0=C0.target,p0=r0.controls[C0.corner],$0=r0.canvas.getZoom(),A0=r0.padding/$0,g0=r0.toLocalPoint(new Ct.Point(N0,w0),v0,k0);return g0.x>=A0&&(g0.x-=A0),g0.x<=-A0&&(g0.x+=A0),g0.y>=A0&&(g0.y-=A0),g0.y<=A0&&(g0.y+=A0),g0.x-=p0.offsetX,g0.y-=p0.offsetY,g0}function e0(C0){return C0.flipX!==C0.flipY}function Zr(C0,v0,k0,N0,w0){if(C0[v0]!==0){var r0=C0._getTransformedDimensions()[N0],p0=w0/r0*C0[k0];C0.set(k0,p0)}}function Ro(C0,v0,k0,N0){var w0=v0.target,r0=w0._getTransformedDimensions(0,w0.skewY),p0=Kr(v0,v0.originX,v0.originY,k0,N0),$0=Math.abs(p0.x*2)-r0.x,A0=w0.skewX,g0;$0<2?g0=0:(g0=Kt(Math.atan2($0/w0.scaleX,r0.y/w0.scaleY)),v0.originX===Lt&&v0.originY===Gt&&(g0=-g0),v0.originX===Ft&&v0.originY===jt&&(g0=-g0),e0(w0)&&(g0=-g0));var E0=A0!==g0;if(E0){var F0=w0._getTransformedDimensions().y;w0.set("skewX",g0),Zr(w0,"skewY","scaleY","y",F0)}return E0}function Sn(C0,v0,k0,N0){var w0=v0.target,r0=w0._getTransformedDimensions(w0.skewX,0),p0=Kr(v0,v0.originX,v0.originY,k0,N0),$0=Math.abs(p0.y*2)-r0.y,A0=w0.skewY,g0;$0<2?g0=0:(g0=Kt(Math.atan2($0/w0.scaleY,r0.x/w0.scaleX)),v0.originX===Lt&&v0.originY===Gt&&(g0=-g0),v0.originX===Ft&&v0.originY===jt&&(g0=-g0),e0(w0)&&(g0=-g0));var E0=A0!==g0;if(E0){var F0=w0._getTransformedDimensions().x;w0.set("skewY",g0),Zr(w0,"skewX","scaleX","x",F0)}return E0}function Tn(C0,v0,k0,N0){var w0=v0.target,r0=w0.skewX,p0,$0=v0.originY;if(w0.lockSkewingX)return!1;if(r0===0){var A0=Kr(v0,Ht,Ht,k0,N0);A0.x>0?p0=Lt:p0=Ft}else r0>0&&(p0=$0===jt?Lt:Ft),r0<0&&(p0=$0===jt?Ft:Lt),e0(w0)&&(p0=p0===Lt?Ft:Lt);v0.originX=p0;var g0=_n("skewing",No(Ro));return g0(C0,v0,k0,N0)}function n0(C0,v0,k0,N0){var w0=v0.target,r0=w0.skewY,p0,$0=v0.originX;if(w0.lockSkewingY)return!1;if(r0===0){var A0=Kr(v0,Ht,Ht,k0,N0);A0.y>0?p0=jt:p0=Gt}else r0>0&&(p0=$0===Lt?jt:Gt),r0<0&&(p0=$0===Lt?Gt:jt),e0(w0)&&(p0=p0===jt?Gt:jt);v0.originY=p0;var g0=_n("skewing",No(Sn));return g0(C0,v0,k0,N0)}function Go(C0,v0,k0,N0){var w0=v0,r0=w0.target,p0=r0.translateToOriginPoint(r0.getCenterPoint(),w0.originX,w0.originY);if(r0.lockRotation)return!1;var $0=Math.atan2(w0.ey-p0.y,w0.ex-p0.x),A0=Math.atan2(N0-p0.y,k0-p0.x),g0=Kt(A0-$0+w0.theta),E0=!0;if(r0.snapAngle>0){var F0=r0.snapAngle,K0=r0.snapThreshold||F0,l1=Math.ceil(g0/F0)*F0,n1=Math.floor(g0/F0)*F0;Math.abs(g0-n1)<K0?g0=n1:Math.abs(g0-l1)<K0&&(g0=l1)}return g0<0&&(g0=360+g0),g0%=360,E0=r0.angle!==g0,r0.angle=g0,E0}function An(C0,v0,k0,N0,w0){w0=w0||{};var r0=v0.target,p0=r0.lockScalingX,$0=r0.lockScalingY,A0=w0.by,g0,E0,F0,K0,l1=jr(C0,r0),n1=Yr(r0,A0,l1),x1,u1,P1=v0.gestureScale;if(n1)return!1;if(P1)E0=v0.scaleX*P1,F0=v0.scaleY*P1;else{if(g0=Kr(v0,v0.originX,v0.originY,k0,N0),x1=A0!=="y"?rr(g0.x):1,u1=A0!=="x"?rr(g0.y):1,v0.signX||(v0.signX=x1),v0.signY||(v0.signY=u1),r0.lockScalingFlip&&(v0.signX!==x1||v0.signY!==u1))return!1;if(K0=r0._getTransformedDimensions(),l1&&!A0){var i1=Math.abs(g0.x)+Math.abs(g0.y),v1=v0.original,_1=Math.abs(K0.x*v1.scaleX/r0.scaleX)+Math.abs(K0.y*v1.scaleY/r0.scaleY),X1=i1/_1;E0=v1.scaleX*X1,F0=v1.scaleY*X1}else E0=Math.abs(g0.x*r0.scaleX/K0.x),F0=Math.abs(g0.y*r0.scaleY/K0.y);qr(v0)&&(E0*=2,F0*=2),v0.signX!==x1&&A0!=="y"&&(v0.originX=qt[v0.originX],E0*=-1,v0.signX=x1),v0.signY!==u1&&A0!=="x"&&(v0.originY=qt[v0.originY],F0*=-1,v0.signY=u1)}var t1=r0.scaleX,cv=r0.scaleY;return A0?(A0==="x"&&r0.set("scaleX",E0),A0==="y"&&r0.set("scaleY",F0)):(!p0&&r0.set("scaleX",E0),!$0&&r0.set("scaleY",F0)),t1!==r0.scaleX||cv!==r0.scaleY}function a0(C0,v0,k0,N0){return An(C0,v0,k0,N0)}function u0(C0,v0,k0,N0){return An(C0,v0,k0,N0,{by:"x"})}function d0(C0,v0,k0,N0){return An(C0,v0,k0,N0,{by:"y"})}function f0(C0,v0,k0,N0){return C0[v0.target.canvas.altActionKey]?$t.skewHandlerX(C0,v0,k0,N0):$t.scalingY(C0,v0,k0,N0)}function y0(C0,v0,k0,N0){return C0[v0.target.canvas.altActionKey]?$t.skewHandlerY(C0,v0,k0,N0):$t.scalingX(C0,v0,k0,N0)}function b0(C0,v0,k0,N0){var w0=v0.target,r0=Kr(v0,v0.originX,v0.originY,k0,N0),p0=w0.strokeWidth/(w0.strokeUniform?w0.scaleX:1),$0=qr(v0)?2:1,A0=w0.width,g0=Math.abs(r0.x*$0/w0.scaleX)-p0;return w0.set("width",Math.max(g0,0)),A0!==g0}function O0(C0,v0,k0,N0){var w0=v0.target,r0=k0-v0.offsetX,p0=N0-v0.offsetY,$0=!w0.get("lockMovementX")&&w0.left!==r0,A0=!w0.get("lockMovementY")&&w0.top!==p0;return $0&&w0.set("left",r0),A0&&w0.set("top",p0),($0||A0)&&or("moving",Uo(C0,v0,k0,N0)),$0||A0}$t.scaleCursorStyleHandler=vn,$t.skewCursorStyleHandler=ko,$t.scaleSkewCursorStyleHandler=Xo,$t.rotationWithSnapping=_n("rotating",No(Go)),$t.scalingEqually=_n("scaling",No(a0)),$t.scalingX=_n("scaling",No(u0)),$t.scalingY=_n("scaling",No(d0)),$t.scalingYOrSkewingX=f0,$t.scalingXOrSkewingY=y0,$t.changeWidth=_n("resizing",No(b0)),$t.skewHandlerX=Tn,$t.skewHandlerY=n0,$t.dragHandler=O0,$t.scaleOrSkewActionName=zo,$t.rotationStyleHandler=t0,$t.fireEvent=or,$t.wrapWithFixedAnchor=No,$t.wrapWithFireEvent=_n,$t.getLocalPoint=Kr,Ct.controlsUtils=$t}(d),function(Tt){var Ct=Tt.fabric||(Tt.fabric={}),pt=Ct.util.degreesToRadians,wt=Ct.controlsUtils;function $t(jt,Ft,Gt,Ht,qt){Ht=Ht||{};var Kt=this.sizeX||Ht.cornerSize||qt.cornerSize,rr=this.sizeY||Ht.cornerSize||qt.cornerSize,ir=typeof Ht.transparentCorners<"u"?Ht.transparentCorners:qt.transparentCorners,or=ir?"stroke":"fill",jr=!ir&&(Ht.cornerStrokeColor||qt.cornerStrokeColor),qr=Ft,Yr=Gt,vn;jt.save(),jt.fillStyle=Ht.cornerColor||qt.cornerColor,jt.strokeStyle=Ht.cornerStrokeColor||qt.cornerStrokeColor,Kt>rr?(vn=Kt,jt.scale(1,rr/Kt),Yr=Gt*Kt/rr):rr>Kt?(vn=rr,jt.scale(Kt/rr,1),qr=Ft*rr/Kt):vn=Kt,jt.lineWidth=1,jt.beginPath(),jt.arc(qr,Yr,vn/2,0,2*Math.PI,!1),jt[or](),jr&&jt.stroke(),jt.restore()}function Lt(jt,Ft,Gt,Ht,qt){Ht=Ht||{};var Kt=this.sizeX||Ht.cornerSize||qt.cornerSize,rr=this.sizeY||Ht.cornerSize||qt.cornerSize,ir=typeof Ht.transparentCorners<"u"?Ht.transparentCorners:qt.transparentCorners,or=ir?"stroke":"fill",jr=!ir&&(Ht.cornerStrokeColor||qt.cornerStrokeColor),qr=Kt/2,Yr=rr/2;jt.save(),jt.fillStyle=Ht.cornerColor||qt.cornerColor,jt.strokeStyle=Ht.cornerStrokeColor||qt.cornerStrokeColor,jt.lineWidth=1,jt.translate(Ft,Gt),jt.rotate(pt(qt.angle)),jt[or+"Rect"](-qr,-Yr,Kt,rr),jr&&jt.strokeRect(-qr,-Yr,Kt,rr),jt.restore()}wt.renderCircleControl=$t,wt.renderSquareControl=Lt}(d),function(Tt){var Ct=Tt.fabric||(Tt.fabric={});function pt(wt){for(var $t in wt)this[$t]=wt[$t]}Ct.Control=pt,Ct.Control.prototype={visible:!0,actionName:"scale",angle:0,x:0,y:0,offsetX:0,offsetY:0,sizeX:null,sizeY:null,touchSizeX:null,touchSizeY:null,cursorStyle:"crosshair",withConnection:!1,actionHandler:function(){},mouseDownHandler:function(){},mouseUpHandler:function(){},getActionHandler:function(){return this.actionHandler},getMouseDownHandler:function(){return this.mouseDownHandler},getMouseUpHandler:function(){return this.mouseUpHandler},cursorStyleHandler:function(wt,$t){return $t.cursorStyle},getActionName:function(wt,$t){return $t.actionName},getVisibility:function(wt,$t){var Lt=wt._controlsVisibility;return Lt&&typeof Lt[$t]<"u"?Lt[$t]:this.visible},setVisibility:function(wt){this.visible=wt},positionHandler:function(wt,$t){var Lt=Ct.util.transformPoint({x:this.x*wt.x+this.offsetX,y:this.y*wt.y+this.offsetY},$t);return Lt},calcCornerCoords:function(wt,$t,Lt,jt,Ft){var Gt,Ht,qt,Kt,rr=Ft?this.touchSizeX:this.sizeX,ir=Ft?this.touchSizeY:this.sizeY;if(rr&&ir&&rr!==ir){var or=Math.atan2(ir,rr),jr=Math.sqrt(rr*rr+ir*ir)/2,qr=or-Ct.util.degreesToRadians(wt),Yr=Math.PI/2-or-Ct.util.degreesToRadians(wt);Gt=jr*Ct.util.cos(qr),Ht=jr*Ct.util.sin(qr),qt=jr*Ct.util.cos(Yr),Kt=jr*Ct.util.sin(Yr)}else{var vn=rr&&ir?rr:$t;jr=vn*.7071067812;var qr=Ct.util.degreesToRadians(45-wt);Gt=qt=jr*Ct.util.cos(qr),Ht=Kt=jr*Ct.util.sin(qr)}return{tl:{x:Lt-Kt,y:jt-qt},tr:{x:Lt+Gt,y:jt-Ht},bl:{x:Lt-Gt,y:jt+Ht},br:{x:Lt+Kt,y:jt+qt}}},render:function(wt,$t,Lt,jt,Ft){switch(jt=jt||{},jt.cornerStyle||Ft.cornerStyle){case"circle":Ct.controlsUtils.renderCircleControl.call(this,wt,$t,Lt,jt,Ft);break;default:Ct.controlsUtils.renderSquareControl.call(this,wt,$t,Lt,jt,Ft)}}}}(d),function(){function Tt(Lt,jt){var Ft=Lt.getAttribute("style"),Gt=Lt.getAttribute("offset")||0,Ht,qt,Kt,rr;if(Gt=parseFloat(Gt)/(/%$/.test(Gt)?100:1),Gt=Gt<0?0:Gt>1?1:Gt,Ft){var ir=Ft.split(/\s*;\s*/);for(ir[ir.length-1]===""&&ir.pop(),rr=ir.length;rr--;){var or=ir[rr].split(/\s*:\s*/),jr=or[0].trim(),qr=or[1].trim();jr==="stop-color"?Ht=qr:jr==="stop-opacity"&&(Kt=qr)}}return Ht||(Ht=Lt.getAttribute("stop-color")||"rgb(0,0,0)"),Kt||(Kt=Lt.getAttribute("stop-opacity")),Ht=new g.Color(Ht),qt=Ht.getAlpha(),Kt=isNaN(parseFloat(Kt))?1:parseFloat(Kt),Kt*=qt*jt,{offset:Gt,color:Ht.toRgb(),opacity:Kt}}function Ct(Lt){return{x1:Lt.getAttribute("x1")||0,y1:Lt.getAttribute("y1")||0,x2:Lt.getAttribute("x2")||"100%",y2:Lt.getAttribute("y2")||0}}function pt(Lt){return{x1:Lt.getAttribute("fx")||Lt.getAttribute("cx")||"50%",y1:Lt.getAttribute("fy")||Lt.getAttribute("cy")||"50%",r1:0,x2:Lt.getAttribute("cx")||"50%",y2:Lt.getAttribute("cy")||"50%",r2:Lt.getAttribute("r")||"50%"}}var wt=g.util.object.clone;g.Gradient=g.util.createClass({offsetX:0,offsetY:0,gradientTransform:null,gradientUnits:"pixels",type:"linear",initialize:function(Lt){Lt||(Lt={}),Lt.coords||(Lt.coords={});var jt,Ft=this;Object.keys(Lt).forEach(function(Gt){Ft[Gt]=Lt[Gt]}),this.id?this.id+="_"+g.Object.__uid++:this.id=g.Object.__uid++,jt={x1:Lt.coords.x1||0,y1:Lt.coords.y1||0,x2:Lt.coords.x2||0,y2:Lt.coords.y2||0},this.type==="radial"&&(jt.r1=Lt.coords.r1||0,jt.r2=Lt.coords.r2||0),this.coords=jt,this.colorStops=Lt.colorStops.slice()},addColorStop:function(Lt){for(var jt in Lt){var Ft=new g.Color(Lt[jt]);this.colorStops.push({offset:parseFloat(jt),color:Ft.toRgb(),opacity:Ft.getAlpha()})}return this},toObject:function(Lt){var jt={type:this.type,coords:this.coords,colorStops:this.colorStops,offsetX:this.offsetX,offsetY:this.offsetY,gradientUnits:this.gradientUnits,gradientTransform:this.gradientTransform?this.gradientTransform.concat():this.gradientTransform};return g.util.populateWithProperties(this,jt,Lt),jt},toSVG:function(Lt,qt){var Ft=wt(this.coords,!0),Gt,Ht,qt=qt||{},Kt,rr,ir=wt(this.colorStops,!0),or=Ft.r1>Ft.r2,jr=this.gradientTransform?this.gradientTransform.concat():g.iMatrix.concat(),qr=-this.offsetX,Yr=-this.offsetY,vn=!!qt.additionalTransform,ko=this.gradientUnits==="pixels"?"userSpaceOnUse":"objectBoundingBox";if(ir.sort(function(No,_n){return No.offset-_n.offset}),ko==="objectBoundingBox"?(qr/=Lt.width,Yr/=Lt.height):(qr+=Lt.width/2,Yr+=Lt.height/2),Lt.type==="path"&&this.gradientUnits!=="percentage"&&(qr-=Lt.pathOffset.x,Yr-=Lt.pathOffset.y),jr[4]-=qr,jr[5]-=Yr,rr='id="SVGID_'+this.id+'" gradientUnits="'+ko+'"',rr+=' gradientTransform="'+(vn?qt.additionalTransform+" ":"")+g.util.matrixToSVG(jr)+'" ',this.type==="linear"?Kt=["<linearGradient ",rr,' x1="',Ft.x1,'" y1="',Ft.y1,'" x2="',Ft.x2,'" y2="',Ft.y2,`">
`]:this.type==="radial"&&(Kt=["<radialGradient ",rr,' cx="',or?Ft.x1:Ft.x2,'" cy="',or?Ft.y1:Ft.y2,'" r="',or?Ft.r1:Ft.r2,'" fx="',or?Ft.x2:Ft.x1,'" fy="',or?Ft.y2:Ft.y1,`">
`]),this.type==="radial"){if(or)for(ir=ir.concat(),ir.reverse(),Gt=0,Ht=ir.length;Gt<Ht;Gt++)ir[Gt].offset=1-ir[Gt].offset;var Xo=Math.min(Ft.r1,Ft.r2);if(Xo>0){var zo=Math.max(Ft.r1,Ft.r2),t0=Xo/zo;for(Gt=0,Ht=ir.length;Gt<Ht;Gt++)ir[Gt].offset+=t0*(1-ir[Gt].offset)}}for(Gt=0,Ht=ir.length;Gt<Ht;Gt++){var Uo=ir[Gt];Kt.push("<stop ",'offset="',Uo.offset*100+"%",'" style="stop-color:',Uo.color,typeof Uo.opacity<"u"?";stop-opacity: "+Uo.opacity:";",`"/>
`)}return Kt.push(this.type==="linear"?`</linearGradient>
`:`</radialGradient>
`),Kt.join("")},toLive:function(Lt){var jt,Ft=g.util.object.clone(this.coords),Gt,Ht;if(this.type){for(this.type==="linear"?jt=Lt.createLinearGradient(Ft.x1,Ft.y1,Ft.x2,Ft.y2):this.type==="radial"&&(jt=Lt.createRadialGradient(Ft.x1,Ft.y1,Ft.r1,Ft.x2,Ft.y2,Ft.r2)),Gt=0,Ht=this.colorStops.length;Gt<Ht;Gt++){var qt=this.colorStops[Gt].color,Kt=this.colorStops[Gt].opacity,rr=this.colorStops[Gt].offset;typeof Kt<"u"&&(qt=new g.Color(qt).setAlpha(Kt).toRgba()),jt.addColorStop(rr,qt)}return jt}}}),g.util.object.extend(g.Gradient,{fromElement:function(Lt,jt,Ft,Gt){var Ht=parseFloat(Ft)/(/%$/.test(Ft)?100:1);Ht=Ht<0?0:Ht>1?1:Ht,isNaN(Ht)&&(Ht=1);var qt=Lt.getElementsByTagName("stop"),Kt,rr=Lt.getAttribute("gradientUnits")==="userSpaceOnUse"?"pixels":"percentage",ir=Lt.getAttribute("gradientTransform")||"",or=[],jr,qr,Yr=0,vn=0,ko;for(Lt.nodeName==="linearGradient"||Lt.nodeName==="LINEARGRADIENT"?(Kt="linear",jr=Ct(Lt)):(Kt="radial",jr=pt(Lt)),qr=qt.length;qr--;)or.push(Tt(qt[qr],Ht));ko=g.parseTransformAttribute(ir),$t(jt,jr,Gt,rr),rr==="pixels"&&(Yr=-jt.left,vn=-jt.top);var Xo=new g.Gradient({id:Lt.getAttribute("id"),type:Kt,coords:jr,colorStops:or,gradientUnits:rr,gradientTransform:ko,offsetX:Yr,offsetY:vn});return Xo}});function $t(Lt,jt,Ft,Gt){var Ht,qt;Object.keys(jt).forEach(function(Kt){Ht=jt[Kt],Ht==="Infinity"?qt=1:Ht==="-Infinity"?qt=0:(qt=parseFloat(jt[Kt],10),typeof Ht=="string"&&/^(\d+\.\d+)%|(\d+)%$/.test(Ht)&&(qt*=.01,Gt==="pixels"&&((Kt==="x1"||Kt==="x2"||Kt==="r2")&&(qt*=Ft.viewBoxWidth||Ft.width),(Kt==="y1"||Kt==="y2")&&(qt*=Ft.viewBoxHeight||Ft.height)))),jt[Kt]=qt})}}(),function(){var Tt=g.util.toFixed;g.Pattern=g.util.createClass({repeat:"repeat",offsetX:0,offsetY:0,crossOrigin:"",patternTransform:null,initialize:function(Ct,pt){if(Ct||(Ct={}),this.id=g.Object.__uid++,this.setOptions(Ct),!Ct.source||Ct.source&&typeof Ct.source!="string"){pt&&pt(this);return}else{var wt=this;this.source=g.util.createImage(),g.util.loadImage(Ct.source,function($t,Lt){wt.source=$t,pt&&pt(wt,Lt)},null,this.crossOrigin)}},toObject:function(Ct){var pt=g.Object.NUM_FRACTION_DIGITS,wt,$t;return typeof this.source.src=="string"?wt=this.source.src:typeof this.source=="object"&&this.source.toDataURL&&(wt=this.source.toDataURL()),$t={type:"pattern",source:wt,repeat:this.repeat,crossOrigin:this.crossOrigin,offsetX:Tt(this.offsetX,pt),offsetY:Tt(this.offsetY,pt),patternTransform:this.patternTransform?this.patternTransform.concat():null},g.util.populateWithProperties(this,$t,Ct),$t},toSVG:function(Ct){var pt=typeof this.source=="function"?this.source():this.source,wt=pt.width/Ct.width,$t=pt.height/Ct.height,Lt=this.offsetX/Ct.width,jt=this.offsetY/Ct.height,Ft="";return(this.repeat==="repeat-x"||this.repeat==="no-repeat")&&($t=1,jt&&($t+=Math.abs(jt))),(this.repeat==="repeat-y"||this.repeat==="no-repeat")&&(wt=1,Lt&&(wt+=Math.abs(Lt))),pt.src?Ft=pt.src:pt.toDataURL&&(Ft=pt.toDataURL()),'<pattern id="SVGID_'+this.id+'" x="'+Lt+'" y="'+jt+'" width="'+wt+'" height="'+$t+`">
<image x="0" y="0" width="`+pt.width+'" height="'+pt.height+'" xlink:href="'+Ft+`"></image>
</pattern>
`},setOptions:function(Ct){for(var pt in Ct)this[pt]=Ct[pt]},toLive:function(Ct){var pt=this.source;return!pt||typeof pt.src<"u"&&(!pt.complete||pt.naturalWidth===0||pt.naturalHeight===0)?"":Ct.createPattern(pt,this.repeat)}})}(),function(Tt){var Ct=Tt.fabric||(Tt.fabric={}),pt=Ct.util.toFixed;if(Ct.Shadow){Ct.warn("fabric.Shadow is already defined.");return}Ct.Shadow=Ct.util.createClass({color:"rgb(0,0,0)",blur:0,offsetX:0,offsetY:0,affectStroke:!1,includeDefaultValues:!0,nonScaling:!1,initialize:function(wt){typeof wt=="string"&&(wt=this._parseShadow(wt));for(var $t in wt)this[$t]=wt[$t];this.id=Ct.Object.__uid++},_parseShadow:function(wt){var $t=wt.trim(),Lt=Ct.Shadow.reOffsetsAndBlur.exec($t)||[],jt=$t.replace(Ct.Shadow.reOffsetsAndBlur,"")||"rgb(0,0,0)";return{color:jt.trim(),offsetX:parseFloat(Lt[1],10)||0,offsetY:parseFloat(Lt[2],10)||0,blur:parseFloat(Lt[3],10)||0}},toString:function(){return[this.offsetX,this.offsetY,this.blur,this.color].join("px ")},toSVG:function(wt){var $t=40,Lt=40,jt=Ct.Object.NUM_FRACTION_DIGITS,Ft=Ct.util.rotateVector({x:this.offsetX,y:this.offsetY},Ct.util.degreesToRadians(-wt.angle)),Gt=20,Ht=new Ct.Color(this.color);return wt.width&&wt.height&&($t=pt((Math.abs(Ft.x)+this.blur)/wt.width,jt)*100+Gt,Lt=pt((Math.abs(Ft.y)+this.blur)/wt.height,jt)*100+Gt),wt.flipX&&(Ft.x*=-1),wt.flipY&&(Ft.y*=-1),'<filter id="SVGID_'+this.id+'" y="-'+Lt+'%" height="'+(100+2*Lt)+'%" x="-'+$t+'%" width="'+(100+2*$t)+`%" >
	<feGaussianBlur in="SourceAlpha" stdDeviation="`+pt(this.blur?this.blur/2:0,jt)+`"></feGaussianBlur>
	<feOffset dx="`+pt(Ft.x,jt)+'" dy="'+pt(Ft.y,jt)+`" result="oBlur" ></feOffset>
	<feFlood flood-color="`+Ht.toRgb()+'" flood-opacity="'+Ht.getAlpha()+`"/>
	<feComposite in2="oBlur" operator="in" />
	<feMerge>
		<feMergeNode></feMergeNode>
		<feMergeNode in="SourceGraphic"></feMergeNode>
	</feMerge>
</filter>
`},toObject:function(){if(this.includeDefaultValues)return{color:this.color,blur:this.blur,offsetX:this.offsetX,offsetY:this.offsetY,affectStroke:this.affectStroke,nonScaling:this.nonScaling};var wt={},$t=Ct.Shadow.prototype;return["color","blur","offsetX","offsetY","affectStroke","nonScaling"].forEach(function(Lt){this[Lt]!==$t[Lt]&&(wt[Lt]=this[Lt])},this),wt}}),Ct.Shadow.reOffsetsAndBlur=/(?:\s|^)(-?\d+(?:\.\d*)?(?:px)?(?:\s?|$))?(-?\d+(?:\.\d*)?(?:px)?(?:\s?|$))?(\d+(?:\.\d*)?(?:px)?)?(?:\s?|$)(?:$|\s)/}(d),function(){if(g.StaticCanvas){g.warn("fabric.StaticCanvas is already defined.");return}var Tt=g.util.object.extend,Ct=g.util.getElementOffset,pt=g.util.removeFromArray,wt=g.util.toFixed,$t=g.util.transformPoint,Lt=g.util.invertTransform,jt=g.util.getNodeCanvas,Ft=g.util.createCanvasElement,Gt=new Error("Could not initialize `canvas` element");g.StaticCanvas=g.util.createClass(g.CommonMethods,{initialize:function(Ht,qt){qt||(qt={}),this.renderAndResetBound=this.renderAndReset.bind(this),this.requestRenderAllBound=this.requestRenderAll.bind(this),this._initStatic(Ht,qt)},backgroundColor:"",backgroundImage:null,overlayColor:"",overlayImage:null,includeDefaultValues:!0,stateful:!1,renderOnAddRemove:!0,controlsAboveOverlay:!1,allowTouchScrolling:!1,imageSmoothingEnabled:!0,viewportTransform:g.iMatrix.concat(),backgroundVpt:!0,overlayVpt:!0,enableRetinaScaling:!0,vptCoords:{},skipOffscreen:!0,clipPath:void 0,_initStatic:function(Ht,qt){var Kt=this.requestRenderAllBound;this._objects=[],this._createLowerCanvas(Ht),this._initOptions(qt),this.interactive||this._initRetinaScaling(),qt.overlayImage&&this.setOverlayImage(qt.overlayImage,Kt),qt.backgroundImage&&this.setBackgroundImage(qt.backgroundImage,Kt),qt.backgroundColor&&this.setBackgroundColor(qt.backgroundColor,Kt),qt.overlayColor&&this.setOverlayColor(qt.overlayColor,Kt),this.calcOffset()},_isRetinaScaling:function(){return g.devicePixelRatio>1&&this.enableRetinaScaling},getRetinaScaling:function(){return this._isRetinaScaling()?Math.max(1,g.devicePixelRatio):1},_initRetinaScaling:function(){if(this._isRetinaScaling()){var Ht=g.devicePixelRatio;this.__initRetinaScaling(Ht,this.lowerCanvasEl,this.contextContainer),this.upperCanvasEl&&this.__initRetinaScaling(Ht,this.upperCanvasEl,this.contextTop)}},__initRetinaScaling:function(Ht,qt,Kt){qt.setAttribute("width",this.width*Ht),qt.setAttribute("height",this.height*Ht),Kt.scale(Ht,Ht)},calcOffset:function(){return this._offset=Ct(this.lowerCanvasEl),this},setOverlayImage:function(Ht,qt,Kt){return this.__setBgOverlayImage("overlayImage",Ht,qt,Kt)},setBackgroundImage:function(Ht,qt,Kt){return this.__setBgOverlayImage("backgroundImage",Ht,qt,Kt)},setOverlayColor:function(Ht,qt){return this.__setBgOverlayColor("overlayColor",Ht,qt)},setBackgroundColor:function(Ht,qt){return this.__setBgOverlayColor("backgroundColor",Ht,qt)},__setBgOverlayImage:function(Ht,qt,Kt,rr){return typeof qt=="string"?g.util.loadImage(qt,function(ir,or){if(ir){var jr=new g.Image(ir,rr);this[Ht]=jr,jr.canvas=this}Kt&&Kt(ir,or)},this,rr&&rr.crossOrigin):(rr&&qt.setOptions(rr),this[Ht]=qt,qt&&(qt.canvas=this),Kt&&Kt(qt,!1)),this},__setBgOverlayColor:function(Ht,qt,Kt){return this[Ht]=qt,this._initGradient(qt,Ht),this._initPattern(qt,Ht,Kt),this},_createCanvasElement:function(){var Ht=Ft();if(!Ht||(Ht.style||(Ht.style={}),typeof Ht.getContext>"u"))throw Gt;return Ht},_initOptions:function(Ht){var qt=this.lowerCanvasEl;this._setOptions(Ht),this.width=this.width||parseInt(qt.width,10)||0,this.height=this.height||parseInt(qt.height,10)||0,this.lowerCanvasEl.style&&(qt.width=this.width,qt.height=this.height,qt.style.width=this.width+"px",qt.style.height=this.height+"px",this.viewportTransform=this.viewportTransform.slice())},_createLowerCanvas:function(Ht){Ht&&Ht.getContext?this.lowerCanvasEl=Ht:this.lowerCanvasEl=g.util.getById(Ht)||this._createCanvasElement(),g.util.addClass(this.lowerCanvasEl,"lower-canvas"),this._originalCanvasStyle=this.lowerCanvasEl.style,this.interactive&&this._applyCanvasStyle(this.lowerCanvasEl),this.contextContainer=this.lowerCanvasEl.getContext("2d")},getWidth:function(){return this.width},getHeight:function(){return this.height},setWidth:function(Ht,qt){return this.setDimensions({width:Ht},qt)},setHeight:function(Ht,qt){return this.setDimensions({height:Ht},qt)},setDimensions:function(Ht,qt){var Kt;qt=qt||{};for(var rr in Ht)Kt=Ht[rr],qt.cssOnly||(this._setBackstoreDimension(rr,Ht[rr]),Kt+="px",this.hasLostContext=!0),qt.backstoreOnly||this._setCssDimension(rr,Kt);return this._isCurrentlyDrawing&&this.freeDrawingBrush&&this.freeDrawingBrush._setBrushStyles(this.contextTop),this._initRetinaScaling(),this.calcOffset(),qt.cssOnly||this.requestRenderAll(),this},_setBackstoreDimension:function(Ht,qt){return this.lowerCanvasEl[Ht]=qt,this.upperCanvasEl&&(this.upperCanvasEl[Ht]=qt),this.cacheCanvasEl&&(this.cacheCanvasEl[Ht]=qt),this[Ht]=qt,this},_setCssDimension:function(Ht,qt){return this.lowerCanvasEl.style[Ht]=qt,this.upperCanvasEl&&(this.upperCanvasEl.style[Ht]=qt),this.wrapperEl&&(this.wrapperEl.style[Ht]=qt),this},getZoom:function(){return this.viewportTransform[0]},setViewportTransform:function(Ht){var qt=this._activeObject,Kt=this.backgroundImage,rr=this.overlayImage,ir,or,jr;for(this.viewportTransform=Ht,or=0,jr=this._objects.length;or<jr;or++)ir=this._objects[or],ir.group||ir.setCoords(!0);return qt&&qt.setCoords(),Kt&&Kt.setCoords(!0),rr&&rr.setCoords(!0),this.calcViewportBoundaries(),this.renderOnAddRemove&&this.requestRenderAll(),this},zoomToPoint:function(Ht,qt){var Kt=Ht,rr=this.viewportTransform.slice(0);Ht=$t(Ht,Lt(this.viewportTransform)),rr[0]=qt,rr[3]=qt;var ir=$t(Ht,rr);return rr[4]+=Kt.x-ir.x,rr[5]+=Kt.y-ir.y,this.setViewportTransform(rr)},setZoom:function(Ht){return this.zoomToPoint(new g.Point(0,0),Ht),this},absolutePan:function(Ht){var qt=this.viewportTransform.slice(0);return qt[4]=-Ht.x,qt[5]=-Ht.y,this.setViewportTransform(qt)},relativePan:function(Ht){return this.absolutePan(new g.Point(-Ht.x-this.viewportTransform[4],-Ht.y-this.viewportTransform[5]))},getElement:function(){return this.lowerCanvasEl},_onObjectAdded:function(Ht){this.stateful&&Ht.setupState(),Ht._set("canvas",this),Ht.setCoords(),this.fire("object:added",{target:Ht}),Ht.fire("added")},_onObjectRemoved:function(Ht){this.fire("object:removed",{target:Ht}),Ht.fire("removed"),delete Ht.canvas},clearContext:function(Ht){return Ht.clearRect(0,0,this.width,this.height),this},getContext:function(){return this.contextContainer},clear:function(){return this.remove.apply(this,this.getObjects()),this.backgroundImage=null,this.overlayImage=null,this.backgroundColor="",this.overlayColor="",this._hasITextHandlers&&(this.off("mouse:up",this._mouseUpITextHandler),this._iTextInstances=null,this._hasITextHandlers=!1),this.clearContext(this.contextContainer),this.fire("canvas:cleared"),this.renderOnAddRemove&&this.requestRenderAll(),this},renderAll:function(){var Ht=this.contextContainer;return this.renderCanvas(Ht,this._objects),this},renderAndReset:function(){this.isRendering=0,this.renderAll()},requestRenderAll:function(){return this.isRendering||(this.isRendering=g.util.requestAnimFrame(this.renderAndResetBound)),this},calcViewportBoundaries:function(){var Ht={},qt=this.width,Kt=this.height,rr=Lt(this.viewportTransform);return Ht.tl=$t({x:0,y:0},rr),Ht.br=$t({x:qt,y:Kt},rr),Ht.tr=new g.Point(Ht.br.x,Ht.tl.y),Ht.bl=new g.Point(Ht.tl.x,Ht.br.y),this.vptCoords=Ht,Ht},cancelRequestedRender:function(){this.isRendering&&(g.util.cancelAnimFrame(this.isRendering),this.isRendering=0)},renderCanvas:function(Ht,qt){var Kt=this.viewportTransform,rr=this.clipPath;this.cancelRequestedRender(),this.calcViewportBoundaries(),this.clearContext(Ht),g.util.setImageSmoothing(Ht,this.imageSmoothingEnabled),this.fire("before:render",{ctx:Ht}),this._renderBackground(Ht),Ht.save(),Ht.transform(Kt[0],Kt[1],Kt[2],Kt[3],Kt[4],Kt[5]),this._renderObjects(Ht,qt),Ht.restore(),!this.controlsAboveOverlay&&this.interactive&&this.drawControls(Ht),rr&&(rr.canvas=this,rr.shouldCache(),rr._transformDone=!0,rr.renderCache({forClipping:!0}),this.drawClipPathOnCanvas(Ht)),this._renderOverlay(Ht),this.controlsAboveOverlay&&this.interactive&&this.drawControls(Ht),this.fire("after:render",{ctx:Ht})},drawClipPathOnCanvas:function(Ht){var qt=this.viewportTransform,Kt=this.clipPath;Ht.save(),Ht.transform(qt[0],qt[1],qt[2],qt[3],qt[4],qt[5]),Ht.globalCompositeOperation="destination-in",Kt.transform(Ht),Ht.scale(1/Kt.zoomX,1/Kt.zoomY),Ht.drawImage(Kt._cacheCanvas,-Kt.cacheTranslationX,-Kt.cacheTranslationY),Ht.restore()},_renderObjects:function(Ht,qt){var Kt,rr;for(Kt=0,rr=qt.length;Kt<rr;++Kt)qt[Kt]&&qt[Kt].render(Ht)},_renderBackgroundOrOverlay:function(Ht,qt){var Kt=this[qt+"Color"],rr=this[qt+"Image"],ir=this.viewportTransform,or=this[qt+"Vpt"];if(!(!Kt&&!rr)){if(Kt){Ht.save(),Ht.beginPath(),Ht.moveTo(0,0),Ht.lineTo(this.width,0),Ht.lineTo(this.width,this.height),Ht.lineTo(0,this.height),Ht.closePath(),Ht.fillStyle=Kt.toLive?Kt.toLive(Ht,this):Kt,or&&Ht.transform(ir[0],ir[1],ir[2],ir[3],ir[4],ir[5]),Ht.transform(1,0,0,1,Kt.offsetX||0,Kt.offsetY||0);var jr=Kt.gradientTransform||Kt.patternTransform;jr&&Ht.transform(jr[0],jr[1],jr[2],jr[3],jr[4],jr[5]),Ht.fill(),Ht.restore()}rr&&(Ht.save(),or&&Ht.transform(ir[0],ir[1],ir[2],ir[3],ir[4],ir[5]),rr.render(Ht),Ht.restore())}},_renderBackground:function(Ht){this._renderBackgroundOrOverlay(Ht,"background")},_renderOverlay:function(Ht){this._renderBackgroundOrOverlay(Ht,"overlay")},getCenter:function(){return{top:this.height/2,left:this.width/2}},getCenterPoint:function(){return new g.Point(this.width/2,this.height/2)},centerObjectH:function(Ht){return this._centerObject(Ht,new g.Point(this.getCenterPoint().x,Ht.getCenterPoint().y))},centerObjectV:function(Ht){return this._centerObject(Ht,new g.Point(Ht.getCenterPoint().x,this.getCenterPoint().y))},centerObject:function(Ht){var qt=this.getCenterPoint();return this._centerObject(Ht,qt)},viewportCenterObject:function(Ht){var qt=this.getVpCenter();return this._centerObject(Ht,qt)},viewportCenterObjectH:function(Ht){var qt=this.getVpCenter();return this._centerObject(Ht,new g.Point(qt.x,Ht.getCenterPoint().y)),this},viewportCenterObjectV:function(Ht){var qt=this.getVpCenter();return this._centerObject(Ht,new g.Point(Ht.getCenterPoint().x,qt.y))},getVpCenter:function(){var Ht=this.getCenterPoint(),qt=Lt(this.viewportTransform);return $t(Ht,qt)},_centerObject:function(Ht,qt){return Ht.setPositionByOrigin(qt,"center","center"),Ht.setCoords(),this.renderOnAddRemove&&this.requestRenderAll(),this},toDatalessJSON:function(Ht){return this.toDatalessObject(Ht)},toObject:function(Ht){return this._toObjectMethod("toObject",Ht)},toDatalessObject:function(Ht){return this._toObjectMethod("toDatalessObject",Ht)},_toObjectMethod:function(Ht,qt){var Kt=this.clipPath,rr={version:g.version,objects:this._toObjects(Ht,qt)};return Kt&&!Kt.excludeFromExport&&(rr.clipPath=this._toObject(this.clipPath,Ht,qt)),Tt(rr,this.__serializeBgOverlay(Ht,qt)),g.util.populateWithProperties(this,rr,qt),rr},_toObjects:function(Ht,qt){return this._objects.filter(function(Kt){return!Kt.excludeFromExport}).map(function(Kt){return this._toObject(Kt,Ht,qt)},this)},_toObject:function(Ht,qt,Kt){var rr;this.includeDefaultValues||(rr=Ht.includeDefaultValues,Ht.includeDefaultValues=!1);var ir=Ht[qt](Kt);return this.includeDefaultValues||(Ht.includeDefaultValues=rr),ir},__serializeBgOverlay:function(Ht,qt){var Kt={},rr=this.backgroundImage,ir=this.overlayImage,or=this.backgroundColor,jr=this.overlayColor;return or&&or.toObject?or.excludeFromExport||(Kt.background=or.toObject(qt)):or&&(Kt.background=or),jr&&jr.toObject?jr.excludeFromExport||(Kt.overlay=jr.toObject(qt)):jr&&(Kt.overlay=jr),rr&&!rr.excludeFromExport&&(Kt.backgroundImage=this._toObject(rr,Ht,qt)),ir&&!ir.excludeFromExport&&(Kt.overlayImage=this._toObject(ir,Ht,qt)),Kt},svgViewportTransformation:!0,toSVG:function(Ht,qt){Ht||(Ht={}),Ht.reviver=qt;var Kt=[];return this._setSVGPreamble(Kt,Ht),this._setSVGHeader(Kt,Ht),this.clipPath&&Kt.push('<g clip-path="url(#'+this.clipPath.clipPathId+`)" >
`),this._setSVGBgOverlayColor(Kt,"background"),this._setSVGBgOverlayImage(Kt,"backgroundImage",qt),this._setSVGObjects(Kt,qt),this.clipPath&&Kt.push(`</g>
`),this._setSVGBgOverlayColor(Kt,"overlay"),this._setSVGBgOverlayImage(Kt,"overlayImage",qt),Kt.push("</svg>"),Kt.join("")},_setSVGPreamble:function(Ht,qt){qt.suppressPreamble||Ht.push('<?xml version="1.0" encoding="',qt.encoding||"UTF-8",`" standalone="no" ?>
`,'<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" ',`"http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
`)},_setSVGHeader:function(Ht,qt){var Kt=qt.width||this.width,rr=qt.height||this.height,ir,or='viewBox="0 0 '+this.width+" "+this.height+'" ',jr=g.Object.NUM_FRACTION_DIGITS;qt.viewBox?or='viewBox="'+qt.viewBox.x+" "+qt.viewBox.y+" "+qt.viewBox.width+" "+qt.viewBox.height+'" ':this.svgViewportTransformation&&(ir=this.viewportTransform,or='viewBox="'+wt(-ir[4]/ir[0],jr)+" "+wt(-ir[5]/ir[3],jr)+" "+wt(this.width/ir[0],jr)+" "+wt(this.height/ir[3],jr)+'" '),Ht.push("<svg ",'xmlns="http://www.w3.org/2000/svg" ','xmlns:xlink="http://www.w3.org/1999/xlink" ','version="1.1" ','width="',Kt,'" ','height="',rr,'" ',or,`xml:space="preserve">
`,"<desc>Created with Fabric.js ",g.version,`</desc>
`,`<defs>
`,this.createSVGFontFacesMarkup(),this.createSVGRefElementsMarkup(),this.createSVGClipPathMarkup(qt),`</defs>
`)},createSVGClipPathMarkup:function(Ht){var qt=this.clipPath;return qt?(qt.clipPathId="CLIPPATH_"+g.Object.__uid++,'<clipPath id="'+qt.clipPathId+`" >
`+this.clipPath.toClipPathSVG(Ht.reviver)+`</clipPath>
`):""},createSVGRefElementsMarkup:function(){var Ht=this,qt=["background","overlay"].map(function(Kt){var rr=Ht[Kt+"Color"];if(rr&&rr.toLive){var ir=Ht[Kt+"Vpt"],or=Ht.viewportTransform,jr={width:Ht.width/(ir?or[0]:1),height:Ht.height/(ir?or[3]:1)};return rr.toSVG(jr,{additionalTransform:ir?g.util.matrixToSVG(or):""})}});return qt.join("")},createSVGFontFacesMarkup:function(){var Ht="",qt={},Kt,rr,ir,or,jr,qr,Yr,vn,ko,Xo=g.fontPaths,zo=[];for(this._objects.forEach(function Uo(No){zo.push(No),No._objects&&No._objects.forEach(Uo)}),vn=0,ko=zo.length;vn<ko;vn++)if(Kt=zo[vn],rr=Kt.fontFamily,!(Kt.type.indexOf("text")===-1||qt[rr]||!Xo[rr])&&(qt[rr]=!0,!!Kt.styles)){ir=Kt.styles;for(jr in ir){or=ir[jr];for(Yr in or)qr=or[Yr],rr=qr.fontFamily,!qt[rr]&&Xo[rr]&&(qt[rr]=!0)}}for(var t0 in qt)Ht+=[`		@font-face {
`,"			font-family: '",t0,`';
`,"			src: url('",Xo[t0],`');
`,`		}
`].join("");return Ht&&(Ht=['	<style type="text/css">',`<![CDATA[
`,Ht,"]]>",`</style>
`].join("")),Ht},_setSVGObjects:function(Ht,qt){var Kt,rr,ir,or=this._objects;for(rr=0,ir=or.length;rr<ir;rr++)Kt=or[rr],!Kt.excludeFromExport&&this._setSVGObject(Ht,Kt,qt)},_setSVGObject:function(Ht,qt,Kt){Ht.push(qt.toSVG(Kt))},_setSVGBgOverlayImage:function(Ht,qt,Kt){this[qt]&&!this[qt].excludeFromExport&&this[qt].toSVG&&Ht.push(this[qt].toSVG(Kt))},_setSVGBgOverlayColor:function(Ht,qt){var Kt=this[qt+"Color"],rr=this.viewportTransform,ir=this.width,or=this.height;if(Kt)if(Kt.toLive){var jr=Kt.repeat,qr=g.util.invertTransform(rr),Yr=this[qt+"Vpt"],vn=Yr?g.util.matrixToSVG(qr):"";Ht.push('<rect transform="'+vn+" translate(",ir/2,",",or/2,')"',' x="',Kt.offsetX-ir/2,'" y="',Kt.offsetY-or/2,'" ','width="',jr==="repeat-y"||jr==="no-repeat"?Kt.source.width:ir,'" height="',jr==="repeat-x"||jr==="no-repeat"?Kt.source.height:or,'" fill="url(#SVGID_'+Kt.id+')"',`></rect>
`)}else Ht.push('<rect x="0" y="0" width="100%" height="100%" ','fill="',Kt,'"',`></rect>
`)},sendToBack:function(Ht){if(!Ht)return this;var qt=this._activeObject,Kt,rr,ir;if(Ht===qt&&Ht.type==="activeSelection")for(ir=qt._objects,Kt=ir.length;Kt--;)rr=ir[Kt],pt(this._objects,rr),this._objects.unshift(rr);else pt(this._objects,Ht),this._objects.unshift(Ht);return this.renderOnAddRemove&&this.requestRenderAll(),this},bringToFront:function(Ht){if(!Ht)return this;var qt=this._activeObject,Kt,rr,ir;if(Ht===qt&&Ht.type==="activeSelection")for(ir=qt._objects,Kt=0;Kt<ir.length;Kt++)rr=ir[Kt],pt(this._objects,rr),this._objects.push(rr);else pt(this._objects,Ht),this._objects.push(Ht);return this.renderOnAddRemove&&this.requestRenderAll(),this},sendBackwards:function(Ht,qt){if(!Ht)return this;var Kt=this._activeObject,rr,ir,or,jr,qr,Yr=0;if(Ht===Kt&&Ht.type==="activeSelection")for(qr=Kt._objects,rr=0;rr<qr.length;rr++)ir=qr[rr],or=this._objects.indexOf(ir),or>0+Yr&&(jr=or-1,pt(this._objects,ir),this._objects.splice(jr,0,ir)),Yr++;else or=this._objects.indexOf(Ht),or!==0&&(jr=this._findNewLowerIndex(Ht,or,qt),pt(this._objects,Ht),this._objects.splice(jr,0,Ht));return this.renderOnAddRemove&&this.requestRenderAll(),this},_findNewLowerIndex:function(Ht,qt,Kt){var rr,ir;if(Kt)for(rr=qt,ir=qt-1;ir>=0;--ir){var or=Ht.intersectsWithObject(this._objects[ir])||Ht.isContainedWithinObject(this._objects[ir])||this._objects[ir].isContainedWithinObject(Ht);if(or){rr=ir;break}}else rr=qt-1;return rr},bringForward:function(Ht,qt){if(!Ht)return this;var Kt=this._activeObject,rr,ir,or,jr,qr,Yr=0;if(Ht===Kt&&Ht.type==="activeSelection")for(qr=Kt._objects,rr=qr.length;rr--;)ir=qr[rr],or=this._objects.indexOf(ir),or<this._objects.length-1-Yr&&(jr=or+1,pt(this._objects,ir),this._objects.splice(jr,0,ir)),Yr++;else or=this._objects.indexOf(Ht),or!==this._objects.length-1&&(jr=this._findNewUpperIndex(Ht,or,qt),pt(this._objects,Ht),this._objects.splice(jr,0,Ht));return this.renderOnAddRemove&&this.requestRenderAll(),this},_findNewUpperIndex:function(Ht,qt,Kt){var rr,ir,or;if(Kt)for(rr=qt,ir=qt+1,or=this._objects.length;ir<or;++ir){var jr=Ht.intersectsWithObject(this._objects[ir])||Ht.isContainedWithinObject(this._objects[ir])||this._objects[ir].isContainedWithinObject(Ht);if(jr){rr=ir;break}}else rr=qt+1;return rr},moveTo:function(Ht,qt){return pt(this._objects,Ht),this._objects.splice(qt,0,Ht),this.renderOnAddRemove&&this.requestRenderAll()},dispose:function(){return this.isRendering&&(g.util.cancelAnimFrame(this.isRendering),this.isRendering=0),this.forEachObject(function(Ht){Ht.dispose&&Ht.dispose()}),this._objects=[],this.backgroundImage&&this.backgroundImage.dispose&&this.backgroundImage.dispose(),this.backgroundImage=null,this.overlayImage&&this.overlayImage.dispose&&this.overlayImage.dispose(),this.overlayImage=null,this._iTextInstances=null,this.contextContainer=null,this.lowerCanvasEl.classList.remove("lower-canvas"),g.util.setStyle(this.lowerCanvasEl,this._originalCanvasStyle),delete this._originalCanvasStyle,this.lowerCanvasEl.setAttribute("width",this.width),this.lowerCanvasEl.setAttribute("height",this.height),g.util.cleanUpJsdomNode(this.lowerCanvasEl),this.lowerCanvasEl=void 0,this},toString:function(){return"#<fabric.Canvas ("+this.complexity()+"): { objects: "+this._objects.length+" }>"}}),Tt(g.StaticCanvas.prototype,g.Observable),Tt(g.StaticCanvas.prototype,g.Collection),Tt(g.StaticCanvas.prototype,g.DataURLExporter),Tt(g.StaticCanvas,{EMPTY_JSON:'{"objects": [], "background": "white"}',supports:function(Ht){var qt=Ft();if(!qt||!qt.getContext)return null;var Kt=qt.getContext("2d");if(!Kt)return null;switch(Ht){case"setLineDash":return typeof Kt.setLineDash<"u";default:return null}}}),g.StaticCanvas.prototype.toJSON=g.StaticCanvas.prototype.toObject,g.isLikelyNode&&(g.StaticCanvas.prototype.createPNGStream=function(){var Ht=jt(this.lowerCanvasEl);return Ht&&Ht.createPNGStream()},g.StaticCanvas.prototype.createJPEGStream=function(Ht){var qt=jt(this.lowerCanvasEl);return qt&&qt.createJPEGStream(Ht)})}(),g.BaseBrush=g.util.createClass({color:"rgb(0, 0, 0)",width:1,shadow:null,strokeLineCap:"round",strokeLineJoin:"round",strokeMiterLimit:10,strokeDashArray:null,limitedToCanvasSize:!1,_setBrushStyles:function(Tt){Tt.strokeStyle=this.color,Tt.lineWidth=this.width,Tt.lineCap=this.strokeLineCap,Tt.miterLimit=this.strokeMiterLimit,Tt.lineJoin=this.strokeLineJoin,Tt.setLineDash(this.strokeDashArray||[])},_saveAndTransform:function(Tt){var Ct=this.canvas.viewportTransform;Tt.save(),Tt.transform(Ct[0],Ct[1],Ct[2],Ct[3],Ct[4],Ct[5])},_setShadow:function(){if(this.shadow){var Tt=this.canvas,Ct=this.shadow,pt=Tt.contextTop,wt=Tt.getZoom();Tt&&Tt._isRetinaScaling()&&(wt*=g.devicePixelRatio),pt.shadowColor=Ct.color,pt.shadowBlur=Ct.blur*wt,pt.shadowOffsetX=Ct.offsetX*wt,pt.shadowOffsetY=Ct.offsetY*wt}},needsFullRender:function(){var Tt=new g.Color(this.color);return Tt.getAlpha()<1||!!this.shadow},_resetShadow:function(){var Tt=this.canvas.contextTop;Tt.shadowColor="",Tt.shadowBlur=Tt.shadowOffsetX=Tt.shadowOffsetY=0},_isOutSideCanvas:function(Tt){return Tt.x<0||Tt.x>this.canvas.getWidth()||Tt.y<0||Tt.y>this.canvas.getHeight()}}),function(){g.PencilBrush=g.util.createClass(g.BaseBrush,{decimate:.4,drawStraightLine:!1,straightLineKey:"shiftKey",initialize:function(Tt){this.canvas=Tt,this._points=[]},needsFullRender:function(){return this.callSuper("needsFullRender")||this._hasStraightLine},_drawSegment:function(Tt,Ct,pt){var wt=Ct.midPointFrom(pt);return Tt.quadraticCurveTo(Ct.x,Ct.y,wt.x,wt.y),wt},onMouseDown:function(Tt,Ct){this.canvas._isMainEvent(Ct.e)&&(this.drawStraightLine=Ct.e[this.straightLineKey],this._prepareForDrawing(Tt),this._captureDrawingPath(Tt),this._render())},onMouseMove:function(Tt,Ct){if(this.canvas._isMainEvent(Ct.e)&&(this.drawStraightLine=Ct.e[this.straightLineKey],!(this.limitedToCanvasSize===!0&&this._isOutSideCanvas(Tt))&&this._captureDrawingPath(Tt)&&this._points.length>1))if(this.needsFullRender())this.canvas.clearContext(this.canvas.contextTop),this._render();else{var pt=this._points,wt=pt.length,$t=this.canvas.contextTop;this._saveAndTransform($t),this.oldEnd&&($t.beginPath(),$t.moveTo(this.oldEnd.x,this.oldEnd.y)),this.oldEnd=this._drawSegment($t,pt[wt-2],pt[wt-1],!0),$t.stroke(),$t.restore()}},onMouseUp:function(Tt){return this.canvas._isMainEvent(Tt.e)?(this.drawStraightLine=!1,this.oldEnd=void 0,this._finalizeAndAddPath(),!1):!0},_prepareForDrawing:function(Tt){var Ct=new g.Point(Tt.x,Tt.y);this._reset(),this._addPoint(Ct),this.canvas.contextTop.moveTo(Ct.x,Ct.y)},_addPoint:function(Tt){return this._points.length>1&&Tt.eq(this._points[this._points.length-1])?!1:(this.drawStraightLine&&this._points.length>1&&(this._hasStraightLine=!0,this._points.pop()),this._points.push(Tt),!0)},_reset:function(){this._points=[],this._setBrushStyles(this.canvas.contextTop),this._setShadow(),this._hasStraightLine=!1},_captureDrawingPath:function(Tt){var Ct=new g.Point(Tt.x,Tt.y);return this._addPoint(Ct)},_render:function(Tt){var Ct,pt,wt=this._points[0],$t=this._points[1];if(Tt=Tt||this.canvas.contextTop,this._saveAndTransform(Tt),Tt.beginPath(),this._points.length===2&&wt.x===$t.x&&wt.y===$t.y){var Lt=this.width/1e3;wt=new g.Point(wt.x,wt.y),$t=new g.Point($t.x,$t.y),wt.x-=Lt,$t.x+=Lt}for(Tt.moveTo(wt.x,wt.y),Ct=1,pt=this._points.length;Ct<pt;Ct++)this._drawSegment(Tt,wt,$t),wt=this._points[Ct],$t=this._points[Ct+1];Tt.lineTo(wt.x,wt.y),Tt.stroke(),Tt.restore()},convertPointsToSVGPath:function(Tt){var Ct=this.width/1e3;return g.util.getSmoothPathFromPoints(Tt,Ct)},_isEmptySVGPath:function(Tt){var Ct=g.util.joinPath(Tt);return Ct==="M 0 0 Q 0 0 0 0 L 0 0"},createPath:function(Tt){var Ct=new g.Path(Tt,{fill:null,stroke:this.color,strokeWidth:this.width,strokeLineCap:this.strokeLineCap,strokeMiterLimit:this.strokeMiterLimit,strokeLineJoin:this.strokeLineJoin,strokeDashArray:this.strokeDashArray});return this.shadow&&(this.shadow.affectStroke=!0,Ct.shadow=new g.Shadow(this.shadow)),Ct},decimatePoints:function(Tt,Ct){if(Tt.length<=2)return Tt;var pt=this.canvas.getZoom(),wt=Math.pow(Ct/pt,2),$t,Lt=Tt.length-1,jt=Tt[0],Ft=[jt],Gt;for($t=1;$t<Lt-1;$t++)Gt=Math.pow(jt.x-Tt[$t].x,2)+Math.pow(jt.y-Tt[$t].y,2),Gt>=wt&&(jt=Tt[$t],Ft.push(jt));return Ft.push(Tt[Lt]),Ft},_finalizeAndAddPath:function(){var Tt=this.canvas.contextTop;Tt.closePath(),this.decimate&&(this._points=this.decimatePoints(this._points,this.decimate));var Ct=this.convertPointsToSVGPath(this._points);if(this._isEmptySVGPath(Ct)){this.canvas.requestRenderAll();return}var pt=this.createPath(Ct);this.canvas.clearContext(this.canvas.contextTop),this.canvas.fire("before:path:created",{path:pt}),this.canvas.add(pt),this.canvas.requestRenderAll(),pt.setCoords(),this._resetShadow(),this.canvas.fire("path:created",{path:pt})}})}(),g.CircleBrush=g.util.createClass(g.BaseBrush,{width:10,initialize:function(Tt){this.canvas=Tt,this.points=[]},drawDot:function(Tt){var Ct=this.addPoint(Tt),pt=this.canvas.contextTop;this._saveAndTransform(pt),this.dot(pt,Ct),pt.restore()},dot:function(Tt,Ct){Tt.fillStyle=Ct.fill,Tt.beginPath(),Tt.arc(Ct.x,Ct.y,Ct.radius,0,Math.PI*2,!1),Tt.closePath(),Tt.fill()},onMouseDown:function(Tt){this.points.length=0,this.canvas.clearContext(this.canvas.contextTop),this._setShadow(),this.drawDot(Tt)},_render:function(){var Tt=this.canvas.contextTop,Ct,pt,wt=this.points;for(this._saveAndTransform(Tt),Ct=0,pt=wt.length;Ct<pt;Ct++)this.dot(Tt,wt[Ct]);Tt.restore()},onMouseMove:function(Tt){this.limitedToCanvasSize===!0&&this._isOutSideCanvas(Tt)||(this.needsFullRender()?(this.canvas.clearContext(this.canvas.contextTop),this.addPoint(Tt),this._render()):this.drawDot(Tt))},onMouseUp:function(){var Tt=this.canvas.renderOnAddRemove,Ct,pt;this.canvas.renderOnAddRemove=!1;var wt=[];for(Ct=0,pt=this.points.length;Ct<pt;Ct++){var $t=this.points[Ct],Lt=new g.Circle({radius:$t.radius,left:$t.x,top:$t.y,originX:"center",originY:"center",fill:$t.fill});this.shadow&&(Lt.shadow=new g.Shadow(this.shadow)),wt.push(Lt)}var jt=new g.Group(wt);jt.canvas=this.canvas,this.canvas.fire("before:path:created",{path:jt}),this.canvas.add(jt),this.canvas.fire("path:created",{path:jt}),this.canvas.clearContext(this.canvas.contextTop),this._resetShadow(),this.canvas.renderOnAddRemove=Tt,this.canvas.requestRenderAll()},addPoint:function(Tt){var Ct=new g.Point(Tt.x,Tt.y),pt=g.util.getRandomInt(Math.max(0,this.width-20),this.width+20)/2,wt=new g.Color(this.color).setAlpha(g.util.getRandomInt(0,100)/100).toRgba();return Ct.radius=pt,Ct.fill=wt,this.points.push(Ct),Ct}}),g.SprayBrush=g.util.createClass(g.BaseBrush,{width:10,density:20,dotWidth:1,dotWidthVariance:1,randomOpacity:!1,optimizeOverlapping:!0,initialize:function(Tt){this.canvas=Tt,this.sprayChunks=[]},onMouseDown:function(Tt){this.sprayChunks.length=0,this.canvas.clearContext(this.canvas.contextTop),this._setShadow(),this.addSprayChunk(Tt),this.render(this.sprayChunkPoints)},onMouseMove:function(Tt){this.limitedToCanvasSize===!0&&this._isOutSideCanvas(Tt)||(this.addSprayChunk(Tt),this.render(this.sprayChunkPoints))},onMouseUp:function(){var Tt=this.canvas.renderOnAddRemove;this.canvas.renderOnAddRemove=!1;for(var Ct=[],pt=0,wt=this.sprayChunks.length;pt<wt;pt++)for(var $t=this.sprayChunks[pt],Lt=0,jt=$t.length;Lt<jt;Lt++){var Ft=new g.Rect({width:$t[Lt].width,height:$t[Lt].width,left:$t[Lt].x+1,top:$t[Lt].y+1,originX:"center",originY:"center",fill:this.color});Ct.push(Ft)}this.optimizeOverlapping&&(Ct=this._getOptimizedRects(Ct));var Gt=new g.Group(Ct);this.shadow&&Gt.set("shadow",new g.Shadow(this.shadow)),this.canvas.fire("before:path:created",{path:Gt}),this.canvas.add(Gt),this.canvas.fire("path:created",{path:Gt}),this.canvas.clearContext(this.canvas.contextTop),this._resetShadow(),this.canvas.renderOnAddRemove=Tt,this.canvas.requestRenderAll()},_getOptimizedRects:function(Tt){var Ct={},pt,wt,$t;for(wt=0,$t=Tt.length;wt<$t;wt++)pt=Tt[wt].left+""+Tt[wt].top,Ct[pt]||(Ct[pt]=Tt[wt]);var Lt=[];for(pt in Ct)Lt.push(Ct[pt]);return Lt},render:function(Tt){var Ct=this.canvas.contextTop,pt,wt;for(Ct.fillStyle=this.color,this._saveAndTransform(Ct),pt=0,wt=Tt.length;pt<wt;pt++){var $t=Tt[pt];typeof $t.opacity<"u"&&(Ct.globalAlpha=$t.opacity),Ct.fillRect($t.x,$t.y,$t.width,$t.width)}Ct.restore()},_render:function(){var Tt=this.canvas.contextTop,Ct,pt;for(Tt.fillStyle=this.color,this._saveAndTransform(Tt),Ct=0,pt=this.sprayChunks.length;Ct<pt;Ct++)this.render(this.sprayChunks[Ct]);Tt.restore()},addSprayChunk:function(Tt){this.sprayChunkPoints=[];var Ct,pt,wt,$t=this.width/2,Lt;for(Lt=0;Lt<this.density;Lt++){Ct=g.util.getRandomInt(Tt.x-$t,Tt.x+$t),pt=g.util.getRandomInt(Tt.y-$t,Tt.y+$t),this.dotWidthVariance?wt=g.util.getRandomInt(Math.max(1,this.dotWidth-this.dotWidthVariance),this.dotWidth+this.dotWidthVariance):wt=this.dotWidth;var jt=new g.Point(Ct,pt);jt.width=wt,this.randomOpacity&&(jt.opacity=g.util.getRandomInt(0,100)/100),this.sprayChunkPoints.push(jt)}this.sprayChunks.push(this.sprayChunkPoints)}}),g.PatternBrush=g.util.createClass(g.PencilBrush,{getPatternSrc:function(){var Tt=20,Ct=5,pt=g.util.createCanvasElement(),wt=pt.getContext("2d");return pt.width=pt.height=Tt+Ct,wt.fillStyle=this.color,wt.beginPath(),wt.arc(Tt/2,Tt/2,Tt/2,0,Math.PI*2,!1),wt.closePath(),wt.fill(),pt},getPatternSrcFunction:function(){return String(this.getPatternSrc).replace("this.color",'"'+this.color+'"')},getPattern:function(Tt){return Tt.createPattern(this.source||this.getPatternSrc(),"repeat")},_setBrushStyles:function(Tt){this.callSuper("_setBrushStyles",Tt),Tt.strokeStyle=this.getPattern(Tt)},createPath:function(Tt){var Ct=this.callSuper("createPath",Tt),pt=Ct._getLeftTopCoords().scalarAdd(Ct.strokeWidth/2);return Ct.stroke=new g.Pattern({source:this.source||this.getPatternSrcFunction(),offsetX:-pt.x,offsetY:-pt.y}),Ct}}),function(){var Tt=g.util.getPointer,Ct=g.util.degreesToRadians,pt=g.util.isTouchEvent;g.Canvas=g.util.createClass(g.StaticCanvas,{initialize:function($t,Lt){Lt||(Lt={}),this.renderAndResetBound=this.renderAndReset.bind(this),this.requestRenderAllBound=this.requestRenderAll.bind(this),this._initStatic($t,Lt),this._initInteractive(),this._createCacheCanvas()},uniformScaling:!0,uniScaleKey:"shiftKey",centeredScaling:!1,centeredRotation:!1,centeredKey:"altKey",altActionKey:"shiftKey",interactive:!0,selection:!0,selectionKey:"shiftKey",altSelectionKey:null,selectionColor:"rgba(100, 100, 255, 0.3)",selectionDashArray:[],selectionBorderColor:"rgba(255, 255, 255, 0.3)",selectionLineWidth:1,selectionFullyContained:!1,hoverCursor:"move",moveCursor:"move",defaultCursor:"default",freeDrawingCursor:"crosshair",notAllowedCursor:"not-allowed",containerClass:"canvas-container",perPixelTargetFind:!1,targetFindTolerance:0,skipTargetFind:!1,isDrawingMode:!1,preserveObjectStacking:!1,snapAngle:0,snapThreshold:null,stopContextMenu:!1,fireRightClick:!1,fireMiddleClick:!1,targets:[],enablePointerEvents:!1,_hoveredTarget:null,_hoveredTargets:[],_initInteractive:function(){this._currentTransform=null,this._groupSelector=null,this._initWrapperElement(),this._createUpperCanvas(),this._initEventListeners(),this._initRetinaScaling(),this.freeDrawingBrush=g.PencilBrush&&new g.PencilBrush(this),this.calcOffset()},_chooseObjectsToRender:function(){var $t=this.getActiveObjects(),Lt,jt,Ft;if($t.length>0&&!this.preserveObjectStacking){jt=[],Ft=[];for(var Gt=0,Ht=this._objects.length;Gt<Ht;Gt++)Lt=this._objects[Gt],$t.indexOf(Lt)===-1?jt.push(Lt):Ft.push(Lt);$t.length>1&&(this._activeObject._objects=Ft),jt.push.apply(jt,Ft)}else jt=this._objects;return jt},renderAll:function(){this.contextTopDirty&&!this._groupSelector&&!this.isDrawingMode&&(this.clearContext(this.contextTop),this.contextTopDirty=!1),this.hasLostContext&&(this.renderTopLayer(this.contextTop),this.hasLostContext=!1);var $t=this.contextContainer;return this.renderCanvas($t,this._chooseObjectsToRender()),this},renderTopLayer:function($t){$t.save(),this.isDrawingMode&&this._isCurrentlyDrawing&&(this.freeDrawingBrush&&this.freeDrawingBrush._render(),this.contextTopDirty=!0),this.selection&&this._groupSelector&&(this._drawSelection($t),this.contextTopDirty=!0),$t.restore()},renderTop:function(){var $t=this.contextTop;return this.clearContext($t),this.renderTopLayer($t),this.fire("after:render"),this},_normalizePointer:function($t,Lt){var jt=$t.calcTransformMatrix(),Ft=g.util.invertTransform(jt),Gt=this.restorePointerVpt(Lt);return g.util.transformPoint(Gt,Ft)},isTargetTransparent:function($t,Lt,jt){if($t.shouldCache()&&$t._cacheCanvas&&$t!==this._activeObject){var Ft=this._normalizePointer($t,{x:Lt,y:jt}),Gt=Math.max($t.cacheTranslationX+Ft.x*$t.zoomX,0),Ht=Math.max($t.cacheTranslationY+Ft.y*$t.zoomY,0),ir=g.util.isTransparent($t._cacheContext,Math.round(Gt),Math.round(Ht),this.targetFindTolerance);return ir}var qt=this.contextCache,Kt=$t.selectionBackgroundColor,rr=this.viewportTransform;$t.selectionBackgroundColor="",this.clearContext(qt),qt.save(),qt.transform(rr[0],rr[1],rr[2],rr[3],rr[4],rr[5]),$t.render(qt),qt.restore(),$t.selectionBackgroundColor=Kt;var ir=g.util.isTransparent(qt,Lt,jt,this.targetFindTolerance);return ir},_isSelectionKeyPressed:function($t){var Lt=!1;return Array.isArray(this.selectionKey)?Lt=!!this.selectionKey.find(function(jt){return $t[jt]===!0}):Lt=$t[this.selectionKey],Lt},_shouldClearSelection:function($t,Lt){var jt=this.getActiveObjects(),Ft=this._activeObject;return!Lt||Lt&&Ft&&jt.length>1&&jt.indexOf(Lt)===-1&&Ft!==Lt&&!this._isSelectionKeyPressed($t)||Lt&&!Lt.evented||Lt&&!Lt.selectable&&Ft&&Ft!==Lt},_shouldCenterTransform:function($t,Lt,jt){if($t){var Ft;return Lt==="scale"||Lt==="scaleX"||Lt==="scaleY"||Lt==="resizing"?Ft=this.centeredScaling||$t.centeredScaling:Lt==="rotate"&&(Ft=this.centeredRotation||$t.centeredRotation),Ft?!jt:jt}},_getOriginFromCorner:function($t,Lt){var jt={x:$t.originX,y:$t.originY};return Lt==="ml"||Lt==="tl"||Lt==="bl"?jt.x="right":(Lt==="mr"||Lt==="tr"||Lt==="br")&&(jt.x="left"),Lt==="tl"||Lt==="mt"||Lt==="tr"?jt.y="bottom":(Lt==="bl"||Lt==="mb"||Lt==="br")&&(jt.y="top"),jt},_getActionFromCorner:function($t,Lt,jt,Ft){if(!Lt||!$t)return"drag";var Gt=Ft.controls[Lt];return Gt.getActionName(jt,Gt,Ft)},_setupCurrentTransform:function($t,Lt,jt){if(Lt){var Ft=this.getPointer($t),Gt=Lt.__corner,Ht=Lt.controls[Gt],qt=jt&&Gt?Ht.getActionHandler($t,Lt,Ht):g.controlsUtils.dragHandler,Kt=this._getActionFromCorner(jt,Gt,$t,Lt),rr=this._getOriginFromCorner(Lt,Gt),ir=$t[this.centeredKey],or={target:Lt,action:Kt,actionHandler:qt,corner:Gt,scaleX:Lt.scaleX,scaleY:Lt.scaleY,skewX:Lt.skewX,skewY:Lt.skewY,offsetX:Ft.x-Lt.left,offsetY:Ft.y-Lt.top,originX:rr.x,originY:rr.y,ex:Ft.x,ey:Ft.y,lastX:Ft.x,lastY:Ft.y,theta:Ct(Lt.angle),width:Lt.width*Lt.scaleX,shiftKey:$t.shiftKey,altKey:ir,original:g.util.saveObjectTransform(Lt)};this._shouldCenterTransform(Lt,Kt,ir)&&(or.originX="center",or.originY="center"),or.original.originX=rr.x,or.original.originY=rr.y,this._currentTransform=or,this._beforeTransform($t)}},setCursor:function($t){this.upperCanvasEl.style.cursor=$t},_drawSelection:function($t){var Lt=this._groupSelector,jt=new g.Point(Lt.ex,Lt.ey),Ft=g.util.transformPoint(jt,this.viewportTransform),Gt=new g.Point(Lt.ex+Lt.left,Lt.ey+Lt.top),Ht=g.util.transformPoint(Gt,this.viewportTransform),qt=Math.min(Ft.x,Ht.x),Kt=Math.min(Ft.y,Ht.y),rr=Math.max(Ft.x,Ht.x),ir=Math.max(Ft.y,Ht.y),or=this.selectionLineWidth/2;this.selectionColor&&($t.fillStyle=this.selectionColor,$t.fillRect(qt,Kt,rr-qt,ir-Kt)),!(!this.selectionLineWidth||!this.selectionBorderColor)&&($t.lineWidth=this.selectionLineWidth,$t.strokeStyle=this.selectionBorderColor,qt+=or,Kt+=or,rr-=or,ir-=or,g.Object.prototype._setLineDash.call(this,$t,this.selectionDashArray),$t.strokeRect(qt,Kt,rr-qt,ir-Kt))},findTarget:function($t,Lt){if(!this.skipTargetFind){var jt=!0,Ft=this.getPointer($t,jt),Gt=this._activeObject,Ht=this.getActiveObjects(),qt,Kt,rr=pt($t),ir=Ht.length>1&&!Lt||Ht.length===1;if(this.targets=[],ir&&Gt._findTargetCorner(Ft,rr)||Ht.length>1&&!Lt&&Gt===this._searchPossibleTargets([Gt],Ft))return Gt;if(Ht.length===1&&Gt===this._searchPossibleTargets([Gt],Ft))if(this.preserveObjectStacking)qt=Gt,Kt=this.targets,this.targets=[];else return Gt;var or=this._searchPossibleTargets(this._objects,Ft);return $t[this.altSelectionKey]&&or&&qt&&or!==qt&&(or=qt,this.targets=Kt),or}},_checkTarget:function($t,Lt,jt){if(Lt&&Lt.visible&&Lt.evented&&Lt.containsPoint($t))if((this.perPixelTargetFind||Lt.perPixelTargetFind)&&!Lt.isEditing){var Ft=this.isTargetTransparent(Lt,jt.x,jt.y);if(!Ft)return!0}else return!0},_searchPossibleTargets:function($t,Lt){for(var jt,Ft=$t.length,Gt;Ft--;){var Ht=$t[Ft],qt=Ht.group?this._normalizePointer(Ht.group,Lt):Lt;if(this._checkTarget(qt,Ht,Lt)){jt=$t[Ft],jt.subTargetCheck&&jt instanceof g.Group&&(Gt=this._searchPossibleTargets(jt._objects,Lt),Gt&&this.targets.push(Gt));break}}return jt},restorePointerVpt:function($t){return g.util.transformPoint($t,g.util.invertTransform(this.viewportTransform))},getPointer:function($t,Lt){if(this._absolutePointer&&!Lt)return this._absolutePointer;if(this._pointer&&Lt)return this._pointer;var jt=Tt($t),Ft=this.upperCanvasEl,Gt=Ft.getBoundingClientRect(),Ht=Gt.width||0,qt=Gt.height||0,Kt;(!Ht||!qt)&&("top"in Gt&&"bottom"in Gt&&(qt=Math.abs(Gt.top-Gt.bottom)),"right"in Gt&&"left"in Gt&&(Ht=Math.abs(Gt.right-Gt.left))),this.calcOffset(),jt.x=jt.x-this._offset.left,jt.y=jt.y-this._offset.top,Lt||(jt=this.restorePointerVpt(jt));var rr=this.getRetinaScaling();return rr!==1&&(jt.x/=rr,jt.y/=rr),Ht===0||qt===0?Kt={width:1,height:1}:Kt={width:Ft.width/Ht,height:Ft.height/qt},{x:jt.x*Kt.width,y:jt.y*Kt.height}},_createUpperCanvas:function(){var $t=this.lowerCanvasEl.className.replace(/\s*lower-canvas\s*/,""),Lt=this.lowerCanvasEl,jt=this.upperCanvasEl;jt?jt.className="":(jt=this._createCanvasElement(),this.upperCanvasEl=jt),g.util.addClass(jt,"upper-canvas "+$t),this.wrapperEl.appendChild(jt),this._copyCanvasStyle(Lt,jt),this._applyCanvasStyle(jt),this.contextTop=jt.getContext("2d")},getTopContext:function(){return this.contextTop},_createCacheCanvas:function(){this.cacheCanvasEl=this._createCanvasElement(),this.cacheCanvasEl.setAttribute("width",this.width),this.cacheCanvasEl.setAttribute("height",this.height),this.contextCache=this.cacheCanvasEl.getContext("2d")},_initWrapperElement:function(){this.wrapperEl=g.util.wrapElement(this.lowerCanvasEl,"div",{class:this.containerClass}),g.util.setStyle(this.wrapperEl,{width:this.width+"px",height:this.height+"px",position:"relative"}),g.util.makeElementUnselectable(this.wrapperEl)},_applyCanvasStyle:function($t){var Lt=this.width||$t.width,jt=this.height||$t.height;g.util.setStyle($t,{position:"absolute",width:Lt+"px",height:jt+"px",left:0,top:0,"touch-action":this.allowTouchScrolling?"manipulation":"none","-ms-touch-action":this.allowTouchScrolling?"manipulation":"none"}),$t.width=Lt,$t.height=jt,g.util.makeElementUnselectable($t)},_copyCanvasStyle:function($t,Lt){Lt.style.cssText=$t.style.cssText},getSelectionContext:function(){return this.contextTop},getSelectionElement:function(){return this.upperCanvasEl},getActiveObject:function(){return this._activeObject},getActiveObjects:function(){var $t=this._activeObject;return $t?$t.type==="activeSelection"&&$t._objects?$t._objects.slice(0):[$t]:[]},_onObjectRemoved:function($t){$t===this._activeObject&&(this.fire("before:selection:cleared",{target:$t}),this._discardActiveObject(),this.fire("selection:cleared",{target:$t}),$t.fire("deselected")),$t===this._hoveredTarget&&(this._hoveredTarget=null,this._hoveredTargets=[]),this.callSuper("_onObjectRemoved",$t)},_fireSelectionEvents:function($t,Lt){var jt=!1,Ft=this.getActiveObjects(),Gt=[],Ht=[];$t.forEach(function(qt){Ft.indexOf(qt)===-1&&(jt=!0,qt.fire("deselected",{e:Lt,target:qt}),Ht.push(qt))}),Ft.forEach(function(qt){$t.indexOf(qt)===-1&&(jt=!0,qt.fire("selected",{e:Lt,target:qt}),Gt.push(qt))}),$t.length>0&&Ft.length>0?jt&&this.fire("selection:updated",{e:Lt,selected:Gt,deselected:Ht}):Ft.length>0?this.fire("selection:created",{e:Lt,selected:Gt}):$t.length>0&&this.fire("selection:cleared",{e:Lt,deselected:Ht})},setActiveObject:function($t,Lt){var jt=this.getActiveObjects();return this._setActiveObject($t,Lt),this._fireSelectionEvents(jt,Lt),this},_setActiveObject:function($t,Lt){return this._activeObject===$t||!this._discardActiveObject(Lt,$t)||$t.onSelect({e:Lt})?!1:(this._activeObject=$t,!0)},_discardActiveObject:function($t,Lt){var jt=this._activeObject;if(jt){if(jt.onDeselect({e:$t,object:Lt}))return!1;this._activeObject=null}return!0},discardActiveObject:function($t){var Lt=this.getActiveObjects(),jt=this.getActiveObject();return Lt.length&&this.fire("before:selection:cleared",{target:jt,e:$t}),this._discardActiveObject($t),this._fireSelectionEvents(Lt,$t),this},dispose:function(){var $t=this.wrapperEl;return this.removeListeners(),$t.removeChild(this.upperCanvasEl),$t.removeChild(this.lowerCanvasEl),this.contextCache=null,this.contextTop=null,["upperCanvasEl","cacheCanvasEl"].forEach((function(Lt){g.util.cleanUpJsdomNode(this[Lt]),this[Lt]=void 0}).bind(this)),$t.parentNode&&$t.parentNode.replaceChild(this.lowerCanvasEl,this.wrapperEl),delete this.wrapperEl,g.StaticCanvas.prototype.dispose.call(this),this},clear:function(){return this.discardActiveObject(),this.clearContext(this.contextTop),this.callSuper("clear")},drawControls:function($t){var Lt=this._activeObject;Lt&&Lt._renderControls($t)},_toObject:function($t,Lt,jt){var Ft=this._realizeGroupTransformOnObject($t),Gt=this.callSuper("_toObject",$t,Lt,jt);return this._unwindGroupTransformOnObject($t,Ft),Gt},_realizeGroupTransformOnObject:function($t){if($t.group&&$t.group.type==="activeSelection"&&this._activeObject===$t.group){var Lt=["angle","flipX","flipY","left","scaleX","scaleY","skewX","skewY","top"],jt={};return Lt.forEach(function(Ft){jt[Ft]=$t[Ft]}),g.util.addTransformToObject($t,this._activeObject.calcOwnMatrix()),jt}else return null},_unwindGroupTransformOnObject:function($t,Lt){Lt&&$t.set(Lt)},_setSVGObject:function($t,Lt,jt){var Ft=this._realizeGroupTransformOnObject(Lt);this.callSuper("_setSVGObject",$t,Lt,jt),this._unwindGroupTransformOnObject(Lt,Ft)},setViewportTransform:function($t){this.renderOnAddRemove&&this._activeObject&&this._activeObject.isEditing&&this._activeObject.clearContextTop(),g.StaticCanvas.prototype.setViewportTransform.call(this,$t)}});for(var wt in g.StaticCanvas)wt!=="prototype"&&(g.Canvas[wt]=g.StaticCanvas[wt])}(),function(){var Tt=g.util.addListener,Ct=g.util.removeListener,pt=3,wt=2,$t=1,Lt={passive:!1};function jt(Ft,Gt){return Ft.button&&Ft.button===Gt-1}g.util.object.extend(g.Canvas.prototype,{mainTouchId:null,_initEventListeners:function(){this.removeListeners(),this._bindEvents(),this.addOrRemove(Tt,"add")},_getEventPrefix:function(){return this.enablePointerEvents?"pointer":"mouse"},addOrRemove:function(Ft,Gt){var Ht=this.upperCanvasEl,qt=this._getEventPrefix();Ft(g.window,"resize",this._onResize),Ft(Ht,qt+"down",this._onMouseDown),Ft(Ht,qt+"move",this._onMouseMove,Lt),Ft(Ht,qt+"out",this._onMouseOut),Ft(Ht,qt+"enter",this._onMouseEnter),Ft(Ht,"wheel",this._onMouseWheel),Ft(Ht,"contextmenu",this._onContextMenu),Ft(Ht,"dblclick",this._onDoubleClick),Ft(Ht,"dragover",this._onDragOver),Ft(Ht,"dragenter",this._onDragEnter),Ft(Ht,"dragleave",this._onDragLeave),Ft(Ht,"drop",this._onDrop),this.enablePointerEvents||Ft(Ht,"touchstart",this._onTouchStart,Lt),typeof eventjs<"u"&&Gt in eventjs&&(eventjs[Gt](Ht,"gesture",this._onGesture),eventjs[Gt](Ht,"drag",this._onDrag),eventjs[Gt](Ht,"orientation",this._onOrientationChange),eventjs[Gt](Ht,"shake",this._onShake),eventjs[Gt](Ht,"longpress",this._onLongPress))},removeListeners:function(){this.addOrRemove(Ct,"remove");var Ft=this._getEventPrefix();Ct(g.document,Ft+"up",this._onMouseUp),Ct(g.document,"touchend",this._onTouchEnd,Lt),Ct(g.document,Ft+"move",this._onMouseMove,Lt),Ct(g.document,"touchmove",this._onMouseMove,Lt)},_bindEvents:function(){this.eventsBound||(this._onMouseDown=this._onMouseDown.bind(this),this._onTouchStart=this._onTouchStart.bind(this),this._onMouseMove=this._onMouseMove.bind(this),this._onMouseUp=this._onMouseUp.bind(this),this._onTouchEnd=this._onTouchEnd.bind(this),this._onResize=this._onResize.bind(this),this._onGesture=this._onGesture.bind(this),this._onDrag=this._onDrag.bind(this),this._onShake=this._onShake.bind(this),this._onLongPress=this._onLongPress.bind(this),this._onOrientationChange=this._onOrientationChange.bind(this),this._onMouseWheel=this._onMouseWheel.bind(this),this._onMouseOut=this._onMouseOut.bind(this),this._onMouseEnter=this._onMouseEnter.bind(this),this._onContextMenu=this._onContextMenu.bind(this),this._onDoubleClick=this._onDoubleClick.bind(this),this._onDragOver=this._onDragOver.bind(this),this._onDragEnter=this._simpleEventHandler.bind(this,"dragenter"),this._onDragLeave=this._simpleEventHandler.bind(this,"dragleave"),this._onDrop=this._onDrop.bind(this),this.eventsBound=!0)},_onGesture:function(Ft,Gt){this.__onTransformGesture&&this.__onTransformGesture(Ft,Gt)},_onDrag:function(Ft,Gt){this.__onDrag&&this.__onDrag(Ft,Gt)},_onMouseWheel:function(Ft){this.__onMouseWheel(Ft)},_onMouseOut:function(Ft){var Gt=this._hoveredTarget;this.fire("mouse:out",{target:Gt,e:Ft}),this._hoveredTarget=null,Gt&&Gt.fire("mouseout",{e:Ft});var Ht=this;this._hoveredTargets.forEach(function(qt){Ht.fire("mouse:out",{target:Gt,e:Ft}),qt&&Gt.fire("mouseout",{e:Ft})}),this._hoveredTargets=[]},_onMouseEnter:function(Ft){!this._currentTransform&&!this.findTarget(Ft)&&(this.fire("mouse:over",{target:null,e:Ft}),this._hoveredTarget=null,this._hoveredTargets=[])},_onOrientationChange:function(Ft,Gt){this.__onOrientationChange&&this.__onOrientationChange(Ft,Gt)},_onShake:function(Ft,Gt){this.__onShake&&this.__onShake(Ft,Gt)},_onLongPress:function(Ft,Gt){this.__onLongPress&&this.__onLongPress(Ft,Gt)},_onDragOver:function(Ft){Ft.preventDefault();var Gt=this._simpleEventHandler("dragover",Ft);this._fireEnterLeaveEvents(Gt,Ft)},_onDrop:function(Ft){return this._simpleEventHandler("drop:before",Ft),this._simpleEventHandler("drop",Ft)},_onContextMenu:function(Ft){return this.stopContextMenu&&(Ft.stopPropagation(),Ft.preventDefault()),!1},_onDoubleClick:function(Ft){this._cacheTransformEventData(Ft),this._handleEvent(Ft,"dblclick"),this._resetTransformEventData(Ft)},getPointerId:function(Ft){var Gt=Ft.changedTouches;return Gt?Gt[0]&&Gt[0].identifier:this.enablePointerEvents?Ft.pointerId:-1},_isMainEvent:function(Ft){return Ft.isPrimary===!0?!0:Ft.isPrimary===!1?!1:Ft.type==="touchend"&&Ft.touches.length===0?!0:Ft.changedTouches?Ft.changedTouches[0].identifier===this.mainTouchId:!0},_onTouchStart:function(Ft){Ft.preventDefault(),this.mainTouchId===null&&(this.mainTouchId=this.getPointerId(Ft)),this.__onMouseDown(Ft),this._resetTransformEventData();var Gt=this.upperCanvasEl,Ht=this._getEventPrefix();Tt(g.document,"touchend",this._onTouchEnd,Lt),Tt(g.document,"touchmove",this._onMouseMove,Lt),Ct(Gt,Ht+"down",this._onMouseDown)},_onMouseDown:function(Ft){this.__onMouseDown(Ft),this._resetTransformEventData();var Gt=this.upperCanvasEl,Ht=this._getEventPrefix();Ct(Gt,Ht+"move",this._onMouseMove,Lt),Tt(g.document,Ht+"up",this._onMouseUp),Tt(g.document,Ht+"move",this._onMouseMove,Lt)},_onTouchEnd:function(Ft){if(!(Ft.touches.length>0)){this.__onMouseUp(Ft),this._resetTransformEventData(),this.mainTouchId=null;var Gt=this._getEventPrefix();Ct(g.document,"touchend",this._onTouchEnd,Lt),Ct(g.document,"touchmove",this._onMouseMove,Lt);var Ht=this;this._willAddMouseDown&&clearTimeout(this._willAddMouseDown),this._willAddMouseDown=setTimeout(function(){Tt(Ht.upperCanvasEl,Gt+"down",Ht._onMouseDown),Ht._willAddMouseDown=0},400)}},_onMouseUp:function(Ft){this.__onMouseUp(Ft),this._resetTransformEventData();var Gt=this.upperCanvasEl,Ht=this._getEventPrefix();this._isMainEvent(Ft)&&(Ct(g.document,Ht+"up",this._onMouseUp),Ct(g.document,Ht+"move",this._onMouseMove,Lt),Tt(Gt,Ht+"move",this._onMouseMove,Lt))},_onMouseMove:function(Ft){!this.allowTouchScrolling&&Ft.preventDefault&&Ft.preventDefault(),this.__onMouseMove(Ft)},_onResize:function(){this.calcOffset()},_shouldRender:function(Ft){var Gt=this._activeObject;return!!Gt!=!!Ft||Gt&&Ft&&Gt!==Ft?!0:(Gt&&Gt.isEditing,!1)},__onMouseUp:function(Ft){var Gt,Ht=this._currentTransform,qt=this._groupSelector,Kt=!1,rr=!qt||qt.left===0&&qt.top===0;if(this._cacheTransformEventData(Ft),Gt=this._target,this._handleEvent(Ft,"up:before"),jt(Ft,pt)){this.fireRightClick&&this._handleEvent(Ft,"up",pt,rr);return}if(jt(Ft,wt)){this.fireMiddleClick&&this._handleEvent(Ft,"up",wt,rr),this._resetTransformEventData();return}if(this.isDrawingMode&&this._isCurrentlyDrawing){this._onMouseUpInDrawingMode(Ft);return}if(this._isMainEvent(Ft)){if(Ht&&(this._finalizeCurrentTransform(Ft),Kt=Ht.actionPerformed),!rr){var ir=Gt===this._activeObject;this._maybeGroupObjects(Ft),Kt||(Kt=this._shouldRender(Gt)||!ir&&Gt===this._activeObject)}var or,jr;if(Gt){if(or=Gt._findTargetCorner(this.getPointer(Ft,!0),g.util.isTouchEvent(Ft)),Gt.selectable&&Gt!==this._activeObject&&Gt.activeOn==="up")this.setActiveObject(Gt,Ft),Kt=!0;else{var qr=Gt.controls[or],Yr=qr&&qr.getMouseUpHandler(Ft,Gt,qr);Yr&&(jr=this.getPointer(Ft),Yr(Ft,Ht,jr.x,jr.y))}Gt.isMoving=!1}if(Ht&&(Ht.target!==Gt||Ht.corner!==or)){var vn=Ht.target&&Ht.target.controls[Ht.corner],ko=vn&&vn.getMouseUpHandler(Ft,Gt,qr);jr=jr||this.getPointer(Ft),ko&&ko(Ft,Ht,jr.x,jr.y)}this._setCursorFromEvent(Ft,Gt),this._handleEvent(Ft,"up",$t,rr),this._groupSelector=null,this._currentTransform=null,Gt&&(Gt.__corner=0),Kt?this.requestRenderAll():rr||this.renderTop()}},_simpleEventHandler:function(Ft,Gt){var Ht=this.findTarget(Gt),qt=this.targets,Kt={e:Gt,target:Ht,subTargets:qt};if(this.fire(Ft,Kt),Ht&&Ht.fire(Ft,Kt),!qt)return Ht;for(var rr=0;rr<qt.length;rr++)qt[rr].fire(Ft,Kt);return Ht},_handleEvent:function(Ft,Gt,Ht,qt){var Kt=this._target,rr=this.targets||[],ir={e:Ft,target:Kt,subTargets:rr,button:Ht||$t,isClick:qt||!1,pointer:this._pointer,absolutePointer:this._absolutePointer,transform:this._currentTransform};Gt==="up"&&(ir.currentTarget=this.findTarget(Ft),ir.currentSubTargets=this.targets),this.fire("mouse:"+Gt,ir),Kt&&Kt.fire("mouse"+Gt,ir);for(var or=0;or<rr.length;or++)rr[or].fire("mouse"+Gt,ir)},_finalizeCurrentTransform:function(Ft){var Gt=this._currentTransform,Ht=Gt.target,qt={e:Ft,target:Ht,transform:Gt,action:Gt.action};Ht._scaling&&(Ht._scaling=!1),Ht.setCoords(),(Gt.actionPerformed||this.stateful&&Ht.hasStateChanged())&&this._fire("modified",qt)},_onMouseDownInDrawingMode:function(Ft){this._isCurrentlyDrawing=!0,this.getActiveObject()&&this.discardActiveObject(Ft).requestRenderAll();var Gt=this.getPointer(Ft);this.freeDrawingBrush.onMouseDown(Gt,{e:Ft,pointer:Gt}),this._handleEvent(Ft,"down")},_onMouseMoveInDrawingMode:function(Ft){if(this._isCurrentlyDrawing){var Gt=this.getPointer(Ft);this.freeDrawingBrush.onMouseMove(Gt,{e:Ft,pointer:Gt})}this.setCursor(this.freeDrawingCursor),this._handleEvent(Ft,"move")},_onMouseUpInDrawingMode:function(Ft){var Gt=this.getPointer(Ft);this._isCurrentlyDrawing=this.freeDrawingBrush.onMouseUp({e:Ft,pointer:Gt}),this._handleEvent(Ft,"up")},__onMouseDown:function(Ft){this._cacheTransformEventData(Ft),this._handleEvent(Ft,"down:before");var Gt=this._target;if(jt(Ft,pt)){this.fireRightClick&&this._handleEvent(Ft,"down",pt);return}if(jt(Ft,wt)){this.fireMiddleClick&&this._handleEvent(Ft,"down",wt);return}if(this.isDrawingMode){this._onMouseDownInDrawingMode(Ft);return}if(this._isMainEvent(Ft)&&!this._currentTransform){var Ht=this._pointer;this._previousPointer=Ht;var qt=this._shouldRender(Gt),Kt=this._shouldGroup(Ft,Gt);if(this._shouldClearSelection(Ft,Gt)?this.discardActiveObject(Ft):Kt&&(this._handleGrouping(Ft,Gt),Gt=this._activeObject),this.selection&&(!Gt||!Gt.selectable&&!Gt.isEditing&&Gt!==this._activeObject)&&(this._groupSelector={ex:this._absolutePointer.x,ey:this._absolutePointer.y,top:0,left:0}),Gt){var rr=Gt===this._activeObject;Gt.selectable&&Gt.activeOn==="down"&&this.setActiveObject(Gt,Ft);var ir=Gt._findTargetCorner(this.getPointer(Ft,!0),g.util.isTouchEvent(Ft));if(Gt.__corner=ir,Gt===this._activeObject&&(ir||!Kt)){this._setupCurrentTransform(Ft,Gt,rr);var or=Gt.controls[ir],Ht=this.getPointer(Ft),jr=or&&or.getMouseDownHandler(Ft,Gt,or);jr&&jr(Ft,this._currentTransform,Ht.x,Ht.y)}}this._handleEvent(Ft,"down"),(qt||Kt)&&this.requestRenderAll()}},_resetTransformEventData:function(){this._target=null,this._pointer=null,this._absolutePointer=null},_cacheTransformEventData:function(Ft){this._resetTransformEventData(),this._pointer=this.getPointer(Ft,!0),this._absolutePointer=this.restorePointerVpt(this._pointer),this._target=this._currentTransform?this._currentTransform.target:this.findTarget(Ft)||null},_beforeTransform:function(Ft){var Gt=this._currentTransform;this.stateful&&Gt.target.saveState(),this.fire("before:transform",{e:Ft,transform:Gt})},__onMouseMove:function(Ft){this._handleEvent(Ft,"move:before"),this._cacheTransformEventData(Ft);var Gt,Ht;if(this.isDrawingMode){this._onMouseMoveInDrawingMode(Ft);return}if(this._isMainEvent(Ft)){var qt=this._groupSelector;qt?(Ht=this._absolutePointer,qt.left=Ht.x-qt.ex,qt.top=Ht.y-qt.ey,this.renderTop()):this._currentTransform?this._transformObject(Ft):(Gt=this.findTarget(Ft)||null,this._setCursorFromEvent(Ft,Gt),this._fireOverOutEvents(Gt,Ft)),this._handleEvent(Ft,"move"),this._resetTransformEventData()}},_fireOverOutEvents:function(Ft,Gt){var Ht=this._hoveredTarget,qt=this._hoveredTargets,Kt=this.targets,rr=Math.max(qt.length,Kt.length);this.fireSyntheticInOutEvents(Ft,Gt,{oldTarget:Ht,evtOut:"mouseout",canvasEvtOut:"mouse:out",evtIn:"mouseover",canvasEvtIn:"mouse:over"});for(var ir=0;ir<rr;ir++)this.fireSyntheticInOutEvents(Kt[ir],Gt,{oldTarget:qt[ir],evtOut:"mouseout",evtIn:"mouseover"});this._hoveredTarget=Ft,this._hoveredTargets=this.targets.concat()},_fireEnterLeaveEvents:function(Ft,Gt){var Ht=this._draggedoverTarget,qt=this._hoveredTargets,Kt=this.targets,rr=Math.max(qt.length,Kt.length);this.fireSyntheticInOutEvents(Ft,Gt,{oldTarget:Ht,evtOut:"dragleave",evtIn:"dragenter"});for(var ir=0;ir<rr;ir++)this.fireSyntheticInOutEvents(Kt[ir],Gt,{oldTarget:qt[ir],evtOut:"dragleave",evtIn:"dragenter"});this._draggedoverTarget=Ft},fireSyntheticInOutEvents:function(Ft,Gt,Ht){var qt,Kt,rr=Ht.oldTarget,ir,or,jr=rr!==Ft,qr=Ht.canvasEvtIn,Yr=Ht.canvasEvtOut;jr&&(qt={e:Gt,target:Ft,previousTarget:rr},Kt={e:Gt,target:rr,nextTarget:Ft}),or=Ft&&jr,ir=rr&&jr,ir&&(Yr&&this.fire(Yr,Kt),rr.fire(Ht.evtOut,Kt)),or&&(qr&&this.fire(qr,qt),Ft.fire(Ht.evtIn,qt))},__onMouseWheel:function(Ft){this._cacheTransformEventData(Ft),this._handleEvent(Ft,"wheel"),this._resetTransformEventData()},_transformObject:function(Ft){var Gt=this.getPointer(Ft),Ht=this._currentTransform;Ht.reset=!1,Ht.shiftKey=Ft.shiftKey,Ht.altKey=Ft[this.centeredKey],this._performTransformAction(Ft,Ht,Gt),Ht.actionPerformed&&this.requestRenderAll()},_performTransformAction:function(Ft,Gt,Ht){var qt=Ht.x,Kt=Ht.y,rr=Gt.action,ir=!1,or=Gt.actionHandler;or&&(ir=or(Ft,Gt,qt,Kt)),rr==="drag"&&ir&&(Gt.target.isMoving=!0,this.setCursor(Gt.target.moveCursor||this.moveCursor)),Gt.actionPerformed=Gt.actionPerformed||ir},_fire:g.controlsUtils.fireEvent,_setCursorFromEvent:function(Ft,Gt){if(!Gt)return this.setCursor(this.defaultCursor),!1;var Ht=Gt.hoverCursor||this.hoverCursor,qt=this._activeObject&&this._activeObject.type==="activeSelection"?this._activeObject:null,Kt=(!qt||!qt.contains(Gt))&&Gt._findTargetCorner(this.getPointer(Ft,!0));Kt?this.setCursor(this.getCornerCursor(Kt,Gt,Ft)):(Gt.subTargetCheck&&this.targets.concat().reverse().map(function(rr){Ht=rr.hoverCursor||Ht}),this.setCursor(Ht))},getCornerCursor:function(Ft,Gt,Ht){var qt=Gt.controls[Ft];return qt.cursorStyleHandler(Ht,qt,Gt)}})}(),function(){var Tt=Math.min,Ct=Math.max;g.util.object.extend(g.Canvas.prototype,{_shouldGroup:function(pt,wt){var $t=this._activeObject;return $t&&this._isSelectionKeyPressed(pt)&&wt&&wt.selectable&&this.selection&&($t!==wt||$t.type==="activeSelection")&&!wt.onSelect({e:pt})},_handleGrouping:function(pt,wt){var $t=this._activeObject;$t.__corner||wt===$t&&(wt=this.findTarget(pt,!0),!wt||!wt.selectable)||($t&&$t.type==="activeSelection"?this._updateActiveSelection(wt,pt):this._createActiveSelection(wt,pt))},_updateActiveSelection:function(pt,wt){var $t=this._activeObject,Lt=$t._objects.slice(0);$t.contains(pt)?($t.removeWithUpdate(pt),this._hoveredTarget=pt,this._hoveredTargets=this.targets.concat(),$t.size()===1&&this._setActiveObject($t.item(0),wt)):($t.addWithUpdate(pt),this._hoveredTarget=$t,this._hoveredTargets=this.targets.concat()),this._fireSelectionEvents(Lt,wt)},_createActiveSelection:function(pt,wt){var $t=this.getActiveObjects(),Lt=this._createGroup(pt);this._hoveredTarget=Lt,this._setActiveObject(Lt,wt),this._fireSelectionEvents($t,wt)},_createGroup:function(pt){var wt=this._objects,$t=wt.indexOf(this._activeObject)<wt.indexOf(pt),Lt=$t?[this._activeObject,pt]:[pt,this._activeObject];return this._activeObject.isEditing&&this._activeObject.exitEditing(),new g.ActiveSelection(Lt,{canvas:this})},_groupSelectedObjects:function(pt){var wt=this._collectObjects(pt),$t;wt.length===1?this.setActiveObject(wt[0],pt):wt.length>1&&($t=new g.ActiveSelection(wt.reverse(),{canvas:this}),this.setActiveObject($t,pt))},_collectObjects:function(pt){for(var wt=[],$t,Lt=this._groupSelector.ex,jt=this._groupSelector.ey,Ft=Lt+this._groupSelector.left,Gt=jt+this._groupSelector.top,Ht=new g.Point(Tt(Lt,Ft),Tt(jt,Gt)),qt=new g.Point(Ct(Lt,Ft),Ct(jt,Gt)),Kt=!this.selectionFullyContained,rr=Lt===Ft&&jt===Gt,ir=this._objects.length;ir--&&($t=this._objects[ir],!(!(!$t||!$t.selectable||!$t.visible)&&(Kt&&$t.intersectsWithRect(Ht,qt,!0)||$t.isContainedWithinRect(Ht,qt,!0)||Kt&&$t.containsPoint(Ht,null,!0)||Kt&&$t.containsPoint(qt,null,!0))&&(wt.push($t),rr))););return wt.length>1&&(wt=wt.filter(function(or){return!or.onSelect({e:pt})})),wt},_maybeGroupObjects:function(pt){this.selection&&this._groupSelector&&this._groupSelectedObjects(pt),this.setCursor(this.defaultCursor),this._groupSelector=null}})}(),function(){g.util.object.extend(g.StaticCanvas.prototype,{toDataURL:function(Tt){Tt||(Tt={});var Ct=Tt.format||"png",pt=Tt.quality||1,wt=(Tt.multiplier||1)*(Tt.enableRetinaScaling?this.getRetinaScaling():1),$t=this.toCanvasElement(wt,Tt);return g.util.toDataURL($t,Ct,pt)},toCanvasElement:function(Tt,Ct){Tt=Tt||1,Ct=Ct||{};var pt=(Ct.width||this.width)*Tt,wt=(Ct.height||this.height)*Tt,$t=this.getZoom(),Lt=this.width,jt=this.height,Ft=$t*Tt,Gt=this.viewportTransform,Ht=(Gt[4]-(Ct.left||0))*Tt,qt=(Gt[5]-(Ct.top||0))*Tt,Kt=this.interactive,rr=[Ft,0,0,Ft,Ht,qt],ir=this.enableRetinaScaling,or=g.util.createCanvasElement(),jr=this.contextTop;return or.width=pt,or.height=wt,this.contextTop=null,this.enableRetinaScaling=!1,this.interactive=!1,this.viewportTransform=rr,this.width=pt,this.height=wt,this.calcViewportBoundaries(),this.renderCanvas(or.getContext("2d"),this._objects),this.viewportTransform=Gt,this.width=Lt,this.height=jt,this.calcViewportBoundaries(),this.interactive=Kt,this.enableRetinaScaling=ir,this.contextTop=jr,or}})}(),g.util.object.extend(g.StaticCanvas.prototype,{loadFromJSON:function(Tt,Ct,pt){if(Tt){var wt=typeof Tt=="string"?JSON.parse(Tt):g.util.object.clone(Tt),$t=this,Lt=wt.clipPath,jt=this.renderOnAddRemove;return this.renderOnAddRemove=!1,delete wt.clipPath,this._enlivenObjects(wt.objects,function(Ft){$t.clear(),$t._setBgOverlay(wt,function(){Lt?$t._enlivenObjects([Lt],function(Gt){$t.clipPath=Gt[0],$t.__setupCanvas.call($t,wt,Ft,jt,Ct)}):$t.__setupCanvas.call($t,wt,Ft,jt,Ct)})},pt),this}},__setupCanvas:function(Tt,Ct,pt,wt){var $t=this;Ct.forEach(function(Lt,jt){$t.insertAt(Lt,jt)}),this.renderOnAddRemove=pt,delete Tt.objects,delete Tt.backgroundImage,delete Tt.overlayImage,delete Tt.background,delete Tt.overlay,this._setOptions(Tt),this.renderAll(),wt&&wt()},_setBgOverlay:function(Tt,Ct){var pt={backgroundColor:!1,overlayColor:!1,backgroundImage:!1,overlayImage:!1};if(!Tt.backgroundImage&&!Tt.overlayImage&&!Tt.background&&!Tt.overlay){Ct&&Ct();return}var wt=function(){pt.backgroundImage&&pt.overlayImage&&pt.backgroundColor&&pt.overlayColor&&Ct&&Ct()};this.__setBgOverlay("backgroundImage",Tt.backgroundImage,pt,wt),this.__setBgOverlay("overlayImage",Tt.overlayImage,pt,wt),this.__setBgOverlay("backgroundColor",Tt.background,pt,wt),this.__setBgOverlay("overlayColor",Tt.overlay,pt,wt)},__setBgOverlay:function(Tt,Ct,pt,wt){var $t=this;if(!Ct){pt[Tt]=!0,wt&&wt();return}Tt==="backgroundImage"||Tt==="overlayImage"?g.util.enlivenObjects([Ct],function(Lt){$t[Tt]=Lt[0],pt[Tt]=!0,wt&&wt()}):this["set"+g.util.string.capitalize(Tt,!0)](Ct,function(){pt[Tt]=!0,wt&&wt()})},_enlivenObjects:function(Tt,Ct,pt){if(!Tt||Tt.length===0){Ct&&Ct([]);return}g.util.enlivenObjects(Tt,function(wt){Ct&&Ct(wt)},null,pt)},_toDataURL:function(Tt,Ct){this.clone(function(pt){Ct(pt.toDataURL(Tt))})},_toDataURLWithMultiplier:function(Tt,Ct,pt){this.clone(function(wt){pt(wt.toDataURLWithMultiplier(Tt,Ct))})},clone:function(Tt,Ct){var pt=JSON.stringify(this.toJSON(Ct));this.cloneWithoutData(function(wt){wt.loadFromJSON(pt,function(){Tt&&Tt(wt)})})},cloneWithoutData:function(Tt){var Ct=g.util.createCanvasElement();Ct.width=this.width,Ct.height=this.height;var pt=new g.Canvas(Ct);this.backgroundImage?(pt.setBackgroundImage(this.backgroundImage.src,function(){pt.renderAll(),Tt&&Tt(pt)}),pt.backgroundImageOpacity=this.backgroundImageOpacity,pt.backgroundImageStretch=this.backgroundImageStretch):Tt&&Tt(pt)}}),function(Tt){var Ct=Tt.fabric||(Tt.fabric={}),pt=Ct.util.object.extend,wt=Ct.util.object.clone,$t=Ct.util.toFixed,Lt=Ct.util.string.capitalize,jt=Ct.util.degreesToRadians,Ft=!Ct.isLikelyNode,Gt=2;Ct.Object||(Ct.Object=Ct.util.createClass(Ct.CommonMethods,{type:"object",originX:"left",originY:"top",top:0,left:0,width:0,height:0,scaleX:1,scaleY:1,flipX:!1,flipY:!1,opacity:1,angle:0,skewX:0,skewY:0,cornerSize:13,touchCornerSize:24,transparentCorners:!0,hoverCursor:null,moveCursor:null,padding:0,borderColor:"rgb(178,204,255)",borderDashArray:null,cornerColor:"rgb(178,204,255)",cornerStrokeColor:null,cornerStyle:"rect",cornerDashArray:null,centeredScaling:!1,centeredRotation:!0,fill:"rgb(0,0,0)",fillRule:"nonzero",globalCompositeOperation:"source-over",backgroundColor:"",selectionBackgroundColor:"",stroke:null,strokeWidth:1,strokeDashArray:null,strokeDashOffset:0,strokeLineCap:"butt",strokeLineJoin:"miter",strokeMiterLimit:4,shadow:null,borderOpacityWhenMoving:.4,borderScaleFactor:1,minScaleLimit:0,selectable:!0,evented:!0,visible:!0,hasControls:!0,hasBorders:!0,perPixelTargetFind:!1,includeDefaultValues:!0,lockMovementX:!1,lockMovementY:!1,lockRotation:!1,lockScalingX:!1,lockScalingY:!1,lockSkewingX:!1,lockSkewingY:!1,lockScalingFlip:!1,excludeFromExport:!1,objectCaching:Ft,statefullCache:!1,noScaleCache:!0,strokeUniform:!1,dirty:!0,__corner:0,paintFirst:"fill",activeOn:"down",stateProperties:"top left width height scaleX scaleY flipX flipY originX originY transformMatrix stroke strokeWidth strokeDashArray strokeLineCap strokeDashOffset strokeLineJoin strokeMiterLimit angle opacity fill globalCompositeOperation shadow visible backgroundColor skewX skewY fillRule paintFirst clipPath strokeUniform".split(" "),cacheProperties:"fill stroke strokeWidth strokeDashArray width height paintFirst strokeUniform strokeLineCap strokeDashOffset strokeLineJoin strokeMiterLimit backgroundColor clipPath".split(" "),colorProperties:"fill stroke backgroundColor".split(" "),clipPath:void 0,inverted:!1,absolutePositioned:!1,initialize:function(Ht){Ht&&this.setOptions(Ht)},_createCacheCanvas:function(){this._cacheProperties={},this._cacheCanvas=Ct.util.createCanvasElement(),this._cacheContext=this._cacheCanvas.getContext("2d"),this._updateCacheCanvas(),this.dirty=!0},_limitCacheSize:function(Ht){var qt=Ct.perfLimitSizeTotal,Kt=Ht.width,rr=Ht.height,ir=Ct.maxCacheSideLimit,or=Ct.minCacheSideLimit;if(Kt<=ir&&rr<=ir&&Kt*rr<=qt)return Kt<or&&(Ht.width=or),rr<or&&(Ht.height=or),Ht;var jr=Kt/rr,qr=Ct.util.limitDimsByArea(jr,qt),Yr=Ct.util.capValue,vn=Yr(or,qr.x,ir),ko=Yr(or,qr.y,ir);return Kt>vn&&(Ht.zoomX/=Kt/vn,Ht.width=vn,Ht.capped=!0),rr>ko&&(Ht.zoomY/=rr/ko,Ht.height=ko,Ht.capped=!0),Ht},_getCacheCanvasDimensions:function(){var Ht=this.getTotalObjectScaling(),qt=this._getTransformedDimensions(0,0),Kt=qt.x*Ht.scaleX/this.scaleX,rr=qt.y*Ht.scaleY/this.scaleY;return{width:Kt+Gt,height:rr+Gt,zoomX:Ht.scaleX,zoomY:Ht.scaleY,x:Kt,y:rr}},_updateCacheCanvas:function(){var Ht=this.canvas;if(this.noScaleCache&&Ht&&Ht._currentTransform){var qt=Ht._currentTransform.target,Kt=Ht._currentTransform.action;if(this===qt&&Kt.slice&&Kt.slice(0,5)==="scale")return!1}var rr=this._cacheCanvas,ir=this._limitCacheSize(this._getCacheCanvasDimensions()),or=Ct.minCacheSideLimit,jr=ir.width,qr=ir.height,Yr,vn,ko=ir.zoomX,Xo=ir.zoomY,zo=jr!==this.cacheWidth||qr!==this.cacheHeight,t0=this.zoomX!==ko||this.zoomY!==Xo,Uo=zo||t0,No=0,_n=0,Kr=!1;if(zo){var e0=this._cacheCanvas.width,Zr=this._cacheCanvas.height,Ro=jr>e0||qr>Zr,Sn=(jr<e0*.9||qr<Zr*.9)&&e0>or&&Zr>or;Kr=Ro||Sn,Ro&&!ir.capped&&(jr>or||qr>or)&&(No=jr*.1,_n=qr*.1)}return this instanceof Ct.Text&&this.path&&(Uo=!0,Kr=!0,No+=this.getHeightOfLine(0)*this.zoomX,_n+=this.getHeightOfLine(0)*this.zoomY),Uo?(Kr?(rr.width=Math.ceil(jr+No),rr.height=Math.ceil(qr+_n)):(this._cacheContext.setTransform(1,0,0,1,0,0),this._cacheContext.clearRect(0,0,rr.width,rr.height)),Yr=ir.x/2,vn=ir.y/2,this.cacheTranslationX=Math.round(rr.width/2-Yr)+Yr,this.cacheTranslationY=Math.round(rr.height/2-vn)+vn,this.cacheWidth=jr,this.cacheHeight=qr,this._cacheContext.translate(this.cacheTranslationX,this.cacheTranslationY),this._cacheContext.scale(ko,Xo),this.zoomX=ko,this.zoomY=Xo,!0):!1},setOptions:function(Ht){this._setOptions(Ht),this._initGradient(Ht.fill,"fill"),this._initGradient(Ht.stroke,"stroke"),this._initPattern(Ht.fill,"fill"),this._initPattern(Ht.stroke,"stroke")},transform:function(Ht){var qt=this.group&&!this.group._transformDone||this.group&&this.canvas&&Ht===this.canvas.contextTop,Kt=this.calcTransformMatrix(!qt);Ht.transform(Kt[0],Kt[1],Kt[2],Kt[3],Kt[4],Kt[5])},toObject:function(Ht){var qt=Ct.Object.NUM_FRACTION_DIGITS,Kt={type:this.type,version:Ct.version,originX:this.originX,originY:this.originY,left:$t(this.left,qt),top:$t(this.top,qt),width:$t(this.width,qt),height:$t(this.height,qt),fill:this.fill&&this.fill.toObject?this.fill.toObject():this.fill,stroke:this.stroke&&this.stroke.toObject?this.stroke.toObject():this.stroke,strokeWidth:$t(this.strokeWidth,qt),strokeDashArray:this.strokeDashArray?this.strokeDashArray.concat():this.strokeDashArray,strokeLineCap:this.strokeLineCap,strokeDashOffset:this.strokeDashOffset,strokeLineJoin:this.strokeLineJoin,strokeUniform:this.strokeUniform,strokeMiterLimit:$t(this.strokeMiterLimit,qt),scaleX:$t(this.scaleX,qt),scaleY:$t(this.scaleY,qt),angle:$t(this.angle,qt),flipX:this.flipX,flipY:this.flipY,opacity:$t(this.opacity,qt),shadow:this.shadow&&this.shadow.toObject?this.shadow.toObject():this.shadow,visible:this.visible,backgroundColor:this.backgroundColor,fillRule:this.fillRule,paintFirst:this.paintFirst,globalCompositeOperation:this.globalCompositeOperation,skewX:$t(this.skewX,qt),skewY:$t(this.skewY,qt)};return this.clipPath&&!this.clipPath.excludeFromExport&&(Kt.clipPath=this.clipPath.toObject(Ht),Kt.clipPath.inverted=this.clipPath.inverted,Kt.clipPath.absolutePositioned=this.clipPath.absolutePositioned),Ct.util.populateWithProperties(this,Kt,Ht),this.includeDefaultValues||(Kt=this._removeDefaultValues(Kt)),Kt},toDatalessObject:function(Ht){return this.toObject(Ht)},_removeDefaultValues:function(Ht){var qt=Ct.util.getKlass(Ht.type).prototype,Kt=qt.stateProperties;return Kt.forEach(function(rr){rr==="left"||rr==="top"||(Ht[rr]===qt[rr]&&delete Ht[rr],Array.isArray(Ht[rr])&&Array.isArray(qt[rr])&&Ht[rr].length===0&&qt[rr].length===0&&delete Ht[rr])}),Ht},toString:function(){return"#<fabric."+Lt(this.type)+">"},getObjectScaling:function(){if(!this.group)return{scaleX:this.scaleX,scaleY:this.scaleY};var Ht=Ct.util.qrDecompose(this.calcTransformMatrix());return{scaleX:Math.abs(Ht.scaleX),scaleY:Math.abs(Ht.scaleY)}},getTotalObjectScaling:function(){var Ht=this.getObjectScaling(),qt=Ht.scaleX,Kt=Ht.scaleY;if(this.canvas){var rr=this.canvas.getZoom(),ir=this.canvas.getRetinaScaling();qt*=rr*ir,Kt*=rr*ir}return{scaleX:qt,scaleY:Kt}},getObjectOpacity:function(){var Ht=this.opacity;return this.group&&(Ht*=this.group.getObjectOpacity()),Ht},_set:function(Ht,qt){var Kt=Ht==="scaleX"||Ht==="scaleY",rr=this[Ht]!==qt,ir=!1;return Kt&&(qt=this._constrainScale(qt)),Ht==="scaleX"&&qt<0?(this.flipX=!this.flipX,qt*=-1):Ht==="scaleY"&&qt<0?(this.flipY=!this.flipY,qt*=-1):Ht==="shadow"&&qt&&!(qt instanceof Ct.Shadow)?qt=new Ct.Shadow(qt):Ht==="dirty"&&this.group&&this.group.set("dirty",qt),this[Ht]=qt,rr&&(ir=this.group&&this.group.isOnACache(),this.cacheProperties.indexOf(Ht)>-1?(this.dirty=!0,ir&&this.group.set("dirty",!0)):ir&&this.stateProperties.indexOf(Ht)>-1&&this.group.set("dirty",!0)),this},setOnGroup:function(){},getViewportTransform:function(){return this.canvas&&this.canvas.viewportTransform?this.canvas.viewportTransform:Ct.iMatrix.concat()},isNotVisible:function(){return this.opacity===0||!this.width&&!this.height&&this.strokeWidth===0||!this.visible},render:function(Ht){this.isNotVisible()||this.canvas&&this.canvas.skipOffscreen&&!this.group&&!this.isOnScreen()||(Ht.save(),this._setupCompositeOperation(Ht),this.drawSelectionBackground(Ht),this.transform(Ht),this._setOpacity(Ht),this._setShadow(Ht,this),this.shouldCache()?(this.renderCache(),this.drawCacheOnCanvas(Ht)):(this._removeCacheCanvas(),this.dirty=!1,this.drawObject(Ht),this.objectCaching&&this.statefullCache&&this.saveState({propertySet:"cacheProperties"})),Ht.restore())},renderCache:function(Ht){Ht=Ht||{},(!this._cacheCanvas||!this._cacheContext)&&this._createCacheCanvas(),this.isCacheDirty()&&(this.statefullCache&&this.saveState({propertySet:"cacheProperties"}),this.drawObject(this._cacheContext,Ht.forClipping),this.dirty=!1)},_removeCacheCanvas:function(){this._cacheCanvas=null,this._cacheContext=null,this.cacheWidth=0,this.cacheHeight=0},hasStroke:function(){return this.stroke&&this.stroke!=="transparent"&&this.strokeWidth!==0},hasFill:function(){return this.fill&&this.fill!=="transparent"},needsItsOwnCache:function(){return!!(this.paintFirst==="stroke"&&this.hasFill()&&this.hasStroke()&&typeof this.shadow=="object"||this.clipPath)},shouldCache:function(){return this.ownCaching=this.needsItsOwnCache()||this.objectCaching&&(!this.group||!this.group.isOnACache()),this.ownCaching},willDrawShadow:function(){return!!this.shadow&&(this.shadow.offsetX!==0||this.shadow.offsetY!==0)},drawClipPathOnCache:function(Ht,qt){if(Ht.save(),qt.inverted?Ht.globalCompositeOperation="destination-out":Ht.globalCompositeOperation="destination-in",qt.absolutePositioned){var Kt=Ct.util.invertTransform(this.calcTransformMatrix());Ht.transform(Kt[0],Kt[1],Kt[2],Kt[3],Kt[4],Kt[5])}qt.transform(Ht),Ht.scale(1/qt.zoomX,1/qt.zoomY),Ht.drawImage(qt._cacheCanvas,-qt.cacheTranslationX,-qt.cacheTranslationY),Ht.restore()},drawObject:function(Ht,qt){var Kt=this.fill,rr=this.stroke;qt?(this.fill="black",this.stroke="",this._setClippingProperties(Ht)):this._renderBackground(Ht),this._render(Ht),this._drawClipPath(Ht,this.clipPath),this.fill=Kt,this.stroke=rr},_drawClipPath:function(Ht,qt){qt&&(qt.canvas=this.canvas,qt.shouldCache(),qt._transformDone=!0,qt.renderCache({forClipping:!0}),this.drawClipPathOnCache(Ht,qt))},drawCacheOnCanvas:function(Ht){Ht.scale(1/this.zoomX,1/this.zoomY),Ht.drawImage(this._cacheCanvas,-this.cacheTranslationX,-this.cacheTranslationY)},isCacheDirty:function(Ht){if(this.isNotVisible())return!1;if(this._cacheCanvas&&this._cacheContext&&!Ht&&this._updateCacheCanvas())return!0;if(this.dirty||this.clipPath&&this.clipPath.absolutePositioned||this.statefullCache&&this.hasStateChanged("cacheProperties")){if(this._cacheCanvas&&this._cacheContext&&!Ht){var qt=this.cacheWidth/this.zoomX,Kt=this.cacheHeight/this.zoomY;this._cacheContext.clearRect(-qt/2,-Kt/2,qt,Kt)}return!0}return!1},_renderBackground:function(Ht){if(this.backgroundColor){var qt=this._getNonTransformedDimensions();Ht.fillStyle=this.backgroundColor,Ht.fillRect(-qt.x/2,-qt.y/2,qt.x,qt.y),this._removeShadow(Ht)}},_setOpacity:function(Ht){this.group&&!this.group._transformDone?Ht.globalAlpha=this.getObjectOpacity():Ht.globalAlpha*=this.opacity},_setStrokeStyles:function(Ht,qt){var Kt=qt.stroke;Kt&&(Ht.lineWidth=qt.strokeWidth,Ht.lineCap=qt.strokeLineCap,Ht.lineDashOffset=qt.strokeDashOffset,Ht.lineJoin=qt.strokeLineJoin,Ht.miterLimit=qt.strokeMiterLimit,Kt.toLive?Kt.gradientUnits==="percentage"||Kt.gradientTransform||Kt.patternTransform?this._applyPatternForTransformedGradient(Ht,Kt):(Ht.strokeStyle=Kt.toLive(Ht,this),this._applyPatternGradientTransform(Ht,Kt)):Ht.strokeStyle=qt.stroke)},_setFillStyles:function(Ht,qt){var Kt=qt.fill;Kt&&(Kt.toLive?(Ht.fillStyle=Kt.toLive(Ht,this),this._applyPatternGradientTransform(Ht,qt.fill)):Ht.fillStyle=Kt)},_setClippingProperties:function(Ht){Ht.globalAlpha=1,Ht.strokeStyle="transparent",Ht.fillStyle="#000000"},_setLineDash:function(Ht,qt){!qt||qt.length===0||(1&qt.length&&qt.push.apply(qt,qt),Ht.setLineDash(qt))},_renderControls:function(Ht,qt){var Kt=this.getViewportTransform(),rr=this.calcTransformMatrix(),ir,or,jr;qt=qt||{},or=typeof qt.hasBorders<"u"?qt.hasBorders:this.hasBorders,jr=typeof qt.hasControls<"u"?qt.hasControls:this.hasControls,rr=Ct.util.multiplyTransformMatrices(Kt,rr),ir=Ct.util.qrDecompose(rr),Ht.save(),Ht.translate(ir.translateX,ir.translateY),Ht.lineWidth=1*this.borderScaleFactor,this.group||(Ht.globalAlpha=this.isMoving?this.borderOpacityWhenMoving:1),this.flipX&&(ir.angle-=180),Ht.rotate(jt(this.group?ir.angle:this.angle)),qt.forActiveSelection||this.group?or&&this.drawBordersInGroup(Ht,ir,qt):or&&this.drawBorders(Ht,qt),jr&&this.drawControls(Ht,qt),Ht.restore()},_setShadow:function(Ht){if(this.shadow){var qt=this.shadow,Kt=this.canvas,rr,ir=Kt&&Kt.viewportTransform[0]||1,or=Kt&&Kt.viewportTransform[3]||1;qt.nonScaling?rr={scaleX:1,scaleY:1}:rr=this.getObjectScaling(),Kt&&Kt._isRetinaScaling()&&(ir*=Ct.devicePixelRatio,or*=Ct.devicePixelRatio),Ht.shadowColor=qt.color,Ht.shadowBlur=qt.blur*Ct.browserShadowBlurConstant*(ir+or)*(rr.scaleX+rr.scaleY)/4,Ht.shadowOffsetX=qt.offsetX*ir*rr.scaleX,Ht.shadowOffsetY=qt.offsetY*or*rr.scaleY}},_removeShadow:function(Ht){this.shadow&&(Ht.shadowColor="",Ht.shadowBlur=Ht.shadowOffsetX=Ht.shadowOffsetY=0)},_applyPatternGradientTransform:function(Ht,qt){if(!qt||!qt.toLive)return{offsetX:0,offsetY:0};var Kt=qt.gradientTransform||qt.patternTransform,rr=-this.width/2+qt.offsetX||0,ir=-this.height/2+qt.offsetY||0;return qt.gradientUnits==="percentage"?Ht.transform(this.width,0,0,this.height,rr,ir):Ht.transform(1,0,0,1,rr,ir),Kt&&Ht.transform(Kt[0],Kt[1],Kt[2],Kt[3],Kt[4],Kt[5]),{offsetX:rr,offsetY:ir}},_renderPaintInOrder:function(Ht){this.paintFirst==="stroke"?(this._renderStroke(Ht),this._renderFill(Ht)):(this._renderFill(Ht),this._renderStroke(Ht))},_render:function(){},_renderFill:function(Ht){this.fill&&(Ht.save(),this._setFillStyles(Ht,this),this.fillRule==="evenodd"?Ht.fill("evenodd"):Ht.fill(),Ht.restore())},_renderStroke:function(Ht){if(!(!this.stroke||this.strokeWidth===0)){if(this.shadow&&!this.shadow.affectStroke&&this._removeShadow(Ht),Ht.save(),this.strokeUniform&&this.group){var qt=this.getObjectScaling();Ht.scale(1/qt.scaleX,1/qt.scaleY)}else this.strokeUniform&&Ht.scale(1/this.scaleX,1/this.scaleY);this._setLineDash(Ht,this.strokeDashArray),this._setStrokeStyles(Ht,this),Ht.stroke(),Ht.restore()}},_applyPatternForTransformedGradient:function(Ht,qt){var Kt=this._limitCacheSize(this._getCacheCanvasDimensions()),rr=Ct.util.createCanvasElement(),ir,or=this.canvas.getRetinaScaling(),jr=Kt.x/this.scaleX/or,qr=Kt.y/this.scaleY/or;rr.width=jr,rr.height=qr,ir=rr.getContext("2d"),ir.beginPath(),ir.moveTo(0,0),ir.lineTo(jr,0),ir.lineTo(jr,qr),ir.lineTo(0,qr),ir.closePath(),ir.translate(jr/2,qr/2),ir.scale(Kt.zoomX/this.scaleX/or,Kt.zoomY/this.scaleY/or),this._applyPatternGradientTransform(ir,qt),ir.fillStyle=qt.toLive(Ht),ir.fill(),Ht.translate(-this.width/2-this.strokeWidth/2,-this.height/2-this.strokeWidth/2),Ht.scale(or*this.scaleX/Kt.zoomX,or*this.scaleY/Kt.zoomY),Ht.strokeStyle=ir.createPattern(rr,"no-repeat")},_findCenterFromElement:function(){return{x:this.left+this.width/2,y:this.top+this.height/2}},_assignTransformMatrixProps:function(){if(this.transformMatrix){var Ht=Ct.util.qrDecompose(this.transformMatrix);this.flipX=!1,this.flipY=!1,this.set("scaleX",Ht.scaleX),this.set("scaleY",Ht.scaleY),this.angle=Ht.angle,this.skewX=Ht.skewX,this.skewY=0}},_removeTransformMatrix:function(Ht){var qt=this._findCenterFromElement();this.transformMatrix&&(this._assignTransformMatrixProps(),qt=Ct.util.transformPoint(qt,this.transformMatrix)),this.transformMatrix=null,Ht&&(this.scaleX*=Ht.scaleX,this.scaleY*=Ht.scaleY,this.cropX=Ht.cropX,this.cropY=Ht.cropY,qt.x+=Ht.offsetLeft,qt.y+=Ht.offsetTop,this.width=Ht.width,this.height=Ht.height),this.setPositionByOrigin(qt,"center","center")},clone:function(Ht,qt){var Kt=this.toObject(qt);this.constructor.fromObject?this.constructor.fromObject(Kt,Ht):Ct.Object._fromObject("Object",Kt,Ht)},cloneAsImage:function(Ht,qt){var Kt=this.toCanvasElement(qt);return Ht&&Ht(new Ct.Image(Kt)),this},toCanvasElement:function(Ht){Ht||(Ht={});var qt=Ct.util,Kt=qt.saveObjectTransform(this),rr=this.group,ir=this.shadow,or=Math.abs,jr=(Ht.multiplier||1)*(Ht.enableRetinaScaling?Ct.devicePixelRatio:1);delete this.group,Ht.withoutTransform&&qt.resetObjectTransform(this),Ht.withoutShadow&&(this.shadow=null);var qr=Ct.util.createCanvasElement(),Yr=this.getBoundingRect(!0,!0),vn=this.shadow,ko,Xo={x:0,y:0},zo,t0,Uo;vn&&(zo=vn.blur,vn.nonScaling?ko={scaleX:1,scaleY:1}:ko=this.getObjectScaling(),Xo.x=2*Math.round(or(vn.offsetX)+zo)*or(ko.scaleX),Xo.y=2*Math.round(or(vn.offsetY)+zo)*or(ko.scaleY)),t0=Yr.width+Xo.x,Uo=Yr.height+Xo.y,qr.width=Math.ceil(t0),qr.height=Math.ceil(Uo);var No=new Ct.StaticCanvas(qr,{enableRetinaScaling:!1,renderOnAddRemove:!1,skipOffscreen:!1});Ht.format==="jpeg"&&(No.backgroundColor="#fff"),this.setPositionByOrigin(new Ct.Point(No.width/2,No.height/2),"center","center");var _n=this.canvas;No.add(this);var Kr=No.toCanvasElement(jr||1,Ht);return this.shadow=ir,this.set("canvas",_n),rr&&(this.group=rr),this.set(Kt).setCoords(),No._objects=[],No.dispose(),No=null,Kr},toDataURL:function(Ht){return Ht||(Ht={}),Ct.util.toDataURL(this.toCanvasElement(Ht),Ht.format||"png",Ht.quality||1)},isType:function(Ht){return arguments.length>1?Array.from(arguments).includes(this.type):this.type===Ht},complexity:function(){return 1},toJSON:function(Ht){return this.toObject(Ht)},rotate:function(Ht){var qt=(this.originX!=="center"||this.originY!=="center")&&this.centeredRotation;return qt&&this._setOriginToCenter(),this.set("angle",Ht),qt&&this._resetOrigin(),this},centerH:function(){return this.canvas&&this.canvas.centerObjectH(this),this},viewportCenterH:function(){return this.canvas&&this.canvas.viewportCenterObjectH(this),this},centerV:function(){return this.canvas&&this.canvas.centerObjectV(this),this},viewportCenterV:function(){return this.canvas&&this.canvas.viewportCenterObjectV(this),this},center:function(){return this.canvas&&this.canvas.centerObject(this),this},viewportCenter:function(){return this.canvas&&this.canvas.viewportCenterObject(this),this},getLocalPointer:function(Ht,qt){qt=qt||this.canvas.getPointer(Ht);var Kt=new Ct.Point(qt.x,qt.y),rr=this._getLeftTopCoords();return this.angle&&(Kt=Ct.util.rotatePoint(Kt,rr,jt(-this.angle))),{x:Kt.x-rr.x,y:Kt.y-rr.y}},_setupCompositeOperation:function(Ht){this.globalCompositeOperation&&(Ht.globalCompositeOperation=this.globalCompositeOperation)},dispose:function(){Ct.runningAnimations&&Ct.runningAnimations.cancelByTarget(this)}}),Ct.util.createAccessors&&Ct.util.createAccessors(Ct.Object),pt(Ct.Object.prototype,Ct.Observable),Ct.Object.NUM_FRACTION_DIGITS=2,Ct.Object.ENLIVEN_PROPS=["clipPath"],Ct.Object._fromObject=function(Ht,qt,Kt,rr){var ir=Ct[Ht];qt=wt(qt,!0),Ct.util.enlivenPatterns([qt.fill,qt.stroke],function(or){typeof or[0]<"u"&&(qt.fill=or[0]),typeof or[1]<"u"&&(qt.stroke=or[1]),Ct.util.enlivenObjectEnlivables(qt,qt,function(){var jr=rr?new ir(qt[rr],qt):new ir(qt);Kt&&Kt(jr)})})},Ct.Object.__uid=0)}(d),function(){var Tt=g.util.degreesToRadians,Ct={left:-.5,center:0,right:.5},pt={top:-.5,center:0,bottom:.5};g.util.object.extend(g.Object.prototype,{translateToGivenOrigin:function(wt,$t,Lt,jt,Ft){var Gt=wt.x,Ht=wt.y,qt,Kt,rr;return typeof $t=="string"?$t=Ct[$t]:$t-=.5,typeof jt=="string"?jt=Ct[jt]:jt-=.5,qt=jt-$t,typeof Lt=="string"?Lt=pt[Lt]:Lt-=.5,typeof Ft=="string"?Ft=pt[Ft]:Ft-=.5,Kt=Ft-Lt,(qt||Kt)&&(rr=this._getTransformedDimensions(),Gt=wt.x+qt*rr.x,Ht=wt.y+Kt*rr.y),new g.Point(Gt,Ht)},translateToCenterPoint:function(wt,$t,Lt){var jt=this.translateToGivenOrigin(wt,$t,Lt,"center","center");return this.angle?g.util.rotatePoint(jt,wt,Tt(this.angle)):jt},translateToOriginPoint:function(wt,$t,Lt){var jt=this.translateToGivenOrigin(wt,"center","center",$t,Lt);return this.angle?g.util.rotatePoint(jt,wt,Tt(this.angle)):jt},getCenterPoint:function(){var wt=new g.Point(this.left,this.top);return this.translateToCenterPoint(wt,this.originX,this.originY)},getPointByOrigin:function(wt,$t){var Lt=this.getCenterPoint();return this.translateToOriginPoint(Lt,wt,$t)},toLocalPoint:function(wt,$t,Lt){var jt=this.getCenterPoint(),Ft,Gt;return typeof $t<"u"&&typeof Lt<"u"?Ft=this.translateToGivenOrigin(jt,"center","center",$t,Lt):Ft=new g.Point(this.left,this.top),Gt=new g.Point(wt.x,wt.y),this.angle&&(Gt=g.util.rotatePoint(Gt,jt,-Tt(this.angle))),Gt.subtractEquals(Ft)},setPositionByOrigin:function(wt,$t,Lt){var jt=this.translateToCenterPoint(wt,$t,Lt),Ft=this.translateToOriginPoint(jt,this.originX,this.originY);this.set("left",Ft.x),this.set("top",Ft.y)},adjustPosition:function(wt){var $t=Tt(this.angle),Lt=this.getScaledWidth(),jt=g.util.cos($t)*Lt,Ft=g.util.sin($t)*Lt,Gt,Ht;typeof this.originX=="string"?Gt=Ct[this.originX]:Gt=this.originX-.5,typeof wt=="string"?Ht=Ct[wt]:Ht=wt-.5,this.left+=jt*(Ht-Gt),this.top+=Ft*(Ht-Gt),this.setCoords(),this.originX=wt},_setOriginToCenter:function(){this._originalOriginX=this.originX,this._originalOriginY=this.originY;var wt=this.getCenterPoint();this.originX="center",this.originY="center",this.left=wt.x,this.top=wt.y},_resetOrigin:function(){var wt=this.translateToOriginPoint(this.getCenterPoint(),this._originalOriginX,this._originalOriginY);this.originX=this._originalOriginX,this.originY=this._originalOriginY,this.left=wt.x,this.top=wt.y,this._originalOriginX=null,this._originalOriginY=null},_getLeftTopCoords:function(){return this.translateToOriginPoint(this.getCenterPoint(),"left","top")}})}(),function(){function Tt(Lt){return[new g.Point(Lt.tl.x,Lt.tl.y),new g.Point(Lt.tr.x,Lt.tr.y),new g.Point(Lt.br.x,Lt.br.y),new g.Point(Lt.bl.x,Lt.bl.y)]}var Ct=g.util,pt=Ct.degreesToRadians,wt=Ct.multiplyTransformMatrices,$t=Ct.transformPoint;Ct.object.extend(g.Object.prototype,{oCoords:null,aCoords:null,lineCoords:null,ownMatrixCache:null,matrixCache:null,controls:{},_getCoords:function(Lt,jt){return jt?Lt?this.calcACoords():this.calcLineCoords():((!this.aCoords||!this.lineCoords)&&this.setCoords(!0),Lt?this.aCoords:this.lineCoords)},getCoords:function(Lt,jt){return Tt(this._getCoords(Lt,jt))},intersectsWithRect:function(Lt,jt,Ft,Gt){var Ht=this.getCoords(Ft,Gt),qt=g.Intersection.intersectPolygonRectangle(Ht,Lt,jt);return qt.status==="Intersection"},intersectsWithObject:function(Lt,jt,Ft){var Gt=g.Intersection.intersectPolygonPolygon(this.getCoords(jt,Ft),Lt.getCoords(jt,Ft));return Gt.status==="Intersection"||Lt.isContainedWithinObject(this,jt,Ft)||this.isContainedWithinObject(Lt,jt,Ft)},isContainedWithinObject:function(Lt,jt,Ft){for(var Gt=this.getCoords(jt,Ft),Ht=jt?Lt.aCoords:Lt.lineCoords,qt=0,Kt=Lt._getImageLines(Ht);qt<4;qt++)if(!Lt.containsPoint(Gt[qt],Kt))return!1;return!0},isContainedWithinRect:function(Lt,jt,Ft,Gt){var Ht=this.getBoundingRect(Ft,Gt);return Ht.left>=Lt.x&&Ht.left+Ht.width<=jt.x&&Ht.top>=Lt.y&&Ht.top+Ht.height<=jt.y},containsPoint:function(Lt,qt,Ft,Gt){var Ht=this._getCoords(Ft,Gt),qt=qt||this._getImageLines(Ht),Kt=this._findCrossPoints(Lt,qt);return Kt!==0&&Kt%2===1},isOnScreen:function(Lt){if(!this.canvas)return!1;var jt=this.canvas.vptCoords.tl,Ft=this.canvas.vptCoords.br,Gt=this.getCoords(!0,Lt);return Gt.some(function(Ht){return Ht.x<=Ft.x&&Ht.x>=jt.x&&Ht.y<=Ft.y&&Ht.y>=jt.y})||this.intersectsWithRect(jt,Ft,!0,Lt)?!0:this._containsCenterOfCanvas(jt,Ft,Lt)},_containsCenterOfCanvas:function(Lt,jt,Ft){var Gt={x:(Lt.x+jt.x)/2,y:(Lt.y+jt.y)/2};return!!this.containsPoint(Gt,null,!0,Ft)},isPartiallyOnScreen:function(Lt){if(!this.canvas)return!1;var jt=this.canvas.vptCoords.tl,Ft=this.canvas.vptCoords.br;if(this.intersectsWithRect(jt,Ft,!0,Lt))return!0;var Gt=this.getCoords(!0,Lt).every(function(Ht){return(Ht.x>=Ft.x||Ht.x<=jt.x)&&(Ht.y>=Ft.y||Ht.y<=jt.y)});return Gt&&this._containsCenterOfCanvas(jt,Ft,Lt)},_getImageLines:function(Lt){var jt={topline:{o:Lt.tl,d:Lt.tr},rightline:{o:Lt.tr,d:Lt.br},bottomline:{o:Lt.br,d:Lt.bl},leftline:{o:Lt.bl,d:Lt.tl}};return jt},_findCrossPoints:function(Lt,jt){var Ft,Gt,Ht,qt,Kt,rr=0,ir;for(var or in jt)if(ir=jt[or],!(ir.o.y<Lt.y&&ir.d.y<Lt.y)&&!(ir.o.y>=Lt.y&&ir.d.y>=Lt.y)&&(ir.o.x===ir.d.x&&ir.o.x>=Lt.x?Kt=ir.o.x:(Ft=0,Gt=(ir.d.y-ir.o.y)/(ir.d.x-ir.o.x),Ht=Lt.y-Ft*Lt.x,qt=ir.o.y-Gt*ir.o.x,Kt=-(Ht-qt)/(Ft-Gt)),Kt>=Lt.x&&(rr+=1),rr===2))break;return rr},getBoundingRect:function(Lt,jt){var Ft=this.getCoords(Lt,jt);return Ct.makeBoundingBoxFromPoints(Ft)},getScaledWidth:function(){return this._getTransformedDimensions().x},getScaledHeight:function(){return this._getTransformedDimensions().y},_constrainScale:function(Lt){return Math.abs(Lt)<this.minScaleLimit?Lt<0?-this.minScaleLimit:this.minScaleLimit:Lt===0?1e-4:Lt},scale:function(Lt){return this._set("scaleX",Lt),this._set("scaleY",Lt),this.setCoords()},scaleToWidth:function(Lt,jt){var Ft=this.getBoundingRect(jt).width/this.getScaledWidth();return this.scale(Lt/this.width/Ft)},scaleToHeight:function(Lt,jt){var Ft=this.getBoundingRect(jt).height/this.getScaledHeight();return this.scale(Lt/this.height/Ft)},calcLineCoords:function(){var Lt=this.getViewportTransform(),jt=this.padding,Ft=pt(this.angle),Gt=Ct.cos(Ft),Ht=Ct.sin(Ft),qt=Gt*jt,Kt=Ht*jt,rr=qt+Kt,ir=qt-Kt,or=this.calcACoords(),jr={tl:$t(or.tl,Lt),tr:$t(or.tr,Lt),bl:$t(or.bl,Lt),br:$t(or.br,Lt)};return jt&&(jr.tl.x-=ir,jr.tl.y-=rr,jr.tr.x+=rr,jr.tr.y-=ir,jr.bl.x-=rr,jr.bl.y+=ir,jr.br.x+=ir,jr.br.y+=rr),jr},calcOCoords:function(){var Lt=this._calcRotateMatrix(),jt=this._calcTranslateMatrix(),Ft=this.getViewportTransform(),Gt=wt(Ft,jt),Ht=wt(Gt,Lt),Ht=wt(Ht,[1/Ft[0],0,0,1/Ft[3],0,0]),qt=this._calculateCurrentDimensions(),Kt={};return this.forEachControl(function(rr,ir,or){Kt[ir]=rr.positionHandler(qt,Ht,or)}),Kt},calcACoords:function(){var Lt=this._calcRotateMatrix(),jt=this._calcTranslateMatrix(),Ft=wt(jt,Lt),Gt=this._getTransformedDimensions(),Ht=Gt.x/2,qt=Gt.y/2;return{tl:$t({x:-Ht,y:-qt},Ft),tr:$t({x:Ht,y:-qt},Ft),bl:$t({x:-Ht,y:qt},Ft),br:$t({x:Ht,y:qt},Ft)}},setCoords:function(Lt){return this.aCoords=this.calcACoords(),this.lineCoords=this.group?this.aCoords:this.calcLineCoords(),Lt?this:(this.oCoords=this.calcOCoords(),this._setCornerCoords&&this._setCornerCoords(),this)},_calcRotateMatrix:function(){return Ct.calcRotateMatrix(this)},_calcTranslateMatrix:function(){var Lt=this.getCenterPoint();return[1,0,0,1,Lt.x,Lt.y]},transformMatrixKey:function(Lt){var jt="_",Ft="";return!Lt&&this.group&&(Ft=this.group.transformMatrixKey(Lt)+jt),Ft+this.top+jt+this.left+jt+this.scaleX+jt+this.scaleY+jt+this.skewX+jt+this.skewY+jt+this.angle+jt+this.originX+jt+this.originY+jt+this.width+jt+this.height+jt+this.strokeWidth+this.flipX+this.flipY},calcTransformMatrix:function(Lt){var jt=this.calcOwnMatrix();if(Lt||!this.group)return jt;var Ft=this.transformMatrixKey(Lt),Gt=this.matrixCache||(this.matrixCache={});return Gt.key===Ft?Gt.value:(this.group&&(jt=wt(this.group.calcTransformMatrix(!1),jt)),Gt.key=Ft,Gt.value=jt,jt)},calcOwnMatrix:function(){var Lt=this.transformMatrixKey(!0),jt=this.ownMatrixCache||(this.ownMatrixCache={});if(jt.key===Lt)return jt.value;var Ft=this._calcTranslateMatrix(),Gt={angle:this.angle,translateX:Ft[4],translateY:Ft[5],scaleX:this.scaleX,scaleY:this.scaleY,skewX:this.skewX,skewY:this.skewY,flipX:this.flipX,flipY:this.flipY};return jt.key=Lt,jt.value=Ct.composeMatrix(Gt),jt.value},_getNonTransformedDimensions:function(){var Lt=this.strokeWidth,jt=this.width+Lt,Ft=this.height+Lt;return{x:jt,y:Ft}},_getTransformedDimensions:function(Lt,jt){typeof Lt>"u"&&(Lt=this.skewX),typeof jt>"u"&&(jt=this.skewY);var Ft,Gt,Ht,qt=Lt===0&&jt===0;if(this.strokeUniform?(Gt=this.width,Ht=this.height):(Ft=this._getNonTransformedDimensions(),Gt=Ft.x,Ht=Ft.y),qt)return this._finalizeDimensions(Gt*this.scaleX,Ht*this.scaleY);var Kt=Ct.sizeAfterTransform(Gt,Ht,{scaleX:this.scaleX,scaleY:this.scaleY,skewX:Lt,skewY:jt});return this._finalizeDimensions(Kt.x,Kt.y)},_finalizeDimensions:function(Lt,jt){return this.strokeUniform?{x:Lt+this.strokeWidth,y:jt+this.strokeWidth}:{x:Lt,y:jt}},_calculateCurrentDimensions:function(){var Lt=this.getViewportTransform(),jt=this._getTransformedDimensions(),Ft=$t(jt,Lt,!0);return Ft.scalarAdd(2*this.padding)}})}(),g.util.object.extend(g.Object.prototype,{sendToBack:function(){return this.group?g.StaticCanvas.prototype.sendToBack.call(this.group,this):this.canvas&&this.canvas.sendToBack(this),this},bringToFront:function(){return this.group?g.StaticCanvas.prototype.bringToFront.call(this.group,this):this.canvas&&this.canvas.bringToFront(this),this},sendBackwards:function(Tt){return this.group?g.StaticCanvas.prototype.sendBackwards.call(this.group,this,Tt):this.canvas&&this.canvas.sendBackwards(this,Tt),this},bringForward:function(Tt){return this.group?g.StaticCanvas.prototype.bringForward.call(this.group,this,Tt):this.canvas&&this.canvas.bringForward(this,Tt),this},moveTo:function(Tt){return this.group&&this.group.type!=="activeSelection"?g.StaticCanvas.prototype.moveTo.call(this.group,this,Tt):this.canvas&&this.canvas.moveTo(this,Tt),this}}),function(){function Tt(pt,wt){if(wt){if(wt.toLive)return pt+": url(#SVGID_"+wt.id+"); ";var $t=new g.Color(wt),Lt=pt+": "+$t.toRgb()+"; ",jt=$t.getAlpha();return jt!==1&&(Lt+=pt+"-opacity: "+jt.toString()+"; "),Lt}else return pt+": none; "}var Ct=g.util.toFixed;g.util.object.extend(g.Object.prototype,{getSvgStyles:function(pt){var wt=this.fillRule?this.fillRule:"nonzero",$t=this.strokeWidth?this.strokeWidth:"0",Lt=this.strokeDashArray?this.strokeDashArray.join(" "):"none",jt=this.strokeDashOffset?this.strokeDashOffset:"0",Ft=this.strokeLineCap?this.strokeLineCap:"butt",Gt=this.strokeLineJoin?this.strokeLineJoin:"miter",Ht=this.strokeMiterLimit?this.strokeMiterLimit:"4",qt=typeof this.opacity<"u"?this.opacity:"1",Kt=this.visible?"":" visibility: hidden;",rr=pt?"":this.getSvgFilter(),ir=Tt("fill",this.fill),or=Tt("stroke",this.stroke);return[or,"stroke-width: ",$t,"; ","stroke-dasharray: ",Lt,"; ","stroke-linecap: ",Ft,"; ","stroke-dashoffset: ",jt,"; ","stroke-linejoin: ",Gt,"; ","stroke-miterlimit: ",Ht,"; ",ir,"fill-rule: ",wt,"; ","opacity: ",qt,";",rr,Kt].join("")},getSvgSpanStyles:function(pt,wt){var $t="; ",jt=pt.fontFamily?"font-family: "+(pt.fontFamily.indexOf("'")===-1&&pt.fontFamily.indexOf('"')===-1?"'"+pt.fontFamily+"'":pt.fontFamily)+$t:"",Lt=pt.strokeWidth?"stroke-width: "+pt.strokeWidth+$t:"",jt=jt,Ft=pt.fontSize?"font-size: "+pt.fontSize+"px"+$t:"",Gt=pt.fontStyle?"font-style: "+pt.fontStyle+$t:"",Ht=pt.fontWeight?"font-weight: "+pt.fontWeight+$t:"",qt=pt.fill?Tt("fill",pt.fill):"",Kt=pt.stroke?Tt("stroke",pt.stroke):"",rr=this.getSvgTextDecoration(pt),ir=pt.deltaY?"baseline-shift: "+-pt.deltaY+"; ":"";return rr&&(rr="text-decoration: "+rr+$t),[Kt,Lt,jt,Ft,Gt,Ht,rr,qt,ir,wt?"white-space: pre; ":""].join("")},getSvgTextDecoration:function(pt){return["overline","underline","line-through"].filter(function(wt){return pt[wt.replace("-","")]}).join(" ")},getSvgFilter:function(){return this.shadow?"filter: url(#SVGID_"+this.shadow.id+");":""},getSvgCommons:function(){return[this.id?'id="'+this.id+'" ':"",this.clipPath?'clip-path="url(#'+this.clipPath.clipPathId+')" ':""].join("")},getSvgTransform:function(pt,wt){var $t=pt?this.calcTransformMatrix():this.calcOwnMatrix(),Lt='transform="'+g.util.matrixToSVG($t);return Lt+(wt||"")+'" '},_setSVGBg:function(pt){if(this.backgroundColor){var wt=g.Object.NUM_FRACTION_DIGITS;pt.push("		<rect ",this._getFillAttributes(this.backgroundColor),' x="',Ct(-this.width/2,wt),'" y="',Ct(-this.height/2,wt),'" width="',Ct(this.width,wt),'" height="',Ct(this.height,wt),`"></rect>
`)}},toSVG:function(pt){return this._createBaseSVGMarkup(this._toSVG(pt),{reviver:pt})},toClipPathSVG:function(pt){return"	"+this._createBaseClipPathSVGMarkup(this._toSVG(pt),{reviver:pt})},_createBaseClipPathSVGMarkup:function(pt,wt){wt=wt||{};var $t=wt.reviver,Lt=wt.additionalTransform||"",jt=[this.getSvgTransform(!0,Lt),this.getSvgCommons()].join(""),Ft=pt.indexOf("COMMON_PARTS");return pt[Ft]=jt,$t?$t(pt.join("")):pt.join("")},_createBaseSVGMarkup:function(pt,wt){wt=wt||{};var $t=wt.noStyle,Lt=wt.reviver,jt=$t?"":'style="'+this.getSvgStyles()+'" ',Ft=wt.withShadow?'style="'+this.getSvgFilter()+'" ':"",Gt=this.clipPath,Ht=this.strokeUniform?'vector-effect="non-scaling-stroke" ':"",qt=Gt&&Gt.absolutePositioned,Kt=this.stroke,rr=this.fill,ir=this.shadow,or,jr=[],qr,Yr=pt.indexOf("COMMON_PARTS"),vn=wt.additionalTransform;return Gt&&(Gt.clipPathId="CLIPPATH_"+g.Object.__uid++,qr='<clipPath id="'+Gt.clipPathId+`" >
`+Gt.toClipPathSVG(Lt)+`</clipPath>
`),qt&&jr.push("<g ",Ft,this.getSvgCommons(),` >
`),jr.push("<g ",this.getSvgTransform(!1),qt?"":Ft+this.getSvgCommons(),` >
`),or=[jt,Ht,$t?"":this.addPaintOrder()," ",vn?'transform="'+vn+'" ':""].join(""),pt[Yr]=or,rr&&rr.toLive&&jr.push(rr.toSVG(this)),Kt&&Kt.toLive&&jr.push(Kt.toSVG(this)),ir&&jr.push(ir.toSVG(this)),Gt&&jr.push(qr),jr.push(pt.join("")),jr.push(`</g>
`),qt&&jr.push(`</g>
`),Lt?Lt(jr.join("")):jr.join("")},addPaintOrder:function(){return this.paintFirst!=="fill"?' paint-order="'+this.paintFirst+'" ':""}})}(),function(){var Tt=g.util.object.extend,Ct="stateProperties";function pt($t,Lt,jt){var Ft={},Gt=!0;jt.forEach(function(Ht){Ft[Ht]=$t[Ht]}),Tt($t[Lt],Ft,Gt)}function wt($t,Lt,jt){if($t===Lt)return!0;if(Array.isArray($t)){if(!Array.isArray(Lt)||$t.length!==Lt.length)return!1;for(var Ft=0,Gt=$t.length;Ft<Gt;Ft++)if(!wt($t[Ft],Lt[Ft]))return!1;return!0}else if($t&&typeof $t=="object"){var Ht=Object.keys($t),qt;if(!Lt||typeof Lt!="object"||!jt&&Ht.length!==Object.keys(Lt).length)return!1;for(var Ft=0,Gt=Ht.length;Ft<Gt;Ft++)if(qt=Ht[Ft],!(qt==="canvas"||qt==="group")&&!wt($t[qt],Lt[qt]))return!1;return!0}}g.util.object.extend(g.Object.prototype,{hasStateChanged:function($t){$t=$t||Ct;var Lt="_"+$t;return Object.keys(this[Lt]).length<this[$t].length?!0:!wt(this[Lt],this,!0)},saveState:function($t){var Lt=$t&&$t.propertySet||Ct,jt="_"+Lt;return this[jt]?(pt(this,jt,this[Lt]),$t&&$t.stateProperties&&pt(this,jt,$t.stateProperties),this):this.setupState($t)},setupState:function($t){$t=$t||{};var Lt=$t.propertySet||Ct;return $t.propertySet=Lt,this["_"+Lt]={},this.saveState($t),this}})}(),function(){var Tt=g.util.degreesToRadians;g.util.object.extend(g.Object.prototype,{_findTargetCorner:function(Ct,pt){if(!this.hasControls||this.group||!this.canvas||this.canvas._activeObject!==this)return!1;var wt=Ct.x,$t=Ct.y,Lt,jt,Ft=Object.keys(this.oCoords),Gt=Ft.length-1,Ht;for(this.__corner=0;Gt>=0;Gt--)if(Ht=Ft[Gt],!!this.isControlVisible(Ht)&&(jt=this._getImageLines(pt?this.oCoords[Ht].touchCorner:this.oCoords[Ht].corner),Lt=this._findCrossPoints({x:wt,y:$t},jt),Lt!==0&&Lt%2===1))return this.__corner=Ht,Ht;return!1},forEachControl:function(Ct){for(var pt in this.controls)Ct(this.controls[pt],pt,this)},_setCornerCoords:function(){var Ct=this.oCoords;for(var pt in Ct){var wt=this.controls[pt];Ct[pt].corner=wt.calcCornerCoords(this.angle,this.cornerSize,Ct[pt].x,Ct[pt].y,!1),Ct[pt].touchCorner=wt.calcCornerCoords(this.angle,this.touchCornerSize,Ct[pt].x,Ct[pt].y,!0)}},drawSelectionBackground:function(Ct){if(!this.selectionBackgroundColor||this.canvas&&!this.canvas.interactive||this.canvas&&this.canvas._activeObject!==this)return this;Ct.save();var pt=this.getCenterPoint(),wt=this._calculateCurrentDimensions(),$t=this.canvas.viewportTransform;return Ct.translate(pt.x,pt.y),Ct.scale(1/$t[0],1/$t[3]),Ct.rotate(Tt(this.angle)),Ct.fillStyle=this.selectionBackgroundColor,Ct.fillRect(-wt.x/2,-wt.y/2,wt.x,wt.y),Ct.restore(),this},drawBorders:function(Ct,pt){pt=pt||{};var wt=this._calculateCurrentDimensions(),$t=this.borderScaleFactor,Lt=wt.x+$t,jt=wt.y+$t,Ft=typeof pt.hasControls<"u"?pt.hasControls:this.hasControls,Gt=!1;return Ct.save(),Ct.strokeStyle=pt.borderColor||this.borderColor,this._setLineDash(Ct,pt.borderDashArray||this.borderDashArray),Ct.strokeRect(-Lt/2,-jt/2,Lt,jt),Ft&&(Ct.beginPath(),this.forEachControl(function(Ht,qt,Kt){Ht.withConnection&&Ht.getVisibility(Kt,qt)&&(Gt=!0,Ct.moveTo(Ht.x*Lt,Ht.y*jt),Ct.lineTo(Ht.x*Lt+Ht.offsetX,Ht.y*jt+Ht.offsetY))}),Gt&&Ct.stroke()),Ct.restore(),this},drawBordersInGroup:function(Ct,pt,wt){wt=wt||{};var $t=g.util.sizeAfterTransform(this.width,this.height,pt),Lt=this.strokeWidth,jt=this.strokeUniform,Ft=this.borderScaleFactor,Gt=$t.x+Lt*(jt?this.canvas.getZoom():pt.scaleX)+Ft,Ht=$t.y+Lt*(jt?this.canvas.getZoom():pt.scaleY)+Ft;return Ct.save(),this._setLineDash(Ct,wt.borderDashArray||this.borderDashArray),Ct.strokeStyle=wt.borderColor||this.borderColor,Ct.strokeRect(-Gt/2,-Ht/2,Gt,Ht),Ct.restore(),this},drawControls:function(Ct,pt){pt=pt||{},Ct.save();var wt=this.canvas.getRetinaScaling(),$t,Lt;return Ct.setTransform(wt,0,0,wt,0,0),Ct.strokeStyle=Ct.fillStyle=pt.cornerColor||this.cornerColor,this.transparentCorners||(Ct.strokeStyle=pt.cornerStrokeColor||this.cornerStrokeColor),this._setLineDash(Ct,pt.cornerDashArray||this.cornerDashArray),this.setCoords(),this.group&&($t=this.group.calcTransformMatrix()),this.forEachControl(function(jt,Ft,Gt){Lt=Gt.oCoords[Ft],jt.getVisibility(Gt,Ft)&&($t&&(Lt=g.util.transformPoint(Lt,$t)),jt.render(Ct,Lt.x,Lt.y,pt,Gt))}),Ct.restore(),this},isControlVisible:function(Ct){return this.controls[Ct]&&this.controls[Ct].getVisibility(this,Ct)},setControlVisible:function(Ct,pt){return this._controlsVisibility||(this._controlsVisibility={}),this._controlsVisibility[Ct]=pt,this},setControlsVisibility:function(Ct){Ct||(Ct={});for(var pt in Ct)this.setControlVisible(pt,Ct[pt]);return this},onDeselect:function(){},onSelect:function(){}})}(),g.util.object.extend(g.StaticCanvas.prototype,{FX_DURATION:500,fxCenterObjectH:function(Tt,Ct){Ct=Ct||{};var pt=function(){},wt=Ct.onComplete||pt,$t=Ct.onChange||pt,Lt=this;return g.util.animate({target:this,startValue:Tt.left,endValue:this.getCenterPoint().x,duration:this.FX_DURATION,onChange:function(jt){Tt.set("left",jt),Lt.requestRenderAll(),$t()},onComplete:function(){Tt.setCoords(),wt()}})},fxCenterObjectV:function(Tt,Ct){Ct=Ct||{};var pt=function(){},wt=Ct.onComplete||pt,$t=Ct.onChange||pt,Lt=this;return g.util.animate({target:this,startValue:Tt.top,endValue:this.getCenterPoint().y,duration:this.FX_DURATION,onChange:function(jt){Tt.set("top",jt),Lt.requestRenderAll(),$t()},onComplete:function(){Tt.setCoords(),wt()}})},fxRemove:function(Tt,Ct){Ct=Ct||{};var pt=function(){},wt=Ct.onComplete||pt,$t=Ct.onChange||pt,Lt=this;return g.util.animate({target:this,startValue:Tt.opacity,endValue:0,duration:this.FX_DURATION,onChange:function(jt){Tt.set("opacity",jt),Lt.requestRenderAll(),$t()},onComplete:function(){Lt.remove(Tt),wt()}})}}),g.util.object.extend(g.Object.prototype,{animate:function(){if(arguments[0]&&typeof arguments[0]=="object"){var Tt=[],Ct,pt,wt=[];for(Ct in arguments[0])Tt.push(Ct);for(var $t=0,Lt=Tt.length;$t<Lt;$t++)Ct=Tt[$t],pt=$t!==Lt-1,wt.push(this._animate(Ct,arguments[0][Ct],arguments[1],pt));return wt}else return this._animate.apply(this,arguments)},_animate:function(Tt,Ct,pt,wt){var $t=this,Lt;Ct=Ct.toString(),pt?pt=g.util.object.clone(pt):pt={},~Tt.indexOf(".")&&(Lt=Tt.split("."));var jt=$t.colorProperties.indexOf(Tt)>-1||Lt&&$t.colorProperties.indexOf(Lt[1])>-1,Ft=Lt?this.get(Lt[0])[Lt[1]]:this.get(Tt);"from"in pt||(pt.from=Ft),jt||(~Ct.indexOf("=")?Ct=Ft+parseFloat(Ct.replace("=","")):Ct=parseFloat(Ct));var Gt={target:this,startValue:pt.from,endValue:Ct,byValue:pt.by,easing:pt.easing,duration:pt.duration,abort:pt.abort&&function(Ht,qt,Kt){return pt.abort.call($t,Ht,qt,Kt)},onChange:function(Ht,qt,Kt){Lt?$t[Lt[0]][Lt[1]]=Ht:$t.set(Tt,Ht),!wt&&pt.onChange&&pt.onChange(Ht,qt,Kt)},onComplete:function(Ht,qt,Kt){wt||($t.setCoords(),pt.onComplete&&pt.onComplete(Ht,qt,Kt))}};return jt?g.util.animateColor(Gt.startValue,Gt.endValue,Gt.duration,Gt):g.util.animate(Gt)}}),function(Tt){var Ct=Tt.fabric||(Tt.fabric={}),pt=Ct.util.object.extend,wt=Ct.util.object.clone,$t={x1:1,x2:1,y1:1,y2:1};if(Ct.Line){Ct.warn("fabric.Line is already defined");return}Ct.Line=Ct.util.createClass(Ct.Object,{type:"line",x1:0,y1:0,x2:0,y2:0,cacheProperties:Ct.Object.prototype.cacheProperties.concat("x1","x2","y1","y2"),initialize:function(jt,Ft){jt||(jt=[0,0,0,0]),this.callSuper("initialize",Ft),this.set("x1",jt[0]),this.set("y1",jt[1]),this.set("x2",jt[2]),this.set("y2",jt[3]),this._setWidthHeight(Ft)},_setWidthHeight:function(jt){jt||(jt={}),this.width=Math.abs(this.x2-this.x1),this.height=Math.abs(this.y2-this.y1),this.left="left"in jt?jt.left:this._getLeftToOriginX(),this.top="top"in jt?jt.top:this._getTopToOriginY()},_set:function(jt,Ft){return this.callSuper("_set",jt,Ft),typeof $t[jt]<"u"&&this._setWidthHeight(),this},_getLeftToOriginX:Lt({origin:"originX",axis1:"x1",axis2:"x2",dimension:"width"},{nearest:"left",center:"center",farthest:"right"}),_getTopToOriginY:Lt({origin:"originY",axis1:"y1",axis2:"y2",dimension:"height"},{nearest:"top",center:"center",farthest:"bottom"}),_render:function(jt){jt.beginPath();var Ft=this.calcLinePoints();jt.moveTo(Ft.x1,Ft.y1),jt.lineTo(Ft.x2,Ft.y2),jt.lineWidth=this.strokeWidth;var Gt=jt.strokeStyle;jt.strokeStyle=this.stroke||jt.fillStyle,this.stroke&&this._renderStroke(jt),jt.strokeStyle=Gt},_findCenterFromElement:function(){return{x:(this.x1+this.x2)/2,y:(this.y1+this.y2)/2}},toObject:function(jt){return pt(this.callSuper("toObject",jt),this.calcLinePoints())},_getNonTransformedDimensions:function(){var jt=this.callSuper("_getNonTransformedDimensions");return this.strokeLineCap==="butt"&&(this.width===0&&(jt.y-=this.strokeWidth),this.height===0&&(jt.x-=this.strokeWidth)),jt},calcLinePoints:function(){var jt=this.x1<=this.x2?-1:1,Ft=this.y1<=this.y2?-1:1,Gt=jt*this.width*.5,Ht=Ft*this.height*.5,qt=jt*this.width*-.5,Kt=Ft*this.height*-.5;return{x1:Gt,x2:qt,y1:Ht,y2:Kt}},_toSVG:function(){var jt=this.calcLinePoints();return["<line ","COMMON_PARTS",'x1="',jt.x1,'" y1="',jt.y1,'" x2="',jt.x2,'" y2="',jt.y2,`" />
`]}}),Ct.Line.ATTRIBUTE_NAMES=Ct.SHARED_ATTRIBUTES.concat("x1 y1 x2 y2".split(" ")),Ct.Line.fromElement=function(jt,Ft,Gt){Gt=Gt||{};var Ht=Ct.parseAttributes(jt,Ct.Line.ATTRIBUTE_NAMES),qt=[Ht.x1||0,Ht.y1||0,Ht.x2||0,Ht.y2||0];Ft(new Ct.Line(qt,pt(Ht,Gt)))},Ct.Line.fromObject=function(jt,Ft){function Gt(qt){delete qt.points,Ft&&Ft(qt)}var Ht=wt(jt,!0);Ht.points=[jt.x1,jt.y1,jt.x2,jt.y2],Ct.Object._fromObject("Line",Ht,Gt,"points")};function Lt(jt,Ft){var Gt=jt.origin,Ht=jt.axis1,qt=jt.axis2,Kt=jt.dimension,rr=Ft.nearest,ir=Ft.center,or=Ft.farthest;return function(){switch(this.get(Gt)){case rr:return Math.min(this.get(Ht),this.get(qt));case ir:return Math.min(this.get(Ht),this.get(qt))+.5*this.get(Kt);case or:return Math.max(this.get(Ht),this.get(qt))}}}}(d),function(Tt){var Ct=Tt.fabric||(Tt.fabric={}),pt=Ct.util.degreesToRadians;if(Ct.Circle){Ct.warn("fabric.Circle is already defined.");return}Ct.Circle=Ct.util.createClass(Ct.Object,{type:"circle",radius:0,startAngle:0,endAngle:360,cacheProperties:Ct.Object.prototype.cacheProperties.concat("radius","startAngle","endAngle"),_set:function($t,Lt){return this.callSuper("_set",$t,Lt),$t==="radius"&&this.setRadius(Lt),this},toObject:function($t){return this.callSuper("toObject",["radius","startAngle","endAngle"].concat($t))},_toSVG:function(){var $t,Lt=0,jt=0,Ft=(this.endAngle-this.startAngle)%360;if(Ft===0)$t=["<circle ","COMMON_PARTS",'cx="'+Lt+'" cy="'+jt+'" ','r="',this.radius,`" />
`];else{var Gt=pt(this.startAngle),Ht=pt(this.endAngle),qt=this.radius,Kt=Ct.util.cos(Gt)*qt,rr=Ct.util.sin(Gt)*qt,ir=Ct.util.cos(Ht)*qt,or=Ct.util.sin(Ht)*qt,jr=Ft>180?"1":"0";$t=['<path d="M '+Kt+" "+rr," A "+qt+" "+qt," 0 ",+jr+" 1"," "+ir+" "+or,'" ',"COMMON_PARTS",` />
`]}return $t},_render:function($t){$t.beginPath(),$t.arc(0,0,this.radius,pt(this.startAngle),pt(this.endAngle),!1),this._renderPaintInOrder($t)},getRadiusX:function(){return this.get("radius")*this.get("scaleX")},getRadiusY:function(){return this.get("radius")*this.get("scaleY")},setRadius:function($t){return this.radius=$t,this.set("width",$t*2).set("height",$t*2)}}),Ct.Circle.ATTRIBUTE_NAMES=Ct.SHARED_ATTRIBUTES.concat("cx cy r".split(" ")),Ct.Circle.fromElement=function($t,Lt){var jt=Ct.parseAttributes($t,Ct.Circle.ATTRIBUTE_NAMES);if(!wt(jt))throw new Error("value of `r` attribute is required and can not be negative");jt.left=(jt.left||0)-jt.radius,jt.top=(jt.top||0)-jt.radius,Lt(new Ct.Circle(jt))};function wt($t){return"radius"in $t&&$t.radius>=0}Ct.Circle.fromObject=function($t,Lt){Ct.Object._fromObject("Circle",$t,Lt)}}(d),function(Tt){var Ct=Tt.fabric||(Tt.fabric={});if(Ct.Triangle){Ct.warn("fabric.Triangle is already defined");return}Ct.Triangle=Ct.util.createClass(Ct.Object,{type:"triangle",width:100,height:100,_render:function(pt){var wt=this.width/2,$t=this.height/2;pt.beginPath(),pt.moveTo(-wt,$t),pt.lineTo(0,-$t),pt.lineTo(wt,$t),pt.closePath(),this._renderPaintInOrder(pt)},_toSVG:function(){var pt=this.width/2,wt=this.height/2,$t=[-pt+" "+wt,"0 "+-wt,pt+" "+wt].join(",");return["<polygon ","COMMON_PARTS",'points="',$t,'" />']}}),Ct.Triangle.fromObject=function(pt,wt){return Ct.Object._fromObject("Triangle",pt,wt)}}(d),function(Tt){var Ct=Tt.fabric||(Tt.fabric={}),pt=Math.PI*2;if(Ct.Ellipse){Ct.warn("fabric.Ellipse is already defined.");return}Ct.Ellipse=Ct.util.createClass(Ct.Object,{type:"ellipse",rx:0,ry:0,cacheProperties:Ct.Object.prototype.cacheProperties.concat("rx","ry"),initialize:function(wt){this.callSuper("initialize",wt),this.set("rx",wt&&wt.rx||0),this.set("ry",wt&&wt.ry||0)},_set:function(wt,$t){switch(this.callSuper("_set",wt,$t),wt){case"rx":this.rx=$t,this.set("width",$t*2);break;case"ry":this.ry=$t,this.set("height",$t*2);break}return this},getRx:function(){return this.get("rx")*this.get("scaleX")},getRy:function(){return this.get("ry")*this.get("scaleY")},toObject:function(wt){return this.callSuper("toObject",["rx","ry"].concat(wt))},_toSVG:function(){return["<ellipse ","COMMON_PARTS",'cx="0" cy="0" ','rx="',this.rx,'" ry="',this.ry,`" />
`]},_render:function(wt){wt.beginPath(),wt.save(),wt.transform(1,0,0,this.ry/this.rx,0,0),wt.arc(0,0,this.rx,0,pt,!1),wt.restore(),this._renderPaintInOrder(wt)}}),Ct.Ellipse.ATTRIBUTE_NAMES=Ct.SHARED_ATTRIBUTES.concat("cx cy rx ry".split(" ")),Ct.Ellipse.fromElement=function(wt,$t){var Lt=Ct.parseAttributes(wt,Ct.Ellipse.ATTRIBUTE_NAMES);Lt.left=(Lt.left||0)-Lt.rx,Lt.top=(Lt.top||0)-Lt.ry,$t(new Ct.Ellipse(Lt))},Ct.Ellipse.fromObject=function(wt,$t){Ct.Object._fromObject("Ellipse",wt,$t)}}(d),function(Tt){var Ct=Tt.fabric||(Tt.fabric={}),pt=Ct.util.object.extend;if(Ct.Rect){Ct.warn("fabric.Rect is already defined");return}Ct.Rect=Ct.util.createClass(Ct.Object,{stateProperties:Ct.Object.prototype.stateProperties.concat("rx","ry"),type:"rect",rx:0,ry:0,cacheProperties:Ct.Object.prototype.cacheProperties.concat("rx","ry"),initialize:function(wt){this.callSuper("initialize",wt),this._initRxRy()},_initRxRy:function(){this.rx&&!this.ry?this.ry=this.rx:this.ry&&!this.rx&&(this.rx=this.ry)},_render:function(wt){var $t=this.rx?Math.min(this.rx,this.width/2):0,Lt=this.ry?Math.min(this.ry,this.height/2):0,jt=this.width,Ft=this.height,Gt=-this.width/2,Ht=-this.height/2,qt=$t!==0||Lt!==0,Kt=1-.5522847498;wt.beginPath(),wt.moveTo(Gt+$t,Ht),wt.lineTo(Gt+jt-$t,Ht),qt&&wt.bezierCurveTo(Gt+jt-Kt*$t,Ht,Gt+jt,Ht+Kt*Lt,Gt+jt,Ht+Lt),wt.lineTo(Gt+jt,Ht+Ft-Lt),qt&&wt.bezierCurveTo(Gt+jt,Ht+Ft-Kt*Lt,Gt+jt-Kt*$t,Ht+Ft,Gt+jt-$t,Ht+Ft),wt.lineTo(Gt+$t,Ht+Ft),qt&&wt.bezierCurveTo(Gt+Kt*$t,Ht+Ft,Gt,Ht+Ft-Kt*Lt,Gt,Ht+Ft-Lt),wt.lineTo(Gt,Ht+Lt),qt&&wt.bezierCurveTo(Gt,Ht+Kt*Lt,Gt+Kt*$t,Ht,Gt+$t,Ht),wt.closePath(),this._renderPaintInOrder(wt)},toObject:function(wt){return this.callSuper("toObject",["rx","ry"].concat(wt))},_toSVG:function(){var wt=-this.width/2,$t=-this.height/2;return["<rect ","COMMON_PARTS",'x="',wt,'" y="',$t,'" rx="',this.rx,'" ry="',this.ry,'" width="',this.width,'" height="',this.height,`" />
`]}}),Ct.Rect.ATTRIBUTE_NAMES=Ct.SHARED_ATTRIBUTES.concat("x y rx ry width height".split(" ")),Ct.Rect.fromElement=function(wt,$t,Lt){if(!wt)return $t(null);Lt=Lt||{};var jt=Ct.parseAttributes(wt,Ct.Rect.ATTRIBUTE_NAMES);jt.left=jt.left||0,jt.top=jt.top||0,jt.height=jt.height||0,jt.width=jt.width||0;var Ft=new Ct.Rect(pt(Lt?Ct.util.object.clone(Lt):{},jt));Ft.visible=Ft.visible&&Ft.width>0&&Ft.height>0,$t(Ft)},Ct.Rect.fromObject=function(wt,$t){return Ct.Object._fromObject("Rect",wt,$t)}}(d),function(Tt){var Ct=Tt.fabric||(Tt.fabric={}),pt=Ct.util.object.extend,wt=Ct.util.array.min,$t=Ct.util.array.max,Lt=Ct.util.toFixed,jt=Ct.util.projectStrokeOnPoints;if(Ct.Polyline){Ct.warn("fabric.Polyline is already defined");return}Ct.Polyline=Ct.util.createClass(Ct.Object,{type:"polyline",points:null,exactBoundingBox:!1,cacheProperties:Ct.Object.prototype.cacheProperties.concat("points"),initialize:function(Ft,Gt){Gt=Gt||{},this.points=Ft||[],this.callSuper("initialize",Gt),this._setPositionDimensions(Gt)},_projectStrokeOnPoints:function(){return jt(this.points,this,!0)},_setPositionDimensions:function(Ft){var Gt=this._calcDimensions(Ft),Ht,qt=this.exactBoundingBox?this.strokeWidth:0;this.width=Gt.width-qt,this.height=Gt.height-qt,Ft.fromSVG||(Ht=this.translateToGivenOrigin({x:Gt.left-this.strokeWidth/2+qt/2,y:Gt.top-this.strokeWidth/2+qt/2},"left","top",this.originX,this.originY)),typeof Ft.left>"u"&&(this.left=Ft.fromSVG?Gt.left:Ht.x),typeof Ft.top>"u"&&(this.top=Ft.fromSVG?Gt.top:Ht.y),this.pathOffset={x:Gt.left+this.width/2+qt/2,y:Gt.top+this.height/2+qt/2}},_calcDimensions:function(){var Ft=this.exactBoundingBox?this._projectStrokeOnPoints():this.points,Gt=wt(Ft,"x")||0,Ht=wt(Ft,"y")||0,qt=$t(Ft,"x")||0,Kt=$t(Ft,"y")||0,rr=qt-Gt,ir=Kt-Ht;return{left:Gt,top:Ht,width:rr,height:ir}},toObject:function(Ft){return pt(this.callSuper("toObject",Ft),{points:this.points.concat()})},_toSVG:function(){for(var Ft=[],Gt=this.pathOffset.x,Ht=this.pathOffset.y,qt=Ct.Object.NUM_FRACTION_DIGITS,Kt=0,rr=this.points.length;Kt<rr;Kt++)Ft.push(Lt(this.points[Kt].x-Gt,qt),",",Lt(this.points[Kt].y-Ht,qt)," ");return["<"+this.type+" ","COMMON_PARTS",'points="',Ft.join(""),`" />
`]},commonRender:function(Ft){var Gt,Ht=this.points.length,qt=this.pathOffset.x,Kt=this.pathOffset.y;if(!Ht||isNaN(this.points[Ht-1].y))return!1;Ft.beginPath(),Ft.moveTo(this.points[0].x-qt,this.points[0].y-Kt);for(var rr=0;rr<Ht;rr++)Gt=this.points[rr],Ft.lineTo(Gt.x-qt,Gt.y-Kt);return!0},_render:function(Ft){this.commonRender(Ft)&&this._renderPaintInOrder(Ft)},complexity:function(){return this.get("points").length}}),Ct.Polyline.ATTRIBUTE_NAMES=Ct.SHARED_ATTRIBUTES.concat(),Ct.Polyline.fromElementGenerator=function(Ft){return function(Gt,Ht,qt){if(!Gt)return Ht(null);qt||(qt={});var Kt=Ct.parsePointsAttribute(Gt.getAttribute("points")),rr=Ct.parseAttributes(Gt,Ct[Ft].ATTRIBUTE_NAMES);rr.fromSVG=!0,Ht(new Ct[Ft](Kt,pt(rr,qt)))}},Ct.Polyline.fromElement=Ct.Polyline.fromElementGenerator("Polyline"),Ct.Polyline.fromObject=function(Ft,Gt){return Ct.Object._fromObject("Polyline",Ft,Gt,"points")}}(d),function(Tt){var Ct=Tt.fabric||(Tt.fabric={}),pt=Ct.util.projectStrokeOnPoints;if(Ct.Polygon){Ct.warn("fabric.Polygon is already defined");return}Ct.Polygon=Ct.util.createClass(Ct.Polyline,{type:"polygon",_projectStrokeOnPoints:function(){return pt(this.points,this)},_render:function(wt){this.commonRender(wt)&&(wt.closePath(),this._renderPaintInOrder(wt))}}),Ct.Polygon.ATTRIBUTE_NAMES=Ct.SHARED_ATTRIBUTES.concat(),Ct.Polygon.fromElement=Ct.Polyline.fromElementGenerator("Polygon"),Ct.Polygon.fromObject=function(wt,$t){Ct.Object._fromObject("Polygon",wt,$t,"points")}}(d),function(Tt){var Ct=Tt.fabric||(Tt.fabric={}),pt=Ct.util.array.min,wt=Ct.util.array.max,$t=Ct.util.object.extend,Lt=Ct.util.object.clone,jt=Ct.util.toFixed;if(Ct.Path){Ct.warn("fabric.Path is already defined");return}Ct.Path=Ct.util.createClass(Ct.Object,{type:"path",path:null,cacheProperties:Ct.Object.prototype.cacheProperties.concat("path","fillRule"),stateProperties:Ct.Object.prototype.stateProperties.concat("path"),initialize:function(Ft,Gt){Gt=Lt(Gt||{}),delete Gt.path,this.callSuper("initialize",Gt),this._setPath(Ft||[],Gt)},_setPath:function(Ft,Gt){this.path=Ct.util.makePathSimpler(Array.isArray(Ft)?Ft:Ct.util.parsePath(Ft)),Ct.Polyline.prototype._setPositionDimensions.call(this,Gt||{})},_renderPathCommands:function(Ft){var Gt,Ht=0,qt=0,Kt=0,rr=0,ir=0,or=0,jr=-this.pathOffset.x,qr=-this.pathOffset.y;Ft.beginPath();for(var Yr=0,vn=this.path.length;Yr<vn;++Yr)switch(Gt=this.path[Yr],Gt[0]){case"L":Kt=Gt[1],rr=Gt[2],Ft.lineTo(Kt+jr,rr+qr);break;case"M":Kt=Gt[1],rr=Gt[2],Ht=Kt,qt=rr,Ft.moveTo(Kt+jr,rr+qr);break;case"C":Kt=Gt[5],rr=Gt[6],ir=Gt[3],or=Gt[4],Ft.bezierCurveTo(Gt[1]+jr,Gt[2]+qr,ir+jr,or+qr,Kt+jr,rr+qr);break;case"Q":Ft.quadraticCurveTo(Gt[1]+jr,Gt[2]+qr,Gt[3]+jr,Gt[4]+qr),Kt=Gt[3],rr=Gt[4],ir=Gt[1],or=Gt[2];break;case"z":case"Z":Kt=Ht,rr=qt,Ft.closePath();break}},_render:function(Ft){this._renderPathCommands(Ft),this._renderPaintInOrder(Ft)},toString:function(){return"#<fabric.Path ("+this.complexity()+'): { "top": '+this.top+', "left": '+this.left+" }>"},toObject:function(Ft){return $t(this.callSuper("toObject",Ft),{path:this.path.map(function(Gt){return Gt.slice()})})},toDatalessObject:function(Ft){var Gt=this.toObject(["sourcePath"].concat(Ft));return Gt.sourcePath&&delete Gt.path,Gt},_toSVG:function(){var Ft=Ct.util.joinPath(this.path);return["<path ","COMMON_PARTS",'d="',Ft,'" stroke-linecap="round" ',`/>
`]},_getOffsetTransform:function(){var Ft=Ct.Object.NUM_FRACTION_DIGITS;return" translate("+jt(-this.pathOffset.x,Ft)+", "+jt(-this.pathOffset.y,Ft)+")"},toClipPathSVG:function(Ft){var Gt=this._getOffsetTransform();return"	"+this._createBaseClipPathSVGMarkup(this._toSVG(),{reviver:Ft,additionalTransform:Gt})},toSVG:function(Ft){var Gt=this._getOffsetTransform();return this._createBaseSVGMarkup(this._toSVG(),{reviver:Ft,additionalTransform:Gt})},complexity:function(){return this.path.length},_calcDimensions:function(){for(var Ft=[],Gt=[],Ht,qt=0,Kt=0,rr=0,ir=0,or,jr=0,qr=this.path.length;jr<qr;++jr){switch(Ht=this.path[jr],Ht[0]){case"L":rr=Ht[1],ir=Ht[2],or=[];break;case"M":rr=Ht[1],ir=Ht[2],qt=rr,Kt=ir,or=[];break;case"C":or=Ct.util.getBoundsOfCurve(rr,ir,Ht[1],Ht[2],Ht[3],Ht[4],Ht[5],Ht[6]),rr=Ht[5],ir=Ht[6];break;case"Q":or=Ct.util.getBoundsOfCurve(rr,ir,Ht[1],Ht[2],Ht[1],Ht[2],Ht[3],Ht[4]),rr=Ht[3],ir=Ht[4];break;case"z":case"Z":rr=qt,ir=Kt;break}or.forEach(function(Uo){Ft.push(Uo.x),Gt.push(Uo.y)}),Ft.push(rr),Gt.push(ir)}var Yr=pt(Ft)||0,vn=pt(Gt)||0,ko=wt(Ft)||0,Xo=wt(Gt)||0,zo=ko-Yr,t0=Xo-vn;return{left:Yr,top:vn,width:zo,height:t0}}}),Ct.Path.fromObject=function(Ft,Gt){if(typeof Ft.sourcePath=="string"){var Ht=Ft.sourcePath;Ct.loadSVGFromURL(Ht,function(qt){var Kt=qt[0];Kt.setOptions(Ft),Ft.clipPath?Ct.util.enlivenObjects([Ft.clipPath],function(rr){Kt.clipPath=rr[0],Gt&&Gt(Kt)}):Gt&&Gt(Kt)})}else Ct.Object._fromObject("Path",Ft,Gt,"path")},Ct.Path.ATTRIBUTE_NAMES=Ct.SHARED_ATTRIBUTES.concat(["d"]),Ct.Path.fromElement=function(Ft,Gt,Ht){var qt=Ct.parseAttributes(Ft,Ct.Path.ATTRIBUTE_NAMES);qt.fromSVG=!0,Gt(new Ct.Path(qt.d,$t(qt,Ht)))}}(d),function(Tt){var Ct=Tt.fabric||(Tt.fabric={}),pt=Ct.util.array.min,wt=Ct.util.array.max;Ct.Group||(Ct.Group=Ct.util.createClass(Ct.Object,Ct.Collection,{type:"group",strokeWidth:0,subTargetCheck:!1,cacheProperties:[],useSetOnGroup:!1,initialize:function($t,Lt,jt){Lt=Lt||{},this._objects=[],jt&&this.callSuper("initialize",Lt),this._objects=$t||[];for(var Ft=this._objects.length;Ft--;)this._objects[Ft].group=this;if(jt)this._updateObjectsACoords();else{var Gt=Lt&&Lt.centerPoint;Lt.originX!==void 0&&(this.originX=Lt.originX),Lt.originY!==void 0&&(this.originY=Lt.originY),Gt||this._calcBounds(),this._updateObjectsCoords(Gt),delete Lt.centerPoint,this.callSuper("initialize",Lt)}this.setCoords()},_updateObjectsACoords:function(){for(var $t=!0,Lt=this._objects.length;Lt--;)this._objects[Lt].setCoords($t)},_updateObjectsCoords:function(Lt){for(var Lt=Lt||this.getCenterPoint(),jt=this._objects.length;jt--;)this._updateObjectCoords(this._objects[jt],Lt)},_updateObjectCoords:function($t,Lt){var jt=$t.left,Ft=$t.top,Gt=!0;$t.set({left:jt-Lt.x,top:Ft-Lt.y}),$t.group=this,$t.setCoords(Gt)},toString:function(){return"#<fabric.Group: ("+this.complexity()+")>"},addWithUpdate:function($t){var Lt=!!this.group;return this._restoreObjectsState(),Ct.util.resetObjectTransform(this),$t&&(Lt&&Ct.util.removeTransformFromObject($t,this.group.calcTransformMatrix()),this._objects.push($t),$t.group=this,$t._set("canvas",this.canvas)),this._calcBounds(),this._updateObjectsCoords(),this.dirty=!0,Lt?this.group.addWithUpdate():this.setCoords(),this},removeWithUpdate:function($t){return this._restoreObjectsState(),Ct.util.resetObjectTransform(this),this.remove($t),this._calcBounds(),this._updateObjectsCoords(),this.setCoords(),this.dirty=!0,this},_onObjectAdded:function($t){this.dirty=!0,$t.group=this,$t._set("canvas",this.canvas)},_onObjectRemoved:function($t){this.dirty=!0,delete $t.group},_set:function($t,Lt){var jt=this._objects.length;if(this.useSetOnGroup)for(;jt--;)this._objects[jt].setOnGroup($t,Lt);if($t==="canvas")for(;jt--;)this._objects[jt]._set($t,Lt);Ct.Object.prototype._set.call(this,$t,Lt)},toObject:function($t){var Lt=this.includeDefaultValues,jt=this._objects.filter(function(Gt){return!Gt.excludeFromExport}).map(function(Gt){var Ht=Gt.includeDefaultValues;Gt.includeDefaultValues=Lt;var qt=Gt.toObject($t);return Gt.includeDefaultValues=Ht,qt}),Ft=Ct.Object.prototype.toObject.call(this,$t);return Ft.objects=jt,Ft},toDatalessObject:function($t){var Lt,jt=this.sourcePath;if(jt)Lt=jt;else{var Ft=this.includeDefaultValues;Lt=this._objects.map(function(Ht){var qt=Ht.includeDefaultValues;Ht.includeDefaultValues=Ft;var Kt=Ht.toDatalessObject($t);return Ht.includeDefaultValues=qt,Kt})}var Gt=Ct.Object.prototype.toDatalessObject.call(this,$t);return Gt.objects=Lt,Gt},render:function($t){this._transformDone=!0,this.callSuper("render",$t),this._transformDone=!1},shouldCache:function(){var $t=Ct.Object.prototype.shouldCache.call(this);if($t){for(var Lt=0,jt=this._objects.length;Lt<jt;Lt++)if(this._objects[Lt].willDrawShadow())return this.ownCaching=!1,!1}return $t},willDrawShadow:function(){if(Ct.Object.prototype.willDrawShadow.call(this))return!0;for(var $t=0,Lt=this._objects.length;$t<Lt;$t++)if(this._objects[$t].willDrawShadow())return!0;return!1},isOnACache:function(){return this.ownCaching||this.group&&this.group.isOnACache()},drawObject:function($t){for(var Lt=0,jt=this._objects.length;Lt<jt;Lt++)this._objects[Lt].render($t);this._drawClipPath($t,this.clipPath)},isCacheDirty:function($t){if(this.callSuper("isCacheDirty",$t))return!0;if(!this.statefullCache)return!1;for(var Lt=0,jt=this._objects.length;Lt<jt;Lt++)if(this._objects[Lt].isCacheDirty(!0)){if(this._cacheCanvas){var Ft=this.cacheWidth/this.zoomX,Gt=this.cacheHeight/this.zoomY;this._cacheContext.clearRect(-Ft/2,-Gt/2,Ft,Gt)}return!0}return!1},_restoreObjectsState:function(){var $t=this.calcOwnMatrix();return this._objects.forEach(function(Lt){Ct.util.addTransformToObject(Lt,$t),delete Lt.group,Lt.setCoords()}),this},destroy:function(){return this._objects.forEach(function($t){$t.set("dirty",!0)}),this._restoreObjectsState()},dispose:function(){this.callSuper("dispose"),this.forEachObject(function($t){$t.dispose&&$t.dispose()}),this._objects=[]},toActiveSelection:function(){if(this.canvas){var $t=this._objects,Lt=this.canvas;this._objects=[];var jt=this.toObject();delete jt.objects;var Ft=new Ct.ActiveSelection([]);return Ft.set(jt),Ft.type="activeSelection",Lt.remove(this),$t.forEach(function(Gt){Gt.group=Ft,Gt.dirty=!0,Lt.add(Gt)}),Ft.canvas=Lt,Ft._objects=$t,Lt._activeObject=Ft,Ft.setCoords(),Ft}},ungroupOnCanvas:function(){return this._restoreObjectsState()},setObjectsCoords:function(){var $t=!0;return this.forEachObject(function(Lt){Lt.setCoords($t)}),this},_calcBounds:function($t){for(var Lt=[],jt=[],Ft,Gt,Ht,qt=["tr","br","bl","tl"],Kt=0,rr=this._objects.length,ir,or=qt.length;Kt<rr;++Kt){for(Ft=this._objects[Kt],Ht=Ft.calcACoords(),ir=0;ir<or;ir++)Gt=qt[ir],Lt.push(Ht[Gt].x),jt.push(Ht[Gt].y);Ft.aCoords=Ht}this._getBounds(Lt,jt,$t)},_getBounds:function($t,Lt,jt){var Ft=new Ct.Point(pt($t),pt(Lt)),Gt=new Ct.Point(wt($t),wt(Lt)),Ht=Ft.y||0,qt=Ft.x||0,Kt=Gt.x-Ft.x||0,rr=Gt.y-Ft.y||0;this.width=Kt,this.height=rr,jt||this.setPositionByOrigin({x:qt,y:Ht},"left","top")},_toSVG:function($t){for(var Lt=["<g ","COMMON_PARTS",` >
`],jt=0,Ft=this._objects.length;jt<Ft;jt++)Lt.push("		",this._objects[jt].toSVG($t));return Lt.push(`</g>
`),Lt},getSvgStyles:function(){var $t=typeof this.opacity<"u"&&this.opacity!==1?"opacity: "+this.opacity+";":"",Lt=this.visible?"":" visibility: hidden;";return[$t,this.getSvgFilter(),Lt].join("")},toClipPathSVG:function($t){for(var Lt=[],jt=0,Ft=this._objects.length;jt<Ft;jt++)Lt.push("	",this._objects[jt].toClipPathSVG($t));return this._createBaseClipPathSVGMarkup(Lt,{reviver:$t})}}),Ct.Group.fromObject=function($t,Lt){var jt=$t.objects,Ft=Ct.util.object.clone($t,!0);if(delete Ft.objects,typeof jt=="string"){Ct.loadSVGFromURL(jt,function(Gt){var Ht=Ct.util.groupSVGElements(Gt,$t,jt),qt=Ft.clipPath;delete Ft.clipPath,Ht.set(Ft),qt?Ct.util.enlivenObjects([qt],function(Kt){Ht.clipPath=Kt[0],Lt&&Lt(Ht)}):Lt&&Lt(Ht)});return}Ct.util.enlivenObjects(jt,function(Gt){Ct.util.enlivenObjectEnlivables($t,Ft,function(){Lt&&Lt(new Ct.Group(Gt,Ft,!0))})})})}(d),function(Tt){var Ct=Tt.fabric||(Tt.fabric={});Ct.ActiveSelection||(Ct.ActiveSelection=Ct.util.createClass(Ct.Group,{type:"activeSelection",initialize:function(pt,wt){wt=wt||{},this._objects=pt||[];for(var $t=this._objects.length;$t--;)this._objects[$t].group=this;wt.originX&&(this.originX=wt.originX),wt.originY&&(this.originY=wt.originY),this._calcBounds(),this._updateObjectsCoords(),Ct.Object.prototype.initialize.call(this,wt),this.setCoords()},toGroup:function(){var pt=this._objects.concat();this._objects=[];var wt=Ct.Object.prototype.toObject.call(this),$t=new Ct.Group([]);if(delete wt.type,$t.set(wt),pt.forEach(function(jt){jt.canvas.remove(jt),jt.group=$t}),$t._objects=pt,!this.canvas)return $t;var Lt=this.canvas;return Lt.add($t),Lt._activeObject=$t,$t.setCoords(),$t},onDeselect:function(){return this.destroy(),!1},toString:function(){return"#<fabric.ActiveSelection: ("+this.complexity()+")>"},shouldCache:function(){return!1},isOnACache:function(){return!1},_renderControls:function(pt,wt,$t){pt.save(),pt.globalAlpha=this.isMoving?this.borderOpacityWhenMoving:1,this.callSuper("_renderControls",pt,wt),$t=$t||{},typeof $t.hasControls>"u"&&($t.hasControls=!1),$t.forActiveSelection=!0;for(var Lt=0,jt=this._objects.length;Lt<jt;Lt++)this._objects[Lt]._renderControls(pt,$t);pt.restore()}}),Ct.ActiveSelection.fromObject=function(pt,wt){Ct.util.enlivenObjects(pt.objects,function($t){delete pt.objects,wt&&wt(new Ct.ActiveSelection($t,pt,!0))})})}(d),function(Tt){var Ct=g.util.object.extend;if(Tt.fabric||(Tt.fabric={}),Tt.fabric.Image){g.warn("fabric.Image is already defined.");return}g.Image=g.util.createClass(g.Object,{type:"image",strokeWidth:0,srcFromAttribute:!1,_lastScaleX:1,_lastScaleY:1,_filterScalingX:1,_filterScalingY:1,minimumScaleTrigger:.5,stateProperties:g.Object.prototype.stateProperties.concat("cropX","cropY"),cacheProperties:g.Object.prototype.cacheProperties.concat("cropX","cropY"),cacheKey:"",cropX:0,cropY:0,imageSmoothing:!0,initialize:function(pt,wt){wt||(wt={}),this.filters=[],this.cacheKey="texture"+g.Object.__uid++,this.callSuper("initialize",wt),this._initElement(pt,wt)},getElement:function(){return this._element||{}},setElement:function(pt,wt){return this.removeTexture(this.cacheKey),this.removeTexture(this.cacheKey+"_filtered"),this._element=pt,this._originalElement=pt,this._initConfig(wt),this.filters.length!==0&&this.applyFilters(),this.resizeFilter&&this.applyResizeFilters(),this},removeTexture:function(pt){var wt=g.filterBackend;wt&&wt.evictCachesForKey&&wt.evictCachesForKey(pt)},dispose:function(){this.callSuper("dispose"),this.removeTexture(this.cacheKey),this.removeTexture(this.cacheKey+"_filtered"),this._cacheContext=void 0,["_originalElement","_element","_filteredEl","_cacheCanvas"].forEach((function(pt){g.util.cleanUpJsdomNode(this[pt]),this[pt]=void 0}).bind(this))},getCrossOrigin:function(){return this._originalElement&&(this._originalElement.crossOrigin||null)},getOriginalSize:function(){var pt=this.getElement();return{width:pt.naturalWidth||pt.width,height:pt.naturalHeight||pt.height}},_stroke:function(pt){if(!(!this.stroke||this.strokeWidth===0)){var wt=this.width/2,$t=this.height/2;pt.beginPath(),pt.moveTo(-wt,-$t),pt.lineTo(wt,-$t),pt.lineTo(wt,$t),pt.lineTo(-wt,$t),pt.lineTo(-wt,-$t),pt.closePath()}},toObject:function(pt){var wt=[];this.filters.forEach(function(Lt){Lt&&wt.push(Lt.toObject())});var $t=Ct(this.callSuper("toObject",["cropX","cropY"].concat(pt)),{src:this.getSrc(),crossOrigin:this.getCrossOrigin(),filters:wt});return this.resizeFilter&&($t.resizeFilter=this.resizeFilter.toObject()),$t},hasCrop:function(){return this.cropX||this.cropY||this.width<this._element.width||this.height<this._element.height},_toSVG:function(){var pt=[],wt=[],$t,Lt=this._element,jt=-this.width/2,Ft=-this.height/2,Gt="",Ht="";if(!Lt)return[];if(this.hasCrop()){var qt=g.Object.__uid++;pt.push('<clipPath id="imageCrop_'+qt+`">
`,'	<rect x="'+jt+'" y="'+Ft+'" width="'+this.width+'" height="'+this.height+`" />
`,`</clipPath>
`),Gt=' clip-path="url(#imageCrop_'+qt+')" '}if(this.imageSmoothing||(Ht='" image-rendering="optimizeSpeed'),wt.push("	<image ","COMMON_PARTS",'xlink:href="',this.getSvgSrc(!0),'" x="',jt-this.cropX,'" y="',Ft-this.cropY,'" width="',Lt.width||Lt.naturalWidth,'" height="',Lt.height||Lt.height,Ht,'"',Gt,`></image>
`),this.stroke||this.strokeDashArray){var Kt=this.fill;this.fill=null,$t=["	<rect ",'x="',jt,'" y="',Ft,'" width="',this.width,'" height="',this.height,'" style="',this.getSvgStyles(),`"/>
`],this.fill=Kt}return this.paintFirst!=="fill"?pt=pt.concat($t,wt):pt=pt.concat(wt,$t),pt},getSrc:function(pt){var wt=pt?this._element:this._originalElement;return wt?wt.toDataURL?wt.toDataURL():this.srcFromAttribute?wt.getAttribute("src"):wt.src:this.src||""},setSrc:function(pt,wt,$t){return g.util.loadImage(pt,function(Lt,jt){this.setElement(Lt,$t),this._setWidthHeight(),wt&&wt(this,jt)},this,$t&&$t.crossOrigin),this},toString:function(){return'#<fabric.Image: { src: "'+this.getSrc()+'" }>'},applyResizeFilters:function(){var pt=this.resizeFilter,wt=this.minimumScaleTrigger,$t=this.getTotalObjectScaling(),Lt=$t.scaleX,jt=$t.scaleY,Ft=this._filteredEl||this._originalElement;if(this.group&&this.set("dirty",!0),!pt||Lt>wt&&jt>wt){this._element=Ft,this._filterScalingX=1,this._filterScalingY=1,this._lastScaleX=Lt,this._lastScaleY=jt;return}g.filterBackend||(g.filterBackend=g.initFilterBackend());var Gt=g.util.createCanvasElement(),Ht=this._filteredEl?this.cacheKey+"_filtered":this.cacheKey,qt=Ft.width,Kt=Ft.height;Gt.width=qt,Gt.height=Kt,this._element=Gt,this._lastScaleX=pt.scaleX=Lt,this._lastScaleY=pt.scaleY=jt,g.filterBackend.applyFilters([pt],Ft,qt,Kt,this._element,Ht),this._filterScalingX=Gt.width/this._originalElement.width,this._filterScalingY=Gt.height/this._originalElement.height},applyFilters:function(pt){if(pt=pt||this.filters||[],pt=pt.filter(function(Ft){return Ft&&!Ft.isNeutralState()}),this.set("dirty",!0),this.removeTexture(this.cacheKey+"_filtered"),pt.length===0)return this._element=this._originalElement,this._filteredEl=null,this._filterScalingX=1,this._filterScalingY=1,this;var wt=this._originalElement,$t=wt.naturalWidth||wt.width,Lt=wt.naturalHeight||wt.height;if(this._element===this._originalElement){var jt=g.util.createCanvasElement();jt.width=$t,jt.height=Lt,this._element=jt,this._filteredEl=jt}else this._element=this._filteredEl,this._filteredEl.getContext("2d").clearRect(0,0,$t,Lt),this._lastScaleX=1,this._lastScaleY=1;return g.filterBackend||(g.filterBackend=g.initFilterBackend()),g.filterBackend.applyFilters(pt,this._originalElement,$t,Lt,this._element,this.cacheKey),(this._originalElement.width!==this._element.width||this._originalElement.height!==this._element.height)&&(this._filterScalingX=this._element.width/this._originalElement.width,this._filterScalingY=this._element.height/this._originalElement.height),this},_render:function(pt){g.util.setImageSmoothing(pt,this.imageSmoothing),this.isMoving!==!0&&this.resizeFilter&&this._needsResize()&&this.applyResizeFilters(),this._stroke(pt),this._renderPaintInOrder(pt)},drawCacheOnCanvas:function(pt){g.util.setImageSmoothing(pt,this.imageSmoothing),g.Object.prototype.drawCacheOnCanvas.call(this,pt)},shouldCache:function(){return this.needsItsOwnCache()},_renderFill:function(pt){var wt=this._element;if(wt){var $t=this._filterScalingX,Lt=this._filterScalingY,jt=this.width,Ft=this.height,Gt=Math.min,Ht=Math.max,qt=Ht(this.cropX,0),Kt=Ht(this.cropY,0),rr=wt.naturalWidth||wt.width,ir=wt.naturalHeight||wt.height,or=qt*$t,jr=Kt*Lt,qr=Gt(jt*$t,rr-or),Yr=Gt(Ft*Lt,ir-jr),vn=-jt/2,ko=-Ft/2,Xo=Gt(jt,rr/$t-qt),zo=Gt(Ft,ir/Lt-Kt);wt&&pt.drawImage(wt,or,jr,qr,Yr,vn,ko,Xo,zo)}},_needsResize:function(){var pt=this.getTotalObjectScaling();return pt.scaleX!==this._lastScaleX||pt.scaleY!==this._lastScaleY},_resetWidthHeight:function(){this.set(this.getOriginalSize())},_initElement:function(pt,wt){this.setElement(g.util.getById(pt),wt),g.util.addClass(this.getElement(),g.Image.CSS_CANVAS)},_initConfig:function(pt){pt||(pt={}),this.setOptions(pt),this._setWidthHeight(pt)},_initFilters:function(pt,wt){pt&&pt.length?g.util.enlivenObjects(pt,function($t){wt&&wt($t)},"fabric.Image.filters"):wt&&wt()},_setWidthHeight:function(pt){pt||(pt={});var wt=this.getElement();this.width=pt.width||wt.naturalWidth||wt.width||0,this.height=pt.height||wt.naturalHeight||wt.height||0},parsePreserveAspectRatioAttribute:function(){var pt=g.util.parsePreserveAspectRatioAttribute(this.preserveAspectRatio||""),wt=this._element.width,$t=this._element.height,Lt=1,jt=1,Ft=0,Gt=0,Ht=0,qt=0,Kt,rr=this.width,ir=this.height,or={width:rr,height:ir};return pt&&(pt.alignX!=="none"||pt.alignY!=="none")?(pt.meetOrSlice==="meet"&&(Lt=jt=g.util.findScaleToFit(this._element,or),Kt=(rr-wt*Lt)/2,pt.alignX==="Min"&&(Ft=-Kt),pt.alignX==="Max"&&(Ft=Kt),Kt=(ir-$t*jt)/2,pt.alignY==="Min"&&(Gt=-Kt),pt.alignY==="Max"&&(Gt=Kt)),pt.meetOrSlice==="slice"&&(Lt=jt=g.util.findScaleToCover(this._element,or),Kt=wt-rr/Lt,pt.alignX==="Mid"&&(Ht=Kt/2),pt.alignX==="Max"&&(Ht=Kt),Kt=$t-ir/jt,pt.alignY==="Mid"&&(qt=Kt/2),pt.alignY==="Max"&&(qt=Kt),wt=rr/Lt,$t=ir/jt)):(Lt=rr/wt,jt=ir/$t),{width:wt,height:$t,scaleX:Lt,scaleY:jt,offsetLeft:Ft,offsetTop:Gt,cropX:Ht,cropY:qt}}}),g.Image.CSS_CANVAS="canvas-img",g.Image.prototype.getSvgSrc=g.Image.prototype.getSrc,g.Image.fromObject=function(pt,wt){var $t=g.util.object.clone(pt);g.util.loadImage($t.src,function(Lt,jt){if(jt){wt&&wt(null,!0);return}g.Image.prototype._initFilters.call($t,$t.filters,function(Ft){$t.filters=Ft||[],g.Image.prototype._initFilters.call($t,[$t.resizeFilter],function(Gt){$t.resizeFilter=Gt[0],g.util.enlivenObjectEnlivables($t,$t,function(){var Ht=new g.Image(Lt,$t);wt(Ht,!1)})})})},null,$t.crossOrigin)},g.Image.fromURL=function(pt,wt,$t){g.util.loadImage(pt,function(Lt,jt){wt&&wt(new g.Image(Lt,$t),jt)},null,$t&&$t.crossOrigin)},g.Image.ATTRIBUTE_NAMES=g.SHARED_ATTRIBUTES.concat("x y width height preserveAspectRatio xlink:href crossOrigin image-rendering".split(" ")),g.Image.fromElement=function(pt,wt,$t){var Lt=g.parseAttributes(pt,g.Image.ATTRIBUTE_NAMES);g.Image.fromURL(Lt["xlink:href"],wt,Ct($t?g.util.object.clone($t):{},Lt))}}(d),g.util.object.extend(g.Object.prototype,{_getAngleValueForStraighten:function(){var Tt=this.angle%360;return Tt>0?Math.round((Tt-1)/90)*90:Math.round(Tt/90)*90},straighten:function(){return this.rotate(this._getAngleValueForStraighten())},fxStraighten:function(Tt){Tt=Tt||{};var Ct=function(){},pt=Tt.onComplete||Ct,wt=Tt.onChange||Ct,$t=this;return g.util.animate({target:this,startValue:this.get("angle"),endValue:this._getAngleValueForStraighten(),duration:this.FX_DURATION,onChange:function(Lt){$t.rotate(Lt),wt()},onComplete:function(){$t.setCoords(),pt()}})}}),g.util.object.extend(g.StaticCanvas.prototype,{straightenObject:function(Tt){return Tt.straighten(),this.requestRenderAll(),this},fxStraightenObject:function(Tt){return Tt.fxStraighten({onChange:this.requestRenderAllBound})}}),function(){function Tt(pt,wt){var $t="precision "+wt+` float;
void main(){}`,Lt=pt.createShader(pt.FRAGMENT_SHADER);return pt.shaderSource(Lt,$t),pt.compileShader(Lt),!!pt.getShaderParameter(Lt,pt.COMPILE_STATUS)}g.isWebglSupported=function(pt){if(g.isLikelyNode)return!1;pt=pt||g.WebglFilterBackend.prototype.tileSize;var wt=document.createElement("canvas"),$t=wt.getContext("webgl")||wt.getContext("experimental-webgl"),Lt=!1;if($t){g.maxTextureSize=$t.getParameter($t.MAX_TEXTURE_SIZE),Lt=g.maxTextureSize>=pt;for(var jt=["highp","mediump","lowp"],Ft=0;Ft<3;Ft++)if(Tt($t,jt[Ft])){g.webGlPrecision=jt[Ft];break}}return this.isSupported=Lt,Lt},g.WebglFilterBackend=Ct;function Ct(pt){pt&&pt.tileSize&&(this.tileSize=pt.tileSize),this.setupGLContext(this.tileSize,this.tileSize),this.captureGPUInfo()}Ct.prototype={tileSize:2048,resources:{},setupGLContext:function(pt,wt){this.dispose(),this.createWebGLCanvas(pt,wt),this.aPosition=new Float32Array([0,0,0,1,1,0,1,1]),this.chooseFastestCopyGLTo2DMethod(pt,wt)},chooseFastestCopyGLTo2DMethod:function(pt,wt){var $t=typeof window.performance<"u",Lt;try{new ImageData(1,1),Lt=!0}catch{Lt=!1}var jt=typeof ArrayBuffer<"u",Ft=typeof Uint8ClampedArray<"u";if($t&&Lt&&jt&&Ft){var Gt=g.util.createCanvasElement(),Ht=new ArrayBuffer(pt*wt*4);if(g.forceGLPutImageData){this.imageBuffer=Ht,this.copyGLTo2D=vt;return}var qt={imageBuffer:Ht,destinationWidth:pt,destinationHeight:wt,targetCanvas:Gt},Kt,rr,ir;Gt.width=pt,Gt.height=wt,Kt=window.performance.now(),at.call(qt,this.gl,qt),rr=window.performance.now()-Kt,Kt=window.performance.now(),vt.call(qt,this.gl,qt),ir=window.performance.now()-Kt,rr>ir?(this.imageBuffer=Ht,this.copyGLTo2D=vt):this.copyGLTo2D=at}},createWebGLCanvas:function(pt,wt){var $t=g.util.createCanvasElement();$t.width=pt,$t.height=wt;var Lt={alpha:!0,premultipliedAlpha:!1,depth:!1,stencil:!1,antialias:!1},jt=$t.getContext("webgl",Lt);jt||(jt=$t.getContext("experimental-webgl",Lt)),jt&&(jt.clearColor(0,0,0,0),this.canvas=$t,this.gl=jt)},applyFilters:function(pt,wt,$t,Lt,jt,Ft){var Gt=this.gl,Ht;Ft&&(Ht=this.getCachedTexture(Ft,wt));var qt={originalWidth:wt.width||wt.originalWidth,originalHeight:wt.height||wt.originalHeight,sourceWidth:$t,sourceHeight:Lt,destinationWidth:$t,destinationHeight:Lt,context:Gt,sourceTexture:this.createTexture(Gt,$t,Lt,!Ht&&wt),targetTexture:this.createTexture(Gt,$t,Lt),originalTexture:Ht||this.createTexture(Gt,$t,Lt,!Ht&&wt),passes:pt.length,webgl:!0,aPosition:this.aPosition,programCache:this.programCache,pass:0,filterBackend:this,targetCanvas:jt},Kt=Gt.createFramebuffer();return Gt.bindFramebuffer(Gt.FRAMEBUFFER,Kt),pt.forEach(function(rr){rr&&rr.applyTo(qt)}),st(qt),this.copyGLTo2D(Gt,qt),Gt.bindTexture(Gt.TEXTURE_2D,null),Gt.deleteTexture(qt.sourceTexture),Gt.deleteTexture(qt.targetTexture),Gt.deleteFramebuffer(Kt),jt.getContext("2d").setTransform(1,0,0,1,0,0),qt},dispose:function(){this.canvas&&(this.canvas=null,this.gl=null),this.clearWebGLCaches()},clearWebGLCaches:function(){this.programCache={},this.textureCache={}},createTexture:function(pt,wt,$t,Lt,jt){var Ft=pt.createTexture();return pt.bindTexture(pt.TEXTURE_2D,Ft),pt.texParameteri(pt.TEXTURE_2D,pt.TEXTURE_MAG_FILTER,jt||pt.NEAREST),pt.texParameteri(pt.TEXTURE_2D,pt.TEXTURE_MIN_FILTER,jt||pt.NEAREST),pt.texParameteri(pt.TEXTURE_2D,pt.TEXTURE_WRAP_S,pt.CLAMP_TO_EDGE),pt.texParameteri(pt.TEXTURE_2D,pt.TEXTURE_WRAP_T,pt.CLAMP_TO_EDGE),Lt?pt.texImage2D(pt.TEXTURE_2D,0,pt.RGBA,pt.RGBA,pt.UNSIGNED_BYTE,Lt):pt.texImage2D(pt.TEXTURE_2D,0,pt.RGBA,wt,$t,0,pt.RGBA,pt.UNSIGNED_BYTE,null),Ft},getCachedTexture:function(pt,wt){if(this.textureCache[pt])return this.textureCache[pt];var $t=this.createTexture(this.gl,wt.width,wt.height,wt);return this.textureCache[pt]=$t,$t},evictCachesForKey:function(pt){this.textureCache[pt]&&(this.gl.deleteTexture(this.textureCache[pt]),delete this.textureCache[pt])},copyGLTo2D:at,captureGPUInfo:function(){if(this.gpuInfo)return this.gpuInfo;var pt=this.gl,wt={renderer:"",vendor:""};if(!pt)return wt;var $t=pt.getExtension("WEBGL_debug_renderer_info");if($t){var Lt=pt.getParameter($t.UNMASKED_RENDERER_WEBGL),jt=pt.getParameter($t.UNMASKED_VENDOR_WEBGL);Lt&&(wt.renderer=Lt.toLowerCase()),jt&&(wt.vendor=jt.toLowerCase())}return this.gpuInfo=wt,wt}}}();function st(Tt){var Ct=Tt.targetCanvas,pt=Ct.width,wt=Ct.height,$t=Tt.destinationWidth,Lt=Tt.destinationHeight;(pt!==$t||wt!==Lt)&&(Ct.width=$t,Ct.height=Lt)}function at(Tt,Ct){var pt=Tt.canvas,wt=Ct.targetCanvas,$t=wt.getContext("2d");$t.translate(0,wt.height),$t.scale(1,-1);var Lt=pt.height-wt.height;$t.drawImage(pt,0,Lt,wt.width,wt.height,0,0,wt.width,wt.height)}function vt(Tt,Ct){var pt=Ct.targetCanvas,wt=pt.getContext("2d"),$t=Ct.destinationWidth,Lt=Ct.destinationHeight,jt=$t*Lt*4,Ft=new Uint8Array(this.imageBuffer,0,jt),Gt=new Uint8ClampedArray(this.imageBuffer,0,jt);Tt.readPixels(0,0,$t,Lt,Tt.RGBA,Tt.UNSIGNED_BYTE,Ft);var Ht=new ImageData(Gt,$t,Lt);wt.putImageData(Ht,0,0)}(function(){var Tt=function(){};g.Canvas2dFilterBackend=Ct;function Ct(){}Ct.prototype={evictCachesForKey:Tt,dispose:Tt,clearWebGLCaches:Tt,resources:{},applyFilters:function(pt,wt,$t,Lt,jt){var Ft=jt.getContext("2d");Ft.drawImage(wt,0,0,$t,Lt);var Gt=Ft.getImageData(0,0,$t,Lt),Ht=Ft.getImageData(0,0,$t,Lt),qt={sourceWidth:$t,sourceHeight:Lt,imageData:Gt,originalEl:wt,originalImageData:Ht,canvasEl:jt,ctx:Ft,filterBackend:this};return pt.forEach(function(Kt){Kt.applyTo(qt)}),(qt.imageData.width!==$t||qt.imageData.height!==Lt)&&(jt.width=qt.imageData.width,jt.height=qt.imageData.height),Ft.putImageData(qt.imageData,0,0),qt}}})(),g.Image=g.Image||{},g.Image.filters=g.Image.filters||{},g.Image.filters.BaseFilter=g.util.createClass({type:"BaseFilter",vertexSource:`attribute vec2 aPosition;
varying vec2 vTexCoord;
void main() {
vTexCoord = aPosition;
gl_Position = vec4(aPosition * 2.0 - 1.0, 0.0, 1.0);
}`,fragmentSource:`precision highp float;
varying vec2 vTexCoord;
uniform sampler2D uTexture;
void main() {
gl_FragColor = texture2D(uTexture, vTexCoord);
}`,initialize:function(Tt){Tt&&this.setOptions(Tt)},setOptions:function(Tt){for(var Ct in Tt)this[Ct]=Tt[Ct]},createProgram:function(Tt,Ct,pt){Ct=Ct||this.fragmentSource,pt=pt||this.vertexSource,g.webGlPrecision!=="highp"&&(Ct=Ct.replace(/precision highp float/g,"precision "+g.webGlPrecision+" float"));var wt=Tt.createShader(Tt.VERTEX_SHADER);if(Tt.shaderSource(wt,pt),Tt.compileShader(wt),!Tt.getShaderParameter(wt,Tt.COMPILE_STATUS))throw new Error("Vertex shader compile error for "+this.type+": "+Tt.getShaderInfoLog(wt));var $t=Tt.createShader(Tt.FRAGMENT_SHADER);if(Tt.shaderSource($t,Ct),Tt.compileShader($t),!Tt.getShaderParameter($t,Tt.COMPILE_STATUS))throw new Error("Fragment shader compile error for "+this.type+": "+Tt.getShaderInfoLog($t));var Lt=Tt.createProgram();if(Tt.attachShader(Lt,wt),Tt.attachShader(Lt,$t),Tt.linkProgram(Lt),!Tt.getProgramParameter(Lt,Tt.LINK_STATUS))throw new Error('Shader link error for "${this.type}" '+Tt.getProgramInfoLog(Lt));var jt=this.getAttributeLocations(Tt,Lt),Ft=this.getUniformLocations(Tt,Lt)||{};return Ft.uStepW=Tt.getUniformLocation(Lt,"uStepW"),Ft.uStepH=Tt.getUniformLocation(Lt,"uStepH"),{program:Lt,attributeLocations:jt,uniformLocations:Ft}},getAttributeLocations:function(Tt,Ct){return{aPosition:Tt.getAttribLocation(Ct,"aPosition")}},getUniformLocations:function(){return{}},sendAttributeData:function(Tt,Ct,pt){var wt=Ct.aPosition,$t=Tt.createBuffer();Tt.bindBuffer(Tt.ARRAY_BUFFER,$t),Tt.enableVertexAttribArray(wt),Tt.vertexAttribPointer(wt,2,Tt.FLOAT,!1,0,0),Tt.bufferData(Tt.ARRAY_BUFFER,pt,Tt.STATIC_DRAW)},_setupFrameBuffer:function(Tt){var Ct=Tt.context,pt,wt;Tt.passes>1?(pt=Tt.destinationWidth,wt=Tt.destinationHeight,(Tt.sourceWidth!==pt||Tt.sourceHeight!==wt)&&(Ct.deleteTexture(Tt.targetTexture),Tt.targetTexture=Tt.filterBackend.createTexture(Ct,pt,wt)),Ct.framebufferTexture2D(Ct.FRAMEBUFFER,Ct.COLOR_ATTACHMENT0,Ct.TEXTURE_2D,Tt.targetTexture,0)):(Ct.bindFramebuffer(Ct.FRAMEBUFFER,null),Ct.finish())},_swapTextures:function(Tt){Tt.passes--,Tt.pass++;var Ct=Tt.targetTexture;Tt.targetTexture=Tt.sourceTexture,Tt.sourceTexture=Ct},isNeutralState:function(){var Tt=this.mainParameter,Ct=g.Image.filters[this.type].prototype;if(Tt)if(Array.isArray(Ct[Tt])){for(var pt=Ct[Tt].length;pt--;)if(this[Tt][pt]!==Ct[Tt][pt])return!1;return!0}else return Ct[Tt]===this[Tt];else return!1},applyTo:function(Tt){Tt.webgl?(this._setupFrameBuffer(Tt),this.applyToWebGL(Tt),this._swapTextures(Tt)):this.applyTo2d(Tt)},retrieveShader:function(Tt){return Tt.programCache.hasOwnProperty(this.type)||(Tt.programCache[this.type]=this.createProgram(Tt.context)),Tt.programCache[this.type]},applyToWebGL:function(Tt){var Ct=Tt.context,pt=this.retrieveShader(Tt);Tt.pass===0&&Tt.originalTexture?Ct.bindTexture(Ct.TEXTURE_2D,Tt.originalTexture):Ct.bindTexture(Ct.TEXTURE_2D,Tt.sourceTexture),Ct.useProgram(pt.program),this.sendAttributeData(Ct,pt.attributeLocations,Tt.aPosition),Ct.uniform1f(pt.uniformLocations.uStepW,1/Tt.sourceWidth),Ct.uniform1f(pt.uniformLocations.uStepH,1/Tt.sourceHeight),this.sendUniformData(Ct,pt.uniformLocations),Ct.viewport(0,0,Tt.destinationWidth,Tt.destinationHeight),Ct.drawArrays(Ct.TRIANGLE_STRIP,0,4)},bindAdditionalTexture:function(Tt,Ct,pt){Tt.activeTexture(pt),Tt.bindTexture(Tt.TEXTURE_2D,Ct),Tt.activeTexture(Tt.TEXTURE0)},unbindAdditionalTexture:function(Tt,Ct){Tt.activeTexture(Ct),Tt.bindTexture(Tt.TEXTURE_2D,null),Tt.activeTexture(Tt.TEXTURE0)},getMainParameter:function(){return this[this.mainParameter]},setMainParameter:function(Tt){this[this.mainParameter]=Tt},sendUniformData:function(){},createHelpLayer:function(Tt){if(!Tt.helpLayer){var Ct=document.createElement("canvas");Ct.width=Tt.sourceWidth,Ct.height=Tt.sourceHeight,Tt.helpLayer=Ct}},toObject:function(){var Tt={type:this.type},Ct=this.mainParameter;return Ct&&(Tt[Ct]=this[Ct]),Tt},toJSON:function(){return this.toObject()}}),g.Image.filters.BaseFilter.fromObject=function(Tt,Ct){var pt=new g.Image.filters[Tt.type](Tt);return Ct&&Ct(pt),pt},function(Tt){var Ct=Tt.fabric||(Tt.fabric={}),pt=Ct.Image.filters,wt=Ct.util.createClass;pt.ColorMatrix=wt(pt.BaseFilter,{type:"ColorMatrix",fragmentSource:`precision highp float;
uniform sampler2D uTexture;
varying vec2 vTexCoord;
uniform mat4 uColorMatrix;
uniform vec4 uConstants;
void main() {
vec4 color = texture2D(uTexture, vTexCoord);
color *= uColorMatrix;
color += uConstants;
gl_FragColor = color;
}`,matrix:[1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0],mainParameter:"matrix",colorsOnly:!0,initialize:function($t){this.callSuper("initialize",$t),this.matrix=this.matrix.slice(0)},applyTo2d:function($t){var Lt=$t.imageData,jt=Lt.data,Ft=jt.length,Gt=this.matrix,Ht,qt,Kt,rr,ir,or=this.colorsOnly;for(ir=0;ir<Ft;ir+=4)Ht=jt[ir],qt=jt[ir+1],Kt=jt[ir+2],or?(jt[ir]=Ht*Gt[0]+qt*Gt[1]+Kt*Gt[2]+Gt[4]*255,jt[ir+1]=Ht*Gt[5]+qt*Gt[6]+Kt*Gt[7]+Gt[9]*255,jt[ir+2]=Ht*Gt[10]+qt*Gt[11]+Kt*Gt[12]+Gt[14]*255):(rr=jt[ir+3],jt[ir]=Ht*Gt[0]+qt*Gt[1]+Kt*Gt[2]+rr*Gt[3]+Gt[4]*255,jt[ir+1]=Ht*Gt[5]+qt*Gt[6]+Kt*Gt[7]+rr*Gt[8]+Gt[9]*255,jt[ir+2]=Ht*Gt[10]+qt*Gt[11]+Kt*Gt[12]+rr*Gt[13]+Gt[14]*255,jt[ir+3]=Ht*Gt[15]+qt*Gt[16]+Kt*Gt[17]+rr*Gt[18]+Gt[19]*255)},getUniformLocations:function($t,Lt){return{uColorMatrix:$t.getUniformLocation(Lt,"uColorMatrix"),uConstants:$t.getUniformLocation(Lt,"uConstants")}},sendUniformData:function($t,Lt){var jt=this.matrix,Ft=[jt[0],jt[1],jt[2],jt[3],jt[5],jt[6],jt[7],jt[8],jt[10],jt[11],jt[12],jt[13],jt[15],jt[16],jt[17],jt[18]],Gt=[jt[4],jt[9],jt[14],jt[19]];$t.uniformMatrix4fv(Lt.uColorMatrix,!1,Ft),$t.uniform4fv(Lt.uConstants,Gt)}}),Ct.Image.filters.ColorMatrix.fromObject=Ct.Image.filters.BaseFilter.fromObject}(d),function(Tt){var Ct=Tt.fabric||(Tt.fabric={}),pt=Ct.Image.filters,wt=Ct.util.createClass;pt.Brightness=wt(pt.BaseFilter,{type:"Brightness",fragmentSource:`precision highp float;
uniform sampler2D uTexture;
uniform float uBrightness;
varying vec2 vTexCoord;
void main() {
vec4 color = texture2D(uTexture, vTexCoord);
color.rgb += uBrightness;
gl_FragColor = color;
}`,brightness:0,mainParameter:"brightness",applyTo2d:function($t){if(this.brightness!==0){var Lt=$t.imageData,jt=Lt.data,Ft,Gt=jt.length,Ht=Math.round(this.brightness*255);for(Ft=0;Ft<Gt;Ft+=4)jt[Ft]=jt[Ft]+Ht,jt[Ft+1]=jt[Ft+1]+Ht,jt[Ft+2]=jt[Ft+2]+Ht}},getUniformLocations:function($t,Lt){return{uBrightness:$t.getUniformLocation(Lt,"uBrightness")}},sendUniformData:function($t,Lt){$t.uniform1f(Lt.uBrightness,this.brightness)}}),Ct.Image.filters.Brightness.fromObject=Ct.Image.filters.BaseFilter.fromObject}(d),function(Tt){var Ct=Tt.fabric||(Tt.fabric={}),pt=Ct.util.object.extend,wt=Ct.Image.filters,$t=Ct.util.createClass;wt.Convolute=$t(wt.BaseFilter,{type:"Convolute",opaque:!1,matrix:[0,0,0,0,1,0,0,0,0],fragmentSource:{Convolute_3_1:`precision highp float;
uniform sampler2D uTexture;
uniform float uMatrix[9];
uniform float uStepW;
uniform float uStepH;
varying vec2 vTexCoord;
void main() {
vec4 color = vec4(0, 0, 0, 0);
for (float h = 0.0; h < 3.0; h+=1.0) {
for (float w = 0.0; w < 3.0; w+=1.0) {
vec2 matrixPos = vec2(uStepW * (w - 1), uStepH * (h - 1));
color += texture2D(uTexture, vTexCoord + matrixPos) * uMatrix[int(h * 3.0 + w)];
}
}
gl_FragColor = color;
}`,Convolute_3_0:`precision highp float;
uniform sampler2D uTexture;
uniform float uMatrix[9];
uniform float uStepW;
uniform float uStepH;
varying vec2 vTexCoord;
void main() {
vec4 color = vec4(0, 0, 0, 1);
for (float h = 0.0; h < 3.0; h+=1.0) {
for (float w = 0.0; w < 3.0; w+=1.0) {
vec2 matrixPos = vec2(uStepW * (w - 1.0), uStepH * (h - 1.0));
color.rgb += texture2D(uTexture, vTexCoord + matrixPos).rgb * uMatrix[int(h * 3.0 + w)];
}
}
float alpha = texture2D(uTexture, vTexCoord).a;
gl_FragColor = color;
gl_FragColor.a = alpha;
}`,Convolute_5_1:`precision highp float;
uniform sampler2D uTexture;
uniform float uMatrix[25];
uniform float uStepW;
uniform float uStepH;
varying vec2 vTexCoord;
void main() {
vec4 color = vec4(0, 0, 0, 0);
for (float h = 0.0; h < 5.0; h+=1.0) {
for (float w = 0.0; w < 5.0; w+=1.0) {
vec2 matrixPos = vec2(uStepW * (w - 2.0), uStepH * (h - 2.0));
color += texture2D(uTexture, vTexCoord + matrixPos) * uMatrix[int(h * 5.0 + w)];
}
}
gl_FragColor = color;
}`,Convolute_5_0:`precision highp float;
uniform sampler2D uTexture;
uniform float uMatrix[25];
uniform float uStepW;
uniform float uStepH;
varying vec2 vTexCoord;
void main() {
vec4 color = vec4(0, 0, 0, 1);
for (float h = 0.0; h < 5.0; h+=1.0) {
for (float w = 0.0; w < 5.0; w+=1.0) {
vec2 matrixPos = vec2(uStepW * (w - 2.0), uStepH * (h - 2.0));
color.rgb += texture2D(uTexture, vTexCoord + matrixPos).rgb * uMatrix[int(h * 5.0 + w)];
}
}
float alpha = texture2D(uTexture, vTexCoord).a;
gl_FragColor = color;
gl_FragColor.a = alpha;
}`,Convolute_7_1:`precision highp float;
uniform sampler2D uTexture;
uniform float uMatrix[49];
uniform float uStepW;
uniform float uStepH;
varying vec2 vTexCoord;
void main() {
vec4 color = vec4(0, 0, 0, 0);
for (float h = 0.0; h < 7.0; h+=1.0) {
for (float w = 0.0; w < 7.0; w+=1.0) {
vec2 matrixPos = vec2(uStepW * (w - 3.0), uStepH * (h - 3.0));
color += texture2D(uTexture, vTexCoord + matrixPos) * uMatrix[int(h * 7.0 + w)];
}
}
gl_FragColor = color;
}`,Convolute_7_0:`precision highp float;
uniform sampler2D uTexture;
uniform float uMatrix[49];
uniform float uStepW;
uniform float uStepH;
varying vec2 vTexCoord;
void main() {
vec4 color = vec4(0, 0, 0, 1);
for (float h = 0.0; h < 7.0; h+=1.0) {
for (float w = 0.0; w < 7.0; w+=1.0) {
vec2 matrixPos = vec2(uStepW * (w - 3.0), uStepH * (h - 3.0));
color.rgb += texture2D(uTexture, vTexCoord + matrixPos).rgb * uMatrix[int(h * 7.0 + w)];
}
}
float alpha = texture2D(uTexture, vTexCoord).a;
gl_FragColor = color;
gl_FragColor.a = alpha;
}`,Convolute_9_1:`precision highp float;
uniform sampler2D uTexture;
uniform float uMatrix[81];
uniform float uStepW;
uniform float uStepH;
varying vec2 vTexCoord;
void main() {
vec4 color = vec4(0, 0, 0, 0);
for (float h = 0.0; h < 9.0; h+=1.0) {
for (float w = 0.0; w < 9.0; w+=1.0) {
vec2 matrixPos = vec2(uStepW * (w - 4.0), uStepH * (h - 4.0));
color += texture2D(uTexture, vTexCoord + matrixPos) * uMatrix[int(h * 9.0 + w)];
}
}
gl_FragColor = color;
}`,Convolute_9_0:`precision highp float;
uniform sampler2D uTexture;
uniform float uMatrix[81];
uniform float uStepW;
uniform float uStepH;
varying vec2 vTexCoord;
void main() {
vec4 color = vec4(0, 0, 0, 1);
for (float h = 0.0; h < 9.0; h+=1.0) {
for (float w = 0.0; w < 9.0; w+=1.0) {
vec2 matrixPos = vec2(uStepW * (w - 4.0), uStepH * (h - 4.0));
color.rgb += texture2D(uTexture, vTexCoord + matrixPos).rgb * uMatrix[int(h * 9.0 + w)];
}
}
float alpha = texture2D(uTexture, vTexCoord).a;
gl_FragColor = color;
gl_FragColor.a = alpha;
}`},retrieveShader:function(Lt){var jt=Math.sqrt(this.matrix.length),Ft=this.type+"_"+jt+"_"+(this.opaque?1:0),Gt=this.fragmentSource[Ft];return Lt.programCache.hasOwnProperty(Ft)||(Lt.programCache[Ft]=this.createProgram(Lt.context,Gt)),Lt.programCache[Ft]},applyTo2d:function(Lt){var jt=Lt.imageData,Ft=jt.data,Gt=this.matrix,Ht=Math.round(Math.sqrt(Gt.length)),qt=Math.floor(Ht/2),Kt=jt.width,rr=jt.height,ir=Lt.ctx.createImageData(Kt,rr),or=ir.data,jr=this.opaque?1:0,qr,Yr,vn,ko,Xo,zo,t0,Uo,No,_n,Kr,e0,Zr;for(Kr=0;Kr<rr;Kr++)for(_n=0;_n<Kt;_n++){for(Xo=(Kr*Kt+_n)*4,qr=0,Yr=0,vn=0,ko=0,Zr=0;Zr<Ht;Zr++)for(e0=0;e0<Ht;e0++)t0=Kr+Zr-qt,zo=_n+e0-qt,!(t0<0||t0>=rr||zo<0||zo>=Kt)&&(Uo=(t0*Kt+zo)*4,No=Gt[Zr*Ht+e0],qr+=Ft[Uo]*No,Yr+=Ft[Uo+1]*No,vn+=Ft[Uo+2]*No,jr||(ko+=Ft[Uo+3]*No));or[Xo]=qr,or[Xo+1]=Yr,or[Xo+2]=vn,jr?or[Xo+3]=Ft[Xo+3]:or[Xo+3]=ko}Lt.imageData=ir},getUniformLocations:function(Lt,jt){return{uMatrix:Lt.getUniformLocation(jt,"uMatrix"),uOpaque:Lt.getUniformLocation(jt,"uOpaque"),uHalfSize:Lt.getUniformLocation(jt,"uHalfSize"),uSize:Lt.getUniformLocation(jt,"uSize")}},sendUniformData:function(Lt,jt){Lt.uniform1fv(jt.uMatrix,this.matrix)},toObject:function(){return pt(this.callSuper("toObject"),{opaque:this.opaque,matrix:this.matrix})}}),Ct.Image.filters.Convolute.fromObject=Ct.Image.filters.BaseFilter.fromObject}(d),function(Tt){var Ct=Tt.fabric||(Tt.fabric={}),pt=Ct.Image.filters,wt=Ct.util.createClass;pt.Grayscale=wt(pt.BaseFilter,{type:"Grayscale",fragmentSource:{average:`precision highp float;
uniform sampler2D uTexture;
varying vec2 vTexCoord;
void main() {
vec4 color = texture2D(uTexture, vTexCoord);
float average = (color.r + color.b + color.g) / 3.0;
gl_FragColor = vec4(average, average, average, color.a);
}`,lightness:`precision highp float;
uniform sampler2D uTexture;
uniform int uMode;
varying vec2 vTexCoord;
void main() {
vec4 col = texture2D(uTexture, vTexCoord);
float average = (max(max(col.r, col.g),col.b) + min(min(col.r, col.g),col.b)) / 2.0;
gl_FragColor = vec4(average, average, average, col.a);
}`,luminosity:`precision highp float;
uniform sampler2D uTexture;
uniform int uMode;
varying vec2 vTexCoord;
void main() {
vec4 col = texture2D(uTexture, vTexCoord);
float average = 0.21 * col.r + 0.72 * col.g + 0.07 * col.b;
gl_FragColor = vec4(average, average, average, col.a);
}`},mode:"average",mainParameter:"mode",applyTo2d:function($t){var Lt=$t.imageData,jt=Lt.data,Ft,Gt=jt.length,Ht,qt=this.mode;for(Ft=0;Ft<Gt;Ft+=4)qt==="average"?Ht=(jt[Ft]+jt[Ft+1]+jt[Ft+2])/3:qt==="lightness"?Ht=(Math.min(jt[Ft],jt[Ft+1],jt[Ft+2])+Math.max(jt[Ft],jt[Ft+1],jt[Ft+2]))/2:qt==="luminosity"&&(Ht=.21*jt[Ft]+.72*jt[Ft+1]+.07*jt[Ft+2]),jt[Ft]=Ht,jt[Ft+1]=Ht,jt[Ft+2]=Ht},retrieveShader:function($t){var Lt=this.type+"_"+this.mode;if(!$t.programCache.hasOwnProperty(Lt)){var jt=this.fragmentSource[this.mode];$t.programCache[Lt]=this.createProgram($t.context,jt)}return $t.programCache[Lt]},getUniformLocations:function($t,Lt){return{uMode:$t.getUniformLocation(Lt,"uMode")}},sendUniformData:function($t,Lt){var jt=1;$t.uniform1i(Lt.uMode,jt)},isNeutralState:function(){return!1}}),Ct.Image.filters.Grayscale.fromObject=Ct.Image.filters.BaseFilter.fromObject}(d),function(Tt){var Ct=Tt.fabric||(Tt.fabric={}),pt=Ct.Image.filters,wt=Ct.util.createClass;pt.Invert=wt(pt.BaseFilter,{type:"Invert",fragmentSource:`precision highp float;
uniform sampler2D uTexture;
uniform int uInvert;
varying vec2 vTexCoord;
void main() {
vec4 color = texture2D(uTexture, vTexCoord);
if (uInvert == 1) {
gl_FragColor = vec4(1.0 - color.r,1.0 -color.g,1.0 -color.b,color.a);
} else {
gl_FragColor = color;
}
}`,invert:!0,mainParameter:"invert",applyTo2d:function($t){var Lt=$t.imageData,jt=Lt.data,Ft,Gt=jt.length;for(Ft=0;Ft<Gt;Ft+=4)jt[Ft]=255-jt[Ft],jt[Ft+1]=255-jt[Ft+1],jt[Ft+2]=255-jt[Ft+2]},isNeutralState:function(){return!this.invert},getUniformLocations:function($t,Lt){return{uInvert:$t.getUniformLocation(Lt,"uInvert")}},sendUniformData:function($t,Lt){$t.uniform1i(Lt.uInvert,this.invert)}}),Ct.Image.filters.Invert.fromObject=Ct.Image.filters.BaseFilter.fromObject}(d),function(Tt){var Ct=Tt.fabric||(Tt.fabric={}),pt=Ct.util.object.extend,wt=Ct.Image.filters,$t=Ct.util.createClass;wt.Noise=$t(wt.BaseFilter,{type:"Noise",fragmentSource:`precision highp float;
uniform sampler2D uTexture;
uniform float uStepH;
uniform float uNoise;
uniform float uSeed;
varying vec2 vTexCoord;
float rand(vec2 co, float seed, float vScale) {
return fract(sin(dot(co.xy * vScale ,vec2(12.9898 , 78.233))) * 43758.5453 * (seed + 0.01) / 2.0);
}
void main() {
vec4 color = texture2D(uTexture, vTexCoord);
color.rgb += (0.5 - rand(vTexCoord, uSeed, 0.1 / uStepH)) * uNoise;
gl_FragColor = color;
}`,mainParameter:"noise",noise:0,applyTo2d:function(Lt){if(this.noise!==0){var jt=Lt.imageData,Ft=jt.data,Gt,Ht=Ft.length,qt=this.noise,Kt;for(Gt=0,Ht=Ft.length;Gt<Ht;Gt+=4)Kt=(.5-Math.random())*qt,Ft[Gt]+=Kt,Ft[Gt+1]+=Kt,Ft[Gt+2]+=Kt}},getUniformLocations:function(Lt,jt){return{uNoise:Lt.getUniformLocation(jt,"uNoise"),uSeed:Lt.getUniformLocation(jt,"uSeed")}},sendUniformData:function(Lt,jt){Lt.uniform1f(jt.uNoise,this.noise/255),Lt.uniform1f(jt.uSeed,Math.random())},toObject:function(){return pt(this.callSuper("toObject"),{noise:this.noise})}}),Ct.Image.filters.Noise.fromObject=Ct.Image.filters.BaseFilter.fromObject}(d),function(Tt){var Ct=Tt.fabric||(Tt.fabric={}),pt=Ct.Image.filters,wt=Ct.util.createClass;pt.Pixelate=wt(pt.BaseFilter,{type:"Pixelate",blocksize:4,mainParameter:"blocksize",fragmentSource:`precision highp float;
uniform sampler2D uTexture;
uniform float uBlocksize;
uniform float uStepW;
uniform float uStepH;
varying vec2 vTexCoord;
void main() {
float blockW = uBlocksize * uStepW;
float blockH = uBlocksize * uStepW;
int posX = int(vTexCoord.x / blockW);
int posY = int(vTexCoord.y / blockH);
float fposX = float(posX);
float fposY = float(posY);
vec2 squareCoords = vec2(fposX * blockW, fposY * blockH);
vec4 color = texture2D(uTexture, squareCoords);
gl_FragColor = color;
}`,applyTo2d:function($t){var Lt=$t.imageData,jt=Lt.data,Ft=Lt.height,Gt=Lt.width,Ht,qt,Kt,rr,ir,or,jr,qr,Yr,vn,ko;for(qt=0;qt<Ft;qt+=this.blocksize)for(Kt=0;Kt<Gt;Kt+=this.blocksize)for(Ht=qt*4*Gt+Kt*4,rr=jt[Ht],ir=jt[Ht+1],or=jt[Ht+2],jr=jt[Ht+3],vn=Math.min(qt+this.blocksize,Ft),ko=Math.min(Kt+this.blocksize,Gt),qr=qt;qr<vn;qr++)for(Yr=Kt;Yr<ko;Yr++)Ht=qr*4*Gt+Yr*4,jt[Ht]=rr,jt[Ht+1]=ir,jt[Ht+2]=or,jt[Ht+3]=jr},isNeutralState:function(){return this.blocksize===1},getUniformLocations:function($t,Lt){return{uBlocksize:$t.getUniformLocation(Lt,"uBlocksize"),uStepW:$t.getUniformLocation(Lt,"uStepW"),uStepH:$t.getUniformLocation(Lt,"uStepH")}},sendUniformData:function($t,Lt){$t.uniform1f(Lt.uBlocksize,this.blocksize)}}),Ct.Image.filters.Pixelate.fromObject=Ct.Image.filters.BaseFilter.fromObject}(d),function(Tt){var Ct=Tt.fabric||(Tt.fabric={}),pt=Ct.util.object.extend,wt=Ct.Image.filters,$t=Ct.util.createClass;wt.RemoveColor=$t(wt.BaseFilter,{type:"RemoveColor",color:"#FFFFFF",fragmentSource:`precision highp float;
uniform sampler2D uTexture;
uniform vec4 uLow;
uniform vec4 uHigh;
varying vec2 vTexCoord;
void main() {
gl_FragColor = texture2D(uTexture, vTexCoord);
if(all(greaterThan(gl_FragColor.rgb,uLow.rgb)) && all(greaterThan(uHigh.rgb,gl_FragColor.rgb))) {
gl_FragColor.a = 0.0;
}
}`,distance:.02,useAlpha:!1,applyTo2d:function(Lt){var jt=Lt.imageData,Ft=jt.data,Gt,Ht=this.distance*255,qt,Kt,rr,ir=new Ct.Color(this.color).getSource(),or=[ir[0]-Ht,ir[1]-Ht,ir[2]-Ht],jr=[ir[0]+Ht,ir[1]+Ht,ir[2]+Ht];for(Gt=0;Gt<Ft.length;Gt+=4)qt=Ft[Gt],Kt=Ft[Gt+1],rr=Ft[Gt+2],qt>or[0]&&Kt>or[1]&&rr>or[2]&&qt<jr[0]&&Kt<jr[1]&&rr<jr[2]&&(Ft[Gt+3]=0)},getUniformLocations:function(Lt,jt){return{uLow:Lt.getUniformLocation(jt,"uLow"),uHigh:Lt.getUniformLocation(jt,"uHigh")}},sendUniformData:function(Lt,jt){var Ft=new Ct.Color(this.color).getSource(),Gt=parseFloat(this.distance),Ht=[0+Ft[0]/255-Gt,0+Ft[1]/255-Gt,0+Ft[2]/255-Gt,1],qt=[Ft[0]/255+Gt,Ft[1]/255+Gt,Ft[2]/255+Gt,1];Lt.uniform4fv(jt.uLow,Ht),Lt.uniform4fv(jt.uHigh,qt)},toObject:function(){return pt(this.callSuper("toObject"),{color:this.color,distance:this.distance})}}),Ct.Image.filters.RemoveColor.fromObject=Ct.Image.filters.BaseFilter.fromObject}(d),function(Tt){var Ct=Tt.fabric||(Tt.fabric={}),pt=Ct.Image.filters,wt=Ct.util.createClass,$t={Brownie:[.5997,.34553,-.27082,0,.186,-.0377,.86095,.15059,0,-.1449,.24113,-.07441,.44972,0,-.02965,0,0,0,1,0],Vintage:[.62793,.32021,-.03965,0,.03784,.02578,.64411,.03259,0,.02926,.0466,-.08512,.52416,0,.02023,0,0,0,1,0],Kodachrome:[1.12855,-.39673,-.03992,0,.24991,-.16404,1.08352,-.05498,0,.09698,-.16786,-.56034,1.60148,0,.13972,0,0,0,1,0],Technicolor:[1.91252,-.85453,-.09155,0,.04624,-.30878,1.76589,-.10601,0,-.27589,-.2311,-.75018,1.84759,0,.12137,0,0,0,1,0],Polaroid:[1.438,-.062,-.062,0,0,-.122,1.378,-.122,0,0,-.016,-.016,1.483,0,0,0,0,0,1,0],Sepia:[.393,.769,.189,0,0,.349,.686,.168,0,0,.272,.534,.131,0,0,0,0,0,1,0],BlackWhite:[1.5,1.5,1.5,0,-1,1.5,1.5,1.5,0,-1,1.5,1.5,1.5,0,-1,0,0,0,1,0]};for(var Lt in $t)pt[Lt]=wt(pt.ColorMatrix,{type:Lt,matrix:$t[Lt],mainParameter:!1,colorsOnly:!0}),Ct.Image.filters[Lt].fromObject=Ct.Image.filters.BaseFilter.fromObject}(d),function(Tt){var Ct=Tt.fabric,pt=Ct.Image.filters,wt=Ct.util.createClass;pt.BlendColor=wt(pt.BaseFilter,{type:"BlendColor",color:"#F95C63",mode:"multiply",alpha:1,fragmentSource:{multiply:`gl_FragColor.rgb *= uColor.rgb;
`,screen:`gl_FragColor.rgb = 1.0 - (1.0 - gl_FragColor.rgb) * (1.0 - uColor.rgb);
`,add:`gl_FragColor.rgb += uColor.rgb;
`,diff:`gl_FragColor.rgb = abs(gl_FragColor.rgb - uColor.rgb);
`,subtract:`gl_FragColor.rgb -= uColor.rgb;
`,lighten:`gl_FragColor.rgb = max(gl_FragColor.rgb, uColor.rgb);
`,darken:`gl_FragColor.rgb = min(gl_FragColor.rgb, uColor.rgb);
`,exclusion:`gl_FragColor.rgb += uColor.rgb - 2.0 * (uColor.rgb * gl_FragColor.rgb);
`,overlay:`if (uColor.r < 0.5) {
gl_FragColor.r *= 2.0 * uColor.r;
} else {
gl_FragColor.r = 1.0 - 2.0 * (1.0 - gl_FragColor.r) * (1.0 - uColor.r);
}
if (uColor.g < 0.5) {
gl_FragColor.g *= 2.0 * uColor.g;
} else {
gl_FragColor.g = 1.0 - 2.0 * (1.0 - gl_FragColor.g) * (1.0 - uColor.g);
}
if (uColor.b < 0.5) {
gl_FragColor.b *= 2.0 * uColor.b;
} else {
gl_FragColor.b = 1.0 - 2.0 * (1.0 - gl_FragColor.b) * (1.0 - uColor.b);
}
`,tint:`gl_FragColor.rgb *= (1.0 - uColor.a);
gl_FragColor.rgb += uColor.rgb;
`},buildSource:function($t){return`precision highp float;
uniform sampler2D uTexture;
uniform vec4 uColor;
varying vec2 vTexCoord;
void main() {
vec4 color = texture2D(uTexture, vTexCoord);
gl_FragColor = color;
if (color.a > 0.0) {
`+this.fragmentSource[$t]+`}
}`},retrieveShader:function($t){var Lt=this.type+"_"+this.mode,jt;return $t.programCache.hasOwnProperty(Lt)||(jt=this.buildSource(this.mode),$t.programCache[Lt]=this.createProgram($t.context,jt)),$t.programCache[Lt]},applyTo2d:function($t){var Lt=$t.imageData,jt=Lt.data,Ft=jt.length,Gt,Ht,qt,Kt,rr,ir,or,jr=1-this.alpha;or=new Ct.Color(this.color).getSource(),Gt=or[0]*this.alpha,Ht=or[1]*this.alpha,qt=or[2]*this.alpha;for(var qr=0;qr<Ft;qr+=4)switch(Kt=jt[qr],rr=jt[qr+1],ir=jt[qr+2],this.mode){case"multiply":jt[qr]=Kt*Gt/255,jt[qr+1]=rr*Ht/255,jt[qr+2]=ir*qt/255;break;case"screen":jt[qr]=255-(255-Kt)*(255-Gt)/255,jt[qr+1]=255-(255-rr)*(255-Ht)/255,jt[qr+2]=255-(255-ir)*(255-qt)/255;break;case"add":jt[qr]=Kt+Gt,jt[qr+1]=rr+Ht,jt[qr+2]=ir+qt;break;case"diff":case"difference":jt[qr]=Math.abs(Kt-Gt),jt[qr+1]=Math.abs(rr-Ht),jt[qr+2]=Math.abs(ir-qt);break;case"subtract":jt[qr]=Kt-Gt,jt[qr+1]=rr-Ht,jt[qr+2]=ir-qt;break;case"darken":jt[qr]=Math.min(Kt,Gt),jt[qr+1]=Math.min(rr,Ht),jt[qr+2]=Math.min(ir,qt);break;case"lighten":jt[qr]=Math.max(Kt,Gt),jt[qr+1]=Math.max(rr,Ht),jt[qr+2]=Math.max(ir,qt);break;case"overlay":jt[qr]=Gt<128?2*Kt*Gt/255:255-2*(255-Kt)*(255-Gt)/255,jt[qr+1]=Ht<128?2*rr*Ht/255:255-2*(255-rr)*(255-Ht)/255,jt[qr+2]=qt<128?2*ir*qt/255:255-2*(255-ir)*(255-qt)/255;break;case"exclusion":jt[qr]=Gt+Kt-2*Gt*Kt/255,jt[qr+1]=Ht+rr-2*Ht*rr/255,jt[qr+2]=qt+ir-2*qt*ir/255;break;case"tint":jt[qr]=Gt+Kt*jr,jt[qr+1]=Ht+rr*jr,jt[qr+2]=qt+ir*jr}},getUniformLocations:function($t,Lt){return{uColor:$t.getUniformLocation(Lt,"uColor")}},sendUniformData:function($t,Lt){var jt=new Ct.Color(this.color).getSource();jt[0]=this.alpha*jt[0]/255,jt[1]=this.alpha*jt[1]/255,jt[2]=this.alpha*jt[2]/255,jt[3]=this.alpha,$t.uniform4fv(Lt.uColor,jt)},toObject:function(){return{type:this.type,color:this.color,mode:this.mode,alpha:this.alpha}}}),Ct.Image.filters.BlendColor.fromObject=Ct.Image.filters.BaseFilter.fromObject}(d),function(Tt){var Ct=Tt.fabric,pt=Ct.Image.filters,wt=Ct.util.createClass;pt.BlendImage=wt(pt.BaseFilter,{type:"BlendImage",image:null,mode:"multiply",alpha:1,vertexSource:`attribute vec2 aPosition;
varying vec2 vTexCoord;
varying vec2 vTexCoord2;
uniform mat3 uTransformMatrix;
void main() {
vTexCoord = aPosition;
vTexCoord2 = (uTransformMatrix * vec3(aPosition, 1.0)).xy;
gl_Position = vec4(aPosition * 2.0 - 1.0, 0.0, 1.0);
}`,fragmentSource:{multiply:`precision highp float;
uniform sampler2D uTexture;
uniform sampler2D uImage;
uniform vec4 uColor;
varying vec2 vTexCoord;
varying vec2 vTexCoord2;
void main() {
vec4 color = texture2D(uTexture, vTexCoord);
vec4 color2 = texture2D(uImage, vTexCoord2);
color.rgba *= color2.rgba;
gl_FragColor = color;
}`,mask:`precision highp float;
uniform sampler2D uTexture;
uniform sampler2D uImage;
uniform vec4 uColor;
varying vec2 vTexCoord;
varying vec2 vTexCoord2;
void main() {
vec4 color = texture2D(uTexture, vTexCoord);
vec4 color2 = texture2D(uImage, vTexCoord2);
color.a = color2.a;
gl_FragColor = color;
}`},retrieveShader:function($t){var Lt=this.type+"_"+this.mode,jt=this.fragmentSource[this.mode];return $t.programCache.hasOwnProperty(Lt)||($t.programCache[Lt]=this.createProgram($t.context,jt)),$t.programCache[Lt]},applyToWebGL:function($t){var Lt=$t.context,jt=this.createTexture($t.filterBackend,this.image);this.bindAdditionalTexture(Lt,jt,Lt.TEXTURE1),this.callSuper("applyToWebGL",$t),this.unbindAdditionalTexture(Lt,Lt.TEXTURE1)},createTexture:function($t,Lt){return $t.getCachedTexture(Lt.cacheKey,Lt._element)},calculateMatrix:function(){var $t=this.image,Lt=$t._element.width,jt=$t._element.height;return[1/$t.scaleX,0,0,0,1/$t.scaleY,0,-$t.left/Lt,-$t.top/jt,1]},applyTo2d:function($t){var Lt=$t.imageData,jt=$t.filterBackend.resources,Ft=Lt.data,Gt=Ft.length,Ht=Lt.width,qt=Lt.height,Kt,rr,ir,or,jr,qr,Yr,vn,ko,Xo,zo=this.image,t0;jt.blendImage||(jt.blendImage=Ct.util.createCanvasElement()),ko=jt.blendImage,Xo=ko.getContext("2d"),ko.width!==Ht||ko.height!==qt?(ko.width=Ht,ko.height=qt):Xo.clearRect(0,0,Ht,qt),Xo.setTransform(zo.scaleX,0,0,zo.scaleY,zo.left,zo.top),Xo.drawImage(zo._element,0,0,Ht,qt),t0=Xo.getImageData(0,0,Ht,qt).data;for(var Uo=0;Uo<Gt;Uo+=4)switch(jr=Ft[Uo],qr=Ft[Uo+1],Yr=Ft[Uo+2],vn=Ft[Uo+3],Kt=t0[Uo],rr=t0[Uo+1],ir=t0[Uo+2],or=t0[Uo+3],this.mode){case"multiply":Ft[Uo]=jr*Kt/255,Ft[Uo+1]=qr*rr/255,Ft[Uo+2]=Yr*ir/255,Ft[Uo+3]=vn*or/255;break;case"mask":Ft[Uo+3]=or;break}},getUniformLocations:function($t,Lt){return{uTransformMatrix:$t.getUniformLocation(Lt,"uTransformMatrix"),uImage:$t.getUniformLocation(Lt,"uImage")}},sendUniformData:function($t,Lt){var jt=this.calculateMatrix();$t.uniform1i(Lt.uImage,1),$t.uniformMatrix3fv(Lt.uTransformMatrix,!1,jt)},toObject:function(){return{type:this.type,image:this.image&&this.image.toObject(),mode:this.mode,alpha:this.alpha}}}),Ct.Image.filters.BlendImage.fromObject=function($t,Lt){Ct.Image.fromObject($t.image,function(jt){var Ft=Ct.util.object.clone($t);Ft.image=jt,Lt(new Ct.Image.filters.BlendImage(Ft))})}}(d),function(Tt){var Ct=Tt.fabric||(Tt.fabric={}),pt=Math.pow,wt=Math.floor,$t=Math.sqrt,Lt=Math.abs,jt=Math.round,Ft=Math.sin,Gt=Math.ceil,Ht=Ct.Image.filters,qt=Ct.util.createClass;Ht.Resize=qt(Ht.BaseFilter,{type:"Resize",resizeType:"hermite",scaleX:1,scaleY:1,lanczosLobes:3,getUniformLocations:function(Kt,rr){return{uDelta:Kt.getUniformLocation(rr,"uDelta"),uTaps:Kt.getUniformLocation(rr,"uTaps")}},sendUniformData:function(Kt,rr){Kt.uniform2fv(rr.uDelta,this.horizontal?[1/this.width,0]:[0,1/this.height]),Kt.uniform1fv(rr.uTaps,this.taps)},retrieveShader:function(Kt){var rr=this.getFilterWindow(),ir=this.type+"_"+rr;if(!Kt.programCache.hasOwnProperty(ir)){var or=this.generateShader(rr);Kt.programCache[ir]=this.createProgram(Kt.context,or)}return Kt.programCache[ir]},getFilterWindow:function(){var Kt=this.tempScale;return Math.ceil(this.lanczosLobes/Kt)},getTaps:function(){for(var Kt=this.lanczosCreate(this.lanczosLobes),rr=this.tempScale,ir=this.getFilterWindow(),or=new Array(ir),jr=1;jr<=ir;jr++)or[jr-1]=Kt(jr*rr);return or},generateShader:function(or){for(var rr=new Array(or),ir=this.fragmentSourceTOP,or,jr=1;jr<=or;jr++)rr[jr-1]=jr+".0 * uDelta";return ir+="uniform float uTaps["+or+`];
`,ir+=`void main() {
`,ir+=`  vec4 color = texture2D(uTexture, vTexCoord);
`,ir+=`  float sum = 1.0;
`,rr.forEach(function(qr,Yr){ir+="  color += texture2D(uTexture, vTexCoord + "+qr+") * uTaps["+Yr+`];
`,ir+="  color += texture2D(uTexture, vTexCoord - "+qr+") * uTaps["+Yr+`];
`,ir+="  sum += 2.0 * uTaps["+Yr+`];
`}),ir+=`  gl_FragColor = color / sum;
`,ir+="}",ir},fragmentSourceTOP:`precision highp float;
uniform sampler2D uTexture;
uniform vec2 uDelta;
varying vec2 vTexCoord;
`,applyTo:function(Kt){Kt.webgl?(Kt.passes++,this.width=Kt.sourceWidth,this.horizontal=!0,this.dW=Math.round(this.width*this.scaleX),this.dH=Kt.sourceHeight,this.tempScale=this.dW/this.width,this.taps=this.getTaps(),Kt.destinationWidth=this.dW,this._setupFrameBuffer(Kt),this.applyToWebGL(Kt),this._swapTextures(Kt),Kt.sourceWidth=Kt.destinationWidth,this.height=Kt.sourceHeight,this.horizontal=!1,this.dH=Math.round(this.height*this.scaleY),this.tempScale=this.dH/this.height,this.taps=this.getTaps(),Kt.destinationHeight=this.dH,this._setupFrameBuffer(Kt),this.applyToWebGL(Kt),this._swapTextures(Kt),Kt.sourceHeight=Kt.destinationHeight):this.applyTo2d(Kt)},isNeutralState:function(){return this.scaleX===1&&this.scaleY===1},lanczosCreate:function(Kt){return function(rr){if(rr>=Kt||rr<=-Kt)return 0;if(rr<11920929e-14&&rr>-11920929e-14)return 1;rr*=Math.PI;var ir=rr/Kt;return Ft(rr)/rr*Ft(ir)/ir}},applyTo2d:function(Kt){var rr=Kt.imageData,ir=this.scaleX,or=this.scaleY;this.rcpScaleX=1/ir,this.rcpScaleY=1/or;var jr=rr.width,qr=rr.height,Yr=jt(jr*ir),vn=jt(qr*or),ko;this.resizeType==="sliceHack"?ko=this.sliceByTwo(Kt,jr,qr,Yr,vn):this.resizeType==="hermite"?ko=this.hermiteFastResize(Kt,jr,qr,Yr,vn):this.resizeType==="bilinear"?ko=this.bilinearFiltering(Kt,jr,qr,Yr,vn):this.resizeType==="lanczos"&&(ko=this.lanczosResize(Kt,jr,qr,Yr,vn)),Kt.imageData=ko},sliceByTwo:function(Kt,rr,ir,or,jr){var qr=Kt.imageData,Yr=.5,vn=!1,ko=!1,Xo=rr*Yr,zo=ir*Yr,t0=Ct.filterBackend.resources,Uo,No,_n=0,Kr=0,e0=rr,Zr=0;for(t0.sliceByTwo||(t0.sliceByTwo=document.createElement("canvas")),Uo=t0.sliceByTwo,(Uo.width<rr*1.5||Uo.height<ir)&&(Uo.width=rr*1.5,Uo.height=ir),No=Uo.getContext("2d"),No.clearRect(0,0,rr*1.5,ir),No.putImageData(qr,0,0),or=wt(or),jr=wt(jr);!vn||!ko;)rr=Xo,ir=zo,or<wt(Xo*Yr)?Xo=wt(Xo*Yr):(Xo=or,vn=!0),jr<wt(zo*Yr)?zo=wt(zo*Yr):(zo=jr,ko=!0),No.drawImage(Uo,_n,Kr,rr,ir,e0,Zr,Xo,zo),_n=e0,Kr=Zr,Zr+=zo;return No.getImageData(_n,Kr,or,jr)},lanczosResize:function(Kt,rr,ir,or,jr){function qr(Sn){var Tn,n0,Go,An,a0,u0,d0,f0,y0,b0,O0;for(Zr.x=(Sn+.5)*zo,Ro.x=wt(Zr.x),Tn=0;Tn<jr;Tn++){for(Zr.y=(Tn+.5)*t0,Ro.y=wt(Zr.y),a0=0,u0=0,d0=0,f0=0,y0=0,n0=Ro.x-_n;n0<=Ro.x+_n;n0++)if(!(n0<0||n0>=rr)){b0=wt(1e3*Lt(n0-Zr.x)),e0[b0]||(e0[b0]={});for(var C0=Ro.y-Kr;C0<=Ro.y+Kr;C0++)C0<0||C0>=ir||(O0=wt(1e3*Lt(C0-Zr.y)),e0[b0][O0]||(e0[b0][O0]=Xo($t(pt(b0*Uo,2)+pt(O0*No,2))/1e3)),Go=e0[b0][O0],Go>0&&(An=(C0*rr+n0)*4,a0+=Go,u0+=Go*Yr[An],d0+=Go*Yr[An+1],f0+=Go*Yr[An+2],y0+=Go*Yr[An+3]))}An=(Tn*or+Sn)*4,ko[An]=u0/a0,ko[An+1]=d0/a0,ko[An+2]=f0/a0,ko[An+3]=y0/a0}return++Sn<or?qr(Sn):vn}var Yr=Kt.imageData.data,vn=Kt.ctx.createImageData(or,jr),ko=vn.data,Xo=this.lanczosCreate(this.lanczosLobes),zo=this.rcpScaleX,t0=this.rcpScaleY,Uo=2/this.rcpScaleX,No=2/this.rcpScaleY,_n=Gt(zo*this.lanczosLobes/2),Kr=Gt(t0*this.lanczosLobes/2),e0={},Zr={},Ro={};return qr(0)},bilinearFiltering:function(Kt,rr,ir,or,jr){var qr,Yr,vn,ko,Xo,zo,t0,Uo,No,_n,Kr,e0,Zr=0,Ro,Sn=this.rcpScaleX,Tn=this.rcpScaleY,n0=4*(rr-1),Go=Kt.imageData,An=Go.data,a0=Kt.ctx.createImageData(or,jr),u0=a0.data;for(t0=0;t0<jr;t0++)for(Uo=0;Uo<or;Uo++)for(Xo=wt(Sn*Uo),zo=wt(Tn*t0),No=Sn*Uo-Xo,_n=Tn*t0-zo,Ro=4*(zo*rr+Xo),Kr=0;Kr<4;Kr++)qr=An[Ro+Kr],Yr=An[Ro+4+Kr],vn=An[Ro+n0+Kr],ko=An[Ro+n0+4+Kr],e0=qr*(1-No)*(1-_n)+Yr*No*(1-_n)+vn*_n*(1-No)+ko*No*_n,u0[Zr++]=e0;return a0},hermiteFastResize:function(Kt,rr,ir,or,jr){for(var qr=this.rcpScaleX,Yr=this.rcpScaleY,vn=Gt(qr/2),ko=Gt(Yr/2),Xo=Kt.imageData,zo=Xo.data,t0=Kt.ctx.createImageData(or,jr),Uo=t0.data,No=0;No<jr;No++)for(var _n=0;_n<or;_n++){for(var Kr=(_n+No*or)*4,e0=0,Zr=0,Ro=0,Sn=0,Tn=0,n0=0,Go=0,An=(No+.5)*Yr,a0=wt(No*Yr);a0<(No+1)*Yr;a0++)for(var u0=Lt(An-(a0+.5))/ko,d0=(_n+.5)*qr,f0=u0*u0,y0=wt(_n*qr);y0<(_n+1)*qr;y0++){var b0=Lt(d0-(y0+.5))/vn,O0=$t(f0+b0*b0);O0>1&&O0<-1||(e0=2*O0*O0*O0-3*O0*O0+1,e0>0&&(b0=4*(y0+a0*rr),Go+=e0*zo[b0+3],Ro+=e0,zo[b0+3]<255&&(e0=e0*zo[b0+3]/250),Sn+=e0*zo[b0],Tn+=e0*zo[b0+1],n0+=e0*zo[b0+2],Zr+=e0))}Uo[Kr]=Sn/Zr,Uo[Kr+1]=Tn/Zr,Uo[Kr+2]=n0/Zr,Uo[Kr+3]=Go/Ro}return t0},toObject:function(){return{type:this.type,scaleX:this.scaleX,scaleY:this.scaleY,resizeType:this.resizeType,lanczosLobes:this.lanczosLobes}}}),Ct.Image.filters.Resize.fromObject=Ct.Image.filters.BaseFilter.fromObject}(d),function(Tt){var Ct=Tt.fabric||(Tt.fabric={}),pt=Ct.Image.filters,wt=Ct.util.createClass;pt.Contrast=wt(pt.BaseFilter,{type:"Contrast",fragmentSource:`precision highp float;
uniform sampler2D uTexture;
uniform float uContrast;
varying vec2 vTexCoord;
void main() {
vec4 color = texture2D(uTexture, vTexCoord);
float contrastF = 1.015 * (uContrast + 1.0) / (1.0 * (1.015 - uContrast));
color.rgb = contrastF * (color.rgb - 0.5) + 0.5;
gl_FragColor = color;
}`,contrast:0,mainParameter:"contrast",applyTo2d:function($t){if(this.contrast!==0){var Lt=$t.imageData,jt,Gt,Ft=Lt.data,Gt=Ft.length,Ht=Math.floor(this.contrast*255),qt=259*(Ht+255)/(255*(259-Ht));for(jt=0;jt<Gt;jt+=4)Ft[jt]=qt*(Ft[jt]-128)+128,Ft[jt+1]=qt*(Ft[jt+1]-128)+128,Ft[jt+2]=qt*(Ft[jt+2]-128)+128}},getUniformLocations:function($t,Lt){return{uContrast:$t.getUniformLocation(Lt,"uContrast")}},sendUniformData:function($t,Lt){$t.uniform1f(Lt.uContrast,this.contrast)}}),Ct.Image.filters.Contrast.fromObject=Ct.Image.filters.BaseFilter.fromObject}(d),function(Tt){var Ct=Tt.fabric||(Tt.fabric={}),pt=Ct.Image.filters,wt=Ct.util.createClass;pt.Saturation=wt(pt.BaseFilter,{type:"Saturation",fragmentSource:`precision highp float;
uniform sampler2D uTexture;
uniform float uSaturation;
varying vec2 vTexCoord;
void main() {
vec4 color = texture2D(uTexture, vTexCoord);
float rgMax = max(color.r, color.g);
float rgbMax = max(rgMax, color.b);
color.r += rgbMax != color.r ? (rgbMax - color.r) * uSaturation : 0.00;
color.g += rgbMax != color.g ? (rgbMax - color.g) * uSaturation : 0.00;
color.b += rgbMax != color.b ? (rgbMax - color.b) * uSaturation : 0.00;
gl_FragColor = color;
}`,saturation:0,mainParameter:"saturation",applyTo2d:function($t){if(this.saturation!==0){var Lt=$t.imageData,jt=Lt.data,Ft=jt.length,Gt=-this.saturation,Ht,qt;for(Ht=0;Ht<Ft;Ht+=4)qt=Math.max(jt[Ht],jt[Ht+1],jt[Ht+2]),jt[Ht]+=qt!==jt[Ht]?(qt-jt[Ht])*Gt:0,jt[Ht+1]+=qt!==jt[Ht+1]?(qt-jt[Ht+1])*Gt:0,jt[Ht+2]+=qt!==jt[Ht+2]?(qt-jt[Ht+2])*Gt:0}},getUniformLocations:function($t,Lt){return{uSaturation:$t.getUniformLocation(Lt,"uSaturation")}},sendUniformData:function($t,Lt){$t.uniform1f(Lt.uSaturation,-this.saturation)}}),Ct.Image.filters.Saturation.fromObject=Ct.Image.filters.BaseFilter.fromObject}(d),function(Tt){var Ct=Tt.fabric||(Tt.fabric={}),pt=Ct.Image.filters,wt=Ct.util.createClass;pt.Vibrance=wt(pt.BaseFilter,{type:"Vibrance",fragmentSource:`precision highp float;
uniform sampler2D uTexture;
uniform float uVibrance;
varying vec2 vTexCoord;
void main() {
vec4 color = texture2D(uTexture, vTexCoord);
float max = max(color.r, max(color.g, color.b));
float avg = (color.r + color.g + color.b) / 3.0;
float amt = (abs(max - avg) * 2.0) * uVibrance;
color.r += max != color.r ? (max - color.r) * amt : 0.00;
color.g += max != color.g ? (max - color.g) * amt : 0.00;
color.b += max != color.b ? (max - color.b) * amt : 0.00;
gl_FragColor = color;
}`,vibrance:0,mainParameter:"vibrance",applyTo2d:function($t){if(this.vibrance!==0){var Lt=$t.imageData,jt=Lt.data,Ft=jt.length,Gt=-this.vibrance,Ht,qt,Kt,rr;for(Ht=0;Ht<Ft;Ht+=4)qt=Math.max(jt[Ht],jt[Ht+1],jt[Ht+2]),Kt=(jt[Ht]+jt[Ht+1]+jt[Ht+2])/3,rr=Math.abs(qt-Kt)*2/255*Gt,jt[Ht]+=qt!==jt[Ht]?(qt-jt[Ht])*rr:0,jt[Ht+1]+=qt!==jt[Ht+1]?(qt-jt[Ht+1])*rr:0,jt[Ht+2]+=qt!==jt[Ht+2]?(qt-jt[Ht+2])*rr:0}},getUniformLocations:function($t,Lt){return{uVibrance:$t.getUniformLocation(Lt,"uVibrance")}},sendUniformData:function($t,Lt){$t.uniform1f(Lt.uVibrance,-this.vibrance)}}),Ct.Image.filters.Vibrance.fromObject=Ct.Image.filters.BaseFilter.fromObject}(d),function(Tt){var Ct=Tt.fabric||(Tt.fabric={}),pt=Ct.Image.filters,wt=Ct.util.createClass;pt.Blur=wt(pt.BaseFilter,{type:"Blur",fragmentSource:`precision highp float;
uniform sampler2D uTexture;
uniform vec2 uDelta;
varying vec2 vTexCoord;
const float nSamples = 15.0;
vec3 v3offset = vec3(12.9898, 78.233, 151.7182);
float random(vec3 scale) {
return fract(sin(dot(gl_FragCoord.xyz, scale)) * 43758.5453);
}
void main() {
vec4 color = vec4(0.0);
float total = 0.0;
float offset = random(v3offset);
for (float t = -nSamples; t <= nSamples; t++) {
float percent = (t + offset - 0.5) / nSamples;
float weight = 1.0 - abs(percent);
color += texture2D(uTexture, vTexCoord + uDelta * percent) * weight;
total += weight;
}
gl_FragColor = color / total;
}`,blur:0,mainParameter:"blur",applyTo:function($t){$t.webgl?(this.aspectRatio=$t.sourceWidth/$t.sourceHeight,$t.passes++,this._setupFrameBuffer($t),this.horizontal=!0,this.applyToWebGL($t),this._swapTextures($t),this._setupFrameBuffer($t),this.horizontal=!1,this.applyToWebGL($t),this._swapTextures($t)):this.applyTo2d($t)},applyTo2d:function($t){$t.imageData=this.simpleBlur($t)},simpleBlur:function($t){var Lt=$t.filterBackend.resources,jt,Ft,Gt=$t.imageData.width,Ht=$t.imageData.height;Lt.blurLayer1||(Lt.blurLayer1=Ct.util.createCanvasElement(),Lt.blurLayer2=Ct.util.createCanvasElement()),jt=Lt.blurLayer1,Ft=Lt.blurLayer2,(jt.width!==Gt||jt.height!==Ht)&&(Ft.width=jt.width=Gt,Ft.height=jt.height=Ht);var qt=jt.getContext("2d"),Kt=Ft.getContext("2d"),rr=15,ir,or,jr,qr,Yr=this.blur*.06*.5;for(qt.putImageData($t.imageData,0,0),Kt.clearRect(0,0,Gt,Ht),qr=-rr;qr<=rr;qr++)ir=(Math.random()-.5)/4,or=qr/rr,jr=Yr*or*Gt+ir,Kt.globalAlpha=1-Math.abs(or),Kt.drawImage(jt,jr,ir),qt.drawImage(Ft,0,0),Kt.globalAlpha=1,Kt.clearRect(0,0,Ft.width,Ft.height);for(qr=-rr;qr<=rr;qr++)ir=(Math.random()-.5)/4,or=qr/rr,jr=Yr*or*Ht+ir,Kt.globalAlpha=1-Math.abs(or),Kt.drawImage(jt,ir,jr),qt.drawImage(Ft,0,0),Kt.globalAlpha=1,Kt.clearRect(0,0,Ft.width,Ft.height);$t.ctx.drawImage(jt,0,0);var vn=$t.ctx.getImageData(0,0,jt.width,jt.height);return qt.globalAlpha=1,qt.clearRect(0,0,jt.width,jt.height),vn},getUniformLocations:function($t,Lt){return{delta:$t.getUniformLocation(Lt,"uDelta")}},sendUniformData:function($t,Lt){var jt=this.chooseRightDelta();$t.uniform2fv(Lt.delta,jt)},chooseRightDelta:function(){var $t=1,Lt=[0,0],jt;return this.horizontal?this.aspectRatio>1&&($t=1/this.aspectRatio):this.aspectRatio<1&&($t=this.aspectRatio),jt=$t*this.blur*.12,this.horizontal?Lt[0]=jt:Lt[1]=jt,Lt}}),pt.Blur.fromObject=Ct.Image.filters.BaseFilter.fromObject}(d),function(Tt){var Ct=Tt.fabric||(Tt.fabric={}),pt=Ct.Image.filters,wt=Ct.util.createClass;pt.Gamma=wt(pt.BaseFilter,{type:"Gamma",fragmentSource:`precision highp float;
uniform sampler2D uTexture;
uniform vec3 uGamma;
varying vec2 vTexCoord;
void main() {
vec4 color = texture2D(uTexture, vTexCoord);
vec3 correction = (1.0 / uGamma);
color.r = pow(color.r, correction.r);
color.g = pow(color.g, correction.g);
color.b = pow(color.b, correction.b);
gl_FragColor = color;
gl_FragColor.rgb *= color.a;
}`,gamma:[1,1,1],mainParameter:"gamma",initialize:function($t){this.gamma=[1,1,1],pt.BaseFilter.prototype.initialize.call(this,$t)},applyTo2d:function($t){var Lt=$t.imageData,jt=Lt.data,Ft=this.gamma,Gt=jt.length,Ht=1/Ft[0],qt=1/Ft[1],Kt=1/Ft[2],rr;for(this.rVals||(this.rVals=new Uint8Array(256),this.gVals=new Uint8Array(256),this.bVals=new Uint8Array(256)),rr=0,Gt=256;rr<Gt;rr++)this.rVals[rr]=Math.pow(rr/255,Ht)*255,this.gVals[rr]=Math.pow(rr/255,qt)*255,this.bVals[rr]=Math.pow(rr/255,Kt)*255;for(rr=0,Gt=jt.length;rr<Gt;rr+=4)jt[rr]=this.rVals[jt[rr]],jt[rr+1]=this.gVals[jt[rr+1]],jt[rr+2]=this.bVals[jt[rr+2]]},getUniformLocations:function($t,Lt){return{uGamma:$t.getUniformLocation(Lt,"uGamma")}},sendUniformData:function($t,Lt){$t.uniform3fv(Lt.uGamma,this.gamma)}}),Ct.Image.filters.Gamma.fromObject=Ct.Image.filters.BaseFilter.fromObject}(d),function(Tt){var Ct=Tt.fabric||(Tt.fabric={}),pt=Ct.Image.filters,wt=Ct.util.createClass;pt.Composed=wt(pt.BaseFilter,{type:"Composed",subFilters:[],initialize:function($t){this.callSuper("initialize",$t),this.subFilters=this.subFilters.slice(0)},applyTo:function($t){$t.passes+=this.subFilters.length-1,this.subFilters.forEach(function(Lt){Lt.applyTo($t)})},toObject:function(){return Ct.util.object.extend(this.callSuper("toObject"),{subFilters:this.subFilters.map(function($t){return $t.toObject()})})},isNeutralState:function(){return!this.subFilters.some(function($t){return!$t.isNeutralState()})}}),Ct.Image.filters.Composed.fromObject=function($t,Lt){var jt=$t.subFilters||[],Ft=jt.map(function(Ht){return new Ct.Image.filters[Ht.type](Ht)}),Gt=new Ct.Image.filters.Composed({subFilters:Ft});return Lt&&Lt(Gt),Gt}}(d),function(Tt){var Ct=Tt.fabric||(Tt.fabric={}),pt=Ct.Image.filters,wt=Ct.util.createClass;pt.HueRotation=wt(pt.ColorMatrix,{type:"HueRotation",rotation:0,mainParameter:"rotation",calculateMatrix:function(){var $t=this.rotation*Math.PI,Lt=Ct.util.cos($t),jt=Ct.util.sin($t),Ft=1/3,Gt=Math.sqrt(Ft)*jt,Ht=1-Lt;this.matrix=[1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0],this.matrix[0]=Lt+Ht/3,this.matrix[1]=Ft*Ht-Gt,this.matrix[2]=Ft*Ht+Gt,this.matrix[5]=Ft*Ht+Gt,this.matrix[6]=Lt+Ft*Ht,this.matrix[7]=Ft*Ht-Gt,this.matrix[10]=Ft*Ht-Gt,this.matrix[11]=Ft*Ht+Gt,this.matrix[12]=Lt+Ft*Ht},isNeutralState:function($t){return this.calculateMatrix(),pt.BaseFilter.prototype.isNeutralState.call(this,$t)},applyTo:function($t){this.calculateMatrix(),pt.BaseFilter.prototype.applyTo.call(this,$t)}}),Ct.Image.filters.HueRotation.fromObject=Ct.Image.filters.BaseFilter.fromObject}(d),function(Tt){var Ct=Tt.fabric||(Tt.fabric={}),pt=Ct.util.object.clone;if(Ct.Text){Ct.warn("fabric.Text is already defined");return}var wt="fontFamily fontWeight fontSize text underline overline linethrough textAlign fontStyle lineHeight textBackgroundColor charSpacing styles direction path pathStartOffset pathSide pathAlign".split(" ");Ct.Text=Ct.util.createClass(Ct.Object,{_dimensionAffectingProps:["fontSize","fontWeight","fontFamily","fontStyle","lineHeight","text","charSpacing","textAlign","styles","path","pathStartOffset","pathSide","pathAlign"],_reNewline:/\r?\n/,_reSpacesAndTabs:/[ \t\r]/g,_reSpaceAndTab:/[ \t\r]/,_reWords:/\S+/g,type:"text",fontSize:40,fontWeight:"normal",fontFamily:"Times New Roman",underline:!1,overline:!1,linethrough:!1,textAlign:"left",fontStyle:"normal",lineHeight:1.16,superscript:{size:.6,baseline:-.35},subscript:{size:.6,baseline:.11},textBackgroundColor:"",stateProperties:Ct.Object.prototype.stateProperties.concat(wt),cacheProperties:Ct.Object.prototype.cacheProperties.concat(wt),stroke:null,shadow:null,path:null,pathStartOffset:0,pathSide:"left",pathAlign:"baseline",_fontSizeFraction:.222,offsets:{underline:.1,linethrough:-.315,overline:-.88},_fontSizeMult:1.13,charSpacing:0,styles:null,_measuringContext:null,deltaY:0,direction:"ltr",_styleProperties:["stroke","strokeWidth","fill","fontFamily","fontSize","fontWeight","fontStyle","underline","overline","linethrough","deltaY","textBackgroundColor"],__charBounds:[],CACHE_FONT_SIZE:400,MIN_TEXT_WIDTH:2,initialize:function($t,Lt){this.styles=Lt?Lt.styles||{}:{},this.text=$t,this.__skipDimension=!0,this.callSuper("initialize",Lt),this.path&&this.setPathInfo(),this.__skipDimension=!1,this.initDimensions(),this.setCoords(),this.setupState({propertySet:"_dimensionAffectingProps"})},setPathInfo:function(){var $t=this.path;$t&&($t.segmentsInfo=Ct.util.getPathSegmentsInfo($t.path))},getMeasuringContext:function(){return Ct._measuringContext||(Ct._measuringContext=this.canvas&&this.canvas.contextCache||Ct.util.createCanvasElement().getContext("2d")),Ct._measuringContext},_splitText:function(){var $t=this._splitTextIntoLines(this.text);return this.textLines=$t.lines,this._textLines=$t.graphemeLines,this._unwrappedTextLines=$t._unwrappedLines,this._text=$t.graphemeText,$t},initDimensions:function(){this.__skipDimension||(this._splitText(),this._clearCache(),this.path?(this.width=this.path.width,this.height=this.path.height):(this.width=this.calcTextWidth()||this.cursorWidth||this.MIN_TEXT_WIDTH,this.height=this.calcTextHeight()),this.textAlign.indexOf("justify")!==-1&&this.enlargeSpaces(),this.saveState({propertySet:"_dimensionAffectingProps"}))},enlargeSpaces:function(){for(var $t,Lt,jt,Ft,Gt,Ht,qt,Kt=0,rr=this._textLines.length;Kt<rr;Kt++)if(!(this.textAlign!=="justify"&&(Kt===rr-1||this.isEndOfWrapping(Kt)))&&(Ft=0,Gt=this._textLines[Kt],Lt=this.getLineWidth(Kt),Lt<this.width&&(qt=this.textLines[Kt].match(this._reSpacesAndTabs)))){jt=qt.length,$t=(this.width-Lt)/jt;for(var ir=0,or=Gt.length;ir<=or;ir++)Ht=this.__charBounds[Kt][ir],this._reSpaceAndTab.test(Gt[ir])?(Ht.width+=$t,Ht.kernedWidth+=$t,Ht.left+=Ft,Ft+=$t):Ht.left+=Ft}},isEndOfWrapping:function($t){return $t===this._textLines.length-1},missingNewlineOffset:function(){return 1},toString:function(){return"#<fabric.Text ("+this.complexity()+'): { "text": "'+this.text+'", "fontFamily": "'+this.fontFamily+'" }>'},_getCacheCanvasDimensions:function(){var $t=this.callSuper("_getCacheCanvasDimensions"),Lt=this.fontSize;return $t.width+=Lt*$t.zoomX,$t.height+=Lt*$t.zoomY,$t},_render:function($t){var Lt=this.path;Lt&&!Lt.isNotVisible()&&Lt._render($t),this._setTextStyles($t),this._renderTextLinesBackground($t),this._renderTextDecoration($t,"underline"),this._renderText($t),this._renderTextDecoration($t,"overline"),this._renderTextDecoration($t,"linethrough")},_renderText:function($t){this.paintFirst==="stroke"?(this._renderTextStroke($t),this._renderTextFill($t)):(this._renderTextFill($t),this._renderTextStroke($t))},_setTextStyles:function($t,Lt,jt){if($t.textBaseline="alphabetical",this.path)switch(this.pathAlign){case"center":$t.textBaseline="middle";break;case"ascender":$t.textBaseline="top";break;case"descender":$t.textBaseline="bottom";break}$t.font=this._getFontDeclaration(Lt,jt)},calcTextWidth:function(){for(var $t=this.getLineWidth(0),Lt=1,jt=this._textLines.length;Lt<jt;Lt++){var Ft=this.getLineWidth(Lt);Ft>$t&&($t=Ft)}return $t},_renderTextLine:function($t,Lt,jt,Ft,Gt,Ht){this._renderChars($t,Lt,jt,Ft,Gt,Ht)},_renderTextLinesBackground:function($t){if(!(!this.textBackgroundColor&&!this.styleHas("textBackgroundColor"))){for(var Lt,jt,Ft=$t.fillStyle,Gt,Ht,qt=this._getLeftOffset(),Kt=this._getTopOffset(),rr=0,ir=0,or,jr,qr=this.path,Yr,vn=0,ko=this._textLines.length;vn<ko;vn++){if(Lt=this.getHeightOfLine(vn),!this.textBackgroundColor&&!this.styleHas("textBackgroundColor",vn)){Kt+=Lt;continue}Gt=this._textLines[vn],jt=this._getLineLeftOffset(vn),ir=0,rr=0,Ht=this.getValueOfPropertyAt(vn,0,"textBackgroundColor");for(var Xo=0,zo=Gt.length;Xo<zo;Xo++)or=this.__charBounds[vn][Xo],jr=this.getValueOfPropertyAt(vn,Xo,"textBackgroundColor"),qr?($t.save(),$t.translate(or.renderLeft,or.renderTop),$t.rotate(or.angle),$t.fillStyle=jr,jr&&$t.fillRect(-or.width/2,-Lt/this.lineHeight*(1-this._fontSizeFraction),or.width,Lt/this.lineHeight),$t.restore()):jr!==Ht?(Yr=qt+jt+rr,this.direction==="rtl"&&(Yr=this.width-Yr-ir),$t.fillStyle=Ht,Ht&&$t.fillRect(Yr,Kt,ir,Lt/this.lineHeight),rr=or.left,ir=or.width,Ht=jr):ir+=or.kernedWidth;jr&&!qr&&(Yr=qt+jt+rr,this.direction==="rtl"&&(Yr=this.width-Yr-ir),$t.fillStyle=jr,$t.fillRect(Yr,Kt,ir,Lt/this.lineHeight)),Kt+=Lt}$t.fillStyle=Ft,this._removeShadow($t)}},getFontCache:function($t){var Lt=$t.fontFamily.toLowerCase();Ct.charWidthsCache[Lt]||(Ct.charWidthsCache[Lt]={});var jt=Ct.charWidthsCache[Lt],Ft=$t.fontStyle.toLowerCase()+"_"+($t.fontWeight+"").toLowerCase();return jt[Ft]||(jt[Ft]={}),jt[Ft]},_measureChar:function($t,Lt,jt,Ft){var Gt=this.getFontCache(Lt),Ht=this._getFontDeclaration(Lt),qt=this._getFontDeclaration(Ft),Kt=jt+$t,rr=Ht===qt,ir,or,jr,qr=Lt.fontSize/this.CACHE_FONT_SIZE,Yr;if(jt&&Gt[jt]!==void 0&&(jr=Gt[jt]),Gt[$t]!==void 0&&(Yr=ir=Gt[$t]),rr&&Gt[Kt]!==void 0&&(or=Gt[Kt],Yr=or-jr),ir===void 0||jr===void 0||or===void 0){var vn=this.getMeasuringContext();this._setTextStyles(vn,Lt,!0)}return ir===void 0&&(Yr=ir=vn.measureText($t).width,Gt[$t]=ir),jr===void 0&&rr&&jt&&(jr=vn.measureText(jt).width,Gt[jt]=jr),rr&&or===void 0&&(or=vn.measureText(Kt).width,Gt[Kt]=or,Yr=or-jr),{width:ir*qr,kernedWidth:Yr*qr}},getHeightOfChar:function($t,Lt){return this.getValueOfPropertyAt($t,Lt,"fontSize")},measureLine:function($t){var Lt=this._measureLine($t);return this.charSpacing!==0&&(Lt.width-=this._getWidthOfCharSpacing()),Lt.width<0&&(Lt.width=0),Lt},_measureLine:function($t){var Lt=0,jt,Ft,Gt=this._textLines[$t],Ht,qt,Kt=0,rr=new Array(Gt.length),ir=0,or,jr,qr=this.path,Yr=this.pathSide==="right";for(this.__charBounds[$t]=rr,jt=0;jt<Gt.length;jt++)Ft=Gt[jt],qt=this._getGraphemeBox(Ft,$t,jt,Ht),rr[jt]=qt,Lt+=qt.kernedWidth,Ht=Ft;if(rr[jt]={left:qt?qt.left+qt.width:0,width:0,kernedWidth:0,height:this.fontSize},qr){switch(jr=qr.segmentsInfo[qr.segmentsInfo.length-1].length,or=Ct.util.getPointOnPath(qr.path,0,qr.segmentsInfo),or.x+=qr.pathOffset.x,or.y+=qr.pathOffset.y,this.textAlign){case"left":ir=Yr?jr-Lt:0;break;case"center":ir=(jr-Lt)/2;break;case"right":ir=Yr?0:jr-Lt;break}for(ir+=this.pathStartOffset*(Yr?-1:1),jt=Yr?Gt.length-1:0;Yr?jt>=0:jt<Gt.length;Yr?jt--:jt++)qt=rr[jt],ir>jr?ir%=jr:ir<0&&(ir+=jr),this._setGraphemeOnPath(ir,qt,or),ir+=qt.kernedWidth}return{width:Lt,numOfSpaces:Kt}},_setGraphemeOnPath:function($t,Lt,jt){var Ft=$t+Lt.kernedWidth/2,Gt=this.path,Ht=Ct.util.getPointOnPath(Gt.path,Ft,Gt.segmentsInfo);Lt.renderLeft=Ht.x-jt.x,Lt.renderTop=Ht.y-jt.y,Lt.angle=Ht.angle+(this.pathSide==="right"?Math.PI:0)},_getGraphemeBox:function($t,Lt,jt,Ft,Gt){var Ht=this.getCompleteStyleDeclaration(Lt,jt),qt=Ft?this.getCompleteStyleDeclaration(Lt,jt-1):{},Kt=this._measureChar($t,Ht,Ft,qt),rr=Kt.kernedWidth,ir=Kt.width,or;this.charSpacing!==0&&(or=this._getWidthOfCharSpacing(),ir+=or,rr+=or);var jr={width:ir,left:0,height:Ht.fontSize,kernedWidth:rr,deltaY:Ht.deltaY};if(jt>0&&!Gt){var qr=this.__charBounds[Lt][jt-1];jr.left=qr.left+qr.width+Kt.kernedWidth-Kt.width}return jr},getHeightOfLine:function($t){if(this.__lineHeights[$t])return this.__lineHeights[$t];for(var Lt=this._textLines[$t],jt=this.getHeightOfChar($t,0),Ft=1,Gt=Lt.length;Ft<Gt;Ft++)jt=Math.max(this.getHeightOfChar($t,Ft),jt);return this.__lineHeights[$t]=jt*this.lineHeight*this._fontSizeMult},calcTextHeight:function(){for(var $t,Lt=0,jt=0,Ft=this._textLines.length;jt<Ft;jt++)$t=this.getHeightOfLine(jt),Lt+=jt===Ft-1?$t/this.lineHeight:$t;return Lt},_getLeftOffset:function(){return this.direction==="ltr"?-this.width/2:this.width/2},_getTopOffset:function(){return-this.height/2},_renderTextCommon:function($t,Lt){$t.save();for(var jt=0,Ft=this._getLeftOffset(),Gt=this._getTopOffset(),Ht=0,qt=this._textLines.length;Ht<qt;Ht++){var Kt=this.getHeightOfLine(Ht),rr=Kt/this.lineHeight,ir=this._getLineLeftOffset(Ht);this._renderTextLine(Lt,$t,this._textLines[Ht],Ft+ir,Gt+jt+rr,Ht),jt+=Kt}$t.restore()},_renderTextFill:function($t){!this.fill&&!this.styleHas("fill")||this._renderTextCommon($t,"fillText")},_renderTextStroke:function($t){(!this.stroke||this.strokeWidth===0)&&this.isEmptyStyles()||(this.shadow&&!this.shadow.affectStroke&&this._removeShadow($t),$t.save(),this._setLineDash($t,this.strokeDashArray),$t.beginPath(),this._renderTextCommon($t,"strokeText"),$t.closePath(),$t.restore())},_renderChars:function($t,Lt,jt,Ft,Gt,Ht){var qt=this.getHeightOfLine(Ht),Kt=this.textAlign.indexOf("justify")!==-1,rr,ir,or="",jr,qr=0,Yr,vn=this.path,ko=!Kt&&this.charSpacing===0&&this.isEmptyStyles(Ht)&&!vn,Xo=this.direction==="ltr",zo=this.direction==="ltr"?1:-1,t0,Uo=Lt.canvas.getAttribute("dir");if(Lt.save(),Uo!==this.direction&&(Lt.canvas.setAttribute("dir",Xo?"ltr":"rtl"),Lt.direction=Xo?"ltr":"rtl",Lt.textAlign=Xo?"left":"right"),Gt-=qt*this._fontSizeFraction/this.lineHeight,ko){this._renderChar($t,Lt,Ht,0,jt.join(""),Ft,Gt,qt),Lt.restore();return}for(var No=0,_n=jt.length-1;No<=_n;No++)Yr=No===_n||this.charSpacing||vn,or+=jt[No],jr=this.__charBounds[Ht][No],qr===0?(Ft+=zo*(jr.kernedWidth-jr.width),qr+=jr.width):qr+=jr.kernedWidth,Kt&&!Yr&&this._reSpaceAndTab.test(jt[No])&&(Yr=!0),Yr||(rr=rr||this.getCompleteStyleDeclaration(Ht,No),ir=this.getCompleteStyleDeclaration(Ht,No+1),Yr=Ct.util.hasStyleChanged(rr,ir,!1)),Yr&&(vn?(Lt.save(),Lt.translate(jr.renderLeft,jr.renderTop),Lt.rotate(jr.angle),this._renderChar($t,Lt,Ht,No,or,-qr/2,0,qt),Lt.restore()):(t0=Ft,this._renderChar($t,Lt,Ht,No,or,t0,Gt,qt)),or="",rr=ir,Ft+=zo*qr,qr=0);Lt.restore()},_applyPatternGradientTransformText:function($t){var Lt=Ct.util.createCanvasElement(),jt,Ft=this.width+this.strokeWidth,Gt=this.height+this.strokeWidth;return Lt.width=Ft,Lt.height=Gt,jt=Lt.getContext("2d"),jt.beginPath(),jt.moveTo(0,0),jt.lineTo(Ft,0),jt.lineTo(Ft,Gt),jt.lineTo(0,Gt),jt.closePath(),jt.translate(Ft/2,Gt/2),jt.fillStyle=$t.toLive(jt),this._applyPatternGradientTransform(jt,$t),jt.fill(),jt.createPattern(Lt,"no-repeat")},handleFiller:function($t,Lt,jt){var Ft,Gt;return jt.toLive?jt.gradientUnits==="percentage"||jt.gradientTransform||jt.patternTransform?(Ft=-this.width/2,Gt=-this.height/2,$t.translate(Ft,Gt),$t[Lt]=this._applyPatternGradientTransformText(jt),{offsetX:Ft,offsetY:Gt}):($t[Lt]=jt.toLive($t,this),this._applyPatternGradientTransform($t,jt)):($t[Lt]=jt,{offsetX:0,offsetY:0})},_setStrokeStyles:function($t,Lt){return $t.lineWidth=Lt.strokeWidth,$t.lineCap=this.strokeLineCap,$t.lineDashOffset=this.strokeDashOffset,$t.lineJoin=this.strokeLineJoin,$t.miterLimit=this.strokeMiterLimit,this.handleFiller($t,"strokeStyle",Lt.stroke)},_setFillStyles:function($t,Lt){return this.handleFiller($t,"fillStyle",Lt.fill)},_renderChar:function($t,Lt,jt,Ft,Gt,Ht,qt){var Kt=this._getStyleDeclaration(jt,Ft),rr=this.getCompleteStyleDeclaration(jt,Ft),ir=$t==="fillText"&&rr.fill,or=$t==="strokeText"&&rr.stroke&&rr.strokeWidth,jr,qr;!or&&!ir||(Lt.save(),ir&&(jr=this._setFillStyles(Lt,rr)),or&&(qr=this._setStrokeStyles(Lt,rr)),Lt.font=this._getFontDeclaration(rr),Kt&&Kt.textBackgroundColor&&this._removeShadow(Lt),Kt&&Kt.deltaY&&(qt+=Kt.deltaY),ir&&Lt.fillText(Gt,Ht-jr.offsetX,qt-jr.offsetY),or&&Lt.strokeText(Gt,Ht-qr.offsetX,qt-qr.offsetY),Lt.restore())},setSuperscript:function($t,Lt){return this._setScript($t,Lt,this.superscript)},setSubscript:function($t,Lt){return this._setScript($t,Lt,this.subscript)},_setScript:function($t,Lt,jt){var Ft=this.get2DCursorLocation($t,!0),Gt=this.getValueOfPropertyAt(Ft.lineIndex,Ft.charIndex,"fontSize"),Ht=this.getValueOfPropertyAt(Ft.lineIndex,Ft.charIndex,"deltaY"),qt={fontSize:Gt*jt.size,deltaY:Ht+Gt*jt.baseline};return this.setSelectionStyles(qt,$t,Lt),this},_getLineLeftOffset:function($t){var Lt=this.getLineWidth($t),jt=this.width-Lt,Ft=this.textAlign,Gt=this.direction,qt,Ht=0,qt=this.isEndOfWrapping($t);return Ft==="justify"||Ft==="justify-center"&&!qt||Ft==="justify-right"&&!qt||Ft==="justify-left"&&!qt?0:(Ft==="center"&&(Ht=jt/2),Ft==="right"&&(Ht=jt),Ft==="justify-center"&&(Ht=jt/2),Ft==="justify-right"&&(Ht=jt),Gt==="rtl"&&(Ht-=jt),Ht)},_clearCache:function(){this.__lineWidths=[],this.__lineHeights=[],this.__charBounds=[]},_shouldClearDimensionCache:function(){var $t=this._forceClearCache;return $t||($t=this.hasStateChanged("_dimensionAffectingProps")),$t&&(this.dirty=!0,this._forceClearCache=!1),$t},getLineWidth:function($t){if(this.__lineWidths[$t]!==void 0)return this.__lineWidths[$t];var Lt=this.measureLine($t),jt=Lt.width;return this.__lineWidths[$t]=jt,jt},_getWidthOfCharSpacing:function(){return this.charSpacing!==0?this.fontSize*this.charSpacing/1e3:0},getValueOfPropertyAt:function($t,Lt,jt){var Ft=this._getStyleDeclaration($t,Lt);return Ft&&typeof Ft[jt]<"u"?Ft[jt]:this[jt]},_renderTextDecoration:function($t,Lt){if(!(!this[Lt]&&!this.styleHas(Lt))){for(var jt,Ft,Gt,Ht,qt,Kt,rr,ir,or=this._getLeftOffset(),jr=this._getTopOffset(),qr,Yr,vn,ko,Xo,zo,t0,Uo,No=this.path,_n=this._getWidthOfCharSpacing(),Kr=this.offsets[Lt],e0=0,Zr=this._textLines.length;e0<Zr;e0++){if(jt=this.getHeightOfLine(e0),!this[Lt]&&!this.styleHas(Lt,e0)){jr+=jt;continue}rr=this._textLines[e0],zo=jt/this.lineHeight,Ht=this._getLineLeftOffset(e0),Yr=0,vn=0,ir=this.getValueOfPropertyAt(e0,0,Lt),Uo=this.getValueOfPropertyAt(e0,0,"fill"),qr=jr+zo*(1-this._fontSizeFraction),Ft=this.getHeightOfChar(e0,0),qt=this.getValueOfPropertyAt(e0,0,"deltaY");for(var Ro=0,Sn=rr.length;Ro<Sn;Ro++)if(ko=this.__charBounds[e0][Ro],Xo=this.getValueOfPropertyAt(e0,Ro,Lt),t0=this.getValueOfPropertyAt(e0,Ro,"fill"),Gt=this.getHeightOfChar(e0,Ro),Kt=this.getValueOfPropertyAt(e0,Ro,"deltaY"),No&&Xo&&t0)$t.save(),$t.fillStyle=Uo,$t.translate(ko.renderLeft,ko.renderTop),$t.rotate(ko.angle),$t.fillRect(-ko.kernedWidth/2,Kr*Gt+Kt,ko.kernedWidth,this.fontSize/15),$t.restore();else if((Xo!==ir||t0!==Uo||Gt!==Ft||Kt!==qt)&&vn>0){var Tn=or+Ht+Yr;this.direction==="rtl"&&(Tn=this.width-Tn-vn),ir&&Uo&&($t.fillStyle=Uo,$t.fillRect(Tn,qr+Kr*Ft+qt,vn,this.fontSize/15)),Yr=ko.left,vn=ko.width,ir=Xo,Uo=t0,Ft=Gt,qt=Kt}else vn+=ko.kernedWidth;var Tn=or+Ht+Yr;this.direction==="rtl"&&(Tn=this.width-Tn-vn),$t.fillStyle=t0,Xo&&t0&&$t.fillRect(Tn,qr+Kr*Ft+qt,vn-_n,this.fontSize/15),jr+=jt}this._removeShadow($t)}},_getFontDeclaration:function($t,Lt){var jt=$t||this,Ft=this.fontFamily,Gt=Ct.Text.genericFonts.indexOf(Ft.toLowerCase())>-1,Ht=Ft===void 0||Ft.indexOf("'")>-1||Ft.indexOf(",")>-1||Ft.indexOf('"')>-1||Gt?jt.fontFamily:'"'+jt.fontFamily+'"';return[Ct.isLikelyNode?jt.fontWeight:jt.fontStyle,Ct.isLikelyNode?jt.fontStyle:jt.fontWeight,Lt?this.CACHE_FONT_SIZE+"px":jt.fontSize+"px",Ht].join(" ")},render:function($t){this.visible&&(this.canvas&&this.canvas.skipOffscreen&&!this.group&&!this.isOnScreen()||(this._shouldClearDimensionCache()&&this.initDimensions(),this.callSuper("render",$t)))},_splitTextIntoLines:function($t){for(var Lt=$t.split(this._reNewline),jt=new Array(Lt.length),Ft=[`
`],Gt=[],Ht=0;Ht<Lt.length;Ht++)jt[Ht]=Ct.util.string.graphemeSplit(Lt[Ht]),Gt=Gt.concat(jt[Ht],Ft);return Gt.pop(),{_unwrappedLines:jt,lines:Lt,graphemeText:Gt,graphemeLines:jt}},toObject:function($t){var Lt=wt.concat($t),jt=this.callSuper("toObject",Lt);return jt.styles=Ct.util.stylesToArray(this.styles,this.text),jt.path&&(jt.path=this.path.toObject()),jt},set:function($t,Lt){this.callSuper("set",$t,Lt);var jt=!1,Ft=!1;if(typeof $t=="object")for(var Gt in $t)Gt==="path"&&this.setPathInfo(),jt=jt||this._dimensionAffectingProps.indexOf(Gt)!==-1,Ft=Ft||Gt==="path";else jt=this._dimensionAffectingProps.indexOf($t)!==-1,Ft=$t==="path";return Ft&&this.setPathInfo(),jt&&(this.initDimensions(),this.setCoords()),this},complexity:function(){return 1}}),Ct.Text.ATTRIBUTE_NAMES=Ct.SHARED_ATTRIBUTES.concat("x y dx dy font-family font-style font-weight font-size letter-spacing text-decoration text-anchor".split(" ")),Ct.Text.DEFAULT_SVG_FONT_SIZE=16,Ct.Text.fromElement=function($t,Lt,jt){if(!$t)return Lt(null);var Ft=Ct.parseAttributes($t,Ct.Text.ATTRIBUTE_NAMES),Gt=Ft.textAnchor||"left";if(jt=Ct.util.object.extend(jt?pt(jt):{},Ft),jt.top=jt.top||0,jt.left=jt.left||0,Ft.textDecoration){var Ht=Ft.textDecoration;Ht.indexOf("underline")!==-1&&(jt.underline=!0),Ht.indexOf("overline")!==-1&&(jt.overline=!0),Ht.indexOf("line-through")!==-1&&(jt.linethrough=!0),delete jt.textDecoration}"dx"in Ft&&(jt.left+=Ft.dx),"dy"in Ft&&(jt.top+=Ft.dy),"fontSize"in jt||(jt.fontSize=Ct.Text.DEFAULT_SVG_FONT_SIZE);var qt="";"textContent"in $t?qt=$t.textContent:"firstChild"in $t&&$t.firstChild!==null&&"data"in $t.firstChild&&$t.firstChild.data!==null&&(qt=$t.firstChild.data),qt=qt.replace(/^\s+|\s+$|\n+/g,"").replace(/\s+/g," ");var Kt=jt.strokeWidth;jt.strokeWidth=0;var rr=new Ct.Text(qt,jt),ir=rr.getScaledHeight()/rr.height,or=(rr.height+rr.strokeWidth)*rr.lineHeight-rr.height,jr=or*ir,qr=rr.getScaledHeight()+jr,Yr=0;Gt==="center"&&(Yr=rr.getScaledWidth()/2),Gt==="right"&&(Yr=rr.getScaledWidth()),rr.set({left:rr.left-Yr,top:rr.top-(qr-rr.fontSize*(.07+rr._fontSizeFraction))/rr.lineHeight,strokeWidth:typeof Kt<"u"?Kt:1}),Lt(rr)},Ct.Text.fromObject=function($t,Lt){var jt=pt($t),Ft=$t.path;return delete jt.path,Ct.Object._fromObject("Text",jt,function(Gt){Gt.styles=Ct.util.stylesFromArray($t.styles,$t.text),Ft?Ct.Object._fromObject("Path",Ft,function(Ht){Gt.set("path",Ht),Lt(Gt)},"path"):Lt(Gt)},"text")},Ct.Text.genericFonts=["sans-serif","serif","cursive","fantasy","monospace"],Ct.util.createAccessors&&Ct.util.createAccessors(Ct.Text)}(d),function(){g.util.object.extend(g.Text.prototype,{isEmptyStyles:function(Tt){if(!this.styles||typeof Tt<"u"&&!this.styles[Tt])return!0;var Ct=typeof Tt>"u"?this.styles:{line:this.styles[Tt]};for(var pt in Ct)for(var wt in Ct[pt])for(var $t in Ct[pt][wt])return!1;return!0},styleHas:function(Tt,Ct){if(!this.styles||!Tt||Tt===""||typeof Ct<"u"&&!this.styles[Ct])return!1;var pt=typeof Ct>"u"?this.styles:{0:this.styles[Ct]};for(var wt in pt)for(var $t in pt[wt])if(typeof pt[wt][$t][Tt]<"u")return!0;return!1},cleanStyle:function(Tt){if(!this.styles||!Tt||Tt==="")return!1;var Ct=this.styles,pt=0,wt,$t,Lt=!0,jt=0,Ft;for(var Gt in Ct){wt=0;for(var Ht in Ct[Gt]){var Ft=Ct[Gt][Ht],qt=Ft.hasOwnProperty(Tt);pt++,qt?($t?Ft[Tt]!==$t&&(Lt=!1):$t=Ft[Tt],Ft[Tt]===this[Tt]&&delete Ft[Tt]):Lt=!1,Object.keys(Ft).length!==0?wt++:delete Ct[Gt][Ht]}wt===0&&delete Ct[Gt]}for(var Kt=0;Kt<this._textLines.length;Kt++)jt+=this._textLines[Kt].length;Lt&&pt===jt&&(this[Tt]=$t,this.removeStyle(Tt))},removeStyle:function(Tt){if(!(!this.styles||!Tt||Tt==="")){var Ct=this.styles,pt,wt,$t;for(wt in Ct){pt=Ct[wt];for($t in pt)delete pt[$t][Tt],Object.keys(pt[$t]).length===0&&delete pt[$t];Object.keys(pt).length===0&&delete Ct[wt]}}},_extendStyles:function(Tt,Ct){var pt=this.get2DCursorLocation(Tt);this._getLineStyle(pt.lineIndex)||this._setLineStyle(pt.lineIndex),this._getStyleDeclaration(pt.lineIndex,pt.charIndex)||this._setStyleDeclaration(pt.lineIndex,pt.charIndex,{}),g.util.object.extend(this._getStyleDeclaration(pt.lineIndex,pt.charIndex),Ct)},get2DCursorLocation:function(Tt,Ct){typeof Tt>"u"&&(Tt=this.selectionStart);for(var pt=Ct?this._unwrappedTextLines:this._textLines,wt=pt.length,$t=0;$t<wt;$t++){if(Tt<=pt[$t].length)return{lineIndex:$t,charIndex:Tt};Tt-=pt[$t].length+this.missingNewlineOffset($t)}return{lineIndex:$t-1,charIndex:pt[$t-1].length<Tt?pt[$t-1].length:Tt}},getSelectionStyles:function(Tt,Ct,pt){typeof Tt>"u"&&(Tt=this.selectionStart||0),typeof Ct>"u"&&(Ct=this.selectionEnd||Tt);for(var wt=[],$t=Tt;$t<Ct;$t++)wt.push(this.getStyleAtPosition($t,pt));return wt},getStyleAtPosition:function(Tt,Ct){var pt=this.get2DCursorLocation(Tt),wt=Ct?this.getCompleteStyleDeclaration(pt.lineIndex,pt.charIndex):this._getStyleDeclaration(pt.lineIndex,pt.charIndex);return wt||{}},setSelectionStyles:function(Tt,Ct,pt){typeof Ct>"u"&&(Ct=this.selectionStart||0),typeof pt>"u"&&(pt=this.selectionEnd||Ct);for(var wt=Ct;wt<pt;wt++)this._extendStyles(wt,Tt);return this._forceClearCache=!0,this},_getStyleDeclaration:function(Tt,Ct){var pt=this.styles&&this.styles[Tt];return pt?pt[Ct]:null},getCompleteStyleDeclaration:function(Tt,Ct){for(var pt=this._getStyleDeclaration(Tt,Ct)||{},wt={},$t,Lt=0;Lt<this._styleProperties.length;Lt++)$t=this._styleProperties[Lt],wt[$t]=typeof pt[$t]>"u"?this[$t]:pt[$t];return wt},_setStyleDeclaration:function(Tt,Ct,pt){this.styles[Tt][Ct]=pt},_deleteStyleDeclaration:function(Tt,Ct){delete this.styles[Tt][Ct]},_getLineStyle:function(Tt){return!!this.styles[Tt]},_setLineStyle:function(Tt){this.styles[Tt]={}},_deleteLineStyle:function(Tt){delete this.styles[Tt]}})}(),function(){function Tt(Ct){Ct.textDecoration&&(Ct.textDecoration.indexOf("underline")>-1&&(Ct.underline=!0),Ct.textDecoration.indexOf("line-through")>-1&&(Ct.linethrough=!0),Ct.textDecoration.indexOf("overline")>-1&&(Ct.overline=!0),delete Ct.textDecoration)}g.IText=g.util.createClass(g.Text,g.Observable,{type:"i-text",selectionStart:0,selectionEnd:0,selectionColor:"rgba(17,119,255,0.3)",isEditing:!1,editable:!0,editingBorderColor:"rgba(102,153,255,0.25)",cursorWidth:2,cursorColor:"",cursorDelay:1e3,cursorDuration:600,caching:!0,hiddenTextareaContainer:null,_reSpace:/\s|\n/,_currentCursorOpacity:0,_selectionDirection:null,_abortCursorAnimation:!1,__widthOfSpace:[],inCompositionMode:!1,initialize:function(Ct,pt){this.callSuper("initialize",Ct,pt),this.initBehavior()},setSelectionStart:function(Ct){Ct=Math.max(Ct,0),this._updateAndFire("selectionStart",Ct)},setSelectionEnd:function(Ct){Ct=Math.min(Ct,this.text.length),this._updateAndFire("selectionEnd",Ct)},_updateAndFire:function(Ct,pt){this[Ct]!==pt&&(this._fireSelectionChanged(),this[Ct]=pt),this._updateTextarea()},_fireSelectionChanged:function(){this.fire("selection:changed"),this.canvas&&this.canvas.fire("text:selection:changed",{target:this})},initDimensions:function(){this.isEditing&&this.initDelayedCursor(),this.clearContextTop(),this.callSuper("initDimensions")},render:function(Ct){this.clearContextTop(),this.callSuper("render",Ct),this.cursorOffsetCache={},this.renderCursorOrSelection()},_render:function(Ct){this.callSuper("_render",Ct)},clearContextTop:function(Ct){if(!(!this.isEditing||!this.canvas||!this.canvas.contextTop)){var pt=this.canvas.contextTop,wt=this.canvas.viewportTransform;pt.save(),pt.transform(wt[0],wt[1],wt[2],wt[3],wt[4],wt[5]),this.transform(pt),this._clearTextArea(pt),Ct||pt.restore()}},renderCursorOrSelection:function(){if(!(!this.isEditing||!this.canvas||!this.canvas.contextTop)){var Ct=this._getCursorBoundaries(),pt=this.canvas.contextTop;this.clearContextTop(!0),this.selectionStart===this.selectionEnd?this.renderCursor(Ct,pt):this.renderSelection(Ct,pt),pt.restore()}},_clearTextArea:function(Ct){var pt=this.width+4,wt=this.height+4;Ct.clearRect(-pt/2,-wt/2,pt,wt)},_getCursorBoundaries:function(Ct){typeof Ct>"u"&&(Ct=this.selectionStart);var pt=this._getLeftOffset(),wt=this._getTopOffset(),$t=this._getCursorBoundariesOffsets(Ct);return{left:pt,top:wt,leftOffset:$t.left,topOffset:$t.top}},_getCursorBoundariesOffsets:function(Ct){if(this.cursorOffsetCache&&"top"in this.cursorOffsetCache)return this.cursorOffsetCache;var pt,wt,$t,Lt=0,jt=0,Ft,Gt=this.get2DCursorLocation(Ct);$t=Gt.charIndex,wt=Gt.lineIndex;for(var Ht=0;Ht<wt;Ht++)Lt+=this.getHeightOfLine(Ht);pt=this._getLineLeftOffset(wt);var qt=this.__charBounds[wt][$t];return qt&&(jt=qt.left),this.charSpacing!==0&&$t===this._textLines[wt].length&&(jt-=this._getWidthOfCharSpacing()),Ft={top:Lt,left:pt+(jt>0?jt:0)},this.direction==="rtl"&&(Ft.left*=-1),this.cursorOffsetCache=Ft,this.cursorOffsetCache},renderCursor:function(Ct,pt){var wt=this.get2DCursorLocation(),$t=wt.lineIndex,Lt=wt.charIndex>0?wt.charIndex-1:0,jt=this.getValueOfPropertyAt($t,Lt,"fontSize"),Ft=this.scaleX*this.canvas.getZoom(),Gt=this.cursorWidth/Ft,Ht=Ct.topOffset,qt=this.getValueOfPropertyAt($t,Lt,"deltaY");Ht+=(1-this._fontSizeFraction)*this.getHeightOfLine($t)/this.lineHeight-jt*(1-this._fontSizeFraction),this.inCompositionMode&&this.renderSelection(Ct,pt),pt.fillStyle=this.cursorColor||this.getValueOfPropertyAt($t,Lt,"fill"),pt.globalAlpha=this.__isMousedown?1:this._currentCursorOpacity,pt.fillRect(Ct.left+Ct.leftOffset-Gt/2,Ht+Ct.top+qt,Gt,jt)},renderSelection:function(Ct,pt){for(var wt=this.inCompositionMode?this.hiddenTextarea.selectionStart:this.selectionStart,$t=this.inCompositionMode?this.hiddenTextarea.selectionEnd:this.selectionEnd,Lt=this.textAlign.indexOf("justify")!==-1,jt=this.get2DCursorLocation(wt),Ft=this.get2DCursorLocation($t),Gt=jt.lineIndex,Ht=Ft.lineIndex,qt=jt.charIndex<0?0:jt.charIndex,Kt=Ft.charIndex<0?0:Ft.charIndex,rr=Gt;rr<=Ht;rr++){var ir=this._getLineLeftOffset(rr)||0,or=this.getHeightOfLine(rr),jr=0,qr=0,Yr=0;if(rr===Gt&&(qr=this.__charBounds[Gt][qt].left),rr>=Gt&&rr<Ht)Yr=Lt&&!this.isEndOfWrapping(rr)?this.width:this.getLineWidth(rr)||5;else if(rr===Ht)if(Kt===0)Yr=this.__charBounds[Ht][Kt].left;else{var vn=this._getWidthOfCharSpacing();Yr=this.__charBounds[Ht][Kt-1].left+this.__charBounds[Ht][Kt-1].width-vn}jr=or,(this.lineHeight<1||rr===Ht&&this.lineHeight>1)&&(or/=this.lineHeight);var ko=Ct.left+ir+qr,Xo=Yr-qr,zo=or,t0=0;this.inCompositionMode?(pt.fillStyle=this.compositionColor||"black",zo=1,t0=or):pt.fillStyle=this.selectionColor,this.direction==="rtl"&&(ko=this.width-ko-Xo),pt.fillRect(ko,Ct.top+Ct.topOffset+t0,Xo,zo),Ct.topOffset+=jr}},getCurrentCharFontSize:function(){var Ct=this._getCurrentCharIndex();return this.getValueOfPropertyAt(Ct.l,Ct.c,"fontSize")},getCurrentCharColor:function(){var Ct=this._getCurrentCharIndex();return this.getValueOfPropertyAt(Ct.l,Ct.c,"fill")},_getCurrentCharIndex:function(){var Ct=this.get2DCursorLocation(this.selectionStart,!0),pt=Ct.charIndex>0?Ct.charIndex-1:0;return{l:Ct.lineIndex,c:pt}}}),g.IText.fromObject=function(Ct,pt){var wt=g.util.stylesFromArray(Ct.styles,Ct.text),$t=Object.assign({},Ct,{styles:wt});if(Tt($t),$t.styles)for(var Lt in $t.styles)for(var jt in $t.styles[Lt])Tt($t.styles[Lt][jt]);g.Object._fromObject("IText",$t,pt,"text")}}(),function(){var Tt=g.util.object.clone;g.util.object.extend(g.IText.prototype,{initBehavior:function(){this.initAddedHandler(),this.initRemovedHandler(),this.initCursorSelectionHandlers(),this.initDoubleClickSimulation(),this.mouseMoveHandler=this.mouseMoveHandler.bind(this)},onDeselect:function(){this.isEditing&&this.exitEditing(),this.selected=!1},initAddedHandler:function(){var Ct=this;this.on("added",function(){var pt=Ct.canvas;pt&&(pt._hasITextHandlers||(pt._hasITextHandlers=!0,Ct._initCanvasHandlers(pt)),pt._iTextInstances=pt._iTextInstances||[],pt._iTextInstances.push(Ct))})},initRemovedHandler:function(){var Ct=this;this.on("removed",function(){var pt=Ct.canvas;pt&&(pt._iTextInstances=pt._iTextInstances||[],g.util.removeFromArray(pt._iTextInstances,Ct),pt._iTextInstances.length===0&&(pt._hasITextHandlers=!1,Ct._removeCanvasHandlers(pt)))})},_initCanvasHandlers:function(Ct){Ct._mouseUpITextHandler=function(){Ct._iTextInstances&&Ct._iTextInstances.forEach(function(pt){pt.__isMousedown=!1})},Ct.on("mouse:up",Ct._mouseUpITextHandler)},_removeCanvasHandlers:function(Ct){Ct.off("mouse:up",Ct._mouseUpITextHandler)},_tick:function(){this._currentTickState=this._animateCursor(this,1,this.cursorDuration,"_onTickComplete")},_animateCursor:function(Ct,pt,wt,$t){var Lt;return Lt={isAborted:!1,abort:function(){this.isAborted=!0}},Ct.animate("_currentCursorOpacity",pt,{duration:wt,onComplete:function(){Lt.isAborted||Ct[$t]()},onChange:function(){Ct.canvas&&Ct.selectionStart===Ct.selectionEnd&&Ct.renderCursorOrSelection()},abort:function(){return Lt.isAborted}}),Lt},_onTickComplete:function(){var Ct=this;this._cursorTimeout1&&clearTimeout(this._cursorTimeout1),this._cursorTimeout1=setTimeout(function(){Ct._currentTickCompleteState=Ct._animateCursor(Ct,0,this.cursorDuration/2,"_tick")},100)},initDelayedCursor:function(Ct){var pt=this,wt=Ct?0:this.cursorDelay;this.abortCursorAnimation(),this._currentCursorOpacity=1,this._cursorTimeout2=setTimeout(function(){pt._tick()},wt)},abortCursorAnimation:function(){var Ct=this._currentTickState||this._currentTickCompleteState,pt=this.canvas;this._currentTickState&&this._currentTickState.abort(),this._currentTickCompleteState&&this._currentTickCompleteState.abort(),clearTimeout(this._cursorTimeout1),clearTimeout(this._cursorTimeout2),this._currentCursorOpacity=0,Ct&&pt&&pt.clearContext(pt.contextTop||pt.contextContainer)},selectAll:function(){return this.selectionStart=0,this.selectionEnd=this._text.length,this._fireSelectionChanged(),this._updateTextarea(),this},getSelectedText:function(){return this._text.slice(this.selectionStart,this.selectionEnd).join("")},findWordBoundaryLeft:function(Ct){var pt=0,wt=Ct-1;if(this._reSpace.test(this._text[wt]))for(;this._reSpace.test(this._text[wt]);)pt++,wt--;for(;/\S/.test(this._text[wt])&&wt>-1;)pt++,wt--;return Ct-pt},findWordBoundaryRight:function(Ct){var pt=0,wt=Ct;if(this._reSpace.test(this._text[wt]))for(;this._reSpace.test(this._text[wt]);)pt++,wt++;for(;/\S/.test(this._text[wt])&&wt<this._text.length;)pt++,wt++;return Ct+pt},findLineBoundaryLeft:function(Ct){for(var pt=0,wt=Ct-1;!/\n/.test(this._text[wt])&&wt>-1;)pt++,wt--;return Ct-pt},findLineBoundaryRight:function(Ct){for(var pt=0,wt=Ct;!/\n/.test(this._text[wt])&&wt<this._text.length;)pt++,wt++;return Ct+pt},searchWordBoundary:function(Ct,pt){for(var wt=this._text,$t=this._reSpace.test(wt[Ct])?Ct-1:Ct,Lt=wt[$t],jt=g.reNonWord;!jt.test(Lt)&&$t>0&&$t<wt.length;)$t+=pt,Lt=wt[$t];return jt.test(Lt)&&($t+=pt===1?0:1),$t},selectWord:function(Ct){Ct=Ct||this.selectionStart;var pt=this.searchWordBoundary(Ct,-1),wt=this.searchWordBoundary(Ct,1);this.selectionStart=pt,this.selectionEnd=wt,this._fireSelectionChanged(),this._updateTextarea(),this.renderCursorOrSelection()},selectLine:function(Ct){Ct=Ct||this.selectionStart;var pt=this.findLineBoundaryLeft(Ct),wt=this.findLineBoundaryRight(Ct);return this.selectionStart=pt,this.selectionEnd=wt,this._fireSelectionChanged(),this._updateTextarea(),this},enterEditing:function(Ct){if(!(this.isEditing||!this.editable))return this.canvas&&(this.canvas.calcOffset(),this.exitEditingOnOthers(this.canvas)),this.isEditing=!0,this.initHiddenTextarea(Ct),this.hiddenTextarea.focus(),this.hiddenTextarea.value=this.text,this._updateTextarea(),this._saveEditingProps(),this._setEditingProps(),this._textBeforeEdit=this.text,this._tick(),this.fire("editing:entered"),this._fireSelectionChanged(),this.canvas?(this.canvas.fire("text:editing:entered",{target:this}),this.initMouseMoveHandler(),this.canvas.requestRenderAll(),this):this},exitEditingOnOthers:function(Ct){Ct._iTextInstances&&Ct._iTextInstances.forEach(function(pt){pt.selected=!1,pt.isEditing&&pt.exitEditing()})},initMouseMoveHandler:function(){this.canvas.on("mouse:move",this.mouseMoveHandler)},mouseMoveHandler:function(Ct){if(!(!this.__isMousedown||!this.isEditing)){document.activeElement!==this.hiddenTextarea&&this.hiddenTextarea.focus();var pt=this.getSelectionStartFromPointer(Ct.e),wt=this.selectionStart,$t=this.selectionEnd;(pt!==this.__selectionStartOnMouseDown||wt===$t)&&(wt===pt||$t===pt)||(pt>this.__selectionStartOnMouseDown?(this.selectionStart=this.__selectionStartOnMouseDown,this.selectionEnd=pt):(this.selectionStart=pt,this.selectionEnd=this.__selectionStartOnMouseDown),(this.selectionStart!==wt||this.selectionEnd!==$t)&&(this.restartCursorIfNeeded(),this._fireSelectionChanged(),this._updateTextarea(),this.renderCursorOrSelection()))}},_setEditingProps:function(){this.hoverCursor="text",this.canvas&&(this.canvas.defaultCursor=this.canvas.moveCursor="text"),this.borderColor=this.editingBorderColor,this.hasControls=this.selectable=!1,this.lockMovementX=this.lockMovementY=!0},fromStringToGraphemeSelection:function(Ct,pt,wt){var $t=wt.slice(0,Ct),Lt=g.util.string.graphemeSplit($t).length;if(Ct===pt)return{selectionStart:Lt,selectionEnd:Lt};var jt=wt.slice(Ct,pt),Ft=g.util.string.graphemeSplit(jt).length;return{selectionStart:Lt,selectionEnd:Lt+Ft}},fromGraphemeToStringSelection:function(Ct,pt,wt){var $t=wt.slice(0,Ct),Lt=$t.join("").length;if(Ct===pt)return{selectionStart:Lt,selectionEnd:Lt};var jt=wt.slice(Ct,pt),Ft=jt.join("").length;return{selectionStart:Lt,selectionEnd:Lt+Ft}},_updateTextarea:function(){if(this.cursorOffsetCache={},!!this.hiddenTextarea){if(!this.inCompositionMode){var Ct=this.fromGraphemeToStringSelection(this.selectionStart,this.selectionEnd,this._text);this.hiddenTextarea.selectionStart=Ct.selectionStart,this.hiddenTextarea.selectionEnd=Ct.selectionEnd}this.updateTextareaPosition()}},updateFromTextArea:function(){if(this.hiddenTextarea){this.cursorOffsetCache={},this.text=this.hiddenTextarea.value,this._shouldClearDimensionCache()&&(this.initDimensions(),this.setCoords());var Ct=this.fromStringToGraphemeSelection(this.hiddenTextarea.selectionStart,this.hiddenTextarea.selectionEnd,this.hiddenTextarea.value);this.selectionEnd=this.selectionStart=Ct.selectionEnd,this.inCompositionMode||(this.selectionStart=Ct.selectionStart),this.updateTextareaPosition()}},updateTextareaPosition:function(){if(this.selectionStart===this.selectionEnd){var Ct=this._calcTextareaPosition();this.hiddenTextarea.style.left=Ct.left,this.hiddenTextarea.style.top=Ct.top}},_calcTextareaPosition:function(){if(!this.canvas)return{x:1,y:1};var Ct=this.inCompositionMode?this.compositionStart:this.selectionStart,pt=this._getCursorBoundaries(Ct),wt=this.get2DCursorLocation(Ct),$t=wt.lineIndex,Lt=wt.charIndex,jt=this.getValueOfPropertyAt($t,Lt,"fontSize")*this.lineHeight,Ft=pt.leftOffset,Gt=this.calcTransformMatrix(),Ht={x:pt.left+Ft,y:pt.top+pt.topOffset+jt},qt=this.canvas.getRetinaScaling(),Kt=this.canvas.upperCanvasEl,rr=Kt.width/qt,ir=Kt.height/qt,or=rr-jt,jr=ir-jt,qr=Kt.clientWidth/rr,Yr=Kt.clientHeight/ir;return Ht=g.util.transformPoint(Ht,Gt),Ht=g.util.transformPoint(Ht,this.canvas.viewportTransform),Ht.x*=qr,Ht.y*=Yr,Ht.x<0&&(Ht.x=0),Ht.x>or&&(Ht.x=or),Ht.y<0&&(Ht.y=0),Ht.y>jr&&(Ht.y=jr),Ht.x+=this.canvas._offset.left,Ht.y+=this.canvas._offset.top,{left:Ht.x+"px",top:Ht.y+"px",fontSize:jt+"px",charHeight:jt}},_saveEditingProps:function(){this._savedProps={hasControls:this.hasControls,borderColor:this.borderColor,lockMovementX:this.lockMovementX,lockMovementY:this.lockMovementY,hoverCursor:this.hoverCursor,selectable:this.selectable,defaultCursor:this.canvas&&this.canvas.defaultCursor,moveCursor:this.canvas&&this.canvas.moveCursor}},_restoreEditingProps:function(){this._savedProps&&(this.hoverCursor=this._savedProps.hoverCursor,this.hasControls=this._savedProps.hasControls,this.borderColor=this._savedProps.borderColor,this.selectable=this._savedProps.selectable,this.lockMovementX=this._savedProps.lockMovementX,this.lockMovementY=this._savedProps.lockMovementY,this.canvas&&(this.canvas.defaultCursor=this._savedProps.defaultCursor,this.canvas.moveCursor=this._savedProps.moveCursor))},exitEditing:function(){var Ct=this._textBeforeEdit!==this.text,pt=this.hiddenTextarea;return this.selected=!1,this.isEditing=!1,this.selectionEnd=this.selectionStart,pt&&(pt.blur&&pt.blur(),pt.parentNode&&pt.parentNode.removeChild(pt)),this.hiddenTextarea=null,this.abortCursorAnimation(),this._restoreEditingProps(),this._currentCursorOpacity=0,this._shouldClearDimensionCache()&&(this.initDimensions(),this.setCoords()),this.fire("editing:exited"),Ct&&this.fire("modified"),this.canvas&&(this.canvas.off("mouse:move",this.mouseMoveHandler),this.canvas.fire("text:editing:exited",{target:this}),Ct&&this.canvas.fire("object:modified",{target:this})),this},_removeExtraneousStyles:function(){for(var Ct in this.styles)this._textLines[Ct]||delete this.styles[Ct]},removeStyleFromTo:function(Ct,pt){var wt=this.get2DCursorLocation(Ct,!0),$t=this.get2DCursorLocation(pt,!0),Lt=wt.lineIndex,jt=wt.charIndex,Ft=$t.lineIndex,Gt=$t.charIndex,Ht,qt;if(Lt!==Ft){if(this.styles[Lt])for(Ht=jt;Ht<this._unwrappedTextLines[Lt].length;Ht++)delete this.styles[Lt][Ht];if(this.styles[Ft])for(Ht=Gt;Ht<this._unwrappedTextLines[Ft].length;Ht++)qt=this.styles[Ft][Ht],qt&&(this.styles[Lt]||(this.styles[Lt]={}),this.styles[Lt][jt+Ht-Gt]=qt);for(Ht=Lt+1;Ht<=Ft;Ht++)delete this.styles[Ht];this.shiftLineStyles(Ft,Lt-Ft)}else if(this.styles[Lt]){qt=this.styles[Lt];var Kt=Gt-jt,rr,ir;for(Ht=jt;Ht<Gt;Ht++)delete qt[Ht];for(ir in this.styles[Lt])rr=parseInt(ir,10),rr>=Gt&&(qt[rr-Kt]=qt[ir],delete qt[ir])}},shiftLineStyles:function(Ct,pt){var wt=Tt(this.styles);for(var $t in this.styles){var Lt=parseInt($t,10);Lt>Ct&&(this.styles[Lt+pt]=wt[Lt],wt[Lt-pt]||delete this.styles[Lt])}},restartCursorIfNeeded:function(){(!this._currentTickState||this._currentTickState.isAborted||!this._currentTickCompleteState||this._currentTickCompleteState.isAborted)&&this.initDelayedCursor()},insertNewlineStyleObject:function(Ct,pt,wt,$t){var Lt,jt={},Ft=!1,Gt=this._unwrappedTextLines[Ct].length===pt;wt||(wt=1),this.shiftLineStyles(Ct,wt),this.styles[Ct]&&(Lt=this.styles[Ct][pt===0?pt:pt-1]);for(var Ht in this.styles[Ct]){var qt=parseInt(Ht,10);qt>=pt&&(Ft=!0,jt[qt-pt]=this.styles[Ct][Ht],Gt&&pt===0||delete this.styles[Ct][Ht])}var Kt=!1;for(Ft&&!Gt&&(this.styles[Ct+wt]=jt,Kt=!0),Kt&&wt--;wt>0;)$t&&$t[wt-1]?this.styles[Ct+wt]={0:Tt($t[wt-1])}:Lt?this.styles[Ct+wt]={0:Tt(Lt)}:delete this.styles[Ct+wt],wt--;this._forceClearCache=!0},insertCharStyleObject:function(Ct,pt,wt,$t){this.styles||(this.styles={});var Lt=this.styles[Ct],jt=Lt?Tt(Lt):{};wt||(wt=1);for(var Ft in jt){var Gt=parseInt(Ft,10);Gt>=pt&&(Lt[Gt+wt]=jt[Gt],jt[Gt-wt]||delete Lt[Gt])}if(this._forceClearCache=!0,$t){for(;wt--;)Object.keys($t[wt]).length&&(this.styles[Ct]||(this.styles[Ct]={}),this.styles[Ct][pt+wt]=Tt($t[wt]));return}if(Lt)for(var Ht=Lt[pt?pt-1:1];Ht&&wt--;)this.styles[Ct][pt+wt]=Tt(Ht)},insertNewStyleBlock:function(Ct,pt,wt){for(var $t=this.get2DCursorLocation(pt,!0),Lt=[0],jt=0,Ft=0;Ft<Ct.length;Ft++)Ct[Ft]===`
`?(jt++,Lt[jt]=0):Lt[jt]++;Lt[0]>0&&(this.insertCharStyleObject($t.lineIndex,$t.charIndex,Lt[0],wt),wt=wt&&wt.slice(Lt[0]+1)),jt&&this.insertNewlineStyleObject($t.lineIndex,$t.charIndex+Lt[0],jt);for(var Ft=1;Ft<jt;Ft++)Lt[Ft]>0?this.insertCharStyleObject($t.lineIndex+Ft,0,Lt[Ft],wt):wt&&this.styles[$t.lineIndex+Ft]&&wt[0]&&(this.styles[$t.lineIndex+Ft][0]=wt[0]),wt=wt&&wt.slice(Lt[Ft]+1);Lt[Ft]>0&&this.insertCharStyleObject($t.lineIndex+Ft,0,Lt[Ft],wt)},setSelectionStartEndWithShift:function(Ct,pt,wt){wt<=Ct?(pt===Ct?this._selectionDirection="left":this._selectionDirection==="right"&&(this._selectionDirection="left",this.selectionEnd=Ct),this.selectionStart=wt):wt>Ct&&wt<pt?this._selectionDirection==="right"?this.selectionEnd=wt:this.selectionStart=wt:(pt===Ct?this._selectionDirection="right":this._selectionDirection==="left"&&(this._selectionDirection="right",this.selectionStart=pt),this.selectionEnd=wt)},setSelectionInBoundaries:function(){var Ct=this.text.length;this.selectionStart>Ct?this.selectionStart=Ct:this.selectionStart<0&&(this.selectionStart=0),this.selectionEnd>Ct?this.selectionEnd=Ct:this.selectionEnd<0&&(this.selectionEnd=0)}})}(),g.util.object.extend(g.IText.prototype,{initDoubleClickSimulation:function(){this.__lastClickTime=+new Date,this.__lastLastClickTime=+new Date,this.__lastPointer={},this.on("mousedown",this.onMouseDown)},onMouseDown:function(Tt){if(this.canvas){this.__newClickTime=+new Date;var Ct=Tt.pointer;this.isTripleClick(Ct)&&(this.fire("tripleclick",Tt),this._stopEvent(Tt.e)),this.__lastLastClickTime=this.__lastClickTime,this.__lastClickTime=this.__newClickTime,this.__lastPointer=Ct,this.__lastIsEditing=this.isEditing,this.__lastSelected=this.selected}},isTripleClick:function(Tt){return this.__newClickTime-this.__lastClickTime<500&&this.__lastClickTime-this.__lastLastClickTime<500&&this.__lastPointer.x===Tt.x&&this.__lastPointer.y===Tt.y},_stopEvent:function(Tt){Tt.preventDefault&&Tt.preventDefault(),Tt.stopPropagation&&Tt.stopPropagation()},initCursorSelectionHandlers:function(){this.initMousedownHandler(),this.initMouseupHandler(),this.initClicks()},doubleClickHandler:function(Tt){this.isEditing&&this.selectWord(this.getSelectionStartFromPointer(Tt.e))},tripleClickHandler:function(Tt){this.isEditing&&this.selectLine(this.getSelectionStartFromPointer(Tt.e))},initClicks:function(){this.on("mousedblclick",this.doubleClickHandler),this.on("tripleclick",this.tripleClickHandler)},_mouseDownHandler:function(Tt){!this.canvas||!this.editable||Tt.e.button&&Tt.e.button!==1||(this.__isMousedown=!0,this.selected&&(this.inCompositionMode=!1,this.setCursorByClick(Tt.e)),this.isEditing&&(this.__selectionStartOnMouseDown=this.selectionStart,this.selectionStart===this.selectionEnd&&this.abortCursorAnimation(),this.renderCursorOrSelection()))},_mouseDownHandlerBefore:function(Tt){!this.canvas||!this.editable||Tt.e.button&&Tt.e.button!==1||(this.selected=this===this.canvas._activeObject)},initMousedownHandler:function(){this.on("mousedown",this._mouseDownHandler),this.on("mousedown:before",this._mouseDownHandlerBefore)},initMouseupHandler:function(){this.on("mouseup",this.mouseUpHandler)},mouseUpHandler:function(Tt){if(this.__isMousedown=!1,!(!this.editable||this.group||Tt.transform&&Tt.transform.actionPerformed||Tt.e.button&&Tt.e.button!==1)){if(this.canvas){var Ct=this.canvas._activeObject;if(Ct&&Ct!==this)return}this.__lastSelected&&!this.__corner?(this.selected=!1,this.__lastSelected=!1,this.enterEditing(Tt.e),this.selectionStart===this.selectionEnd?this.initDelayedCursor(!0):this.renderCursorOrSelection()):this.selected=!0}},setCursorByClick:function(Tt){var Ct=this.getSelectionStartFromPointer(Tt),pt=this.selectionStart,wt=this.selectionEnd;Tt.shiftKey?this.setSelectionStartEndWithShift(pt,wt,Ct):(this.selectionStart=Ct,this.selectionEnd=Ct),this.isEditing&&(this._fireSelectionChanged(),this._updateTextarea())},getSelectionStartFromPointer:function(Tt){for(var Ct=this.getLocalPointer(Tt),pt=0,wt=0,$t=0,Lt=0,jt=0,Ft,Gt,Ht=0,qt=this._textLines.length;Ht<qt&&$t<=Ct.y;Ht++)$t+=this.getHeightOfLine(Ht)*this.scaleY,jt=Ht,Ht>0&&(Lt+=this._textLines[Ht-1].length+this.missingNewlineOffset(Ht-1));Ft=this._getLineLeftOffset(jt),wt=Ft*this.scaleX,Gt=this._textLines[jt],this.direction==="rtl"&&(Ct.x=this.width*this.scaleX-Ct.x+wt);for(var Kt=0,rr=Gt.length;Kt<rr&&(pt=wt,wt+=this.__charBounds[jt][Kt].kernedWidth*this.scaleX,wt<=Ct.x);Kt++)Lt++;return this._getNewSelectionStartFromOffset(Ct,pt,wt,Lt,rr)},_getNewSelectionStartFromOffset:function(Tt,Ct,pt,wt,$t){var Lt=Tt.x-Ct,jt=pt-Tt.x,Ft=jt>Lt||jt<0?0:1,Gt=wt+Ft;return this.flipX&&(Gt=$t-Gt),Gt>this._text.length&&(Gt=this._text.length),Gt}}),g.util.object.extend(g.IText.prototype,{initHiddenTextarea:function(){this.hiddenTextarea=g.document.createElement("textarea"),this.hiddenTextarea.setAttribute("autocapitalize","off"),this.hiddenTextarea.setAttribute("autocorrect","off"),this.hiddenTextarea.setAttribute("autocomplete","off"),this.hiddenTextarea.setAttribute("spellcheck","false"),this.hiddenTextarea.setAttribute("data-fabric-hiddentextarea",""),this.hiddenTextarea.setAttribute("wrap","off");var Tt=this._calcTextareaPosition();this.hiddenTextarea.style.cssText="position: absolute; top: "+Tt.top+"; left: "+Tt.left+"; z-index: -999; opacity: 0; width: 1px; height: 1px; font-size: 1px; padding-top: "+Tt.fontSize+";",this.hiddenTextareaContainer?this.hiddenTextareaContainer.appendChild(this.hiddenTextarea):g.document.body.appendChild(this.hiddenTextarea),g.util.addListener(this.hiddenTextarea,"keydown",this.onKeyDown.bind(this)),g.util.addListener(this.hiddenTextarea,"keyup",this.onKeyUp.bind(this)),g.util.addListener(this.hiddenTextarea,"input",this.onInput.bind(this)),g.util.addListener(this.hiddenTextarea,"copy",this.copy.bind(this)),g.util.addListener(this.hiddenTextarea,"cut",this.copy.bind(this)),g.util.addListener(this.hiddenTextarea,"paste",this.paste.bind(this)),g.util.addListener(this.hiddenTextarea,"compositionstart",this.onCompositionStart.bind(this)),g.util.addListener(this.hiddenTextarea,"compositionupdate",this.onCompositionUpdate.bind(this)),g.util.addListener(this.hiddenTextarea,"compositionend",this.onCompositionEnd.bind(this)),!this._clickHandlerInitialized&&this.canvas&&(g.util.addListener(this.canvas.upperCanvasEl,"click",this.onClick.bind(this)),this._clickHandlerInitialized=!0)},keysMap:{9:"exitEditing",27:"exitEditing",33:"moveCursorUp",34:"moveCursorDown",35:"moveCursorRight",36:"moveCursorLeft",37:"moveCursorLeft",38:"moveCursorUp",39:"moveCursorRight",40:"moveCursorDown"},keysMapRtl:{9:"exitEditing",27:"exitEditing",33:"moveCursorUp",34:"moveCursorDown",35:"moveCursorLeft",36:"moveCursorRight",37:"moveCursorRight",38:"moveCursorUp",39:"moveCursorLeft",40:"moveCursorDown"},ctrlKeysMapUp:{67:"copy",88:"cut"},ctrlKeysMapDown:{65:"selectAll"},onClick:function(){this.hiddenTextarea&&this.hiddenTextarea.focus()},onKeyDown:function(Tt){if(this.isEditing){var Ct=this.direction==="rtl"?this.keysMapRtl:this.keysMap;if(Tt.keyCode in Ct)this[Ct[Tt.keyCode]](Tt);else if(Tt.keyCode in this.ctrlKeysMapDown&&(Tt.ctrlKey||Tt.metaKey))this[this.ctrlKeysMapDown[Tt.keyCode]](Tt);else return;Tt.stopImmediatePropagation(),Tt.preventDefault(),Tt.keyCode>=33&&Tt.keyCode<=40?(this.inCompositionMode=!1,this.clearContextTop(),this.renderCursorOrSelection()):this.canvas&&this.canvas.requestRenderAll()}},onKeyUp:function(Tt){if(!this.isEditing||this._copyDone||this.inCompositionMode){this._copyDone=!1;return}if(Tt.keyCode in this.ctrlKeysMapUp&&(Tt.ctrlKey||Tt.metaKey))this[this.ctrlKeysMapUp[Tt.keyCode]](Tt);else return;Tt.stopImmediatePropagation(),Tt.preventDefault(),this.canvas&&this.canvas.requestRenderAll()},onInput:function(Tt){var Ct=this.fromPaste;if(this.fromPaste=!1,Tt&&Tt.stopPropagation(),!!this.isEditing){var pt=this._splitTextIntoLines(this.hiddenTextarea.value).graphemeText,wt=this._text.length,$t=pt.length,Lt,jt,Ft=$t-wt,Gt=this.selectionStart,Ht=this.selectionEnd,qt=Gt!==Ht,Kt,rr,ir;if(this.hiddenTextarea.value===""){this.styles={},this.updateFromTextArea(),this.fire("changed"),this.canvas&&(this.canvas.fire("text:changed",{target:this}),this.canvas.requestRenderAll());return}var or=this.fromStringToGraphemeSelection(this.hiddenTextarea.selectionStart,this.hiddenTextarea.selectionEnd,this.hiddenTextarea.value),jr=Gt>or.selectionStart;qt?(Lt=this._text.slice(Gt,Ht),Ft+=Ht-Gt):$t<wt&&(jr?Lt=this._text.slice(Ht+Ft,Ht):Lt=this._text.slice(Gt,Gt-Ft)),jt=pt.slice(or.selectionEnd-Ft,or.selectionEnd),Lt&&Lt.length&&(jt.length&&(Kt=this.getSelectionStyles(Gt,Gt+1,!1),Kt=jt.map(function(){return Kt[0]})),qt?(rr=Gt,ir=Ht):jr?(rr=Ht-Lt.length,ir=Ht):(rr=Ht,ir=Ht+Lt.length),this.removeStyleFromTo(rr,ir)),jt.length&&(Ct&&jt.join("")===g.copiedText&&!g.disableStyleCopyPaste&&(Kt=g.copiedTextStyle),this.insertNewStyleBlock(jt,Gt,Kt)),this.updateFromTextArea(),this.fire("changed"),this.canvas&&(this.canvas.fire("text:changed",{target:this}),this.canvas.requestRenderAll())}},onCompositionStart:function(){this.inCompositionMode=!0},onCompositionEnd:function(){this.inCompositionMode=!1},onCompositionUpdate:function(Tt){this.compositionStart=Tt.target.selectionStart,this.compositionEnd=Tt.target.selectionEnd,this.updateTextareaPosition()},copy:function(){this.selectionStart!==this.selectionEnd&&(g.copiedText=this.getSelectedText(),g.disableStyleCopyPaste?g.copiedTextStyle=null:g.copiedTextStyle=this.getSelectionStyles(this.selectionStart,this.selectionEnd,!0),this._copyDone=!0)},paste:function(){this.fromPaste=!0},_getClipboardData:function(Tt){return Tt&&Tt.clipboardData||g.window.clipboardData},_getWidthBeforeCursor:function(Tt,Ct){var pt=this._getLineLeftOffset(Tt),wt;return Ct>0&&(wt=this.__charBounds[Tt][Ct-1],pt+=wt.left+wt.width),pt},getDownCursorOffset:function(Tt,Ct){var pt=this._getSelectionForOffset(Tt,Ct),wt=this.get2DCursorLocation(pt),$t=wt.lineIndex;if($t===this._textLines.length-1||Tt.metaKey||Tt.keyCode===34)return this._text.length-pt;var Lt=wt.charIndex,jt=this._getWidthBeforeCursor($t,Lt),Ft=this._getIndexOnLine($t+1,jt),Gt=this._textLines[$t].slice(Lt);return Gt.length+Ft+1+this.missingNewlineOffset($t)},_getSelectionForOffset:function(Tt,Ct){return Tt.shiftKey&&this.selectionStart!==this.selectionEnd&&Ct?this.selectionEnd:this.selectionStart},getUpCursorOffset:function(Tt,Ct){var pt=this._getSelectionForOffset(Tt,Ct),wt=this.get2DCursorLocation(pt),$t=wt.lineIndex;if($t===0||Tt.metaKey||Tt.keyCode===33)return-pt;var Lt=wt.charIndex,jt=this._getWidthBeforeCursor($t,Lt),Ft=this._getIndexOnLine($t-1,jt),Gt=this._textLines[$t].slice(0,Lt),Ht=this.missingNewlineOffset($t-1);return-this._textLines[$t-1].length+Ft-Gt.length+(1-Ht)},_getIndexOnLine:function(Tt,Ct){for(var pt=this._textLines[Tt],wt=this._getLineLeftOffset(Tt),$t=wt,Lt=0,jt,Ft,Gt=0,Ht=pt.length;Gt<Ht;Gt++)if(jt=this.__charBounds[Tt][Gt].width,$t+=jt,$t>Ct){Ft=!0;var qt=$t-jt,Kt=$t,rr=Math.abs(qt-Ct),ir=Math.abs(Kt-Ct);Lt=ir<rr?Gt:Gt-1;break}return Ft||(Lt=pt.length-1),Lt},moveCursorDown:function(Tt){this.selectionStart>=this._text.length&&this.selectionEnd>=this._text.length||this._moveCursorUpOrDown("Down",Tt)},moveCursorUp:function(Tt){this.selectionStart===0&&this.selectionEnd===0||this._moveCursorUpOrDown("Up",Tt)},_moveCursorUpOrDown:function(Tt,Ct){var pt="get"+Tt+"CursorOffset",wt=this[pt](Ct,this._selectionDirection==="right");Ct.shiftKey?this.moveCursorWithShift(wt):this.moveCursorWithoutShift(wt),wt!==0&&(this.setSelectionInBoundaries(),this.abortCursorAnimation(),this._currentCursorOpacity=1,this.initDelayedCursor(),this._fireSelectionChanged(),this._updateTextarea())},moveCursorWithShift:function(Tt){var Ct=this._selectionDirection==="left"?this.selectionStart+Tt:this.selectionEnd+Tt;return this.setSelectionStartEndWithShift(this.selectionStart,this.selectionEnd,Ct),Tt!==0},moveCursorWithoutShift:function(Tt){return Tt<0?(this.selectionStart+=Tt,this.selectionEnd=this.selectionStart):(this.selectionEnd+=Tt,this.selectionStart=this.selectionEnd),Tt!==0},moveCursorLeft:function(Tt){this.selectionStart===0&&this.selectionEnd===0||this._moveCursorLeftOrRight("Left",Tt)},_move:function(Tt,Ct,pt){var wt;if(Tt.altKey)wt=this["findWordBoundary"+pt](this[Ct]);else if(Tt.metaKey||Tt.keyCode===35||Tt.keyCode===36)wt=this["findLineBoundary"+pt](this[Ct]);else return this[Ct]+=pt==="Left"?-1:1,!0;if(typeof wt<"u"&&this[Ct]!==wt)return this[Ct]=wt,!0},_moveLeft:function(Tt,Ct){return this._move(Tt,Ct,"Left")},_moveRight:function(Tt,Ct){return this._move(Tt,Ct,"Right")},moveCursorLeftWithoutShift:function(Tt){var Ct=!0;return this._selectionDirection="left",this.selectionEnd===this.selectionStart&&this.selectionStart!==0&&(Ct=this._moveLeft(Tt,"selectionStart")),this.selectionEnd=this.selectionStart,Ct},moveCursorLeftWithShift:function(Tt){if(this._selectionDirection==="right"&&this.selectionStart!==this.selectionEnd)return this._moveLeft(Tt,"selectionEnd");if(this.selectionStart!==0)return this._selectionDirection="left",this._moveLeft(Tt,"selectionStart")},moveCursorRight:function(Tt){this.selectionStart>=this._text.length&&this.selectionEnd>=this._text.length||this._moveCursorLeftOrRight("Right",Tt)},_moveCursorLeftOrRight:function(Tt,Ct){var pt="moveCursor"+Tt+"With";this._currentCursorOpacity=1,Ct.shiftKey?pt+="Shift":pt+="outShift",this[pt](Ct)&&(this.abortCursorAnimation(),this.initDelayedCursor(),this._fireSelectionChanged(),this._updateTextarea())},moveCursorRightWithShift:function(Tt){if(this._selectionDirection==="left"&&this.selectionStart!==this.selectionEnd)return this._moveRight(Tt,"selectionStart");if(this.selectionEnd!==this._text.length)return this._selectionDirection="right",this._moveRight(Tt,"selectionEnd")},moveCursorRightWithoutShift:function(Tt){var Ct=!0;return this._selectionDirection="right",this.selectionStart===this.selectionEnd?(Ct=this._moveRight(Tt,"selectionStart"),this.selectionEnd=this.selectionStart):this.selectionStart=this.selectionEnd,Ct},removeChars:function(Tt,Ct){typeof Ct>"u"&&(Ct=Tt+1),this.removeStyleFromTo(Tt,Ct),this._text.splice(Tt,Ct-Tt),this.text=this._text.join(""),this.set("dirty",!0),this._shouldClearDimensionCache()&&(this.initDimensions(),this.setCoords()),this._removeExtraneousStyles()},insertChars:function(Tt,Ct,pt,wt){typeof wt>"u"&&(wt=pt),wt>pt&&this.removeStyleFromTo(pt,wt);var $t=g.util.string.graphemeSplit(Tt);this.insertNewStyleBlock($t,pt,Ct),this._text=[].concat(this._text.slice(0,pt),$t,this._text.slice(wt)),this.text=this._text.join(""),this.set("dirty",!0),this._shouldClearDimensionCache()&&(this.initDimensions(),this.setCoords()),this._removeExtraneousStyles()}}),function(){var Tt=g.util.toFixed,Ct=/  +/g;g.util.object.extend(g.Text.prototype,{_toSVG:function(){var pt=this._getSVGLeftTopOffsets(),wt=this._getSVGTextAndBg(pt.textTop,pt.textLeft);return this._wrapSVGTextAndBg(wt)},toSVG:function(pt){return this._createBaseSVGMarkup(this._toSVG(),{reviver:pt,noStyle:!0,withShadow:!0})},_getSVGLeftTopOffsets:function(){return{textLeft:-this.width/2,textTop:-this.height/2,lineTop:this.getHeightOfLine(0)}},_wrapSVGTextAndBg:function(pt){var wt=!0,$t=this.getSvgTextDecoration(this);return[pt.textBgRects.join(""),'		<text xml:space="preserve" ',this.fontFamily?'font-family="'+this.fontFamily.replace(/"/g,"'")+'" ':"",this.fontSize?'font-size="'+this.fontSize+'" ':"",this.fontStyle?'font-style="'+this.fontStyle+'" ':"",this.fontWeight?'font-weight="'+this.fontWeight+'" ':"",$t?'text-decoration="'+$t+'" ':"",'style="',this.getSvgStyles(wt),'"',this.addPaintOrder()," >",pt.textSpans.join(""),`</text>
`]},_getSVGTextAndBg:function(pt,wt){var $t=[],Lt=[],jt=pt,Ft;this._setSVGBg(Lt);for(var Gt=0,Ht=this._textLines.length;Gt<Ht;Gt++)Ft=this._getLineLeftOffset(Gt),(this.textBackgroundColor||this.styleHas("textBackgroundColor",Gt))&&this._setSVGTextLineBg(Lt,Gt,wt+Ft,jt),this._setSVGTextLineText($t,Gt,wt+Ft,jt),jt+=this.getHeightOfLine(Gt);return{textSpans:$t,textBgRects:Lt}},_createTextCharSpan:function(pt,wt,$t,Lt){var jt=pt!==pt.trim()||pt.match(Ct),Ft=this.getSvgSpanStyles(wt,jt),Gt=Ft?'style="'+Ft+'"':"",Ht=wt.deltaY,qt="",Kt=g.Object.NUM_FRACTION_DIGITS;return Ht&&(qt=' dy="'+Tt(Ht,Kt)+'" '),['<tspan x="',Tt($t,Kt),'" y="',Tt(Lt,Kt),'" ',qt,Gt,">",g.util.string.escapeXml(pt),"</tspan>"].join("")},_setSVGTextLineText:function(pt,wt,$t,Lt){var jt=this.getHeightOfLine(wt),Ft=this.textAlign.indexOf("justify")!==-1,Gt,Ht,qt="",Kt,rr,ir=0,or=this._textLines[wt],jr;Lt+=jt*(1-this._fontSizeFraction)/this.lineHeight;for(var qr=0,Yr=or.length-1;qr<=Yr;qr++)jr=qr===Yr||this.charSpacing,qt+=or[qr],Kt=this.__charBounds[wt][qr],ir===0?($t+=Kt.kernedWidth-Kt.width,ir+=Kt.width):ir+=Kt.kernedWidth,Ft&&!jr&&this._reSpaceAndTab.test(or[qr])&&(jr=!0),jr||(Gt=Gt||this.getCompleteStyleDeclaration(wt,qr),Ht=this.getCompleteStyleDeclaration(wt,qr+1),jr=g.util.hasStyleChanged(Gt,Ht,!0)),jr&&(rr=this._getStyleDeclaration(wt,qr)||{},pt.push(this._createTextCharSpan(qt,rr,$t,Lt)),qt="",Gt=Ht,$t+=ir,ir=0)},_pushTextBgRect:function(pt,wt,$t,Lt,jt,Ft){var Gt=g.Object.NUM_FRACTION_DIGITS;pt.push("		<rect ",this._getFillAttributes(wt),' x="',Tt($t,Gt),'" y="',Tt(Lt,Gt),'" width="',Tt(jt,Gt),'" height="',Tt(Ft,Gt),`"></rect>
`)},_setSVGTextLineBg:function(pt,wt,$t,Lt){for(var jt=this._textLines[wt],Ft=this.getHeightOfLine(wt)/this.lineHeight,Gt=0,Ht=0,qt,Kt,rr=this.getValueOfPropertyAt(wt,0,"textBackgroundColor"),ir=0,or=jt.length;ir<or;ir++)qt=this.__charBounds[wt][ir],Kt=this.getValueOfPropertyAt(wt,ir,"textBackgroundColor"),Kt!==rr?(rr&&this._pushTextBgRect(pt,rr,$t+Ht,Lt,Gt,Ft),Ht=qt.left,Gt=qt.width,rr=Kt):Gt+=qt.kernedWidth;Kt&&this._pushTextBgRect(pt,Kt,$t+Ht,Lt,Gt,Ft)},_getFillAttributes:function(pt){var wt=pt&&typeof pt=="string"?new g.Color(pt):"";return!wt||!wt.getSource()||wt.getAlpha()===1?'fill="'+pt+'"':'opacity="'+wt.getAlpha()+'" fill="'+wt.setAlpha(1).toRgb()+'"'},_getSVGLineTopOffset:function(pt){for(var wt=0,$t=0,Lt=0;Lt<pt;Lt++)wt+=this.getHeightOfLine(Lt);return $t=this.getHeightOfLine(Lt),{lineTop:wt,offset:(this._fontSizeMult-this._fontSizeFraction)*$t/(this.lineHeight*this._fontSizeMult)}},getSvgStyles:function(pt){var wt=g.Object.prototype.getSvgStyles.call(this,pt);return wt+" white-space: pre;"}})}(),function(Tt){var Ct=Tt.fabric||(Tt.fabric={});Ct.Textbox=Ct.util.createClass(Ct.IText,Ct.Observable,{type:"textbox",minWidth:20,dynamicMinWidth:2,__cachedLines:null,lockScalingFlip:!0,noScaleCache:!1,_dimensionAffectingProps:Ct.Text.prototype._dimensionAffectingProps.concat("width"),_wordJoiners:/[ \t\r]/,splitByGrapheme:!1,initDimensions:function(){this.__skipDimension||(this.isEditing&&this.initDelayedCursor(),this.clearContextTop(),this._clearCache(),this.dynamicMinWidth=0,this._styleMap=this._generateStyleMap(this._splitText()),this.dynamicMinWidth>this.width&&this._set("width",this.dynamicMinWidth),this.textAlign.indexOf("justify")!==-1&&this.enlargeSpaces(),this.height=this.calcTextHeight(),this.saveState({propertySet:"_dimensionAffectingProps"}))},_generateStyleMap:function(pt){for(var wt=0,$t=0,Lt=0,jt={},Ft=0;Ft<pt.graphemeLines.length;Ft++)pt.graphemeText[Lt]===`
`&&Ft>0?($t=0,Lt++,wt++):!this.splitByGrapheme&&this._reSpaceAndTab.test(pt.graphemeText[Lt])&&Ft>0&&($t++,Lt++),jt[Ft]={line:wt,offset:$t},Lt+=pt.graphemeLines[Ft].length,$t+=pt.graphemeLines[Ft].length;return jt},styleHas:function(pt,wt){if(this._styleMap&&!this.isWrapping){var $t=this._styleMap[wt];$t&&(wt=$t.line)}return Ct.Text.prototype.styleHas.call(this,pt,wt)},isEmptyStyles:function(pt){if(!this.styles)return!0;var wt=0,$t=pt+1,Lt,jt,Ft=!1,Gt=this._styleMap[pt],Ht=this._styleMap[pt+1];Gt&&(pt=Gt.line,wt=Gt.offset),Ht&&($t=Ht.line,Ft=$t===pt,Lt=Ht.offset),jt=typeof pt>"u"?this.styles:{line:this.styles[pt]};for(var qt in jt)for(var Kt in jt[qt])if(Kt>=wt&&(!Ft||Kt<Lt))for(var rr in jt[qt][Kt])return!1;return!0},_getStyleDeclaration:function(pt,wt){if(this._styleMap&&!this.isWrapping){var $t=this._styleMap[pt];if(!$t)return null;pt=$t.line,wt=$t.offset+wt}return this.callSuper("_getStyleDeclaration",pt,wt)},_setStyleDeclaration:function(pt,wt,$t){var Lt=this._styleMap[pt];pt=Lt.line,wt=Lt.offset+wt,this.styles[pt][wt]=$t},_deleteStyleDeclaration:function(pt,wt){var $t=this._styleMap[pt];pt=$t.line,wt=$t.offset+wt,delete this.styles[pt][wt]},_getLineStyle:function(pt){var wt=this._styleMap[pt];return!!this.styles[wt.line]},_setLineStyle:function(pt){var wt=this._styleMap[pt];this.styles[wt.line]={}},_wrapText:function(pt,wt){var $t=[],Lt;for(this.isWrapping=!0,Lt=0;Lt<pt.length;Lt++)$t=$t.concat(this._wrapLine(pt[Lt],Lt,wt));return this.isWrapping=!1,$t},_measureWord:function(pt,wt,$t){var Lt=0,jt,Ft=!0;$t=$t||0;for(var Gt=0,Ht=pt.length;Gt<Ht;Gt++){var qt=this._getGraphemeBox(pt[Gt],wt,Gt+$t,jt,Ft);Lt+=qt.kernedWidth,jt=pt[Gt]}return Lt},_wrapLine:function(pt,wt,$t,ko){var jt=0,Ft=this.splitByGrapheme,Gt=[],Ht=[],qt=Ft?Ct.util.string.graphemeSplit(pt):pt.split(this._wordJoiners),Kt="",rr=0,ir=Ft?"":" ",or=0,jr=0,qr=0,Yr=!0,vn=this._getWidthOfCharSpacing(),ko=ko||0;qt.length===0&&qt.push([]),$t-=ko;for(var Xo=0;Xo<qt.length;Xo++)Kt=Ft?qt[Xo]:Ct.util.string.graphemeSplit(qt[Xo]),or=this._measureWord(Kt,wt,rr),rr+=Kt.length,jt+=jr+or-vn,jt>$t&&!Yr?(Gt.push(Ht),Ht=[],jt=or,Yr=!0):jt+=vn,!Yr&&!Ft&&Ht.push(ir),Ht=Ht.concat(Kt),jr=Ft?0:this._measureWord([ir],wt,rr),rr++,Yr=!1,or>qr&&(qr=or);return Xo&&Gt.push(Ht),qr+ko>this.dynamicMinWidth&&(this.dynamicMinWidth=qr-vn+ko),Gt},isEndOfWrapping:function(pt){return!this._styleMap[pt+1]||this._styleMap[pt+1].line!==this._styleMap[pt].line},missingNewlineOffset:function(pt){return this.splitByGrapheme?this.isEndOfWrapping(pt)?1:0:1},_splitTextIntoLines:function(pt){for(var wt=Ct.Text.prototype._splitTextIntoLines.call(this,pt),$t=this._wrapText(wt.lines,this.width),Lt=new Array($t.length),jt=0;jt<$t.length;jt++)Lt[jt]=$t[jt].join("");return wt.lines=Lt,wt.graphemeLines=$t,wt},getMinWidth:function(){return Math.max(this.minWidth,this.dynamicMinWidth)},_removeExtraneousStyles:function(){var pt={};for(var wt in this._styleMap)this._textLines[wt]&&(pt[this._styleMap[wt].line]=1);for(var wt in this.styles)pt[wt]||delete this.styles[wt]},toObject:function(pt){return this.callSuper("toObject",["minWidth","splitByGrapheme"].concat(pt))}}),Ct.Textbox.fromObject=function(pt,wt){var $t=Ct.util.stylesFromArray(pt.styles,pt.text),Lt=Object.assign({},pt,{styles:$t});return Ct.Object._fromObject("Textbox",Lt,wt,"text")}}(d),function(){var Tt=g.controlsUtils,Ct=Tt.scaleSkewCursorStyleHandler,pt=Tt.scaleCursorStyleHandler,wt=Tt.scalingEqually,$t=Tt.scalingYOrSkewingX,Lt=Tt.scalingXOrSkewingY,jt=Tt.scaleOrSkewActionName,Ft=g.Object.prototype.controls;if(Ft.ml=new g.Control({x:-.5,y:0,cursorStyleHandler:Ct,actionHandler:Lt,getActionName:jt}),Ft.mr=new g.Control({x:.5,y:0,cursorStyleHandler:Ct,actionHandler:Lt,getActionName:jt}),Ft.mb=new g.Control({x:0,y:.5,cursorStyleHandler:Ct,actionHandler:$t,getActionName:jt}),Ft.mt=new g.Control({x:0,y:-.5,cursorStyleHandler:Ct,actionHandler:$t,getActionName:jt}),Ft.tl=new g.Control({x:-.5,y:-.5,cursorStyleHandler:pt,actionHandler:wt}),Ft.tr=new g.Control({x:.5,y:-.5,cursorStyleHandler:pt,actionHandler:wt}),Ft.bl=new g.Control({x:-.5,y:.5,cursorStyleHandler:pt,actionHandler:wt}),Ft.br=new g.Control({x:.5,y:.5,cursorStyleHandler:pt,actionHandler:wt}),Ft.mtr=new g.Control({x:0,y:-.5,actionHandler:Tt.rotationWithSnapping,cursorStyleHandler:Tt.rotationStyleHandler,offsetY:-40,withConnection:!0,actionName:"rotate"}),g.Textbox){var Gt=g.Textbox.prototype.controls={};Gt.mtr=Ft.mtr,Gt.tr=Ft.tr,Gt.br=Ft.br,Gt.tl=Ft.tl,Gt.bl=Ft.bl,Gt.mt=Ft.mt,Gt.mb=Ft.mb,Gt.mr=new g.Control({x:.5,y:0,actionHandler:Tt.changeWidth,cursorStyleHandler:Ct,actionName:"resizing"}),Gt.ml=new g.Control({x:-.5,y:0,actionHandler:Tt.changeWidth,cursorStyleHandler:Ct,actionName:"resizing"})}}()})(fabric);function cn$1(...d){return twMerge(clsx(d))}function dataURItoBlob(d){const g=d.split(",")[0].split(":")[1].split(";")[0],b=atob(d.split(",")[1]),et=[];for(let st=0;st<b.length;st+=1)et.push(b.charCodeAt(st));return new Blob([new Uint8Array(et)],{type:g})}function loadImage$1(d,g){return new Promise((b,et)=>{const st=d.src,at=d;at.onload=b,at.onerror=vt=>{at.src=st,et(vt)},at.src=g})}async function blobToImage(d){const g=URL.createObjectURL(d),b=new Image;return await loadImage$1(b,g),b}function canvasToImage(d){return new Promise((g,b)=>{const et=new Image;et.addEventListener("load",()=>{g(et)}),et.addEventListener("error",st=>{b(st)}),et.src=d.toDataURL()})}function srcToFile(d,g,b){return fetch(d).then(function(et){return et.arrayBuffer()}).then(function(et){return new File([et],g,{type:b})})}function randomNumberInRange(d,g){return Math.floor(Math.random()*(g-d+1))+d}async function askWritePermission(){try{const{state:d}=await navigator.permissions.query({name:"clipboard-write"});return d==="granted"}catch{return!1}}function canvasToBlob(d,g){return new Promise((b,et)=>d.toBlob(async st=>{st?b(st):et(new Error("Expected toBlob() to be defined"))},g))}function base64ToBlob(d){const g=atob(d),b=new Array(g.length);for(let at=0;at<g.length;at++)b[at]=g.charCodeAt(at);const et=new Uint8Array(b);return new Blob([et],{type:"image/png"})}const setToClipboard=async d=>{const g=[new ClipboardItem({[d.type]:d})];await navigator.clipboard.write(g)};function isMidClick(d){return d.e.button===1}async function copyCanvasImage(d){const g=await canvasToBlob(d,"image/png");try{await setToClipboard(g)}catch{console.log("Copy image failed!")}}function drawLines(d,g,b=BRUSH_COLOR){d.strokeStyle=b,d.lineCap="round",d.lineJoin="round",g.forEach(et=>{!(et!=null&&et.pts.length)||!et.size||(d.lineWidth=et.size,d.beginPath(),d.moveTo(et.pts[0].x,et.pts[0].y),et.pts.forEach(st=>d.lineTo(st.x,st.y)),d.stroke())})}const generateMask=(d,g,b,et=[],st="white")=>{const at=document.createElement("canvas");at.width=d,at.height=g;const vt=at.getContext("2d");if(!vt)throw new Error("could not retrieve mask canvas");return et.forEach(Tt=>{vt.drawImage(Tt,0,0,d,g)}),b.forEach(Tt=>{drawLines(vt,Tt,st)}),at},generateFromCanvas=(d,g,b)=>new Promise((et,st)=>{var at=new fabric.fabric.Canvas(null,{width:g,height:b});let vt,Tt;const Ct=JSON.parse(d),pt=Ct.objects.filter(jt=>jt.type==="path"),wt={...Ct,objects:pt},$t=Ct.objects.filter(jt=>jt.type==="image"),Lt={...Ct,objects:$t};at.loadFromJSON(wt,()=>{try{if(Tt=at.toDataURL(),!Tt)throw new Error("Mask generation failed")}catch(jt){st(jt)}}),at.clear(),at.loadFromJSON(Lt,()=>{try{if(vt=at.toDataURL(),!vt)throw new Error("Image generation failed");et({targetMask:Tt,targetFile:vt})}catch(jt){st(jt)}})}),convertToBase64=d=>new Promise((g,b)=>{const et=new FileReader;et.onload=st=>{var vt;const at=(vt=st.target)==null?void 0:vt.result;g(at)},et.onerror=st=>{b(st)},et.readAsDataURL(d)}),ToastProvider=$054eb8030ebde76e$export$2881499e37b75b9a,ToastViewport=reactExports.forwardRef(({className:d,...g},b)=>jsxRuntimeExports.jsx($054eb8030ebde76e$export$d5c6c08dc2d3ca7,{ref:b,className:cn$1("fixed top-0 z-[100] flex max-h-screen w-full flex-col-reverse p-4 sm:bottom-0 sm:right-0 sm:top-auto sm:flex-col md:max-w-[420px]",d),tabIndex:-1,...g}));ToastViewport.displayName=$054eb8030ebde76e$export$d5c6c08dc2d3ca7.displayName;const toastVariants=cva("group pointer-events-auto relative flex w-full items-center justify-between space-x-2 overflow-hidden rounded-md border p-4 pr-6 shadow-lg transition-all data-[swipe=cancel]:translate-x-0 data-[swipe=end]:translate-x-[var(--radix-toast-swipe-end-x)] data-[swipe=move]:translate-x-[var(--radix-toast-swipe-move-x)] data-[swipe=move]:transition-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[swipe=end]:animate-out data-[state=closed]:fade-out-80 data-[state=closed]:slide-out-to-right-full data-[state=open]:slide-in-from-top-full data-[state=open]:sm:slide-in-from-bottom-full",{variants:{variant:{default:"border bg-background text-foreground",destructive:"destructive group border-destructive bg-destructive text-destructive-foreground"}},defaultVariants:{variant:"default"}}),Toast=reactExports.forwardRef(({className:d,variant:g,...b},et)=>jsxRuntimeExports.jsx($054eb8030ebde76e$export$be92b6f5f03c0fe9,{ref:et,className:cn$1(toastVariants({variant:g}),d),tabIndex:-1,...b}));Toast.displayName=$054eb8030ebde76e$export$be92b6f5f03c0fe9.displayName;const ToastAction=reactExports.forwardRef(({className:d,...g},b)=>jsxRuntimeExports.jsx($054eb8030ebde76e$export$e19cd5f9376f8cee,{ref:b,className:cn$1("inline-flex h-8 shrink-0 items-center justify-center rounded-md border bg-transparent px-3 text-sm font-medium transition-colors hover:bg-secondary focus:outline-none focus:ring-1 focus:ring-ring disabled:pointer-events-none disabled:opacity-50 group-[.destructive]:border-muted/40 group-[.destructive]:hover:border-destructive/30 group-[.destructive]:hover:bg-destructive group-[.destructive]:hover:text-destructive-foreground group-[.destructive]:focus:ring-destructive",d),tabIndex:-1,...g}));ToastAction.displayName=$054eb8030ebde76e$export$e19cd5f9376f8cee.displayName;const ToastClose=reactExports.forwardRef(({className:d,...g},b)=>jsxRuntimeExports.jsx($054eb8030ebde76e$export$f39c2d165cd861fe,{ref:b,className:cn$1("absolute right-1 top-1 rounded-md p-1 text-foreground/50 opacity-0 transition-opacity hover:text-foreground focus:opacity-100 focus:outline-none focus:ring-1 group-hover:opacity-100 group-[.destructive]:text-red-300 group-[.destructive]:hover:text-red-50 group-[.destructive]:focus:ring-red-400 group-[.destructive]:focus:ring-offset-red-600",d),"toast-close":"",tabIndex:-1,...g,children:jsxRuntimeExports.jsx(Cross2Icon,{className:"h-4 w-4"})}));ToastClose.displayName=$054eb8030ebde76e$export$f39c2d165cd861fe.displayName;const ToastTitle=reactExports.forwardRef(({className:d,...g},b)=>jsxRuntimeExports.jsx($054eb8030ebde76e$export$f99233281efd08a0,{ref:b,className:cn$1("text-sm font-semibold [&+div]:text-xs",d),tabIndex:-1,...g}));ToastTitle.displayName=$054eb8030ebde76e$export$f99233281efd08a0.displayName;const ToastDescription=reactExports.forwardRef(({className:d,...g},b)=>jsxRuntimeExports.jsx($054eb8030ebde76e$export$393edc798c47379d,{ref:b,className:cn$1("text-sm opacity-90",d),...g,tabIndex:-1}));ToastDescription.displayName=$054eb8030ebde76e$export$393edc798c47379d.displayName;const TOAST_LIMIT=1,TOAST_REMOVE_DELAY=1e6;let count=0;function genId(){return count=(count+1)%Number.MAX_VALUE,count.toString()}const toastTimeouts=new Map,addToRemoveQueue=d=>{if(toastTimeouts.has(d))return;const g=setTimeout(()=>{toastTimeouts.delete(d),dispatch({type:"REMOVE_TOAST",toastId:d})},TOAST_REMOVE_DELAY);toastTimeouts.set(d,g)},reducer=(d,g)=>{switch(g.type){case"ADD_TOAST":return{...d,toasts:[g.toast,...d.toasts].slice(0,TOAST_LIMIT)};case"UPDATE_TOAST":return{...d,toasts:d.toasts.map(b=>b.id===g.toast.id?{...b,...g.toast}:b)};case"DISMISS_TOAST":{const{toastId:b}=g;return b?addToRemoveQueue(b):d.toasts.forEach(et=>{addToRemoveQueue(et.id)}),{...d,toasts:d.toasts.map(et=>et.id===b||b===void 0?{...et,open:!1}:et)}}case"REMOVE_TOAST":return g.toastId===void 0?{...d,toasts:[]}:{...d,toasts:d.toasts.filter(b=>b.id!==g.toastId)}}},listeners=[];let memoryState={toasts:[]};function dispatch(d){memoryState=reducer(memoryState,d),listeners.forEach(g=>{g(memoryState)})}function toast({...d}){const g=genId(),b=st=>dispatch({type:"UPDATE_TOAST",toast:{...st,id:g}}),et=()=>dispatch({type:"DISMISS_TOAST",toastId:g});return dispatch({type:"ADD_TOAST",toast:{...d,id:g,open:!0,onOpenChange:st=>{st||et()}}}),{id:g,dismiss:et,update:b}}function useToast(){const[d,g]=reactExports.useState(memoryState);return reactExports.useEffect(()=>(listeners.push(g),()=>{const b=listeners.indexOf(g);b>-1&&listeners.splice(b,1)}),[d]),{...d,toast,dismiss:b=>dispatch({type:"DISMISS_TOAST",toastId:b})}}function Toaster(){const{toasts:d}=useToast();return jsxRuntimeExports.jsxs(ToastProvider,{children:[d.map(function({id:g,title:b,description:et,action:st,...at}){return jsxRuntimeExports.jsxs(Toast,{...at,children:[jsxRuntimeExports.jsxs("div",{className:"grid gap-1",children:[b&&jsxRuntimeExports.jsx(ToastTitle,{children:b}),et&&jsxRuntimeExports.jsx(ToastDescription,{children:et})]}),st,jsxRuntimeExports.jsx(ToastClose,{})]},g)}),jsxRuntimeExports.jsx(ToastViewport,{})]})}/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const toKebabCase=d=>d.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),mergeClasses=(...d)=>d.filter((g,b,et)=>!!g&&et.indexOf(g)===b).join(" ");/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var defaultAttributes={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Icon=reactExports.forwardRef(({color:d="currentColor",size:g=24,strokeWidth:b=2,absoluteStrokeWidth:et,className:st="",children:at,iconNode:vt,...Tt},Ct)=>reactExports.createElement("svg",{ref:Ct,...defaultAttributes,width:g,height:g,stroke:d,strokeWidth:et?Number(b)*24/Number(g):b,className:mergeClasses("lucide",st),...Tt},[...vt.map(([pt,wt])=>reactExports.createElement(pt,wt)),...Array.isArray(at)?at:[at]]));/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const createLucideIcon=(d,g)=>{const b=reactExports.forwardRef(({className:et,...st},at)=>reactExports.createElement(Icon,{ref:at,iconNode:g,className:mergeClasses(`lucide-${toKebabCase(d)}`,et),...st}));return b.displayName=`${d}`,b};/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Check=createLucideIcon("Check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ChevronLeft=createLucideIcon("ChevronLeft",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ChevronRight=createLucideIcon("ChevronRight",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ChevronsUpDown=createLucideIcon("ChevronsUpDown",[["path",{d:"m7 15 5 5 5-5",key:"1hf1tw"}],["path",{d:"m7 9 5-5 5 5",key:"sgt6xg"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Download=createLucideIcon("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Eraser=createLucideIcon("Eraser",[["path",{d:"m7 21-4.3-4.3c-1-1-1-2.5 0-3.4l9.6-9.6c1-1 2.5-1 3.4 0l5.6 5.6c1 1 1 2.5 0 3.4L13 21",key:"182aya"}],["path",{d:"M22 21H7",key:"t4ddhn"}],["path",{d:"m5 11 9 9",key:"1mo9qw"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Expand=createLucideIcon("Expand",[["path",{d:"m21 21-6-6m6 6v-4.8m0 4.8h-4.8",key:"1c15vz"}],["path",{d:"M3 16.2V21m0 0h4.8M3 21l6-6",key:"1fsnz2"}],["path",{d:"M21 7.8V3m0 0h-4.8M21 3l-6 6",key:"hawz9i"}],["path",{d:"M3 7.8V3m0 0h4.8M3 3l6 6",key:"u9ee12"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Eye=createLucideIcon("Eye",[["path",{d:"M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7Z",key:"rwhkz3"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Image$1=createLucideIcon("Image",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Keyboard=createLucideIcon("Keyboard",[["path",{d:"M10 8h.01",key:"1r9ogq"}],["path",{d:"M12 12h.01",key:"1mp3jc"}],["path",{d:"M14 8h.01",key:"1primd"}],["path",{d:"M16 12h.01",key:"1l6xoz"}],["path",{d:"M18 8h.01",key:"emo2bl"}],["path",{d:"M6 8h.01",key:"x9i8wu"}],["path",{d:"M7 16h10",key:"wp8him"}],["path",{d:"M8 12h.01",key:"czm47f"}],["rect",{width:"20",height:"16",x:"2",y:"4",rx:"2",key:"18n3k1"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Redo=createLucideIcon("Redo",[["path",{d:"M21 7v6h-6",key:"3ptur4"}],["path",{d:"M3 17a9 9 0 0 1 9-9 9 9 0 0 1 6 2.3l3 2.7",key:"1kgawr"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Search=createLucideIcon("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Settings=createLucideIcon("Settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Undo=createLucideIcon("Undo",[["path",{d:"M3 7v6h6",key:"1v2h90"}],["path",{d:"M21 17a9 9 0 0 0-9-9 9 9 0 0 0-6 2.3L3 13",key:"1r6uu6"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Upload=createLucideIcon("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]]);var define_import_meta_env_default$1={VITE_BACKEND:"https://api.runpod.ai/v2/sa6txt6v9ok382/runsync",VITE_RUNPOD:"J9AEA4HA0M792XF35GRC8FHVHWQAH2LU3LZB635Q",BASE_URL:"/images-project",MODE:"production",DEV:!1,PROD:!0,SSR:!1};function createJSONStorage(d,g){let b;try{b=d()}catch{return}return{getItem:st=>{var at;const vt=Ct=>Ct===null?null:JSON.parse(Ct,void 0),Tt=(at=b.getItem(st))!=null?at:null;return Tt instanceof Promise?Tt.then(vt):vt(Tt)},setItem:(st,at)=>b.setItem(st,JSON.stringify(at,void 0)),removeItem:st=>b.removeItem(st)}}const toThenable=d=>g=>{try{const b=d(g);return b instanceof Promise?b:{then(et){return toThenable(et)(b)},catch(et){return this}}}catch(b){return{then(et){return this},catch(et){return toThenable(et)(b)}}}},oldImpl=(d,g)=>(b,et,st)=>{let at={getStorage:()=>localStorage,serialize:JSON.stringify,deserialize:JSON.parse,partialize:Ht=>Ht,version:0,merge:(Ht,qt)=>({...qt,...Ht}),...g},vt=!1;const Tt=new Set,Ct=new Set;let pt;try{pt=at.getStorage()}catch{}if(!pt)return d((...Ht)=>{console.warn(`[zustand persist middleware] Unable to update item '${at.name}', the given storage is currently unavailable.`),b(...Ht)},et,st);const wt=toThenable(at.serialize),$t=()=>{const Ht=at.partialize({...et()});let qt;const Kt=wt({state:Ht,version:at.version}).then(rr=>pt.setItem(at.name,rr)).catch(rr=>{qt=rr});if(qt)throw qt;return Kt},Lt=st.setState;st.setState=(Ht,qt)=>{Lt(Ht,qt),$t()};const jt=d((...Ht)=>{b(...Ht),$t()},et,st);let Ft;const Gt=()=>{var Ht;if(!pt)return;vt=!1,Tt.forEach(Kt=>Kt(et()));const qt=((Ht=at.onRehydrateStorage)==null?void 0:Ht.call(at,et()))||void 0;return toThenable(pt.getItem.bind(pt))(at.name).then(Kt=>{if(Kt)return at.deserialize(Kt)}).then(Kt=>{if(Kt)if(typeof Kt.version=="number"&&Kt.version!==at.version){if(at.migrate)return at.migrate(Kt.state,Kt.version);console.error("State loaded from storage couldn't be migrated since no migrate function was provided")}else return Kt.state}).then(Kt=>{var rr;return Ft=at.merge(Kt,(rr=et())!=null?rr:jt),b(Ft,!0),$t()}).then(()=>{qt==null||qt(Ft,void 0),vt=!0,Ct.forEach(Kt=>Kt(Ft))}).catch(Kt=>{qt==null||qt(void 0,Kt)})};return st.persist={setOptions:Ht=>{at={...at,...Ht},Ht.getStorage&&(pt=Ht.getStorage())},clearStorage:()=>{pt==null||pt.removeItem(at.name)},getOptions:()=>at,rehydrate:()=>Gt(),hasHydrated:()=>vt,onHydrate:Ht=>(Tt.add(Ht),()=>{Tt.delete(Ht)}),onFinishHydration:Ht=>(Ct.add(Ht),()=>{Ct.delete(Ht)})},Gt(),Ft||jt},newImpl=(d,g)=>(b,et,st)=>{let at={storage:createJSONStorage(()=>localStorage),partialize:Gt=>Gt,version:0,merge:(Gt,Ht)=>({...Ht,...Gt}),...g},vt=!1;const Tt=new Set,Ct=new Set;let pt=at.storage;if(!pt)return d((...Gt)=>{console.warn(`[zustand persist middleware] Unable to update item '${at.name}', the given storage is currently unavailable.`),b(...Gt)},et,st);const wt=()=>{const Gt=at.partialize({...et()});return pt.setItem(at.name,{state:Gt,version:at.version})},$t=st.setState;st.setState=(Gt,Ht)=>{$t(Gt,Ht),wt()};const Lt=d((...Gt)=>{b(...Gt),wt()},et,st);st.getInitialState=()=>Lt;let jt;const Ft=()=>{var Gt,Ht;if(!pt)return;vt=!1,Tt.forEach(Kt=>{var rr;return Kt((rr=et())!=null?rr:Lt)});const qt=((Ht=at.onRehydrateStorage)==null?void 0:Ht.call(at,(Gt=et())!=null?Gt:Lt))||void 0;return toThenable(pt.getItem.bind(pt))(at.name).then(Kt=>{if(Kt)if(typeof Kt.version=="number"&&Kt.version!==at.version){if(at.migrate)return at.migrate(Kt.state,Kt.version);console.error("State loaded from storage couldn't be migrated since no migrate function was provided")}else return Kt.state}).then(Kt=>{var rr;return jt=at.merge(Kt,(rr=et())!=null?rr:Lt),b(jt,!0),wt()}).then(()=>{qt==null||qt(jt,void 0),jt=et(),vt=!0,Ct.forEach(Kt=>Kt(jt))}).catch(Kt=>{qt==null||qt(void 0,Kt)})};return st.persist={setOptions:Gt=>{at={...at,...Gt},Gt.storage&&(pt=Gt.storage)},clearStorage:()=>{pt==null||pt.removeItem(at.name)},getOptions:()=>at,rehydrate:()=>Ft(),hasHydrated:()=>vt,onHydrate:Gt=>(Tt.add(Gt),()=>{Tt.delete(Gt)}),onFinishHydration:Gt=>(Ct.add(Gt),()=>{Ct.delete(Gt)})},at.skipHydration||Ft(),jt||Lt},persistImpl=(d,g)=>"getStorage"in g||"serialize"in g||"deserialize"in g?((define_import_meta_env_default$1?"production":void 0)!=="production"&&console.warn("[DEPRECATED] `getStorage`, `serialize` and `deserialize` options are deprecated. Use `storage` option instead."),oldImpl(d,g)):newImpl(d,g),persist=persistImpl;function shallow$1(d,g){if(Object.is(d,g))return!0;if(typeof d!="object"||d===null||typeof g!="object"||g===null)return!1;if(d instanceof Map&&g instanceof Map){if(d.size!==g.size)return!1;for(const[et,st]of d)if(!Object.is(st,g.get(et)))return!1;return!0}if(d instanceof Set&&g instanceof Set){if(d.size!==g.size)return!1;for(const et of d)if(!g.has(et))return!1;return!0}const b=Object.keys(d);if(b.length!==Object.keys(g).length)return!1;for(const et of b)if(!Object.prototype.hasOwnProperty.call(g,et)||!Object.is(d[et],g[et]))return!1;return!0}var NOTHING=Symbol.for("immer-nothing"),DRAFTABLE=Symbol.for("immer-draftable"),DRAFT_STATE=Symbol.for("immer-state");function die(d,...g){throw new Error(`[Immer] minified error nr: ${d}. Full error at: https://bit.ly/3cXEKWf`)}var getPrototypeOf$1=Object.getPrototypeOf;function isDraft(d){return!!d&&!!d[DRAFT_STATE]}function isDraftable(d){var g;return d?isPlainObject$2(d)||Array.isArray(d)||!!d[DRAFTABLE]||!!((g=d.constructor)!=null&&g[DRAFTABLE])||isMap(d)||isSet(d):!1}var objectCtorString=Object.prototype.constructor.toString();function isPlainObject$2(d){if(!d||typeof d!="object")return!1;const g=getPrototypeOf$1(d);if(g===null)return!0;const b=Object.hasOwnProperty.call(g,"constructor")&&g.constructor;return b===Object?!0:typeof b=="function"&&Function.toString.call(b)===objectCtorString}function each(d,g){getArchtype(d)===0?Reflect.ownKeys(d).forEach(b=>{g(b,d[b],d)}):d.forEach((b,et)=>g(et,b,d))}function getArchtype(d){const g=d[DRAFT_STATE];return g?g.type_:Array.isArray(d)?1:isMap(d)?2:isSet(d)?3:0}function has(d,g){return getArchtype(d)===2?d.has(g):Object.prototype.hasOwnProperty.call(d,g)}function set$1(d,g,b){const et=getArchtype(d);et===2?d.set(g,b):et===3?d.add(b):d[g]=b}function is$2(d,g){return d===g?d!==0||1/d===1/g:d!==d&&g!==g}function isMap(d){return d instanceof Map}function isSet(d){return d instanceof Set}function latest(d){return d.copy_||d.base_}function shallowCopy(d,g){if(isMap(d))return new Map(d);if(isSet(d))return new Set(d);if(Array.isArray(d))return Array.prototype.slice.call(d);const b=isPlainObject$2(d);if(g===!0||g==="class_only"&&!b){const et=Object.getOwnPropertyDescriptors(d);delete et[DRAFT_STATE];let st=Reflect.ownKeys(et);for(let at=0;at<st.length;at++){const vt=st[at],Tt=et[vt];Tt.writable===!1&&(Tt.writable=!0,Tt.configurable=!0),(Tt.get||Tt.set)&&(et[vt]={configurable:!0,writable:!0,enumerable:Tt.enumerable,value:d[vt]})}return Object.create(getPrototypeOf$1(d),et)}else{const et=getPrototypeOf$1(d);if(et!==null&&b)return{...d};const st=Object.create(et);return Object.assign(st,d)}}function freeze(d,g=!1){return isFrozen(d)||isDraft(d)||!isDraftable(d)||(getArchtype(d)>1&&(d.set=d.add=d.clear=d.delete=dontMutateFrozenCollections),Object.freeze(d),g&&Object.entries(d).forEach(([b,et])=>freeze(et,!0))),d}function dontMutateFrozenCollections(){die(2)}function isFrozen(d){return Object.isFrozen(d)}var plugins={};function getPlugin(d){const g=plugins[d];return g||die(0,d),g}var currentScope;function getCurrentScope(){return currentScope}function createScope(d,g){return{drafts_:[],parent_:d,immer_:g,canAutoFreeze_:!0,unfinalizedDrafts_:0}}function usePatchesInScope(d,g){g&&(getPlugin("Patches"),d.patches_=[],d.inversePatches_=[],d.patchListener_=g)}function revokeScope(d){leaveScope(d),d.drafts_.forEach(revokeDraft),d.drafts_=null}function leaveScope(d){d===currentScope&&(currentScope=d.parent_)}function enterScope(d){return currentScope=createScope(currentScope,d)}function revokeDraft(d){const g=d[DRAFT_STATE];g.type_===0||g.type_===1?g.revoke_():g.revoked_=!0}function processResult(d,g){g.unfinalizedDrafts_=g.drafts_.length;const b=g.drafts_[0];return d!==void 0&&d!==b?(b[DRAFT_STATE].modified_&&(revokeScope(g),die(4)),isDraftable(d)&&(d=finalize(g,d),g.parent_||maybeFreeze(g,d)),g.patches_&&getPlugin("Patches").generateReplacementPatches_(b[DRAFT_STATE].base_,d,g.patches_,g.inversePatches_)):d=finalize(g,b,[]),revokeScope(g),g.patches_&&g.patchListener_(g.patches_,g.inversePatches_),d!==NOTHING?d:void 0}function finalize(d,g,b){if(isFrozen(g))return g;const et=g[DRAFT_STATE];if(!et)return each(g,(st,at)=>finalizeProperty(d,et,g,st,at,b)),g;if(et.scope_!==d)return g;if(!et.modified_)return maybeFreeze(d,et.base_,!0),et.base_;if(!et.finalized_){et.finalized_=!0,et.scope_.unfinalizedDrafts_--;const st=et.copy_;let at=st,vt=!1;et.type_===3&&(at=new Set(st),st.clear(),vt=!0),each(at,(Tt,Ct)=>finalizeProperty(d,et,st,Tt,Ct,b,vt)),maybeFreeze(d,st,!1),b&&d.patches_&&getPlugin("Patches").generatePatches_(et,b,d.patches_,d.inversePatches_)}return et.copy_}function finalizeProperty(d,g,b,et,st,at,vt){if(isDraft(st)){const Tt=at&&g&&g.type_!==3&&!has(g.assigned_,et)?at.concat(et):void 0,Ct=finalize(d,st,Tt);if(set$1(b,et,Ct),isDraft(Ct))d.canAutoFreeze_=!1;else return}else vt&&b.add(st);if(isDraftable(st)&&!isFrozen(st)){if(!d.immer_.autoFreeze_&&d.unfinalizedDrafts_<1)return;finalize(d,st),(!g||!g.scope_.parent_)&&typeof et!="symbol"&&Object.prototype.propertyIsEnumerable.call(b,et)&&maybeFreeze(d,st)}}function maybeFreeze(d,g,b=!1){!d.parent_&&d.immer_.autoFreeze_&&d.canAutoFreeze_&&freeze(g,b)}function createProxyProxy(d,g){const b=Array.isArray(d),et={type_:b?1:0,scope_:g?g.scope_:getCurrentScope(),modified_:!1,finalized_:!1,assigned_:{},parent_:g,base_:d,draft_:null,copy_:null,revoke_:null,isManual_:!1};let st=et,at=objectTraps;b&&(st=[et],at=arrayTraps);const{revoke:vt,proxy:Tt}=Proxy.revocable(st,at);return et.draft_=Tt,et.revoke_=vt,Tt}var objectTraps={get(d,g){if(g===DRAFT_STATE)return d;const b=latest(d);if(!has(b,g))return readPropFromProto(d,b,g);const et=b[g];return d.finalized_||!isDraftable(et)?et:et===peek(d.base_,g)?(prepareCopy(d),d.copy_[g]=createProxy(et,d)):et},has(d,g){return g in latest(d)},ownKeys(d){return Reflect.ownKeys(latest(d))},set(d,g,b){const et=getDescriptorFromProto(latest(d),g);if(et!=null&&et.set)return et.set.call(d.draft_,b),!0;if(!d.modified_){const st=peek(latest(d),g),at=st==null?void 0:st[DRAFT_STATE];if(at&&at.base_===b)return d.copy_[g]=b,d.assigned_[g]=!1,!0;if(is$2(b,st)&&(b!==void 0||has(d.base_,g)))return!0;prepareCopy(d),markChanged(d)}return d.copy_[g]===b&&(b!==void 0||g in d.copy_)||Number.isNaN(b)&&Number.isNaN(d.copy_[g])||(d.copy_[g]=b,d.assigned_[g]=!0),!0},deleteProperty(d,g){return peek(d.base_,g)!==void 0||g in d.base_?(d.assigned_[g]=!1,prepareCopy(d),markChanged(d)):delete d.assigned_[g],d.copy_&&delete d.copy_[g],!0},getOwnPropertyDescriptor(d,g){const b=latest(d),et=Reflect.getOwnPropertyDescriptor(b,g);return et&&{writable:!0,configurable:d.type_!==1||g!=="length",enumerable:et.enumerable,value:b[g]}},defineProperty(){die(11)},getPrototypeOf(d){return getPrototypeOf$1(d.base_)},setPrototypeOf(){die(12)}},arrayTraps={};each(objectTraps,(d,g)=>{arrayTraps[d]=function(){return arguments[0]=arguments[0][0],g.apply(this,arguments)}});arrayTraps.deleteProperty=function(d,g){return arrayTraps.set.call(this,d,g,void 0)};arrayTraps.set=function(d,g,b){return objectTraps.set.call(this,d[0],g,b,d[0])};function peek(d,g){const b=d[DRAFT_STATE];return(b?latest(b):d)[g]}function readPropFromProto(d,g,b){var st;const et=getDescriptorFromProto(g,b);return et?"value"in et?et.value:(st=et.get)==null?void 0:st.call(d.draft_):void 0}function getDescriptorFromProto(d,g){if(!(g in d))return;let b=getPrototypeOf$1(d);for(;b;){const et=Object.getOwnPropertyDescriptor(b,g);if(et)return et;b=getPrototypeOf$1(b)}}function markChanged(d){d.modified_||(d.modified_=!0,d.parent_&&markChanged(d.parent_))}function prepareCopy(d){d.copy_||(d.copy_=shallowCopy(d.base_,d.scope_.immer_.useStrictShallowCopy_))}var Immer2=class{constructor(d){this.autoFreeze_=!0,this.useStrictShallowCopy_=!1,this.produce=(g,b,et)=>{if(typeof g=="function"&&typeof b!="function"){const at=b;b=g;const vt=this;return function(Ct=at,...pt){return vt.produce(Ct,wt=>b.call(this,wt,...pt))}}typeof b!="function"&&die(6),et!==void 0&&typeof et!="function"&&die(7);let st;if(isDraftable(g)){const at=enterScope(this),vt=createProxy(g,void 0);let Tt=!0;try{st=b(vt),Tt=!1}finally{Tt?revokeScope(at):leaveScope(at)}return usePatchesInScope(at,et),processResult(st,at)}else if(!g||typeof g!="object"){if(st=b(g),st===void 0&&(st=g),st===NOTHING&&(st=void 0),this.autoFreeze_&&freeze(st,!0),et){const at=[],vt=[];getPlugin("Patches").generateReplacementPatches_(g,st,at,vt),et(at,vt)}return st}else die(1,g)},this.produceWithPatches=(g,b)=>{if(typeof g=="function")return(vt,...Tt)=>this.produceWithPatches(vt,Ct=>g(Ct,...Tt));let et,st;return[this.produce(g,b,(vt,Tt)=>{et=vt,st=Tt}),et,st]},typeof(d==null?void 0:d.autoFreeze)=="boolean"&&this.setAutoFreeze(d.autoFreeze),typeof(d==null?void 0:d.useStrictShallowCopy)=="boolean"&&this.setUseStrictShallowCopy(d.useStrictShallowCopy)}createDraft(d){isDraftable(d)||die(8),isDraft(d)&&(d=current(d));const g=enterScope(this),b=createProxy(d,void 0);return b[DRAFT_STATE].isManual_=!0,leaveScope(g),b}finishDraft(d,g){const b=d&&d[DRAFT_STATE];(!b||!b.isManual_)&&die(9);const{scope_:et}=b;return usePatchesInScope(et,g),processResult(void 0,et)}setAutoFreeze(d){this.autoFreeze_=d}setUseStrictShallowCopy(d){this.useStrictShallowCopy_=d}applyPatches(d,g){let b;for(b=g.length-1;b>=0;b--){const st=g[b];if(st.path.length===0&&st.op==="replace"){d=st.value;break}}b>-1&&(g=g.slice(b+1));const et=getPlugin("Patches").applyPatches_;return isDraft(d)?et(d,g):this.produce(d,st=>et(st,g))}};function createProxy(d,g){const b=isMap(d)?getPlugin("MapSet").proxyMap_(d,g):isSet(d)?getPlugin("MapSet").proxySet_(d,g):createProxyProxy(d,g);return(g?g.scope_:getCurrentScope()).drafts_.push(b),b}function current(d){return isDraft(d)||die(10,d),currentImpl(d)}function currentImpl(d){if(!isDraftable(d)||isFrozen(d))return d;const g=d[DRAFT_STATE];let b;if(g){if(!g.modified_)return g.base_;g.finalized_=!0,b=shallowCopy(d,g.scope_.immer_.useStrictShallowCopy_)}else b=shallowCopy(d,!0);return each(b,(et,st)=>{set$1(b,et,currentImpl(st))}),g&&(g.finalized_=!1),b}var immer$1=new Immer2,produce=immer$1.produce;immer$1.produceWithPatches.bind(immer$1);immer$1.setAutoFreeze.bind(immer$1);immer$1.setUseStrictShallowCopy.bind(immer$1);immer$1.applyPatches.bind(immer$1);immer$1.createDraft.bind(immer$1);immer$1.finishDraft.bind(immer$1);function castDraft(d){return d}const immerImpl=d=>(g,b,et)=>(et.setState=(st,at,...vt)=>{const Tt=typeof st=="function"?produce(st):st;return g(Tt,at,...vt)},d(et.setState,b,et)),immer=immerImpl;var withSelector={exports:{}},withSelector_production_min={},shim={exports:{}},useSyncExternalStoreShim_production_min={};/**
 * @license React
 * use-sync-external-store-shim.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var e$1=reactExports;function h$1(d,g){return d===g&&(d!==0||1/d===1/g)||d!==d&&g!==g}var k$2=typeof Object.is=="function"?Object.is:h$1,l$1=e$1.useState,m$1=e$1.useEffect,n$3=e$1.useLayoutEffect,p$2=e$1.useDebugValue;function q$1(d,g){var b=g(),et=l$1({inst:{value:b,getSnapshot:g}}),st=et[0].inst,at=et[1];return n$3(function(){st.value=b,st.getSnapshot=g,r$2(st)&&at({inst:st})},[d,b,g]),m$1(function(){return r$2(st)&&at({inst:st}),d(function(){r$2(st)&&at({inst:st})})},[d]),p$2(b),b}function r$2(d){var g=d.getSnapshot;d=d.value;try{var b=g();return!k$2(d,b)}catch{return!0}}function t$4(d,g){return g()}var u$2=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?t$4:q$1;useSyncExternalStoreShim_production_min.useSyncExternalStore=e$1.useSyncExternalStore!==void 0?e$1.useSyncExternalStore:u$2;shim.exports=useSyncExternalStoreShim_production_min;var shimExports=shim.exports;/**
 * @license React
 * use-sync-external-store-shim/with-selector.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var h=reactExports,n$2=shimExports;function p$1(d,g){return d===g&&(d!==0||1/d===1/g)||d!==d&&g!==g}var q=typeof Object.is=="function"?Object.is:p$1,r$1=n$2.useSyncExternalStore,t$3=h.useRef,u$1=h.useEffect,v=h.useMemo,w=h.useDebugValue;withSelector_production_min.useSyncExternalStoreWithSelector=function(d,g,b,et,st){var at=t$3(null);if(at.current===null){var vt={hasValue:!1,value:null};at.current=vt}else vt=at.current;at=v(function(){function Ct(jt){if(!pt){if(pt=!0,wt=jt,jt=et(jt),st!==void 0&&vt.hasValue){var Ft=vt.value;if(st(Ft,jt))return $t=Ft}return $t=jt}if(Ft=$t,q(wt,jt))return Ft;var Gt=et(jt);return st!==void 0&&st(Ft,Gt)?Ft:(wt=jt,$t=Gt)}var pt=!1,wt,$t,Lt=b===void 0?null:b;return[function(){return Ct(g())},Lt===null?void 0:function(){return Ct(Lt())}]},[g,b,et,st]);var Tt=r$1(d,at[0],at[1]);return u$1(function(){vt.hasValue=!0,vt.value=Tt},[Tt]),w(Tt),Tt};withSelector.exports=withSelector_production_min;var withSelectorExports=withSelector.exports;const useSyncExternalStoreExports=getDefaultExportFromCjs(withSelectorExports);var define_import_meta_env_default={VITE_BACKEND:"https://api.runpod.ai/v2/sa6txt6v9ok382/runsync",VITE_RUNPOD:"J9AEA4HA0M792XF35GRC8FHVHWQAH2LU3LZB635Q",BASE_URL:"/images-project",MODE:"production",DEV:!1,PROD:!0,SSR:!1};const createStoreImpl=d=>{let g;const b=new Set,et=(wt,$t)=>{const Lt=typeof wt=="function"?wt(g):wt;if(!Object.is(Lt,g)){const jt=g;g=$t??(typeof Lt!="object"||Lt===null)?Lt:Object.assign({},g,Lt),b.forEach(Ft=>Ft(g,jt))}},st=()=>g,Ct={setState:et,getState:st,getInitialState:()=>pt,subscribe:wt=>(b.add(wt),()=>b.delete(wt)),destroy:()=>{(define_import_meta_env_default?"production":void 0)!=="production"&&console.warn("[DEPRECATED] The `destroy` method will be unsupported in a future version. Instead use unsubscribe function returned by subscribe. Everything will be garbage-collected if store is garbage-collected."),b.clear()}},pt=g=d(et,st,Ct);return Ct},createStore=d=>d?createStoreImpl(d):createStoreImpl,{useDebugValue}=React,{useSyncExternalStoreWithSelector}=useSyncExternalStoreExports,identity=d=>d;function useStoreWithEqualityFn(d,g=identity,b){const et=useSyncExternalStoreWithSelector(d.subscribe,d.getState,d.getServerState||d.getInitialState,g,b);return useDebugValue(et),et}const createWithEqualityFnImpl=(d,g)=>{const b=createStore(d),et=(st,at=g)=>useStoreWithEqualityFn(b,st,at);return Object.assign(et,b),et},createWithEqualityFn=(d,g)=>d?createWithEqualityFnImpl(d,g):createWithEqualityFnImpl;var PluginName=(d=>(d.RemoveBG="RemoveBG",d.AnimeSeg="AnimeSeg",d.RealESRGAN="RealESRGAN",d.GFPGAN="GFPGAN",d.RestoreFormer="RestoreFormer",d.InteractiveSeg="InteractiveSeg",d))(PluginName||{}),SortBy=(d=>(d.NAME="name",d.CTIME="ctime",d.MTIME="mtime",d))(SortBy||{}),SortOrder=(d=>(d.DESCENDING="desc",d.ASCENDING="asc",d))(SortOrder||{}),LDMSampler=(d=>(d.ddim="ddim",d.plms="plms",d))(LDMSampler||{}),CV2Flag=(d=>(d.INPAINT_NS="INPAINT_NS",d.INPAINT_TELEA="INPAINT_TELEA",d))(CV2Flag||{}),ExtenderDirection=(d=>(d.x="x",d.y="y",d.xy="xy",d))(ExtenderDirection||{}),PowerPaintTask=(d=>(d.text_guided="text-guided",d.shape_guided="shape-guided",d.object_remove="object-remove",d.outpainting="outpainting",d))(PowerPaintTask||{});const paintByExampleConfig={plugins:[{name:"RemoveBG",support_gen_image:!0,support_gen_mask:!0}],modelInfos:[{name:"lama",path:"lama",model_type:"inpaint",is_single_file_diffusers:!1,need_prompt:!1,controlnets:[],support_strength:!1,support_outpainting:!1,support_lcm_lora:!1,support_controlnet:!1,support_freeu:!1},{name:"cv2",path:"cv2",model_type:"inpaint",is_single_file_diffusers:!1,need_prompt:!1,controlnets:[],support_strength:!1,support_outpainting:!1,support_lcm_lora:!1,support_controlnet:!1,support_freeu:!1},{name:"runwayml/stable-diffusion-v1-5",path:"runwayml/stable-diffusion-v1-5",model_type:"diffusers_sd",is_single_file_diffusers:!1,need_prompt:!0,controlnets:["lllyasviel/control_v11p_sd15_canny","lllyasviel/control_v11p_sd15_openpose","lllyasviel/control_v11p_sd15_inpaint","lllyasviel/control_v11f1p_sd15_depth"],support_strength:!0,support_outpainting:!0,support_lcm_lora:!0,support_controlnet:!0,support_freeu:!0},{name:"Sanster/PowerPaint-V1-stable-diffusion-inpainting",path:"Sanster/PowerPaint-V1-stable-diffusion-inpainting",model_type:"diffusers_other",is_single_file_diffusers:!1,need_prompt:!0,controlnets:["lllyasviel/control_v11p_sd15_canny","lllyasviel/control_v11p_sd15_openpose","lllyasviel/control_v11p_sd15_inpaint","lllyasviel/control_v11f1p_sd15_depth"],support_strength:!0,support_outpainting:!0,support_lcm_lora:!1,support_controlnet:!1,support_freeu:!1},{name:"redstonehero/ReV_Animated_Inpainting",path:"redstonehero/ReV_Animated_Inpainting",model_type:"diffusers_sd",is_single_file_diffusers:!1,need_prompt:!0,controlnets:["lllyasviel/control_v11p_sd15_canny","lllyasviel/control_v11p_sd15_openpose","lllyasviel/control_v11p_sd15_inpaint","lllyasviel/control_v11f1p_sd15_depth"],support_strength:!0,support_outpainting:!0,support_lcm_lora:!0,support_controlnet:!0,support_freeu:!0},{name:"Fantasy-Studio/Paint-by-Example",path:"Fantasy-Studio/Paint-by-Example",model_type:"diffusers_other",is_single_file_diffusers:!1,need_prompt:!1,controlnets:[],support_strength:!1,support_outpainting:!1,support_lcm_lora:!1,support_controlnet:!1,support_freeu:!1}],removeBGModel:"briaai/RMBG-1.4",removeBGModels:["u2net","u2netp","u2net_human_seg","u2net_cloth_seg","silueta","isnet-general-use","briaai/RMBG-1.4"],realesrganModel:"realesr-general-x4v3",realesrganModels:["realesr-general-x4v3","RealESRGAN_x4plus","RealESRGAN_x4plus_anime_6B"],interactiveSegModel:"vit_b",interactiveSegModels:["vit_b","vit_l","vit_h","sam_hq_vit_b","sam_hq_vit_l","sam_hq_vit_h","mobile_sam"],enableFileManager:!1,enableAutoSaving:!1,enableControlnet:!1,controlnetMethod:"",disableModelSwitch:!1,isDesktop:!1,samplers:["DPM++ 2M","DPM++ 2M Karras","DPM++ 2M SDE","DPM++ 2M SDE Karras","DPM++ SDE","DPM++ SDE Karras","DPM2","DPM2 Karras","DPM2 a","DPM2 a Karras","Euler","Euler a","Heun","LMS","LMS Karras","DDIM","PNDM","UniPC","LCM"]};function bind(d,g){return function(){return d.apply(g,arguments)}}const{toString}=Object.prototype,{getPrototypeOf}=Object,kindOf=(d=>g=>{const b=toString.call(g);return d[b]||(d[b]=b.slice(8,-1).toLowerCase())})(Object.create(null)),kindOfTest=d=>(d=d.toLowerCase(),g=>kindOf(g)===d),typeOfTest=d=>g=>typeof g===d,{isArray}=Array,isUndefined$1=typeOfTest("undefined");function isBuffer$2(d){return d!==null&&!isUndefined$1(d)&&d.constructor!==null&&!isUndefined$1(d.constructor)&&isFunction$1(d.constructor.isBuffer)&&d.constructor.isBuffer(d)}const isArrayBuffer=kindOfTest("ArrayBuffer");function isArrayBufferView(d){let g;return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?g=ArrayBuffer.isView(d):g=d&&d.buffer&&isArrayBuffer(d.buffer),g}const isString$1=typeOfTest("string"),isFunction$1=typeOfTest("function"),isNumber=typeOfTest("number"),isObject$1=d=>d!==null&&typeof d=="object",isBoolean$1=d=>d===!0||d===!1,isPlainObject$1=d=>{if(kindOf(d)!=="object")return!1;const g=getPrototypeOf(d);return(g===null||g===Object.prototype||Object.getPrototypeOf(g)===null)&&!(Symbol.toStringTag in d)&&!(Symbol.iterator in d)},isDate=kindOfTest("Date"),isFile=kindOfTest("File"),isBlob=kindOfTest("Blob"),isFileList=kindOfTest("FileList"),isStream=d=>isObject$1(d)&&isFunction$1(d.pipe),isFormData=d=>{let g;return d&&(typeof FormData=="function"&&d instanceof FormData||isFunction$1(d.append)&&((g=kindOf(d))==="formdata"||g==="object"&&isFunction$1(d.toString)&&d.toString()==="[object FormData]"))},isURLSearchParams=kindOfTest("URLSearchParams"),trim=d=>d.trim?d.trim():d.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"");function forEach$1(d,g,{allOwnKeys:b=!1}={}){if(d===null||typeof d>"u")return;let et,st;if(typeof d!="object"&&(d=[d]),isArray(d))for(et=0,st=d.length;et<st;et++)g.call(null,d[et],et,d);else{const at=b?Object.getOwnPropertyNames(d):Object.keys(d),vt=at.length;let Tt;for(et=0;et<vt;et++)Tt=at[et],g.call(null,d[Tt],Tt,d)}}function findKey(d,g){g=g.toLowerCase();const b=Object.keys(d);let et=b.length,st;for(;et-- >0;)if(st=b[et],g===st.toLowerCase())return st;return null}const _global=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:global,isContextDefined=d=>!isUndefined$1(d)&&d!==_global;function merge(){const{caseless:d}=isContextDefined(this)&&this||{},g={},b=(et,st)=>{const at=d&&findKey(g,st)||st;isPlainObject$1(g[at])&&isPlainObject$1(et)?g[at]=merge(g[at],et):isPlainObject$1(et)?g[at]=merge({},et):isArray(et)?g[at]=et.slice():g[at]=et};for(let et=0,st=arguments.length;et<st;et++)arguments[et]&&forEach$1(arguments[et],b);return g}const extend=(d,g,b,{allOwnKeys:et}={})=>(forEach$1(g,(st,at)=>{b&&isFunction$1(st)?d[at]=bind(st,b):d[at]=st},{allOwnKeys:et}),d),stripBOM=d=>(d.charCodeAt(0)===65279&&(d=d.slice(1)),d),inherits=(d,g,b,et)=>{d.prototype=Object.create(g.prototype,et),d.prototype.constructor=d,Object.defineProperty(d,"super",{value:g.prototype}),b&&Object.assign(d.prototype,b)},toFlatObject=(d,g,b,et)=>{let st,at,vt;const Tt={};if(g=g||{},d==null)return g;do{for(st=Object.getOwnPropertyNames(d),at=st.length;at-- >0;)vt=st[at],(!et||et(vt,d,g))&&!Tt[vt]&&(g[vt]=d[vt],Tt[vt]=!0);d=b!==!1&&getPrototypeOf(d)}while(d&&(!b||b(d,g))&&d!==Object.prototype);return g},endsWith=(d,g,b)=>{d=String(d),(b===void 0||b>d.length)&&(b=d.length),b-=g.length;const et=d.indexOf(g,b);return et!==-1&&et===b},toArray=d=>{if(!d)return null;if(isArray(d))return d;let g=d.length;if(!isNumber(g))return null;const b=new Array(g);for(;g-- >0;)b[g]=d[g];return b},isTypedArray=(d=>g=>d&&g instanceof d)(typeof Uint8Array<"u"&&getPrototypeOf(Uint8Array)),forEachEntry=(d,g)=>{const et=(d&&d[Symbol.iterator]).call(d);let st;for(;(st=et.next())&&!st.done;){const at=st.value;g.call(d,at[0],at[1])}},matchAll=(d,g)=>{let b;const et=[];for(;(b=d.exec(g))!==null;)et.push(b);return et},isHTMLForm=kindOfTest("HTMLFormElement"),toCamelCase=d=>d.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,function(b,et,st){return et.toUpperCase()+st}),hasOwnProperty=(({hasOwnProperty:d})=>(g,b)=>d.call(g,b))(Object.prototype),isRegExp=kindOfTest("RegExp"),reduceDescriptors=(d,g)=>{const b=Object.getOwnPropertyDescriptors(d),et={};forEach$1(b,(st,at)=>{let vt;(vt=g(st,at,d))!==!1&&(et[at]=vt||st)}),Object.defineProperties(d,et)},freezeMethods=d=>{reduceDescriptors(d,(g,b)=>{if(isFunction$1(d)&&["arguments","caller","callee"].indexOf(b)!==-1)return!1;const et=d[b];if(isFunction$1(et)){if(g.enumerable=!1,"writable"in g){g.writable=!1;return}g.set||(g.set=()=>{throw Error("Can not rewrite read-only method '"+b+"'")})}})},toObjectSet=(d,g)=>{const b={},et=st=>{st.forEach(at=>{b[at]=!0})};return isArray(d)?et(d):et(String(d).split(g)),b},noop$2=()=>{},toFiniteNumber=(d,g)=>(d=+d,Number.isFinite(d)?d:g),ALPHA="abcdefghijklmnopqrstuvwxyz",DIGIT="0123456789",ALPHABET={DIGIT,ALPHA,ALPHA_DIGIT:ALPHA+ALPHA.toUpperCase()+DIGIT},generateString=(d=16,g=ALPHABET.ALPHA_DIGIT)=>{let b="";const{length:et}=g;for(;d--;)b+=g[Math.random()*et|0];return b};function isSpecCompliantForm(d){return!!(d&&isFunction$1(d.append)&&d[Symbol.toStringTag]==="FormData"&&d[Symbol.iterator])}const toJSONObject=d=>{const g=new Array(10),b=(et,st)=>{if(isObject$1(et)){if(g.indexOf(et)>=0)return;if(!("toJSON"in et)){g[st]=et;const at=isArray(et)?[]:{};return forEach$1(et,(vt,Tt)=>{const Ct=b(vt,st+1);!isUndefined$1(Ct)&&(at[Tt]=Ct)}),g[st]=void 0,at}}return et};return b(d,0)},isAsyncFn=kindOfTest("AsyncFunction"),isThenable=d=>d&&(isObject$1(d)||isFunction$1(d))&&isFunction$1(d.then)&&isFunction$1(d.catch),utils$1={isArray,isArrayBuffer,isBuffer:isBuffer$2,isFormData,isArrayBufferView,isString:isString$1,isNumber,isBoolean:isBoolean$1,isObject:isObject$1,isPlainObject:isPlainObject$1,isUndefined:isUndefined$1,isDate,isFile,isBlob,isRegExp,isFunction:isFunction$1,isStream,isURLSearchParams,isTypedArray,isFileList,forEach:forEach$1,merge,extend,trim,stripBOM,inherits,toFlatObject,kindOf,kindOfTest,endsWith,toArray,forEachEntry,matchAll,isHTMLForm,hasOwnProperty,hasOwnProp:hasOwnProperty,reduceDescriptors,freezeMethods,toObjectSet,toCamelCase,noop:noop$2,toFiniteNumber,findKey,global:_global,isContextDefined,ALPHABET,generateString,isSpecCompliantForm,toJSONObject,isAsyncFn,isThenable};function AxiosError(d,g,b,et,st){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack,this.message=d,this.name="AxiosError",g&&(this.code=g),b&&(this.config=b),et&&(this.request=et),st&&(this.response=st)}utils$1.inherits(AxiosError,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:utils$1.toJSONObject(this.config),code:this.code,status:this.response&&this.response.status?this.response.status:null}}});const prototype$1=AxiosError.prototype,descriptors={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach(d=>{descriptors[d]={value:d}});Object.defineProperties(AxiosError,descriptors);Object.defineProperty(prototype$1,"isAxiosError",{value:!0});AxiosError.from=(d,g,b,et,st,at)=>{const vt=Object.create(prototype$1);return utils$1.toFlatObject(d,vt,function(Ct){return Ct!==Error.prototype},Tt=>Tt!=="isAxiosError"),AxiosError.call(vt,d.message,g,b,et,st),vt.cause=d,vt.name=d.name,at&&Object.assign(vt,at),vt};const httpAdapter=null;function isVisitable(d){return utils$1.isPlainObject(d)||utils$1.isArray(d)}function removeBrackets(d){return utils$1.endsWith(d,"[]")?d.slice(0,-2):d}function renderKey(d,g,b){return d?d.concat(g).map(function(st,at){return st=removeBrackets(st),!b&&at?"["+st+"]":st}).join(b?".":""):g}function isFlatArray(d){return utils$1.isArray(d)&&!d.some(isVisitable)}const predicates=utils$1.toFlatObject(utils$1,{},null,function(g){return/^is[A-Z]/.test(g)});function toFormData(d,g,b){if(!utils$1.isObject(d))throw new TypeError("target must be an object");g=g||new FormData,b=utils$1.toFlatObject(b,{metaTokens:!0,dots:!1,indexes:!1},!1,function(Gt,Ht){return!utils$1.isUndefined(Ht[Gt])});const et=b.metaTokens,st=b.visitor||wt,at=b.dots,vt=b.indexes,Ct=(b.Blob||typeof Blob<"u"&&Blob)&&utils$1.isSpecCompliantForm(g);if(!utils$1.isFunction(st))throw new TypeError("visitor must be a function");function pt(Ft){if(Ft===null)return"";if(utils$1.isDate(Ft))return Ft.toISOString();if(!Ct&&utils$1.isBlob(Ft))throw new AxiosError("Blob is not supported. Use a Buffer instead.");return utils$1.isArrayBuffer(Ft)||utils$1.isTypedArray(Ft)?Ct&&typeof Blob=="function"?new Blob([Ft]):Buffer.from(Ft):Ft}function wt(Ft,Gt,Ht){let qt=Ft;if(Ft&&!Ht&&typeof Ft=="object"){if(utils$1.endsWith(Gt,"{}"))Gt=et?Gt:Gt.slice(0,-2),Ft=JSON.stringify(Ft);else if(utils$1.isArray(Ft)&&isFlatArray(Ft)||(utils$1.isFileList(Ft)||utils$1.endsWith(Gt,"[]"))&&(qt=utils$1.toArray(Ft)))return Gt=removeBrackets(Gt),qt.forEach(function(rr,ir){!(utils$1.isUndefined(rr)||rr===null)&&g.append(vt===!0?renderKey([Gt],ir,at):vt===null?Gt:Gt+"[]",pt(rr))}),!1}return isVisitable(Ft)?!0:(g.append(renderKey(Ht,Gt,at),pt(Ft)),!1)}const $t=[],Lt=Object.assign(predicates,{defaultVisitor:wt,convertValue:pt,isVisitable});function jt(Ft,Gt){if(!utils$1.isUndefined(Ft)){if($t.indexOf(Ft)!==-1)throw Error("Circular reference detected in "+Gt.join("."));$t.push(Ft),utils$1.forEach(Ft,function(qt,Kt){(!(utils$1.isUndefined(qt)||qt===null)&&st.call(g,qt,utils$1.isString(Kt)?Kt.trim():Kt,Gt,Lt))===!0&&jt(qt,Gt?Gt.concat(Kt):[Kt])}),$t.pop()}}if(!utils$1.isObject(d))throw new TypeError("data must be an object");return jt(d),g}function encode$1(d){const g={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(d).replace(/[!'()~]|%20|%00/g,function(et){return g[et]})}function AxiosURLSearchParams(d,g){this._pairs=[],d&&toFormData(d,this,g)}const prototype=AxiosURLSearchParams.prototype;prototype.append=function(g,b){this._pairs.push([g,b])};prototype.toString=function(g){const b=g?function(et){return g.call(this,et,encode$1)}:encode$1;return this._pairs.map(function(st){return b(st[0])+"="+b(st[1])},"").join("&")};function encode(d){return encodeURIComponent(d).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}function buildURL(d,g,b){if(!g)return d;const et=b&&b.encode||encode,st=b&&b.serialize;let at;if(st?at=st(g,b):at=utils$1.isURLSearchParams(g)?g.toString():new AxiosURLSearchParams(g,b).toString(et),at){const vt=d.indexOf("#");vt!==-1&&(d=d.slice(0,vt)),d+=(d.indexOf("?")===-1?"?":"&")+at}return d}class InterceptorManager{constructor(){this.handlers=[]}use(g,b,et){return this.handlers.push({fulfilled:g,rejected:b,synchronous:et?et.synchronous:!1,runWhen:et?et.runWhen:null}),this.handlers.length-1}eject(g){this.handlers[g]&&(this.handlers[g]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(g){utils$1.forEach(this.handlers,function(et){et!==null&&g(et)})}}const transitionalDefaults={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},URLSearchParams$1=typeof URLSearchParams<"u"?URLSearchParams:AxiosURLSearchParams,FormData$1=typeof FormData<"u"?FormData:null,Blob$1=typeof Blob<"u"?Blob:null,platform$2={isBrowser:!0,classes:{URLSearchParams:URLSearchParams$1,FormData:FormData$1,Blob:Blob$1},protocols:["http","https","file","blob","url","data"]},hasBrowserEnv=typeof window<"u"&&typeof document<"u",hasStandardBrowserEnv=(d=>hasBrowserEnv&&["ReactNative","NativeScript","NS"].indexOf(d)<0)(typeof navigator<"u"&&navigator.product),hasStandardBrowserWebWorkerEnv=typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&typeof self.importScripts=="function",utils=Object.freeze(Object.defineProperty({__proto__:null,hasBrowserEnv,hasStandardBrowserEnv,hasStandardBrowserWebWorkerEnv},Symbol.toStringTag,{value:"Module"})),platform$1={...utils,...platform$2};function toURLEncodedForm(d,g){return toFormData(d,new platform$1.classes.URLSearchParams,Object.assign({visitor:function(b,et,st,at){return platform$1.isNode&&utils$1.isBuffer(b)?(this.append(et,b.toString("base64")),!1):at.defaultVisitor.apply(this,arguments)}},g))}function parsePropPath(d){return utils$1.matchAll(/\w+|\[(\w*)]/g,d).map(g=>g[0]==="[]"?"":g[1]||g[0])}function arrayToObject(d){const g={},b=Object.keys(d);let et;const st=b.length;let at;for(et=0;et<st;et++)at=b[et],g[at]=d[at];return g}function formDataToJSON(d){function g(b,et,st,at){let vt=b[at++];if(vt==="__proto__")return!0;const Tt=Number.isFinite(+vt),Ct=at>=b.length;return vt=!vt&&utils$1.isArray(st)?st.length:vt,Ct?(utils$1.hasOwnProp(st,vt)?st[vt]=[st[vt],et]:st[vt]=et,!Tt):((!st[vt]||!utils$1.isObject(st[vt]))&&(st[vt]=[]),g(b,et,st[vt],at)&&utils$1.isArray(st[vt])&&(st[vt]=arrayToObject(st[vt])),!Tt)}if(utils$1.isFormData(d)&&utils$1.isFunction(d.entries)){const b={};return utils$1.forEachEntry(d,(et,st)=>{g(parsePropPath(et),st,b,0)}),b}return null}function stringifySafely(d,g,b){if(utils$1.isString(d))try{return(g||JSON.parse)(d),utils$1.trim(d)}catch(et){if(et.name!=="SyntaxError")throw et}return(b||JSON.stringify)(d)}const defaults$1={transitional:transitionalDefaults,adapter:["xhr","http"],transformRequest:[function(g,b){const et=b.getContentType()||"",st=et.indexOf("application/json")>-1,at=utils$1.isObject(g);if(at&&utils$1.isHTMLForm(g)&&(g=new FormData(g)),utils$1.isFormData(g))return st?JSON.stringify(formDataToJSON(g)):g;if(utils$1.isArrayBuffer(g)||utils$1.isBuffer(g)||utils$1.isStream(g)||utils$1.isFile(g)||utils$1.isBlob(g))return g;if(utils$1.isArrayBufferView(g))return g.buffer;if(utils$1.isURLSearchParams(g))return b.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),g.toString();let Tt;if(at){if(et.indexOf("application/x-www-form-urlencoded")>-1)return toURLEncodedForm(g,this.formSerializer).toString();if((Tt=utils$1.isFileList(g))||et.indexOf("multipart/form-data")>-1){const Ct=this.env&&this.env.FormData;return toFormData(Tt?{"files[]":g}:g,Ct&&new Ct,this.formSerializer)}}return at||st?(b.setContentType("application/json",!1),stringifySafely(g)):g}],transformResponse:[function(g){const b=this.transitional||defaults$1.transitional,et=b&&b.forcedJSONParsing,st=this.responseType==="json";if(g&&utils$1.isString(g)&&(et&&!this.responseType||st)){const vt=!(b&&b.silentJSONParsing)&&st;try{return JSON.parse(g)}catch(Tt){if(vt)throw Tt.name==="SyntaxError"?AxiosError.from(Tt,AxiosError.ERR_BAD_RESPONSE,this,null,this.response):Tt}}return g}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:platform$1.classes.FormData,Blob:platform$1.classes.Blob},validateStatus:function(g){return g>=200&&g<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};utils$1.forEach(["delete","get","head","post","put","patch"],d=>{defaults$1.headers[d]={}});const ignoreDuplicateOf=utils$1.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),parseHeaders=d=>{const g={};let b,et,st;return d&&d.split(`
`).forEach(function(vt){st=vt.indexOf(":"),b=vt.substring(0,st).trim().toLowerCase(),et=vt.substring(st+1).trim(),!(!b||g[b]&&ignoreDuplicateOf[b])&&(b==="set-cookie"?g[b]?g[b].push(et):g[b]=[et]:g[b]=g[b]?g[b]+", "+et:et)}),g},$internals=Symbol("internals");function normalizeHeader(d){return d&&String(d).trim().toLowerCase()}function normalizeValue(d){return d===!1||d==null?d:utils$1.isArray(d)?d.map(normalizeValue):String(d)}function parseTokens(d){const g=Object.create(null),b=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let et;for(;et=b.exec(d);)g[et[1]]=et[2];return g}const isValidHeaderName=d=>/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(d.trim());function matchHeaderValue(d,g,b,et,st){if(utils$1.isFunction(et))return et.call(this,g,b);if(st&&(g=b),!!utils$1.isString(g)){if(utils$1.isString(et))return g.indexOf(et)!==-1;if(utils$1.isRegExp(et))return et.test(g)}}function formatHeader(d){return d.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,(g,b,et)=>b.toUpperCase()+et)}function buildAccessors(d,g){const b=utils$1.toCamelCase(" "+g);["get","set","has"].forEach(et=>{Object.defineProperty(d,et+b,{value:function(st,at,vt){return this[et].call(this,g,st,at,vt)},configurable:!0})})}class AxiosHeaders{constructor(g){g&&this.set(g)}set(g,b,et){const st=this;function at(Tt,Ct,pt){const wt=normalizeHeader(Ct);if(!wt)throw new Error("header name must be a non-empty string");const $t=utils$1.findKey(st,wt);(!$t||st[$t]===void 0||pt===!0||pt===void 0&&st[$t]!==!1)&&(st[$t||Ct]=normalizeValue(Tt))}const vt=(Tt,Ct)=>utils$1.forEach(Tt,(pt,wt)=>at(pt,wt,Ct));return utils$1.isPlainObject(g)||g instanceof this.constructor?vt(g,b):utils$1.isString(g)&&(g=g.trim())&&!isValidHeaderName(g)?vt(parseHeaders(g),b):g!=null&&at(b,g,et),this}get(g,b){if(g=normalizeHeader(g),g){const et=utils$1.findKey(this,g);if(et){const st=this[et];if(!b)return st;if(b===!0)return parseTokens(st);if(utils$1.isFunction(b))return b.call(this,st,et);if(utils$1.isRegExp(b))return b.exec(st);throw new TypeError("parser must be boolean|regexp|function")}}}has(g,b){if(g=normalizeHeader(g),g){const et=utils$1.findKey(this,g);return!!(et&&this[et]!==void 0&&(!b||matchHeaderValue(this,this[et],et,b)))}return!1}delete(g,b){const et=this;let st=!1;function at(vt){if(vt=normalizeHeader(vt),vt){const Tt=utils$1.findKey(et,vt);Tt&&(!b||matchHeaderValue(et,et[Tt],Tt,b))&&(delete et[Tt],st=!0)}}return utils$1.isArray(g)?g.forEach(at):at(g),st}clear(g){const b=Object.keys(this);let et=b.length,st=!1;for(;et--;){const at=b[et];(!g||matchHeaderValue(this,this[at],at,g,!0))&&(delete this[at],st=!0)}return st}normalize(g){const b=this,et={};return utils$1.forEach(this,(st,at)=>{const vt=utils$1.findKey(et,at);if(vt){b[vt]=normalizeValue(st),delete b[at];return}const Tt=g?formatHeader(at):String(at).trim();Tt!==at&&delete b[at],b[Tt]=normalizeValue(st),et[Tt]=!0}),this}concat(...g){return this.constructor.concat(this,...g)}toJSON(g){const b=Object.create(null);return utils$1.forEach(this,(et,st)=>{et!=null&&et!==!1&&(b[st]=g&&utils$1.isArray(et)?et.join(", "):et)}),b}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map(([g,b])=>g+": "+b).join(`
`)}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(g){return g instanceof this?g:new this(g)}static concat(g,...b){const et=new this(g);return b.forEach(st=>et.set(st)),et}static accessor(g){const et=(this[$internals]=this[$internals]={accessors:{}}).accessors,st=this.prototype;function at(vt){const Tt=normalizeHeader(vt);et[Tt]||(buildAccessors(st,vt),et[Tt]=!0)}return utils$1.isArray(g)?g.forEach(at):at(g),this}}AxiosHeaders.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]);utils$1.reduceDescriptors(AxiosHeaders.prototype,({value:d},g)=>{let b=g[0].toUpperCase()+g.slice(1);return{get:()=>d,set(et){this[b]=et}}});utils$1.freezeMethods(AxiosHeaders);function transformData(d,g){const b=this||defaults$1,et=g||b,st=AxiosHeaders.from(et.headers);let at=et.data;return utils$1.forEach(d,function(Tt){at=Tt.call(b,at,st.normalize(),g?g.status:void 0)}),st.normalize(),at}function isCancel(d){return!!(d&&d.__CANCEL__)}function CanceledError(d,g,b){AxiosError.call(this,d??"canceled",AxiosError.ERR_CANCELED,g,b),this.name="CanceledError"}utils$1.inherits(CanceledError,AxiosError,{__CANCEL__:!0});function settle(d,g,b){const et=b.config.validateStatus;!b.status||!et||et(b.status)?d(b):g(new AxiosError("Request failed with status code "+b.status,[AxiosError.ERR_BAD_REQUEST,AxiosError.ERR_BAD_RESPONSE][Math.floor(b.status/100)-4],b.config,b.request,b))}const cookies=platform$1.hasStandardBrowserEnv?{write(d,g,b,et,st,at){const vt=[d+"="+encodeURIComponent(g)];utils$1.isNumber(b)&&vt.push("expires="+new Date(b).toGMTString()),utils$1.isString(et)&&vt.push("path="+et),utils$1.isString(st)&&vt.push("domain="+st),at===!0&&vt.push("secure"),document.cookie=vt.join("; ")},read(d){const g=document.cookie.match(new RegExp("(^|;\\s*)("+d+")=([^;]*)"));return g?decodeURIComponent(g[3]):null},remove(d){this.write(d,"",Date.now()-864e5)}}:{write(){},read(){return null},remove(){}};function isAbsoluteURL(d){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(d)}function combineURLs(d,g){return g?d.replace(/\/?\/$/,"")+"/"+g.replace(/^\/+/,""):d}function buildFullPath(d,g){return d&&!isAbsoluteURL(g)?combineURLs(d,g):g}const isURLSameOrigin=platform$1.hasStandardBrowserEnv?function(){const g=/(msie|trident)/i.test(navigator.userAgent),b=document.createElement("a");let et;function st(at){let vt=at;return g&&(b.setAttribute("href",vt),vt=b.href),b.setAttribute("href",vt),{href:b.href,protocol:b.protocol?b.protocol.replace(/:$/,""):"",host:b.host,search:b.search?b.search.replace(/^\?/,""):"",hash:b.hash?b.hash.replace(/^#/,""):"",hostname:b.hostname,port:b.port,pathname:b.pathname.charAt(0)==="/"?b.pathname:"/"+b.pathname}}return et=st(window.location.href),function(vt){const Tt=utils$1.isString(vt)?st(vt):vt;return Tt.protocol===et.protocol&&Tt.host===et.host}}():function(){return function(){return!0}}();function parseProtocol(d){const g=/^([-+\w]{1,25})(:?\/\/|:)/.exec(d);return g&&g[1]||""}function speedometer(d,g){d=d||10;const b=new Array(d),et=new Array(d);let st=0,at=0,vt;return g=g!==void 0?g:1e3,function(Ct){const pt=Date.now(),wt=et[at];vt||(vt=pt),b[st]=Ct,et[st]=pt;let $t=at,Lt=0;for(;$t!==st;)Lt+=b[$t++],$t=$t%d;if(st=(st+1)%d,st===at&&(at=(at+1)%d),pt-vt<g)return;const jt=wt&&pt-wt;return jt?Math.round(Lt*1e3/jt):void 0}}function progressEventReducer(d,g){let b=0;const et=speedometer(50,250);return st=>{const at=st.loaded,vt=st.lengthComputable?st.total:void 0,Tt=at-b,Ct=et(Tt),pt=at<=vt;b=at;const wt={loaded:at,total:vt,progress:vt?at/vt:void 0,bytes:Tt,rate:Ct||void 0,estimated:Ct&&vt&&pt?(vt-at)/Ct:void 0,event:st};wt[g?"download":"upload"]=!0,d(wt)}}const isXHRAdapterSupported=typeof XMLHttpRequest<"u",xhrAdapter=isXHRAdapterSupported&&function(d){return new Promise(function(b,et){let st=d.data;const at=AxiosHeaders.from(d.headers).normalize();let{responseType:vt,withXSRFToken:Tt}=d,Ct;function pt(){d.cancelToken&&d.cancelToken.unsubscribe(Ct),d.signal&&d.signal.removeEventListener("abort",Ct)}let wt;if(utils$1.isFormData(st)){if(platform$1.hasStandardBrowserEnv||platform$1.hasStandardBrowserWebWorkerEnv)at.setContentType(!1);else if((wt=at.getContentType())!==!1){const[Gt,...Ht]=wt?wt.split(";").map(qt=>qt.trim()).filter(Boolean):[];at.setContentType([Gt||"multipart/form-data",...Ht].join("; "))}}let $t=new XMLHttpRequest;if(d.auth){const Gt=d.auth.username||"",Ht=d.auth.password?unescape(encodeURIComponent(d.auth.password)):"";at.set("Authorization","Basic "+btoa(Gt+":"+Ht))}const Lt=buildFullPath(d.baseURL,d.url);$t.open(d.method.toUpperCase(),buildURL(Lt,d.params,d.paramsSerializer),!0),$t.timeout=d.timeout;function jt(){if(!$t)return;const Gt=AxiosHeaders.from("getAllResponseHeaders"in $t&&$t.getAllResponseHeaders()),qt={data:!vt||vt==="text"||vt==="json"?$t.responseText:$t.response,status:$t.status,statusText:$t.statusText,headers:Gt,config:d,request:$t};settle(function(rr){b(rr),pt()},function(rr){et(rr),pt()},qt),$t=null}if("onloadend"in $t?$t.onloadend=jt:$t.onreadystatechange=function(){!$t||$t.readyState!==4||$t.status===0&&!($t.responseURL&&$t.responseURL.indexOf("file:")===0)||setTimeout(jt)},$t.onabort=function(){$t&&(et(new AxiosError("Request aborted",AxiosError.ECONNABORTED,d,$t)),$t=null)},$t.onerror=function(){et(new AxiosError("Network Error",AxiosError.ERR_NETWORK,d,$t)),$t=null},$t.ontimeout=function(){let Ht=d.timeout?"timeout of "+d.timeout+"ms exceeded":"timeout exceeded";const qt=d.transitional||transitionalDefaults;d.timeoutErrorMessage&&(Ht=d.timeoutErrorMessage),et(new AxiosError(Ht,qt.clarifyTimeoutError?AxiosError.ETIMEDOUT:AxiosError.ECONNABORTED,d,$t)),$t=null},platform$1.hasStandardBrowserEnv&&(Tt&&utils$1.isFunction(Tt)&&(Tt=Tt(d)),Tt||Tt!==!1&&isURLSameOrigin(Lt))){const Gt=d.xsrfHeaderName&&d.xsrfCookieName&&cookies.read(d.xsrfCookieName);Gt&&at.set(d.xsrfHeaderName,Gt)}st===void 0&&at.setContentType(null),"setRequestHeader"in $t&&utils$1.forEach(at.toJSON(),function(Ht,qt){$t.setRequestHeader(qt,Ht)}),utils$1.isUndefined(d.withCredentials)||($t.withCredentials=!!d.withCredentials),vt&&vt!=="json"&&($t.responseType=d.responseType),typeof d.onDownloadProgress=="function"&&$t.addEventListener("progress",progressEventReducer(d.onDownloadProgress,!0)),typeof d.onUploadProgress=="function"&&$t.upload&&$t.upload.addEventListener("progress",progressEventReducer(d.onUploadProgress)),(d.cancelToken||d.signal)&&(Ct=Gt=>{$t&&(et(!Gt||Gt.type?new CanceledError(null,d,$t):Gt),$t.abort(),$t=null)},d.cancelToken&&d.cancelToken.subscribe(Ct),d.signal&&(d.signal.aborted?Ct():d.signal.addEventListener("abort",Ct)));const Ft=parseProtocol(Lt);if(Ft&&platform$1.protocols.indexOf(Ft)===-1){et(new AxiosError("Unsupported protocol "+Ft+":",AxiosError.ERR_BAD_REQUEST,d));return}$t.send(st||null)})},knownAdapters={http:httpAdapter,xhr:xhrAdapter};utils$1.forEach(knownAdapters,(d,g)=>{if(d){try{Object.defineProperty(d,"name",{value:g})}catch{}Object.defineProperty(d,"adapterName",{value:g})}});const renderReason=d=>`- ${d}`,isResolvedHandle=d=>utils$1.isFunction(d)||d===null||d===!1,adapters={getAdapter:d=>{d=utils$1.isArray(d)?d:[d];const{length:g}=d;let b,et;const st={};for(let at=0;at<g;at++){b=d[at];let vt;if(et=b,!isResolvedHandle(b)&&(et=knownAdapters[(vt=String(b)).toLowerCase()],et===void 0))throw new AxiosError(`Unknown adapter '${vt}'`);if(et)break;st[vt||"#"+at]=et}if(!et){const at=Object.entries(st).map(([Tt,Ct])=>`adapter ${Tt} `+(Ct===!1?"is not supported by the environment":"is not available in the build"));let vt=g?at.length>1?`since :
`+at.map(renderReason).join(`
`):" "+renderReason(at[0]):"as no adapter specified";throw new AxiosError("There is no suitable adapter to dispatch the request "+vt,"ERR_NOT_SUPPORT")}return et},adapters:knownAdapters};function throwIfCancellationRequested(d){if(d.cancelToken&&d.cancelToken.throwIfRequested(),d.signal&&d.signal.aborted)throw new CanceledError(null,d)}function dispatchRequest(d){return throwIfCancellationRequested(d),d.headers=AxiosHeaders.from(d.headers),d.data=transformData.call(d,d.transformRequest),["post","put","patch"].indexOf(d.method)!==-1&&d.headers.setContentType("application/x-www-form-urlencoded",!1),adapters.getAdapter(d.adapter||defaults$1.adapter)(d).then(function(et){return throwIfCancellationRequested(d),et.data=transformData.call(d,d.transformResponse,et),et.headers=AxiosHeaders.from(et.headers),et},function(et){return isCancel(et)||(throwIfCancellationRequested(d),et&&et.response&&(et.response.data=transformData.call(d,d.transformResponse,et.response),et.response.headers=AxiosHeaders.from(et.response.headers))),Promise.reject(et)})}const headersToObject=d=>d instanceof AxiosHeaders?{...d}:d;function mergeConfig(d,g){g=g||{};const b={};function et(pt,wt,$t){return utils$1.isPlainObject(pt)&&utils$1.isPlainObject(wt)?utils$1.merge.call({caseless:$t},pt,wt):utils$1.isPlainObject(wt)?utils$1.merge({},wt):utils$1.isArray(wt)?wt.slice():wt}function st(pt,wt,$t){if(utils$1.isUndefined(wt)){if(!utils$1.isUndefined(pt))return et(void 0,pt,$t)}else return et(pt,wt,$t)}function at(pt,wt){if(!utils$1.isUndefined(wt))return et(void 0,wt)}function vt(pt,wt){if(utils$1.isUndefined(wt)){if(!utils$1.isUndefined(pt))return et(void 0,pt)}else return et(void 0,wt)}function Tt(pt,wt,$t){if($t in g)return et(pt,wt);if($t in d)return et(void 0,pt)}const Ct={url:at,method:at,data:at,baseURL:vt,transformRequest:vt,transformResponse:vt,paramsSerializer:vt,timeout:vt,timeoutMessage:vt,withCredentials:vt,withXSRFToken:vt,adapter:vt,responseType:vt,xsrfCookieName:vt,xsrfHeaderName:vt,onUploadProgress:vt,onDownloadProgress:vt,decompress:vt,maxContentLength:vt,maxBodyLength:vt,beforeRedirect:vt,transport:vt,httpAgent:vt,httpsAgent:vt,cancelToken:vt,socketPath:vt,responseEncoding:vt,validateStatus:Tt,headers:(pt,wt)=>st(headersToObject(pt),headersToObject(wt),!0)};return utils$1.forEach(Object.keys(Object.assign({},d,g)),function(wt){const $t=Ct[wt]||st,Lt=$t(d[wt],g[wt],wt);utils$1.isUndefined(Lt)&&$t!==Tt||(b[wt]=Lt)}),b}const VERSION="1.6.8",validators$1={};["object","boolean","number","function","string","symbol"].forEach((d,g)=>{validators$1[d]=function(et){return typeof et===d||"a"+(g<1?"n ":" ")+d}});const deprecatedWarnings={};validators$1.transitional=function(g,b,et){function st(at,vt){return"[Axios v"+VERSION+"] Transitional option '"+at+"'"+vt+(et?". "+et:"")}return(at,vt,Tt)=>{if(g===!1)throw new AxiosError(st(vt," has been removed"+(b?" in "+b:"")),AxiosError.ERR_DEPRECATED);return b&&!deprecatedWarnings[vt]&&(deprecatedWarnings[vt]=!0,console.warn(st(vt," has been deprecated since v"+b+" and will be removed in the near future"))),g?g(at,vt,Tt):!0}};function assertOptions(d,g,b){if(typeof d!="object")throw new AxiosError("options must be an object",AxiosError.ERR_BAD_OPTION_VALUE);const et=Object.keys(d);let st=et.length;for(;st-- >0;){const at=et[st],vt=g[at];if(vt){const Tt=d[at],Ct=Tt===void 0||vt(Tt,at,d);if(Ct!==!0)throw new AxiosError("option "+at+" must be "+Ct,AxiosError.ERR_BAD_OPTION_VALUE);continue}if(b!==!0)throw new AxiosError("Unknown option "+at,AxiosError.ERR_BAD_OPTION)}}const validator={assertOptions,validators:validators$1},validators=validator.validators;class Axios{constructor(g){this.defaults=g,this.interceptors={request:new InterceptorManager,response:new InterceptorManager}}async request(g,b){try{return await this._request(g,b)}catch(et){if(et instanceof Error){let st;Error.captureStackTrace?Error.captureStackTrace(st={}):st=new Error;const at=st.stack?st.stack.replace(/^.+\n/,""):"";et.stack?at&&!String(et.stack).endsWith(at.replace(/^.+\n.+\n/,""))&&(et.stack+=`
`+at):et.stack=at}throw et}}_request(g,b){typeof g=="string"?(b=b||{},b.url=g):b=g||{},b=mergeConfig(this.defaults,b);const{transitional:et,paramsSerializer:st,headers:at}=b;et!==void 0&&validator.assertOptions(et,{silentJSONParsing:validators.transitional(validators.boolean),forcedJSONParsing:validators.transitional(validators.boolean),clarifyTimeoutError:validators.transitional(validators.boolean)},!1),st!=null&&(utils$1.isFunction(st)?b.paramsSerializer={serialize:st}:validator.assertOptions(st,{encode:validators.function,serialize:validators.function},!0)),b.method=(b.method||this.defaults.method||"get").toLowerCase();let vt=at&&utils$1.merge(at.common,at[b.method]);at&&utils$1.forEach(["delete","get","head","post","put","patch","common"],Ft=>{delete at[Ft]}),b.headers=AxiosHeaders.concat(vt,at);const Tt=[];let Ct=!0;this.interceptors.request.forEach(function(Gt){typeof Gt.runWhen=="function"&&Gt.runWhen(b)===!1||(Ct=Ct&&Gt.synchronous,Tt.unshift(Gt.fulfilled,Gt.rejected))});const pt=[];this.interceptors.response.forEach(function(Gt){pt.push(Gt.fulfilled,Gt.rejected)});let wt,$t=0,Lt;if(!Ct){const Ft=[dispatchRequest.bind(this),void 0];for(Ft.unshift.apply(Ft,Tt),Ft.push.apply(Ft,pt),Lt=Ft.length,wt=Promise.resolve(b);$t<Lt;)wt=wt.then(Ft[$t++],Ft[$t++]);return wt}Lt=Tt.length;let jt=b;for($t=0;$t<Lt;){const Ft=Tt[$t++],Gt=Tt[$t++];try{jt=Ft(jt)}catch(Ht){Gt.call(this,Ht);break}}try{wt=dispatchRequest.call(this,jt)}catch(Ft){return Promise.reject(Ft)}for($t=0,Lt=pt.length;$t<Lt;)wt=wt.then(pt[$t++],pt[$t++]);return wt}getUri(g){g=mergeConfig(this.defaults,g);const b=buildFullPath(g.baseURL,g.url);return buildURL(b,g.params,g.paramsSerializer)}}utils$1.forEach(["delete","get","head","options"],function(g){Axios.prototype[g]=function(b,et){return this.request(mergeConfig(et||{},{method:g,url:b,data:(et||{}).data}))}});utils$1.forEach(["post","put","patch"],function(g){function b(et){return function(at,vt,Tt){return this.request(mergeConfig(Tt||{},{method:g,headers:et?{"Content-Type":"multipart/form-data"}:{},url:at,data:vt}))}}Axios.prototype[g]=b(),Axios.prototype[g+"Form"]=b(!0)});class CancelToken{constructor(g){if(typeof g!="function")throw new TypeError("executor must be a function.");let b;this.promise=new Promise(function(at){b=at});const et=this;this.promise.then(st=>{if(!et._listeners)return;let at=et._listeners.length;for(;at-- >0;)et._listeners[at](st);et._listeners=null}),this.promise.then=st=>{let at;const vt=new Promise(Tt=>{et.subscribe(Tt),at=Tt}).then(st);return vt.cancel=function(){et.unsubscribe(at)},vt},g(function(at,vt,Tt){et.reason||(et.reason=new CanceledError(at,vt,Tt),b(et.reason))})}throwIfRequested(){if(this.reason)throw this.reason}subscribe(g){if(this.reason){g(this.reason);return}this._listeners?this._listeners.push(g):this._listeners=[g]}unsubscribe(g){if(!this._listeners)return;const b=this._listeners.indexOf(g);b!==-1&&this._listeners.splice(b,1)}static source(){let g;return{token:new CancelToken(function(st){g=st}),cancel:g}}}function spread(d){return function(b){return d.apply(null,b)}}function isAxiosError(d){return utils$1.isObject(d)&&d.isAxiosError===!0}const HttpStatusCode={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511};Object.entries(HttpStatusCode).forEach(([d,g])=>{HttpStatusCode[g]=d});function createInstance(d){const g=new Axios(d),b=bind(Axios.prototype.request,g);return utils$1.extend(b,Axios.prototype,g,{allOwnKeys:!0}),utils$1.extend(b,g,null,{allOwnKeys:!0}),b.create=function(st){return createInstance(mergeConfig(d,st))},b}const axios=createInstance(defaults$1);axios.Axios=Axios;axios.CanceledError=CanceledError;axios.CancelToken=CancelToken;axios.isCancel=isCancel;axios.VERSION=VERSION;axios.toFormData=toFormData;axios.AxiosError=AxiosError;axios.Cancel=axios.CanceledError;axios.all=function(g){return Promise.all(g)};axios.spread=spread;axios.isAxiosError=isAxiosError;axios.mergeConfig=mergeConfig;axios.AxiosHeaders=AxiosHeaders;axios.formToJSON=d=>formDataToJSON(utils$1.isHTMLForm(d)?new FormData(d):d);axios.getAdapter=adapters.getAdapter;axios.HttpStatusCode=HttpStatusCode;axios.default=axios;const API_ENDPOINT="https://api.runpod.ai/v2/sa6txt6v9ok382/runsync",TOKEN="J9AEA4HA0M792XF35GRC8FHVHWQAH2LU3LZB635Q",api=axios.create({baseURL:API_ENDPOINT});async function inpaint(d,g,b,et,st,at=null,vt){const Tt=await convertToBase64(d),Ct=await convertToBase64(st),pt=at?await convertToBase64(at):null,wt=await fetch(`${API_ENDPOINT}`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${TOKEN}`},body:JSON.stringify({id:randomNumberInRange(1,65536),input:{image:Tt,mask:Ct,call_to_api:{api_call:"inpainting"},model:vt,ldm_steps:g.ldmSteps,ldm_sampler:g.ldmSampler,zits_wireframe:g.zitsWireframe,cv2_flag:g.cv2Flag,cv2_radius:g.cv2Radius,hd_strategy:"Crop",hd_strategy_crop_triger_size:640,hd_strategy_crop_margin:128,hd_trategy_resize_imit:2048,prompt:g.prompt,negative_prompt:g.negativePrompt,use_croper:g.showCropper,croper_x:b.x,croper_y:b.y,croper_height:b.height,croper_width:b.width,use_extender:g.showExtender,extender_x:et.x,extender_y:et.y,extender_height:et.height,extender_width:et.width,sd_mask_blur:g.sdMaskBlur,sd_strength:g.sdStrength,sd_steps:g.sdSteps,sd_guidance_scale:g.sdGuidanceScale,sd_sampler:g.sdSampler,sd_seed:g.seedFixed?g.seed:-1,sd_match_histograms:g.sdMatchHistograms,sd_freeu:g.enableFreeu,sd_freeu_config:g.freeuConfig,sd_lcm_lora:g.enableLCMLora,paint_by_example_example_image:pt,p2p_image_guidance_scale:g.p2pImageGuidanceScale,enable_controlnet:g.enableControlnet,controlnet_conditioning_scale:g.controlnetConditioningScale,controlnet_method:g.controlnetMethod?g.controlnetMethod:"",powerpaint_task:g.showExtender?PowerPaintTask.outpainting:g.powerpaintTask}})});if(wt.ok){const Lt=await wt.json(),{output:jt}=Lt,Ft=base64ToBlob(jt);return{blob:URL.createObjectURL(Ft),seed:"42"}}const $t=await wt.json();throw new Error(`Something went wrong: ${$t.errors}`)}async function switchPluginModel(d,g){return api.post("/switch_plugin_model",{plugin_name:d,model_name:g})}async function runPlugin(d,g,b,et,st,at){const vt=await convertToBase64(b),Tt=await fetch(`${API_ENDPOINT}`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${TOKEN}`},body:JSON.stringify({id:randomNumberInRange(1,65536),input:{call_to_api:{api_call:g,plugin_name:g,model_name:et.removeBGModel},name:g,image:vt,upscale:st,clicks:at}})});if(Tt.ok){const pt=await Tt.json(),{output:wt}=pt,$t=base64ToBlob(wt);return{blob:URL.createObjectURL($t)}}const Ct=await Tt.json();throw new Error(Ct)}async function postAdjustMask(d,g,b){const et=await convertToBase64(d),st=await fetch(`${API_ENDPOINT}/adjust_mask`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({mask:et,operate:g,kernel_size:b})});if(st.ok)return await st.blob();const at=await st.json();throw new Error(at)}const defaultValues={file:null,paintByExampleFile:null,customMask:null,imageHeight:0,imageWidth:0,isInpainting:!1,isPluginRunning:!1,isAdjustingMask:!1,disableShortCuts:!1,windowSize:{height:600,width:800},editorState:{baseBrushSize:DEFAULT_BRUSH_SIZE,brushSizeScale:1,renders:[],extraMasks:[],prevExtraMasks:[],temporaryMasks:[],lineGroups:[],lastLineGroup:[],curLineGroup:[],currentCanvas:"",canvasGroups:[],currCanvasGroups:[],lastCanvasGroups:[],redoRenders:[],redoCurLines:[],redoLineGroups:[],redoCurCanvas:[]},interactiveSegState:{isInteractiveSeg:!1,tmpInteractiveSegMask:null,clicks:[]},cropperState:{x:0,y:0,width:512,height:512},extenderState:{x:0,y:0,width:512,height:512},isCropperExtenderResizing:!1,fileManagerState:{sortBy:SortBy.CTIME,sortOrder:SortOrder.DESCENDING,layout:"masonry",searchText:"",inputDirectory:"",outputDirectory:""},serverConfig:paintByExampleConfig,settings:{model:{name:"lama",path:"lama",model_type:"inpaint",support_controlnet:!1,support_strength:!1,support_outpainting:!1,controlnets:[],support_freeu:!1,support_lcm_lora:!1,is_single_file_diffusers:!1,need_prompt:!1},enableControlnet:!1,showCropper:!1,showExtender:!1,showDrawing:!1,showSelectable:!1,extenderDirection:ExtenderDirection.xy,enableDownloadMask:!1,enableManualInpainting:!1,enableUploadMask:!1,enableAutoExtractPrompt:!0,ldmSteps:30,ldmSampler:LDMSampler.ddim,zitsWireframe:!0,cv2Radius:5,cv2Flag:CV2Flag.INPAINT_NS,prompt:"",negativePrompt:DEFAULT_NEGATIVE_PROMPT,seed:42,seedFixed:!1,sdMaskBlur:12,sdStrength:1,sdSteps:50,sdGuidanceScale:7.5,sdSampler:"DPM++ 2M",sdMatchHistograms:!1,sdScale:1,p2pImageGuidanceScale:1.5,controlnetConditioningScale:.4,controlnetMethod:"lllyasviel/control_v11p_sd15_canny",enableLCMLora:!1,enableFreeu:!1,freeuConfig:{s1:.9,s2:.2,b1:1.2,b2:1.4},powerpaintTask:PowerPaintTask.text_guided,adjustMaskKernelSize:12}},useLanguageStore=createWithEqualityFn(d=>({language:"",setLanguage:g=>d({language:g})})),useStore=createWithEqualityFn()(persist(immer((d,g)=>({...defaultValues,showPrevMask:async()=>{if(g().settings.showExtender)return;const{lastLineGroup:b,curLineGroup:et,prevExtraMasks:st,extraMasks:at}=g().editorState;if(et.length!==0||at.length!==0)return;const{imageWidth:vt,imageHeight:Tt}=g(),Ct=generateMask(vt,Tt,[b],st,BRUSH_COLOR);try{const pt=await canvasToImage(Ct);d(wt=>{wt.editorState.temporaryMasks.push(pt)})}catch(pt){console.error(pt);return}},hidePrevMask:()=>{d(b=>{b.editorState.temporaryMasks=[]})},getCurrentTargetFile:async()=>{const b=g().file,et=g().editorState.renders;let st=b;if(et.length>0){const at=et[et.length-1];st=await srcToFile(at.currentSrc,b.name,b.type)}return st},runInpainting:async b=>{const{isInpainting:et,file:st,paintByExampleFile:at,imageWidth:vt,imageHeight:Tt,settings:Ct,cropperState:pt,extenderState:wt}=g();if(et||st===null||g().settings.model.support_outpainting&&Ct.showExtender&&wt.height===Tt&&wt.width===vt)return;const{lastLineGroup:$t,curLineGroup:Lt,lineGroups:jt,renders:Ft,prevExtraMasks:Gt,extraMasks:Ht,currCanvasGroups:qt}=g().editorState;let Kt=[],rr=[];if(qt.length===0){toast({variant:"destructive",description:"Please draw mask on picture"});return}const ir=[...jt,rr];d(qr=>{qr.isInpainting=!0});const{targetMask:or,targetFile:jr}=await generateFromCanvas(qt[qt.length-1],vt,Tt);try{const qr=await inpaint(dataURItoBlob(jr),Ct,pt,wt,dataURItoBlob(or),at,b),{blob:Yr,seed:vn}=qr;vn&&g().setSeed(parseInt(vn,10));const ko=new Image;await loadImage$1(ko,Yr);const Xo=[...Ft,ko];g().setImageSize(ko.width,ko.height),g().updateEditorState({renders:Xo,lineGroups:ir,lastLineGroup:rr,curLineGroup:[],extraMasks:[],prevExtraMasks:Kt})}catch(qr){toast({variant:"destructive",description:qr.message?qr.message:qr.toString()})}g().resetRedoState(),d(qr=>{qr.isInpainting=!1,qr.editorState.temporaryMasks=[]})},runRenderablePlugin:async(b,et,st={upscale:1})=>{const{renders:at,lineGroups:vt}=g().editorState;d(Tt=>{Tt.isPluginRunning=!0});try{const Tt=new Date,Ct=await g().getCurrentTargetFile(),pt=await runPlugin(b,et,Ct,g().serverConfig,st.upscale),{blob:wt}=pt;if(b){const jt=new Image;await loadImage$1(jt,wt),d(Ft=>{Ft.editorState.extraMasks.push(jt)})}else{const jt=new Image;await loadImage$1(jt,wt),g().setImageSize(jt.width,jt.height);const Ft=[...at,jt],Gt=[...vt,[]];g().updateEditorState({renders:Ft,lineGroups:Gt})}const Lt=new Date().getTime()-Tt.getTime();toast({description:`Run ${et} successfully in ${Lt/1e3}s`})}catch(Tt){toast({variant:"destructive",description:Tt.message?Tt.message:Tt.toString()})}d(Tt=>{Tt.isPluginRunning=!1})},updateEditorState:b=>{d(et=>{et.editorState={...et.editorState,...b}})},cleanCurLineGroup:()=>{g().updateEditorState({curLineGroup:[]})},handleCanvasMouseDown:b=>{let et=[];const st=g();st.runMannually()&&(et=[...st.editorState.curLineGroup]),et.push({size:st.getBrushSize(),pts:[b]}),d(at=>{at.editorState.curLineGroup=et})},handleSaveState:b=>{let et=[];const st=g();st.runMannually()&&(et=[...st.editorState.currCanvasGroups]),et.push(b),d(at=>{at.editorState.currCanvasGroups=et})},handleCanvasMouseMove:b=>{d(et=>{const st=et.editorState.curLineGroup;st.length&&st[st.length-1].pts.push(b)})},runMannually:()=>{const b=g();return b.settings.enableManualInpainting||b.settings.model.model_type!==MODEL_TYPE_INPAINT},getIsProcessing:()=>g().isInpainting||g().isPluginRunning||g().isAdjustingMask,isSD:()=>g().settings.model.model_type!==MODEL_TYPE_INPAINT,undoDisabled:()=>{const b=g().editorState;if(b.renders.length>0)return!1;if(g().runMannually()){if(b.currCanvasGroups.length===0)return!0}else if(b.renders.length===0)return!0;return!1},undo:()=>{g().runMannually()&&g().editorState.currCanvasGroups.length!==0?d(b=>{const et=b.editorState;if(et.currCanvasGroups.length===0)return;et.lastCanvasGroups=[];const st=et.currCanvasGroups.pop();et.redoCurCanvas.push(st)}):d(b=>{const et=b.editorState;if(et.renders.length===0||et.lineGroups.length===0)return;const st=et.lineGroups.pop();et.redoLineGroups.push(st),et.redoCurLines=[],et.curLineGroup=[];const at=et.renders.pop();et.redoRenders.push(at)})},redoDisabled:()=>{const b=g().editorState;if(b.redoRenders.length>0)return!1;if(g().runMannually()){if(b.redoCurCanvas.length===0)return!0}else if(b.redoRenders.length===0)return!0;return!1},redo:()=>{g().runMannually()&&g().editorState.redoCurCanvas.length!==0?d(b=>{const et=b.editorState;if(et.redoCurCanvas.length===0)return;const st=et.redoCurCanvas.pop();et.currCanvasGroups.push(st)}):d(b=>{const et=b.editorState;if(et.redoRenders.length===0||et.redoLineGroups.length===0)return;const st=et.redoLineGroups.pop();et.lineGroups.push(st),et.curLineGroup=[];const at=et.redoRenders.pop();et.renders.push(at)})},resetRedoState:()=>{d(b=>{b.editorState.redoCurLines=[],b.editorState.redoLineGroups=[],b.editorState.redoRenders=[]})},updateAppState:b=>{d(()=>b)},getBrushSize:()=>g().editorState.baseBrushSize*g().editorState.brushSizeScale,showPromptInput:()=>{const b=g().settings.model;return b.model_type!==MODEL_TYPE_INPAINT&&b.name!==PAINT_BY_EXAMPLE},setServerConfig:b=>{d(et=>{et.serverConfig=b,et.settings.enableControlnet=b.enableControlnet,et.settings.controlnetMethod=b.controlnetMethod})},updateServerConfig:b=>{d(et=>{et.serverConfig={...et.serverConfig,...b},console.log(et.serverConfig)})},updateSettings:b=>{d(et=>{et.settings={...et.settings,...b}})},setModel:b=>{d(et=>{et.settings.model=b,b.support_controlnet&&!b.controlnets.includes(et.settings.controlnetMethod)&&(et.settings.controlnetMethod=b.controlnets[0])})},updateFileManagerState:b=>{d(et=>{et.fileManagerState={...et.fileManagerState,...b}})},updateInteractiveSegState:b=>{d(et=>({...et,interactiveSegState:{...et.interactiveSegState,...b}}))},resetInteractiveSegState:()=>{g().updateInteractiveSegState(defaultValues.interactiveSegState)},handleInteractiveSegAccept:()=>{d(b=>{b.interactiveSegState.tmpInteractiveSegMask&&b.editorState.extraMasks.push(b.interactiveSegState.tmpInteractiveSegMask),b.interactiveSegState={...defaultValues.interactiveSegState}})},setIsInpainting:b=>d(et=>{et.isInpainting=b}),setFile:async b=>{d(et=>{et.file=b,et.interactiveSegState=defaultValues.interactiveSegState,et.editorState=defaultValues.editorState,et.cropperState=defaultValues.cropperState})},setCustomFile:b=>d(et=>{et.customMask=b}),setBaseBrushSize:b=>d(et=>{et.editorState.baseBrushSize=b}),decreaseBaseBrushSize:()=>{const b=g().editorState.baseBrushSize;let et=b;b>10&&(et=b-10),b<=10&&b>0&&(et=b-3),g().setBaseBrushSize(et)},increaseBaseBrushSize:()=>{const b=g().editorState.baseBrushSize,et=Math.min(b+10,MAX_BRUSH_SIZE);g().setBaseBrushSize(et)},setImageSize:(b,et)=>{d(st=>{st.imageWidth=b,st.imageHeight=et,st.editorState.brushSizeScale=Math.max(Math.min(b,et),512)/512}),g().resetExtender(b,et)},setCropperX:b=>d(et=>{et.cropperState.x=b}),setCropperY:b=>d(et=>{et.cropperState.y=b}),setCropperWidth:b=>d(et=>{et.cropperState.width=b}),setCropperHeight:b=>d(et=>{et.cropperState.height=b}),setExtenderX:b=>d(et=>{et.extenderState.x=b}),setExtenderY:b=>d(et=>{et.extenderState.y=b}),setExtenderWidth:b=>d(et=>{et.extenderState.width=b}),setExtenderHeight:b=>d(et=>{et.extenderState.height=b}),setIsCropperExtenderResizing:b=>d(et=>{et.isCropperExtenderResizing=b}),updateExtenderDirection:b=>{console.log(`updateExtenderDirection: ${JSON.stringify(g().extenderState)}`),d(et=>{et.settings.extenderDirection=b,et.extenderState.x=0,et.extenderState.y=0,et.extenderState.width=et.imageWidth,et.extenderState.height=et.imageHeight}),g().updateExtenderByBuiltIn(b,1.5)},updateExtenderByBuiltIn:(b,et)=>{const st={...defaultValues.extenderState};let{x:at,y:vt,width:Tt,height:Ct}=st;const{imageWidth:pt,imageHeight:wt}=g();switch(Tt=pt,Ct=wt,b){case ExtenderDirection.x:at=-Math.ceil(pt*(et-1)/2),Tt=Math.ceil(pt*et);break;case ExtenderDirection.y:vt=-Math.ceil(wt*(et-1)/2),Ct=Math.ceil(wt*et);break;case ExtenderDirection.xy:at=-Math.ceil(pt*(et-1)/2),vt=-Math.ceil(wt*(et-1)/2),Tt=Math.ceil(pt*et),Ct=Math.ceil(wt*et);break}d($t=>{$t.extenderState.x=at,$t.extenderState.y=vt,$t.extenderState.width=Tt,$t.extenderState.height=Ct})},resetExtender:(b,et)=>{d(st=>{st.extenderState.x=0,st.extenderState.y=0,st.extenderState.width=b,st.extenderState.height=et})},setSeed:b=>d(et=>{et.settings.seed=b}),adjustMask:async b=>{const{imageWidth:et,imageHeight:st}=g(),{curLineGroup:at,extraMasks:vt}=g().editorState,{adjustMaskKernelSize:Tt}=g().settings;if(at.length===0&&vt.length===0)return;d(Lt=>{Lt.isAdjustingMask=!0});const Ct=generateMask(et,st,[at],vt,BRUSH_COLOR),pt=dataURItoBlob(Ct.toDataURL()),wt=await postAdjustMask(pt,b,Tt),$t=await blobToImage(wt);d(Lt=>{Lt.editorState.extraMasks=[$t],Lt.editorState.curLineGroup=[]}),d(Lt=>{Lt.isAdjustingMask=!1})},clearMask:()=>{d(b=>{b.editorState.extraMasks=[],b.editorState.curLineGroup=[]})}})),{name:"ZUSTAND_STATE",version:1,partialize:d=>Object.fromEntries(Object.entries(d).filter(([g])=>["fileManagerState","settings"].includes(g)))}),shallow$1),Input=reactExports.forwardRef(({className:d,type:g,...b},et)=>{const st=useStore(Tt=>Tt.updateAppState),at=()=>{st({disableShortCuts:!0})},vt=()=>{st({disableShortCuts:!1})};return jsxRuntimeExports.jsx("input",{type:g,className:cn$1("flex h-8 w-full rounded-md border border-input bg-transparent px-3 py-1 text-sm shadow-sm transition-colors file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50",d),ref:et,autoComplete:"off",tabIndex:-1,onFocus:at,onBlur:vt,...b})});Input.displayName="Input";const NumberInput=reactExports.forwardRef(({numberValue:d,allowFloat:g,onNumberValueChange:b,...et},st)=>{const[at,vt]=reactExports.useState(d.toString());reactExports.useEffect(()=>{at!==d.toString()+"."&&vt(d.toString())},[d]);const Tt=Ct=>{let wt=Ct.target.value;if(g){if(wt=wt.replace(/[^0-9.]/g,"").replace(/(\..*?)\..*/g,"$1"),wt.length===0){b(0);return}b(parseFloat(wt))}else{if(wt=wt.replace(/\D/g,""),wt.length===0){b(0);return}b(parseInt(wt,10))}vt(wt)};return jsxRuntimeExports.jsx(Input,{ref:st,value:at,onInput:Tt,...et})}),$1746a345f3d73bb7$var$useReactId=React$1.useId||(()=>{});let $1746a345f3d73bb7$var$count=0;function $1746a345f3d73bb7$export$f680877a34711e37(d){const[g,b]=reactExports.useState($1746a345f3d73bb7$var$useReactId());return $9f79659886946c16$export$e5c5a5f917a5871c(()=>{b(et=>et??String($1746a345f3d73bb7$var$count++))},[d]),g?`radix-${g}`:""}const sides=["top","right","bottom","left"],min=Math.min,max=Math.max,round=Math.round,floor=Math.floor,createCoords=d=>({x:d,y:d}),oppositeSideMap={left:"right",right:"left",bottom:"top",top:"bottom"},oppositeAlignmentMap={start:"end",end:"start"};function clamp$2(d,g,b){return max(d,min(g,b))}function evaluate(d,g){return typeof d=="function"?d(g):d}function getSide(d){return d.split("-")[0]}function getAlignment(d){return d.split("-")[1]}function getOppositeAxis(d){return d==="x"?"y":"x"}function getAxisLength(d){return d==="y"?"height":"width"}function getSideAxis(d){return["top","bottom"].includes(getSide(d))?"y":"x"}function getAlignmentAxis(d){return getOppositeAxis(getSideAxis(d))}function getAlignmentSides(d,g,b){b===void 0&&(b=!1);const et=getAlignment(d),st=getAlignmentAxis(d),at=getAxisLength(st);let vt=st==="x"?et===(b?"end":"start")?"right":"left":et==="start"?"bottom":"top";return g.reference[at]>g.floating[at]&&(vt=getOppositePlacement(vt)),[vt,getOppositePlacement(vt)]}function getExpandedPlacements(d){const g=getOppositePlacement(d);return[getOppositeAlignmentPlacement(d),g,getOppositeAlignmentPlacement(g)]}function getOppositeAlignmentPlacement(d){return d.replace(/start|end/g,g=>oppositeAlignmentMap[g])}function getSideList(d,g,b){const et=["left","right"],st=["right","left"],at=["top","bottom"],vt=["bottom","top"];switch(d){case"top":case"bottom":return b?g?st:et:g?et:st;case"left":case"right":return g?at:vt;default:return[]}}function getOppositeAxisPlacements(d,g,b,et){const st=getAlignment(d);let at=getSideList(getSide(d),b==="start",et);return st&&(at=at.map(vt=>vt+"-"+st),g&&(at=at.concat(at.map(getOppositeAlignmentPlacement)))),at}function getOppositePlacement(d){return d.replace(/left|right|bottom|top/g,g=>oppositeSideMap[g])}function expandPaddingObject(d){return{top:0,right:0,bottom:0,left:0,...d}}function getPaddingObject(d){return typeof d!="number"?expandPaddingObject(d):{top:d,right:d,bottom:d,left:d}}function rectToClientRect(d){const{x:g,y:b,width:et,height:st}=d;return{width:et,height:st,top:b,left:g,right:g+et,bottom:b+st,x:g,y:b}}function computeCoordsFromPlacement(d,g,b){let{reference:et,floating:st}=d;const at=getSideAxis(g),vt=getAlignmentAxis(g),Tt=getAxisLength(vt),Ct=getSide(g),pt=at==="y",wt=et.x+et.width/2-st.width/2,$t=et.y+et.height/2-st.height/2,Lt=et[Tt]/2-st[Tt]/2;let jt;switch(Ct){case"top":jt={x:wt,y:et.y-st.height};break;case"bottom":jt={x:wt,y:et.y+et.height};break;case"right":jt={x:et.x+et.width,y:$t};break;case"left":jt={x:et.x-st.width,y:$t};break;default:jt={x:et.x,y:et.y}}switch(getAlignment(g)){case"start":jt[vt]-=Lt*(b&&pt?-1:1);break;case"end":jt[vt]+=Lt*(b&&pt?-1:1);break}return jt}const computePosition$1=async(d,g,b)=>{const{placement:et="bottom",strategy:st="absolute",middleware:at=[],platform:vt}=b,Tt=at.filter(Boolean),Ct=await(vt.isRTL==null?void 0:vt.isRTL(g));let pt=await vt.getElementRects({reference:d,floating:g,strategy:st}),{x:wt,y:$t}=computeCoordsFromPlacement(pt,et,Ct),Lt=et,jt={},Ft=0;for(let Gt=0;Gt<Tt.length;Gt++){const{name:Ht,fn:qt}=Tt[Gt],{x:Kt,y:rr,data:ir,reset:or}=await qt({x:wt,y:$t,initialPlacement:et,placement:Lt,strategy:st,middlewareData:jt,rects:pt,platform:vt,elements:{reference:d,floating:g}});wt=Kt??wt,$t=rr??$t,jt={...jt,[Ht]:{...jt[Ht],...ir}},or&&Ft<=50&&(Ft++,typeof or=="object"&&(or.placement&&(Lt=or.placement),or.rects&&(pt=or.rects===!0?await vt.getElementRects({reference:d,floating:g,strategy:st}):or.rects),{x:wt,y:$t}=computeCoordsFromPlacement(pt,Lt,Ct)),Gt=-1)}return{x:wt,y:$t,placement:Lt,strategy:st,middlewareData:jt}};async function detectOverflow(d,g){var b;g===void 0&&(g={});const{x:et,y:st,platform:at,rects:vt,elements:Tt,strategy:Ct}=d,{boundary:pt="clippingAncestors",rootBoundary:wt="viewport",elementContext:$t="floating",altBoundary:Lt=!1,padding:jt=0}=evaluate(g,d),Ft=getPaddingObject(jt),Ht=Tt[Lt?$t==="floating"?"reference":"floating":$t],qt=rectToClientRect(await at.getClippingRect({element:(b=await(at.isElement==null?void 0:at.isElement(Ht)))==null||b?Ht:Ht.contextElement||await(at.getDocumentElement==null?void 0:at.getDocumentElement(Tt.floating)),boundary:pt,rootBoundary:wt,strategy:Ct})),Kt=$t==="floating"?{x:et,y:st,width:vt.floating.width,height:vt.floating.height}:vt.reference,rr=await(at.getOffsetParent==null?void 0:at.getOffsetParent(Tt.floating)),ir=await(at.isElement==null?void 0:at.isElement(rr))?await(at.getScale==null?void 0:at.getScale(rr))||{x:1,y:1}:{x:1,y:1},or=rectToClientRect(at.convertOffsetParentRelativeRectToViewportRelativeRect?await at.convertOffsetParentRelativeRectToViewportRelativeRect({elements:Tt,rect:Kt,offsetParent:rr,strategy:Ct}):Kt);return{top:(qt.top-or.top+Ft.top)/ir.y,bottom:(or.bottom-qt.bottom+Ft.bottom)/ir.y,left:(qt.left-or.left+Ft.left)/ir.x,right:(or.right-qt.right+Ft.right)/ir.x}}const arrow$2=d=>({name:"arrow",options:d,async fn(g){const{x:b,y:et,placement:st,rects:at,platform:vt,elements:Tt,middlewareData:Ct}=g,{element:pt,padding:wt=0}=evaluate(d,g)||{};if(pt==null)return{};const $t=getPaddingObject(wt),Lt={x:b,y:et},jt=getAlignmentAxis(st),Ft=getAxisLength(jt),Gt=await vt.getDimensions(pt),Ht=jt==="y",qt=Ht?"top":"left",Kt=Ht?"bottom":"right",rr=Ht?"clientHeight":"clientWidth",ir=at.reference[Ft]+at.reference[jt]-Lt[jt]-at.floating[Ft],or=Lt[jt]-at.reference[jt],jr=await(vt.getOffsetParent==null?void 0:vt.getOffsetParent(pt));let qr=jr?jr[rr]:0;(!qr||!await(vt.isElement==null?void 0:vt.isElement(jr)))&&(qr=Tt.floating[rr]||at.floating[Ft]);const Yr=ir/2-or/2,vn=qr/2-Gt[Ft]/2-1,ko=min($t[qt],vn),Xo=min($t[Kt],vn),zo=ko,t0=qr-Gt[Ft]-Xo,Uo=qr/2-Gt[Ft]/2+Yr,No=clamp$2(zo,Uo,t0),_n=!Ct.arrow&&getAlignment(st)!=null&&Uo!==No&&at.reference[Ft]/2-(Uo<zo?ko:Xo)-Gt[Ft]/2<0,Kr=_n?Uo<zo?Uo-zo:Uo-t0:0;return{[jt]:Lt[jt]+Kr,data:{[jt]:No,centerOffset:Uo-No-Kr,..._n&&{alignmentOffset:Kr}},reset:_n}}}),flip$1=function(d){return d===void 0&&(d={}),{name:"flip",options:d,async fn(g){var b,et;const{placement:st,middlewareData:at,rects:vt,initialPlacement:Tt,platform:Ct,elements:pt}=g,{mainAxis:wt=!0,crossAxis:$t=!0,fallbackPlacements:Lt,fallbackStrategy:jt="bestFit",fallbackAxisSideDirection:Ft="none",flipAlignment:Gt=!0,...Ht}=evaluate(d,g);if((b=at.arrow)!=null&&b.alignmentOffset)return{};const qt=getSide(st),Kt=getSide(Tt)===Tt,rr=await(Ct.isRTL==null?void 0:Ct.isRTL(pt.floating)),ir=Lt||(Kt||!Gt?[getOppositePlacement(Tt)]:getExpandedPlacements(Tt));!Lt&&Ft!=="none"&&ir.push(...getOppositeAxisPlacements(Tt,Gt,Ft,rr));const or=[Tt,...ir],jr=await detectOverflow(g,Ht),qr=[];let Yr=((et=at.flip)==null?void 0:et.overflows)||[];if(wt&&qr.push(jr[qt]),$t){const zo=getAlignmentSides(st,vt,rr);qr.push(jr[zo[0]],jr[zo[1]])}if(Yr=[...Yr,{placement:st,overflows:qr}],!qr.every(zo=>zo<=0)){var vn,ko;const zo=(((vn=at.flip)==null?void 0:vn.index)||0)+1,t0=or[zo];if(t0)return{data:{index:zo,overflows:Yr},reset:{placement:t0}};let Uo=(ko=Yr.filter(No=>No.overflows[0]<=0).sort((No,_n)=>No.overflows[1]-_n.overflows[1])[0])==null?void 0:ko.placement;if(!Uo)switch(jt){case"bestFit":{var Xo;const No=(Xo=Yr.map(_n=>[_n.placement,_n.overflows.filter(Kr=>Kr>0).reduce((Kr,e0)=>Kr+e0,0)]).sort((_n,Kr)=>_n[1]-Kr[1])[0])==null?void 0:Xo[0];No&&(Uo=No);break}case"initialPlacement":Uo=Tt;break}if(st!==Uo)return{reset:{placement:Uo}}}return{}}}};function getSideOffsets(d,g){return{top:d.top-g.height,right:d.right-g.width,bottom:d.bottom-g.height,left:d.left-g.width}}function isAnySideFullyClipped(d){return sides.some(g=>d[g]>=0)}const hide$1=function(d){return d===void 0&&(d={}),{name:"hide",options:d,async fn(g){const{rects:b}=g,{strategy:et="referenceHidden",...st}=evaluate(d,g);switch(et){case"referenceHidden":{const at=await detectOverflow(g,{...st,elementContext:"reference"}),vt=getSideOffsets(at,b.reference);return{data:{referenceHiddenOffsets:vt,referenceHidden:isAnySideFullyClipped(vt)}}}case"escaped":{const at=await detectOverflow(g,{...st,altBoundary:!0}),vt=getSideOffsets(at,b.floating);return{data:{escapedOffsets:vt,escaped:isAnySideFullyClipped(vt)}}}default:return{}}}}};async function convertValueToCoords(d,g){const{placement:b,platform:et,elements:st}=d,at=await(et.isRTL==null?void 0:et.isRTL(st.floating)),vt=getSide(b),Tt=getAlignment(b),Ct=getSideAxis(b)==="y",pt=["left","top"].includes(vt)?-1:1,wt=at&&Ct?-1:1,$t=evaluate(g,d);let{mainAxis:Lt,crossAxis:jt,alignmentAxis:Ft}=typeof $t=="number"?{mainAxis:$t,crossAxis:0,alignmentAxis:null}:{mainAxis:0,crossAxis:0,alignmentAxis:null,...$t};return Tt&&typeof Ft=="number"&&(jt=Tt==="end"?Ft*-1:Ft),Ct?{x:jt*wt,y:Lt*pt}:{x:Lt*pt,y:jt*wt}}const offset$1=function(d){return d===void 0&&(d=0),{name:"offset",options:d,async fn(g){var b,et;const{x:st,y:at,placement:vt,middlewareData:Tt}=g,Ct=await convertValueToCoords(g,d);return vt===((b=Tt.offset)==null?void 0:b.placement)&&(et=Tt.arrow)!=null&&et.alignmentOffset?{}:{x:st+Ct.x,y:at+Ct.y,data:{...Ct,placement:vt}}}}},shift$1=function(d){return d===void 0&&(d={}),{name:"shift",options:d,async fn(g){const{x:b,y:et,placement:st}=g,{mainAxis:at=!0,crossAxis:vt=!1,limiter:Tt={fn:Ht=>{let{x:qt,y:Kt}=Ht;return{x:qt,y:Kt}}},...Ct}=evaluate(d,g),pt={x:b,y:et},wt=await detectOverflow(g,Ct),$t=getSideAxis(getSide(st)),Lt=getOppositeAxis($t);let jt=pt[Lt],Ft=pt[$t];if(at){const Ht=Lt==="y"?"top":"left",qt=Lt==="y"?"bottom":"right",Kt=jt+wt[Ht],rr=jt-wt[qt];jt=clamp$2(Kt,jt,rr)}if(vt){const Ht=$t==="y"?"top":"left",qt=$t==="y"?"bottom":"right",Kt=Ft+wt[Ht],rr=Ft-wt[qt];Ft=clamp$2(Kt,Ft,rr)}const Gt=Tt.fn({...g,[Lt]:jt,[$t]:Ft});return{...Gt,data:{x:Gt.x-b,y:Gt.y-et}}}}},limitShift$1=function(d){return d===void 0&&(d={}),{options:d,fn(g){const{x:b,y:et,placement:st,rects:at,middlewareData:vt}=g,{offset:Tt=0,mainAxis:Ct=!0,crossAxis:pt=!0}=evaluate(d,g),wt={x:b,y:et},$t=getSideAxis(st),Lt=getOppositeAxis($t);let jt=wt[Lt],Ft=wt[$t];const Gt=evaluate(Tt,g),Ht=typeof Gt=="number"?{mainAxis:Gt,crossAxis:0}:{mainAxis:0,crossAxis:0,...Gt};if(Ct){const rr=Lt==="y"?"height":"width",ir=at.reference[Lt]-at.floating[rr]+Ht.mainAxis,or=at.reference[Lt]+at.reference[rr]-Ht.mainAxis;jt<ir?jt=ir:jt>or&&(jt=or)}if(pt){var qt,Kt;const rr=Lt==="y"?"width":"height",ir=["top","left"].includes(getSide(st)),or=at.reference[$t]-at.floating[rr]+(ir&&((qt=vt.offset)==null?void 0:qt[$t])||0)+(ir?0:Ht.crossAxis),jr=at.reference[$t]+at.reference[rr]+(ir?0:((Kt=vt.offset)==null?void 0:Kt[$t])||0)-(ir?Ht.crossAxis:0);Ft<or?Ft=or:Ft>jr&&(Ft=jr)}return{[Lt]:jt,[$t]:Ft}}}},size$1=function(d){return d===void 0&&(d={}),{name:"size",options:d,async fn(g){const{placement:b,rects:et,platform:st,elements:at}=g,{apply:vt=()=>{},...Tt}=evaluate(d,g),Ct=await detectOverflow(g,Tt),pt=getSide(b),wt=getAlignment(b),$t=getSideAxis(b)==="y",{width:Lt,height:jt}=et.floating;let Ft,Gt;pt==="top"||pt==="bottom"?(Ft=pt,Gt=wt===(await(st.isRTL==null?void 0:st.isRTL(at.floating))?"start":"end")?"left":"right"):(Gt=pt,Ft=wt==="end"?"top":"bottom");const Ht=jt-Ct[Ft],qt=Lt-Ct[Gt],Kt=!g.middlewareData.shift;let rr=Ht,ir=qt;if($t){const jr=Lt-Ct.left-Ct.right;ir=wt||Kt?min(qt,jr):jr}else{const jr=jt-Ct.top-Ct.bottom;rr=wt||Kt?min(Ht,jr):jr}if(Kt&&!wt){const jr=max(Ct.left,0),qr=max(Ct.right,0),Yr=max(Ct.top,0),vn=max(Ct.bottom,0);$t?ir=Lt-2*(jr!==0||qr!==0?jr+qr:max(Ct.left,Ct.right)):rr=jt-2*(Yr!==0||vn!==0?Yr+vn:max(Ct.top,Ct.bottom))}await vt({...g,availableWidth:ir,availableHeight:rr});const or=await st.getDimensions(at.floating);return Lt!==or.width||jt!==or.height?{reset:{rects:!0}}:{}}}};function getNodeName(d){return isNode(d)?(d.nodeName||"").toLowerCase():"#document"}function getWindow(d){var g;return(d==null||(g=d.ownerDocument)==null?void 0:g.defaultView)||window}function getDocumentElement(d){var g;return(g=(isNode(d)?d.ownerDocument:d.document)||window.document)==null?void 0:g.documentElement}function isNode(d){return d instanceof Node||d instanceof getWindow(d).Node}function isElement(d){return d instanceof Element||d instanceof getWindow(d).Element}function isHTMLElement$1(d){return d instanceof HTMLElement||d instanceof getWindow(d).HTMLElement}function isShadowRoot(d){return typeof ShadowRoot>"u"?!1:d instanceof ShadowRoot||d instanceof getWindow(d).ShadowRoot}function isOverflowElement(d){const{overflow:g,overflowX:b,overflowY:et,display:st}=getComputedStyle$1(d);return/auto|scroll|overlay|hidden|clip/.test(g+et+b)&&!["inline","contents"].includes(st)}function isTableElement(d){return["table","td","th"].includes(getNodeName(d))}function isContainingBlock(d){const g=isWebKit(),b=getComputedStyle$1(d);return b.transform!=="none"||b.perspective!=="none"||(b.containerType?b.containerType!=="normal":!1)||!g&&(b.backdropFilter?b.backdropFilter!=="none":!1)||!g&&(b.filter?b.filter!=="none":!1)||["transform","perspective","filter"].some(et=>(b.willChange||"").includes(et))||["paint","layout","strict","content"].some(et=>(b.contain||"").includes(et))}function getContainingBlock(d){let g=getParentNode(d);for(;isHTMLElement$1(g)&&!isLastTraversableNode(g);){if(isContainingBlock(g))return g;g=getParentNode(g)}return null}function isWebKit(){return typeof CSS>"u"||!CSS.supports?!1:CSS.supports("-webkit-backdrop-filter","none")}function isLastTraversableNode(d){return["html","body","#document"].includes(getNodeName(d))}function getComputedStyle$1(d){return getWindow(d).getComputedStyle(d)}function getNodeScroll(d){return isElement(d)?{scrollLeft:d.scrollLeft,scrollTop:d.scrollTop}:{scrollLeft:d.pageXOffset,scrollTop:d.pageYOffset}}function getParentNode(d){if(getNodeName(d)==="html")return d;const g=d.assignedSlot||d.parentNode||isShadowRoot(d)&&d.host||getDocumentElement(d);return isShadowRoot(g)?g.host:g}function getNearestOverflowAncestor(d){const g=getParentNode(d);return isLastTraversableNode(g)?d.ownerDocument?d.ownerDocument.body:d.body:isHTMLElement$1(g)&&isOverflowElement(g)?g:getNearestOverflowAncestor(g)}function getOverflowAncestors(d,g,b){var et;g===void 0&&(g=[]),b===void 0&&(b=!0);const st=getNearestOverflowAncestor(d),at=st===((et=d.ownerDocument)==null?void 0:et.body),vt=getWindow(st);return at?g.concat(vt,vt.visualViewport||[],isOverflowElement(st)?st:[],vt.frameElement&&b?getOverflowAncestors(vt.frameElement):[]):g.concat(st,getOverflowAncestors(st,[],b))}function getCssDimensions(d){const g=getComputedStyle$1(d);let b=parseFloat(g.width)||0,et=parseFloat(g.height)||0;const st=isHTMLElement$1(d),at=st?d.offsetWidth:b,vt=st?d.offsetHeight:et,Tt=round(b)!==at||round(et)!==vt;return Tt&&(b=at,et=vt),{width:b,height:et,$:Tt}}function unwrapElement(d){return isElement(d)?d:d.contextElement}function getScale(d){const g=unwrapElement(d);if(!isHTMLElement$1(g))return createCoords(1);const b=g.getBoundingClientRect(),{width:et,height:st,$:at}=getCssDimensions(g);let vt=(at?round(b.width):b.width)/et,Tt=(at?round(b.height):b.height)/st;return(!vt||!Number.isFinite(vt))&&(vt=1),(!Tt||!Number.isFinite(Tt))&&(Tt=1),{x:vt,y:Tt}}const noOffsets=createCoords(0);function getVisualOffsets(d){const g=getWindow(d);return!isWebKit()||!g.visualViewport?noOffsets:{x:g.visualViewport.offsetLeft,y:g.visualViewport.offsetTop}}function shouldAddVisualOffsets(d,g,b){return g===void 0&&(g=!1),!b||g&&b!==getWindow(d)?!1:g}function getBoundingClientRect(d,g,b,et){g===void 0&&(g=!1),b===void 0&&(b=!1);const st=d.getBoundingClientRect(),at=unwrapElement(d);let vt=createCoords(1);g&&(et?isElement(et)&&(vt=getScale(et)):vt=getScale(d));const Tt=shouldAddVisualOffsets(at,b,et)?getVisualOffsets(at):createCoords(0);let Ct=(st.left+Tt.x)/vt.x,pt=(st.top+Tt.y)/vt.y,wt=st.width/vt.x,$t=st.height/vt.y;if(at){const Lt=getWindow(at),jt=et&&isElement(et)?getWindow(et):et;let Ft=Lt,Gt=Ft.frameElement;for(;Gt&&et&&jt!==Ft;){const Ht=getScale(Gt),qt=Gt.getBoundingClientRect(),Kt=getComputedStyle$1(Gt),rr=qt.left+(Gt.clientLeft+parseFloat(Kt.paddingLeft))*Ht.x,ir=qt.top+(Gt.clientTop+parseFloat(Kt.paddingTop))*Ht.y;Ct*=Ht.x,pt*=Ht.y,wt*=Ht.x,$t*=Ht.y,Ct+=rr,pt+=ir,Ft=getWindow(Gt),Gt=Ft.frameElement}}return rectToClientRect({width:wt,height:$t,x:Ct,y:pt})}const topLayerSelectors=[":popover-open",":modal"];function isTopLayer(d){return topLayerSelectors.some(g=>{try{return d.matches(g)}catch{return!1}})}function convertOffsetParentRelativeRectToViewportRelativeRect(d){let{elements:g,rect:b,offsetParent:et,strategy:st}=d;const at=st==="fixed",vt=getDocumentElement(et),Tt=g?isTopLayer(g.floating):!1;if(et===vt||Tt&&at)return b;let Ct={scrollLeft:0,scrollTop:0},pt=createCoords(1);const wt=createCoords(0),$t=isHTMLElement$1(et);if(($t||!$t&&!at)&&((getNodeName(et)!=="body"||isOverflowElement(vt))&&(Ct=getNodeScroll(et)),isHTMLElement$1(et))){const Lt=getBoundingClientRect(et);pt=getScale(et),wt.x=Lt.x+et.clientLeft,wt.y=Lt.y+et.clientTop}return{width:b.width*pt.x,height:b.height*pt.y,x:b.x*pt.x-Ct.scrollLeft*pt.x+wt.x,y:b.y*pt.y-Ct.scrollTop*pt.y+wt.y}}function getClientRects(d){return Array.from(d.getClientRects())}function getWindowScrollBarX(d){return getBoundingClientRect(getDocumentElement(d)).left+getNodeScroll(d).scrollLeft}function getDocumentRect(d){const g=getDocumentElement(d),b=getNodeScroll(d),et=d.ownerDocument.body,st=max(g.scrollWidth,g.clientWidth,et.scrollWidth,et.clientWidth),at=max(g.scrollHeight,g.clientHeight,et.scrollHeight,et.clientHeight);let vt=-b.scrollLeft+getWindowScrollBarX(d);const Tt=-b.scrollTop;return getComputedStyle$1(et).direction==="rtl"&&(vt+=max(g.clientWidth,et.clientWidth)-st),{width:st,height:at,x:vt,y:Tt}}function getViewportRect(d,g){const b=getWindow(d),et=getDocumentElement(d),st=b.visualViewport;let at=et.clientWidth,vt=et.clientHeight,Tt=0,Ct=0;if(st){at=st.width,vt=st.height;const pt=isWebKit();(!pt||pt&&g==="fixed")&&(Tt=st.offsetLeft,Ct=st.offsetTop)}return{width:at,height:vt,x:Tt,y:Ct}}function getInnerBoundingClientRect(d,g){const b=getBoundingClientRect(d,!0,g==="fixed"),et=b.top+d.clientTop,st=b.left+d.clientLeft,at=isHTMLElement$1(d)?getScale(d):createCoords(1),vt=d.clientWidth*at.x,Tt=d.clientHeight*at.y,Ct=st*at.x,pt=et*at.y;return{width:vt,height:Tt,x:Ct,y:pt}}function getClientRectFromClippingAncestor(d,g,b){let et;if(g==="viewport")et=getViewportRect(d,b);else if(g==="document")et=getDocumentRect(getDocumentElement(d));else if(isElement(g))et=getInnerBoundingClientRect(g,b);else{const st=getVisualOffsets(d);et={...g,x:g.x-st.x,y:g.y-st.y}}return rectToClientRect(et)}function hasFixedPositionAncestor(d,g){const b=getParentNode(d);return b===g||!isElement(b)||isLastTraversableNode(b)?!1:getComputedStyle$1(b).position==="fixed"||hasFixedPositionAncestor(b,g)}function getClippingElementAncestors(d,g){const b=g.get(d);if(b)return b;let et=getOverflowAncestors(d,[],!1).filter(Tt=>isElement(Tt)&&getNodeName(Tt)!=="body"),st=null;const at=getComputedStyle$1(d).position==="fixed";let vt=at?getParentNode(d):d;for(;isElement(vt)&&!isLastTraversableNode(vt);){const Tt=getComputedStyle$1(vt),Ct=isContainingBlock(vt);!Ct&&Tt.position==="fixed"&&(st=null),(at?!Ct&&!st:!Ct&&Tt.position==="static"&&!!st&&["absolute","fixed"].includes(st.position)||isOverflowElement(vt)&&!Ct&&hasFixedPositionAncestor(d,vt))?et=et.filter(wt=>wt!==vt):st=Tt,vt=getParentNode(vt)}return g.set(d,et),et}function getClippingRect(d){let{element:g,boundary:b,rootBoundary:et,strategy:st}=d;const vt=[...b==="clippingAncestors"?isTopLayer(g)?[]:getClippingElementAncestors(g,this._c):[].concat(b),et],Tt=vt[0],Ct=vt.reduce((pt,wt)=>{const $t=getClientRectFromClippingAncestor(g,wt,st);return pt.top=max($t.top,pt.top),pt.right=min($t.right,pt.right),pt.bottom=min($t.bottom,pt.bottom),pt.left=max($t.left,pt.left),pt},getClientRectFromClippingAncestor(g,Tt,st));return{width:Ct.right-Ct.left,height:Ct.bottom-Ct.top,x:Ct.left,y:Ct.top}}function getDimensions(d){const{width:g,height:b}=getCssDimensions(d);return{width:g,height:b}}function getRectRelativeToOffsetParent(d,g,b){const et=isHTMLElement$1(g),st=getDocumentElement(g),at=b==="fixed",vt=getBoundingClientRect(d,!0,at,g);let Tt={scrollLeft:0,scrollTop:0};const Ct=createCoords(0);if(et||!et&&!at)if((getNodeName(g)!=="body"||isOverflowElement(st))&&(Tt=getNodeScroll(g)),et){const $t=getBoundingClientRect(g,!0,at,g);Ct.x=$t.x+g.clientLeft,Ct.y=$t.y+g.clientTop}else st&&(Ct.x=getWindowScrollBarX(st));const pt=vt.left+Tt.scrollLeft-Ct.x,wt=vt.top+Tt.scrollTop-Ct.y;return{x:pt,y:wt,width:vt.width,height:vt.height}}function isStaticPositioned(d){return getComputedStyle$1(d).position==="static"}function getTrueOffsetParent(d,g){return!isHTMLElement$1(d)||getComputedStyle$1(d).position==="fixed"?null:g?g(d):d.offsetParent}function getOffsetParent(d,g){const b=getWindow(d);if(isTopLayer(d))return b;if(!isHTMLElement$1(d)){let st=getParentNode(d);for(;st&&!isLastTraversableNode(st);){if(isElement(st)&&!isStaticPositioned(st))return st;st=getParentNode(st)}return b}let et=getTrueOffsetParent(d,g);for(;et&&isTableElement(et)&&isStaticPositioned(et);)et=getTrueOffsetParent(et,g);return et&&isLastTraversableNode(et)&&isStaticPositioned(et)&&!isContainingBlock(et)?b:et||getContainingBlock(d)||b}const getElementRects=async function(d){const g=this.getOffsetParent||getOffsetParent,b=this.getDimensions,et=await b(d.floating);return{reference:getRectRelativeToOffsetParent(d.reference,await g(d.floating),d.strategy),floating:{x:0,y:0,width:et.width,height:et.height}}};function isRTL(d){return getComputedStyle$1(d).direction==="rtl"}const platform={convertOffsetParentRelativeRectToViewportRelativeRect,getDocumentElement,getClippingRect,getOffsetParent,getElementRects,getClientRects,getDimensions,getScale,isElement,isRTL};function observeMove(d,g){let b=null,et;const st=getDocumentElement(d);function at(){var Tt;clearTimeout(et),(Tt=b)==null||Tt.disconnect(),b=null}function vt(Tt,Ct){Tt===void 0&&(Tt=!1),Ct===void 0&&(Ct=1),at();const{left:pt,top:wt,width:$t,height:Lt}=d.getBoundingClientRect();if(Tt||g(),!$t||!Lt)return;const jt=floor(wt),Ft=floor(st.clientWidth-(pt+$t)),Gt=floor(st.clientHeight-(wt+Lt)),Ht=floor(pt),Kt={rootMargin:-jt+"px "+-Ft+"px "+-Gt+"px "+-Ht+"px",threshold:max(0,min(1,Ct))||1};let rr=!0;function ir(or){const jr=or[0].intersectionRatio;if(jr!==Ct){if(!rr)return vt();jr?vt(!1,jr):et=setTimeout(()=>{vt(!1,1e-7)},1e3)}rr=!1}try{b=new IntersectionObserver(ir,{...Kt,root:st.ownerDocument})}catch{b=new IntersectionObserver(ir,Kt)}b.observe(d)}return vt(!0),at}function autoUpdate(d,g,b,et){et===void 0&&(et={});const{ancestorScroll:st=!0,ancestorResize:at=!0,elementResize:vt=typeof ResizeObserver=="function",layoutShift:Tt=typeof IntersectionObserver=="function",animationFrame:Ct=!1}=et,pt=unwrapElement(d),wt=st||at?[...pt?getOverflowAncestors(pt):[],...getOverflowAncestors(g)]:[];wt.forEach(qt=>{st&&qt.addEventListener("scroll",b,{passive:!0}),at&&qt.addEventListener("resize",b)});const $t=pt&&Tt?observeMove(pt,b):null;let Lt=-1,jt=null;vt&&(jt=new ResizeObserver(qt=>{let[Kt]=qt;Kt&&Kt.target===pt&&jt&&(jt.unobserve(g),cancelAnimationFrame(Lt),Lt=requestAnimationFrame(()=>{var rr;(rr=jt)==null||rr.observe(g)})),b()}),pt&&!Ct&&jt.observe(pt),jt.observe(g));let Ft,Gt=Ct?getBoundingClientRect(d):null;Ct&&Ht();function Ht(){const qt=getBoundingClientRect(d);Gt&&(qt.x!==Gt.x||qt.y!==Gt.y||qt.width!==Gt.width||qt.height!==Gt.height)&&b(),Gt=qt,Ft=requestAnimationFrame(Ht)}return b(),()=>{var qt;wt.forEach(Kt=>{st&&Kt.removeEventListener("scroll",b),at&&Kt.removeEventListener("resize",b)}),$t==null||$t(),(qt=jt)==null||qt.disconnect(),jt=null,Ct&&cancelAnimationFrame(Ft)}}const offset=offset$1,shift=shift$1,flip=flip$1,size=size$1,hide=hide$1,arrow$1=arrow$2,limitShift=limitShift$1,computePosition=(d,g,b)=>{const et=new Map,st={platform,...b},at={...st.platform,_c:et};return computePosition$1(d,g,{...st,platform:at})},arrow=d=>{function g(b){return{}.hasOwnProperty.call(b,"current")}return{name:"arrow",options:d,fn(b){const{element:et,padding:st}=typeof d=="function"?d(b):d;return et&&g(et)?et.current!=null?arrow$1({element:et.current,padding:st}).fn(b):{}:et?arrow$1({element:et,padding:st}).fn(b):{}}}};var index=typeof document<"u"?reactExports.useLayoutEffect:reactExports.useEffect;function deepEqual$2(d,g){if(d===g)return!0;if(typeof d!=typeof g)return!1;if(typeof d=="function"&&d.toString()===g.toString())return!0;let b,et,st;if(d&&g&&typeof d=="object"){if(Array.isArray(d)){if(b=d.length,b!==g.length)return!1;for(et=b;et--!==0;)if(!deepEqual$2(d[et],g[et]))return!1;return!0}if(st=Object.keys(d),b=st.length,b!==Object.keys(g).length)return!1;for(et=b;et--!==0;)if(!{}.hasOwnProperty.call(g,st[et]))return!1;for(et=b;et--!==0;){const at=st[et];if(!(at==="_owner"&&d.$$typeof)&&!deepEqual$2(d[at],g[at]))return!1}return!0}return d!==d&&g!==g}function getDPR(d){return typeof window>"u"?1:(d.ownerDocument.defaultView||window).devicePixelRatio||1}function roundByDPR(d,g){const b=getDPR(d);return Math.round(g*b)/b}function useLatestRef(d){const g=reactExports.useRef(d);return index(()=>{g.current=d}),g}function useFloating(d){d===void 0&&(d={});const{placement:g="bottom",strategy:b="absolute",middleware:et=[],platform:st,elements:{reference:at,floating:vt}={},transform:Tt=!0,whileElementsMounted:Ct,open:pt}=d,[wt,$t]=reactExports.useState({x:0,y:0,strategy:b,placement:g,middlewareData:{},isPositioned:!1}),[Lt,jt]=reactExports.useState(et);deepEqual$2(Lt,et)||jt(et);const[Ft,Gt]=reactExports.useState(null),[Ht,qt]=reactExports.useState(null),Kt=reactExports.useCallback(Kr=>{Kr!==jr.current&&(jr.current=Kr,Gt(Kr))},[]),rr=reactExports.useCallback(Kr=>{Kr!==qr.current&&(qr.current=Kr,qt(Kr))},[]),ir=at||Ft,or=vt||Ht,jr=reactExports.useRef(null),qr=reactExports.useRef(null),Yr=reactExports.useRef(wt),vn=Ct!=null,ko=useLatestRef(Ct),Xo=useLatestRef(st),zo=reactExports.useCallback(()=>{if(!jr.current||!qr.current)return;const Kr={placement:g,strategy:b,middleware:Lt};Xo.current&&(Kr.platform=Xo.current),computePosition(jr.current,qr.current,Kr).then(e0=>{const Zr={...e0,isPositioned:!0};t0.current&&!deepEqual$2(Yr.current,Zr)&&(Yr.current=Zr,reactDomExports.flushSync(()=>{$t(Zr)}))})},[Lt,g,b,Xo]);index(()=>{pt===!1&&Yr.current.isPositioned&&(Yr.current.isPositioned=!1,$t(Kr=>({...Kr,isPositioned:!1})))},[pt]);const t0=reactExports.useRef(!1);index(()=>(t0.current=!0,()=>{t0.current=!1}),[]),index(()=>{if(ir&&(jr.current=ir),or&&(qr.current=or),ir&&or){if(ko.current)return ko.current(ir,or,zo);zo()}},[ir,or,zo,ko,vn]);const Uo=reactExports.useMemo(()=>({reference:jr,floating:qr,setReference:Kt,setFloating:rr}),[Kt,rr]),No=reactExports.useMemo(()=>({reference:ir,floating:or}),[ir,or]),_n=reactExports.useMemo(()=>{const Kr={position:b,left:0,top:0};if(!No.floating)return Kr;const e0=roundByDPR(No.floating,wt.x),Zr=roundByDPR(No.floating,wt.y);return Tt?{...Kr,transform:"translate("+e0+"px, "+Zr+"px)",...getDPR(No.floating)>=1.5&&{willChange:"transform"}}:{position:b,left:e0,top:Zr}},[b,Tt,No.floating,wt.x,wt.y]);return reactExports.useMemo(()=>({...wt,update:zo,refs:Uo,elements:No,floatingStyles:_n}),[wt,zo,Uo,No,_n])}const $7e8f5cd07187803e$export$21b07c8f274aebd5=reactExports.forwardRef((d,g)=>{const{children:b,width:et=10,height:st=5,...at}=d;return reactExports.createElement($8927f6f2acc4f386$export$250ffa63cdc0d034.svg,_extends$1({},at,{ref:g,width:et,height:st,viewBox:"0 0 30 10",preserveAspectRatio:"none"}),d.asChild?b:reactExports.createElement("polygon",{points:"0,0 30,0 15,10"}))}),$7e8f5cd07187803e$export$be92b6f5f03c0fe9=$7e8f5cd07187803e$export$21b07c8f274aebd5;function $db6c3485150b8e66$export$1ab7ae714698c4b8(d){const[g,b]=reactExports.useState(void 0);return $9f79659886946c16$export$e5c5a5f917a5871c(()=>{if(d){b({width:d.offsetWidth,height:d.offsetHeight});const et=new ResizeObserver(st=>{if(!Array.isArray(st)||!st.length)return;const at=st[0];let vt,Tt;if("borderBoxSize"in at){const Ct=at.borderBoxSize,pt=Array.isArray(Ct)?Ct[0]:Ct;vt=pt.inlineSize,Tt=pt.blockSize}else vt=d.offsetWidth,Tt=d.offsetHeight;b({width:vt,height:Tt})});return et.observe(d,{box:"border-box"}),()=>et.unobserve(d)}else b(void 0)},[d]),g}const $cf1ac5d9fe0e8206$var$POPPER_NAME="Popper",[$cf1ac5d9fe0e8206$var$createPopperContext,$cf1ac5d9fe0e8206$export$722aac194ae923]=$c512c27ab02ef895$export$50c7b4e9d9f19c1($cf1ac5d9fe0e8206$var$POPPER_NAME),[$cf1ac5d9fe0e8206$var$PopperProvider,$cf1ac5d9fe0e8206$var$usePopperContext]=$cf1ac5d9fe0e8206$var$createPopperContext($cf1ac5d9fe0e8206$var$POPPER_NAME),$cf1ac5d9fe0e8206$export$badac9ada3a0bdf9=d=>{const{__scopePopper:g,children:b}=d,[et,st]=reactExports.useState(null);return reactExports.createElement($cf1ac5d9fe0e8206$var$PopperProvider,{scope:g,anchor:et,onAnchorChange:st},b)},$cf1ac5d9fe0e8206$var$ANCHOR_NAME="PopperAnchor",$cf1ac5d9fe0e8206$export$ecd4e1ccab6ed6d=reactExports.forwardRef((d,g)=>{const{__scopePopper:b,virtualRef:et,...st}=d,at=$cf1ac5d9fe0e8206$var$usePopperContext($cf1ac5d9fe0e8206$var$ANCHOR_NAME,b),vt=reactExports.useRef(null),Tt=$6ed0406888f73fc4$export$c7b2cbe3552a0d05(g,vt);return reactExports.useEffect(()=>{at.onAnchorChange((et==null?void 0:et.current)||vt.current)}),et?null:reactExports.createElement($8927f6f2acc4f386$export$250ffa63cdc0d034.div,_extends$1({},st,{ref:Tt}))}),$cf1ac5d9fe0e8206$var$CONTENT_NAME="PopperContent",[$cf1ac5d9fe0e8206$var$PopperContentProvider,$cf1ac5d9fe0e8206$var$useContentContext]=$cf1ac5d9fe0e8206$var$createPopperContext($cf1ac5d9fe0e8206$var$CONTENT_NAME),$cf1ac5d9fe0e8206$export$bc4ae5855d3c4fc=reactExports.forwardRef((d,g)=>{var b,et,st,at,vt,Tt,Ct,pt;const{__scopePopper:wt,side:$t="bottom",sideOffset:Lt=0,align:jt="center",alignOffset:Ft=0,arrowPadding:Gt=0,avoidCollisions:Ht=!0,collisionBoundary:qt=[],collisionPadding:Kt=0,sticky:rr="partial",hideWhenDetached:ir=!1,updatePositionStrategy:or="optimized",onPlaced:jr,...qr}=d,Yr=$cf1ac5d9fe0e8206$var$usePopperContext($cf1ac5d9fe0e8206$var$CONTENT_NAME,wt),[vn,ko]=reactExports.useState(null),Xo=$6ed0406888f73fc4$export$c7b2cbe3552a0d05(g,k0=>ko(k0)),[zo,t0]=reactExports.useState(null),Uo=$db6c3485150b8e66$export$1ab7ae714698c4b8(zo),No=(b=Uo==null?void 0:Uo.width)!==null&&b!==void 0?b:0,_n=(et=Uo==null?void 0:Uo.height)!==null&&et!==void 0?et:0,Kr=$t+(jt!=="center"?"-"+jt:""),e0=typeof Kt=="number"?Kt:{top:0,right:0,bottom:0,left:0,...Kt},Zr=Array.isArray(qt)?qt:[qt],Ro=Zr.length>0,Sn={padding:e0,boundary:Zr.filter($cf1ac5d9fe0e8206$var$isNotNull),altBoundary:Ro},{refs:Tn,floatingStyles:n0,placement:Go,isPositioned:An,middlewareData:a0}=useFloating({strategy:"fixed",placement:Kr,whileElementsMounted:(...k0)=>autoUpdate(...k0,{animationFrame:or==="always"}),elements:{reference:Yr.anchor},middleware:[offset({mainAxis:Lt+_n,alignmentAxis:Ft}),Ht&&shift({mainAxis:!0,crossAxis:!1,limiter:rr==="partial"?limitShift():void 0,...Sn}),Ht&&flip({...Sn}),size({...Sn,apply:({elements:k0,rects:N0,availableWidth:w0,availableHeight:r0})=>{const{width:p0,height:$0}=N0.reference,A0=k0.floating.style;A0.setProperty("--radix-popper-available-width",`${w0}px`),A0.setProperty("--radix-popper-available-height",`${r0}px`),A0.setProperty("--radix-popper-anchor-width",`${p0}px`),A0.setProperty("--radix-popper-anchor-height",`${$0}px`)}}),zo&&arrow({element:zo,padding:Gt}),$cf1ac5d9fe0e8206$var$transformOrigin({arrowWidth:No,arrowHeight:_n}),ir&&hide({strategy:"referenceHidden",...Sn})]}),[u0,d0]=$cf1ac5d9fe0e8206$var$getSideAndAlignFromPlacement(Go),f0=$b1b2314f5f9a1d84$export$25bec8c6f54ee79a(jr);$9f79659886946c16$export$e5c5a5f917a5871c(()=>{An&&(f0==null||f0())},[An,f0]);const y0=(st=a0.arrow)===null||st===void 0?void 0:st.x,b0=(at=a0.arrow)===null||at===void 0?void 0:at.y,O0=((vt=a0.arrow)===null||vt===void 0?void 0:vt.centerOffset)!==0,[C0,v0]=reactExports.useState();return $9f79659886946c16$export$e5c5a5f917a5871c(()=>{vn&&v0(window.getComputedStyle(vn).zIndex)},[vn]),reactExports.createElement("div",{ref:Tn.setFloating,"data-radix-popper-content-wrapper":"",style:{...n0,transform:An?n0.transform:"translate(0, -200%)",minWidth:"max-content",zIndex:C0,"--radix-popper-transform-origin":[(Tt=a0.transformOrigin)===null||Tt===void 0?void 0:Tt.x,(Ct=a0.transformOrigin)===null||Ct===void 0?void 0:Ct.y].join(" ")},dir:d.dir},reactExports.createElement($cf1ac5d9fe0e8206$var$PopperContentProvider,{scope:wt,placedSide:u0,onArrowChange:t0,arrowX:y0,arrowY:b0,shouldHideArrow:O0},reactExports.createElement($8927f6f2acc4f386$export$250ffa63cdc0d034.div,_extends$1({"data-side":u0,"data-align":d0},qr,{ref:Xo,style:{...qr.style,animation:An?void 0:"none",opacity:(pt=a0.hide)!==null&&pt!==void 0&&pt.referenceHidden?0:void 0}}))))}),$cf1ac5d9fe0e8206$var$ARROW_NAME="PopperArrow",$cf1ac5d9fe0e8206$var$OPPOSITE_SIDE={top:"bottom",right:"left",bottom:"top",left:"right"},$cf1ac5d9fe0e8206$export$79d62cd4e10a3fd0=reactExports.forwardRef(function(g,b){const{__scopePopper:et,...st}=g,at=$cf1ac5d9fe0e8206$var$useContentContext($cf1ac5d9fe0e8206$var$ARROW_NAME,et),vt=$cf1ac5d9fe0e8206$var$OPPOSITE_SIDE[at.placedSide];return reactExports.createElement("span",{ref:at.onArrowChange,style:{position:"absolute",left:at.arrowX,top:at.arrowY,[vt]:0,transformOrigin:{top:"",right:"0 0",bottom:"center 0",left:"100% 0"}[at.placedSide],transform:{top:"translateY(100%)",right:"translateY(50%) rotate(90deg) translateX(-50%)",bottom:"rotate(180deg)",left:"translateY(50%) rotate(-90deg) translateX(50%)"}[at.placedSide],visibility:at.shouldHideArrow?"hidden":void 0}},reactExports.createElement($7e8f5cd07187803e$export$be92b6f5f03c0fe9,_extends$1({},st,{ref:b,style:{...st.style,display:"block"}})))});function $cf1ac5d9fe0e8206$var$isNotNull(d){return d!==null}const $cf1ac5d9fe0e8206$var$transformOrigin=d=>({name:"transformOrigin",options:d,fn(g){var b,et,st,at,vt;const{placement:Tt,rects:Ct,middlewareData:pt}=g,$t=((b=pt.arrow)===null||b===void 0?void 0:b.centerOffset)!==0,Lt=$t?0:d.arrowWidth,jt=$t?0:d.arrowHeight,[Ft,Gt]=$cf1ac5d9fe0e8206$var$getSideAndAlignFromPlacement(Tt),Ht={start:"0%",center:"50%",end:"100%"}[Gt],qt=((et=(st=pt.arrow)===null||st===void 0?void 0:st.x)!==null&&et!==void 0?et:0)+Lt/2,Kt=((at=(vt=pt.arrow)===null||vt===void 0?void 0:vt.y)!==null&&at!==void 0?at:0)+jt/2;let rr="",ir="";return Ft==="bottom"?(rr=$t?Ht:`${qt}px`,ir=`${-jt}px`):Ft==="top"?(rr=$t?Ht:`${qt}px`,ir=`${Ct.floating.height+jt}px`):Ft==="right"?(rr=`${-jt}px`,ir=$t?Ht:`${Kt}px`):Ft==="left"&&(rr=`${Ct.floating.width+jt}px`,ir=$t?Ht:`${Kt}px`),{data:{x:rr,y:ir}}}});function $cf1ac5d9fe0e8206$var$getSideAndAlignFromPlacement(d){const[g,b="center"]=d.split("-");return[g,b]}const $cf1ac5d9fe0e8206$export$be92b6f5f03c0fe9=$cf1ac5d9fe0e8206$export$badac9ada3a0bdf9,$cf1ac5d9fe0e8206$export$b688253958b8dfe7=$cf1ac5d9fe0e8206$export$ecd4e1ccab6ed6d,$cf1ac5d9fe0e8206$export$7c6e2c02157bb7d2=$cf1ac5d9fe0e8206$export$bc4ae5855d3c4fc,[$a093c7e1ec25a057$var$createTooltipContext,$a093c7e1ec25a057$export$1c540a2224f0d865]=$c512c27ab02ef895$export$50c7b4e9d9f19c1("Tooltip",[$cf1ac5d9fe0e8206$export$722aac194ae923]),$a093c7e1ec25a057$var$usePopperScope=$cf1ac5d9fe0e8206$export$722aac194ae923(),$a093c7e1ec25a057$var$PROVIDER_NAME="TooltipProvider",$a093c7e1ec25a057$var$DEFAULT_DELAY_DURATION=700,$a093c7e1ec25a057$var$TOOLTIP_OPEN="tooltip.open",[$a093c7e1ec25a057$var$TooltipProviderContextProvider,$a093c7e1ec25a057$var$useTooltipProviderContext]=$a093c7e1ec25a057$var$createTooltipContext($a093c7e1ec25a057$var$PROVIDER_NAME),$a093c7e1ec25a057$export$f78649fb9ca566b8=d=>{const{__scopeTooltip:g,delayDuration:b=$a093c7e1ec25a057$var$DEFAULT_DELAY_DURATION,skipDelayDuration:et=300,disableHoverableContent:st=!1,children:at}=d,[vt,Tt]=reactExports.useState(!0),Ct=reactExports.useRef(!1),pt=reactExports.useRef(0);return reactExports.useEffect(()=>{const wt=pt.current;return()=>window.clearTimeout(wt)},[]),reactExports.createElement($a093c7e1ec25a057$var$TooltipProviderContextProvider,{scope:g,isOpenDelayed:vt,delayDuration:b,onOpen:reactExports.useCallback(()=>{window.clearTimeout(pt.current),Tt(!1)},[]),onClose:reactExports.useCallback(()=>{window.clearTimeout(pt.current),pt.current=window.setTimeout(()=>Tt(!0),et)},[et]),isPointerInTransitRef:Ct,onPointerInTransitChange:reactExports.useCallback(wt=>{Ct.current=wt},[]),disableHoverableContent:st},at)},$a093c7e1ec25a057$var$TOOLTIP_NAME="Tooltip",[$a093c7e1ec25a057$var$TooltipContextProvider,$a093c7e1ec25a057$var$useTooltipContext]=$a093c7e1ec25a057$var$createTooltipContext($a093c7e1ec25a057$var$TOOLTIP_NAME),$a093c7e1ec25a057$export$28c660c63b792dea=d=>{const{__scopeTooltip:g,children:b,open:et,defaultOpen:st=!1,onOpenChange:at,disableHoverableContent:vt,delayDuration:Tt}=d,Ct=$a093c7e1ec25a057$var$useTooltipProviderContext($a093c7e1ec25a057$var$TOOLTIP_NAME,d.__scopeTooltip),pt=$a093c7e1ec25a057$var$usePopperScope(g),[wt,$t]=reactExports.useState(null),Lt=$1746a345f3d73bb7$export$f680877a34711e37(),jt=reactExports.useRef(0),Ft=vt??Ct.disableHoverableContent,Gt=Tt??Ct.delayDuration,Ht=reactExports.useRef(!1),[qt=!1,Kt]=$71cd76cc60e0454e$export$6f32135080cb4c3({prop:et,defaultProp:st,onChange:qr=>{qr?(Ct.onOpen(),document.dispatchEvent(new CustomEvent($a093c7e1ec25a057$var$TOOLTIP_OPEN))):Ct.onClose(),at==null||at(qr)}}),rr=reactExports.useMemo(()=>qt?Ht.current?"delayed-open":"instant-open":"closed",[qt]),ir=reactExports.useCallback(()=>{window.clearTimeout(jt.current),Ht.current=!1,Kt(!0)},[Kt]),or=reactExports.useCallback(()=>{window.clearTimeout(jt.current),Kt(!1)},[Kt]),jr=reactExports.useCallback(()=>{window.clearTimeout(jt.current),jt.current=window.setTimeout(()=>{Ht.current=!0,Kt(!0)},Gt)},[Gt,Kt]);return reactExports.useEffect(()=>()=>window.clearTimeout(jt.current),[]),reactExports.createElement($cf1ac5d9fe0e8206$export$be92b6f5f03c0fe9,pt,reactExports.createElement($a093c7e1ec25a057$var$TooltipContextProvider,{scope:g,contentId:Lt,open:qt,stateAttribute:rr,trigger:wt,onTriggerChange:$t,onTriggerEnter:reactExports.useCallback(()=>{Ct.isOpenDelayed?jr():ir()},[Ct.isOpenDelayed,jr,ir]),onTriggerLeave:reactExports.useCallback(()=>{Ft?or():window.clearTimeout(jt.current)},[or,Ft]),onOpen:ir,onClose:or,disableHoverableContent:Ft},b))},$a093c7e1ec25a057$var$TRIGGER_NAME="TooltipTrigger",$a093c7e1ec25a057$export$8c610744efcf8a1d=reactExports.forwardRef((d,g)=>{const{__scopeTooltip:b,...et}=d,st=$a093c7e1ec25a057$var$useTooltipContext($a093c7e1ec25a057$var$TRIGGER_NAME,b),at=$a093c7e1ec25a057$var$useTooltipProviderContext($a093c7e1ec25a057$var$TRIGGER_NAME,b),vt=$a093c7e1ec25a057$var$usePopperScope(b),Tt=reactExports.useRef(null),Ct=$6ed0406888f73fc4$export$c7b2cbe3552a0d05(g,Tt,st.onTriggerChange),pt=reactExports.useRef(!1),wt=reactExports.useRef(!1),$t=reactExports.useCallback(()=>pt.current=!1,[]);return reactExports.useEffect(()=>()=>document.removeEventListener("pointerup",$t),[$t]),reactExports.createElement($cf1ac5d9fe0e8206$export$b688253958b8dfe7,_extends$1({asChild:!0},vt),reactExports.createElement($8927f6f2acc4f386$export$250ffa63cdc0d034.button,_extends$1({"aria-describedby":st.open?st.contentId:void 0,"data-state":st.stateAttribute},et,{ref:Ct,onPointerMove:$e42e1063c40fb3ef$export$b9ecd428b558ff10(d.onPointerMove,Lt=>{Lt.pointerType!=="touch"&&!wt.current&&!at.isPointerInTransitRef.current&&(st.onTriggerEnter(),wt.current=!0)}),onPointerLeave:$e42e1063c40fb3ef$export$b9ecd428b558ff10(d.onPointerLeave,()=>{st.onTriggerLeave(),wt.current=!1}),onPointerDown:$e42e1063c40fb3ef$export$b9ecd428b558ff10(d.onPointerDown,()=>{pt.current=!0,document.addEventListener("pointerup",$t,{once:!0})}),onFocus:$e42e1063c40fb3ef$export$b9ecd428b558ff10(d.onFocus,()=>{pt.current||st.onOpen()}),onBlur:$e42e1063c40fb3ef$export$b9ecd428b558ff10(d.onBlur,st.onClose),onClick:$e42e1063c40fb3ef$export$b9ecd428b558ff10(d.onClick,st.onClose)})))}),$a093c7e1ec25a057$var$PORTAL_NAME="TooltipPortal",[$a093c7e1ec25a057$var$PortalProvider,$a093c7e1ec25a057$var$usePortalContext]=$a093c7e1ec25a057$var$createTooltipContext($a093c7e1ec25a057$var$PORTAL_NAME,{forceMount:void 0}),$a093c7e1ec25a057$var$CONTENT_NAME="TooltipContent",$a093c7e1ec25a057$export$e9003e2be37ec060=reactExports.forwardRef((d,g)=>{const b=$a093c7e1ec25a057$var$usePortalContext($a093c7e1ec25a057$var$CONTENT_NAME,d.__scopeTooltip),{forceMount:et=b.forceMount,side:st="top",...at}=d,vt=$a093c7e1ec25a057$var$useTooltipContext($a093c7e1ec25a057$var$CONTENT_NAME,d.__scopeTooltip);return reactExports.createElement($921a889cee6df7e8$export$99c2b779aa4e8b8b,{present:et||vt.open},vt.disableHoverableContent?reactExports.createElement($a093c7e1ec25a057$var$TooltipContentImpl,_extends$1({side:st},at,{ref:g})):reactExports.createElement($a093c7e1ec25a057$var$TooltipContentHoverable,_extends$1({side:st},at,{ref:g})))}),$a093c7e1ec25a057$var$TooltipContentHoverable=reactExports.forwardRef((d,g)=>{const b=$a093c7e1ec25a057$var$useTooltipContext($a093c7e1ec25a057$var$CONTENT_NAME,d.__scopeTooltip),et=$a093c7e1ec25a057$var$useTooltipProviderContext($a093c7e1ec25a057$var$CONTENT_NAME,d.__scopeTooltip),st=reactExports.useRef(null),at=$6ed0406888f73fc4$export$c7b2cbe3552a0d05(g,st),[vt,Tt]=reactExports.useState(null),{trigger:Ct,onClose:pt}=b,wt=st.current,{onPointerInTransitChange:$t}=et,Lt=reactExports.useCallback(()=>{Tt(null),$t(!1)},[$t]),jt=reactExports.useCallback((Ft,Gt)=>{const Ht=Ft.currentTarget,qt={x:Ft.clientX,y:Ft.clientY},Kt=$a093c7e1ec25a057$var$getExitSideFromRect(qt,Ht.getBoundingClientRect()),rr=$a093c7e1ec25a057$var$getPaddedExitPoints(qt,Kt),ir=$a093c7e1ec25a057$var$getPointsFromRect(Gt.getBoundingClientRect()),or=$a093c7e1ec25a057$var$getHull([...rr,...ir]);Tt(or),$t(!0)},[$t]);return reactExports.useEffect(()=>()=>Lt(),[Lt]),reactExports.useEffect(()=>{if(Ct&&wt){const Ft=Ht=>jt(Ht,wt),Gt=Ht=>jt(Ht,Ct);return Ct.addEventListener("pointerleave",Ft),wt.addEventListener("pointerleave",Gt),()=>{Ct.removeEventListener("pointerleave",Ft),wt.removeEventListener("pointerleave",Gt)}}},[Ct,wt,jt,Lt]),reactExports.useEffect(()=>{if(vt){const Ft=Gt=>{const Ht=Gt.target,qt={x:Gt.clientX,y:Gt.clientY},Kt=(Ct==null?void 0:Ct.contains(Ht))||(wt==null?void 0:wt.contains(Ht)),rr=!$a093c7e1ec25a057$var$isPointInPolygon(qt,vt);Kt?Lt():rr&&(Lt(),pt())};return document.addEventListener("pointermove",Ft),()=>document.removeEventListener("pointermove",Ft)}},[Ct,wt,vt,pt,Lt]),reactExports.createElement($a093c7e1ec25a057$var$TooltipContentImpl,_extends$1({},d,{ref:at}))}),[$a093c7e1ec25a057$var$VisuallyHiddenContentContextProvider,$a093c7e1ec25a057$var$useVisuallyHiddenContentContext]=$a093c7e1ec25a057$var$createTooltipContext($a093c7e1ec25a057$var$TOOLTIP_NAME,{isInside:!1}),$a093c7e1ec25a057$var$TooltipContentImpl=reactExports.forwardRef((d,g)=>{const{__scopeTooltip:b,children:et,"aria-label":st,onEscapeKeyDown:at,onPointerDownOutside:vt,...Tt}=d,Ct=$a093c7e1ec25a057$var$useTooltipContext($a093c7e1ec25a057$var$CONTENT_NAME,b),pt=$a093c7e1ec25a057$var$usePopperScope(b),{onClose:wt}=Ct;return reactExports.useEffect(()=>(document.addEventListener($a093c7e1ec25a057$var$TOOLTIP_OPEN,wt),()=>document.removeEventListener($a093c7e1ec25a057$var$TOOLTIP_OPEN,wt)),[wt]),reactExports.useEffect(()=>{if(Ct.trigger){const $t=Lt=>{const jt=Lt.target;jt!=null&&jt.contains(Ct.trigger)&&wt()};return window.addEventListener("scroll",$t,{capture:!0}),()=>window.removeEventListener("scroll",$t,{capture:!0})}},[Ct.trigger,wt]),reactExports.createElement($5cb92bef7577960e$export$177fb62ff3ec1f22,{asChild:!0,disableOutsidePointerEvents:!1,onEscapeKeyDown:at,onPointerDownOutside:vt,onFocusOutside:$t=>$t.preventDefault(),onDismiss:wt},reactExports.createElement($cf1ac5d9fe0e8206$export$7c6e2c02157bb7d2,_extends$1({"data-state":Ct.stateAttribute},pt,Tt,{ref:g,style:{...Tt.style,"--radix-tooltip-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-tooltip-content-available-width":"var(--radix-popper-available-width)","--radix-tooltip-content-available-height":"var(--radix-popper-available-height)","--radix-tooltip-trigger-width":"var(--radix-popper-anchor-width)","--radix-tooltip-trigger-height":"var(--radix-popper-anchor-height)"}}),reactExports.createElement($5e63c961fc1ce211$export$d9f1ccf0bdb05d45,null,et),reactExports.createElement($a093c7e1ec25a057$var$VisuallyHiddenContentContextProvider,{scope:b,isInside:!0},reactExports.createElement($ea1ef594cf570d83$export$be92b6f5f03c0fe9,{id:Ct.contentId,role:"tooltip"},st||et))))});function $a093c7e1ec25a057$var$getExitSideFromRect(d,g){const b=Math.abs(g.top-d.y),et=Math.abs(g.bottom-d.y),st=Math.abs(g.right-d.x),at=Math.abs(g.left-d.x);switch(Math.min(b,et,st,at)){case at:return"left";case st:return"right";case b:return"top";case et:return"bottom";default:throw new Error("unreachable")}}function $a093c7e1ec25a057$var$getPaddedExitPoints(d,g,b=5){const et=[];switch(g){case"top":et.push({x:d.x-b,y:d.y+b},{x:d.x+b,y:d.y+b});break;case"bottom":et.push({x:d.x-b,y:d.y-b},{x:d.x+b,y:d.y-b});break;case"left":et.push({x:d.x+b,y:d.y-b},{x:d.x+b,y:d.y+b});break;case"right":et.push({x:d.x-b,y:d.y-b},{x:d.x-b,y:d.y+b});break}return et}function $a093c7e1ec25a057$var$getPointsFromRect(d){const{top:g,right:b,bottom:et,left:st}=d;return[{x:st,y:g},{x:b,y:g},{x:b,y:et},{x:st,y:et}]}function $a093c7e1ec25a057$var$isPointInPolygon(d,g){const{x:b,y:et}=d;let st=!1;for(let at=0,vt=g.length-1;at<g.length;vt=at++){const Tt=g[at].x,Ct=g[at].y,pt=g[vt].x,wt=g[vt].y;Ct>et!=wt>et&&b<(pt-Tt)*(et-Ct)/(wt-Ct)+Tt&&(st=!st)}return st}function $a093c7e1ec25a057$var$getHull(d){const g=d.slice();return g.sort((b,et)=>b.x<et.x?-1:b.x>et.x?1:b.y<et.y?-1:b.y>et.y?1:0),$a093c7e1ec25a057$var$getHullPresorted(g)}function $a093c7e1ec25a057$var$getHullPresorted(d){if(d.length<=1)return d.slice();const g=[];for(let et=0;et<d.length;et++){const st=d[et];for(;g.length>=2;){const at=g[g.length-1],vt=g[g.length-2];if((at.x-vt.x)*(st.y-vt.y)>=(at.y-vt.y)*(st.x-vt.x))g.pop();else break}g.push(st)}g.pop();const b=[];for(let et=d.length-1;et>=0;et--){const st=d[et];for(;b.length>=2;){const at=b[b.length-1],vt=b[b.length-2];if((at.x-vt.x)*(st.y-vt.y)>=(at.y-vt.y)*(st.x-vt.x))b.pop();else break}b.push(st)}return b.pop(),g.length===1&&b.length===1&&g[0].x===b[0].x&&g[0].y===b[0].y?g:g.concat(b)}const $a093c7e1ec25a057$export$2881499e37b75b9a=$a093c7e1ec25a057$export$f78649fb9ca566b8,$a093c7e1ec25a057$export$be92b6f5f03c0fe9=$a093c7e1ec25a057$export$28c660c63b792dea,$a093c7e1ec25a057$export$41fb9f06171c75f4=$a093c7e1ec25a057$export$8c610744efcf8a1d,$a093c7e1ec25a057$export$7c6e2c02157bb7d2=$a093c7e1ec25a057$export$e9003e2be37ec060,TooltipProvider=$a093c7e1ec25a057$export$2881499e37b75b9a,Tooltip=$a093c7e1ec25a057$export$be92b6f5f03c0fe9,TooltipTrigger=$a093c7e1ec25a057$export$41fb9f06171c75f4,TooltipContent=reactExports.forwardRef(({className:d,sideOffset:g=4,...b},et)=>jsxRuntimeExports.jsx($a093c7e1ec25a057$export$7c6e2c02157bb7d2,{ref:et,sideOffset:g,className:cn$1("z-50 border overflow-hidden rounded-md bg-background text-foreground px-3 py-1.5 text-xs animate-in fade-in-0 zoom-in-95 data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=closed]:zoom-out-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",d),...b}));TooltipContent.displayName=$a093c7e1ec25a057$export$7c6e2c02157bb7d2.displayName;const buttonVariants=cva("inline-flex items-center justify-center whitespace-nowrap rounded-md text-sm font-medium transition-colors focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:pointer-events-none disabled:opacity-50",{variants:{variant:{default:"bg-primary text-primary-foreground shadow hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground shadow-sm hover:bg-destructive/90",outline:"border border-input bg-transparent shadow-sm hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground shadow-sm hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-9 px-4 py-2",sm:"h-8 rounded-md px-3 text-xs",lg:"h-10 rounded-md px-8",icon:"h-9 w-9"}},defaultVariants:{variant:"default",size:"default"}}),Button=reactExports.forwardRef(({className:d,variant:g,size:b,asChild:et=!1,...st},at)=>{const vt=et?$5e63c961fc1ce211$export$8c6ed5c666ac1360:"button";return jsxRuntimeExports.jsx(vt,{className:cn$1(buttonVariants({variant:g,size:b,className:d}),"outline-none cursor-default select-none"),ref:at,tabIndex:-1,...st})});Button.displayName="Button";const IconButton=reactExports.forwardRef(({tooltip:d,children:g,...b},et)=>jsxRuntimeExports.jsxs(Tooltip,{children:[jsxRuntimeExports.jsx(TooltipTrigger,{asChild:!0,children:jsxRuntimeExports.jsx(Button,{variant:"ghost",size:"icon",...b,ref:et,tabIndex:-1,className:"cursor-default bg-background",children:jsxRuntimeExports.jsx("div",{className:"icon-button-icon-wrapper",children:g})})}),jsxRuntimeExports.jsx(TooltipContent,{children:jsxRuntimeExports.jsx("p",{children:d})})]})),ImageUploadButton=d=>{const{onFileUpload:g,children:b,...et}=d,[st]=reactExports.useState(`file-upload-${Math.random().toString()}`),at=vt=>{var Ct;const Tt=(Ct=vt.currentTarget.files)==null?void 0:Ct[0];Tt&&g(Tt)};return jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx("label",{htmlFor:st,children:jsxRuntimeExports.jsx(IconButton,{...et,asChild:!0,children:b})}),jsxRuntimeExports.jsx(Input,{style:{display:"none"},id:st,name:st,type:"file",onChange:at,accept:"image/png, image/jpeg"})]})};function useToggle$1(d){const[g,b]=reactExports.useState(()=>d),et=reactExports.useCallback(st=>b(typeof st=="boolean"?st:at=>!at),[]);return[g,et]}const $d3863c46a17e8a28$var$AUTOFOCUS_ON_MOUNT="focusScope.autoFocusOnMount",$d3863c46a17e8a28$var$AUTOFOCUS_ON_UNMOUNT="focusScope.autoFocusOnUnmount",$d3863c46a17e8a28$var$EVENT_OPTIONS={bubbles:!1,cancelable:!0},$d3863c46a17e8a28$export$20e40289641fbbb6=reactExports.forwardRef((d,g)=>{const{loop:b=!1,trapped:et=!1,onMountAutoFocus:st,onUnmountAutoFocus:at,...vt}=d,[Tt,Ct]=reactExports.useState(null),pt=$b1b2314f5f9a1d84$export$25bec8c6f54ee79a(st),wt=$b1b2314f5f9a1d84$export$25bec8c6f54ee79a(at),$t=reactExports.useRef(null),Lt=$6ed0406888f73fc4$export$c7b2cbe3552a0d05(g,Gt=>Ct(Gt)),jt=reactExports.useRef({paused:!1,pause(){this.paused=!0},resume(){this.paused=!1}}).current;reactExports.useEffect(()=>{if(et){let Kt=function(jr){if(jt.paused||!Tt)return;const qr=jr.target;Tt.contains(qr)?$t.current=qr:$d3863c46a17e8a28$var$focus($t.current,{select:!0})},rr=function(jr){if(jt.paused||!Tt)return;const qr=jr.relatedTarget;qr!==null&&(Tt.contains(qr)||$d3863c46a17e8a28$var$focus($t.current,{select:!0}))},ir=function(jr){if(document.activeElement===document.body)for(const Yr of jr)Yr.removedNodes.length>0&&$d3863c46a17e8a28$var$focus(Tt)};var Gt=Kt,Ht=rr,qt=ir;document.addEventListener("focusin",Kt),document.addEventListener("focusout",rr);const or=new MutationObserver(ir);return Tt&&or.observe(Tt,{childList:!0,subtree:!0}),()=>{document.removeEventListener("focusin",Kt),document.removeEventListener("focusout",rr),or.disconnect()}}},[et,Tt,jt.paused]),reactExports.useEffect(()=>{if(Tt){$d3863c46a17e8a28$var$focusScopesStack.add(jt);const Gt=document.activeElement;if(!Tt.contains(Gt)){const qt=new CustomEvent($d3863c46a17e8a28$var$AUTOFOCUS_ON_MOUNT,$d3863c46a17e8a28$var$EVENT_OPTIONS);Tt.addEventListener($d3863c46a17e8a28$var$AUTOFOCUS_ON_MOUNT,pt),Tt.dispatchEvent(qt),qt.defaultPrevented||($d3863c46a17e8a28$var$focusFirst($d3863c46a17e8a28$var$removeLinks($d3863c46a17e8a28$var$getTabbableCandidates(Tt)),{select:!0}),document.activeElement===Gt&&$d3863c46a17e8a28$var$focus(Tt))}return()=>{Tt.removeEventListener($d3863c46a17e8a28$var$AUTOFOCUS_ON_MOUNT,pt),setTimeout(()=>{const qt=new CustomEvent($d3863c46a17e8a28$var$AUTOFOCUS_ON_UNMOUNT,$d3863c46a17e8a28$var$EVENT_OPTIONS);Tt.addEventListener($d3863c46a17e8a28$var$AUTOFOCUS_ON_UNMOUNT,wt),Tt.dispatchEvent(qt),qt.defaultPrevented||$d3863c46a17e8a28$var$focus(Gt??document.body,{select:!0}),Tt.removeEventListener($d3863c46a17e8a28$var$AUTOFOCUS_ON_UNMOUNT,wt),$d3863c46a17e8a28$var$focusScopesStack.remove(jt)},0)}}},[Tt,pt,wt,jt]);const Ft=reactExports.useCallback(Gt=>{if(!b&&!et||jt.paused)return;const Ht=Gt.key==="Tab"&&!Gt.altKey&&!Gt.ctrlKey&&!Gt.metaKey,qt=document.activeElement;if(Ht&&qt){const Kt=Gt.currentTarget,[rr,ir]=$d3863c46a17e8a28$var$getTabbableEdges(Kt);rr&&ir?!Gt.shiftKey&&qt===ir?(Gt.preventDefault(),b&&$d3863c46a17e8a28$var$focus(rr,{select:!0})):Gt.shiftKey&&qt===rr&&(Gt.preventDefault(),b&&$d3863c46a17e8a28$var$focus(ir,{select:!0})):qt===Kt&&Gt.preventDefault()}},[b,et,jt.paused]);return reactExports.createElement($8927f6f2acc4f386$export$250ffa63cdc0d034.div,_extends$1({tabIndex:-1},vt,{ref:Lt,onKeyDown:Ft}))});function $d3863c46a17e8a28$var$focusFirst(d,{select:g=!1}={}){const b=document.activeElement;for(const et of d)if($d3863c46a17e8a28$var$focus(et,{select:g}),document.activeElement!==b)return}function $d3863c46a17e8a28$var$getTabbableEdges(d){const g=$d3863c46a17e8a28$var$getTabbableCandidates(d),b=$d3863c46a17e8a28$var$findVisible(g,d),et=$d3863c46a17e8a28$var$findVisible(g.reverse(),d);return[b,et]}function $d3863c46a17e8a28$var$getTabbableCandidates(d){const g=[],b=document.createTreeWalker(d,NodeFilter.SHOW_ELEMENT,{acceptNode:et=>{const st=et.tagName==="INPUT"&&et.type==="hidden";return et.disabled||et.hidden||st?NodeFilter.FILTER_SKIP:et.tabIndex>=0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});for(;b.nextNode();)g.push(b.currentNode);return g}function $d3863c46a17e8a28$var$findVisible(d,g){for(const b of d)if(!$d3863c46a17e8a28$var$isHidden(b,{upTo:g}))return b}function $d3863c46a17e8a28$var$isHidden(d,{upTo:g}){if(getComputedStyle(d).visibility==="hidden")return!0;for(;d;){if(g!==void 0&&d===g)return!1;if(getComputedStyle(d).display==="none")return!0;d=d.parentElement}return!1}function $d3863c46a17e8a28$var$isSelectableInput(d){return d instanceof HTMLInputElement&&"select"in d}function $d3863c46a17e8a28$var$focus(d,{select:g=!1}={}){if(d&&d.focus){const b=document.activeElement;d.focus({preventScroll:!0}),d!==b&&$d3863c46a17e8a28$var$isSelectableInput(d)&&g&&d.select()}}const $d3863c46a17e8a28$var$focusScopesStack=$d3863c46a17e8a28$var$createFocusScopesStack();function $d3863c46a17e8a28$var$createFocusScopesStack(){let d=[];return{add(g){const b=d[0];g!==b&&(b==null||b.pause()),d=$d3863c46a17e8a28$var$arrayRemove(d,g),d.unshift(g)},remove(g){var b;d=$d3863c46a17e8a28$var$arrayRemove(d,g),(b=d[0])===null||b===void 0||b.resume()}}}function $d3863c46a17e8a28$var$arrayRemove(d,g){const b=[...d],et=b.indexOf(g);return et!==-1&&b.splice(et,1),b}function $d3863c46a17e8a28$var$removeLinks(d){return d.filter(g=>g.tagName!=="A")}let $3db38b7d1fb3fe6a$var$count=0;function $3db38b7d1fb3fe6a$export$b7ece24a22aeda8c(){reactExports.useEffect(()=>{var d,g;const b=document.querySelectorAll("[data-radix-focus-guard]");return document.body.insertAdjacentElement("afterbegin",(d=b[0])!==null&&d!==void 0?d:$3db38b7d1fb3fe6a$var$createFocusGuard()),document.body.insertAdjacentElement("beforeend",(g=b[1])!==null&&g!==void 0?g:$3db38b7d1fb3fe6a$var$createFocusGuard()),$3db38b7d1fb3fe6a$var$count++,()=>{$3db38b7d1fb3fe6a$var$count===1&&document.querySelectorAll("[data-radix-focus-guard]").forEach(et=>et.remove()),$3db38b7d1fb3fe6a$var$count--}},[])}function $3db38b7d1fb3fe6a$var$createFocusGuard(){const d=document.createElement("span");return d.setAttribute("data-radix-focus-guard",""),d.tabIndex=0,d.style.cssText="outline: none; opacity: 0; position: fixed; pointer-events: none",d}var __assign$1=function(){return __assign$1=Object.assign||function(g){for(var b,et=1,st=arguments.length;et<st;et++){b=arguments[et];for(var at in b)Object.prototype.hasOwnProperty.call(b,at)&&(g[at]=b[at])}return g},__assign$1.apply(this,arguments)};function __rest(d,g){var b={};for(var et in d)Object.prototype.hasOwnProperty.call(d,et)&&g.indexOf(et)<0&&(b[et]=d[et]);if(d!=null&&typeof Object.getOwnPropertySymbols=="function")for(var st=0,et=Object.getOwnPropertySymbols(d);st<et.length;st++)g.indexOf(et[st])<0&&Object.prototype.propertyIsEnumerable.call(d,et[st])&&(b[et[st]]=d[et[st]]);return b}function __spreadArray$1(d,g,b){if(b||arguments.length===2)for(var et=0,st=g.length,at;et<st;et++)(at||!(et in g))&&(at||(at=Array.prototype.slice.call(g,0,et)),at[et]=g[et]);return d.concat(at||Array.prototype.slice.call(g))}typeof SuppressedError=="function"&&SuppressedError;var zeroRightClassName="right-scroll-bar-position",fullWidthClassName="width-before-scroll-bar",noScrollbarsClassName="with-scroll-bars-hidden",removedBarSizeVariable="--removed-body-scroll-bar-size";function assignRef(d,g){return typeof d=="function"?d(g):d&&(d.current=g),d}function useCallbackRef(d,g){var b=reactExports.useState(function(){return{value:d,callback:g,facade:{get current(){return b.value},set current(et){var st=b.value;st!==et&&(b.value=et,b.callback(et,st))}}}})[0];return b.callback=g,b.facade}var useIsomorphicLayoutEffect=typeof window<"u"?reactExports.useLayoutEffect:reactExports.useEffect,currentValues=new WeakMap;function useMergeRefs(d,g){var b=useCallbackRef(null,function(et){return d.forEach(function(st){return assignRef(st,et)})});return useIsomorphicLayoutEffect(function(){var et=currentValues.get(b);if(et){var st=new Set(et),at=new Set(d),vt=b.current;st.forEach(function(Tt){at.has(Tt)||assignRef(Tt,null)}),at.forEach(function(Tt){st.has(Tt)||assignRef(Tt,vt)})}currentValues.set(b,d)},[d]),b}function ItoI(d){return d}function innerCreateMedium(d,g){g===void 0&&(g=ItoI);var b=[],et=!1,st={read:function(){if(et)throw new Error("Sidecar: could not `read` from an `assigned` medium. `read` could be used only with `useMedium`.");return b.length?b[b.length-1]:d},useMedium:function(at){var vt=g(at,et);return b.push(vt),function(){b=b.filter(function(Tt){return Tt!==vt})}},assignSyncMedium:function(at){for(et=!0;b.length;){var vt=b;b=[],vt.forEach(at)}b={push:function(Tt){return at(Tt)},filter:function(){return b}}},assignMedium:function(at){et=!0;var vt=[];if(b.length){var Tt=b;b=[],Tt.forEach(at),vt=b}var Ct=function(){var wt=vt;vt=[],wt.forEach(at)},pt=function(){return Promise.resolve().then(Ct)};pt(),b={push:function(wt){vt.push(wt),pt()},filter:function(wt){return vt=vt.filter(wt),b}}}};return st}function createSidecarMedium(d){d===void 0&&(d={});var g=innerCreateMedium(null);return g.options=__assign$1({async:!0,ssr:!1},d),g}var SideCar$1=function(d){var g=d.sideCar,b=__rest(d,["sideCar"]);if(!g)throw new Error("Sidecar: please provide `sideCar` property to import the right car");var et=g.read();if(!et)throw new Error("Sidecar medium not found");return reactExports.createElement(et,__assign$1({},b))};SideCar$1.isSideCarExport=!0;function exportSidecar(d,g){return d.useMedium(g),SideCar$1}var effectCar=createSidecarMedium(),nothing=function(){},RemoveScroll=reactExports.forwardRef(function(d,g){var b=reactExports.useRef(null),et=reactExports.useState({onScrollCapture:nothing,onWheelCapture:nothing,onTouchMoveCapture:nothing}),st=et[0],at=et[1],vt=d.forwardProps,Tt=d.children,Ct=d.className,pt=d.removeScrollBar,wt=d.enabled,$t=d.shards,Lt=d.sideCar,jt=d.noIsolation,Ft=d.inert,Gt=d.allowPinchZoom,Ht=d.as,qt=Ht===void 0?"div":Ht,Kt=__rest(d,["forwardProps","children","className","removeScrollBar","enabled","shards","sideCar","noIsolation","inert","allowPinchZoom","as"]),rr=Lt,ir=useMergeRefs([b,g]),or=__assign$1(__assign$1({},Kt),st);return reactExports.createElement(reactExports.Fragment,null,wt&&reactExports.createElement(rr,{sideCar:effectCar,removeScrollBar:pt,shards:$t,noIsolation:jt,inert:Ft,setCallbacks:at,allowPinchZoom:!!Gt,lockRef:b}),vt?reactExports.cloneElement(reactExports.Children.only(Tt),__assign$1(__assign$1({},or),{ref:ir})):reactExports.createElement(qt,__assign$1({},or,{className:Ct,ref:ir}),Tt))});RemoveScroll.defaultProps={enabled:!0,removeScrollBar:!0,inert:!1};RemoveScroll.classNames={fullWidth:fullWidthClassName,zeroRight:zeroRightClassName};var getNonce=function(){if(typeof __webpack_nonce__<"u")return __webpack_nonce__};function makeStyleTag(){if(!document)return null;var d=document.createElement("style");d.type="text/css";var g=getNonce();return g&&d.setAttribute("nonce",g),d}function injectStyles(d,g){d.styleSheet?d.styleSheet.cssText=g:d.appendChild(document.createTextNode(g))}function insertStyleTag(d){var g=document.head||document.getElementsByTagName("head")[0];g.appendChild(d)}var stylesheetSingleton=function(){var d=0,g=null;return{add:function(b){d==0&&(g=makeStyleTag())&&(injectStyles(g,b),insertStyleTag(g)),d++},remove:function(){d--,!d&&g&&(g.parentNode&&g.parentNode.removeChild(g),g=null)}}},styleHookSingleton=function(){var d=stylesheetSingleton();return function(g,b){reactExports.useEffect(function(){return d.add(g),function(){d.remove()}},[g&&b])}},styleSingleton=function(){var d=styleHookSingleton(),g=function(b){var et=b.styles,st=b.dynamic;return d(et,st),null};return g},zeroGap={left:0,top:0,right:0,gap:0},parse=function(d){return parseInt(d||"",10)||0},getOffset$1=function(d){var g=window.getComputedStyle(document.body),b=g[d==="padding"?"paddingLeft":"marginLeft"],et=g[d==="padding"?"paddingTop":"marginTop"],st=g[d==="padding"?"paddingRight":"marginRight"];return[parse(b),parse(et),parse(st)]},getGapWidth=function(d){if(d===void 0&&(d="margin"),typeof window>"u")return zeroGap;var g=getOffset$1(d),b=document.documentElement.clientWidth,et=window.innerWidth;return{left:g[0],top:g[1],right:g[2],gap:Math.max(0,et-b+g[2]-g[0])}},Style=styleSingleton(),lockAttribute="data-scroll-locked",getStyles=function(d,g,b,et){var st=d.left,at=d.top,vt=d.right,Tt=d.gap;return b===void 0&&(b="margin"),`
  .`.concat(noScrollbarsClassName,` {
   overflow: hidden `).concat(et,`;
   padding-right: `).concat(Tt,"px ").concat(et,`;
  }
  body[`).concat(lockAttribute,`] {
    overflow: hidden `).concat(et,`;
    overscroll-behavior: contain;
    `).concat([g&&"position: relative ".concat(et,";"),b==="margin"&&`
    padding-left: `.concat(st,`px;
    padding-top: `).concat(at,`px;
    padding-right: `).concat(vt,`px;
    margin-left:0;
    margin-top:0;
    margin-right: `).concat(Tt,"px ").concat(et,`;
    `),b==="padding"&&"padding-right: ".concat(Tt,"px ").concat(et,";")].filter(Boolean).join(""),`
  }
  
  .`).concat(zeroRightClassName,` {
    right: `).concat(Tt,"px ").concat(et,`;
  }
  
  .`).concat(fullWidthClassName,` {
    margin-right: `).concat(Tt,"px ").concat(et,`;
  }
  
  .`).concat(zeroRightClassName," .").concat(zeroRightClassName,` {
    right: 0 `).concat(et,`;
  }
  
  .`).concat(fullWidthClassName," .").concat(fullWidthClassName,` {
    margin-right: 0 `).concat(et,`;
  }
  
  body[`).concat(lockAttribute,`] {
    `).concat(removedBarSizeVariable,": ").concat(Tt,`px;
  }
`)},getCurrentUseCounter=function(){var d=parseInt(document.body.getAttribute(lockAttribute)||"0",10);return isFinite(d)?d:0},useLockAttribute=function(){reactExports.useEffect(function(){return document.body.setAttribute(lockAttribute,(getCurrentUseCounter()+1).toString()),function(){var d=getCurrentUseCounter()-1;d<=0?document.body.removeAttribute(lockAttribute):document.body.setAttribute(lockAttribute,d.toString())}},[])},RemoveScrollBar=function(d){var g=d.noRelative,b=d.noImportant,et=d.gapMode,st=et===void 0?"margin":et;useLockAttribute();var at=reactExports.useMemo(function(){return getGapWidth(st)},[st]);return reactExports.createElement(Style,{styles:getStyles(at,!g,st,b?"":"!important")})},passiveSupported$1=!1;if(typeof window<"u")try{var options=Object.defineProperty({},"passive",{get:function(){return passiveSupported$1=!0,!0}});window.addEventListener("test",options,options),window.removeEventListener("test",options,options)}catch{passiveSupported$1=!1}var nonPassive=passiveSupported$1?{passive:!1}:!1,alwaysContainsScroll=function(d){return d.tagName==="TEXTAREA"},elementCanBeScrolled=function(d,g){var b=window.getComputedStyle(d);return b[g]!=="hidden"&&!(b.overflowY===b.overflowX&&!alwaysContainsScroll(d)&&b[g]==="visible")},elementCouldBeVScrolled=function(d){return elementCanBeScrolled(d,"overflowY")},elementCouldBeHScrolled=function(d){return elementCanBeScrolled(d,"overflowX")},locationCouldBeScrolled=function(d,g){var b=g;do{typeof ShadowRoot<"u"&&b instanceof ShadowRoot&&(b=b.host);var et=elementCouldBeScrolled(d,b);if(et){var st=getScrollVariables(d,b),at=st[1],vt=st[2];if(at>vt)return!0}b=b.parentNode}while(b&&b!==document.body);return!1},getVScrollVariables=function(d){var g=d.scrollTop,b=d.scrollHeight,et=d.clientHeight;return[g,b,et]},getHScrollVariables=function(d){var g=d.scrollLeft,b=d.scrollWidth,et=d.clientWidth;return[g,b,et]},elementCouldBeScrolled=function(d,g){return d==="v"?elementCouldBeVScrolled(g):elementCouldBeHScrolled(g)},getScrollVariables=function(d,g){return d==="v"?getVScrollVariables(g):getHScrollVariables(g)},getDirectionFactor=function(d,g){return d==="h"&&g==="rtl"?-1:1},handleScroll=function(d,g,b,et,st){var at=getDirectionFactor(d,window.getComputedStyle(g).direction),vt=at*et,Tt=b.target,Ct=g.contains(Tt),pt=!1,wt=vt>0,$t=0,Lt=0;do{var jt=getScrollVariables(d,Tt),Ft=jt[0],Gt=jt[1],Ht=jt[2],qt=Gt-Ht-at*Ft;(Ft||qt)&&elementCouldBeScrolled(d,Tt)&&($t+=qt,Lt+=Ft),Tt=Tt.parentNode}while(!Ct&&Tt!==document.body||Ct&&(g.contains(Tt)||g===Tt));return(wt&&($t===0||!st)||!wt&&(Lt===0||!st))&&(pt=!0),pt},getTouchXY=function(d){return"changedTouches"in d?[d.changedTouches[0].clientX,d.changedTouches[0].clientY]:[0,0]},getDeltaXY=function(d){return[d.deltaX,d.deltaY]},extractRef=function(d){return d&&"current"in d?d.current:d},deltaCompare=function(d,g){return d[0]===g[0]&&d[1]===g[1]},generateStyle=function(d){return`
  .block-interactivity-`.concat(d,` {pointer-events: none;}
  .allow-interactivity-`).concat(d,` {pointer-events: all;}
`)},idCounter=0,lockStack=[];function RemoveScrollSideCar(d){var g=reactExports.useRef([]),b=reactExports.useRef([0,0]),et=reactExports.useRef(),st=reactExports.useState(idCounter++)[0],at=reactExports.useState(function(){return styleSingleton()})[0],vt=reactExports.useRef(d);reactExports.useEffect(function(){vt.current=d},[d]),reactExports.useEffect(function(){if(d.inert){document.body.classList.add("block-interactivity-".concat(st));var Gt=__spreadArray$1([d.lockRef.current],(d.shards||[]).map(extractRef),!0).filter(Boolean);return Gt.forEach(function(Ht){return Ht.classList.add("allow-interactivity-".concat(st))}),function(){document.body.classList.remove("block-interactivity-".concat(st)),Gt.forEach(function(Ht){return Ht.classList.remove("allow-interactivity-".concat(st))})}}},[d.inert,d.lockRef.current,d.shards]);var Tt=reactExports.useCallback(function(Gt,Ht){if("touches"in Gt&&Gt.touches.length===2)return!vt.current.allowPinchZoom;var qt=getTouchXY(Gt),Kt=b.current,rr="deltaX"in Gt?Gt.deltaX:Kt[0]-qt[0],ir="deltaY"in Gt?Gt.deltaY:Kt[1]-qt[1],or,jr=Gt.target,qr=Math.abs(rr)>Math.abs(ir)?"h":"v";if("touches"in Gt&&qr==="h"&&jr.type==="range")return!1;var Yr=locationCouldBeScrolled(qr,jr);if(!Yr)return!0;if(Yr?or=qr:(or=qr==="v"?"h":"v",Yr=locationCouldBeScrolled(qr,jr)),!Yr)return!1;if(!et.current&&"changedTouches"in Gt&&(rr||ir)&&(et.current=or),!or)return!0;var vn=et.current||or;return handleScroll(vn,Ht,Gt,vn==="h"?rr:ir,!0)},[]),Ct=reactExports.useCallback(function(Gt){var Ht=Gt;if(!(!lockStack.length||lockStack[lockStack.length-1]!==at)){var qt="deltaY"in Ht?getDeltaXY(Ht):getTouchXY(Ht),Kt=g.current.filter(function(or){return or.name===Ht.type&&or.target===Ht.target&&deltaCompare(or.delta,qt)})[0];if(Kt&&Kt.should){Ht.cancelable&&Ht.preventDefault();return}if(!Kt){var rr=(vt.current.shards||[]).map(extractRef).filter(Boolean).filter(function(or){return or.contains(Ht.target)}),ir=rr.length>0?Tt(Ht,rr[0]):!vt.current.noIsolation;ir&&Ht.cancelable&&Ht.preventDefault()}}},[]),pt=reactExports.useCallback(function(Gt,Ht,qt,Kt){var rr={name:Gt,delta:Ht,target:qt,should:Kt};g.current.push(rr),setTimeout(function(){g.current=g.current.filter(function(ir){return ir!==rr})},1)},[]),wt=reactExports.useCallback(function(Gt){b.current=getTouchXY(Gt),et.current=void 0},[]),$t=reactExports.useCallback(function(Gt){pt(Gt.type,getDeltaXY(Gt),Gt.target,Tt(Gt,d.lockRef.current))},[]),Lt=reactExports.useCallback(function(Gt){pt(Gt.type,getTouchXY(Gt),Gt.target,Tt(Gt,d.lockRef.current))},[]);reactExports.useEffect(function(){return lockStack.push(at),d.setCallbacks({onScrollCapture:$t,onWheelCapture:$t,onTouchMoveCapture:Lt}),document.addEventListener("wheel",Ct,nonPassive),document.addEventListener("touchmove",Ct,nonPassive),document.addEventListener("touchstart",wt,nonPassive),function(){lockStack=lockStack.filter(function(Gt){return Gt!==at}),document.removeEventListener("wheel",Ct,nonPassive),document.removeEventListener("touchmove",Ct,nonPassive),document.removeEventListener("touchstart",wt,nonPassive)}},[]);var jt=d.removeScrollBar,Ft=d.inert;return reactExports.createElement(reactExports.Fragment,null,Ft?reactExports.createElement(at,{styles:generateStyle(st)}):null,jt?reactExports.createElement(RemoveScrollBar,{gapMode:"margin"}):null)}const SideCar=exportSidecar(effectCar,RemoveScrollSideCar);var ReactRemoveScroll=reactExports.forwardRef(function(d,g){return reactExports.createElement(RemoveScroll,__assign$1({},d,{ref:g,sideCar:SideCar}))});ReactRemoveScroll.classNames=RemoveScroll.classNames;var getDefaultParent=function(d){if(typeof document>"u")return null;var g=Array.isArray(d)?d[0]:d;return g.ownerDocument.body},counterMap=new WeakMap,uncontrolledNodes=new WeakMap,markerMap={},lockCount=0,unwrapHost=function(d){return d&&(d.host||unwrapHost(d.parentNode))},correctTargets=function(d,g){return g.map(function(b){if(d.contains(b))return b;var et=unwrapHost(b);return et&&d.contains(et)?et:(console.error("aria-hidden",b,"in not contained inside",d,". Doing nothing"),null)}).filter(function(b){return!!b})},applyAttributeToOthers=function(d,g,b,et){var st=correctTargets(g,Array.isArray(d)?d:[d]);markerMap[b]||(markerMap[b]=new WeakMap);var at=markerMap[b],vt=[],Tt=new Set,Ct=new Set(st),pt=function($t){!$t||Tt.has($t)||(Tt.add($t),pt($t.parentNode))};st.forEach(pt);var wt=function($t){!$t||Ct.has($t)||Array.prototype.forEach.call($t.children,function(Lt){if(Tt.has(Lt))wt(Lt);else try{var jt=Lt.getAttribute(et),Ft=jt!==null&&jt!=="false",Gt=(counterMap.get(Lt)||0)+1,Ht=(at.get(Lt)||0)+1;counterMap.set(Lt,Gt),at.set(Lt,Ht),vt.push(Lt),Gt===1&&Ft&&uncontrolledNodes.set(Lt,!0),Ht===1&&Lt.setAttribute(b,"true"),Ft||Lt.setAttribute(et,"true")}catch(qt){console.error("aria-hidden: cannot operate on ",Lt,qt)}})};return wt(g),Tt.clear(),lockCount++,function(){vt.forEach(function($t){var Lt=counterMap.get($t)-1,jt=at.get($t)-1;counterMap.set($t,Lt),at.set($t,jt),Lt||(uncontrolledNodes.has($t)||$t.removeAttribute(et),uncontrolledNodes.delete($t)),jt||$t.removeAttribute(b)}),lockCount--,lockCount||(counterMap=new WeakMap,counterMap=new WeakMap,uncontrolledNodes=new WeakMap,markerMap={})}},hideOthers=function(d,g,b){b===void 0&&(b="data-aria-hidden");var et=Array.from(Array.isArray(d)?d:[d]),st=getDefaultParent(d);return st?(et.push.apply(et,Array.from(st.querySelectorAll("[aria-live]"))),applyAttributeToOthers(et,st,b,"aria-hidden")):function(){return null}};const $5d3850c4d0b4e6c7$var$DIALOG_NAME="Dialog",[$5d3850c4d0b4e6c7$var$createDialogContext,$5d3850c4d0b4e6c7$export$cc702773b8ea3e41]=$c512c27ab02ef895$export$50c7b4e9d9f19c1($5d3850c4d0b4e6c7$var$DIALOG_NAME),[$5d3850c4d0b4e6c7$var$DialogProvider,$5d3850c4d0b4e6c7$var$useDialogContext]=$5d3850c4d0b4e6c7$var$createDialogContext($5d3850c4d0b4e6c7$var$DIALOG_NAME),$5d3850c4d0b4e6c7$export$3ddf2d174ce01153=d=>{const{__scopeDialog:g,children:b,open:et,defaultOpen:st,onOpenChange:at,modal:vt=!0}=d,Tt=reactExports.useRef(null),Ct=reactExports.useRef(null),[pt=!1,wt]=$71cd76cc60e0454e$export$6f32135080cb4c3({prop:et,defaultProp:st,onChange:at});return reactExports.createElement($5d3850c4d0b4e6c7$var$DialogProvider,{scope:g,triggerRef:Tt,contentRef:Ct,contentId:$1746a345f3d73bb7$export$f680877a34711e37(),titleId:$1746a345f3d73bb7$export$f680877a34711e37(),descriptionId:$1746a345f3d73bb7$export$f680877a34711e37(),open:pt,onOpenChange:wt,onOpenToggle:reactExports.useCallback(()=>wt($t=>!$t),[wt]),modal:vt},b)},$5d3850c4d0b4e6c7$var$TRIGGER_NAME="DialogTrigger",$5d3850c4d0b4e6c7$export$2e1e1122cf0cba88=reactExports.forwardRef((d,g)=>{const{__scopeDialog:b,...et}=d,st=$5d3850c4d0b4e6c7$var$useDialogContext($5d3850c4d0b4e6c7$var$TRIGGER_NAME,b),at=$6ed0406888f73fc4$export$c7b2cbe3552a0d05(g,st.triggerRef);return reactExports.createElement($8927f6f2acc4f386$export$250ffa63cdc0d034.button,_extends$1({type:"button","aria-haspopup":"dialog","aria-expanded":st.open,"aria-controls":st.contentId,"data-state":$5d3850c4d0b4e6c7$var$getState(st.open)},et,{ref:at,onClick:$e42e1063c40fb3ef$export$b9ecd428b558ff10(d.onClick,st.onOpenToggle)}))}),$5d3850c4d0b4e6c7$var$PORTAL_NAME="DialogPortal",[$5d3850c4d0b4e6c7$var$PortalProvider,$5d3850c4d0b4e6c7$var$usePortalContext]=$5d3850c4d0b4e6c7$var$createDialogContext($5d3850c4d0b4e6c7$var$PORTAL_NAME,{forceMount:void 0}),$5d3850c4d0b4e6c7$export$dad7c95542bacce0=d=>{const{__scopeDialog:g,forceMount:b,children:et,container:st}=d,at=$5d3850c4d0b4e6c7$var$useDialogContext($5d3850c4d0b4e6c7$var$PORTAL_NAME,g);return reactExports.createElement($5d3850c4d0b4e6c7$var$PortalProvider,{scope:g,forceMount:b},reactExports.Children.map(et,vt=>reactExports.createElement($921a889cee6df7e8$export$99c2b779aa4e8b8b,{present:b||at.open},reactExports.createElement($f1701beae083dbae$export$602eac185826482c,{asChild:!0,container:st},vt))))},$5d3850c4d0b4e6c7$var$OVERLAY_NAME="DialogOverlay",$5d3850c4d0b4e6c7$export$bd1d06c79be19e17=reactExports.forwardRef((d,g)=>{const b=$5d3850c4d0b4e6c7$var$usePortalContext($5d3850c4d0b4e6c7$var$OVERLAY_NAME,d.__scopeDialog),{forceMount:et=b.forceMount,...st}=d,at=$5d3850c4d0b4e6c7$var$useDialogContext($5d3850c4d0b4e6c7$var$OVERLAY_NAME,d.__scopeDialog);return at.modal?reactExports.createElement($921a889cee6df7e8$export$99c2b779aa4e8b8b,{present:et||at.open},reactExports.createElement($5d3850c4d0b4e6c7$var$DialogOverlayImpl,_extends$1({},st,{ref:g}))):null}),$5d3850c4d0b4e6c7$var$DialogOverlayImpl=reactExports.forwardRef((d,g)=>{const{__scopeDialog:b,...et}=d,st=$5d3850c4d0b4e6c7$var$useDialogContext($5d3850c4d0b4e6c7$var$OVERLAY_NAME,b);return reactExports.createElement(ReactRemoveScroll,{as:$5e63c961fc1ce211$export$8c6ed5c666ac1360,allowPinchZoom:!0,shards:[st.contentRef]},reactExports.createElement($8927f6f2acc4f386$export$250ffa63cdc0d034.div,_extends$1({"data-state":$5d3850c4d0b4e6c7$var$getState(st.open)},et,{ref:g,style:{pointerEvents:"auto",...et.style}})))}),$5d3850c4d0b4e6c7$var$CONTENT_NAME="DialogContent",$5d3850c4d0b4e6c7$export$b6d9565de1e068cf=reactExports.forwardRef((d,g)=>{const b=$5d3850c4d0b4e6c7$var$usePortalContext($5d3850c4d0b4e6c7$var$CONTENT_NAME,d.__scopeDialog),{forceMount:et=b.forceMount,...st}=d,at=$5d3850c4d0b4e6c7$var$useDialogContext($5d3850c4d0b4e6c7$var$CONTENT_NAME,d.__scopeDialog);return reactExports.createElement($921a889cee6df7e8$export$99c2b779aa4e8b8b,{present:et||at.open},at.modal?reactExports.createElement($5d3850c4d0b4e6c7$var$DialogContentModal,_extends$1({},st,{ref:g})):reactExports.createElement($5d3850c4d0b4e6c7$var$DialogContentNonModal,_extends$1({},st,{ref:g})))}),$5d3850c4d0b4e6c7$var$DialogContentModal=reactExports.forwardRef((d,g)=>{const b=$5d3850c4d0b4e6c7$var$useDialogContext($5d3850c4d0b4e6c7$var$CONTENT_NAME,d.__scopeDialog),et=reactExports.useRef(null),st=$6ed0406888f73fc4$export$c7b2cbe3552a0d05(g,b.contentRef,et);return reactExports.useEffect(()=>{const at=et.current;if(at)return hideOthers(at)},[]),reactExports.createElement($5d3850c4d0b4e6c7$var$DialogContentImpl,_extends$1({},d,{ref:st,trapFocus:b.open,disableOutsidePointerEvents:!0,onCloseAutoFocus:$e42e1063c40fb3ef$export$b9ecd428b558ff10(d.onCloseAutoFocus,at=>{var vt;at.preventDefault(),(vt=b.triggerRef.current)===null||vt===void 0||vt.focus()}),onPointerDownOutside:$e42e1063c40fb3ef$export$b9ecd428b558ff10(d.onPointerDownOutside,at=>{const vt=at.detail.originalEvent,Tt=vt.button===0&&vt.ctrlKey===!0;(vt.button===2||Tt)&&at.preventDefault()}),onFocusOutside:$e42e1063c40fb3ef$export$b9ecd428b558ff10(d.onFocusOutside,at=>at.preventDefault())}))}),$5d3850c4d0b4e6c7$var$DialogContentNonModal=reactExports.forwardRef((d,g)=>{const b=$5d3850c4d0b4e6c7$var$useDialogContext($5d3850c4d0b4e6c7$var$CONTENT_NAME,d.__scopeDialog),et=reactExports.useRef(!1),st=reactExports.useRef(!1);return reactExports.createElement($5d3850c4d0b4e6c7$var$DialogContentImpl,_extends$1({},d,{ref:g,trapFocus:!1,disableOutsidePointerEvents:!1,onCloseAutoFocus:at=>{var vt;if((vt=d.onCloseAutoFocus)===null||vt===void 0||vt.call(d,at),!at.defaultPrevented){var Tt;et.current||(Tt=b.triggerRef.current)===null||Tt===void 0||Tt.focus(),at.preventDefault()}et.current=!1,st.current=!1},onInteractOutside:at=>{var vt,Tt;(vt=d.onInteractOutside)===null||vt===void 0||vt.call(d,at),at.defaultPrevented||(et.current=!0,at.detail.originalEvent.type==="pointerdown"&&(st.current=!0));const Ct=at.target;((Tt=b.triggerRef.current)===null||Tt===void 0?void 0:Tt.contains(Ct))&&at.preventDefault(),at.detail.originalEvent.type==="focusin"&&st.current&&at.preventDefault()}}))}),$5d3850c4d0b4e6c7$var$DialogContentImpl=reactExports.forwardRef((d,g)=>{const{__scopeDialog:b,trapFocus:et,onOpenAutoFocus:st,onCloseAutoFocus:at,...vt}=d,Tt=$5d3850c4d0b4e6c7$var$useDialogContext($5d3850c4d0b4e6c7$var$CONTENT_NAME,b),Ct=reactExports.useRef(null),pt=$6ed0406888f73fc4$export$c7b2cbe3552a0d05(g,Ct);return $3db38b7d1fb3fe6a$export$b7ece24a22aeda8c(),reactExports.createElement(reactExports.Fragment,null,reactExports.createElement($d3863c46a17e8a28$export$20e40289641fbbb6,{asChild:!0,loop:!0,trapped:et,onMountAutoFocus:st,onUnmountAutoFocus:at},reactExports.createElement($5cb92bef7577960e$export$177fb62ff3ec1f22,_extends$1({role:"dialog",id:Tt.contentId,"aria-describedby":Tt.descriptionId,"aria-labelledby":Tt.titleId,"data-state":$5d3850c4d0b4e6c7$var$getState(Tt.open)},vt,{ref:pt,onDismiss:()=>Tt.onOpenChange(!1)}))),!1)}),$5d3850c4d0b4e6c7$var$TITLE_NAME="DialogTitle",$5d3850c4d0b4e6c7$export$16f7638e4a34b909=reactExports.forwardRef((d,g)=>{const{__scopeDialog:b,...et}=d,st=$5d3850c4d0b4e6c7$var$useDialogContext($5d3850c4d0b4e6c7$var$TITLE_NAME,b);return reactExports.createElement($8927f6f2acc4f386$export$250ffa63cdc0d034.h2,_extends$1({id:st.titleId},et,{ref:g}))}),$5d3850c4d0b4e6c7$var$DESCRIPTION_NAME="DialogDescription",$5d3850c4d0b4e6c7$export$94e94c2ec2c954d5=reactExports.forwardRef((d,g)=>{const{__scopeDialog:b,...et}=d,st=$5d3850c4d0b4e6c7$var$useDialogContext($5d3850c4d0b4e6c7$var$DESCRIPTION_NAME,b);return reactExports.createElement($8927f6f2acc4f386$export$250ffa63cdc0d034.p,_extends$1({id:st.descriptionId},et,{ref:g}))}),$5d3850c4d0b4e6c7$var$CLOSE_NAME="DialogClose",$5d3850c4d0b4e6c7$export$fba2fb7cd781b7ac=reactExports.forwardRef((d,g)=>{const{__scopeDialog:b,...et}=d,st=$5d3850c4d0b4e6c7$var$useDialogContext($5d3850c4d0b4e6c7$var$CLOSE_NAME,b);return reactExports.createElement($8927f6f2acc4f386$export$250ffa63cdc0d034.button,_extends$1({type:"button"},et,{ref:g,onClick:$e42e1063c40fb3ef$export$b9ecd428b558ff10(d.onClick,()=>st.onOpenChange(!1))}))});function $5d3850c4d0b4e6c7$var$getState(d){return d?"open":"closed"}const $5d3850c4d0b4e6c7$var$TITLE_WARNING_NAME="DialogTitleWarning",[$5d3850c4d0b4e6c7$export$69b62a49393917d6,$5d3850c4d0b4e6c7$var$useWarningContext]=$c512c27ab02ef895$export$fd42f52fd3ae1109($5d3850c4d0b4e6c7$var$TITLE_WARNING_NAME,{contentName:$5d3850c4d0b4e6c7$var$CONTENT_NAME,titleName:$5d3850c4d0b4e6c7$var$TITLE_NAME,docsSlug:"dialog"}),$5d3850c4d0b4e6c7$export$be92b6f5f03c0fe9=$5d3850c4d0b4e6c7$export$3ddf2d174ce01153,$5d3850c4d0b4e6c7$export$41fb9f06171c75f4=$5d3850c4d0b4e6c7$export$2e1e1122cf0cba88,$5d3850c4d0b4e6c7$export$602eac185826482c=$5d3850c4d0b4e6c7$export$dad7c95542bacce0,$5d3850c4d0b4e6c7$export$c6fdb837b070b4ff=$5d3850c4d0b4e6c7$export$bd1d06c79be19e17,$5d3850c4d0b4e6c7$export$7c6e2c02157bb7d2=$5d3850c4d0b4e6c7$export$b6d9565de1e068cf,$5d3850c4d0b4e6c7$export$f99233281efd08a0=$5d3850c4d0b4e6c7$export$16f7638e4a34b909,$5d3850c4d0b4e6c7$export$393edc798c47379d=$5d3850c4d0b4e6c7$export$94e94c2ec2c954d5,$5d3850c4d0b4e6c7$export$f39c2d165cd861fe=$5d3850c4d0b4e6c7$export$fba2fb7cd781b7ac,Dialog=$5d3850c4d0b4e6c7$export$be92b6f5f03c0fe9,DialogTrigger=$5d3850c4d0b4e6c7$export$41fb9f06171c75f4,DialogPortal=$5d3850c4d0b4e6c7$export$602eac185826482c,DialogOverlay=reactExports.forwardRef(({className:d,...g},b)=>jsxRuntimeExports.jsx($5d3850c4d0b4e6c7$export$c6fdb837b070b4ff,{ref:b,className:cn$1("fixed inset-0 z-50 bg-background/80 backdrop-blur-sm data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",d),...g}));DialogOverlay.displayName=$5d3850c4d0b4e6c7$export$c6fdb837b070b4ff.displayName;const DialogContent=reactExports.forwardRef(({className:d,children:g,...b},et)=>jsxRuntimeExports.jsxs(DialogPortal,{children:[jsxRuntimeExports.jsx(DialogOverlay,{}),jsxRuntimeExports.jsxs($5d3850c4d0b4e6c7$export$7c6e2c02157bb7d2,{ref:et,className:cn$1("fixed left-[50%] top-[50%] z-50 flex flex-col w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",d,"outline-none"),onCloseAutoFocus:st=>st.preventDefault(),...b,children:[g,jsxRuntimeExports.jsxs($5d3850c4d0b4e6c7$export$f39c2d165cd861fe,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground",children:[jsxRuntimeExports.jsx(Cross2Icon,{className:"h-4 w-4"}),jsxRuntimeExports.jsx("span",{className:"sr-only",children:"Close"})]})]})]}));DialogContent.displayName=$5d3850c4d0b4e6c7$export$7c6e2c02157bb7d2.displayName;const DialogHeader=({className:d,...g})=>jsxRuntimeExports.jsx("div",{className:cn$1("flex flex-col space-y-1.5 text-center sm:text-left",d),...g});DialogHeader.displayName="DialogHeader";const DialogTitle=reactExports.forwardRef(({className:d,...g},b)=>jsxRuntimeExports.jsx($5d3850c4d0b4e6c7$export$f99233281efd08a0,{ref:b,className:cn$1("text-2xl font-semibold leading-none tracking-tight",d),...g}));DialogTitle.displayName=$5d3850c4d0b4e6c7$export$f99233281efd08a0.displayName;const DialogDescription=reactExports.forwardRef(({className:d,...g},b)=>jsxRuntimeExports.jsx($5d3850c4d0b4e6c7$export$393edc798c47379d,{ref:b,className:cn$1("text-sm text-muted-foreground",d),...g}));DialogDescription.displayName=$5d3850c4d0b4e6c7$export$393edc798c47379d.displayName;function _extends(){return _extends=Object.assign?Object.assign.bind():function(d){for(var g=1;g<arguments.length;g++){var b=arguments[g];for(var et in b)Object.prototype.hasOwnProperty.call(b,et)&&(d[et]=b[et])}return d},_extends.apply(this,arguments)}var reservedModifierKeywords=["shift","alt","meta","mod","ctrl"],mappedKeys={esc:"escape",return:"enter",".":"period",",":"comma","-":"slash"," ":"space","`":"backquote","#":"backslash","+":"bracketright",ShiftLeft:"shift",ShiftRight:"shift",AltLeft:"alt",AltRight:"alt",MetaLeft:"meta",MetaRight:"meta",OSLeft:"meta",OSRight:"meta",ControlLeft:"ctrl",ControlRight:"ctrl"};function mapKey(d){return(mappedKeys[d]||d).trim().toLowerCase().replace(/key|digit|numpad|arrow/,"")}function isHotkeyModifier(d){return reservedModifierKeywords.includes(d)}function parseKeysHookInput(d,g){return g===void 0&&(g=","),d.split(g)}function parseHotkey(d,g,b){g===void 0&&(g="+");var et=d.toLocaleLowerCase().split(g).map(function(vt){return mapKey(vt)}),st={alt:et.includes("alt"),ctrl:et.includes("ctrl")||et.includes("control"),shift:et.includes("shift"),meta:et.includes("meta"),mod:et.includes("mod")},at=et.filter(function(vt){return!reservedModifierKeywords.includes(vt)});return _extends({},st,{keys:at,description:b})}(function(){typeof document<"u"&&(document.addEventListener("keydown",function(d){d.key!==void 0&&pushToCurrentlyPressedKeys([mapKey(d.key),mapKey(d.code)])}),document.addEventListener("keyup",function(d){d.key!==void 0&&removeFromCurrentlyPressedKeys([mapKey(d.key),mapKey(d.code)])})),typeof window<"u"&&window.addEventListener("blur",function(){currentlyPressedKeys.clear()})})();var currentlyPressedKeys=new Set;function isReadonlyArray(d){return Array.isArray(d)}function isHotkeyPressed(d,g){g===void 0&&(g=",");var b=isReadonlyArray(d)?d:d.split(g);return b.every(function(et){return currentlyPressedKeys.has(et.trim().toLowerCase())})}function pushToCurrentlyPressedKeys(d){var g=Array.isArray(d)?d:[d];currentlyPressedKeys.has("meta")&&currentlyPressedKeys.forEach(function(b){return!isHotkeyModifier(b)&&currentlyPressedKeys.delete(b.toLowerCase())}),g.forEach(function(b){return currentlyPressedKeys.add(b.toLowerCase())})}function removeFromCurrentlyPressedKeys(d){var g=Array.isArray(d)?d:[d];d==="meta"?currentlyPressedKeys.clear():g.forEach(function(b){return currentlyPressedKeys.delete(b.toLowerCase())})}function maybePreventDefault(d,g,b){(typeof b=="function"&&b(d,g)||b===!0)&&d.preventDefault()}function isHotkeyEnabled(d,g,b){return typeof b=="function"?b(d,g):b===!0||b===void 0}function isKeyboardEventTriggeredByInput(d){return isHotkeyEnabledOnTag(d,["input","textarea","select"])}function isHotkeyEnabledOnTag(d,g){var b=d.target;g===void 0&&(g=!1);var et=b&&b.tagName;return isReadonlyArray(g)?!!(et&&g&&g.some(function(st){return st.toLowerCase()===et.toLowerCase()})):!!(et&&g&&g===!0)}function isScopeActive(d,g){return d.length===0&&g?(console.warn('A hotkey has the "scopes" option set, however no active scopes were found. If you want to use the global scopes feature, you need to wrap your app in a <HotkeysProvider>'),!0):g?d.some(function(b){return g.includes(b)})||d.includes("*"):!0}var isHotkeyMatchingKeyboardEvent=function(g,b,et){et===void 0&&(et=!1);var st=b.alt,at=b.meta,vt=b.mod,Tt=b.shift,Ct=b.ctrl,pt=b.keys,wt=g.key,$t=g.code,Lt=g.ctrlKey,jt=g.metaKey,Ft=g.shiftKey,Gt=g.altKey,Ht=mapKey($t),qt=wt.toLowerCase();if(!(pt!=null&&pt.includes(Ht))&&!(pt!=null&&pt.includes(qt))&&!["ctrl","control","unknown","meta","alt","shift","os"].includes(Ht))return!1;if(!et){if(st===!Gt&&qt!=="alt"||Tt===!Ft&&qt!=="shift")return!1;if(vt){if(!jt&&!Lt)return!1}else if(at===!jt&&qt!=="meta"&&qt!=="os"||Ct===!Lt&&qt!=="ctrl"&&qt!=="control")return!1}return pt&&pt.length===1&&(pt.includes(qt)||pt.includes(Ht))?!0:pt?isHotkeyPressed(pt):!pt},BoundHotkeysProxyProvider=reactExports.createContext(void 0),useBoundHotkeysProxy=function(){return reactExports.useContext(BoundHotkeysProxyProvider)};function deepEqual$1(d,g){return d&&g&&typeof d=="object"&&typeof g=="object"?Object.keys(d).length===Object.keys(g).length&&Object.keys(d).reduce(function(b,et){return b&&deepEqual$1(d[et],g[et])},!0):d===g}var HotkeysContext=reactExports.createContext({hotkeys:[],enabledScopes:[],toggleScope:function(){},enableScope:function(){},disableScope:function(){}}),useHotkeysContext=function(){return reactExports.useContext(HotkeysContext)};function useDeepEqualMemo(d){var g=reactExports.useRef(void 0);return deepEqual$1(g.current,d)||(g.current=d),g.current}var stopPropagation=function(g){g.stopPropagation(),g.preventDefault(),g.stopImmediatePropagation()},useSafeLayoutEffect=typeof window<"u"?reactExports.useLayoutEffect:reactExports.useEffect;function useHotkeys(d,g,b,et){var st=reactExports.useRef(null),at=reactExports.useRef(!1),vt=b instanceof Array?et instanceof Array?void 0:et:b,Tt=isReadonlyArray(d)?d.join(vt==null?void 0:vt.splitKey):d,Ct=b instanceof Array?b:et instanceof Array?et:void 0,pt=reactExports.useCallback(g,Ct??[]),wt=reactExports.useRef(pt);Ct?wt.current=pt:wt.current=g;var $t=useDeepEqualMemo(vt),Lt=useHotkeysContext(),jt=Lt.enabledScopes,Ft=useBoundHotkeysProxy();return useSafeLayoutEffect(function(){if(!(($t==null?void 0:$t.enabled)===!1||!isScopeActive(jt,$t==null?void 0:$t.scopes))){var Gt=function(ir,or){var jr;if(or===void 0&&(or=!1),!(isKeyboardEventTriggeredByInput(ir)&&!isHotkeyEnabledOnTag(ir,$t==null?void 0:$t.enableOnFormTags))){if(st.current!==null){var qr=st.current.getRootNode();if((qr instanceof Document||qr instanceof ShadowRoot)&&qr.activeElement!==st.current&&!st.current.contains(qr.activeElement)){stopPropagation(ir);return}}(jr=ir.target)!=null&&jr.isContentEditable&&!($t!=null&&$t.enableOnContentEditable)||parseKeysHookInput(Tt,$t==null?void 0:$t.splitKey).forEach(function(Yr){var vn,ko=parseHotkey(Yr,$t==null?void 0:$t.combinationKey);if(isHotkeyMatchingKeyboardEvent(ir,ko,$t==null?void 0:$t.ignoreModifiers)||(vn=ko.keys)!=null&&vn.includes("*")){if($t!=null&&$t.ignoreEventWhen!=null&&$t.ignoreEventWhen(ir)||or&&at.current)return;if(maybePreventDefault(ir,ko,$t==null?void 0:$t.preventDefault),!isHotkeyEnabled(ir,ko,$t==null?void 0:$t.enabled)){stopPropagation(ir);return}wt.current(ir,ko),or||(at.current=!0)}})}},Ht=function(ir){ir.key!==void 0&&(pushToCurrentlyPressedKeys(mapKey(ir.code)),(($t==null?void 0:$t.keydown)===void 0&&($t==null?void 0:$t.keyup)!==!0||$t!=null&&$t.keydown)&&Gt(ir))},qt=function(ir){ir.key!==void 0&&(removeFromCurrentlyPressedKeys(mapKey(ir.code)),at.current=!1,$t!=null&&$t.keyup&&Gt(ir,!0))},Kt=st.current||(vt==null?void 0:vt.document)||document;return Kt.addEventListener("keyup",qt),Kt.addEventListener("keydown",Ht),Ft&&parseKeysHookInput(Tt,$t==null?void 0:$t.splitKey).forEach(function(rr){return Ft.addHotkey(parseHotkey(rr,$t==null?void 0:$t.combinationKey,$t==null?void 0:$t.description))}),function(){Kt.removeEventListener("keyup",qt),Kt.removeEventListener("keydown",Ht),Ft&&parseKeysHookInput(Tt,$t==null?void 0:$t.splitKey).forEach(function(rr){return Ft.removeHotkey(parseHotkey(rr,$t==null?void 0:$t.combinationKey,$t==null?void 0:$t.description))})}}},[Tt,$t,jt]),st}const useHotKey=(d,g,b)=>{const et=useStore(at=>at.disableShortCuts);return useHotkeys(d,g,{enabled:!et},b)};function warn(){if(console&&console.warn){for(var d=arguments.length,g=new Array(d),b=0;b<d;b++)g[b]=arguments[b];typeof g[0]=="string"&&(g[0]=`react-i18next:: ${g[0]}`),console.warn(...g)}}const alreadyWarned={};function warnOnce(){for(var d=arguments.length,g=new Array(d),b=0;b<d;b++)g[b]=arguments[b];typeof g[0]=="string"&&alreadyWarned[g[0]]||(typeof g[0]=="string"&&(alreadyWarned[g[0]]=new Date),warn(...g))}const loadedClb=(d,g)=>()=>{if(d.isInitialized)g();else{const b=()=>{setTimeout(()=>{d.off("initialized",b)},0),g()};d.on("initialized",b)}};function loadNamespaces(d,g,b){d.loadNamespaces(g,loadedClb(d,b))}function loadLanguages(d,g,b,et){typeof b=="string"&&(b=[b]),b.forEach(st=>{d.options.ns.indexOf(st)<0&&d.options.ns.push(st)}),d.loadLanguages(g,loadedClb(d,et))}function oldI18nextHasLoadedNamespace(d,g){let b=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};const et=g.languages[0],st=g.options?g.options.fallbackLng:!1,at=g.languages[g.languages.length-1];if(et.toLowerCase()==="cimode")return!0;const vt=(Tt,Ct)=>{const pt=g.services.backendConnector.state[`${Tt}|${Ct}`];return pt===-1||pt===2};return b.bindI18n&&b.bindI18n.indexOf("languageChanging")>-1&&g.services.backendConnector.backend&&g.isLanguageChangingTo&&!vt(g.isLanguageChangingTo,d)?!1:!!(g.hasResourceBundle(et,d)||!g.services.backendConnector.backend||g.options.resources&&!g.options.partialBundledLanguages||vt(et,d)&&(!st||vt(at,d)))}function hasLoadedNamespace(d,g){let b=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return!g.languages||!g.languages.length?(warnOnce("i18n.languages were undefined or empty",g.languages),!0):g.options.ignoreJSONStructure!==void 0?g.hasLoadedNamespace(d,{lng:b.lng,precheck:(st,at)=>{if(b.bindI18n&&b.bindI18n.indexOf("languageChanging")>-1&&st.services.backendConnector.backend&&st.isLanguageChangingTo&&!at(st.isLanguageChangingTo,d))return!1}}):oldI18nextHasLoadedNamespace(d,g,b)}const matchHtmlEntity=/&(?:amp|#38|lt|#60|gt|#62|apos|#39|quot|#34|nbsp|#160|copy|#169|reg|#174|hellip|#8230|#x2F|#47);/g,htmlEntities={"&amp;":"&","&#38;":"&","&lt;":"<","&#60;":"<","&gt;":">","&#62;":">","&apos;":"'","&#39;":"'","&quot;":'"',"&#34;":'"',"&nbsp;":" ","&#160;":" ","&copy;":"","&#169;":"","&reg;":"","&#174;":"","&hellip;":"","&#8230;":"","&#x2F;":"/","&#47;":"/"},unescapeHtmlEntity=d=>htmlEntities[d],unescape$1=d=>d.replace(matchHtmlEntity,unescapeHtmlEntity);let defaultOptions$1={bindI18n:"languageChanged",bindI18nStore:"",transEmptyNodeValue:"",transSupportBasicHtmlNodes:!0,transWrapTextNodes:"",transKeepBasicHtmlNodesFor:["br","strong","i","p"],useSuspense:!0,unescape:unescape$1};function setDefaults(){let d=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};defaultOptions$1={...defaultOptions$1,...d}}function getDefaults$1(){return defaultOptions$1}let i18nInstance;function setI18n(d){i18nInstance=d}function getI18n(){return i18nInstance}const initReactI18next={type:"3rdParty",init(d){setDefaults(d.options.react),setI18n(d)}},I18nContext=reactExports.createContext();class ReportNamespaces{constructor(){this.usedNamespaces={}}addUsedNamespaces(g){g.forEach(b=>{this.usedNamespaces[b]||(this.usedNamespaces[b]=!0)})}getUsedNamespaces(){return Object.keys(this.usedNamespaces)}}const usePrevious=(d,g)=>{const b=reactExports.useRef();return reactExports.useEffect(()=>{b.current=d},[d,g]),b.current};function alwaysNewT(d,g,b,et){return d.getFixedT(g,b,et)}function useMemoizedT(d,g,b,et){return reactExports.useCallback(alwaysNewT(d,g,b,et),[d,g,b,et])}function useTranslation(d){let g=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const{i18n:b}=g,{i18n:et,defaultNS:st}=reactExports.useContext(I18nContext)||{},at=b||et||getI18n();if(at&&!at.reportNamespaces&&(at.reportNamespaces=new ReportNamespaces),!at){warnOnce("You will need to pass in an i18next instance by using initReactI18next");const ir=(jr,qr)=>typeof qr=="string"?qr:qr&&typeof qr=="object"&&typeof qr.defaultValue=="string"?qr.defaultValue:Array.isArray(jr)?jr[jr.length-1]:jr,or=[ir,{},!1];return or.t=ir,or.i18n={},or.ready=!1,or}at.options.react&&at.options.react.wait!==void 0&&warnOnce("It seems you are still using the old wait option, you may migrate to the new useSuspense behaviour.");const vt={...getDefaults$1(),...at.options.react,...g},{useSuspense:Tt,keyPrefix:Ct}=vt;let pt=st||at.options&&at.options.defaultNS;pt=typeof pt=="string"?[pt]:pt||["translation"],at.reportNamespaces.addUsedNamespaces&&at.reportNamespaces.addUsedNamespaces(pt);const wt=(at.isInitialized||at.initializedStoreOnce)&&pt.every(ir=>hasLoadedNamespace(ir,at,vt)),$t=useMemoizedT(at,g.lng||null,vt.nsMode==="fallback"?pt:pt[0],Ct),Lt=()=>$t,jt=()=>alwaysNewT(at,g.lng||null,vt.nsMode==="fallback"?pt:pt[0],Ct),[Ft,Gt]=reactExports.useState(Lt);let Ht=pt.join();g.lng&&(Ht=`${g.lng}${Ht}`);const qt=usePrevious(Ht),Kt=reactExports.useRef(!0);reactExports.useEffect(()=>{const{bindI18n:ir,bindI18nStore:or}=vt;Kt.current=!0,!wt&&!Tt&&(g.lng?loadLanguages(at,g.lng,pt,()=>{Kt.current&&Gt(jt)}):loadNamespaces(at,pt,()=>{Kt.current&&Gt(jt)})),wt&&qt&&qt!==Ht&&Kt.current&&Gt(jt);function jr(){Kt.current&&Gt(jt)}return ir&&at&&at.on(ir,jr),or&&at&&at.store.on(or,jr),()=>{Kt.current=!1,ir&&at&&ir.split(" ").forEach(qr=>at.off(qr,jr)),or&&at&&or.split(" ").forEach(qr=>at.store.off(qr,jr))}},[at,Ht]),reactExports.useEffect(()=>{Kt.current&&wt&&Gt(Lt)},[at,Ct,wt]);const rr=[Ft,at,wt];if(rr.t=Ft,rr.i18n=at,rr.ready=wt,wt||!wt&&!Tt)return rr;throw new Promise(ir=>{g.lng?loadLanguages(at,g.lng,pt,()=>ir()):loadNamespaces(at,pt,()=>ir())})}function ShortCut(d){const{content:g,keys:b}=d;return jsxRuntimeExports.jsxs("div",{className:"flex justify-between",children:[jsxRuntimeExports.jsx("div",{children:g}),jsxRuntimeExports.jsx("div",{className:"flex gap-[8px]",children:b.map(et=>jsxRuntimeExports.jsx("div",{className:"border px-2 py-1 rounded-lg",children:et},et))})]})}const isMac=function(){return/macintosh|mac os x/i.test(navigator.userAgent)},CmdOrCtrl=()=>isMac()?"Cmd":"Ctrl";function Shortcuts(){const[d,g]=useToggle$1(!1),{t:b}=useTranslation();return useHotKey("h",()=>{g()}),jsxRuntimeExports.jsxs(Dialog,{open:d,onOpenChange:g,children:[jsxRuntimeExports.jsx(DialogTrigger,{asChild:!0,children:jsxRuntimeExports.jsx(IconButton,{tooltip:"Hotkeys",children:jsxRuntimeExports.jsx(Keyboard,{})})}),jsxRuntimeExports.jsx(DialogContent,{children:jsxRuntimeExports.jsxs(DialogHeader,{children:[jsxRuntimeExports.jsx(DialogTitle,{children:"Hotkeys"}),jsxRuntimeExports.jsxs("div",{className:"flex gap-2 flex-col pt-4",children:[jsxRuntimeExports.jsx(ShortCut,{content:b("Pan"),keys:["Space + Drag"]}),jsxRuntimeExports.jsx(ShortCut,{content:b("Reset Zoom/Pan"),keys:["Esc"]}),jsxRuntimeExports.jsx(ShortCut,{content:b("Decrease Brush Size"),keys:["["]}),jsxRuntimeExports.jsx(ShortCut,{content:b("Increase Brush Size"),keys:["]"]}),jsxRuntimeExports.jsx(ShortCut,{content:b("View Original Image"),keys:["Hold Tab"]}),jsxRuntimeExports.jsx(ShortCut,{content:b("Undo"),keys:[CmdOrCtrl(),"Z"]}),jsxRuntimeExports.jsx(ShortCut,{content:b("Redo"),keys:[CmdOrCtrl(),"Shift","Z"]}),jsxRuntimeExports.jsx(ShortCut,{content:b("Copy Result"),keys:[CmdOrCtrl(),"C"]}),jsxRuntimeExports.jsx(ShortCut,{content:b("Paste Image"),keys:[CmdOrCtrl(),"V"]}),jsxRuntimeExports.jsx(ShortCut,{content:b("Trigger Manually Inpainting"),keys:["Shift","R"]}),jsxRuntimeExports.jsx(ShortCut,{content:b("Toggle Hotkeys Dialog"),keys:["H"]}),jsxRuntimeExports.jsx(ShortCut,{content:b("Toggle Settings Dialog"),keys:["S"]}),jsxRuntimeExports.jsx(ShortCut,{content:b("Toggle File Manager"),keys:["F"]})]})]})})]})}var isCheckBoxInput=d=>d.type==="checkbox",isDateObject=d=>d instanceof Date,isNullOrUndefined=d=>d==null;const isObjectType=d=>typeof d=="object";var isObject=d=>!isNullOrUndefined(d)&&!Array.isArray(d)&&isObjectType(d)&&!isDateObject(d),getEventValue=d=>isObject(d)&&d.target?isCheckBoxInput(d.target)?d.target.checked:d.target.value:d,getNodeParentName=d=>d.substring(0,d.search(/\.\d+(\.|$)/))||d,isNameInFieldArray=(d,g)=>d.has(getNodeParentName(g)),isPlainObject=d=>{const g=d.constructor&&d.constructor.prototype;return isObject(g)&&g.hasOwnProperty("isPrototypeOf")},isWeb=typeof window<"u"&&typeof window.HTMLElement<"u"&&typeof document<"u";function cloneObject(d){let g;const b=Array.isArray(d);if(d instanceof Date)g=new Date(d);else if(d instanceof Set)g=new Set(d);else if(!(isWeb&&(d instanceof Blob||d instanceof FileList))&&(b||isObject(d)))if(g=b?[]:{},!b&&!isPlainObject(d))g=d;else for(const et in d)d.hasOwnProperty(et)&&(g[et]=cloneObject(d[et]));else return d;return g}var compact=d=>Array.isArray(d)?d.filter(Boolean):[],isUndefined=d=>d===void 0,get$1=(d,g,b)=>{if(!g||!isObject(d))return b;const et=compact(g.split(/[,[\].]+?/)).reduce((st,at)=>isNullOrUndefined(st)?st:st[at],d);return isUndefined(et)||et===d?isUndefined(d[g])?b:d[g]:et},isBoolean=d=>typeof d=="boolean";const EVENTS={BLUR:"blur",FOCUS_OUT:"focusout",CHANGE:"change"},VALIDATION_MODE={onBlur:"onBlur",onChange:"onChange",onSubmit:"onSubmit",onTouched:"onTouched",all:"all"},INPUT_VALIDATION_RULES={max:"max",min:"min",maxLength:"maxLength",minLength:"minLength",pattern:"pattern",required:"required",validate:"validate"},HookFormContext=React.createContext(null),useFormContext=()=>React.useContext(HookFormContext),FormProvider=d=>{const{children:g,...b}=d;return React.createElement(HookFormContext.Provider,{value:b},g)};var getProxyFormState=(d,g,b,et=!0)=>{const st={defaultValues:g._defaultValues};for(const at in d)Object.defineProperty(st,at,{get:()=>{const vt=at;return g._proxyFormState[vt]!==VALIDATION_MODE.all&&(g._proxyFormState[vt]=!et||VALIDATION_MODE.all),b&&(b[vt]=!0),d[vt]}});return st},isEmptyObject=d=>isObject(d)&&!Object.keys(d).length,shouldRenderFormState=(d,g,b,et)=>{b(d);const{name:st,...at}=d;return isEmptyObject(at)||Object.keys(at).length>=Object.keys(g).length||Object.keys(at).find(vt=>g[vt]===(!et||VALIDATION_MODE.all))},convertToArrayPayload=d=>Array.isArray(d)?d:[d],shouldSubscribeByName=(d,g,b)=>!d||!g||d===g||convertToArrayPayload(d).some(et=>et&&(b?et===g:et.startsWith(g)||g.startsWith(et)));function useSubscribe(d){const g=React.useRef(d);g.current=d,React.useEffect(()=>{const b=!d.disabled&&g.current.subject&&g.current.subject.subscribe({next:g.current.next});return()=>{b&&b.unsubscribe()}},[d.disabled])}function useFormState(d){const g=useFormContext(),{control:b=g.control,disabled:et,name:st,exact:at}=d||{},[vt,Tt]=React.useState(b._formState),Ct=React.useRef(!0),pt=React.useRef({isDirty:!1,isLoading:!1,dirtyFields:!1,touchedFields:!1,validatingFields:!1,isValidating:!1,isValid:!1,errors:!1}),wt=React.useRef(st);return wt.current=st,useSubscribe({disabled:et,next:$t=>Ct.current&&shouldSubscribeByName(wt.current,$t.name,at)&&shouldRenderFormState($t,pt.current,b._updateFormState)&&Tt({...b._formState,...$t}),subject:b._subjects.state}),React.useEffect(()=>(Ct.current=!0,pt.current.isValid&&b._updateValid(!0),()=>{Ct.current=!1}),[b]),getProxyFormState(vt,b,pt.current,!1)}var isString=d=>typeof d=="string",generateWatchOutput=(d,g,b,et,st)=>isString(d)?(et&&g.watch.add(d),get$1(b,d,st)):Array.isArray(d)?d.map(at=>(et&&g.watch.add(at),get$1(b,at))):(et&&(g.watchAll=!0),b);function useWatch(d){const g=useFormContext(),{control:b=g.control,name:et,defaultValue:st,disabled:at,exact:vt}=d||{},Tt=React.useRef(et);Tt.current=et,useSubscribe({disabled:at,subject:b._subjects.values,next:wt=>{shouldSubscribeByName(Tt.current,wt.name,vt)&&pt(cloneObject(generateWatchOutput(Tt.current,b._names,wt.values||b._formValues,!1,st)))}});const[Ct,pt]=React.useState(b._getWatch(et,st));return React.useEffect(()=>b._removeUnmounted()),Ct}var isKey=d=>/^\w*$/.test(d),stringToPath=d=>compact(d.replace(/["|']|\]/g,"").split(/\.|\[/)),set=(d,g,b)=>{let et=-1;const st=isKey(g)?[g]:stringToPath(g),at=st.length,vt=at-1;for(;++et<at;){const Tt=st[et];let Ct=b;if(et!==vt){const pt=d[Tt];Ct=isObject(pt)||Array.isArray(pt)?pt:isNaN(+st[et+1])?{}:[]}d[Tt]=Ct,d=d[Tt]}return d};function useController(d){const g=useFormContext(),{name:b,disabled:et,control:st=g.control,shouldUnregister:at}=d,vt=isNameInFieldArray(st._names.array,b),Tt=useWatch({control:st,name:b,defaultValue:get$1(st._formValues,b,get$1(st._defaultValues,b,d.defaultValue)),exact:!0}),Ct=useFormState({control:st,name:b}),pt=React.useRef(st.register(b,{...d.rules,value:Tt,...isBoolean(d.disabled)?{disabled:d.disabled}:{}}));return React.useEffect(()=>{const wt=st._options.shouldUnregister||at,$t=(Lt,jt)=>{const Ft=get$1(st._fields,Lt);Ft&&(Ft._f.mount=jt)};if($t(b,!0),wt){const Lt=cloneObject(get$1(st._options.defaultValues,b));set(st._defaultValues,b,Lt),isUndefined(get$1(st._formValues,b))&&set(st._formValues,b,Lt)}return()=>{(vt?wt&&!st._state.action:wt)?st.unregister(b):$t(b,!1)}},[b,st,vt,at]),React.useEffect(()=>{get$1(st._fields,b)&&st._updateDisabledField({disabled:et,fields:st._fields,name:b,value:get$1(st._fields,b)._f.value})},[et,b,st]),{field:{name:b,value:Tt,...isBoolean(et)||Ct.disabled?{disabled:Ct.disabled||et}:{},onChange:React.useCallback(wt=>pt.current.onChange({target:{value:getEventValue(wt),name:b},type:EVENTS.CHANGE}),[b]),onBlur:React.useCallback(()=>pt.current.onBlur({target:{value:get$1(st._formValues,b),name:b},type:EVENTS.BLUR}),[b,st]),ref:wt=>{const $t=get$1(st._fields,b);$t&&wt&&($t._f.ref={focus:()=>wt.focus(),select:()=>wt.select(),setCustomValidity:Lt=>wt.setCustomValidity(Lt),reportValidity:()=>wt.reportValidity()})}},formState:Ct,fieldState:Object.defineProperties({},{invalid:{enumerable:!0,get:()=>!!get$1(Ct.errors,b)},isDirty:{enumerable:!0,get:()=>!!get$1(Ct.dirtyFields,b)},isTouched:{enumerable:!0,get:()=>!!get$1(Ct.touchedFields,b)},isValidating:{enumerable:!0,get:()=>!!get$1(Ct.validatingFields,b)},error:{enumerable:!0,get:()=>get$1(Ct.errors,b)}})}}const Controller=d=>d.render(useController(d));var appendErrors=(d,g,b,et,st)=>g?{...b[d],types:{...b[d]&&b[d].types?b[d].types:{},[et]:st||!0}}:{},getValidationModes=d=>({isOnSubmit:!d||d===VALIDATION_MODE.onSubmit,isOnBlur:d===VALIDATION_MODE.onBlur,isOnChange:d===VALIDATION_MODE.onChange,isOnAll:d===VALIDATION_MODE.all,isOnTouch:d===VALIDATION_MODE.onTouched}),isWatched=(d,g,b)=>!b&&(g.watchAll||g.watch.has(d)||[...g.watch].some(et=>d.startsWith(et)&&/^\.\w+/.test(d.slice(et.length))));const iterateFieldsByAction=(d,g,b,et)=>{for(const st of b||Object.keys(d)){const at=get$1(d,st);if(at){const{_f:vt,...Tt}=at;if(vt){if(vt.refs&&vt.refs[0]&&g(vt.refs[0],st)&&!et)break;if(vt.ref&&g(vt.ref,vt.name)&&!et)break;iterateFieldsByAction(Tt,g)}else isObject(Tt)&&iterateFieldsByAction(Tt,g)}}};var updateFieldArrayRootError=(d,g,b)=>{const et=compact(get$1(d,b));return set(et,"root",g[b]),set(d,b,et),d},isFileInput=d=>d.type==="file",isFunction=d=>typeof d=="function",isHTMLElement=d=>{if(!isWeb)return!1;const g=d?d.ownerDocument:0;return d instanceof(g&&g.defaultView?g.defaultView.HTMLElement:HTMLElement)},isMessage=d=>isString(d),isRadioInput=d=>d.type==="radio",isRegex=d=>d instanceof RegExp;const defaultResult={value:!1,isValid:!1},validResult={value:!0,isValid:!0};var getCheckboxValue=d=>{if(Array.isArray(d)){if(d.length>1){const g=d.filter(b=>b&&b.checked&&!b.disabled).map(b=>b.value);return{value:g,isValid:!!g.length}}return d[0].checked&&!d[0].disabled?d[0].attributes&&!isUndefined(d[0].attributes.value)?isUndefined(d[0].value)||d[0].value===""?validResult:{value:d[0].value,isValid:!0}:validResult:defaultResult}return defaultResult};const defaultReturn={isValid:!1,value:null};var getRadioValue=d=>Array.isArray(d)?d.reduce((g,b)=>b&&b.checked&&!b.disabled?{isValid:!0,value:b.value}:g,defaultReturn):defaultReturn;function getValidateError(d,g,b="validate"){if(isMessage(d)||Array.isArray(d)&&d.every(isMessage)||isBoolean(d)&&!d)return{type:b,message:isMessage(d)?d:"",ref:g}}var getValueAndMessage=d=>isObject(d)&&!isRegex(d)?d:{value:d,message:""},validateField=async(d,g,b,et,st)=>{const{ref:at,refs:vt,required:Tt,maxLength:Ct,minLength:pt,min:wt,max:$t,pattern:Lt,validate:jt,name:Ft,valueAsNumber:Gt,mount:Ht,disabled:qt}=d._f,Kt=get$1(g,Ft);if(!Ht||qt)return{};const rr=vt?vt[0]:at,ir=zo=>{et&&rr.reportValidity&&(rr.setCustomValidity(isBoolean(zo)?"":zo||""),rr.reportValidity())},or={},jr=isRadioInput(at),qr=isCheckBoxInput(at),Yr=jr||qr,vn=(Gt||isFileInput(at))&&isUndefined(at.value)&&isUndefined(Kt)||isHTMLElement(at)&&at.value===""||Kt===""||Array.isArray(Kt)&&!Kt.length,ko=appendErrors.bind(null,Ft,b,or),Xo=(zo,t0,Uo,No=INPUT_VALIDATION_RULES.maxLength,_n=INPUT_VALIDATION_RULES.minLength)=>{const Kr=zo?t0:Uo;or[Ft]={type:zo?No:_n,message:Kr,ref:at,...ko(zo?No:_n,Kr)}};if(st?!Array.isArray(Kt)||!Kt.length:Tt&&(!Yr&&(vn||isNullOrUndefined(Kt))||isBoolean(Kt)&&!Kt||qr&&!getCheckboxValue(vt).isValid||jr&&!getRadioValue(vt).isValid)){const{value:zo,message:t0}=isMessage(Tt)?{value:!!Tt,message:Tt}:getValueAndMessage(Tt);if(zo&&(or[Ft]={type:INPUT_VALIDATION_RULES.required,message:t0,ref:rr,...ko(INPUT_VALIDATION_RULES.required,t0)},!b))return ir(t0),or}if(!vn&&(!isNullOrUndefined(wt)||!isNullOrUndefined($t))){let zo,t0;const Uo=getValueAndMessage($t),No=getValueAndMessage(wt);if(!isNullOrUndefined(Kt)&&!isNaN(Kt)){const _n=at.valueAsNumber||Kt&&+Kt;isNullOrUndefined(Uo.value)||(zo=_n>Uo.value),isNullOrUndefined(No.value)||(t0=_n<No.value)}else{const _n=at.valueAsDate||new Date(Kt),Kr=Ro=>new Date(new Date().toDateString()+" "+Ro),e0=at.type=="time",Zr=at.type=="week";isString(Uo.value)&&Kt&&(zo=e0?Kr(Kt)>Kr(Uo.value):Zr?Kt>Uo.value:_n>new Date(Uo.value)),isString(No.value)&&Kt&&(t0=e0?Kr(Kt)<Kr(No.value):Zr?Kt<No.value:_n<new Date(No.value))}if((zo||t0)&&(Xo(!!zo,Uo.message,No.message,INPUT_VALIDATION_RULES.max,INPUT_VALIDATION_RULES.min),!b))return ir(or[Ft].message),or}if((Ct||pt)&&!vn&&(isString(Kt)||st&&Array.isArray(Kt))){const zo=getValueAndMessage(Ct),t0=getValueAndMessage(pt),Uo=!isNullOrUndefined(zo.value)&&Kt.length>+zo.value,No=!isNullOrUndefined(t0.value)&&Kt.length<+t0.value;if((Uo||No)&&(Xo(Uo,zo.message,t0.message),!b))return ir(or[Ft].message),or}if(Lt&&!vn&&isString(Kt)){const{value:zo,message:t0}=getValueAndMessage(Lt);if(isRegex(zo)&&!Kt.match(zo)&&(or[Ft]={type:INPUT_VALIDATION_RULES.pattern,message:t0,ref:at,...ko(INPUT_VALIDATION_RULES.pattern,t0)},!b))return ir(t0),or}if(jt){if(isFunction(jt)){const zo=await jt(Kt,g),t0=getValidateError(zo,rr);if(t0&&(or[Ft]={...t0,...ko(INPUT_VALIDATION_RULES.validate,t0.message)},!b))return ir(t0.message),or}else if(isObject(jt)){let zo={};for(const t0 in jt){if(!isEmptyObject(zo)&&!b)break;const Uo=getValidateError(await jt[t0](Kt,g),rr,t0);Uo&&(zo={...Uo,...ko(t0,Uo.message)},ir(Uo.message),b&&(or[Ft]=zo))}if(!isEmptyObject(zo)&&(or[Ft]={ref:rr,...zo},!b))return or}}return ir(!0),or};function baseGet(d,g){const b=g.slice(0,-1).length;let et=0;for(;et<b;)d=isUndefined(d)?et++:d[g[et++]];return d}function isEmptyArray(d){for(const g in d)if(d.hasOwnProperty(g)&&!isUndefined(d[g]))return!1;return!0}function unset(d,g){const b=Array.isArray(g)?g:isKey(g)?[g]:stringToPath(g),et=b.length===1?d:baseGet(d,b),st=b.length-1,at=b[st];return et&&delete et[at],st!==0&&(isObject(et)&&isEmptyObject(et)||Array.isArray(et)&&isEmptyArray(et))&&unset(d,b.slice(0,-1)),d}var createSubject=()=>{let d=[];return{get observers(){return d},next:st=>{for(const at of d)at.next&&at.next(st)},subscribe:st=>(d.push(st),{unsubscribe:()=>{d=d.filter(at=>at!==st)}}),unsubscribe:()=>{d=[]}}},isPrimitive=d=>isNullOrUndefined(d)||!isObjectType(d);function deepEqual(d,g){if(isPrimitive(d)||isPrimitive(g))return d===g;if(isDateObject(d)&&isDateObject(g))return d.getTime()===g.getTime();const b=Object.keys(d),et=Object.keys(g);if(b.length!==et.length)return!1;for(const st of b){const at=d[st];if(!et.includes(st))return!1;if(st!=="ref"){const vt=g[st];if(isDateObject(at)&&isDateObject(vt)||isObject(at)&&isObject(vt)||Array.isArray(at)&&Array.isArray(vt)?!deepEqual(at,vt):at!==vt)return!1}}return!0}var isMultipleSelect=d=>d.type==="select-multiple",isRadioOrCheckbox=d=>isRadioInput(d)||isCheckBoxInput(d),live=d=>isHTMLElement(d)&&d.isConnected,objectHasFunction=d=>{for(const g in d)if(isFunction(d[g]))return!0;return!1};function markFieldsDirty(d,g={}){const b=Array.isArray(d);if(isObject(d)||b)for(const et in d)Array.isArray(d[et])||isObject(d[et])&&!objectHasFunction(d[et])?(g[et]=Array.isArray(d[et])?[]:{},markFieldsDirty(d[et],g[et])):isNullOrUndefined(d[et])||(g[et]=!0);return g}function getDirtyFieldsFromDefaultValues(d,g,b){const et=Array.isArray(d);if(isObject(d)||et)for(const st in d)Array.isArray(d[st])||isObject(d[st])&&!objectHasFunction(d[st])?isUndefined(g)||isPrimitive(b[st])?b[st]=Array.isArray(d[st])?markFieldsDirty(d[st],[]):{...markFieldsDirty(d[st])}:getDirtyFieldsFromDefaultValues(d[st],isNullOrUndefined(g)?{}:g[st],b[st]):b[st]=!deepEqual(d[st],g[st]);return b}var getDirtyFields=(d,g)=>getDirtyFieldsFromDefaultValues(d,g,markFieldsDirty(g)),getFieldValueAs=(d,{valueAsNumber:g,valueAsDate:b,setValueAs:et})=>isUndefined(d)?d:g?d===""?NaN:d&&+d:b&&isString(d)?new Date(d):et?et(d):d;function getFieldValue(d){const g=d.ref;if(!(d.refs?d.refs.every(b=>b.disabled):g.disabled))return isFileInput(g)?g.files:isRadioInput(g)?getRadioValue(d.refs).value:isMultipleSelect(g)?[...g.selectedOptions].map(({value:b})=>b):isCheckBoxInput(g)?getCheckboxValue(d.refs).value:getFieldValueAs(isUndefined(g.value)?d.ref.value:g.value,d)}var getResolverOptions=(d,g,b,et)=>{const st={};for(const at of d){const vt=get$1(g,at);vt&&set(st,at,vt._f)}return{criteriaMode:b,names:[...d],fields:st,shouldUseNativeValidation:et}},getRuleValue=d=>isUndefined(d)?d:isRegex(d)?d.source:isObject(d)?isRegex(d.value)?d.value.source:d.value:d,hasValidation=d=>d.mount&&(d.required||d.min||d.max||d.maxLength||d.minLength||d.pattern||d.validate);function schemaErrorLookup(d,g,b){const et=get$1(d,b);if(et||isKey(b))return{error:et,name:b};const st=b.split(".");for(;st.length;){const at=st.join("."),vt=get$1(g,at),Tt=get$1(d,at);if(vt&&!Array.isArray(vt)&&b!==at)return{name:b};if(Tt&&Tt.type)return{name:at,error:Tt};st.pop()}return{name:b}}var skipValidation=(d,g,b,et,st)=>st.isOnAll?!1:!b&&st.isOnTouch?!(g||d):(b?et.isOnBlur:st.isOnBlur)?!d:(b?et.isOnChange:st.isOnChange)?d:!0,unsetEmptyArray=(d,g)=>!compact(get$1(d,g)).length&&unset(d,g);const defaultOptions={mode:VALIDATION_MODE.onSubmit,reValidateMode:VALIDATION_MODE.onChange,shouldFocusError:!0};function createFormControl(d={}){let g={...defaultOptions,...d},b={submitCount:0,isDirty:!1,isLoading:isFunction(g.defaultValues),isValidating:!1,isSubmitted:!1,isSubmitting:!1,isSubmitSuccessful:!1,isValid:!1,touchedFields:{},dirtyFields:{},validatingFields:{},errors:g.errors||{},disabled:g.disabled||!1},et={},st=isObject(g.defaultValues)||isObject(g.values)?cloneObject(g.defaultValues||g.values)||{}:{},at=g.shouldUnregister?{}:cloneObject(st),vt={action:!1,mount:!1,watch:!1},Tt={mount:new Set,unMount:new Set,array:new Set,watch:new Set},Ct,pt=0;const wt={isDirty:!1,dirtyFields:!1,validatingFields:!1,touchedFields:!1,isValidating:!1,isValid:!1,errors:!1},$t={values:createSubject(),array:createSubject(),state:createSubject()},Lt=getValidationModes(g.mode),jt=getValidationModes(g.reValidateMode),Ft=g.criteriaMode===VALIDATION_MODE.all,Gt=r0=>p0=>{clearTimeout(pt),pt=setTimeout(r0,p0)},Ht=async r0=>{if(wt.isValid||r0){const p0=g.resolver?isEmptyObject((await Yr()).errors):await ko(et,!0);p0!==b.isValid&&$t.state.next({isValid:p0})}},qt=(r0,p0)=>{(wt.isValidating||wt.validatingFields)&&((r0||Array.from(Tt.mount)).forEach($0=>{$0&&(p0?set(b.validatingFields,$0,p0):unset(b.validatingFields,$0))}),$t.state.next({validatingFields:b.validatingFields,isValidating:!isEmptyObject(b.validatingFields)}))},Kt=(r0,p0=[],$0,A0,g0=!0,E0=!0)=>{if(A0&&$0){if(vt.action=!0,E0&&Array.isArray(get$1(et,r0))){const F0=$0(get$1(et,r0),A0.argA,A0.argB);g0&&set(et,r0,F0)}if(E0&&Array.isArray(get$1(b.errors,r0))){const F0=$0(get$1(b.errors,r0),A0.argA,A0.argB);g0&&set(b.errors,r0,F0),unsetEmptyArray(b.errors,r0)}if(wt.touchedFields&&E0&&Array.isArray(get$1(b.touchedFields,r0))){const F0=$0(get$1(b.touchedFields,r0),A0.argA,A0.argB);g0&&set(b.touchedFields,r0,F0)}wt.dirtyFields&&(b.dirtyFields=getDirtyFields(st,at)),$t.state.next({name:r0,isDirty:zo(r0,p0),dirtyFields:b.dirtyFields,errors:b.errors,isValid:b.isValid})}else set(at,r0,p0)},rr=(r0,p0)=>{set(b.errors,r0,p0),$t.state.next({errors:b.errors})},ir=r0=>{b.errors=r0,$t.state.next({errors:b.errors,isValid:!1})},or=(r0,p0,$0,A0)=>{const g0=get$1(et,r0);if(g0){const E0=get$1(at,r0,isUndefined($0)?get$1(st,r0):$0);isUndefined(E0)||A0&&A0.defaultChecked||p0?set(at,r0,p0?E0:getFieldValue(g0._f)):No(r0,E0),vt.mount&&Ht()}},jr=(r0,p0,$0,A0,g0)=>{let E0=!1,F0=!1;const K0={name:r0},l1=!!(get$1(et,r0)&&get$1(et,r0)._f.disabled);if(!$0||A0){wt.isDirty&&(F0=b.isDirty,b.isDirty=K0.isDirty=zo(),E0=F0!==K0.isDirty);const n1=l1||deepEqual(get$1(st,r0),p0);F0=!!(!l1&&get$1(b.dirtyFields,r0)),n1||l1?unset(b.dirtyFields,r0):set(b.dirtyFields,r0,!0),K0.dirtyFields=b.dirtyFields,E0=E0||wt.dirtyFields&&F0!==!n1}if($0){const n1=get$1(b.touchedFields,r0);n1||(set(b.touchedFields,r0,$0),K0.touchedFields=b.touchedFields,E0=E0||wt.touchedFields&&n1!==$0)}return E0&&g0&&$t.state.next(K0),E0?K0:{}},qr=(r0,p0,$0,A0)=>{const g0=get$1(b.errors,r0),E0=wt.isValid&&isBoolean(p0)&&b.isValid!==p0;if(d.delayError&&$0?(Ct=Gt(()=>rr(r0,$0)),Ct(d.delayError)):(clearTimeout(pt),Ct=null,$0?set(b.errors,r0,$0):unset(b.errors,r0)),($0?!deepEqual(g0,$0):g0)||!isEmptyObject(A0)||E0){const F0={...A0,...E0&&isBoolean(p0)?{isValid:p0}:{},errors:b.errors,name:r0};b={...b,...F0},$t.state.next(F0)}},Yr=async r0=>{qt(r0,!0);const p0=await g.resolver(at,g.context,getResolverOptions(r0||Tt.mount,et,g.criteriaMode,g.shouldUseNativeValidation));return qt(r0),p0},vn=async r0=>{const{errors:p0}=await Yr(r0);if(r0)for(const $0 of r0){const A0=get$1(p0,$0);A0?set(b.errors,$0,A0):unset(b.errors,$0)}else b.errors=p0;return p0},ko=async(r0,p0,$0={valid:!0})=>{for(const A0 in r0){const g0=r0[A0];if(g0){const{_f:E0,...F0}=g0;if(E0){const K0=Tt.array.has(E0.name);qt([A0],!0);const l1=await validateField(g0,at,Ft,g.shouldUseNativeValidation&&!p0,K0);if(qt([A0]),l1[E0.name]&&($0.valid=!1,p0))break;!p0&&(get$1(l1,E0.name)?K0?updateFieldArrayRootError(b.errors,l1,E0.name):set(b.errors,E0.name,l1[E0.name]):unset(b.errors,E0.name))}F0&&await ko(F0,p0,$0)}}return $0.valid},Xo=()=>{for(const r0 of Tt.unMount){const p0=get$1(et,r0);p0&&(p0._f.refs?p0._f.refs.every($0=>!live($0)):!live(p0._f.ref))&&a0(r0)}Tt.unMount=new Set},zo=(r0,p0)=>(r0&&p0&&set(at,r0,p0),!deepEqual(Sn(),st)),t0=(r0,p0,$0)=>generateWatchOutput(r0,Tt,{...vt.mount?at:isUndefined(p0)?st:isString(r0)?{[r0]:p0}:p0},$0,p0),Uo=r0=>compact(get$1(vt.mount?at:st,r0,d.shouldUnregister?get$1(st,r0,[]):[])),No=(r0,p0,$0={})=>{const A0=get$1(et,r0);let g0=p0;if(A0){const E0=A0._f;E0&&(!E0.disabled&&set(at,r0,getFieldValueAs(p0,E0)),g0=isHTMLElement(E0.ref)&&isNullOrUndefined(p0)?"":p0,isMultipleSelect(E0.ref)?[...E0.ref.options].forEach(F0=>F0.selected=g0.includes(F0.value)):E0.refs?isCheckBoxInput(E0.ref)?E0.refs.length>1?E0.refs.forEach(F0=>(!F0.defaultChecked||!F0.disabled)&&(F0.checked=Array.isArray(g0)?!!g0.find(K0=>K0===F0.value):g0===F0.value)):E0.refs[0]&&(E0.refs[0].checked=!!g0):E0.refs.forEach(F0=>F0.checked=F0.value===g0):isFileInput(E0.ref)?E0.ref.value="":(E0.ref.value=g0,E0.ref.type||$t.values.next({name:r0,values:{...at}})))}($0.shouldDirty||$0.shouldTouch)&&jr(r0,g0,$0.shouldTouch,$0.shouldDirty,!0),$0.shouldValidate&&Ro(r0)},_n=(r0,p0,$0)=>{for(const A0 in p0){const g0=p0[A0],E0=`${r0}.${A0}`,F0=get$1(et,E0);(Tt.array.has(r0)||!isPrimitive(g0)||F0&&!F0._f)&&!isDateObject(g0)?_n(E0,g0,$0):No(E0,g0,$0)}},Kr=(r0,p0,$0={})=>{const A0=get$1(et,r0),g0=Tt.array.has(r0),E0=cloneObject(p0);set(at,r0,E0),g0?($t.array.next({name:r0,values:{...at}}),(wt.isDirty||wt.dirtyFields)&&$0.shouldDirty&&$t.state.next({name:r0,dirtyFields:getDirtyFields(st,at),isDirty:zo(r0,E0)})):A0&&!A0._f&&!isNullOrUndefined(E0)?_n(r0,E0,$0):No(r0,E0,$0),isWatched(r0,Tt)&&$t.state.next({...b}),$t.values.next({name:vt.mount?r0:void 0,values:{...at}})},e0=async r0=>{vt.mount=!0;const p0=r0.target;let $0=p0.name,A0=!0;const g0=get$1(et,$0),E0=()=>p0.type?getFieldValue(g0._f):getEventValue(r0),F0=K0=>{A0=Number.isNaN(K0)||K0===get$1(at,$0,K0)};if(g0){let K0,l1;const n1=E0(),x1=r0.type===EVENTS.BLUR||r0.type===EVENTS.FOCUS_OUT,u1=!hasValidation(g0._f)&&!g.resolver&&!get$1(b.errors,$0)&&!g0._f.deps||skipValidation(x1,get$1(b.touchedFields,$0),b.isSubmitted,jt,Lt),P1=isWatched($0,Tt,x1);set(at,$0,n1),x1?(g0._f.onBlur&&g0._f.onBlur(r0),Ct&&Ct(0)):g0._f.onChange&&g0._f.onChange(r0);const i1=jr($0,n1,x1,!1),v1=!isEmptyObject(i1)||P1;if(!x1&&$t.values.next({name:$0,type:r0.type,values:{...at}}),u1)return wt.isValid&&Ht(),v1&&$t.state.next({name:$0,...P1?{}:i1});if(!x1&&P1&&$t.state.next({...b}),g.resolver){const{errors:_1}=await Yr([$0]);if(F0(n1),A0){const X1=schemaErrorLookup(b.errors,et,$0),t1=schemaErrorLookup(_1,et,X1.name||$0);K0=t1.error,$0=t1.name,l1=isEmptyObject(_1)}}else qt([$0],!0),K0=(await validateField(g0,at,Ft,g.shouldUseNativeValidation))[$0],qt([$0]),F0(n1),A0&&(K0?l1=!1:wt.isValid&&(l1=await ko(et,!0)));A0&&(g0._f.deps&&Ro(g0._f.deps),qr($0,l1,K0,i1))}},Zr=(r0,p0)=>{if(get$1(b.errors,p0)&&r0.focus)return r0.focus(),1},Ro=async(r0,p0={})=>{let $0,A0;const g0=convertToArrayPayload(r0);if(g.resolver){const E0=await vn(isUndefined(r0)?r0:g0);$0=isEmptyObject(E0),A0=r0?!g0.some(F0=>get$1(E0,F0)):$0}else r0?(A0=(await Promise.all(g0.map(async E0=>{const F0=get$1(et,E0);return await ko(F0&&F0._f?{[E0]:F0}:F0)}))).every(Boolean),!(!A0&&!b.isValid)&&Ht()):A0=$0=await ko(et);return $t.state.next({...!isString(r0)||wt.isValid&&$0!==b.isValid?{}:{name:r0},...g.resolver||!r0?{isValid:$0}:{},errors:b.errors}),p0.shouldFocus&&!A0&&iterateFieldsByAction(et,Zr,r0?g0:Tt.mount),A0},Sn=r0=>{const p0={...vt.mount?at:st};return isUndefined(r0)?p0:isString(r0)?get$1(p0,r0):r0.map($0=>get$1(p0,$0))},Tn=(r0,p0)=>({invalid:!!get$1((p0||b).errors,r0),isDirty:!!get$1((p0||b).dirtyFields,r0),isTouched:!!get$1((p0||b).touchedFields,r0),isValidating:!!get$1((p0||b).validatingFields,r0),error:get$1((p0||b).errors,r0)}),n0=r0=>{r0&&convertToArrayPayload(r0).forEach(p0=>unset(b.errors,p0)),$t.state.next({errors:r0?b.errors:{}})},Go=(r0,p0,$0)=>{const A0=(get$1(et,r0,{_f:{}})._f||{}).ref;set(b.errors,r0,{...p0,ref:A0}),$t.state.next({name:r0,errors:b.errors,isValid:!1}),$0&&$0.shouldFocus&&A0&&A0.focus&&A0.focus()},An=(r0,p0)=>isFunction(r0)?$t.values.subscribe({next:$0=>r0(t0(void 0,p0),$0)}):t0(r0,p0,!0),a0=(r0,p0={})=>{for(const $0 of r0?convertToArrayPayload(r0):Tt.mount)Tt.mount.delete($0),Tt.array.delete($0),p0.keepValue||(unset(et,$0),unset(at,$0)),!p0.keepError&&unset(b.errors,$0),!p0.keepDirty&&unset(b.dirtyFields,$0),!p0.keepTouched&&unset(b.touchedFields,$0),!p0.keepIsValidating&&unset(b.validatingFields,$0),!g.shouldUnregister&&!p0.keepDefaultValue&&unset(st,$0);$t.values.next({values:{...at}}),$t.state.next({...b,...p0.keepDirty?{isDirty:zo()}:{}}),!p0.keepIsValid&&Ht()},u0=({disabled:r0,name:p0,field:$0,fields:A0,value:g0})=>{if(isBoolean(r0)){const E0=r0?void 0:isUndefined(g0)?getFieldValue($0?$0._f:get$1(A0,p0)._f):g0;set(at,p0,E0),jr(p0,E0,!1,!1,!0)}},d0=(r0,p0={})=>{let $0=get$1(et,r0);const A0=isBoolean(p0.disabled);return set(et,r0,{...$0||{},_f:{...$0&&$0._f?$0._f:{ref:{name:r0}},name:r0,mount:!0,...p0}}),Tt.mount.add(r0),$0?u0({field:$0,disabled:p0.disabled,name:r0,value:p0.value}):or(r0,!0,p0.value),{...A0?{disabled:p0.disabled}:{},...g.progressive?{required:!!p0.required,min:getRuleValue(p0.min),max:getRuleValue(p0.max),minLength:getRuleValue(p0.minLength),maxLength:getRuleValue(p0.maxLength),pattern:getRuleValue(p0.pattern)}:{},name:r0,onChange:e0,onBlur:e0,ref:g0=>{if(g0){d0(r0,p0),$0=get$1(et,r0);const E0=isUndefined(g0.value)&&g0.querySelectorAll&&g0.querySelectorAll("input,select,textarea")[0]||g0,F0=isRadioOrCheckbox(E0),K0=$0._f.refs||[];if(F0?K0.find(l1=>l1===E0):E0===$0._f.ref)return;set(et,r0,{_f:{...$0._f,...F0?{refs:[...K0.filter(live),E0,...Array.isArray(get$1(st,r0))?[{}]:[]],ref:{type:E0.type,name:r0}}:{ref:E0}}}),or(r0,!1,void 0,E0)}else $0=get$1(et,r0,{}),$0._f&&($0._f.mount=!1),(g.shouldUnregister||p0.shouldUnregister)&&!(isNameInFieldArray(Tt.array,r0)&&vt.action)&&Tt.unMount.add(r0)}}},f0=()=>g.shouldFocusError&&iterateFieldsByAction(et,Zr,Tt.mount),y0=r0=>{isBoolean(r0)&&($t.state.next({disabled:r0}),iterateFieldsByAction(et,(p0,$0)=>{let A0=r0;const g0=get$1(et,$0);g0&&isBoolean(g0._f.disabled)&&(A0||(A0=g0._f.disabled)),p0.disabled=A0},0,!1))},b0=(r0,p0)=>async $0=>{let A0;$0&&($0.preventDefault&&$0.preventDefault(),$0.persist&&$0.persist());let g0=cloneObject(at);if($t.state.next({isSubmitting:!0}),g.resolver){const{errors:E0,values:F0}=await Yr();b.errors=E0,g0=F0}else await ko(et);if(unset(b.errors,"root"),isEmptyObject(b.errors)){$t.state.next({errors:{}});try{await r0(g0,$0)}catch(E0){A0=E0}}else p0&&await p0({...b.errors},$0),f0(),setTimeout(f0);if($t.state.next({isSubmitted:!0,isSubmitting:!1,isSubmitSuccessful:isEmptyObject(b.errors)&&!A0,submitCount:b.submitCount+1,errors:b.errors}),A0)throw A0},O0=(r0,p0={})=>{get$1(et,r0)&&(isUndefined(p0.defaultValue)?Kr(r0,cloneObject(get$1(st,r0))):(Kr(r0,p0.defaultValue),set(st,r0,cloneObject(p0.defaultValue))),p0.keepTouched||unset(b.touchedFields,r0),p0.keepDirty||(unset(b.dirtyFields,r0),b.isDirty=p0.defaultValue?zo(r0,cloneObject(get$1(st,r0))):zo()),p0.keepError||(unset(b.errors,r0),wt.isValid&&Ht()),$t.state.next({...b}))},C0=(r0,p0={})=>{const $0=r0?cloneObject(r0):st,A0=cloneObject($0),g0=isEmptyObject(r0),E0=g0?st:A0;if(p0.keepDefaultValues||(st=$0),!p0.keepValues){if(p0.keepDirtyValues)for(const F0 of Tt.mount)get$1(b.dirtyFields,F0)?set(E0,F0,get$1(at,F0)):Kr(F0,get$1(E0,F0));else{if(isWeb&&isUndefined(r0))for(const F0 of Tt.mount){const K0=get$1(et,F0);if(K0&&K0._f){const l1=Array.isArray(K0._f.refs)?K0._f.refs[0]:K0._f.ref;if(isHTMLElement(l1)){const n1=l1.closest("form");if(n1){n1.reset();break}}}}et={}}at=d.shouldUnregister?p0.keepDefaultValues?cloneObject(st):{}:cloneObject(E0),$t.array.next({values:{...E0}}),$t.values.next({values:{...E0}})}Tt={mount:p0.keepDirtyValues?Tt.mount:new Set,unMount:new Set,array:new Set,watch:new Set,watchAll:!1,focus:""},vt.mount=!wt.isValid||!!p0.keepIsValid||!!p0.keepDirtyValues,vt.watch=!!d.shouldUnregister,$t.state.next({submitCount:p0.keepSubmitCount?b.submitCount:0,isDirty:g0?!1:p0.keepDirty?b.isDirty:!!(p0.keepDefaultValues&&!deepEqual(r0,st)),isSubmitted:p0.keepIsSubmitted?b.isSubmitted:!1,dirtyFields:g0?[]:p0.keepDirtyValues?p0.keepDefaultValues&&at?getDirtyFields(st,at):b.dirtyFields:p0.keepDefaultValues&&r0?getDirtyFields(st,r0):{},touchedFields:p0.keepTouched?b.touchedFields:{},errors:p0.keepErrors?b.errors:{},isSubmitSuccessful:p0.keepIsSubmitSuccessful?b.isSubmitSuccessful:!1,isSubmitting:!1})},v0=(r0,p0)=>C0(isFunction(r0)?r0(at):r0,p0);return{control:{register:d0,unregister:a0,getFieldState:Tn,handleSubmit:b0,setError:Go,_executeSchema:Yr,_getWatch:t0,_getDirty:zo,_updateValid:Ht,_removeUnmounted:Xo,_updateFieldArray:Kt,_updateDisabledField:u0,_getFieldArray:Uo,_reset:C0,_resetDefaultValues:()=>isFunction(g.defaultValues)&&g.defaultValues().then(r0=>{v0(r0,g.resetOptions),$t.state.next({isLoading:!1})}),_updateFormState:r0=>{b={...b,...r0}},_disableForm:y0,_subjects:$t,_proxyFormState:wt,_setErrors:ir,get _fields(){return et},get _formValues(){return at},get _state(){return vt},set _state(r0){vt=r0},get _defaultValues(){return st},get _names(){return Tt},set _names(r0){Tt=r0},get _formState(){return b},set _formState(r0){b=r0},get _options(){return g},set _options(r0){g={...g,...r0}}},trigger:Ro,register:d0,handleSubmit:b0,watch:An,setValue:Kr,getValues:Sn,reset:v0,resetField:O0,clearErrors:n0,unregister:a0,setError:Go,setFocus:(r0,p0={})=>{const $0=get$1(et,r0),A0=$0&&$0._f;if(A0){const g0=A0.refs?A0.refs[0]:A0.ref;g0.focus&&(g0.focus(),p0.shouldSelect&&g0.select())}},getFieldState:Tn}}function useForm(d={}){const g=React.useRef(),b=React.useRef(),[et,st]=React.useState({isDirty:!1,isValidating:!1,isLoading:isFunction(d.defaultValues),isSubmitted:!1,isSubmitting:!1,isSubmitSuccessful:!1,isValid:!1,submitCount:0,dirtyFields:{},touchedFields:{},validatingFields:{},errors:d.errors||{},disabled:d.disabled||!1,defaultValues:isFunction(d.defaultValues)?void 0:d.defaultValues});g.current||(g.current={...createFormControl(d),formState:et});const at=g.current.control;return at._options=d,useSubscribe({subject:at._subjects.state,next:vt=>{shouldRenderFormState(vt,at._proxyFormState,at._updateFormState,!0)&&st({...at._formState})}}),React.useEffect(()=>at._disableForm(d.disabled),[at,d.disabled]),React.useEffect(()=>{if(at._proxyFormState.isDirty){const vt=at._getDirty();vt!==et.isDirty&&at._subjects.state.next({isDirty:vt})}},[at,et.isDirty]),React.useEffect(()=>{d.values&&!deepEqual(d.values,b.current)?(at._reset(d.values,at._options.resetOptions),b.current=d.values,st(vt=>({...vt}))):at._resetDefaultValues()},[d.values,at]),React.useEffect(()=>{d.errors&&at._setErrors(d.errors)},[d.errors,at]),React.useEffect(()=>{at._state.mount||(at._updateValid(),at._state.mount=!0),at._state.watch&&(at._state.watch=!1,at._subjects.state.next({...at._formState})),at._removeUnmounted()}),React.useEffect(()=>{d.shouldUnregister&&at._subjects.values.next({values:at._getWatch()})},[d.shouldUnregister,at]),g.current.formState=getProxyFormState(et,at),g.current}var t$2=function(d,g,b){if(d&&"reportValidity"in d){var et=get$1(b,g);d.setCustomValidity(et&&et.message||""),d.reportValidity()}},i$1=function(d,g){var b=function(st){var at=g.fields[st];at&&at.ref&&"reportValidity"in at.ref?t$2(at.ref,st,d):at.refs&&at.refs.forEach(function(vt){return t$2(vt,st,d)})};for(var et in g.fields)b(et)},n$1=function(d,g){g.shouldUseNativeValidation&&i$1(d,g);var b={};for(var et in d){var st=get$1(g.fields,et),at=Object.assign(d[et]||{},{ref:st&&st.ref});if(o$1(g.names||Object.keys(d),et)){var vt=Object.assign({},get$1(b,et));set(vt,"root",at),set(b,et,vt)}else set(b,et,at)}return b},o$1=function(d,g){return d.some(function(b){return b.startsWith(g+".")})},n=function(d,g){for(var b={};d.length;){var et=d[0],st=et.code,at=et.message,vt=et.path.join(".");if(!b[vt])if("unionErrors"in et){var Tt=et.unionErrors[0].errors[0];b[vt]={message:Tt.message,type:Tt.code}}else b[vt]={message:at,type:st};if("unionErrors"in et&&et.unionErrors.forEach(function(wt){return wt.errors.forEach(function($t){return d.push($t)})}),g){var Ct=b[vt].types,pt=Ct&&Ct[et.code];b[vt]=appendErrors(vt,g,b,st,pt?[].concat(pt,et.message):et.message)}d.shift()}return b},t$1=function(d,g,b){return b===void 0&&(b={}),function(et,st,at){try{return Promise.resolve(function(vt,Tt){try{var Ct=Promise.resolve(d[b.mode==="sync"?"parse":"parseAsync"](et,g)).then(function(pt){return at.shouldUseNativeValidation&&i$1({},at),{errors:{},values:b.raw?et:pt}})}catch(pt){return Tt(pt)}return Ct&&Ct.then?Ct.then(void 0,Tt):Ct}(0,function(vt){if(function(Tt){return Tt.errors!=null}(vt))return{values:{},errors:n$1(n(vt.errors,!at.shouldUseNativeValidation&&at.criteriaMode==="all"),at)};throw vt}))}catch(vt){return Promise.reject(vt)}}},util;(function(d){d.assertEqual=st=>st;function g(st){}d.assertIs=g;function b(st){throw new Error}d.assertNever=b,d.arrayToEnum=st=>{const at={};for(const vt of st)at[vt]=vt;return at},d.getValidEnumValues=st=>{const at=d.objectKeys(st).filter(Tt=>typeof st[st[Tt]]!="number"),vt={};for(const Tt of at)vt[Tt]=st[Tt];return d.objectValues(vt)},d.objectValues=st=>d.objectKeys(st).map(function(at){return st[at]}),d.objectKeys=typeof Object.keys=="function"?st=>Object.keys(st):st=>{const at=[];for(const vt in st)Object.prototype.hasOwnProperty.call(st,vt)&&at.push(vt);return at},d.find=(st,at)=>{for(const vt of st)if(at(vt))return vt},d.isInteger=typeof Number.isInteger=="function"?st=>Number.isInteger(st):st=>typeof st=="number"&&isFinite(st)&&Math.floor(st)===st;function et(st,at=" | "){return st.map(vt=>typeof vt=="string"?`'${vt}'`:vt).join(at)}d.joinValues=et,d.jsonStringifyReplacer=(st,at)=>typeof at=="bigint"?at.toString():at})(util||(util={}));var objectUtil;(function(d){d.mergeShapes=(g,b)=>({...g,...b})})(objectUtil||(objectUtil={}));const ZodParsedType=util.arrayToEnum(["string","nan","number","integer","float","boolean","date","bigint","symbol","function","undefined","null","array","object","unknown","promise","void","never","map","set"]),getParsedType=d=>{switch(typeof d){case"undefined":return ZodParsedType.undefined;case"string":return ZodParsedType.string;case"number":return isNaN(d)?ZodParsedType.nan:ZodParsedType.number;case"boolean":return ZodParsedType.boolean;case"function":return ZodParsedType.function;case"bigint":return ZodParsedType.bigint;case"symbol":return ZodParsedType.symbol;case"object":return Array.isArray(d)?ZodParsedType.array:d===null?ZodParsedType.null:d.then&&typeof d.then=="function"&&d.catch&&typeof d.catch=="function"?ZodParsedType.promise:typeof Map<"u"&&d instanceof Map?ZodParsedType.map:typeof Set<"u"&&d instanceof Set?ZodParsedType.set:typeof Date<"u"&&d instanceof Date?ZodParsedType.date:ZodParsedType.object;default:return ZodParsedType.unknown}},ZodIssueCode=util.arrayToEnum(["invalid_type","invalid_literal","custom","invalid_union","invalid_union_discriminator","invalid_enum_value","unrecognized_keys","invalid_arguments","invalid_return_type","invalid_date","invalid_string","too_small","too_big","invalid_intersection_types","not_multiple_of","not_finite"]),quotelessJson=d=>JSON.stringify(d,null,2).replace(/"([^"]+)":/g,"$1:");class ZodError extends Error{constructor(g){super(),this.issues=[],this.addIssue=et=>{this.issues=[...this.issues,et]},this.addIssues=(et=[])=>{this.issues=[...this.issues,...et]};const b=new.target.prototype;Object.setPrototypeOf?Object.setPrototypeOf(this,b):this.__proto__=b,this.name="ZodError",this.issues=g}get errors(){return this.issues}format(g){const b=g||function(at){return at.message},et={_errors:[]},st=at=>{for(const vt of at.issues)if(vt.code==="invalid_union")vt.unionErrors.map(st);else if(vt.code==="invalid_return_type")st(vt.returnTypeError);else if(vt.code==="invalid_arguments")st(vt.argumentsError);else if(vt.path.length===0)et._errors.push(b(vt));else{let Tt=et,Ct=0;for(;Ct<vt.path.length;){const pt=vt.path[Ct];Ct===vt.path.length-1?(Tt[pt]=Tt[pt]||{_errors:[]},Tt[pt]._errors.push(b(vt))):Tt[pt]=Tt[pt]||{_errors:[]},Tt=Tt[pt],Ct++}}};return st(this),et}static assert(g){if(!(g instanceof ZodError))throw new Error(`Not a ZodError: ${g}`)}toString(){return this.message}get message(){return JSON.stringify(this.issues,util.jsonStringifyReplacer,2)}get isEmpty(){return this.issues.length===0}flatten(g=b=>b.message){const b={},et=[];for(const st of this.issues)st.path.length>0?(b[st.path[0]]=b[st.path[0]]||[],b[st.path[0]].push(g(st))):et.push(g(st));return{formErrors:et,fieldErrors:b}}get formErrors(){return this.flatten()}}ZodError.create=d=>new ZodError(d);const errorMap=(d,g)=>{let b;switch(d.code){case ZodIssueCode.invalid_type:d.received===ZodParsedType.undefined?b="Required":b=`Expected ${d.expected}, received ${d.received}`;break;case ZodIssueCode.invalid_literal:b=`Invalid literal value, expected ${JSON.stringify(d.expected,util.jsonStringifyReplacer)}`;break;case ZodIssueCode.unrecognized_keys:b=`Unrecognized key(s) in object: ${util.joinValues(d.keys,", ")}`;break;case ZodIssueCode.invalid_union:b="Invalid input";break;case ZodIssueCode.invalid_union_discriminator:b=`Invalid discriminator value. Expected ${util.joinValues(d.options)}`;break;case ZodIssueCode.invalid_enum_value:b=`Invalid enum value. Expected ${util.joinValues(d.options)}, received '${d.received}'`;break;case ZodIssueCode.invalid_arguments:b="Invalid function arguments";break;case ZodIssueCode.invalid_return_type:b="Invalid function return type";break;case ZodIssueCode.invalid_date:b="Invalid date";break;case ZodIssueCode.invalid_string:typeof d.validation=="object"?"includes"in d.validation?(b=`Invalid input: must include "${d.validation.includes}"`,typeof d.validation.position=="number"&&(b=`${b} at one or more positions greater than or equal to ${d.validation.position}`)):"startsWith"in d.validation?b=`Invalid input: must start with "${d.validation.startsWith}"`:"endsWith"in d.validation?b=`Invalid input: must end with "${d.validation.endsWith}"`:util.assertNever(d.validation):d.validation!=="regex"?b=`Invalid ${d.validation}`:b="Invalid";break;case ZodIssueCode.too_small:d.type==="array"?b=`Array must contain ${d.exact?"exactly":d.inclusive?"at least":"more than"} ${d.minimum} element(s)`:d.type==="string"?b=`String must contain ${d.exact?"exactly":d.inclusive?"at least":"over"} ${d.minimum} character(s)`:d.type==="number"?b=`Number must be ${d.exact?"exactly equal to ":d.inclusive?"greater than or equal to ":"greater than "}${d.minimum}`:d.type==="date"?b=`Date must be ${d.exact?"exactly equal to ":d.inclusive?"greater than or equal to ":"greater than "}${new Date(Number(d.minimum))}`:b="Invalid input";break;case ZodIssueCode.too_big:d.type==="array"?b=`Array must contain ${d.exact?"exactly":d.inclusive?"at most":"less than"} ${d.maximum} element(s)`:d.type==="string"?b=`String must contain ${d.exact?"exactly":d.inclusive?"at most":"under"} ${d.maximum} character(s)`:d.type==="number"?b=`Number must be ${d.exact?"exactly":d.inclusive?"less than or equal to":"less than"} ${d.maximum}`:d.type==="bigint"?b=`BigInt must be ${d.exact?"exactly":d.inclusive?"less than or equal to":"less than"} ${d.maximum}`:d.type==="date"?b=`Date must be ${d.exact?"exactly":d.inclusive?"smaller than or equal to":"smaller than"} ${new Date(Number(d.maximum))}`:b="Invalid input";break;case ZodIssueCode.custom:b="Invalid input";break;case ZodIssueCode.invalid_intersection_types:b="Intersection results could not be merged";break;case ZodIssueCode.not_multiple_of:b=`Number must be a multiple of ${d.multipleOf}`;break;case ZodIssueCode.not_finite:b="Number must be finite";break;default:b=g.defaultError,util.assertNever(d)}return{message:b}};let overrideErrorMap=errorMap;function setErrorMap(d){overrideErrorMap=d}function getErrorMap(){return overrideErrorMap}const makeIssue=d=>{const{data:g,path:b,errorMaps:et,issueData:st}=d,at=[...b,...st.path||[]],vt={...st,path:at};if(st.message!==void 0)return{...st,path:at,message:st.message};let Tt="";const Ct=et.filter(pt=>!!pt).slice().reverse();for(const pt of Ct)Tt=pt(vt,{data:g,defaultError:Tt}).message;return{...st,path:at,message:Tt}},EMPTY_PATH=[];function addIssueToContext(d,g){const b=getErrorMap(),et=makeIssue({issueData:g,data:d.data,path:d.path,errorMaps:[d.common.contextualErrorMap,d.schemaErrorMap,b,b===errorMap?void 0:errorMap].filter(st=>!!st)});d.common.issues.push(et)}class ParseStatus{constructor(){this.value="valid"}dirty(){this.value==="valid"&&(this.value="dirty")}abort(){this.value!=="aborted"&&(this.value="aborted")}static mergeArray(g,b){const et=[];for(const st of b){if(st.status==="aborted")return INVALID;st.status==="dirty"&&g.dirty(),et.push(st.value)}return{status:g.value,value:et}}static async mergeObjectAsync(g,b){const et=[];for(const st of b){const at=await st.key,vt=await st.value;et.push({key:at,value:vt})}return ParseStatus.mergeObjectSync(g,et)}static mergeObjectSync(g,b){const et={};for(const st of b){const{key:at,value:vt}=st;if(at.status==="aborted"||vt.status==="aborted")return INVALID;at.status==="dirty"&&g.dirty(),vt.status==="dirty"&&g.dirty(),at.value!=="__proto__"&&(typeof vt.value<"u"||st.alwaysSet)&&(et[at.value]=vt.value)}return{status:g.value,value:et}}}const INVALID=Object.freeze({status:"aborted"}),DIRTY=d=>({status:"dirty",value:d}),OK=d=>({status:"valid",value:d}),isAborted=d=>d.status==="aborted",isDirty=d=>d.status==="dirty",isValid=d=>d.status==="valid",isAsync=d=>typeof Promise<"u"&&d instanceof Promise;function __classPrivateFieldGet(d,g,b,et){if(typeof g=="function"?d!==g||!et:!g.has(d))throw new TypeError("Cannot read private member from an object whose class did not declare it");return g.get(d)}function __classPrivateFieldSet(d,g,b,et,st){if(typeof g=="function"?d!==g||!st:!g.has(d))throw new TypeError("Cannot write private member to an object whose class did not declare it");return g.set(d,b),b}typeof SuppressedError=="function"&&SuppressedError;var errorUtil;(function(d){d.errToObj=g=>typeof g=="string"?{message:g}:g||{},d.toString=g=>typeof g=="string"?g:g==null?void 0:g.message})(errorUtil||(errorUtil={}));var _ZodEnum_cache,_ZodNativeEnum_cache;class ParseInputLazyPath{constructor(g,b,et,st){this._cachedPath=[],this.parent=g,this.data=b,this._path=et,this._key=st}get path(){return this._cachedPath.length||(this._key instanceof Array?this._cachedPath.push(...this._path,...this._key):this._cachedPath.push(...this._path,this._key)),this._cachedPath}}const handleResult=(d,g)=>{if(isValid(g))return{success:!0,data:g.value};if(!d.common.issues.length)throw new Error("Validation failed but no issues detected.");return{success:!1,get error(){if(this._error)return this._error;const b=new ZodError(d.common.issues);return this._error=b,this._error}}};function processCreateParams(d){if(!d)return{};const{errorMap:g,invalid_type_error:b,required_error:et,description:st}=d;if(g&&(b||et))throw new Error(`Can't use "invalid_type_error" or "required_error" in conjunction with custom error map.`);return g?{errorMap:g,description:st}:{errorMap:(vt,Tt)=>{var Ct,pt;const{message:wt}=d;return vt.code==="invalid_enum_value"?{message:wt??Tt.defaultError}:typeof Tt.data>"u"?{message:(Ct=wt??et)!==null&&Ct!==void 0?Ct:Tt.defaultError}:vt.code!=="invalid_type"?{message:Tt.defaultError}:{message:(pt=wt??b)!==null&&pt!==void 0?pt:Tt.defaultError}},description:st}}class ZodType{constructor(g){this.spa=this.safeParseAsync,this._def=g,this.parse=this.parse.bind(this),this.safeParse=this.safeParse.bind(this),this.parseAsync=this.parseAsync.bind(this),this.safeParseAsync=this.safeParseAsync.bind(this),this.spa=this.spa.bind(this),this.refine=this.refine.bind(this),this.refinement=this.refinement.bind(this),this.superRefine=this.superRefine.bind(this),this.optional=this.optional.bind(this),this.nullable=this.nullable.bind(this),this.nullish=this.nullish.bind(this),this.array=this.array.bind(this),this.promise=this.promise.bind(this),this.or=this.or.bind(this),this.and=this.and.bind(this),this.transform=this.transform.bind(this),this.brand=this.brand.bind(this),this.default=this.default.bind(this),this.catch=this.catch.bind(this),this.describe=this.describe.bind(this),this.pipe=this.pipe.bind(this),this.readonly=this.readonly.bind(this),this.isNullable=this.isNullable.bind(this),this.isOptional=this.isOptional.bind(this)}get description(){return this._def.description}_getType(g){return getParsedType(g.data)}_getOrReturnCtx(g,b){return b||{common:g.parent.common,data:g.data,parsedType:getParsedType(g.data),schemaErrorMap:this._def.errorMap,path:g.path,parent:g.parent}}_processInputParams(g){return{status:new ParseStatus,ctx:{common:g.parent.common,data:g.data,parsedType:getParsedType(g.data),schemaErrorMap:this._def.errorMap,path:g.path,parent:g.parent}}}_parseSync(g){const b=this._parse(g);if(isAsync(b))throw new Error("Synchronous parse encountered promise.");return b}_parseAsync(g){const b=this._parse(g);return Promise.resolve(b)}parse(g,b){const et=this.safeParse(g,b);if(et.success)return et.data;throw et.error}safeParse(g,b){var et;const st={common:{issues:[],async:(et=b==null?void 0:b.async)!==null&&et!==void 0?et:!1,contextualErrorMap:b==null?void 0:b.errorMap},path:(b==null?void 0:b.path)||[],schemaErrorMap:this._def.errorMap,parent:null,data:g,parsedType:getParsedType(g)},at=this._parseSync({data:g,path:st.path,parent:st});return handleResult(st,at)}async parseAsync(g,b){const et=await this.safeParseAsync(g,b);if(et.success)return et.data;throw et.error}async safeParseAsync(g,b){const et={common:{issues:[],contextualErrorMap:b==null?void 0:b.errorMap,async:!0},path:(b==null?void 0:b.path)||[],schemaErrorMap:this._def.errorMap,parent:null,data:g,parsedType:getParsedType(g)},st=this._parse({data:g,path:et.path,parent:et}),at=await(isAsync(st)?st:Promise.resolve(st));return handleResult(et,at)}refine(g,b){const et=st=>typeof b=="string"||typeof b>"u"?{message:b}:typeof b=="function"?b(st):b;return this._refinement((st,at)=>{const vt=g(st),Tt=()=>at.addIssue({code:ZodIssueCode.custom,...et(st)});return typeof Promise<"u"&&vt instanceof Promise?vt.then(Ct=>Ct?!0:(Tt(),!1)):vt?!0:(Tt(),!1)})}refinement(g,b){return this._refinement((et,st)=>g(et)?!0:(st.addIssue(typeof b=="function"?b(et,st):b),!1))}_refinement(g){return new ZodEffects({schema:this,typeName:ZodFirstPartyTypeKind.ZodEffects,effect:{type:"refinement",refinement:g}})}superRefine(g){return this._refinement(g)}optional(){return ZodOptional.create(this,this._def)}nullable(){return ZodNullable.create(this,this._def)}nullish(){return this.nullable().optional()}array(){return ZodArray.create(this,this._def)}promise(){return ZodPromise.create(this,this._def)}or(g){return ZodUnion.create([this,g],this._def)}and(g){return ZodIntersection.create(this,g,this._def)}transform(g){return new ZodEffects({...processCreateParams(this._def),schema:this,typeName:ZodFirstPartyTypeKind.ZodEffects,effect:{type:"transform",transform:g}})}default(g){const b=typeof g=="function"?g:()=>g;return new ZodDefault({...processCreateParams(this._def),innerType:this,defaultValue:b,typeName:ZodFirstPartyTypeKind.ZodDefault})}brand(){return new ZodBranded({typeName:ZodFirstPartyTypeKind.ZodBranded,type:this,...processCreateParams(this._def)})}catch(g){const b=typeof g=="function"?g:()=>g;return new ZodCatch({...processCreateParams(this._def),innerType:this,catchValue:b,typeName:ZodFirstPartyTypeKind.ZodCatch})}describe(g){const b=this.constructor;return new b({...this._def,description:g})}pipe(g){return ZodPipeline.create(this,g)}readonly(){return ZodReadonly.create(this)}isOptional(){return this.safeParse(void 0).success}isNullable(){return this.safeParse(null).success}}const cuidRegex=/^c[^\s-]{8,}$/i,cuid2Regex=/^[0-9a-z]+$/,ulidRegex=/^[0-9A-HJKMNP-TV-Z]{26}$/,uuidRegex=/^[0-9a-fA-F]{8}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{12}$/i,nanoidRegex=/^[a-z0-9_-]{21}$/i,durationRegex=/^[-+]?P(?!$)(?:(?:[-+]?\d+Y)|(?:[-+]?\d+[.,]\d+Y$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:(?:[-+]?\d+W)|(?:[-+]?\d+[.,]\d+W$))?(?:(?:[-+]?\d+D)|(?:[-+]?\d+[.,]\d+D$))?(?:T(?=[\d+-])(?:(?:[-+]?\d+H)|(?:[-+]?\d+[.,]\d+H$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:[-+]?\d+(?:[.,]\d+)?S)?)??$/,emailRegex=/^(?!\.)(?!.*\.\.)([A-Z0-9_'+\-\.]*)[A-Z0-9_+-]@([A-Z0-9][A-Z0-9\-]*\.)+[A-Z]{2,}$/i,_emojiRegex="^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$";let emojiRegex;const ipv4Regex=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,ipv6Regex=/^(([a-f0-9]{1,4}:){7}|::([a-f0-9]{1,4}:){0,6}|([a-f0-9]{1,4}:){1}:([a-f0-9]{1,4}:){0,5}|([a-f0-9]{1,4}:){2}:([a-f0-9]{1,4}:){0,4}|([a-f0-9]{1,4}:){3}:([a-f0-9]{1,4}:){0,3}|([a-f0-9]{1,4}:){4}:([a-f0-9]{1,4}:){0,2}|([a-f0-9]{1,4}:){5}:([a-f0-9]{1,4}:){0,1})([a-f0-9]{1,4}|(((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2}))\.){3}((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2})))$/,base64Regex=/^([0-9a-zA-Z+/]{4})*(([0-9a-zA-Z+/]{2}==)|([0-9a-zA-Z+/]{3}=))?$/,dateRegexSource="((\\d\\d[2468][048]|\\d\\d[13579][26]|\\d\\d0[48]|[02468][048]00|[13579][26]00)-02-29|\\d{4}-((0[13578]|1[02])-(0[1-9]|[12]\\d|3[01])|(0[469]|11)-(0[1-9]|[12]\\d|30)|(02)-(0[1-9]|1\\d|2[0-8])))",dateRegex=new RegExp(`^${dateRegexSource}$`);function timeRegexSource(d){let g="([01]\\d|2[0-3]):[0-5]\\d:[0-5]\\d";return d.precision?g=`${g}\\.\\d{${d.precision}}`:d.precision==null&&(g=`${g}(\\.\\d+)?`),g}function timeRegex(d){return new RegExp(`^${timeRegexSource(d)}$`)}function datetimeRegex(d){let g=`${dateRegexSource}T${timeRegexSource(d)}`;const b=[];return b.push(d.local?"Z?":"Z"),d.offset&&b.push("([+-]\\d{2}:?\\d{2})"),g=`${g}(${b.join("|")})`,new RegExp(`^${g}$`)}function isValidIP(d,g){return!!((g==="v4"||!g)&&ipv4Regex.test(d)||(g==="v6"||!g)&&ipv6Regex.test(d))}class ZodString extends ZodType{_parse(g){if(this._def.coerce&&(g.data=String(g.data)),this._getType(g)!==ZodParsedType.string){const at=this._getOrReturnCtx(g);return addIssueToContext(at,{code:ZodIssueCode.invalid_type,expected:ZodParsedType.string,received:at.parsedType}),INVALID}const et=new ParseStatus;let st;for(const at of this._def.checks)if(at.kind==="min")g.data.length<at.value&&(st=this._getOrReturnCtx(g,st),addIssueToContext(st,{code:ZodIssueCode.too_small,minimum:at.value,type:"string",inclusive:!0,exact:!1,message:at.message}),et.dirty());else if(at.kind==="max")g.data.length>at.value&&(st=this._getOrReturnCtx(g,st),addIssueToContext(st,{code:ZodIssueCode.too_big,maximum:at.value,type:"string",inclusive:!0,exact:!1,message:at.message}),et.dirty());else if(at.kind==="length"){const vt=g.data.length>at.value,Tt=g.data.length<at.value;(vt||Tt)&&(st=this._getOrReturnCtx(g,st),vt?addIssueToContext(st,{code:ZodIssueCode.too_big,maximum:at.value,type:"string",inclusive:!0,exact:!0,message:at.message}):Tt&&addIssueToContext(st,{code:ZodIssueCode.too_small,minimum:at.value,type:"string",inclusive:!0,exact:!0,message:at.message}),et.dirty())}else if(at.kind==="email")emailRegex.test(g.data)||(st=this._getOrReturnCtx(g,st),addIssueToContext(st,{validation:"email",code:ZodIssueCode.invalid_string,message:at.message}),et.dirty());else if(at.kind==="emoji")emojiRegex||(emojiRegex=new RegExp(_emojiRegex,"u")),emojiRegex.test(g.data)||(st=this._getOrReturnCtx(g,st),addIssueToContext(st,{validation:"emoji",code:ZodIssueCode.invalid_string,message:at.message}),et.dirty());else if(at.kind==="uuid")uuidRegex.test(g.data)||(st=this._getOrReturnCtx(g,st),addIssueToContext(st,{validation:"uuid",code:ZodIssueCode.invalid_string,message:at.message}),et.dirty());else if(at.kind==="nanoid")nanoidRegex.test(g.data)||(st=this._getOrReturnCtx(g,st),addIssueToContext(st,{validation:"nanoid",code:ZodIssueCode.invalid_string,message:at.message}),et.dirty());else if(at.kind==="cuid")cuidRegex.test(g.data)||(st=this._getOrReturnCtx(g,st),addIssueToContext(st,{validation:"cuid",code:ZodIssueCode.invalid_string,message:at.message}),et.dirty());else if(at.kind==="cuid2")cuid2Regex.test(g.data)||(st=this._getOrReturnCtx(g,st),addIssueToContext(st,{validation:"cuid2",code:ZodIssueCode.invalid_string,message:at.message}),et.dirty());else if(at.kind==="ulid")ulidRegex.test(g.data)||(st=this._getOrReturnCtx(g,st),addIssueToContext(st,{validation:"ulid",code:ZodIssueCode.invalid_string,message:at.message}),et.dirty());else if(at.kind==="url")try{new URL(g.data)}catch{st=this._getOrReturnCtx(g,st),addIssueToContext(st,{validation:"url",code:ZodIssueCode.invalid_string,message:at.message}),et.dirty()}else at.kind==="regex"?(at.regex.lastIndex=0,at.regex.test(g.data)||(st=this._getOrReturnCtx(g,st),addIssueToContext(st,{validation:"regex",code:ZodIssueCode.invalid_string,message:at.message}),et.dirty())):at.kind==="trim"?g.data=g.data.trim():at.kind==="includes"?g.data.includes(at.value,at.position)||(st=this._getOrReturnCtx(g,st),addIssueToContext(st,{code:ZodIssueCode.invalid_string,validation:{includes:at.value,position:at.position},message:at.message}),et.dirty()):at.kind==="toLowerCase"?g.data=g.data.toLowerCase():at.kind==="toUpperCase"?g.data=g.data.toUpperCase():at.kind==="startsWith"?g.data.startsWith(at.value)||(st=this._getOrReturnCtx(g,st),addIssueToContext(st,{code:ZodIssueCode.invalid_string,validation:{startsWith:at.value},message:at.message}),et.dirty()):at.kind==="endsWith"?g.data.endsWith(at.value)||(st=this._getOrReturnCtx(g,st),addIssueToContext(st,{code:ZodIssueCode.invalid_string,validation:{endsWith:at.value},message:at.message}),et.dirty()):at.kind==="datetime"?datetimeRegex(at).test(g.data)||(st=this._getOrReturnCtx(g,st),addIssueToContext(st,{code:ZodIssueCode.invalid_string,validation:"datetime",message:at.message}),et.dirty()):at.kind==="date"?dateRegex.test(g.data)||(st=this._getOrReturnCtx(g,st),addIssueToContext(st,{code:ZodIssueCode.invalid_string,validation:"date",message:at.message}),et.dirty()):at.kind==="time"?timeRegex(at).test(g.data)||(st=this._getOrReturnCtx(g,st),addIssueToContext(st,{code:ZodIssueCode.invalid_string,validation:"time",message:at.message}),et.dirty()):at.kind==="duration"?durationRegex.test(g.data)||(st=this._getOrReturnCtx(g,st),addIssueToContext(st,{validation:"duration",code:ZodIssueCode.invalid_string,message:at.message}),et.dirty()):at.kind==="ip"?isValidIP(g.data,at.version)||(st=this._getOrReturnCtx(g,st),addIssueToContext(st,{validation:"ip",code:ZodIssueCode.invalid_string,message:at.message}),et.dirty()):at.kind==="base64"?base64Regex.test(g.data)||(st=this._getOrReturnCtx(g,st),addIssueToContext(st,{validation:"base64",code:ZodIssueCode.invalid_string,message:at.message}),et.dirty()):util.assertNever(at);return{status:et.value,value:g.data}}_regex(g,b,et){return this.refinement(st=>g.test(st),{validation:b,code:ZodIssueCode.invalid_string,...errorUtil.errToObj(et)})}_addCheck(g){return new ZodString({...this._def,checks:[...this._def.checks,g]})}email(g){return this._addCheck({kind:"email",...errorUtil.errToObj(g)})}url(g){return this._addCheck({kind:"url",...errorUtil.errToObj(g)})}emoji(g){return this._addCheck({kind:"emoji",...errorUtil.errToObj(g)})}uuid(g){return this._addCheck({kind:"uuid",...errorUtil.errToObj(g)})}nanoid(g){return this._addCheck({kind:"nanoid",...errorUtil.errToObj(g)})}cuid(g){return this._addCheck({kind:"cuid",...errorUtil.errToObj(g)})}cuid2(g){return this._addCheck({kind:"cuid2",...errorUtil.errToObj(g)})}ulid(g){return this._addCheck({kind:"ulid",...errorUtil.errToObj(g)})}base64(g){return this._addCheck({kind:"base64",...errorUtil.errToObj(g)})}ip(g){return this._addCheck({kind:"ip",...errorUtil.errToObj(g)})}datetime(g){var b,et;return typeof g=="string"?this._addCheck({kind:"datetime",precision:null,offset:!1,local:!1,message:g}):this._addCheck({kind:"datetime",precision:typeof(g==null?void 0:g.precision)>"u"?null:g==null?void 0:g.precision,offset:(b=g==null?void 0:g.offset)!==null&&b!==void 0?b:!1,local:(et=g==null?void 0:g.local)!==null&&et!==void 0?et:!1,...errorUtil.errToObj(g==null?void 0:g.message)})}date(g){return this._addCheck({kind:"date",message:g})}time(g){return typeof g=="string"?this._addCheck({kind:"time",precision:null,message:g}):this._addCheck({kind:"time",precision:typeof(g==null?void 0:g.precision)>"u"?null:g==null?void 0:g.precision,...errorUtil.errToObj(g==null?void 0:g.message)})}duration(g){return this._addCheck({kind:"duration",...errorUtil.errToObj(g)})}regex(g,b){return this._addCheck({kind:"regex",regex:g,...errorUtil.errToObj(b)})}includes(g,b){return this._addCheck({kind:"includes",value:g,position:b==null?void 0:b.position,...errorUtil.errToObj(b==null?void 0:b.message)})}startsWith(g,b){return this._addCheck({kind:"startsWith",value:g,...errorUtil.errToObj(b)})}endsWith(g,b){return this._addCheck({kind:"endsWith",value:g,...errorUtil.errToObj(b)})}min(g,b){return this._addCheck({kind:"min",value:g,...errorUtil.errToObj(b)})}max(g,b){return this._addCheck({kind:"max",value:g,...errorUtil.errToObj(b)})}length(g,b){return this._addCheck({kind:"length",value:g,...errorUtil.errToObj(b)})}nonempty(g){return this.min(1,errorUtil.errToObj(g))}trim(){return new ZodString({...this._def,checks:[...this._def.checks,{kind:"trim"}]})}toLowerCase(){return new ZodString({...this._def,checks:[...this._def.checks,{kind:"toLowerCase"}]})}toUpperCase(){return new ZodString({...this._def,checks:[...this._def.checks,{kind:"toUpperCase"}]})}get isDatetime(){return!!this._def.checks.find(g=>g.kind==="datetime")}get isDate(){return!!this._def.checks.find(g=>g.kind==="date")}get isTime(){return!!this._def.checks.find(g=>g.kind==="time")}get isDuration(){return!!this._def.checks.find(g=>g.kind==="duration")}get isEmail(){return!!this._def.checks.find(g=>g.kind==="email")}get isURL(){return!!this._def.checks.find(g=>g.kind==="url")}get isEmoji(){return!!this._def.checks.find(g=>g.kind==="emoji")}get isUUID(){return!!this._def.checks.find(g=>g.kind==="uuid")}get isNANOID(){return!!this._def.checks.find(g=>g.kind==="nanoid")}get isCUID(){return!!this._def.checks.find(g=>g.kind==="cuid")}get isCUID2(){return!!this._def.checks.find(g=>g.kind==="cuid2")}get isULID(){return!!this._def.checks.find(g=>g.kind==="ulid")}get isIP(){return!!this._def.checks.find(g=>g.kind==="ip")}get isBase64(){return!!this._def.checks.find(g=>g.kind==="base64")}get minLength(){let g=null;for(const b of this._def.checks)b.kind==="min"&&(g===null||b.value>g)&&(g=b.value);return g}get maxLength(){let g=null;for(const b of this._def.checks)b.kind==="max"&&(g===null||b.value<g)&&(g=b.value);return g}}ZodString.create=d=>{var g;return new ZodString({checks:[],typeName:ZodFirstPartyTypeKind.ZodString,coerce:(g=d==null?void 0:d.coerce)!==null&&g!==void 0?g:!1,...processCreateParams(d)})};function floatSafeRemainder(d,g){const b=(d.toString().split(".")[1]||"").length,et=(g.toString().split(".")[1]||"").length,st=b>et?b:et,at=parseInt(d.toFixed(st).replace(".","")),vt=parseInt(g.toFixed(st).replace(".",""));return at%vt/Math.pow(10,st)}class ZodNumber extends ZodType{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte,this.step=this.multipleOf}_parse(g){if(this._def.coerce&&(g.data=Number(g.data)),this._getType(g)!==ZodParsedType.number){const at=this._getOrReturnCtx(g);return addIssueToContext(at,{code:ZodIssueCode.invalid_type,expected:ZodParsedType.number,received:at.parsedType}),INVALID}let et;const st=new ParseStatus;for(const at of this._def.checks)at.kind==="int"?util.isInteger(g.data)||(et=this._getOrReturnCtx(g,et),addIssueToContext(et,{code:ZodIssueCode.invalid_type,expected:"integer",received:"float",message:at.message}),st.dirty()):at.kind==="min"?(at.inclusive?g.data<at.value:g.data<=at.value)&&(et=this._getOrReturnCtx(g,et),addIssueToContext(et,{code:ZodIssueCode.too_small,minimum:at.value,type:"number",inclusive:at.inclusive,exact:!1,message:at.message}),st.dirty()):at.kind==="max"?(at.inclusive?g.data>at.value:g.data>=at.value)&&(et=this._getOrReturnCtx(g,et),addIssueToContext(et,{code:ZodIssueCode.too_big,maximum:at.value,type:"number",inclusive:at.inclusive,exact:!1,message:at.message}),st.dirty()):at.kind==="multipleOf"?floatSafeRemainder(g.data,at.value)!==0&&(et=this._getOrReturnCtx(g,et),addIssueToContext(et,{code:ZodIssueCode.not_multiple_of,multipleOf:at.value,message:at.message}),st.dirty()):at.kind==="finite"?Number.isFinite(g.data)||(et=this._getOrReturnCtx(g,et),addIssueToContext(et,{code:ZodIssueCode.not_finite,message:at.message}),st.dirty()):util.assertNever(at);return{status:st.value,value:g.data}}gte(g,b){return this.setLimit("min",g,!0,errorUtil.toString(b))}gt(g,b){return this.setLimit("min",g,!1,errorUtil.toString(b))}lte(g,b){return this.setLimit("max",g,!0,errorUtil.toString(b))}lt(g,b){return this.setLimit("max",g,!1,errorUtil.toString(b))}setLimit(g,b,et,st){return new ZodNumber({...this._def,checks:[...this._def.checks,{kind:g,value:b,inclusive:et,message:errorUtil.toString(st)}]})}_addCheck(g){return new ZodNumber({...this._def,checks:[...this._def.checks,g]})}int(g){return this._addCheck({kind:"int",message:errorUtil.toString(g)})}positive(g){return this._addCheck({kind:"min",value:0,inclusive:!1,message:errorUtil.toString(g)})}negative(g){return this._addCheck({kind:"max",value:0,inclusive:!1,message:errorUtil.toString(g)})}nonpositive(g){return this._addCheck({kind:"max",value:0,inclusive:!0,message:errorUtil.toString(g)})}nonnegative(g){return this._addCheck({kind:"min",value:0,inclusive:!0,message:errorUtil.toString(g)})}multipleOf(g,b){return this._addCheck({kind:"multipleOf",value:g,message:errorUtil.toString(b)})}finite(g){return this._addCheck({kind:"finite",message:errorUtil.toString(g)})}safe(g){return this._addCheck({kind:"min",inclusive:!0,value:Number.MIN_SAFE_INTEGER,message:errorUtil.toString(g)})._addCheck({kind:"max",inclusive:!0,value:Number.MAX_SAFE_INTEGER,message:errorUtil.toString(g)})}get minValue(){let g=null;for(const b of this._def.checks)b.kind==="min"&&(g===null||b.value>g)&&(g=b.value);return g}get maxValue(){let g=null;for(const b of this._def.checks)b.kind==="max"&&(g===null||b.value<g)&&(g=b.value);return g}get isInt(){return!!this._def.checks.find(g=>g.kind==="int"||g.kind==="multipleOf"&&util.isInteger(g.value))}get isFinite(){let g=null,b=null;for(const et of this._def.checks){if(et.kind==="finite"||et.kind==="int"||et.kind==="multipleOf")return!0;et.kind==="min"?(b===null||et.value>b)&&(b=et.value):et.kind==="max"&&(g===null||et.value<g)&&(g=et.value)}return Number.isFinite(b)&&Number.isFinite(g)}}ZodNumber.create=d=>new ZodNumber({checks:[],typeName:ZodFirstPartyTypeKind.ZodNumber,coerce:(d==null?void 0:d.coerce)||!1,...processCreateParams(d)});class ZodBigInt extends ZodType{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte}_parse(g){if(this._def.coerce&&(g.data=BigInt(g.data)),this._getType(g)!==ZodParsedType.bigint){const at=this._getOrReturnCtx(g);return addIssueToContext(at,{code:ZodIssueCode.invalid_type,expected:ZodParsedType.bigint,received:at.parsedType}),INVALID}let et;const st=new ParseStatus;for(const at of this._def.checks)at.kind==="min"?(at.inclusive?g.data<at.value:g.data<=at.value)&&(et=this._getOrReturnCtx(g,et),addIssueToContext(et,{code:ZodIssueCode.too_small,type:"bigint",minimum:at.value,inclusive:at.inclusive,message:at.message}),st.dirty()):at.kind==="max"?(at.inclusive?g.data>at.value:g.data>=at.value)&&(et=this._getOrReturnCtx(g,et),addIssueToContext(et,{code:ZodIssueCode.too_big,type:"bigint",maximum:at.value,inclusive:at.inclusive,message:at.message}),st.dirty()):at.kind==="multipleOf"?g.data%at.value!==BigInt(0)&&(et=this._getOrReturnCtx(g,et),addIssueToContext(et,{code:ZodIssueCode.not_multiple_of,multipleOf:at.value,message:at.message}),st.dirty()):util.assertNever(at);return{status:st.value,value:g.data}}gte(g,b){return this.setLimit("min",g,!0,errorUtil.toString(b))}gt(g,b){return this.setLimit("min",g,!1,errorUtil.toString(b))}lte(g,b){return this.setLimit("max",g,!0,errorUtil.toString(b))}lt(g,b){return this.setLimit("max",g,!1,errorUtil.toString(b))}setLimit(g,b,et,st){return new ZodBigInt({...this._def,checks:[...this._def.checks,{kind:g,value:b,inclusive:et,message:errorUtil.toString(st)}]})}_addCheck(g){return new ZodBigInt({...this._def,checks:[...this._def.checks,g]})}positive(g){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!1,message:errorUtil.toString(g)})}negative(g){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!1,message:errorUtil.toString(g)})}nonpositive(g){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!0,message:errorUtil.toString(g)})}nonnegative(g){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!0,message:errorUtil.toString(g)})}multipleOf(g,b){return this._addCheck({kind:"multipleOf",value:g,message:errorUtil.toString(b)})}get minValue(){let g=null;for(const b of this._def.checks)b.kind==="min"&&(g===null||b.value>g)&&(g=b.value);return g}get maxValue(){let g=null;for(const b of this._def.checks)b.kind==="max"&&(g===null||b.value<g)&&(g=b.value);return g}}ZodBigInt.create=d=>{var g;return new ZodBigInt({checks:[],typeName:ZodFirstPartyTypeKind.ZodBigInt,coerce:(g=d==null?void 0:d.coerce)!==null&&g!==void 0?g:!1,...processCreateParams(d)})};class ZodBoolean extends ZodType{_parse(g){if(this._def.coerce&&(g.data=!!g.data),this._getType(g)!==ZodParsedType.boolean){const et=this._getOrReturnCtx(g);return addIssueToContext(et,{code:ZodIssueCode.invalid_type,expected:ZodParsedType.boolean,received:et.parsedType}),INVALID}return OK(g.data)}}ZodBoolean.create=d=>new ZodBoolean({typeName:ZodFirstPartyTypeKind.ZodBoolean,coerce:(d==null?void 0:d.coerce)||!1,...processCreateParams(d)});class ZodDate extends ZodType{_parse(g){if(this._def.coerce&&(g.data=new Date(g.data)),this._getType(g)!==ZodParsedType.date){const at=this._getOrReturnCtx(g);return addIssueToContext(at,{code:ZodIssueCode.invalid_type,expected:ZodParsedType.date,received:at.parsedType}),INVALID}if(isNaN(g.data.getTime())){const at=this._getOrReturnCtx(g);return addIssueToContext(at,{code:ZodIssueCode.invalid_date}),INVALID}const et=new ParseStatus;let st;for(const at of this._def.checks)at.kind==="min"?g.data.getTime()<at.value&&(st=this._getOrReturnCtx(g,st),addIssueToContext(st,{code:ZodIssueCode.too_small,message:at.message,inclusive:!0,exact:!1,minimum:at.value,type:"date"}),et.dirty()):at.kind==="max"?g.data.getTime()>at.value&&(st=this._getOrReturnCtx(g,st),addIssueToContext(st,{code:ZodIssueCode.too_big,message:at.message,inclusive:!0,exact:!1,maximum:at.value,type:"date"}),et.dirty()):util.assertNever(at);return{status:et.value,value:new Date(g.data.getTime())}}_addCheck(g){return new ZodDate({...this._def,checks:[...this._def.checks,g]})}min(g,b){return this._addCheck({kind:"min",value:g.getTime(),message:errorUtil.toString(b)})}max(g,b){return this._addCheck({kind:"max",value:g.getTime(),message:errorUtil.toString(b)})}get minDate(){let g=null;for(const b of this._def.checks)b.kind==="min"&&(g===null||b.value>g)&&(g=b.value);return g!=null?new Date(g):null}get maxDate(){let g=null;for(const b of this._def.checks)b.kind==="max"&&(g===null||b.value<g)&&(g=b.value);return g!=null?new Date(g):null}}ZodDate.create=d=>new ZodDate({checks:[],coerce:(d==null?void 0:d.coerce)||!1,typeName:ZodFirstPartyTypeKind.ZodDate,...processCreateParams(d)});class ZodSymbol extends ZodType{_parse(g){if(this._getType(g)!==ZodParsedType.symbol){const et=this._getOrReturnCtx(g);return addIssueToContext(et,{code:ZodIssueCode.invalid_type,expected:ZodParsedType.symbol,received:et.parsedType}),INVALID}return OK(g.data)}}ZodSymbol.create=d=>new ZodSymbol({typeName:ZodFirstPartyTypeKind.ZodSymbol,...processCreateParams(d)});class ZodUndefined extends ZodType{_parse(g){if(this._getType(g)!==ZodParsedType.undefined){const et=this._getOrReturnCtx(g);return addIssueToContext(et,{code:ZodIssueCode.invalid_type,expected:ZodParsedType.undefined,received:et.parsedType}),INVALID}return OK(g.data)}}ZodUndefined.create=d=>new ZodUndefined({typeName:ZodFirstPartyTypeKind.ZodUndefined,...processCreateParams(d)});class ZodNull extends ZodType{_parse(g){if(this._getType(g)!==ZodParsedType.null){const et=this._getOrReturnCtx(g);return addIssueToContext(et,{code:ZodIssueCode.invalid_type,expected:ZodParsedType.null,received:et.parsedType}),INVALID}return OK(g.data)}}ZodNull.create=d=>new ZodNull({typeName:ZodFirstPartyTypeKind.ZodNull,...processCreateParams(d)});class ZodAny extends ZodType{constructor(){super(...arguments),this._any=!0}_parse(g){return OK(g.data)}}ZodAny.create=d=>new ZodAny({typeName:ZodFirstPartyTypeKind.ZodAny,...processCreateParams(d)});class ZodUnknown extends ZodType{constructor(){super(...arguments),this._unknown=!0}_parse(g){return OK(g.data)}}ZodUnknown.create=d=>new ZodUnknown({typeName:ZodFirstPartyTypeKind.ZodUnknown,...processCreateParams(d)});class ZodNever extends ZodType{_parse(g){const b=this._getOrReturnCtx(g);return addIssueToContext(b,{code:ZodIssueCode.invalid_type,expected:ZodParsedType.never,received:b.parsedType}),INVALID}}ZodNever.create=d=>new ZodNever({typeName:ZodFirstPartyTypeKind.ZodNever,...processCreateParams(d)});class ZodVoid extends ZodType{_parse(g){if(this._getType(g)!==ZodParsedType.undefined){const et=this._getOrReturnCtx(g);return addIssueToContext(et,{code:ZodIssueCode.invalid_type,expected:ZodParsedType.void,received:et.parsedType}),INVALID}return OK(g.data)}}ZodVoid.create=d=>new ZodVoid({typeName:ZodFirstPartyTypeKind.ZodVoid,...processCreateParams(d)});class ZodArray extends ZodType{_parse(g){const{ctx:b,status:et}=this._processInputParams(g),st=this._def;if(b.parsedType!==ZodParsedType.array)return addIssueToContext(b,{code:ZodIssueCode.invalid_type,expected:ZodParsedType.array,received:b.parsedType}),INVALID;if(st.exactLength!==null){const vt=b.data.length>st.exactLength.value,Tt=b.data.length<st.exactLength.value;(vt||Tt)&&(addIssueToContext(b,{code:vt?ZodIssueCode.too_big:ZodIssueCode.too_small,minimum:Tt?st.exactLength.value:void 0,maximum:vt?st.exactLength.value:void 0,type:"array",inclusive:!0,exact:!0,message:st.exactLength.message}),et.dirty())}if(st.minLength!==null&&b.data.length<st.minLength.value&&(addIssueToContext(b,{code:ZodIssueCode.too_small,minimum:st.minLength.value,type:"array",inclusive:!0,exact:!1,message:st.minLength.message}),et.dirty()),st.maxLength!==null&&b.data.length>st.maxLength.value&&(addIssueToContext(b,{code:ZodIssueCode.too_big,maximum:st.maxLength.value,type:"array",inclusive:!0,exact:!1,message:st.maxLength.message}),et.dirty()),b.common.async)return Promise.all([...b.data].map((vt,Tt)=>st.type._parseAsync(new ParseInputLazyPath(b,vt,b.path,Tt)))).then(vt=>ParseStatus.mergeArray(et,vt));const at=[...b.data].map((vt,Tt)=>st.type._parseSync(new ParseInputLazyPath(b,vt,b.path,Tt)));return ParseStatus.mergeArray(et,at)}get element(){return this._def.type}min(g,b){return new ZodArray({...this._def,minLength:{value:g,message:errorUtil.toString(b)}})}max(g,b){return new ZodArray({...this._def,maxLength:{value:g,message:errorUtil.toString(b)}})}length(g,b){return new ZodArray({...this._def,exactLength:{value:g,message:errorUtil.toString(b)}})}nonempty(g){return this.min(1,g)}}ZodArray.create=(d,g)=>new ZodArray({type:d,minLength:null,maxLength:null,exactLength:null,typeName:ZodFirstPartyTypeKind.ZodArray,...processCreateParams(g)});function deepPartialify(d){if(d instanceof ZodObject){const g={};for(const b in d.shape){const et=d.shape[b];g[b]=ZodOptional.create(deepPartialify(et))}return new ZodObject({...d._def,shape:()=>g})}else return d instanceof ZodArray?new ZodArray({...d._def,type:deepPartialify(d.element)}):d instanceof ZodOptional?ZodOptional.create(deepPartialify(d.unwrap())):d instanceof ZodNullable?ZodNullable.create(deepPartialify(d.unwrap())):d instanceof ZodTuple?ZodTuple.create(d.items.map(g=>deepPartialify(g))):d}class ZodObject extends ZodType{constructor(){super(...arguments),this._cached=null,this.nonstrict=this.passthrough,this.augment=this.extend}_getCached(){if(this._cached!==null)return this._cached;const g=this._def.shape(),b=util.objectKeys(g);return this._cached={shape:g,keys:b}}_parse(g){if(this._getType(g)!==ZodParsedType.object){const pt=this._getOrReturnCtx(g);return addIssueToContext(pt,{code:ZodIssueCode.invalid_type,expected:ZodParsedType.object,received:pt.parsedType}),INVALID}const{status:et,ctx:st}=this._processInputParams(g),{shape:at,keys:vt}=this._getCached(),Tt=[];if(!(this._def.catchall instanceof ZodNever&&this._def.unknownKeys==="strip"))for(const pt in st.data)vt.includes(pt)||Tt.push(pt);const Ct=[];for(const pt of vt){const wt=at[pt],$t=st.data[pt];Ct.push({key:{status:"valid",value:pt},value:wt._parse(new ParseInputLazyPath(st,$t,st.path,pt)),alwaysSet:pt in st.data})}if(this._def.catchall instanceof ZodNever){const pt=this._def.unknownKeys;if(pt==="passthrough")for(const wt of Tt)Ct.push({key:{status:"valid",value:wt},value:{status:"valid",value:st.data[wt]}});else if(pt==="strict")Tt.length>0&&(addIssueToContext(st,{code:ZodIssueCode.unrecognized_keys,keys:Tt}),et.dirty());else if(pt!=="strip")throw new Error("Internal ZodObject error: invalid unknownKeys value.")}else{const pt=this._def.catchall;for(const wt of Tt){const $t=st.data[wt];Ct.push({key:{status:"valid",value:wt},value:pt._parse(new ParseInputLazyPath(st,$t,st.path,wt)),alwaysSet:wt in st.data})}}return st.common.async?Promise.resolve().then(async()=>{const pt=[];for(const wt of Ct){const $t=await wt.key,Lt=await wt.value;pt.push({key:$t,value:Lt,alwaysSet:wt.alwaysSet})}return pt}).then(pt=>ParseStatus.mergeObjectSync(et,pt)):ParseStatus.mergeObjectSync(et,Ct)}get shape(){return this._def.shape()}strict(g){return errorUtil.errToObj,new ZodObject({...this._def,unknownKeys:"strict",...g!==void 0?{errorMap:(b,et)=>{var st,at,vt,Tt;const Ct=(vt=(at=(st=this._def).errorMap)===null||at===void 0?void 0:at.call(st,b,et).message)!==null&&vt!==void 0?vt:et.defaultError;return b.code==="unrecognized_keys"?{message:(Tt=errorUtil.errToObj(g).message)!==null&&Tt!==void 0?Tt:Ct}:{message:Ct}}}:{}})}strip(){return new ZodObject({...this._def,unknownKeys:"strip"})}passthrough(){return new ZodObject({...this._def,unknownKeys:"passthrough"})}extend(g){return new ZodObject({...this._def,shape:()=>({...this._def.shape(),...g})})}merge(g){return new ZodObject({unknownKeys:g._def.unknownKeys,catchall:g._def.catchall,shape:()=>({...this._def.shape(),...g._def.shape()}),typeName:ZodFirstPartyTypeKind.ZodObject})}setKey(g,b){return this.augment({[g]:b})}catchall(g){return new ZodObject({...this._def,catchall:g})}pick(g){const b={};return util.objectKeys(g).forEach(et=>{g[et]&&this.shape[et]&&(b[et]=this.shape[et])}),new ZodObject({...this._def,shape:()=>b})}omit(g){const b={};return util.objectKeys(this.shape).forEach(et=>{g[et]||(b[et]=this.shape[et])}),new ZodObject({...this._def,shape:()=>b})}deepPartial(){return deepPartialify(this)}partial(g){const b={};return util.objectKeys(this.shape).forEach(et=>{const st=this.shape[et];g&&!g[et]?b[et]=st:b[et]=st.optional()}),new ZodObject({...this._def,shape:()=>b})}required(g){const b={};return util.objectKeys(this.shape).forEach(et=>{if(g&&!g[et])b[et]=this.shape[et];else{let at=this.shape[et];for(;at instanceof ZodOptional;)at=at._def.innerType;b[et]=at}}),new ZodObject({...this._def,shape:()=>b})}keyof(){return createZodEnum(util.objectKeys(this.shape))}}ZodObject.create=(d,g)=>new ZodObject({shape:()=>d,unknownKeys:"strip",catchall:ZodNever.create(),typeName:ZodFirstPartyTypeKind.ZodObject,...processCreateParams(g)});ZodObject.strictCreate=(d,g)=>new ZodObject({shape:()=>d,unknownKeys:"strict",catchall:ZodNever.create(),typeName:ZodFirstPartyTypeKind.ZodObject,...processCreateParams(g)});ZodObject.lazycreate=(d,g)=>new ZodObject({shape:d,unknownKeys:"strip",catchall:ZodNever.create(),typeName:ZodFirstPartyTypeKind.ZodObject,...processCreateParams(g)});class ZodUnion extends ZodType{_parse(g){const{ctx:b}=this._processInputParams(g),et=this._def.options;function st(at){for(const Tt of at)if(Tt.result.status==="valid")return Tt.result;for(const Tt of at)if(Tt.result.status==="dirty")return b.common.issues.push(...Tt.ctx.common.issues),Tt.result;const vt=at.map(Tt=>new ZodError(Tt.ctx.common.issues));return addIssueToContext(b,{code:ZodIssueCode.invalid_union,unionErrors:vt}),INVALID}if(b.common.async)return Promise.all(et.map(async at=>{const vt={...b,common:{...b.common,issues:[]},parent:null};return{result:await at._parseAsync({data:b.data,path:b.path,parent:vt}),ctx:vt}})).then(st);{let at;const vt=[];for(const Ct of et){const pt={...b,common:{...b.common,issues:[]},parent:null},wt=Ct._parseSync({data:b.data,path:b.path,parent:pt});if(wt.status==="valid")return wt;wt.status==="dirty"&&!at&&(at={result:wt,ctx:pt}),pt.common.issues.length&&vt.push(pt.common.issues)}if(at)return b.common.issues.push(...at.ctx.common.issues),at.result;const Tt=vt.map(Ct=>new ZodError(Ct));return addIssueToContext(b,{code:ZodIssueCode.invalid_union,unionErrors:Tt}),INVALID}}get options(){return this._def.options}}ZodUnion.create=(d,g)=>new ZodUnion({options:d,typeName:ZodFirstPartyTypeKind.ZodUnion,...processCreateParams(g)});const getDiscriminator=d=>d instanceof ZodLazy?getDiscriminator(d.schema):d instanceof ZodEffects?getDiscriminator(d.innerType()):d instanceof ZodLiteral?[d.value]:d instanceof ZodEnum?d.options:d instanceof ZodNativeEnum?util.objectValues(d.enum):d instanceof ZodDefault?getDiscriminator(d._def.innerType):d instanceof ZodUndefined?[void 0]:d instanceof ZodNull?[null]:d instanceof ZodOptional?[void 0,...getDiscriminator(d.unwrap())]:d instanceof ZodNullable?[null,...getDiscriminator(d.unwrap())]:d instanceof ZodBranded||d instanceof ZodReadonly?getDiscriminator(d.unwrap()):d instanceof ZodCatch?getDiscriminator(d._def.innerType):[];class ZodDiscriminatedUnion extends ZodType{_parse(g){const{ctx:b}=this._processInputParams(g);if(b.parsedType!==ZodParsedType.object)return addIssueToContext(b,{code:ZodIssueCode.invalid_type,expected:ZodParsedType.object,received:b.parsedType}),INVALID;const et=this.discriminator,st=b.data[et],at=this.optionsMap.get(st);return at?b.common.async?at._parseAsync({data:b.data,path:b.path,parent:b}):at._parseSync({data:b.data,path:b.path,parent:b}):(addIssueToContext(b,{code:ZodIssueCode.invalid_union_discriminator,options:Array.from(this.optionsMap.keys()),path:[et]}),INVALID)}get discriminator(){return this._def.discriminator}get options(){return this._def.options}get optionsMap(){return this._def.optionsMap}static create(g,b,et){const st=new Map;for(const at of b){const vt=getDiscriminator(at.shape[g]);if(!vt.length)throw new Error(`A discriminator value for key \`${g}\` could not be extracted from all schema options`);for(const Tt of vt){if(st.has(Tt))throw new Error(`Discriminator property ${String(g)} has duplicate value ${String(Tt)}`);st.set(Tt,at)}}return new ZodDiscriminatedUnion({typeName:ZodFirstPartyTypeKind.ZodDiscriminatedUnion,discriminator:g,options:b,optionsMap:st,...processCreateParams(et)})}}function mergeValues(d,g){const b=getParsedType(d),et=getParsedType(g);if(d===g)return{valid:!0,data:d};if(b===ZodParsedType.object&&et===ZodParsedType.object){const st=util.objectKeys(g),at=util.objectKeys(d).filter(Tt=>st.indexOf(Tt)!==-1),vt={...d,...g};for(const Tt of at){const Ct=mergeValues(d[Tt],g[Tt]);if(!Ct.valid)return{valid:!1};vt[Tt]=Ct.data}return{valid:!0,data:vt}}else if(b===ZodParsedType.array&&et===ZodParsedType.array){if(d.length!==g.length)return{valid:!1};const st=[];for(let at=0;at<d.length;at++){const vt=d[at],Tt=g[at],Ct=mergeValues(vt,Tt);if(!Ct.valid)return{valid:!1};st.push(Ct.data)}return{valid:!0,data:st}}else return b===ZodParsedType.date&&et===ZodParsedType.date&&+d==+g?{valid:!0,data:d}:{valid:!1}}class ZodIntersection extends ZodType{_parse(g){const{status:b,ctx:et}=this._processInputParams(g),st=(at,vt)=>{if(isAborted(at)||isAborted(vt))return INVALID;const Tt=mergeValues(at.value,vt.value);return Tt.valid?((isDirty(at)||isDirty(vt))&&b.dirty(),{status:b.value,value:Tt.data}):(addIssueToContext(et,{code:ZodIssueCode.invalid_intersection_types}),INVALID)};return et.common.async?Promise.all([this._def.left._parseAsync({data:et.data,path:et.path,parent:et}),this._def.right._parseAsync({data:et.data,path:et.path,parent:et})]).then(([at,vt])=>st(at,vt)):st(this._def.left._parseSync({data:et.data,path:et.path,parent:et}),this._def.right._parseSync({data:et.data,path:et.path,parent:et}))}}ZodIntersection.create=(d,g,b)=>new ZodIntersection({left:d,right:g,typeName:ZodFirstPartyTypeKind.ZodIntersection,...processCreateParams(b)});class ZodTuple extends ZodType{_parse(g){const{status:b,ctx:et}=this._processInputParams(g);if(et.parsedType!==ZodParsedType.array)return addIssueToContext(et,{code:ZodIssueCode.invalid_type,expected:ZodParsedType.array,received:et.parsedType}),INVALID;if(et.data.length<this._def.items.length)return addIssueToContext(et,{code:ZodIssueCode.too_small,minimum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),INVALID;!this._def.rest&&et.data.length>this._def.items.length&&(addIssueToContext(et,{code:ZodIssueCode.too_big,maximum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),b.dirty());const at=[...et.data].map((vt,Tt)=>{const Ct=this._def.items[Tt]||this._def.rest;return Ct?Ct._parse(new ParseInputLazyPath(et,vt,et.path,Tt)):null}).filter(vt=>!!vt);return et.common.async?Promise.all(at).then(vt=>ParseStatus.mergeArray(b,vt)):ParseStatus.mergeArray(b,at)}get items(){return this._def.items}rest(g){return new ZodTuple({...this._def,rest:g})}}ZodTuple.create=(d,g)=>{if(!Array.isArray(d))throw new Error("You must pass an array of schemas to z.tuple([ ... ])");return new ZodTuple({items:d,typeName:ZodFirstPartyTypeKind.ZodTuple,rest:null,...processCreateParams(g)})};class ZodRecord extends ZodType{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(g){const{status:b,ctx:et}=this._processInputParams(g);if(et.parsedType!==ZodParsedType.object)return addIssueToContext(et,{code:ZodIssueCode.invalid_type,expected:ZodParsedType.object,received:et.parsedType}),INVALID;const st=[],at=this._def.keyType,vt=this._def.valueType;for(const Tt in et.data)st.push({key:at._parse(new ParseInputLazyPath(et,Tt,et.path,Tt)),value:vt._parse(new ParseInputLazyPath(et,et.data[Tt],et.path,Tt)),alwaysSet:Tt in et.data});return et.common.async?ParseStatus.mergeObjectAsync(b,st):ParseStatus.mergeObjectSync(b,st)}get element(){return this._def.valueType}static create(g,b,et){return b instanceof ZodType?new ZodRecord({keyType:g,valueType:b,typeName:ZodFirstPartyTypeKind.ZodRecord,...processCreateParams(et)}):new ZodRecord({keyType:ZodString.create(),valueType:g,typeName:ZodFirstPartyTypeKind.ZodRecord,...processCreateParams(b)})}}class ZodMap extends ZodType{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(g){const{status:b,ctx:et}=this._processInputParams(g);if(et.parsedType!==ZodParsedType.map)return addIssueToContext(et,{code:ZodIssueCode.invalid_type,expected:ZodParsedType.map,received:et.parsedType}),INVALID;const st=this._def.keyType,at=this._def.valueType,vt=[...et.data.entries()].map(([Tt,Ct],pt)=>({key:st._parse(new ParseInputLazyPath(et,Tt,et.path,[pt,"key"])),value:at._parse(new ParseInputLazyPath(et,Ct,et.path,[pt,"value"]))}));if(et.common.async){const Tt=new Map;return Promise.resolve().then(async()=>{for(const Ct of vt){const pt=await Ct.key,wt=await Ct.value;if(pt.status==="aborted"||wt.status==="aborted")return INVALID;(pt.status==="dirty"||wt.status==="dirty")&&b.dirty(),Tt.set(pt.value,wt.value)}return{status:b.value,value:Tt}})}else{const Tt=new Map;for(const Ct of vt){const pt=Ct.key,wt=Ct.value;if(pt.status==="aborted"||wt.status==="aborted")return INVALID;(pt.status==="dirty"||wt.status==="dirty")&&b.dirty(),Tt.set(pt.value,wt.value)}return{status:b.value,value:Tt}}}}ZodMap.create=(d,g,b)=>new ZodMap({valueType:g,keyType:d,typeName:ZodFirstPartyTypeKind.ZodMap,...processCreateParams(b)});class ZodSet extends ZodType{_parse(g){const{status:b,ctx:et}=this._processInputParams(g);if(et.parsedType!==ZodParsedType.set)return addIssueToContext(et,{code:ZodIssueCode.invalid_type,expected:ZodParsedType.set,received:et.parsedType}),INVALID;const st=this._def;st.minSize!==null&&et.data.size<st.minSize.value&&(addIssueToContext(et,{code:ZodIssueCode.too_small,minimum:st.minSize.value,type:"set",inclusive:!0,exact:!1,message:st.minSize.message}),b.dirty()),st.maxSize!==null&&et.data.size>st.maxSize.value&&(addIssueToContext(et,{code:ZodIssueCode.too_big,maximum:st.maxSize.value,type:"set",inclusive:!0,exact:!1,message:st.maxSize.message}),b.dirty());const at=this._def.valueType;function vt(Ct){const pt=new Set;for(const wt of Ct){if(wt.status==="aborted")return INVALID;wt.status==="dirty"&&b.dirty(),pt.add(wt.value)}return{status:b.value,value:pt}}const Tt=[...et.data.values()].map((Ct,pt)=>at._parse(new ParseInputLazyPath(et,Ct,et.path,pt)));return et.common.async?Promise.all(Tt).then(Ct=>vt(Ct)):vt(Tt)}min(g,b){return new ZodSet({...this._def,minSize:{value:g,message:errorUtil.toString(b)}})}max(g,b){return new ZodSet({...this._def,maxSize:{value:g,message:errorUtil.toString(b)}})}size(g,b){return this.min(g,b).max(g,b)}nonempty(g){return this.min(1,g)}}ZodSet.create=(d,g)=>new ZodSet({valueType:d,minSize:null,maxSize:null,typeName:ZodFirstPartyTypeKind.ZodSet,...processCreateParams(g)});class ZodFunction extends ZodType{constructor(){super(...arguments),this.validate=this.implement}_parse(g){const{ctx:b}=this._processInputParams(g);if(b.parsedType!==ZodParsedType.function)return addIssueToContext(b,{code:ZodIssueCode.invalid_type,expected:ZodParsedType.function,received:b.parsedType}),INVALID;function et(Tt,Ct){return makeIssue({data:Tt,path:b.path,errorMaps:[b.common.contextualErrorMap,b.schemaErrorMap,getErrorMap(),errorMap].filter(pt=>!!pt),issueData:{code:ZodIssueCode.invalid_arguments,argumentsError:Ct}})}function st(Tt,Ct){return makeIssue({data:Tt,path:b.path,errorMaps:[b.common.contextualErrorMap,b.schemaErrorMap,getErrorMap(),errorMap].filter(pt=>!!pt),issueData:{code:ZodIssueCode.invalid_return_type,returnTypeError:Ct}})}const at={errorMap:b.common.contextualErrorMap},vt=b.data;if(this._def.returns instanceof ZodPromise){const Tt=this;return OK(async function(...Ct){const pt=new ZodError([]),wt=await Tt._def.args.parseAsync(Ct,at).catch(jt=>{throw pt.addIssue(et(Ct,jt)),pt}),$t=await Reflect.apply(vt,this,wt);return await Tt._def.returns._def.type.parseAsync($t,at).catch(jt=>{throw pt.addIssue(st($t,jt)),pt})})}else{const Tt=this;return OK(function(...Ct){const pt=Tt._def.args.safeParse(Ct,at);if(!pt.success)throw new ZodError([et(Ct,pt.error)]);const wt=Reflect.apply(vt,this,pt.data),$t=Tt._def.returns.safeParse(wt,at);if(!$t.success)throw new ZodError([st(wt,$t.error)]);return $t.data})}}parameters(){return this._def.args}returnType(){return this._def.returns}args(...g){return new ZodFunction({...this._def,args:ZodTuple.create(g).rest(ZodUnknown.create())})}returns(g){return new ZodFunction({...this._def,returns:g})}implement(g){return this.parse(g)}strictImplement(g){return this.parse(g)}static create(g,b,et){return new ZodFunction({args:g||ZodTuple.create([]).rest(ZodUnknown.create()),returns:b||ZodUnknown.create(),typeName:ZodFirstPartyTypeKind.ZodFunction,...processCreateParams(et)})}}class ZodLazy extends ZodType{get schema(){return this._def.getter()}_parse(g){const{ctx:b}=this._processInputParams(g);return this._def.getter()._parse({data:b.data,path:b.path,parent:b})}}ZodLazy.create=(d,g)=>new ZodLazy({getter:d,typeName:ZodFirstPartyTypeKind.ZodLazy,...processCreateParams(g)});class ZodLiteral extends ZodType{_parse(g){if(g.data!==this._def.value){const b=this._getOrReturnCtx(g);return addIssueToContext(b,{received:b.data,code:ZodIssueCode.invalid_literal,expected:this._def.value}),INVALID}return{status:"valid",value:g.data}}get value(){return this._def.value}}ZodLiteral.create=(d,g)=>new ZodLiteral({value:d,typeName:ZodFirstPartyTypeKind.ZodLiteral,...processCreateParams(g)});function createZodEnum(d,g){return new ZodEnum({values:d,typeName:ZodFirstPartyTypeKind.ZodEnum,...processCreateParams(g)})}class ZodEnum extends ZodType{constructor(){super(...arguments),_ZodEnum_cache.set(this,void 0)}_parse(g){if(typeof g.data!="string"){const b=this._getOrReturnCtx(g),et=this._def.values;return addIssueToContext(b,{expected:util.joinValues(et),received:b.parsedType,code:ZodIssueCode.invalid_type}),INVALID}if(__classPrivateFieldGet(this,_ZodEnum_cache)||__classPrivateFieldSet(this,_ZodEnum_cache,new Set(this._def.values)),!__classPrivateFieldGet(this,_ZodEnum_cache).has(g.data)){const b=this._getOrReturnCtx(g),et=this._def.values;return addIssueToContext(b,{received:b.data,code:ZodIssueCode.invalid_enum_value,options:et}),INVALID}return OK(g.data)}get options(){return this._def.values}get enum(){const g={};for(const b of this._def.values)g[b]=b;return g}get Values(){const g={};for(const b of this._def.values)g[b]=b;return g}get Enum(){const g={};for(const b of this._def.values)g[b]=b;return g}extract(g,b=this._def){return ZodEnum.create(g,{...this._def,...b})}exclude(g,b=this._def){return ZodEnum.create(this.options.filter(et=>!g.includes(et)),{...this._def,...b})}}_ZodEnum_cache=new WeakMap;ZodEnum.create=createZodEnum;class ZodNativeEnum extends ZodType{constructor(){super(...arguments),_ZodNativeEnum_cache.set(this,void 0)}_parse(g){const b=util.getValidEnumValues(this._def.values),et=this._getOrReturnCtx(g);if(et.parsedType!==ZodParsedType.string&&et.parsedType!==ZodParsedType.number){const st=util.objectValues(b);return addIssueToContext(et,{expected:util.joinValues(st),received:et.parsedType,code:ZodIssueCode.invalid_type}),INVALID}if(__classPrivateFieldGet(this,_ZodNativeEnum_cache)||__classPrivateFieldSet(this,_ZodNativeEnum_cache,new Set(util.getValidEnumValues(this._def.values))),!__classPrivateFieldGet(this,_ZodNativeEnum_cache).has(g.data)){const st=util.objectValues(b);return addIssueToContext(et,{received:et.data,code:ZodIssueCode.invalid_enum_value,options:st}),INVALID}return OK(g.data)}get enum(){return this._def.values}}_ZodNativeEnum_cache=new WeakMap;ZodNativeEnum.create=(d,g)=>new ZodNativeEnum({values:d,typeName:ZodFirstPartyTypeKind.ZodNativeEnum,...processCreateParams(g)});class ZodPromise extends ZodType{unwrap(){return this._def.type}_parse(g){const{ctx:b}=this._processInputParams(g);if(b.parsedType!==ZodParsedType.promise&&b.common.async===!1)return addIssueToContext(b,{code:ZodIssueCode.invalid_type,expected:ZodParsedType.promise,received:b.parsedType}),INVALID;const et=b.parsedType===ZodParsedType.promise?b.data:Promise.resolve(b.data);return OK(et.then(st=>this._def.type.parseAsync(st,{path:b.path,errorMap:b.common.contextualErrorMap})))}}ZodPromise.create=(d,g)=>new ZodPromise({type:d,typeName:ZodFirstPartyTypeKind.ZodPromise,...processCreateParams(g)});class ZodEffects extends ZodType{innerType(){return this._def.schema}sourceType(){return this._def.schema._def.typeName===ZodFirstPartyTypeKind.ZodEffects?this._def.schema.sourceType():this._def.schema}_parse(g){const{status:b,ctx:et}=this._processInputParams(g),st=this._def.effect||null,at={addIssue:vt=>{addIssueToContext(et,vt),vt.fatal?b.abort():b.dirty()},get path(){return et.path}};if(at.addIssue=at.addIssue.bind(at),st.type==="preprocess"){const vt=st.transform(et.data,at);if(et.common.async)return Promise.resolve(vt).then(async Tt=>{if(b.value==="aborted")return INVALID;const Ct=await this._def.schema._parseAsync({data:Tt,path:et.path,parent:et});return Ct.status==="aborted"?INVALID:Ct.status==="dirty"||b.value==="dirty"?DIRTY(Ct.value):Ct});{if(b.value==="aborted")return INVALID;const Tt=this._def.schema._parseSync({data:vt,path:et.path,parent:et});return Tt.status==="aborted"?INVALID:Tt.status==="dirty"||b.value==="dirty"?DIRTY(Tt.value):Tt}}if(st.type==="refinement"){const vt=Tt=>{const Ct=st.refinement(Tt,at);if(et.common.async)return Promise.resolve(Ct);if(Ct instanceof Promise)throw new Error("Async refinement encountered during synchronous parse operation. Use .parseAsync instead.");return Tt};if(et.common.async===!1){const Tt=this._def.schema._parseSync({data:et.data,path:et.path,parent:et});return Tt.status==="aborted"?INVALID:(Tt.status==="dirty"&&b.dirty(),vt(Tt.value),{status:b.value,value:Tt.value})}else return this._def.schema._parseAsync({data:et.data,path:et.path,parent:et}).then(Tt=>Tt.status==="aborted"?INVALID:(Tt.status==="dirty"&&b.dirty(),vt(Tt.value).then(()=>({status:b.value,value:Tt.value}))))}if(st.type==="transform")if(et.common.async===!1){const vt=this._def.schema._parseSync({data:et.data,path:et.path,parent:et});if(!isValid(vt))return vt;const Tt=st.transform(vt.value,at);if(Tt instanceof Promise)throw new Error("Asynchronous transform encountered during synchronous parse operation. Use .parseAsync instead.");return{status:b.value,value:Tt}}else return this._def.schema._parseAsync({data:et.data,path:et.path,parent:et}).then(vt=>isValid(vt)?Promise.resolve(st.transform(vt.value,at)).then(Tt=>({status:b.value,value:Tt})):vt);util.assertNever(st)}}ZodEffects.create=(d,g,b)=>new ZodEffects({schema:d,typeName:ZodFirstPartyTypeKind.ZodEffects,effect:g,...processCreateParams(b)});ZodEffects.createWithPreprocess=(d,g,b)=>new ZodEffects({schema:g,effect:{type:"preprocess",transform:d},typeName:ZodFirstPartyTypeKind.ZodEffects,...processCreateParams(b)});class ZodOptional extends ZodType{_parse(g){return this._getType(g)===ZodParsedType.undefined?OK(void 0):this._def.innerType._parse(g)}unwrap(){return this._def.innerType}}ZodOptional.create=(d,g)=>new ZodOptional({innerType:d,typeName:ZodFirstPartyTypeKind.ZodOptional,...processCreateParams(g)});class ZodNullable extends ZodType{_parse(g){return this._getType(g)===ZodParsedType.null?OK(null):this._def.innerType._parse(g)}unwrap(){return this._def.innerType}}ZodNullable.create=(d,g)=>new ZodNullable({innerType:d,typeName:ZodFirstPartyTypeKind.ZodNullable,...processCreateParams(g)});class ZodDefault extends ZodType{_parse(g){const{ctx:b}=this._processInputParams(g);let et=b.data;return b.parsedType===ZodParsedType.undefined&&(et=this._def.defaultValue()),this._def.innerType._parse({data:et,path:b.path,parent:b})}removeDefault(){return this._def.innerType}}ZodDefault.create=(d,g)=>new ZodDefault({innerType:d,typeName:ZodFirstPartyTypeKind.ZodDefault,defaultValue:typeof g.default=="function"?g.default:()=>g.default,...processCreateParams(g)});class ZodCatch extends ZodType{_parse(g){const{ctx:b}=this._processInputParams(g),et={...b,common:{...b.common,issues:[]}},st=this._def.innerType._parse({data:et.data,path:et.path,parent:{...et}});return isAsync(st)?st.then(at=>({status:"valid",value:at.status==="valid"?at.value:this._def.catchValue({get error(){return new ZodError(et.common.issues)},input:et.data})})):{status:"valid",value:st.status==="valid"?st.value:this._def.catchValue({get error(){return new ZodError(et.common.issues)},input:et.data})}}removeCatch(){return this._def.innerType}}ZodCatch.create=(d,g)=>new ZodCatch({innerType:d,typeName:ZodFirstPartyTypeKind.ZodCatch,catchValue:typeof g.catch=="function"?g.catch:()=>g.catch,...processCreateParams(g)});class ZodNaN extends ZodType{_parse(g){if(this._getType(g)!==ZodParsedType.nan){const et=this._getOrReturnCtx(g);return addIssueToContext(et,{code:ZodIssueCode.invalid_type,expected:ZodParsedType.nan,received:et.parsedType}),INVALID}return{status:"valid",value:g.data}}}ZodNaN.create=d=>new ZodNaN({typeName:ZodFirstPartyTypeKind.ZodNaN,...processCreateParams(d)});const BRAND=Symbol("zod_brand");class ZodBranded extends ZodType{_parse(g){const{ctx:b}=this._processInputParams(g),et=b.data;return this._def.type._parse({data:et,path:b.path,parent:b})}unwrap(){return this._def.type}}class ZodPipeline extends ZodType{_parse(g){const{status:b,ctx:et}=this._processInputParams(g);if(et.common.async)return(async()=>{const at=await this._def.in._parseAsync({data:et.data,path:et.path,parent:et});return at.status==="aborted"?INVALID:at.status==="dirty"?(b.dirty(),DIRTY(at.value)):this._def.out._parseAsync({data:at.value,path:et.path,parent:et})})();{const st=this._def.in._parseSync({data:et.data,path:et.path,parent:et});return st.status==="aborted"?INVALID:st.status==="dirty"?(b.dirty(),{status:"dirty",value:st.value}):this._def.out._parseSync({data:st.value,path:et.path,parent:et})}}static create(g,b){return new ZodPipeline({in:g,out:b,typeName:ZodFirstPartyTypeKind.ZodPipeline})}}class ZodReadonly extends ZodType{_parse(g){const b=this._def.innerType._parse(g),et=st=>(isValid(st)&&(st.value=Object.freeze(st.value)),st);return isAsync(b)?b.then(st=>et(st)):et(b)}unwrap(){return this._def.innerType}}ZodReadonly.create=(d,g)=>new ZodReadonly({innerType:d,typeName:ZodFirstPartyTypeKind.ZodReadonly,...processCreateParams(g)});function custom(d,g={},b){return d?ZodAny.create().superRefine((et,st)=>{var at,vt;if(!d(et)){const Tt=typeof g=="function"?g(et):typeof g=="string"?{message:g}:g,Ct=(vt=(at=Tt.fatal)!==null&&at!==void 0?at:b)!==null&&vt!==void 0?vt:!0,pt=typeof Tt=="string"?{message:Tt}:Tt;st.addIssue({code:"custom",...pt,fatal:Ct})}}):ZodAny.create()}const late={object:ZodObject.lazycreate};var ZodFirstPartyTypeKind;(function(d){d.ZodString="ZodString",d.ZodNumber="ZodNumber",d.ZodNaN="ZodNaN",d.ZodBigInt="ZodBigInt",d.ZodBoolean="ZodBoolean",d.ZodDate="ZodDate",d.ZodSymbol="ZodSymbol",d.ZodUndefined="ZodUndefined",d.ZodNull="ZodNull",d.ZodAny="ZodAny",d.ZodUnknown="ZodUnknown",d.ZodNever="ZodNever",d.ZodVoid="ZodVoid",d.ZodArray="ZodArray",d.ZodObject="ZodObject",d.ZodUnion="ZodUnion",d.ZodDiscriminatedUnion="ZodDiscriminatedUnion",d.ZodIntersection="ZodIntersection",d.ZodTuple="ZodTuple",d.ZodRecord="ZodRecord",d.ZodMap="ZodMap",d.ZodSet="ZodSet",d.ZodFunction="ZodFunction",d.ZodLazy="ZodLazy",d.ZodLiteral="ZodLiteral",d.ZodEnum="ZodEnum",d.ZodEffects="ZodEffects",d.ZodNativeEnum="ZodNativeEnum",d.ZodOptional="ZodOptional",d.ZodNullable="ZodNullable",d.ZodDefault="ZodDefault",d.ZodCatch="ZodCatch",d.ZodPromise="ZodPromise",d.ZodBranded="ZodBranded",d.ZodPipeline="ZodPipeline",d.ZodReadonly="ZodReadonly"})(ZodFirstPartyTypeKind||(ZodFirstPartyTypeKind={}));const instanceOfType=(d,g={message:`Input not instance of ${d.name}`})=>custom(b=>b instanceof d,g),stringType=ZodString.create,numberType=ZodNumber.create,nanType=ZodNaN.create,bigIntType=ZodBigInt.create,booleanType=ZodBoolean.create,dateType=ZodDate.create,symbolType=ZodSymbol.create,undefinedType=ZodUndefined.create,nullType=ZodNull.create,anyType=ZodAny.create,unknownType=ZodUnknown.create,neverType=ZodNever.create,voidType=ZodVoid.create,arrayType=ZodArray.create,objectType=ZodObject.create,strictObjectType=ZodObject.strictCreate,unionType=ZodUnion.create,discriminatedUnionType=ZodDiscriminatedUnion.create,intersectionType=ZodIntersection.create,tupleType=ZodTuple.create,recordType=ZodRecord.create,mapType=ZodMap.create,setType=ZodSet.create,functionType=ZodFunction.create,lazyType=ZodLazy.create,literalType=ZodLiteral.create,enumType=ZodEnum.create,nativeEnumType=ZodNativeEnum.create,promiseType=ZodPromise.create,effectsType=ZodEffects.create,optionalType=ZodOptional.create,nullableType=ZodNullable.create,preprocessType=ZodEffects.createWithPreprocess,pipelineType=ZodPipeline.create,ostring=()=>stringType().optional(),onumber=()=>numberType().optional(),oboolean=()=>booleanType().optional(),coerce={string:d=>ZodString.create({...d,coerce:!0}),number:d=>ZodNumber.create({...d,coerce:!0}),boolean:d=>ZodBoolean.create({...d,coerce:!0}),bigint:d=>ZodBigInt.create({...d,coerce:!0}),date:d=>ZodDate.create({...d,coerce:!0})},NEVER=INVALID;var z$1=Object.freeze({__proto__:null,defaultErrorMap:errorMap,setErrorMap,getErrorMap,makeIssue,EMPTY_PATH,addIssueToContext,ParseStatus,INVALID,DIRTY,OK,isAborted,isDirty,isValid,isAsync,get util(){return util},get objectUtil(){return objectUtil},ZodParsedType,getParsedType,ZodType,datetimeRegex,ZodString,ZodNumber,ZodBigInt,ZodBoolean,ZodDate,ZodSymbol,ZodUndefined,ZodNull,ZodAny,ZodUnknown,ZodNever,ZodVoid,ZodArray,ZodObject,ZodUnion,ZodDiscriminatedUnion,ZodIntersection,ZodTuple,ZodRecord,ZodMap,ZodSet,ZodFunction,ZodLazy,ZodLiteral,ZodEnum,ZodNativeEnum,ZodPromise,ZodEffects,ZodTransformer:ZodEffects,ZodOptional,ZodNullable,ZodDefault,ZodCatch,ZodNaN,BRAND,ZodBranded,ZodPipeline,ZodReadonly,custom,Schema:ZodType,ZodSchema:ZodType,late,get ZodFirstPartyTypeKind(){return ZodFirstPartyTypeKind},coerce,any:anyType,array:arrayType,bigint:bigIntType,boolean:booleanType,date:dateType,discriminatedUnion:discriminatedUnionType,effect:effectsType,enum:enumType,function:functionType,instanceof:instanceOfType,intersection:intersectionType,lazy:lazyType,literal:literalType,map:mapType,nan:nanType,nativeEnum:nativeEnumType,never:neverType,null:nullType,nullable:nullableType,number:numberType,object:objectType,oboolean,onumber,optional:optionalType,ostring,pipeline:pipelineType,preprocess:preprocessType,promise:promiseType,record:recordType,set:setType,strictObject:strictObjectType,string:stringType,symbol:symbolType,transformer:effectsType,tuple:tupleType,undefined:undefinedType,union:unionType,unknown:unknownType,void:voidType,NEVER,ZodIssueCode,quotelessJson,ZodError});const $89eedd556c436f6a$var$DEFAULT_ORIENTATION="horizontal",$89eedd556c436f6a$var$ORIENTATIONS=["horizontal","vertical"],$89eedd556c436f6a$export$1ff3c3f08ae963c0=reactExports.forwardRef((d,g)=>{const{decorative:b,orientation:et=$89eedd556c436f6a$var$DEFAULT_ORIENTATION,...st}=d,at=$89eedd556c436f6a$var$isValidOrientation(et)?et:$89eedd556c436f6a$var$DEFAULT_ORIENTATION,Tt=b?{role:"none"}:{"aria-orientation":at==="vertical"?at:void 0,role:"separator"};return reactExports.createElement($8927f6f2acc4f386$export$250ffa63cdc0d034.div,_extends$1({"data-orientation":at},Tt,st,{ref:g}))});$89eedd556c436f6a$export$1ff3c3f08ae963c0.propTypes={orientation(d,g,b){const et=d[g],st=String(et);return et&&!$89eedd556c436f6a$var$isValidOrientation(et)?new Error($89eedd556c436f6a$var$getInvalidOrientationError(st,b)):null}};function $89eedd556c436f6a$var$getInvalidOrientationError(d,g){return`Invalid prop \`orientation\` of value \`${d}\` supplied to \`${g}\`, expected one of:
  - horizontal
  - vertical

Defaulting to \`${$89eedd556c436f6a$var$DEFAULT_ORIENTATION}\`.`}function $89eedd556c436f6a$var$isValidOrientation(d){return $89eedd556c436f6a$var$ORIENTATIONS.includes(d)}const $89eedd556c436f6a$export$be92b6f5f03c0fe9=$89eedd556c436f6a$export$1ff3c3f08ae963c0,Separator=reactExports.forwardRef(({className:d,orientation:g="horizontal",decorative:b=!0,...et},st)=>jsxRuntimeExports.jsx($89eedd556c436f6a$export$be92b6f5f03c0fe9,{ref:st,decorative:b,orientation:g,className:cn$1("shrink-0 bg-border",g==="horizontal"?"h-[1px] w-full":"h-full w-[1px]",d),...et}));Separator.displayName=$89eedd556c436f6a$export$be92b6f5f03c0fe9.displayName;const $b73a6c6685e72184$export$b04be29aa201d4f5=reactExports.forwardRef((d,g)=>reactExports.createElement($8927f6f2acc4f386$export$250ffa63cdc0d034.label,_extends$1({},d,{ref:g,onMouseDown:b=>{var et;(et=d.onMouseDown)===null||et===void 0||et.call(d,b),!b.defaultPrevented&&b.detail>1&&b.preventDefault()}}))),$b73a6c6685e72184$export$be92b6f5f03c0fe9=$b73a6c6685e72184$export$b04be29aa201d4f5,labelVariants=cva("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),Label=reactExports.forwardRef(({className:d,disabled:g,...b},et)=>jsxRuntimeExports.jsx($b73a6c6685e72184$export$be92b6f5f03c0fe9,{ref:et,className:cn$1(labelVariants(),d,g?"opacity-50":"","select-none"),...b}));Label.displayName=$b73a6c6685e72184$export$be92b6f5f03c0fe9.displayName;const Form=FormProvider,FormFieldContext=reactExports.createContext({}),FormField=({...d})=>jsxRuntimeExports.jsx(FormFieldContext.Provider,{value:{name:d.name},children:jsxRuntimeExports.jsx(Controller,{...d})}),useFormField=()=>{const d=reactExports.useContext(FormFieldContext),g=reactExports.useContext(FormItemContext),{getFieldState:b,formState:et}=useFormContext(),st=b(d.name,et);if(!d)throw new Error("useFormField should be used within <FormField>");const{id:at}=g;return{id:at,name:d.name,formItemId:`${at}-form-item`,formDescriptionId:`${at}-form-item-description`,formMessageId:`${at}-form-item-message`,...st}},FormItemContext=reactExports.createContext({}),FormItem=reactExports.forwardRef(({className:d,...g},b)=>{const et=reactExports.useId();return jsxRuntimeExports.jsx(FormItemContext.Provider,{value:{id:et},children:jsxRuntimeExports.jsx("div",{ref:b,className:cn$1("space-y-2",d),...g})})});FormItem.displayName="FormItem";const FormLabel=reactExports.forwardRef(({className:d,...g},b)=>{const{error:et,formItemId:st}=useFormField();return jsxRuntimeExports.jsx(Label,{ref:b,className:cn$1(et&&"text-destructive","text-sm",d),htmlFor:st,...g})});FormLabel.displayName="FormLabel";const FormControl=reactExports.forwardRef(({...d},g)=>{const{error:b,formItemId:et,formDescriptionId:st,formMessageId:at}=useFormField();return jsxRuntimeExports.jsx($5e63c961fc1ce211$export$8c6ed5c666ac1360,{ref:g,id:et,"aria-describedby":b?`${st} ${at}`:`${st}`,"aria-invalid":!!b,...d})});FormControl.displayName="FormControl";const FormDescription=reactExports.forwardRef(({className:d,...g},b)=>{const{formDescriptionId:et}=useFormField();return jsxRuntimeExports.jsx("p",{ref:b,id:et,className:cn$1("text-[0.8rem] text-muted-foreground",d),...g})});FormDescription.displayName="FormDescription";const FormMessage=reactExports.forwardRef(({className:d,children:g,...b},et)=>{const{error:st,formMessageId:at}=useFormField(),vt=st?String(st==null?void 0:st.message):g;return vt?jsxRuntimeExports.jsx("p",{ref:et,id:at,className:cn$1("text-[0.8rem] font-medium text-destructive",d),...b,children:vt}):null});FormMessage.displayName="FormMessage";function $010c2913dbd2fe3d$export$5cae361ad82dce8b(d){const g=reactExports.useRef({value:d,previous:d});return reactExports.useMemo(()=>(g.current.value!==d&&(g.current.previous=g.current.value,g.current.value=d),g.current.previous),[d])}const $6be4966fd9bbc698$var$SWITCH_NAME="Switch",[$6be4966fd9bbc698$var$createSwitchContext,$6be4966fd9bbc698$export$cf7f5f17f69cbd43]=$c512c27ab02ef895$export$50c7b4e9d9f19c1($6be4966fd9bbc698$var$SWITCH_NAME),[$6be4966fd9bbc698$var$SwitchProvider,$6be4966fd9bbc698$var$useSwitchContext]=$6be4966fd9bbc698$var$createSwitchContext($6be4966fd9bbc698$var$SWITCH_NAME),$6be4966fd9bbc698$export$b5d5cf8927ab7262=reactExports.forwardRef((d,g)=>{const{__scopeSwitch:b,name:et,checked:st,defaultChecked:at,required:vt,disabled:Tt,value:Ct="on",onCheckedChange:pt,...wt}=d,[$t,Lt]=reactExports.useState(null),jt=$6ed0406888f73fc4$export$c7b2cbe3552a0d05(g,Kt=>Lt(Kt)),Ft=reactExports.useRef(!1),Gt=$t?!!$t.closest("form"):!0,[Ht=!1,qt]=$71cd76cc60e0454e$export$6f32135080cb4c3({prop:st,defaultProp:at,onChange:pt});return reactExports.createElement($6be4966fd9bbc698$var$SwitchProvider,{scope:b,checked:Ht,disabled:Tt},reactExports.createElement($8927f6f2acc4f386$export$250ffa63cdc0d034.button,_extends$1({type:"button",role:"switch","aria-checked":Ht,"aria-required":vt,"data-state":$6be4966fd9bbc698$var$getState(Ht),"data-disabled":Tt?"":void 0,disabled:Tt,value:Ct},wt,{ref:jt,onClick:$e42e1063c40fb3ef$export$b9ecd428b558ff10(d.onClick,Kt=>{qt(rr=>!rr),Gt&&(Ft.current=Kt.isPropagationStopped(),Ft.current||Kt.stopPropagation())})})),Gt&&reactExports.createElement($6be4966fd9bbc698$var$BubbleInput,{control:$t,bubbles:!Ft.current,name:et,value:Ct,checked:Ht,required:vt,disabled:Tt,style:{transform:"translateX(-100%)"}}))}),$6be4966fd9bbc698$var$THUMB_NAME="SwitchThumb",$6be4966fd9bbc698$export$4d07bf653ea69106=reactExports.forwardRef((d,g)=>{const{__scopeSwitch:b,...et}=d,st=$6be4966fd9bbc698$var$useSwitchContext($6be4966fd9bbc698$var$THUMB_NAME,b);return reactExports.createElement($8927f6f2acc4f386$export$250ffa63cdc0d034.span,_extends$1({"data-state":$6be4966fd9bbc698$var$getState(st.checked),"data-disabled":st.disabled?"":void 0},et,{ref:g}))}),$6be4966fd9bbc698$var$BubbleInput=d=>{const{control:g,checked:b,bubbles:et=!0,...st}=d,at=reactExports.useRef(null),vt=$010c2913dbd2fe3d$export$5cae361ad82dce8b(b),Tt=$db6c3485150b8e66$export$1ab7ae714698c4b8(g);return reactExports.useEffect(()=>{const Ct=at.current,pt=window.HTMLInputElement.prototype,$t=Object.getOwnPropertyDescriptor(pt,"checked").set;if(vt!==b&&$t){const Lt=new Event("click",{bubbles:et});$t.call(Ct,b),Ct.dispatchEvent(Lt)}},[vt,b,et]),reactExports.createElement("input",_extends$1({type:"checkbox","aria-hidden":!0,defaultChecked:b},st,{tabIndex:-1,ref:at,style:{...d.style,...Tt,position:"absolute",pointerEvents:"none",opacity:0,margin:0}}))};function $6be4966fd9bbc698$var$getState(d){return d?"checked":"unchecked"}const $6be4966fd9bbc698$export$be92b6f5f03c0fe9=$6be4966fd9bbc698$export$b5d5cf8927ab7262,$6be4966fd9bbc698$export$6521433ed15a34db=$6be4966fd9bbc698$export$4d07bf653ea69106,Switch=reactExports.forwardRef(({className:d,...g},b)=>jsxRuntimeExports.jsx($6be4966fd9bbc698$export$be92b6f5f03c0fe9,{className:cn$1("peer inline-flex h-5 w-9 shrink-0 cursor-pointer items-center rounded-full border-2 border-transparent shadow-sm transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 focus-visible:ring-offset-background disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=unchecked]:bg-input",d),tabIndex:-1,...g,ref:b,children:jsxRuntimeExports.jsx($6be4966fd9bbc698$export$6521433ed15a34db,{className:cn$1("pointer-events-none block h-4 w-4 rounded-full bg-background shadow-lg ring-0 transition-transform data-[state=checked]:translate-x-4 data-[state=unchecked]:translate-x-0")})}));Switch.displayName=$6be4966fd9bbc698$export$be92b6f5f03c0fe9.displayName;const $f631663db3294ace$var$DirectionContext=reactExports.createContext(void 0);function $f631663db3294ace$export$b39126d51d94e6f3(d){const g=reactExports.useContext($f631663db3294ace$var$DirectionContext);return d||g||"ltr"}const $d7bdfb9eb0fdf311$var$ENTRY_FOCUS="rovingFocusGroup.onEntryFocus",$d7bdfb9eb0fdf311$var$EVENT_OPTIONS={bubbles:!1,cancelable:!0},$d7bdfb9eb0fdf311$var$GROUP_NAME="RovingFocusGroup",[$d7bdfb9eb0fdf311$var$Collection,$d7bdfb9eb0fdf311$var$useCollection,$d7bdfb9eb0fdf311$var$createCollectionScope]=$e02a7d9cb1dc128c$export$c74125a8e3af6bb2($d7bdfb9eb0fdf311$var$GROUP_NAME),[$d7bdfb9eb0fdf311$var$createRovingFocusGroupContext,$d7bdfb9eb0fdf311$export$c7109489551a4f4]=$c512c27ab02ef895$export$50c7b4e9d9f19c1($d7bdfb9eb0fdf311$var$GROUP_NAME,[$d7bdfb9eb0fdf311$var$createCollectionScope]),[$d7bdfb9eb0fdf311$var$RovingFocusProvider,$d7bdfb9eb0fdf311$var$useRovingFocusContext]=$d7bdfb9eb0fdf311$var$createRovingFocusGroupContext($d7bdfb9eb0fdf311$var$GROUP_NAME),$d7bdfb9eb0fdf311$export$8699f7c8af148338=reactExports.forwardRef((d,g)=>reactExports.createElement($d7bdfb9eb0fdf311$var$Collection.Provider,{scope:d.__scopeRovingFocusGroup},reactExports.createElement($d7bdfb9eb0fdf311$var$Collection.Slot,{scope:d.__scopeRovingFocusGroup},reactExports.createElement($d7bdfb9eb0fdf311$var$RovingFocusGroupImpl,_extends$1({},d,{ref:g}))))),$d7bdfb9eb0fdf311$var$RovingFocusGroupImpl=reactExports.forwardRef((d,g)=>{const{__scopeRovingFocusGroup:b,orientation:et,loop:st=!1,dir:at,currentTabStopId:vt,defaultCurrentTabStopId:Tt,onCurrentTabStopIdChange:Ct,onEntryFocus:pt,...wt}=d,$t=reactExports.useRef(null),Lt=$6ed0406888f73fc4$export$c7b2cbe3552a0d05(g,$t),jt=$f631663db3294ace$export$b39126d51d94e6f3(at),[Ft=null,Gt]=$71cd76cc60e0454e$export$6f32135080cb4c3({prop:vt,defaultProp:Tt,onChange:Ct}),[Ht,qt]=reactExports.useState(!1),Kt=$b1b2314f5f9a1d84$export$25bec8c6f54ee79a(pt),rr=$d7bdfb9eb0fdf311$var$useCollection(b),ir=reactExports.useRef(!1),[or,jr]=reactExports.useState(0);return reactExports.useEffect(()=>{const qr=$t.current;if(qr)return qr.addEventListener($d7bdfb9eb0fdf311$var$ENTRY_FOCUS,Kt),()=>qr.removeEventListener($d7bdfb9eb0fdf311$var$ENTRY_FOCUS,Kt)},[Kt]),reactExports.createElement($d7bdfb9eb0fdf311$var$RovingFocusProvider,{scope:b,orientation:et,dir:jt,loop:st,currentTabStopId:Ft,onItemFocus:reactExports.useCallback(qr=>Gt(qr),[Gt]),onItemShiftTab:reactExports.useCallback(()=>qt(!0),[]),onFocusableItemAdd:reactExports.useCallback(()=>jr(qr=>qr+1),[]),onFocusableItemRemove:reactExports.useCallback(()=>jr(qr=>qr-1),[])},reactExports.createElement($8927f6f2acc4f386$export$250ffa63cdc0d034.div,_extends$1({tabIndex:Ht||or===0?-1:0,"data-orientation":et},wt,{ref:Lt,style:{outline:"none",...d.style},onMouseDown:$e42e1063c40fb3ef$export$b9ecd428b558ff10(d.onMouseDown,()=>{ir.current=!0}),onFocus:$e42e1063c40fb3ef$export$b9ecd428b558ff10(d.onFocus,qr=>{const Yr=!ir.current;if(qr.target===qr.currentTarget&&Yr&&!Ht){const vn=new CustomEvent($d7bdfb9eb0fdf311$var$ENTRY_FOCUS,$d7bdfb9eb0fdf311$var$EVENT_OPTIONS);if(qr.currentTarget.dispatchEvent(vn),!vn.defaultPrevented){const ko=rr().filter(No=>No.focusable),Xo=ko.find(No=>No.active),zo=ko.find(No=>No.id===Ft),Uo=[Xo,zo,...ko].filter(Boolean).map(No=>No.ref.current);$d7bdfb9eb0fdf311$var$focusFirst(Uo)}}ir.current=!1}),onBlur:$e42e1063c40fb3ef$export$b9ecd428b558ff10(d.onBlur,()=>qt(!1))})))}),$d7bdfb9eb0fdf311$var$ITEM_NAME="RovingFocusGroupItem",$d7bdfb9eb0fdf311$export$ab9df7c53fe8454=reactExports.forwardRef((d,g)=>{const{__scopeRovingFocusGroup:b,focusable:et=!0,active:st=!1,tabStopId:at,...vt}=d,Tt=$1746a345f3d73bb7$export$f680877a34711e37(),Ct=at||Tt,pt=$d7bdfb9eb0fdf311$var$useRovingFocusContext($d7bdfb9eb0fdf311$var$ITEM_NAME,b),wt=pt.currentTabStopId===Ct,$t=$d7bdfb9eb0fdf311$var$useCollection(b),{onFocusableItemAdd:Lt,onFocusableItemRemove:jt}=pt;return reactExports.useEffect(()=>{if(et)return Lt(),()=>jt()},[et,Lt,jt]),reactExports.createElement($d7bdfb9eb0fdf311$var$Collection.ItemSlot,{scope:b,id:Ct,focusable:et,active:st},reactExports.createElement($8927f6f2acc4f386$export$250ffa63cdc0d034.span,_extends$1({tabIndex:wt?0:-1,"data-orientation":pt.orientation},vt,{ref:g,onMouseDown:$e42e1063c40fb3ef$export$b9ecd428b558ff10(d.onMouseDown,Ft=>{et?pt.onItemFocus(Ct):Ft.preventDefault()}),onFocus:$e42e1063c40fb3ef$export$b9ecd428b558ff10(d.onFocus,()=>pt.onItemFocus(Ct)),onKeyDown:$e42e1063c40fb3ef$export$b9ecd428b558ff10(d.onKeyDown,Ft=>{if(Ft.key==="Tab"&&Ft.shiftKey){pt.onItemShiftTab();return}if(Ft.target!==Ft.currentTarget)return;const Gt=$d7bdfb9eb0fdf311$var$getFocusIntent(Ft,pt.orientation,pt.dir);if(Gt!==void 0){Ft.preventDefault();let qt=$t().filter(Kt=>Kt.focusable).map(Kt=>Kt.ref.current);if(Gt==="last")qt.reverse();else if(Gt==="prev"||Gt==="next"){Gt==="prev"&&qt.reverse();const Kt=qt.indexOf(Ft.currentTarget);qt=pt.loop?$d7bdfb9eb0fdf311$var$wrapArray(qt,Kt+1):qt.slice(Kt+1)}setTimeout(()=>$d7bdfb9eb0fdf311$var$focusFirst(qt))}})})))}),$d7bdfb9eb0fdf311$var$MAP_KEY_TO_FOCUS_INTENT={ArrowLeft:"prev",ArrowUp:"prev",ArrowRight:"next",ArrowDown:"next",PageUp:"first",Home:"first",PageDown:"last",End:"last"};function $d7bdfb9eb0fdf311$var$getDirectionAwareKey(d,g){return g!=="rtl"?d:d==="ArrowLeft"?"ArrowRight":d==="ArrowRight"?"ArrowLeft":d}function $d7bdfb9eb0fdf311$var$getFocusIntent(d,g,b){const et=$d7bdfb9eb0fdf311$var$getDirectionAwareKey(d.key,b);if(!(g==="vertical"&&["ArrowLeft","ArrowRight"].includes(et))&&!(g==="horizontal"&&["ArrowUp","ArrowDown"].includes(et)))return $d7bdfb9eb0fdf311$var$MAP_KEY_TO_FOCUS_INTENT[et]}function $d7bdfb9eb0fdf311$var$focusFirst(d){const g=document.activeElement;for(const b of d)if(b===g||(b.focus(),document.activeElement!==g))return}function $d7bdfb9eb0fdf311$var$wrapArray(d,g){return d.map((b,et)=>d[(g+et)%d.length])}const $d7bdfb9eb0fdf311$export$be92b6f5f03c0fe9=$d7bdfb9eb0fdf311$export$8699f7c8af148338,$d7bdfb9eb0fdf311$export$6d08773d2e66f8f2=$d7bdfb9eb0fdf311$export$ab9df7c53fe8454,$69cb30bb0017df05$var$TABS_NAME="Tabs",[$69cb30bb0017df05$var$createTabsContext,$69cb30bb0017df05$export$355f5bd209d7b13a]=$c512c27ab02ef895$export$50c7b4e9d9f19c1($69cb30bb0017df05$var$TABS_NAME,[$d7bdfb9eb0fdf311$export$c7109489551a4f4]),$69cb30bb0017df05$var$useRovingFocusGroupScope=$d7bdfb9eb0fdf311$export$c7109489551a4f4(),[$69cb30bb0017df05$var$TabsProvider,$69cb30bb0017df05$var$useTabsContext]=$69cb30bb0017df05$var$createTabsContext($69cb30bb0017df05$var$TABS_NAME),$69cb30bb0017df05$export$b2539bed5023c21c=reactExports.forwardRef((d,g)=>{const{__scopeTabs:b,value:et,onValueChange:st,defaultValue:at,orientation:vt="horizontal",dir:Tt,activationMode:Ct="automatic",...pt}=d,wt=$f631663db3294ace$export$b39126d51d94e6f3(Tt),[$t,Lt]=$71cd76cc60e0454e$export$6f32135080cb4c3({prop:et,onChange:st,defaultProp:at});return reactExports.createElement($69cb30bb0017df05$var$TabsProvider,{scope:b,baseId:$1746a345f3d73bb7$export$f680877a34711e37(),value:$t,onValueChange:Lt,orientation:vt,dir:wt,activationMode:Ct},reactExports.createElement($8927f6f2acc4f386$export$250ffa63cdc0d034.div,_extends$1({dir:wt,"data-orientation":vt},pt,{ref:g})))}),$69cb30bb0017df05$var$TAB_LIST_NAME="TabsList",$69cb30bb0017df05$export$9712d22edc0d78c1=reactExports.forwardRef((d,g)=>{const{__scopeTabs:b,loop:et=!0,...st}=d,at=$69cb30bb0017df05$var$useTabsContext($69cb30bb0017df05$var$TAB_LIST_NAME,b),vt=$69cb30bb0017df05$var$useRovingFocusGroupScope(b);return reactExports.createElement($d7bdfb9eb0fdf311$export$be92b6f5f03c0fe9,_extends$1({asChild:!0},vt,{orientation:at.orientation,dir:at.dir,loop:et}),reactExports.createElement($8927f6f2acc4f386$export$250ffa63cdc0d034.div,_extends$1({role:"tablist","aria-orientation":at.orientation},st,{ref:g})))}),$69cb30bb0017df05$var$TRIGGER_NAME="TabsTrigger",$69cb30bb0017df05$export$8114b9fdfdf9f3ba=reactExports.forwardRef((d,g)=>{const{__scopeTabs:b,value:et,disabled:st=!1,...at}=d,vt=$69cb30bb0017df05$var$useTabsContext($69cb30bb0017df05$var$TRIGGER_NAME,b),Tt=$69cb30bb0017df05$var$useRovingFocusGroupScope(b),Ct=$69cb30bb0017df05$var$makeTriggerId(vt.baseId,et),pt=$69cb30bb0017df05$var$makeContentId(vt.baseId,et),wt=et===vt.value;return reactExports.createElement($d7bdfb9eb0fdf311$export$6d08773d2e66f8f2,_extends$1({asChild:!0},Tt,{focusable:!st,active:wt}),reactExports.createElement($8927f6f2acc4f386$export$250ffa63cdc0d034.button,_extends$1({type:"button",role:"tab","aria-selected":wt,"aria-controls":pt,"data-state":wt?"active":"inactive","data-disabled":st?"":void 0,disabled:st,id:Ct},at,{ref:g,onMouseDown:$e42e1063c40fb3ef$export$b9ecd428b558ff10(d.onMouseDown,$t=>{!st&&$t.button===0&&$t.ctrlKey===!1?vt.onValueChange(et):$t.preventDefault()}),onKeyDown:$e42e1063c40fb3ef$export$b9ecd428b558ff10(d.onKeyDown,$t=>{[" ","Enter"].includes($t.key)&&vt.onValueChange(et)}),onFocus:$e42e1063c40fb3ef$export$b9ecd428b558ff10(d.onFocus,()=>{const $t=vt.activationMode!=="manual";!wt&&!st&&$t&&vt.onValueChange(et)})})))}),$69cb30bb0017df05$var$CONTENT_NAME="TabsContent",$69cb30bb0017df05$export$bd905d70e8fd2ebb=reactExports.forwardRef((d,g)=>{const{__scopeTabs:b,value:et,forceMount:st,children:at,...vt}=d,Tt=$69cb30bb0017df05$var$useTabsContext($69cb30bb0017df05$var$CONTENT_NAME,b),Ct=$69cb30bb0017df05$var$makeTriggerId(Tt.baseId,et),pt=$69cb30bb0017df05$var$makeContentId(Tt.baseId,et),wt=et===Tt.value,$t=reactExports.useRef(wt);return reactExports.useEffect(()=>{const Lt=requestAnimationFrame(()=>$t.current=!1);return()=>cancelAnimationFrame(Lt)},[]),reactExports.createElement($921a889cee6df7e8$export$99c2b779aa4e8b8b,{present:st||wt},({present:Lt})=>reactExports.createElement($8927f6f2acc4f386$export$250ffa63cdc0d034.div,_extends$1({"data-state":wt?"active":"inactive","data-orientation":Tt.orientation,role:"tabpanel","aria-labelledby":Ct,hidden:!Lt,id:pt,tabIndex:0},vt,{ref:g,style:{...d.style,animationDuration:$t.current?"0s":void 0}}),Lt&&at))});function $69cb30bb0017df05$var$makeTriggerId(d,g){return`${d}-trigger-${g}`}function $69cb30bb0017df05$var$makeContentId(d,g){return`${d}-content-${g}`}const $69cb30bb0017df05$export$be92b6f5f03c0fe9=$69cb30bb0017df05$export$b2539bed5023c21c,$69cb30bb0017df05$export$54c2e3dc7acea9f5=$69cb30bb0017df05$export$9712d22edc0d78c1,$69cb30bb0017df05$export$41fb9f06171c75f4=$69cb30bb0017df05$export$8114b9fdfdf9f3ba,$69cb30bb0017df05$export$7c6e2c02157bb7d2=$69cb30bb0017df05$export$bd905d70e8fd2ebb,Tabs=$69cb30bb0017df05$export$be92b6f5f03c0fe9,TabsList=reactExports.forwardRef(({className:d,...g},b)=>jsxRuntimeExports.jsx($69cb30bb0017df05$export$54c2e3dc7acea9f5,{ref:b,className:cn$1("inline-flex h-9 items-center justify-center rounded-lg bg-muted p-1 text-muted-foreground",d),tabIndex:-1,...g}));TabsList.displayName=$69cb30bb0017df05$export$54c2e3dc7acea9f5.displayName;const TabsTrigger=reactExports.forwardRef(({className:d,...g},b)=>jsxRuntimeExports.jsx($69cb30bb0017df05$export$41fb9f06171c75f4,{ref:b,className:cn$1("inline-flex items-center justify-center whitespace-nowrap rounded-md px-3 py-1 text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-background data-[state=active]:text-foreground data-[state=active]:shadow",d),tabIndex:-1,...g}));TabsTrigger.displayName=$69cb30bb0017df05$export$41fb9f06171c75f4.displayName;const TabsContent=reactExports.forwardRef(({className:d,...g},b)=>jsxRuntimeExports.jsx($69cb30bb0017df05$export$7c6e2c02157bb7d2,{ref:b,className:cn$1("mt-2 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2",d),tabIndex:-1,...g}));TabsContent.displayName=$69cb30bb0017df05$export$7c6e2c02157bb7d2.displayName;function $ae6933e535247d3d$export$7d15b64cf5a3a4c4(d,[g,b]){return Math.min(b,Math.max(g,d))}function $6c2e24571c90391f$export$3e6543de14f8614f(d,g){return reactExports.useReducer((b,et)=>{const st=g[b][et];return st??b},d)}const $57acba87d6e25586$var$SCROLL_AREA_NAME="ScrollArea",[$57acba87d6e25586$var$createScrollAreaContext,$57acba87d6e25586$export$488468afe3a6f2b1]=$c512c27ab02ef895$export$50c7b4e9d9f19c1($57acba87d6e25586$var$SCROLL_AREA_NAME),[$57acba87d6e25586$var$ScrollAreaProvider,$57acba87d6e25586$var$useScrollAreaContext]=$57acba87d6e25586$var$createScrollAreaContext($57acba87d6e25586$var$SCROLL_AREA_NAME),$57acba87d6e25586$export$ccf8d8d7bbf3c2cc=reactExports.forwardRef((d,g)=>{const{__scopeScrollArea:b,type:et="hover",dir:st,scrollHideDelay:at=600,...vt}=d,[Tt,Ct]=reactExports.useState(null),[pt,wt]=reactExports.useState(null),[$t,Lt]=reactExports.useState(null),[jt,Ft]=reactExports.useState(null),[Gt,Ht]=reactExports.useState(null),[qt,Kt]=reactExports.useState(0),[rr,ir]=reactExports.useState(0),[or,jr]=reactExports.useState(!1),[qr,Yr]=reactExports.useState(!1),vn=$6ed0406888f73fc4$export$c7b2cbe3552a0d05(g,Xo=>Ct(Xo)),ko=$f631663db3294ace$export$b39126d51d94e6f3(st);return reactExports.createElement($57acba87d6e25586$var$ScrollAreaProvider,{scope:b,type:et,dir:ko,scrollHideDelay:at,scrollArea:Tt,viewport:pt,onViewportChange:wt,content:$t,onContentChange:Lt,scrollbarX:jt,onScrollbarXChange:Ft,scrollbarXEnabled:or,onScrollbarXEnabledChange:jr,scrollbarY:Gt,onScrollbarYChange:Ht,scrollbarYEnabled:qr,onScrollbarYEnabledChange:Yr,onCornerWidthChange:Kt,onCornerHeightChange:ir},reactExports.createElement($8927f6f2acc4f386$export$250ffa63cdc0d034.div,_extends$1({dir:ko},vt,{ref:vn,style:{position:"relative","--radix-scroll-area-corner-width":qt+"px","--radix-scroll-area-corner-height":rr+"px",...d.style}})))}),$57acba87d6e25586$var$VIEWPORT_NAME="ScrollAreaViewport",$57acba87d6e25586$export$a21cbf9f11fca853=reactExports.forwardRef((d,g)=>{const{__scopeScrollArea:b,children:et,...st}=d,at=$57acba87d6e25586$var$useScrollAreaContext($57acba87d6e25586$var$VIEWPORT_NAME,b),vt=reactExports.useRef(null),Tt=$6ed0406888f73fc4$export$c7b2cbe3552a0d05(g,vt,at.onViewportChange);return reactExports.createElement(reactExports.Fragment,null,reactExports.createElement("style",{dangerouslySetInnerHTML:{__html:"[data-radix-scroll-area-viewport]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}[data-radix-scroll-area-viewport]::-webkit-scrollbar{display:none}"}}),reactExports.createElement($8927f6f2acc4f386$export$250ffa63cdc0d034.div,_extends$1({"data-radix-scroll-area-viewport":""},st,{ref:Tt,style:{overflowX:at.scrollbarXEnabled?"scroll":"hidden",overflowY:at.scrollbarYEnabled?"scroll":"hidden",...d.style}}),reactExports.createElement("div",{ref:at.onContentChange,style:{minWidth:"100%",display:"table"}},et)))}),$57acba87d6e25586$var$SCROLLBAR_NAME="ScrollAreaScrollbar",$57acba87d6e25586$export$2fabd85d0eba3c57=reactExports.forwardRef((d,g)=>{const{forceMount:b,...et}=d,st=$57acba87d6e25586$var$useScrollAreaContext($57acba87d6e25586$var$SCROLLBAR_NAME,d.__scopeScrollArea),{onScrollbarXEnabledChange:at,onScrollbarYEnabledChange:vt}=st,Tt=d.orientation==="horizontal";return reactExports.useEffect(()=>(Tt?at(!0):vt(!0),()=>{Tt?at(!1):vt(!1)}),[Tt,at,vt]),st.type==="hover"?reactExports.createElement($57acba87d6e25586$var$ScrollAreaScrollbarHover,_extends$1({},et,{ref:g,forceMount:b})):st.type==="scroll"?reactExports.createElement($57acba87d6e25586$var$ScrollAreaScrollbarScroll,_extends$1({},et,{ref:g,forceMount:b})):st.type==="auto"?reactExports.createElement($57acba87d6e25586$var$ScrollAreaScrollbarAuto,_extends$1({},et,{ref:g,forceMount:b})):st.type==="always"?reactExports.createElement($57acba87d6e25586$var$ScrollAreaScrollbarVisible,_extends$1({},et,{ref:g})):null}),$57acba87d6e25586$var$ScrollAreaScrollbarHover=reactExports.forwardRef((d,g)=>{const{forceMount:b,...et}=d,st=$57acba87d6e25586$var$useScrollAreaContext($57acba87d6e25586$var$SCROLLBAR_NAME,d.__scopeScrollArea),[at,vt]=reactExports.useState(!1);return reactExports.useEffect(()=>{const Tt=st.scrollArea;let Ct=0;if(Tt){const pt=()=>{window.clearTimeout(Ct),vt(!0)},wt=()=>{Ct=window.setTimeout(()=>vt(!1),st.scrollHideDelay)};return Tt.addEventListener("pointerenter",pt),Tt.addEventListener("pointerleave",wt),()=>{window.clearTimeout(Ct),Tt.removeEventListener("pointerenter",pt),Tt.removeEventListener("pointerleave",wt)}}},[st.scrollArea,st.scrollHideDelay]),reactExports.createElement($921a889cee6df7e8$export$99c2b779aa4e8b8b,{present:b||at},reactExports.createElement($57acba87d6e25586$var$ScrollAreaScrollbarAuto,_extends$1({"data-state":at?"visible":"hidden"},et,{ref:g})))}),$57acba87d6e25586$var$ScrollAreaScrollbarScroll=reactExports.forwardRef((d,g)=>{const{forceMount:b,...et}=d,st=$57acba87d6e25586$var$useScrollAreaContext($57acba87d6e25586$var$SCROLLBAR_NAME,d.__scopeScrollArea),at=d.orientation==="horizontal",vt=$57acba87d6e25586$var$useDebounceCallback(()=>Ct("SCROLL_END"),100),[Tt,Ct]=$6c2e24571c90391f$export$3e6543de14f8614f("hidden",{hidden:{SCROLL:"scrolling"},scrolling:{SCROLL_END:"idle",POINTER_ENTER:"interacting"},interacting:{SCROLL:"interacting",POINTER_LEAVE:"idle"},idle:{HIDE:"hidden",SCROLL:"scrolling",POINTER_ENTER:"interacting"}});return reactExports.useEffect(()=>{if(Tt==="idle"){const pt=window.setTimeout(()=>Ct("HIDE"),st.scrollHideDelay);return()=>window.clearTimeout(pt)}},[Tt,st.scrollHideDelay,Ct]),reactExports.useEffect(()=>{const pt=st.viewport,wt=at?"scrollLeft":"scrollTop";if(pt){let $t=pt[wt];const Lt=()=>{const jt=pt[wt];$t!==jt&&(Ct("SCROLL"),vt()),$t=jt};return pt.addEventListener("scroll",Lt),()=>pt.removeEventListener("scroll",Lt)}},[st.viewport,at,Ct,vt]),reactExports.createElement($921a889cee6df7e8$export$99c2b779aa4e8b8b,{present:b||Tt!=="hidden"},reactExports.createElement($57acba87d6e25586$var$ScrollAreaScrollbarVisible,_extends$1({"data-state":Tt==="hidden"?"hidden":"visible"},et,{ref:g,onPointerEnter:$e42e1063c40fb3ef$export$b9ecd428b558ff10(d.onPointerEnter,()=>Ct("POINTER_ENTER")),onPointerLeave:$e42e1063c40fb3ef$export$b9ecd428b558ff10(d.onPointerLeave,()=>Ct("POINTER_LEAVE"))})))}),$57acba87d6e25586$var$ScrollAreaScrollbarAuto=reactExports.forwardRef((d,g)=>{const b=$57acba87d6e25586$var$useScrollAreaContext($57acba87d6e25586$var$SCROLLBAR_NAME,d.__scopeScrollArea),{forceMount:et,...st}=d,[at,vt]=reactExports.useState(!1),Tt=d.orientation==="horizontal",Ct=$57acba87d6e25586$var$useDebounceCallback(()=>{if(b.viewport){const pt=b.viewport.offsetWidth<b.viewport.scrollWidth,wt=b.viewport.offsetHeight<b.viewport.scrollHeight;vt(Tt?pt:wt)}},10);return $57acba87d6e25586$var$useResizeObserver(b.viewport,Ct),$57acba87d6e25586$var$useResizeObserver(b.content,Ct),reactExports.createElement($921a889cee6df7e8$export$99c2b779aa4e8b8b,{present:et||at},reactExports.createElement($57acba87d6e25586$var$ScrollAreaScrollbarVisible,_extends$1({"data-state":at?"visible":"hidden"},st,{ref:g})))}),$57acba87d6e25586$var$ScrollAreaScrollbarVisible=reactExports.forwardRef((d,g)=>{const{orientation:b="vertical",...et}=d,st=$57acba87d6e25586$var$useScrollAreaContext($57acba87d6e25586$var$SCROLLBAR_NAME,d.__scopeScrollArea),at=reactExports.useRef(null),vt=reactExports.useRef(0),[Tt,Ct]=reactExports.useState({content:0,viewport:0,scrollbar:{size:0,paddingStart:0,paddingEnd:0}}),pt=$57acba87d6e25586$var$getThumbRatio(Tt.viewport,Tt.content),wt={...et,sizes:Tt,onSizesChange:Ct,hasThumb:pt>0&&pt<1,onThumbChange:Lt=>at.current=Lt,onThumbPointerUp:()=>vt.current=0,onThumbPointerDown:Lt=>vt.current=Lt};function $t(Lt,jt){return $57acba87d6e25586$var$getScrollPositionFromPointer(Lt,vt.current,Tt,jt)}return b==="horizontal"?reactExports.createElement($57acba87d6e25586$var$ScrollAreaScrollbarX,_extends$1({},wt,{ref:g,onThumbPositionChange:()=>{if(st.viewport&&at.current){const Lt=st.viewport.scrollLeft,jt=$57acba87d6e25586$var$getThumbOffsetFromScroll(Lt,Tt,st.dir);at.current.style.transform=`translate3d(${jt}px, 0, 0)`}},onWheelScroll:Lt=>{st.viewport&&(st.viewport.scrollLeft=Lt)},onDragScroll:Lt=>{st.viewport&&(st.viewport.scrollLeft=$t(Lt,st.dir))}})):b==="vertical"?reactExports.createElement($57acba87d6e25586$var$ScrollAreaScrollbarY,_extends$1({},wt,{ref:g,onThumbPositionChange:()=>{if(st.viewport&&at.current){const Lt=st.viewport.scrollTop,jt=$57acba87d6e25586$var$getThumbOffsetFromScroll(Lt,Tt);at.current.style.transform=`translate3d(0, ${jt}px, 0)`}},onWheelScroll:Lt=>{st.viewport&&(st.viewport.scrollTop=Lt)},onDragScroll:Lt=>{st.viewport&&(st.viewport.scrollTop=$t(Lt))}})):null}),$57acba87d6e25586$var$ScrollAreaScrollbarX=reactExports.forwardRef((d,g)=>{const{sizes:b,onSizesChange:et,...st}=d,at=$57acba87d6e25586$var$useScrollAreaContext($57acba87d6e25586$var$SCROLLBAR_NAME,d.__scopeScrollArea),[vt,Tt]=reactExports.useState(),Ct=reactExports.useRef(null),pt=$6ed0406888f73fc4$export$c7b2cbe3552a0d05(g,Ct,at.onScrollbarXChange);return reactExports.useEffect(()=>{Ct.current&&Tt(getComputedStyle(Ct.current))},[Ct]),reactExports.createElement($57acba87d6e25586$var$ScrollAreaScrollbarImpl,_extends$1({"data-orientation":"horizontal"},st,{ref:pt,sizes:b,style:{bottom:0,left:at.dir==="rtl"?"var(--radix-scroll-area-corner-width)":0,right:at.dir==="ltr"?"var(--radix-scroll-area-corner-width)":0,"--radix-scroll-area-thumb-width":$57acba87d6e25586$var$getThumbSize(b)+"px",...d.style},onThumbPointerDown:wt=>d.onThumbPointerDown(wt.x),onDragScroll:wt=>d.onDragScroll(wt.x),onWheelScroll:(wt,$t)=>{if(at.viewport){const Lt=at.viewport.scrollLeft+wt.deltaX;d.onWheelScroll(Lt),$57acba87d6e25586$var$isScrollingWithinScrollbarBounds(Lt,$t)&&wt.preventDefault()}},onResize:()=>{Ct.current&&at.viewport&&vt&&et({content:at.viewport.scrollWidth,viewport:at.viewport.offsetWidth,scrollbar:{size:Ct.current.clientWidth,paddingStart:$57acba87d6e25586$var$toInt(vt.paddingLeft),paddingEnd:$57acba87d6e25586$var$toInt(vt.paddingRight)}})}}))}),$57acba87d6e25586$var$ScrollAreaScrollbarY=reactExports.forwardRef((d,g)=>{const{sizes:b,onSizesChange:et,...st}=d,at=$57acba87d6e25586$var$useScrollAreaContext($57acba87d6e25586$var$SCROLLBAR_NAME,d.__scopeScrollArea),[vt,Tt]=reactExports.useState(),Ct=reactExports.useRef(null),pt=$6ed0406888f73fc4$export$c7b2cbe3552a0d05(g,Ct,at.onScrollbarYChange);return reactExports.useEffect(()=>{Ct.current&&Tt(getComputedStyle(Ct.current))},[Ct]),reactExports.createElement($57acba87d6e25586$var$ScrollAreaScrollbarImpl,_extends$1({"data-orientation":"vertical"},st,{ref:pt,sizes:b,style:{top:0,right:at.dir==="ltr"?0:void 0,left:at.dir==="rtl"?0:void 0,bottom:"var(--radix-scroll-area-corner-height)","--radix-scroll-area-thumb-height":$57acba87d6e25586$var$getThumbSize(b)+"px",...d.style},onThumbPointerDown:wt=>d.onThumbPointerDown(wt.y),onDragScroll:wt=>d.onDragScroll(wt.y),onWheelScroll:(wt,$t)=>{if(at.viewport){const Lt=at.viewport.scrollTop+wt.deltaY;d.onWheelScroll(Lt),$57acba87d6e25586$var$isScrollingWithinScrollbarBounds(Lt,$t)&&wt.preventDefault()}},onResize:()=>{Ct.current&&at.viewport&&vt&&et({content:at.viewport.scrollHeight,viewport:at.viewport.offsetHeight,scrollbar:{size:Ct.current.clientHeight,paddingStart:$57acba87d6e25586$var$toInt(vt.paddingTop),paddingEnd:$57acba87d6e25586$var$toInt(vt.paddingBottom)}})}}))}),[$57acba87d6e25586$var$ScrollbarProvider,$57acba87d6e25586$var$useScrollbarContext]=$57acba87d6e25586$var$createScrollAreaContext($57acba87d6e25586$var$SCROLLBAR_NAME),$57acba87d6e25586$var$ScrollAreaScrollbarImpl=reactExports.forwardRef((d,g)=>{const{__scopeScrollArea:b,sizes:et,hasThumb:st,onThumbChange:at,onThumbPointerUp:vt,onThumbPointerDown:Tt,onThumbPositionChange:Ct,onDragScroll:pt,onWheelScroll:wt,onResize:$t,...Lt}=d,jt=$57acba87d6e25586$var$useScrollAreaContext($57acba87d6e25586$var$SCROLLBAR_NAME,b),[Ft,Gt]=reactExports.useState(null),Ht=$6ed0406888f73fc4$export$c7b2cbe3552a0d05(g,vn=>Gt(vn)),qt=reactExports.useRef(null),Kt=reactExports.useRef(""),rr=jt.viewport,ir=et.content-et.viewport,or=$b1b2314f5f9a1d84$export$25bec8c6f54ee79a(wt),jr=$b1b2314f5f9a1d84$export$25bec8c6f54ee79a(Ct),qr=$57acba87d6e25586$var$useDebounceCallback($t,10);function Yr(vn){if(qt.current){const ko=vn.clientX-qt.current.left,Xo=vn.clientY-qt.current.top;pt({x:ko,y:Xo})}}return reactExports.useEffect(()=>{const vn=ko=>{const Xo=ko.target;(Ft==null?void 0:Ft.contains(Xo))&&or(ko,ir)};return document.addEventListener("wheel",vn,{passive:!1}),()=>document.removeEventListener("wheel",vn,{passive:!1})},[rr,Ft,ir,or]),reactExports.useEffect(jr,[et,jr]),$57acba87d6e25586$var$useResizeObserver(Ft,qr),$57acba87d6e25586$var$useResizeObserver(jt.content,qr),reactExports.createElement($57acba87d6e25586$var$ScrollbarProvider,{scope:b,scrollbar:Ft,hasThumb:st,onThumbChange:$b1b2314f5f9a1d84$export$25bec8c6f54ee79a(at),onThumbPointerUp:$b1b2314f5f9a1d84$export$25bec8c6f54ee79a(vt),onThumbPositionChange:jr,onThumbPointerDown:$b1b2314f5f9a1d84$export$25bec8c6f54ee79a(Tt)},reactExports.createElement($8927f6f2acc4f386$export$250ffa63cdc0d034.div,_extends$1({},Lt,{ref:Ht,style:{position:"absolute",...Lt.style},onPointerDown:$e42e1063c40fb3ef$export$b9ecd428b558ff10(d.onPointerDown,vn=>{vn.button===0&&(vn.target.setPointerCapture(vn.pointerId),qt.current=Ft.getBoundingClientRect(),Kt.current=document.body.style.webkitUserSelect,document.body.style.webkitUserSelect="none",jt.viewport&&(jt.viewport.style.scrollBehavior="auto"),Yr(vn))}),onPointerMove:$e42e1063c40fb3ef$export$b9ecd428b558ff10(d.onPointerMove,Yr),onPointerUp:$e42e1063c40fb3ef$export$b9ecd428b558ff10(d.onPointerUp,vn=>{const ko=vn.target;ko.hasPointerCapture(vn.pointerId)&&ko.releasePointerCapture(vn.pointerId),document.body.style.webkitUserSelect=Kt.current,jt.viewport&&(jt.viewport.style.scrollBehavior=""),qt.current=null})})))}),$57acba87d6e25586$var$THUMB_NAME="ScrollAreaThumb",$57acba87d6e25586$export$9fba1154677d7cd2=reactExports.forwardRef((d,g)=>{const{forceMount:b,...et}=d,st=$57acba87d6e25586$var$useScrollbarContext($57acba87d6e25586$var$THUMB_NAME,d.__scopeScrollArea);return reactExports.createElement($921a889cee6df7e8$export$99c2b779aa4e8b8b,{present:b||st.hasThumb},reactExports.createElement($57acba87d6e25586$var$ScrollAreaThumbImpl,_extends$1({ref:g},et)))}),$57acba87d6e25586$var$ScrollAreaThumbImpl=reactExports.forwardRef((d,g)=>{const{__scopeScrollArea:b,style:et,...st}=d,at=$57acba87d6e25586$var$useScrollAreaContext($57acba87d6e25586$var$THUMB_NAME,b),vt=$57acba87d6e25586$var$useScrollbarContext($57acba87d6e25586$var$THUMB_NAME,b),{onThumbPositionChange:Tt}=vt,Ct=$6ed0406888f73fc4$export$c7b2cbe3552a0d05(g,$t=>vt.onThumbChange($t)),pt=reactExports.useRef(),wt=$57acba87d6e25586$var$useDebounceCallback(()=>{pt.current&&(pt.current(),pt.current=void 0)},100);return reactExports.useEffect(()=>{const $t=at.viewport;if($t){const Lt=()=>{if(wt(),!pt.current){const jt=$57acba87d6e25586$var$addUnlinkedScrollListener($t,Tt);pt.current=jt,Tt()}};return Tt(),$t.addEventListener("scroll",Lt),()=>$t.removeEventListener("scroll",Lt)}},[at.viewport,wt,Tt]),reactExports.createElement($8927f6f2acc4f386$export$250ffa63cdc0d034.div,_extends$1({"data-state":vt.hasThumb?"visible":"hidden"},st,{ref:Ct,style:{width:"var(--radix-scroll-area-thumb-width)",height:"var(--radix-scroll-area-thumb-height)",...et},onPointerDownCapture:$e42e1063c40fb3ef$export$b9ecd428b558ff10(d.onPointerDownCapture,$t=>{const jt=$t.target.getBoundingClientRect(),Ft=$t.clientX-jt.left,Gt=$t.clientY-jt.top;vt.onThumbPointerDown({x:Ft,y:Gt})}),onPointerUp:$e42e1063c40fb3ef$export$b9ecd428b558ff10(d.onPointerUp,vt.onThumbPointerUp)}))}),$57acba87d6e25586$var$CORNER_NAME="ScrollAreaCorner",$57acba87d6e25586$export$56969d565df7cc4b=reactExports.forwardRef((d,g)=>{const b=$57acba87d6e25586$var$useScrollAreaContext($57acba87d6e25586$var$CORNER_NAME,d.__scopeScrollArea),et=!!(b.scrollbarX&&b.scrollbarY);return b.type!=="scroll"&&et?reactExports.createElement($57acba87d6e25586$var$ScrollAreaCornerImpl,_extends$1({},d,{ref:g})):null}),$57acba87d6e25586$var$ScrollAreaCornerImpl=reactExports.forwardRef((d,g)=>{const{__scopeScrollArea:b,...et}=d,st=$57acba87d6e25586$var$useScrollAreaContext($57acba87d6e25586$var$CORNER_NAME,b),[at,vt]=reactExports.useState(0),[Tt,Ct]=reactExports.useState(0),pt=!!(at&&Tt);return $57acba87d6e25586$var$useResizeObserver(st.scrollbarX,()=>{var wt;const $t=((wt=st.scrollbarX)===null||wt===void 0?void 0:wt.offsetHeight)||0;st.onCornerHeightChange($t),Ct($t)}),$57acba87d6e25586$var$useResizeObserver(st.scrollbarY,()=>{var wt;const $t=((wt=st.scrollbarY)===null||wt===void 0?void 0:wt.offsetWidth)||0;st.onCornerWidthChange($t),vt($t)}),pt?reactExports.createElement($8927f6f2acc4f386$export$250ffa63cdc0d034.div,_extends$1({},et,{ref:g,style:{width:at,height:Tt,position:"absolute",right:st.dir==="ltr"?0:void 0,left:st.dir==="rtl"?0:void 0,bottom:0,...d.style}})):null});function $57acba87d6e25586$var$toInt(d){return d?parseInt(d,10):0}function $57acba87d6e25586$var$getThumbRatio(d,g){const b=d/g;return isNaN(b)?0:b}function $57acba87d6e25586$var$getThumbSize(d){const g=$57acba87d6e25586$var$getThumbRatio(d.viewport,d.content),b=d.scrollbar.paddingStart+d.scrollbar.paddingEnd,et=(d.scrollbar.size-b)*g;return Math.max(et,18)}function $57acba87d6e25586$var$getScrollPositionFromPointer(d,g,b,et="ltr"){const st=$57acba87d6e25586$var$getThumbSize(b),at=st/2,vt=g||at,Tt=st-vt,Ct=b.scrollbar.paddingStart+vt,pt=b.scrollbar.size-b.scrollbar.paddingEnd-Tt,wt=b.content-b.viewport,$t=et==="ltr"?[0,wt]:[wt*-1,0];return $57acba87d6e25586$var$linearScale([Ct,pt],$t)(d)}function $57acba87d6e25586$var$getThumbOffsetFromScroll(d,g,b="ltr"){const et=$57acba87d6e25586$var$getThumbSize(g),st=g.scrollbar.paddingStart+g.scrollbar.paddingEnd,at=g.scrollbar.size-st,vt=g.content-g.viewport,Tt=at-et,Ct=b==="ltr"?[0,vt]:[vt*-1,0],pt=$ae6933e535247d3d$export$7d15b64cf5a3a4c4(d,Ct);return $57acba87d6e25586$var$linearScale([0,vt],[0,Tt])(pt)}function $57acba87d6e25586$var$linearScale(d,g){return b=>{if(d[0]===d[1]||g[0]===g[1])return g[0];const et=(g[1]-g[0])/(d[1]-d[0]);return g[0]+et*(b-d[0])}}function $57acba87d6e25586$var$isScrollingWithinScrollbarBounds(d,g){return d>0&&d<g}const $57acba87d6e25586$var$addUnlinkedScrollListener=(d,g=()=>{})=>{let b={left:d.scrollLeft,top:d.scrollTop},et=0;return function st(){const at={left:d.scrollLeft,top:d.scrollTop},vt=b.left!==at.left,Tt=b.top!==at.top;(vt||Tt)&&g(),b=at,et=window.requestAnimationFrame(st)}(),()=>window.cancelAnimationFrame(et)};function $57acba87d6e25586$var$useDebounceCallback(d,g){const b=$b1b2314f5f9a1d84$export$25bec8c6f54ee79a(d),et=reactExports.useRef(0);return reactExports.useEffect(()=>()=>window.clearTimeout(et.current),[]),reactExports.useCallback(()=>{window.clearTimeout(et.current),et.current=window.setTimeout(b,g)},[b,g])}function $57acba87d6e25586$var$useResizeObserver(d,g){const b=$b1b2314f5f9a1d84$export$25bec8c6f54ee79a(g);$9f79659886946c16$export$e5c5a5f917a5871c(()=>{let et=0;if(d){const st=new ResizeObserver(()=>{cancelAnimationFrame(et),et=window.requestAnimationFrame(b)});return st.observe(d),()=>{window.cancelAnimationFrame(et),st.unobserve(d)}}},[d,b])}const $57acba87d6e25586$export$be92b6f5f03c0fe9=$57acba87d6e25586$export$ccf8d8d7bbf3c2cc,$57acba87d6e25586$export$d5c6c08dc2d3ca7=$57acba87d6e25586$export$a21cbf9f11fca853,$57acba87d6e25586$export$ac61190d9fc311a9=$57acba87d6e25586$export$56969d565df7cc4b,ScrollArea=reactExports.forwardRef(({className:d,children:g,...b},et)=>jsxRuntimeExports.jsxs($57acba87d6e25586$export$be92b6f5f03c0fe9,{ref:et,className:cn$1("relative overflow-hidden",d),scrollHideDelay:400,...b,children:[jsxRuntimeExports.jsx($57acba87d6e25586$export$d5c6c08dc2d3ca7,{className:"h-full w-full rounded-[inherit]",children:g}),jsxRuntimeExports.jsx(ScrollBar,{}),jsxRuntimeExports.jsx($57acba87d6e25586$export$ac61190d9fc311a9,{})]}));ScrollArea.displayName=$57acba87d6e25586$export$be92b6f5f03c0fe9.displayName;const ScrollBar=reactExports.forwardRef(({className:d,orientation:g="vertical",...b},et)=>jsxRuntimeExports.jsx($57acba87d6e25586$export$2fabd85d0eba3c57,{ref:et,orientation:g,className:cn$1("flex touch-none select-none transition-colors",g==="vertical"&&"h-full w-2.5 border-l border-l-transparent p-[1px]",g==="horizontal"&&"h-2.5 flex-col border-t border-t-transparent p-[1px]",d),...b,children:jsxRuntimeExports.jsx($57acba87d6e25586$export$9fba1154677d7cd2,{className:"relative flex-1 rounded-full bg-border"})}));ScrollBar.displayName=$57acba87d6e25586$export$2fabd85d0eba3c57.displayName;const $905f4ae918aab1aa$var$ROOT_NAME="AlertDialog",[$905f4ae918aab1aa$var$createAlertDialogContext,$905f4ae918aab1aa$export$b8891880751c2c5b]=$c512c27ab02ef895$export$50c7b4e9d9f19c1($905f4ae918aab1aa$var$ROOT_NAME,[$5d3850c4d0b4e6c7$export$cc702773b8ea3e41]),$905f4ae918aab1aa$var$useDialogScope=$5d3850c4d0b4e6c7$export$cc702773b8ea3e41(),$905f4ae918aab1aa$export$de466dd8317b0b75=d=>{const{__scopeAlertDialog:g,...b}=d,et=$905f4ae918aab1aa$var$useDialogScope(g);return reactExports.createElement($5d3850c4d0b4e6c7$export$be92b6f5f03c0fe9,_extends$1({},et,b,{modal:!0}))},$905f4ae918aab1aa$export$660f2bfdb986706c=d=>{const{__scopeAlertDialog:g,...b}=d,et=$905f4ae918aab1aa$var$useDialogScope(g);return reactExports.createElement($5d3850c4d0b4e6c7$export$602eac185826482c,_extends$1({},et,b))},$905f4ae918aab1aa$export$a707a4895ce23256=reactExports.forwardRef((d,g)=>{const{__scopeAlertDialog:b,...et}=d,st=$905f4ae918aab1aa$var$useDialogScope(b);return reactExports.createElement($5d3850c4d0b4e6c7$export$c6fdb837b070b4ff,_extends$1({},st,et,{ref:g}))}),$905f4ae918aab1aa$var$CONTENT_NAME="AlertDialogContent",[$905f4ae918aab1aa$var$AlertDialogContentProvider,$905f4ae918aab1aa$var$useAlertDialogContentContext]=$905f4ae918aab1aa$var$createAlertDialogContext($905f4ae918aab1aa$var$CONTENT_NAME),$905f4ae918aab1aa$export$94e6af45f0af4efd=reactExports.forwardRef((d,g)=>{const{__scopeAlertDialog:b,children:et,...st}=d,at=$905f4ae918aab1aa$var$useDialogScope(b),vt=reactExports.useRef(null),Tt=$6ed0406888f73fc4$export$c7b2cbe3552a0d05(g,vt),Ct=reactExports.useRef(null);return reactExports.createElement($5d3850c4d0b4e6c7$export$69b62a49393917d6,{contentName:$905f4ae918aab1aa$var$CONTENT_NAME,titleName:$905f4ae918aab1aa$var$TITLE_NAME,docsSlug:"alert-dialog"},reactExports.createElement($905f4ae918aab1aa$var$AlertDialogContentProvider,{scope:b,cancelRef:Ct},reactExports.createElement($5d3850c4d0b4e6c7$export$7c6e2c02157bb7d2,_extends$1({role:"alertdialog"},at,st,{ref:Tt,onOpenAutoFocus:$e42e1063c40fb3ef$export$b9ecd428b558ff10(st.onOpenAutoFocus,pt=>{var wt;pt.preventDefault(),(wt=Ct.current)===null||wt===void 0||wt.focus({preventScroll:!0})}),onPointerDownOutside:pt=>pt.preventDefault(),onInteractOutside:pt=>pt.preventDefault()}),reactExports.createElement($5e63c961fc1ce211$export$d9f1ccf0bdb05d45,null,et),!1)))}),$905f4ae918aab1aa$var$TITLE_NAME="AlertDialogTitle",$905f4ae918aab1aa$export$225e0da62d314b7=reactExports.forwardRef((d,g)=>{const{__scopeAlertDialog:b,...et}=d,st=$905f4ae918aab1aa$var$useDialogScope(b);return reactExports.createElement($5d3850c4d0b4e6c7$export$f99233281efd08a0,_extends$1({},st,et,{ref:g}))}),$905f4ae918aab1aa$export$a23b55cde55ad9a5=reactExports.forwardRef((d,g)=>{const{__scopeAlertDialog:b,...et}=d,st=$905f4ae918aab1aa$var$useDialogScope(b);return reactExports.createElement($5d3850c4d0b4e6c7$export$393edc798c47379d,_extends$1({},st,et,{ref:g}))}),$905f4ae918aab1aa$export$b454f818c58ee85d=reactExports.forwardRef((d,g)=>{const{__scopeAlertDialog:b,...et}=d,st=$905f4ae918aab1aa$var$useDialogScope(b);return reactExports.createElement($5d3850c4d0b4e6c7$export$f39c2d165cd861fe,_extends$1({},st,et,{ref:g}))}),$905f4ae918aab1aa$var$CANCEL_NAME="AlertDialogCancel",$905f4ae918aab1aa$export$2f67a923571aaea0=reactExports.forwardRef((d,g)=>{const{__scopeAlertDialog:b,...et}=d,{cancelRef:st}=$905f4ae918aab1aa$var$useAlertDialogContentContext($905f4ae918aab1aa$var$CANCEL_NAME,b),at=$905f4ae918aab1aa$var$useDialogScope(b),vt=$6ed0406888f73fc4$export$c7b2cbe3552a0d05(g,st);return reactExports.createElement($5d3850c4d0b4e6c7$export$f39c2d165cd861fe,_extends$1({},at,et,{ref:vt}))}),$905f4ae918aab1aa$export$be92b6f5f03c0fe9=$905f4ae918aab1aa$export$de466dd8317b0b75,$905f4ae918aab1aa$export$602eac185826482c=$905f4ae918aab1aa$export$660f2bfdb986706c,$905f4ae918aab1aa$export$c6fdb837b070b4ff=$905f4ae918aab1aa$export$a707a4895ce23256,$905f4ae918aab1aa$export$7c6e2c02157bb7d2=$905f4ae918aab1aa$export$94e6af45f0af4efd,$905f4ae918aab1aa$export$e19cd5f9376f8cee=$905f4ae918aab1aa$export$b454f818c58ee85d,$905f4ae918aab1aa$export$848c9b7ead0df967=$905f4ae918aab1aa$export$2f67a923571aaea0,$905f4ae918aab1aa$export$f99233281efd08a0=$905f4ae918aab1aa$export$225e0da62d314b7,$905f4ae918aab1aa$export$393edc798c47379d=$905f4ae918aab1aa$export$a23b55cde55ad9a5,AlertDialog=$905f4ae918aab1aa$export$be92b6f5f03c0fe9,AlertDialogPortal=$905f4ae918aab1aa$export$602eac185826482c,AlertDialogOverlay=reactExports.forwardRef(({className:d,...g},b)=>jsxRuntimeExports.jsx($905f4ae918aab1aa$export$c6fdb837b070b4ff,{className:cn$1("fixed inset-0 z-50 bg-background/80 backdrop-blur-sm data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",d),...g,ref:b}));AlertDialogOverlay.displayName=$905f4ae918aab1aa$export$c6fdb837b070b4ff.displayName;const AlertDialogContent=reactExports.forwardRef(({className:d,...g},b)=>jsxRuntimeExports.jsxs(AlertDialogPortal,{children:[jsxRuntimeExports.jsx(AlertDialogOverlay,{}),jsxRuntimeExports.jsx($905f4ae918aab1aa$export$7c6e2c02157bb7d2,{ref:b,className:cn$1("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",d),...g})]}));AlertDialogContent.displayName=$905f4ae918aab1aa$export$7c6e2c02157bb7d2.displayName;const AlertDialogHeader=({className:d,...g})=>jsxRuntimeExports.jsx("div",{className:cn$1("flex flex-col space-y-2 text-center sm:text-left",d),...g});AlertDialogHeader.displayName="AlertDialogHeader";const AlertDialogTitle=reactExports.forwardRef(({className:d,...g},b)=>jsxRuntimeExports.jsx($905f4ae918aab1aa$export$f99233281efd08a0,{ref:b,className:cn$1("text-lg font-semibold",d),...g}));AlertDialogTitle.displayName=$905f4ae918aab1aa$export$f99233281efd08a0.displayName;const AlertDialogDescription=reactExports.forwardRef(({className:d,...g},b)=>jsxRuntimeExports.jsx($905f4ae918aab1aa$export$393edc798c47379d,{ref:b,className:cn$1("text-sm text-muted-foreground",d),...g}));AlertDialogDescription.displayName=$905f4ae918aab1aa$export$393edc798c47379d.displayName;const AlertDialogAction=reactExports.forwardRef(({className:d,...g},b)=>jsxRuntimeExports.jsx($905f4ae918aab1aa$export$e19cd5f9376f8cee,{ref:b,className:cn$1(buttonVariants(),d),...g}));AlertDialogAction.displayName=$905f4ae918aab1aa$export$e19cd5f9376f8cee.displayName;const AlertDialogCancel=reactExports.forwardRef(({className:d,...g},b)=>jsxRuntimeExports.jsx($905f4ae918aab1aa$export$848c9b7ead0df967,{ref:b,className:cn$1(buttonVariants({variant:"outline"}),"mt-2 sm:mt-0",d),...g}));AlertDialogCancel.displayName=$905f4ae918aab1aa$export$848c9b7ead0df967.displayName;const $cc7e05a45900e73f$var$OPEN_KEYS=[" ","Enter","ArrowUp","ArrowDown"],$cc7e05a45900e73f$var$SELECTION_KEYS=[" ","Enter"],$cc7e05a45900e73f$var$SELECT_NAME="Select",[$cc7e05a45900e73f$var$Collection,$cc7e05a45900e73f$var$useCollection,$cc7e05a45900e73f$var$createCollectionScope]=$e02a7d9cb1dc128c$export$c74125a8e3af6bb2($cc7e05a45900e73f$var$SELECT_NAME),[$cc7e05a45900e73f$var$createSelectContext,$cc7e05a45900e73f$export$286727a75dc039bd]=$c512c27ab02ef895$export$50c7b4e9d9f19c1($cc7e05a45900e73f$var$SELECT_NAME,[$cc7e05a45900e73f$var$createCollectionScope,$cf1ac5d9fe0e8206$export$722aac194ae923]),$cc7e05a45900e73f$var$usePopperScope=$cf1ac5d9fe0e8206$export$722aac194ae923(),[$cc7e05a45900e73f$var$SelectProvider,$cc7e05a45900e73f$var$useSelectContext]=$cc7e05a45900e73f$var$createSelectContext($cc7e05a45900e73f$var$SELECT_NAME),[$cc7e05a45900e73f$var$SelectNativeOptionsProvider,$cc7e05a45900e73f$var$useSelectNativeOptionsContext]=$cc7e05a45900e73f$var$createSelectContext($cc7e05a45900e73f$var$SELECT_NAME),$cc7e05a45900e73f$export$ef9b1a59e592288f=d=>{const{__scopeSelect:g,children:b,open:et,defaultOpen:st,onOpenChange:at,value:vt,defaultValue:Tt,onValueChange:Ct,dir:pt,name:wt,autoComplete:$t,disabled:Lt,required:jt}=d,Ft=$cc7e05a45900e73f$var$usePopperScope(g),[Gt,Ht]=reactExports.useState(null),[qt,Kt]=reactExports.useState(null),[rr,ir]=reactExports.useState(!1),or=$f631663db3294ace$export$b39126d51d94e6f3(pt),[jr=!1,qr]=$71cd76cc60e0454e$export$6f32135080cb4c3({prop:et,defaultProp:st,onChange:at}),[Yr,vn]=$71cd76cc60e0454e$export$6f32135080cb4c3({prop:vt,defaultProp:Tt,onChange:Ct}),ko=reactExports.useRef(null),Xo=Gt?!!Gt.closest("form"):!0,[zo,t0]=reactExports.useState(new Set),Uo=Array.from(zo).map(No=>No.props.value).join(";");return reactExports.createElement($cf1ac5d9fe0e8206$export$be92b6f5f03c0fe9,Ft,reactExports.createElement($cc7e05a45900e73f$var$SelectProvider,{required:jt,scope:g,trigger:Gt,onTriggerChange:Ht,valueNode:qt,onValueNodeChange:Kt,valueNodeHasChildren:rr,onValueNodeHasChildrenChange:ir,contentId:$1746a345f3d73bb7$export$f680877a34711e37(),value:Yr,onValueChange:vn,open:jr,onOpenChange:qr,dir:or,triggerPointerDownPosRef:ko,disabled:Lt},reactExports.createElement($cc7e05a45900e73f$var$Collection.Provider,{scope:g},reactExports.createElement($cc7e05a45900e73f$var$SelectNativeOptionsProvider,{scope:d.__scopeSelect,onNativeOptionAdd:reactExports.useCallback(No=>{t0(_n=>new Set(_n).add(No))},[]),onNativeOptionRemove:reactExports.useCallback(No=>{t0(_n=>{const Kr=new Set(_n);return Kr.delete(No),Kr})},[])},b)),Xo?reactExports.createElement($cc7e05a45900e73f$var$BubbleSelect,{key:Uo,"aria-hidden":!0,required:jt,tabIndex:-1,name:wt,autoComplete:$t,value:Yr,onChange:No=>vn(No.target.value),disabled:Lt},Yr===void 0?reactExports.createElement("option",{value:""}):null,Array.from(zo)):null))},$cc7e05a45900e73f$var$TRIGGER_NAME="SelectTrigger",$cc7e05a45900e73f$export$3ac1e88a1c0b9f1=reactExports.forwardRef((d,g)=>{const{__scopeSelect:b,disabled:et=!1,...st}=d,at=$cc7e05a45900e73f$var$usePopperScope(b),vt=$cc7e05a45900e73f$var$useSelectContext($cc7e05a45900e73f$var$TRIGGER_NAME,b),Tt=vt.disabled||et,Ct=$6ed0406888f73fc4$export$c7b2cbe3552a0d05(g,vt.onTriggerChange),pt=$cc7e05a45900e73f$var$useCollection(b),[wt,$t,Lt]=$cc7e05a45900e73f$var$useTypeaheadSearch(Ft=>{const Gt=pt().filter(Kt=>!Kt.disabled),Ht=Gt.find(Kt=>Kt.value===vt.value),qt=$cc7e05a45900e73f$var$findNextItem(Gt,Ft,Ht);qt!==void 0&&vt.onValueChange(qt.value)}),jt=()=>{Tt||(vt.onOpenChange(!0),Lt())};return reactExports.createElement($cf1ac5d9fe0e8206$export$b688253958b8dfe7,_extends$1({asChild:!0},at),reactExports.createElement($8927f6f2acc4f386$export$250ffa63cdc0d034.button,_extends$1({type:"button",role:"combobox","aria-controls":vt.contentId,"aria-expanded":vt.open,"aria-required":vt.required,"aria-autocomplete":"none",dir:vt.dir,"data-state":vt.open?"open":"closed",disabled:Tt,"data-disabled":Tt?"":void 0,"data-placeholder":$cc7e05a45900e73f$var$shouldShowPlaceholder(vt.value)?"":void 0},st,{ref:Ct,onClick:$e42e1063c40fb3ef$export$b9ecd428b558ff10(st.onClick,Ft=>{Ft.currentTarget.focus()}),onPointerDown:$e42e1063c40fb3ef$export$b9ecd428b558ff10(st.onPointerDown,Ft=>{const Gt=Ft.target;Gt.hasPointerCapture(Ft.pointerId)&&Gt.releasePointerCapture(Ft.pointerId),Ft.button===0&&Ft.ctrlKey===!1&&(jt(),vt.triggerPointerDownPosRef.current={x:Math.round(Ft.pageX),y:Math.round(Ft.pageY)},Ft.preventDefault())}),onKeyDown:$e42e1063c40fb3ef$export$b9ecd428b558ff10(st.onKeyDown,Ft=>{const Gt=wt.current!=="";!(Ft.ctrlKey||Ft.altKey||Ft.metaKey)&&Ft.key.length===1&&$t(Ft.key),!(Gt&&Ft.key===" ")&&$cc7e05a45900e73f$var$OPEN_KEYS.includes(Ft.key)&&(jt(),Ft.preventDefault())})})))}),$cc7e05a45900e73f$var$VALUE_NAME="SelectValue",$cc7e05a45900e73f$export$e288731fd71264f0=reactExports.forwardRef((d,g)=>{const{__scopeSelect:b,className:et,style:st,children:at,placeholder:vt="",...Tt}=d,Ct=$cc7e05a45900e73f$var$useSelectContext($cc7e05a45900e73f$var$VALUE_NAME,b),{onValueNodeHasChildrenChange:pt}=Ct,wt=at!==void 0,$t=$6ed0406888f73fc4$export$c7b2cbe3552a0d05(g,Ct.onValueNodeChange);return $9f79659886946c16$export$e5c5a5f917a5871c(()=>{pt(wt)},[pt,wt]),reactExports.createElement($8927f6f2acc4f386$export$250ffa63cdc0d034.span,_extends$1({},Tt,{ref:$t,style:{pointerEvents:"none"}}),$cc7e05a45900e73f$var$shouldShowPlaceholder(Ct.value)?reactExports.createElement(reactExports.Fragment,null,vt):at)}),$cc7e05a45900e73f$export$99b400cabb58c515=reactExports.forwardRef((d,g)=>{const{__scopeSelect:b,children:et,...st}=d;return reactExports.createElement($8927f6f2acc4f386$export$250ffa63cdc0d034.span,_extends$1({"aria-hidden":!0},st,{ref:g}),et||"")}),$cc7e05a45900e73f$export$b2af6c9944296213=d=>reactExports.createElement($f1701beae083dbae$export$602eac185826482c,_extends$1({asChild:!0},d)),$cc7e05a45900e73f$var$CONTENT_NAME="SelectContent",$cc7e05a45900e73f$export$c973a4b3cb86a03d=reactExports.forwardRef((d,g)=>{const b=$cc7e05a45900e73f$var$useSelectContext($cc7e05a45900e73f$var$CONTENT_NAME,d.__scopeSelect),[et,st]=reactExports.useState();if($9f79659886946c16$export$e5c5a5f917a5871c(()=>{st(new DocumentFragment)},[]),!b.open){const at=et;return at?reactDomExports.createPortal(reactExports.createElement($cc7e05a45900e73f$var$SelectContentProvider,{scope:d.__scopeSelect},reactExports.createElement($cc7e05a45900e73f$var$Collection.Slot,{scope:d.__scopeSelect},reactExports.createElement("div",null,d.children))),at):null}return reactExports.createElement($cc7e05a45900e73f$var$SelectContentImpl,_extends$1({},d,{ref:g}))}),$cc7e05a45900e73f$var$CONTENT_MARGIN=10,[$cc7e05a45900e73f$var$SelectContentProvider,$cc7e05a45900e73f$var$useSelectContentContext]=$cc7e05a45900e73f$var$createSelectContext($cc7e05a45900e73f$var$CONTENT_NAME),$cc7e05a45900e73f$var$SelectContentImpl=reactExports.forwardRef((d,g)=>{const{__scopeSelect:b,position:et="item-aligned",onCloseAutoFocus:st,onEscapeKeyDown:at,onPointerDownOutside:vt,side:Tt,sideOffset:Ct,align:pt,alignOffset:wt,arrowPadding:$t,collisionBoundary:Lt,collisionPadding:jt,sticky:Ft,hideWhenDetached:Gt,avoidCollisions:Ht,...qt}=d,Kt=$cc7e05a45900e73f$var$useSelectContext($cc7e05a45900e73f$var$CONTENT_NAME,b),[rr,ir]=reactExports.useState(null),[or,jr]=reactExports.useState(null),qr=$6ed0406888f73fc4$export$c7b2cbe3552a0d05(g,u0=>ir(u0)),[Yr,vn]=reactExports.useState(null),[ko,Xo]=reactExports.useState(null),zo=$cc7e05a45900e73f$var$useCollection(b),[t0,Uo]=reactExports.useState(!1),No=reactExports.useRef(!1);reactExports.useEffect(()=>{if(rr)return hideOthers(rr)},[rr]),$3db38b7d1fb3fe6a$export$b7ece24a22aeda8c();const _n=reactExports.useCallback(u0=>{const[d0,...f0]=zo().map(O0=>O0.ref.current),[y0]=f0.slice(-1),b0=document.activeElement;for(const O0 of u0)if(O0===b0||(O0==null||O0.scrollIntoView({block:"nearest"}),O0===d0&&or&&(or.scrollTop=0),O0===y0&&or&&(or.scrollTop=or.scrollHeight),O0==null||O0.focus(),document.activeElement!==b0))return},[zo,or]),Kr=reactExports.useCallback(()=>_n([Yr,rr]),[_n,Yr,rr]);reactExports.useEffect(()=>{t0&&Kr()},[t0,Kr]);const{onOpenChange:e0,triggerPointerDownPosRef:Zr}=Kt;reactExports.useEffect(()=>{if(rr){let u0={x:0,y:0};const d0=y0=>{var b0,O0,C0,v0;u0={x:Math.abs(Math.round(y0.pageX)-((b0=(O0=Zr.current)===null||O0===void 0?void 0:O0.x)!==null&&b0!==void 0?b0:0)),y:Math.abs(Math.round(y0.pageY)-((C0=(v0=Zr.current)===null||v0===void 0?void 0:v0.y)!==null&&C0!==void 0?C0:0))}},f0=y0=>{u0.x<=10&&u0.y<=10?y0.preventDefault():rr.contains(y0.target)||e0(!1),document.removeEventListener("pointermove",d0),Zr.current=null};return Zr.current!==null&&(document.addEventListener("pointermove",d0),document.addEventListener("pointerup",f0,{capture:!0,once:!0})),()=>{document.removeEventListener("pointermove",d0),document.removeEventListener("pointerup",f0,{capture:!0})}}},[rr,e0,Zr]),reactExports.useEffect(()=>{const u0=()=>e0(!1);return window.addEventListener("blur",u0),window.addEventListener("resize",u0),()=>{window.removeEventListener("blur",u0),window.removeEventListener("resize",u0)}},[e0]);const[Ro,Sn]=$cc7e05a45900e73f$var$useTypeaheadSearch(u0=>{const d0=zo().filter(b0=>!b0.disabled),f0=d0.find(b0=>b0.ref.current===document.activeElement),y0=$cc7e05a45900e73f$var$findNextItem(d0,u0,f0);y0&&setTimeout(()=>y0.ref.current.focus())}),Tn=reactExports.useCallback((u0,d0,f0)=>{const y0=!No.current&&!f0;(Kt.value!==void 0&&Kt.value===d0||y0)&&(vn(u0),y0&&(No.current=!0))},[Kt.value]),n0=reactExports.useCallback(()=>rr==null?void 0:rr.focus(),[rr]),Go=reactExports.useCallback((u0,d0,f0)=>{const y0=!No.current&&!f0;(Kt.value!==void 0&&Kt.value===d0||y0)&&Xo(u0)},[Kt.value]),An=et==="popper"?$cc7e05a45900e73f$var$SelectPopperPosition:$cc7e05a45900e73f$var$SelectItemAlignedPosition,a0=An===$cc7e05a45900e73f$var$SelectPopperPosition?{side:Tt,sideOffset:Ct,align:pt,alignOffset:wt,arrowPadding:$t,collisionBoundary:Lt,collisionPadding:jt,sticky:Ft,hideWhenDetached:Gt,avoidCollisions:Ht}:{};return reactExports.createElement($cc7e05a45900e73f$var$SelectContentProvider,{scope:b,content:rr,viewport:or,onViewportChange:jr,itemRefCallback:Tn,selectedItem:Yr,onItemLeave:n0,itemTextRefCallback:Go,focusSelectedItem:Kr,selectedItemText:ko,position:et,isPositioned:t0,searchRef:Ro},reactExports.createElement(ReactRemoveScroll,{as:$5e63c961fc1ce211$export$8c6ed5c666ac1360,allowPinchZoom:!0},reactExports.createElement($d3863c46a17e8a28$export$20e40289641fbbb6,{asChild:!0,trapped:Kt.open,onMountAutoFocus:u0=>{u0.preventDefault()},onUnmountAutoFocus:$e42e1063c40fb3ef$export$b9ecd428b558ff10(st,u0=>{var d0;(d0=Kt.trigger)===null||d0===void 0||d0.focus({preventScroll:!0}),u0.preventDefault()})},reactExports.createElement($5cb92bef7577960e$export$177fb62ff3ec1f22,{asChild:!0,disableOutsidePointerEvents:!0,onEscapeKeyDown:at,onPointerDownOutside:vt,onFocusOutside:u0=>u0.preventDefault(),onDismiss:()=>Kt.onOpenChange(!1)},reactExports.createElement(An,_extends$1({role:"listbox",id:Kt.contentId,"data-state":Kt.open?"open":"closed",dir:Kt.dir,onContextMenu:u0=>u0.preventDefault()},qt,a0,{onPlaced:()=>Uo(!0),ref:qr,style:{display:"flex",flexDirection:"column",outline:"none",...qt.style},onKeyDown:$e42e1063c40fb3ef$export$b9ecd428b558ff10(qt.onKeyDown,u0=>{const d0=u0.ctrlKey||u0.altKey||u0.metaKey;if(u0.key==="Tab"&&u0.preventDefault(),!d0&&u0.key.length===1&&Sn(u0.key),["ArrowUp","ArrowDown","Home","End"].includes(u0.key)){let y0=zo().filter(b0=>!b0.disabled).map(b0=>b0.ref.current);if(["ArrowUp","End"].includes(u0.key)&&(y0=y0.slice().reverse()),["ArrowUp","ArrowDown"].includes(u0.key)){const b0=u0.target,O0=y0.indexOf(b0);y0=y0.slice(O0+1)}setTimeout(()=>_n(y0)),u0.preventDefault()}})}))))))}),$cc7e05a45900e73f$var$SelectItemAlignedPosition=reactExports.forwardRef((d,g)=>{const{__scopeSelect:b,onPlaced:et,...st}=d,at=$cc7e05a45900e73f$var$useSelectContext($cc7e05a45900e73f$var$CONTENT_NAME,b),vt=$cc7e05a45900e73f$var$useSelectContentContext($cc7e05a45900e73f$var$CONTENT_NAME,b),[Tt,Ct]=reactExports.useState(null),[pt,wt]=reactExports.useState(null),$t=$6ed0406888f73fc4$export$c7b2cbe3552a0d05(g,qr=>wt(qr)),Lt=$cc7e05a45900e73f$var$useCollection(b),jt=reactExports.useRef(!1),Ft=reactExports.useRef(!0),{viewport:Gt,selectedItem:Ht,selectedItemText:qt,focusSelectedItem:Kt}=vt,rr=reactExports.useCallback(()=>{if(at.trigger&&at.valueNode&&Tt&&pt&&Gt&&Ht&&qt){const qr=at.trigger.getBoundingClientRect(),Yr=pt.getBoundingClientRect(),vn=at.valueNode.getBoundingClientRect(),ko=qt.getBoundingClientRect();if(at.dir!=="rtl"){const b0=ko.left-Yr.left,O0=vn.left-b0,C0=qr.left-O0,v0=qr.width+C0,k0=Math.max(v0,Yr.width),N0=window.innerWidth-$cc7e05a45900e73f$var$CONTENT_MARGIN,w0=$ae6933e535247d3d$export$7d15b64cf5a3a4c4(O0,[$cc7e05a45900e73f$var$CONTENT_MARGIN,N0-k0]);Tt.style.minWidth=v0+"px",Tt.style.left=w0+"px"}else{const b0=Yr.right-ko.right,O0=window.innerWidth-vn.right-b0,C0=window.innerWidth-qr.right-O0,v0=qr.width+C0,k0=Math.max(v0,Yr.width),N0=window.innerWidth-$cc7e05a45900e73f$var$CONTENT_MARGIN,w0=$ae6933e535247d3d$export$7d15b64cf5a3a4c4(O0,[$cc7e05a45900e73f$var$CONTENT_MARGIN,N0-k0]);Tt.style.minWidth=v0+"px",Tt.style.right=w0+"px"}const Xo=Lt(),zo=window.innerHeight-$cc7e05a45900e73f$var$CONTENT_MARGIN*2,t0=Gt.scrollHeight,Uo=window.getComputedStyle(pt),No=parseInt(Uo.borderTopWidth,10),_n=parseInt(Uo.paddingTop,10),Kr=parseInt(Uo.borderBottomWidth,10),e0=parseInt(Uo.paddingBottom,10),Zr=No+_n+t0+e0+Kr,Ro=Math.min(Ht.offsetHeight*5,Zr),Sn=window.getComputedStyle(Gt),Tn=parseInt(Sn.paddingTop,10),n0=parseInt(Sn.paddingBottom,10),Go=qr.top+qr.height/2-$cc7e05a45900e73f$var$CONTENT_MARGIN,An=zo-Go,a0=Ht.offsetHeight/2,u0=Ht.offsetTop+a0,d0=No+_n+u0,f0=Zr-d0;if(d0<=Go){const b0=Ht===Xo[Xo.length-1].ref.current;Tt.style.bottom="0px";const O0=pt.clientHeight-Gt.offsetTop-Gt.offsetHeight,C0=Math.max(An,a0+(b0?n0:0)+O0+Kr),v0=d0+C0;Tt.style.height=v0+"px"}else{const b0=Ht===Xo[0].ref.current;Tt.style.top="0px";const C0=Math.max(Go,No+Gt.offsetTop+(b0?Tn:0)+a0)+f0;Tt.style.height=C0+"px",Gt.scrollTop=d0-Go+Gt.offsetTop}Tt.style.margin=`${$cc7e05a45900e73f$var$CONTENT_MARGIN}px 0`,Tt.style.minHeight=Ro+"px",Tt.style.maxHeight=zo+"px",et==null||et(),requestAnimationFrame(()=>jt.current=!0)}},[Lt,at.trigger,at.valueNode,Tt,pt,Gt,Ht,qt,at.dir,et]);$9f79659886946c16$export$e5c5a5f917a5871c(()=>rr(),[rr]);const[ir,or]=reactExports.useState();$9f79659886946c16$export$e5c5a5f917a5871c(()=>{pt&&or(window.getComputedStyle(pt).zIndex)},[pt]);const jr=reactExports.useCallback(qr=>{qr&&Ft.current===!0&&(rr(),Kt==null||Kt(),Ft.current=!1)},[rr,Kt]);return reactExports.createElement($cc7e05a45900e73f$var$SelectViewportProvider,{scope:b,contentWrapper:Tt,shouldExpandOnScrollRef:jt,onScrollButtonChange:jr},reactExports.createElement("div",{ref:Ct,style:{display:"flex",flexDirection:"column",position:"fixed",zIndex:ir}},reactExports.createElement($8927f6f2acc4f386$export$250ffa63cdc0d034.div,_extends$1({},st,{ref:$t,style:{boxSizing:"border-box",maxHeight:"100%",...st.style}}))))}),$cc7e05a45900e73f$var$SelectPopperPosition=reactExports.forwardRef((d,g)=>{const{__scopeSelect:b,align:et="start",collisionPadding:st=$cc7e05a45900e73f$var$CONTENT_MARGIN,...at}=d,vt=$cc7e05a45900e73f$var$usePopperScope(b);return reactExports.createElement($cf1ac5d9fe0e8206$export$7c6e2c02157bb7d2,_extends$1({},vt,at,{ref:g,align:et,collisionPadding:st,style:{boxSizing:"border-box",...at.style,"--radix-select-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-select-content-available-width":"var(--radix-popper-available-width)","--radix-select-content-available-height":"var(--radix-popper-available-height)","--radix-select-trigger-width":"var(--radix-popper-anchor-width)","--radix-select-trigger-height":"var(--radix-popper-anchor-height)"}}))}),[$cc7e05a45900e73f$var$SelectViewportProvider,$cc7e05a45900e73f$var$useSelectViewportContext]=$cc7e05a45900e73f$var$createSelectContext($cc7e05a45900e73f$var$CONTENT_NAME,{}),$cc7e05a45900e73f$var$VIEWPORT_NAME="SelectViewport",$cc7e05a45900e73f$export$9ed6e7b40248d36d=reactExports.forwardRef((d,g)=>{const{__scopeSelect:b,...et}=d,st=$cc7e05a45900e73f$var$useSelectContentContext($cc7e05a45900e73f$var$VIEWPORT_NAME,b),at=$cc7e05a45900e73f$var$useSelectViewportContext($cc7e05a45900e73f$var$VIEWPORT_NAME,b),vt=$6ed0406888f73fc4$export$c7b2cbe3552a0d05(g,st.onViewportChange),Tt=reactExports.useRef(0);return reactExports.createElement(reactExports.Fragment,null,reactExports.createElement("style",{dangerouslySetInnerHTML:{__html:"[data-radix-select-viewport]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}[data-radix-select-viewport]::-webkit-scrollbar{display:none}"}}),reactExports.createElement($cc7e05a45900e73f$var$Collection.Slot,{scope:b},reactExports.createElement($8927f6f2acc4f386$export$250ffa63cdc0d034.div,_extends$1({"data-radix-select-viewport":"",role:"presentation"},et,{ref:vt,style:{position:"relative",flex:1,overflow:"auto",...et.style},onScroll:$e42e1063c40fb3ef$export$b9ecd428b558ff10(et.onScroll,Ct=>{const pt=Ct.currentTarget,{contentWrapper:wt,shouldExpandOnScrollRef:$t}=at;if($t!=null&&$t.current&&wt){const Lt=Math.abs(Tt.current-pt.scrollTop);if(Lt>0){const jt=window.innerHeight-$cc7e05a45900e73f$var$CONTENT_MARGIN*2,Ft=parseFloat(wt.style.minHeight),Gt=parseFloat(wt.style.height),Ht=Math.max(Ft,Gt);if(Ht<jt){const qt=Ht+Lt,Kt=Math.min(jt,qt),rr=qt-Kt;wt.style.height=Kt+"px",wt.style.bottom==="0px"&&(pt.scrollTop=rr>0?rr:0,wt.style.justifyContent="flex-end")}}}Tt.current=pt.scrollTop})}))))}),$cc7e05a45900e73f$var$GROUP_NAME="SelectGroup",[$cc7e05a45900e73f$var$SelectGroupContextProvider,$cc7e05a45900e73f$var$useSelectGroupContext]=$cc7e05a45900e73f$var$createSelectContext($cc7e05a45900e73f$var$GROUP_NAME),$cc7e05a45900e73f$export$ee25a334c55de1f4=reactExports.forwardRef((d,g)=>{const{__scopeSelect:b,...et}=d,st=$1746a345f3d73bb7$export$f680877a34711e37();return reactExports.createElement($cc7e05a45900e73f$var$SelectGroupContextProvider,{scope:b,id:st},reactExports.createElement($8927f6f2acc4f386$export$250ffa63cdc0d034.div,_extends$1({role:"group","aria-labelledby":st},et,{ref:g})))}),$cc7e05a45900e73f$var$LABEL_NAME="SelectLabel",$cc7e05a45900e73f$export$f67338d29bd972f8=reactExports.forwardRef((d,g)=>{const{__scopeSelect:b,...et}=d,st=$cc7e05a45900e73f$var$useSelectGroupContext($cc7e05a45900e73f$var$LABEL_NAME,b);return reactExports.createElement($8927f6f2acc4f386$export$250ffa63cdc0d034.div,_extends$1({id:st.id},et,{ref:g}))}),$cc7e05a45900e73f$var$ITEM_NAME="SelectItem",[$cc7e05a45900e73f$var$SelectItemContextProvider,$cc7e05a45900e73f$var$useSelectItemContext]=$cc7e05a45900e73f$var$createSelectContext($cc7e05a45900e73f$var$ITEM_NAME),$cc7e05a45900e73f$export$13ef48a934230896=reactExports.forwardRef((d,g)=>{const{__scopeSelect:b,value:et,disabled:st=!1,textValue:at,...vt}=d,Tt=$cc7e05a45900e73f$var$useSelectContext($cc7e05a45900e73f$var$ITEM_NAME,b),Ct=$cc7e05a45900e73f$var$useSelectContentContext($cc7e05a45900e73f$var$ITEM_NAME,b),pt=Tt.value===et,[wt,$t]=reactExports.useState(at??""),[Lt,jt]=reactExports.useState(!1),Ft=$6ed0406888f73fc4$export$c7b2cbe3552a0d05(g,qt=>{var Kt;return(Kt=Ct.itemRefCallback)===null||Kt===void 0?void 0:Kt.call(Ct,qt,et,st)}),Gt=$1746a345f3d73bb7$export$f680877a34711e37(),Ht=()=>{st||(Tt.onValueChange(et),Tt.onOpenChange(!1))};if(et==="")throw new Error("A <Select.Item /> must have a value prop that is not an empty string. This is because the Select value can be set to an empty string to clear the selection and show the placeholder.");return reactExports.createElement($cc7e05a45900e73f$var$SelectItemContextProvider,{scope:b,value:et,disabled:st,textId:Gt,isSelected:pt,onItemTextChange:reactExports.useCallback(qt=>{$t(Kt=>{var rr;return Kt||((rr=qt==null?void 0:qt.textContent)!==null&&rr!==void 0?rr:"").trim()})},[])},reactExports.createElement($cc7e05a45900e73f$var$Collection.ItemSlot,{scope:b,value:et,disabled:st,textValue:wt},reactExports.createElement($8927f6f2acc4f386$export$250ffa63cdc0d034.div,_extends$1({role:"option","aria-labelledby":Gt,"data-highlighted":Lt?"":void 0,"aria-selected":pt&&Lt,"data-state":pt?"checked":"unchecked","aria-disabled":st||void 0,"data-disabled":st?"":void 0,tabIndex:st?void 0:-1},vt,{ref:Ft,onFocus:$e42e1063c40fb3ef$export$b9ecd428b558ff10(vt.onFocus,()=>jt(!0)),onBlur:$e42e1063c40fb3ef$export$b9ecd428b558ff10(vt.onBlur,()=>jt(!1)),onPointerUp:$e42e1063c40fb3ef$export$b9ecd428b558ff10(vt.onPointerUp,Ht),onPointerMove:$e42e1063c40fb3ef$export$b9ecd428b558ff10(vt.onPointerMove,qt=>{if(st){var Kt;(Kt=Ct.onItemLeave)===null||Kt===void 0||Kt.call(Ct)}else qt.currentTarget.focus({preventScroll:!0})}),onPointerLeave:$e42e1063c40fb3ef$export$b9ecd428b558ff10(vt.onPointerLeave,qt=>{if(qt.currentTarget===document.activeElement){var Kt;(Kt=Ct.onItemLeave)===null||Kt===void 0||Kt.call(Ct)}}),onKeyDown:$e42e1063c40fb3ef$export$b9ecd428b558ff10(vt.onKeyDown,qt=>{var Kt;((Kt=Ct.searchRef)===null||Kt===void 0?void 0:Kt.current)!==""&&qt.key===" "||($cc7e05a45900e73f$var$SELECTION_KEYS.includes(qt.key)&&Ht(),qt.key===" "&&qt.preventDefault())})}))))}),$cc7e05a45900e73f$var$ITEM_TEXT_NAME="SelectItemText",$cc7e05a45900e73f$export$3572fb0fb821ff49=reactExports.forwardRef((d,g)=>{const{__scopeSelect:b,className:et,style:st,...at}=d,vt=$cc7e05a45900e73f$var$useSelectContext($cc7e05a45900e73f$var$ITEM_TEXT_NAME,b),Tt=$cc7e05a45900e73f$var$useSelectContentContext($cc7e05a45900e73f$var$ITEM_TEXT_NAME,b),Ct=$cc7e05a45900e73f$var$useSelectItemContext($cc7e05a45900e73f$var$ITEM_TEXT_NAME,b),pt=$cc7e05a45900e73f$var$useSelectNativeOptionsContext($cc7e05a45900e73f$var$ITEM_TEXT_NAME,b),[wt,$t]=reactExports.useState(null),Lt=$6ed0406888f73fc4$export$c7b2cbe3552a0d05(g,qt=>$t(qt),Ct.onItemTextChange,qt=>{var Kt;return(Kt=Tt.itemTextRefCallback)===null||Kt===void 0?void 0:Kt.call(Tt,qt,Ct.value,Ct.disabled)}),jt=wt==null?void 0:wt.textContent,Ft=reactExports.useMemo(()=>reactExports.createElement("option",{key:Ct.value,value:Ct.value,disabled:Ct.disabled},jt),[Ct.disabled,Ct.value,jt]),{onNativeOptionAdd:Gt,onNativeOptionRemove:Ht}=pt;return $9f79659886946c16$export$e5c5a5f917a5871c(()=>(Gt(Ft),()=>Ht(Ft)),[Gt,Ht,Ft]),reactExports.createElement(reactExports.Fragment,null,reactExports.createElement($8927f6f2acc4f386$export$250ffa63cdc0d034.span,_extends$1({id:Ct.textId},at,{ref:Lt})),Ct.isSelected&&vt.valueNode&&!vt.valueNodeHasChildren?reactDomExports.createPortal(at.children,vt.valueNode):null)}),$cc7e05a45900e73f$var$ITEM_INDICATOR_NAME="SelectItemIndicator",$cc7e05a45900e73f$export$6b9198de19accfe6=reactExports.forwardRef((d,g)=>{const{__scopeSelect:b,...et}=d;return $cc7e05a45900e73f$var$useSelectItemContext($cc7e05a45900e73f$var$ITEM_INDICATOR_NAME,b).isSelected?reactExports.createElement($8927f6f2acc4f386$export$250ffa63cdc0d034.span,_extends$1({"aria-hidden":!0},et,{ref:g})):null}),$cc7e05a45900e73f$var$SCROLL_UP_BUTTON_NAME="SelectScrollUpButton",$cc7e05a45900e73f$export$d8117927658af6d7=reactExports.forwardRef((d,g)=>{const b=$cc7e05a45900e73f$var$useSelectContentContext($cc7e05a45900e73f$var$SCROLL_UP_BUTTON_NAME,d.__scopeSelect),et=$cc7e05a45900e73f$var$useSelectViewportContext($cc7e05a45900e73f$var$SCROLL_UP_BUTTON_NAME,d.__scopeSelect),[st,at]=reactExports.useState(!1),vt=$6ed0406888f73fc4$export$c7b2cbe3552a0d05(g,et.onScrollButtonChange);return $9f79659886946c16$export$e5c5a5f917a5871c(()=>{if(b.viewport&&b.isPositioned){let pt=function(){const wt=Ct.scrollTop>0;at(wt)};var Tt=pt;const Ct=b.viewport;return pt(),Ct.addEventListener("scroll",pt),()=>Ct.removeEventListener("scroll",pt)}},[b.viewport,b.isPositioned]),st?reactExports.createElement($cc7e05a45900e73f$var$SelectScrollButtonImpl,_extends$1({},d,{ref:vt,onAutoScroll:()=>{const{viewport:Tt,selectedItem:Ct}=b;Tt&&Ct&&(Tt.scrollTop=Tt.scrollTop-Ct.offsetHeight)}})):null}),$cc7e05a45900e73f$var$SCROLL_DOWN_BUTTON_NAME="SelectScrollDownButton",$cc7e05a45900e73f$export$ff951e476c12189=reactExports.forwardRef((d,g)=>{const b=$cc7e05a45900e73f$var$useSelectContentContext($cc7e05a45900e73f$var$SCROLL_DOWN_BUTTON_NAME,d.__scopeSelect),et=$cc7e05a45900e73f$var$useSelectViewportContext($cc7e05a45900e73f$var$SCROLL_DOWN_BUTTON_NAME,d.__scopeSelect),[st,at]=reactExports.useState(!1),vt=$6ed0406888f73fc4$export$c7b2cbe3552a0d05(g,et.onScrollButtonChange);return $9f79659886946c16$export$e5c5a5f917a5871c(()=>{if(b.viewport&&b.isPositioned){let pt=function(){const wt=Ct.scrollHeight-Ct.clientHeight,$t=Math.ceil(Ct.scrollTop)<wt;at($t)};var Tt=pt;const Ct=b.viewport;return pt(),Ct.addEventListener("scroll",pt),()=>Ct.removeEventListener("scroll",pt)}},[b.viewport,b.isPositioned]),st?reactExports.createElement($cc7e05a45900e73f$var$SelectScrollButtonImpl,_extends$1({},d,{ref:vt,onAutoScroll:()=>{const{viewport:Tt,selectedItem:Ct}=b;Tt&&Ct&&(Tt.scrollTop=Tt.scrollTop+Ct.offsetHeight)}})):null}),$cc7e05a45900e73f$var$SelectScrollButtonImpl=reactExports.forwardRef((d,g)=>{const{__scopeSelect:b,onAutoScroll:et,...st}=d,at=$cc7e05a45900e73f$var$useSelectContentContext("SelectScrollButton",b),vt=reactExports.useRef(null),Tt=$cc7e05a45900e73f$var$useCollection(b),Ct=reactExports.useCallback(()=>{vt.current!==null&&(window.clearInterval(vt.current),vt.current=null)},[]);return reactExports.useEffect(()=>()=>Ct(),[Ct]),$9f79659886946c16$export$e5c5a5f917a5871c(()=>{var pt;const wt=Tt().find($t=>$t.ref.current===document.activeElement);wt==null||(pt=wt.ref.current)===null||pt===void 0||pt.scrollIntoView({block:"nearest"})},[Tt]),reactExports.createElement($8927f6f2acc4f386$export$250ffa63cdc0d034.div,_extends$1({"aria-hidden":!0},st,{ref:g,style:{flexShrink:0,...st.style},onPointerDown:$e42e1063c40fb3ef$export$b9ecd428b558ff10(st.onPointerDown,()=>{vt.current===null&&(vt.current=window.setInterval(et,50))}),onPointerMove:$e42e1063c40fb3ef$export$b9ecd428b558ff10(st.onPointerMove,()=>{var pt;(pt=at.onItemLeave)===null||pt===void 0||pt.call(at),vt.current===null&&(vt.current=window.setInterval(et,50))}),onPointerLeave:$e42e1063c40fb3ef$export$b9ecd428b558ff10(st.onPointerLeave,()=>{Ct()})}))}),$cc7e05a45900e73f$export$eba4b1df07cb1d3=reactExports.forwardRef((d,g)=>{const{__scopeSelect:b,...et}=d;return reactExports.createElement($8927f6f2acc4f386$export$250ffa63cdc0d034.div,_extends$1({"aria-hidden":!0},et,{ref:g}))});function $cc7e05a45900e73f$var$shouldShowPlaceholder(d){return d===""||d===void 0}const $cc7e05a45900e73f$var$BubbleSelect=reactExports.forwardRef((d,g)=>{const{value:b,...et}=d,st=reactExports.useRef(null),at=$6ed0406888f73fc4$export$c7b2cbe3552a0d05(g,st),vt=$010c2913dbd2fe3d$export$5cae361ad82dce8b(b);return reactExports.useEffect(()=>{const Tt=st.current,Ct=window.HTMLSelectElement.prototype,wt=Object.getOwnPropertyDescriptor(Ct,"value").set;if(vt!==b&&wt){const $t=new Event("change",{bubbles:!0});wt.call(Tt,b),Tt.dispatchEvent($t)}},[vt,b]),reactExports.createElement($ea1ef594cf570d83$export$439d29a4e110a164,{asChild:!0},reactExports.createElement("select",_extends$1({},et,{ref:at,defaultValue:b})))});$cc7e05a45900e73f$var$BubbleSelect.displayName="BubbleSelect";function $cc7e05a45900e73f$var$useTypeaheadSearch(d){const g=$b1b2314f5f9a1d84$export$25bec8c6f54ee79a(d),b=reactExports.useRef(""),et=reactExports.useRef(0),st=reactExports.useCallback(vt=>{const Tt=b.current+vt;g(Tt),function Ct(pt){b.current=pt,window.clearTimeout(et.current),pt!==""&&(et.current=window.setTimeout(()=>Ct(""),1e3))}(Tt)},[g]),at=reactExports.useCallback(()=>{b.current="",window.clearTimeout(et.current)},[]);return reactExports.useEffect(()=>()=>window.clearTimeout(et.current),[]),[b,st,at]}function $cc7e05a45900e73f$var$findNextItem(d,g,b){const st=g.length>1&&Array.from(g).every(pt=>pt===g[0])?g[0]:g,at=b?d.indexOf(b):-1;let vt=$cc7e05a45900e73f$var$wrapArray(d,Math.max(at,0));st.length===1&&(vt=vt.filter(pt=>pt!==b));const Ct=vt.find(pt=>pt.textValue.toLowerCase().startsWith(st.toLowerCase()));return Ct!==b?Ct:void 0}function $cc7e05a45900e73f$var$wrapArray(d,g){return d.map((b,et)=>d[(g+et)%d.length])}const $cc7e05a45900e73f$export$be92b6f5f03c0fe9=$cc7e05a45900e73f$export$ef9b1a59e592288f,$cc7e05a45900e73f$export$41fb9f06171c75f4=$cc7e05a45900e73f$export$3ac1e88a1c0b9f1,$cc7e05a45900e73f$export$4c8d1a57a761ef94=$cc7e05a45900e73f$export$e288731fd71264f0,$cc7e05a45900e73f$export$f04a61298a47a40f=$cc7e05a45900e73f$export$99b400cabb58c515,$cc7e05a45900e73f$export$602eac185826482c=$cc7e05a45900e73f$export$b2af6c9944296213,$cc7e05a45900e73f$export$7c6e2c02157bb7d2=$cc7e05a45900e73f$export$c973a4b3cb86a03d,$cc7e05a45900e73f$export$d5c6c08dc2d3ca7=$cc7e05a45900e73f$export$9ed6e7b40248d36d,$cc7e05a45900e73f$export$eb2fcfdbd7ba97d4=$cc7e05a45900e73f$export$ee25a334c55de1f4,$cc7e05a45900e73f$export$b04be29aa201d4f5=$cc7e05a45900e73f$export$f67338d29bd972f8,$cc7e05a45900e73f$export$6d08773d2e66f8f2=$cc7e05a45900e73f$export$13ef48a934230896,$cc7e05a45900e73f$export$d6e5bf9c43ea9319=$cc7e05a45900e73f$export$3572fb0fb821ff49,$cc7e05a45900e73f$export$c3468e2714d175fa=$cc7e05a45900e73f$export$6b9198de19accfe6,$cc7e05a45900e73f$export$2f60d3ec9ad468f2=$cc7e05a45900e73f$export$d8117927658af6d7,$cc7e05a45900e73f$export$bf1aedc3039c8d63=$cc7e05a45900e73f$export$ff951e476c12189,$cc7e05a45900e73f$export$1ff3c3f08ae963c0=$cc7e05a45900e73f$export$eba4b1df07cb1d3,Select=$cc7e05a45900e73f$export$be92b6f5f03c0fe9,SelectGroup=$cc7e05a45900e73f$export$eb2fcfdbd7ba97d4,SelectValue=$cc7e05a45900e73f$export$4c8d1a57a761ef94,SelectTrigger=reactExports.forwardRef(({className:d,children:g,...b},et)=>jsxRuntimeExports.jsxs($cc7e05a45900e73f$export$41fb9f06171c75f4,{ref:et,className:cn$1("flex h-9 w-full items-center justify-between whitespace-nowrap rounded-md border border-input bg-transparent px-3 py-2 text-sm shadow-sm ring-offset-background placeholder:text-muted-foreground focus:outline-none focus:ring-1 focus:ring-ring disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1",d),tabIndex:-1,...b,children:[g,jsxRuntimeExports.jsx($cc7e05a45900e73f$export$f04a61298a47a40f,{asChild:!0,children:jsxRuntimeExports.jsx(CaretSortIcon,{className:"h-4 w-4 opacity-50"})})]}));SelectTrigger.displayName=$cc7e05a45900e73f$export$41fb9f06171c75f4.displayName;const SelectScrollUpButton=reactExports.forwardRef(({className:d,...g},b)=>jsxRuntimeExports.jsx($cc7e05a45900e73f$export$2f60d3ec9ad468f2,{ref:b,className:cn$1("flex cursor-default items-center justify-center py-1",d),...g,children:jsxRuntimeExports.jsx(ChevronUpIcon,{})}));SelectScrollUpButton.displayName=$cc7e05a45900e73f$export$2f60d3ec9ad468f2.displayName;const SelectScrollDownButton=reactExports.forwardRef(({className:d,...g},b)=>jsxRuntimeExports.jsx($cc7e05a45900e73f$export$bf1aedc3039c8d63,{ref:b,className:cn$1("flex cursor-default items-center justify-center py-1",d),...g,children:jsxRuntimeExports.jsx(ChevronDownIcon,{})}));SelectScrollDownButton.displayName=$cc7e05a45900e73f$export$bf1aedc3039c8d63.displayName;const SelectContent=reactExports.forwardRef(({className:d,children:g,position:b="popper",...et},st)=>jsxRuntimeExports.jsx($cc7e05a45900e73f$export$602eac185826482c,{children:jsxRuntimeExports.jsxs($cc7e05a45900e73f$export$7c6e2c02157bb7d2,{ref:st,className:cn$1("relative z-50 max-h-96 min-w-[8rem] overflow-hidden rounded-md border bg-popover text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",b==="popper"&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",d),position:b,onCloseAutoFocus:at=>at.preventDefault(),...et,children:[jsxRuntimeExports.jsx(SelectScrollUpButton,{}),jsxRuntimeExports.jsx($cc7e05a45900e73f$export$d5c6c08dc2d3ca7,{className:cn$1("p-1",b==="popper"&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]"),children:g}),jsxRuntimeExports.jsx(SelectScrollDownButton,{})]})}));SelectContent.displayName=$cc7e05a45900e73f$export$7c6e2c02157bb7d2.displayName;const SelectLabel=reactExports.forwardRef(({className:d,...g},b)=>jsxRuntimeExports.jsx($cc7e05a45900e73f$export$b04be29aa201d4f5,{ref:b,className:cn$1("px-2 py-1.5 text-sm font-semibold",d),...g}));SelectLabel.displayName=$cc7e05a45900e73f$export$b04be29aa201d4f5.displayName;const SelectItem=reactExports.forwardRef(({className:d,children:g,...b},et)=>jsxRuntimeExports.jsxs($cc7e05a45900e73f$export$6d08773d2e66f8f2,{ref:et,className:cn$1("relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-2 pr-8 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",d),...b,children:[jsxRuntimeExports.jsx("span",{className:"absolute right-2 flex h-3.5 w-3.5 items-center justify-center",children:jsxRuntimeExports.jsx($cc7e05a45900e73f$export$c3468e2714d175fa,{children:jsxRuntimeExports.jsx(CheckIcon,{className:"h-4 w-4"})})}),jsxRuntimeExports.jsx($cc7e05a45900e73f$export$d6e5bf9c43ea9319,{children:g})]}));SelectItem.displayName=$cc7e05a45900e73f$export$6d08773d2e66f8f2.displayName;const SelectSeparator=reactExports.forwardRef(({className:d,...g},b)=>jsxRuntimeExports.jsx($cc7e05a45900e73f$export$1ff3c3f08ae963c0,{ref:b,className:cn$1("-mx-1 my-1 h-px bg-muted",d),...g}));SelectSeparator.displayName=$cc7e05a45900e73f$export$1ff3c3f08ae963c0.displayName;const formSchema=objectType({enableFileManager:booleanType(),inputDirectory:stringType(),outputDirectory:stringType(),enableDownloadMask:booleanType(),enableManualInpainting:booleanType(),enableUploadMask:booleanType(),enableAutoExtractPrompt:booleanType(),removeBGModel:stringType(),realesrganModel:stringType(),interactiveSegModel:stringType()}),TAB_GENERAL="General",TAB_MODEL="Model",TAB_PLUGINS="Plugins",TAB_NAMES=[TAB_MODEL,TAB_GENERAL,TAB_PLUGINS];function SettingsDialog(){const[d,g]=useToggle$1(!1),[b,et]=reactExports.useState(TAB_MODEL),[st,at,vt,Tt,Ct,pt,wt,$t]=useStore(No=>[No.updateAppState,No.settings,No.updateSettings,No.fileManagerState,No.setModel,No.serverConfig,No.updateServerConfig,No.setServerConfig]),{toast:Lt}=useToast(),[jt,Ft]=reactExports.useState(at.model),[Gt,Ht]=reactExports.useState([]),qt=Gt.length>0;reactExports.useEffect(()=>{Ft(at.model)},[at.model]);const Kt=useForm({resolver:t$1(formSchema),defaultValues:{enableDownloadMask:at.enableDownloadMask,enableManualInpainting:at.enableManualInpainting,enableUploadMask:at.enableUploadMask,enableAutoExtractPrompt:at.enableAutoExtractPrompt,inputDirectory:Tt.inputDirectory,outputDirectory:Tt.outputDirectory,removeBGModel:pt==null?void 0:pt.removeBGModel,realesrganModel:pt==null?void 0:pt.realesrganModel,interactiveSegModel:pt==null?void 0:pt.interactiveSegModel}});reactExports.useEffect(()=>{pt&&($t(pt),Kt.setValue("removeBGModel",pt.removeBGModel),Kt.setValue("realesrganModel",pt.realesrganModel),Kt.setValue("interactiveSegModel",pt.interactiveSegModel))},[Kt,pt]);async function rr(No){vt({enableDownloadMask:No.enableDownloadMask,enableManualInpainting:No.enableManualInpainting,enableUploadMask:No.enableUploadMask,enableAutoExtractPrompt:No.enableAutoExtractPrompt});const _n=jt.name!==at.model.name,Kr=(pt==null?void 0:pt.removeBGModel)!==No.removeBGModel&&jr,e0=(pt==null?void 0:pt.realesrganModel)!==No.realesrganModel&&qr,Zr=(pt==null?void 0:pt.interactiveSegModel)!==No.interactiveSegModel&&Yr;if(_n||Kr||e0||Zr){const Sn=[];if(_n&&Sn.push(`Switching model from ${at.model.name} to ${jt.name}`),Kr&&Sn.push(`Switching RemoveBG model from ${pt==null?void 0:pt.removeBGModel} to ${No.removeBGModel}`),e0&&Sn.push(`Switching RealESRGAN model from ${pt==null?void 0:pt.realesrganModel} to ${No.realesrganModel}`),Zr&&Sn.push(`Switching ${PluginName.InteractiveSeg} model from ${pt==null?void 0:pt.interactiveSegModel} to ${No.interactiveSegModel}`),Ht(Sn),st({disableShortCuts:!0}),_n)try{Lt({title:`Switch to ${jt.name} success`}),Ct(jt)}catch(Tn){Lt({variant:"destructive",title:`Switch to ${jt.name} failed: ${Tn}`}),Ft(at.model)}if(Kr)try{wt({removeBGModel:No.removeBGModel}),Lt({title:`Switch to removeBG ${No.removeBGModel} success`})}catch(Tn){Lt({variant:"destructive",title:`Switch RemoveBG model to ${No.removeBGModel} failed: ${Tn}`})}if(e0)try{const Tn=await switchPluginModel(PluginName.RealESRGAN,No.realesrganModel);if(Tn.status!==200)throw new Error(Tn.statusText)}catch(Tn){Lt({variant:"destructive",title:`Switch RealESRGAN model to ${No.realesrganModel} failed: ${Tn}`})}if(Zr)try{const Tn=await switchPluginModel(PluginName.InteractiveSeg,No.interactiveSegModel);if(Tn.status!==200)throw new Error(Tn.statusText)}catch(Tn){Lt({variant:"destructive",title:`Switch ${PluginName.InteractiveSeg} model to ${No.interactiveSegModel} failed: ${Tn}`})}Ht([]),st({disableShortCuts:!1})}}useHotKey("s",()=>{g(),d&&rr(Kt.getValues())},[d,Kt,jt,pt]);const ir=pt.modelInfos,or=pt.plugins,jr=or.some(No=>No.name===PluginName.RemoveBG),qr=or.some(No=>No.name===PluginName.RealESRGAN),Yr=or.some(No=>No.name===PluginName.InteractiveSeg);function vn(No){g(),No||rr(Kt.getValues())}function ko(No){Ft(No)}function Xo(No){return ir?ir.filter(_n=>No.includes(_n.model_type)).map(_n=>jsxRuntimeExports.jsxs("div",{onClick:()=>ko(_n),className:"px-2",children:[jsxRuntimeExports.jsx("div",{className:cn$1([_n.name===jt.name?"bg-muted":"hover:bg-muted","rounded-md px-2 py-2","cursor-default"]),children:jsxRuntimeExports.jsx("div",{className:"text-base",children:_n.name})}),jsxRuntimeExports.jsx(Separator,{className:"my-1"})]},_n.name)):jsxRuntimeExports.jsx("div",{children:"Please download model first"})}function zo(){let No=MODEL_TYPE_INPAINT;for(let _n of ir)if(jt.name===_n.name){No=_n.model_type,No===MODEL_TYPE_DIFFUSERS_SDXL&&(No=MODEL_TYPE_DIFFUSERS_SD),No===MODEL_TYPE_DIFFUSERS_SDXL_INPAINT&&(No=MODEL_TYPE_DIFFUSERS_SD_INPAINT);break}return jsxRuntimeExports.jsxs("div",{className:"flex flex-col gap-4 w-[510px]",children:[jsxRuntimeExports.jsxs("div",{className:"flex flex-col gap-4 rounded-md",children:[jsxRuntimeExports.jsx("div",{className:"font-medium",children:"Current Model"}),jsxRuntimeExports.jsx("div",{children:jt.name})]}),jsxRuntimeExports.jsx(Separator,{}),jsxRuntimeExports.jsxs("div",{className:"space-y-4  rounded-md",children:[jsxRuntimeExports.jsx("div",{className:"flex gap-1 items-center justify-start",children:jsxRuntimeExports.jsx("div",{className:"font-medium",children:"Available models"})}),jsxRuntimeExports.jsxs(Tabs,{defaultValue:No,children:[jsxRuntimeExports.jsxs(TabsList,{children:[jsxRuntimeExports.jsx(TabsTrigger,{value:MODEL_TYPE_INPAINT,children:"Inpaint"}),jsxRuntimeExports.jsx(TabsTrigger,{value:MODEL_TYPE_DIFFUSERS_SD,children:"Stable Diffusion"}),jsxRuntimeExports.jsx(TabsTrigger,{value:MODEL_TYPE_DIFFUSERS_SD_INPAINT,children:"Stable Diffusion Inpaint"}),jsxRuntimeExports.jsx(TabsTrigger,{value:MODEL_TYPE_OTHER,children:"Other Diffusion"})]}),jsxRuntimeExports.jsxs(ScrollArea,{className:"h-[240px] w-full mt-2 outline-none border rounded-lg",children:[jsxRuntimeExports.jsx(TabsContent,{value:MODEL_TYPE_INPAINT,children:Xo([MODEL_TYPE_INPAINT])}),jsxRuntimeExports.jsx(TabsContent,{value:MODEL_TYPE_DIFFUSERS_SD,children:Xo([MODEL_TYPE_DIFFUSERS_SD,MODEL_TYPE_DIFFUSERS_SDXL])}),jsxRuntimeExports.jsx(TabsContent,{value:MODEL_TYPE_DIFFUSERS_SD_INPAINT,children:Xo([MODEL_TYPE_DIFFUSERS_SD_INPAINT,MODEL_TYPE_DIFFUSERS_SDXL_INPAINT])}),jsxRuntimeExports.jsx(TabsContent,{value:MODEL_TYPE_OTHER,children:Xo([MODEL_TYPE_OTHER])})]})]})]})]})}function t0(){return jsxRuntimeExports.jsxs("div",{className:"space-y-4 w-[510px]",children:[jsxRuntimeExports.jsx(FormField,{control:Kt.control,name:"enableManualInpainting",render:({field:No})=>jsxRuntimeExports.jsxs(FormItem,{className:"flex items-center justify-between",children:[jsxRuntimeExports.jsxs("div",{className:"space-y-0.5",children:[jsxRuntimeExports.jsx(FormLabel,{children:"Enable manual inpainting"}),jsxRuntimeExports.jsx(FormDescription,{children:"For erase model, click a button to trigger inpainting after draw mask."})]}),jsxRuntimeExports.jsx(FormControl,{children:jsxRuntimeExports.jsx(Switch,{checked:No.value,onCheckedChange:No.onChange})})]})}),jsxRuntimeExports.jsx(Separator,{}),jsxRuntimeExports.jsx(FormField,{control:Kt.control,name:"enableDownloadMask",render:({field:No})=>jsxRuntimeExports.jsxs(FormItem,{className:"flex items-center justify-between",children:[jsxRuntimeExports.jsxs("div",{className:"space-y-0.5",children:[jsxRuntimeExports.jsx(FormLabel,{children:"Enable download mask"}),jsxRuntimeExports.jsx(FormDescription,{children:"Also download the mask after save the inpainting result."})]}),jsxRuntimeExports.jsx(FormControl,{children:jsxRuntimeExports.jsx(Switch,{checked:No.value,onCheckedChange:No.onChange})})]})}),jsxRuntimeExports.jsx(Separator,{}),jsxRuntimeExports.jsx(FormField,{control:Kt.control,name:"enableAutoExtractPrompt",render:({field:No})=>jsxRuntimeExports.jsxs(FormItem,{className:"flex items-center justify-between",children:[jsxRuntimeExports.jsxs("div",{className:"space-y-0.5",children:[jsxRuntimeExports.jsx(FormLabel,{children:"Enable auto extract prompt"}),jsxRuntimeExports.jsx(FormDescription,{children:"Automatically extract prompt/negativate prompt from the image meta."})]}),jsxRuntimeExports.jsx(FormControl,{children:jsxRuntimeExports.jsx(Switch,{checked:No.value,onCheckedChange:No.onChange})})]})})]})}function Uo(){return jsxRuntimeExports.jsxs("div",{className:"space-y-4 w-[510px]",children:[jsxRuntimeExports.jsx(FormField,{control:Kt.control,name:"removeBGModel",render:({field:No})=>jsxRuntimeExports.jsxs(FormItem,{className:"flex items-center justify-between",children:[jsxRuntimeExports.jsxs("div",{className:"space-y-0.5",children:[jsxRuntimeExports.jsx(FormLabel,{children:"Remove Background"}),jsxRuntimeExports.jsx(FormDescription,{children:"Remove background model"})]}),jsxRuntimeExports.jsxs(Select,{onValueChange:No.onChange,defaultValue:No.value,disabled:!jr,children:[jsxRuntimeExports.jsx(FormControl,{children:jsxRuntimeExports.jsx(SelectTrigger,{className:"w-auto",children:jsxRuntimeExports.jsx(SelectValue,{placeholder:"Select removebg model"})})}),jsxRuntimeExports.jsx(SelectContent,{align:"end",children:jsxRuntimeExports.jsx(SelectGroup,{children:pt==null?void 0:pt.removeBGModels.map(_n=>jsxRuntimeExports.jsx(SelectItem,{value:_n,children:_n},_n))})})]})]})}),jsxRuntimeExports.jsx(Separator,{}),jsxRuntimeExports.jsx(FormField,{control:Kt.control,name:"realesrganModel",render:({field:No})=>jsxRuntimeExports.jsxs(FormItem,{className:"flex items-center justify-between",children:[jsxRuntimeExports.jsxs("div",{className:"space-y-0.5",children:[jsxRuntimeExports.jsx(FormLabel,{children:"RealESRGAN"}),jsxRuntimeExports.jsx(FormDescription,{children:"RealESRGAN Model"})]}),jsxRuntimeExports.jsxs(Select,{onValueChange:No.onChange,defaultValue:No.value,disabled:!qr,children:[jsxRuntimeExports.jsx(FormControl,{children:jsxRuntimeExports.jsx(SelectTrigger,{className:"w-auto",children:jsxRuntimeExports.jsx(SelectValue,{placeholder:"Select RealESRGAN model"})})}),jsxRuntimeExports.jsx(SelectContent,{align:"end",children:jsxRuntimeExports.jsx(SelectGroup,{children:pt==null?void 0:pt.realesrganModels.map(_n=>jsxRuntimeExports.jsx(SelectItem,{value:_n,children:_n},_n))})})]})]})}),jsxRuntimeExports.jsx(Separator,{}),jsxRuntimeExports.jsx(FormField,{control:Kt.control,name:"interactiveSegModel",render:({field:No})=>jsxRuntimeExports.jsxs(FormItem,{className:"flex items-center justify-between",children:[jsxRuntimeExports.jsxs("div",{className:"space-y-0.5",children:[jsxRuntimeExports.jsx(FormLabel,{children:"Interactive Segmentation"}),jsxRuntimeExports.jsx(FormDescription,{children:"Interactive Segmentation Model"})]}),jsxRuntimeExports.jsxs(Select,{onValueChange:No.onChange,defaultValue:No.value,disabled:!Yr,children:[jsxRuntimeExports.jsx(FormControl,{children:jsxRuntimeExports.jsx(SelectTrigger,{className:"w-auto",children:jsxRuntimeExports.jsx(SelectValue,{placeholder:"Select interactive segmentation model"})})}),jsxRuntimeExports.jsx(SelectContent,{align:"end",children:jsxRuntimeExports.jsx(SelectGroup,{children:pt==null?void 0:pt.interactiveSegModels.map(_n=>jsxRuntimeExports.jsx(SelectItem,{value:_n,children:_n},_n))})})]})]})})]})}return jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx(AlertDialog,{open:qt,children:jsxRuntimeExports.jsx(AlertDialogContent,{children:jsxRuntimeExports.jsx(AlertDialogHeader,{children:jsxRuntimeExports.jsxs("div",{className:"flex flex-col justify-center items-center gap-4",children:[jsxRuntimeExports.jsxs("div",{role:"status",children:[jsxRuntimeExports.jsxs("svg",{"aria-hidden":"true",className:"w-8 h-8 text-gray-200 animate-spin dark:text-gray-600 fill-primary",viewBox:"0 0 100 101",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[jsxRuntimeExports.jsx("path",{d:"M100 50.5908C100 78.2051 77.6142 100.591 50 100.591C22.3858 100.591 0 78.2051 0 50.5908C0 22.9766 22.3858 0.59082 50 0.59082C77.6142 0.59082 100 22.9766 100 50.5908ZM9.08144 50.5908C9.08144 73.1895 27.4013 91.5094 50 91.5094C72.5987 91.5094 90.9186 73.1895 90.9186 50.5908C90.9186 27.9921 72.5987 9.67226 50 9.67226C27.4013 9.67226 9.08144 27.9921 9.08144 50.5908Z",fill:"currentColor"}),jsxRuntimeExports.jsx("path",{d:"M93.9676 39.0409C96.393 38.4038 97.8624 35.9116 97.0079 33.5539C95.2932 28.8227 92.871 24.3692 89.8167 20.348C85.8452 15.1192 80.8826 10.7238 75.2124 7.41289C69.5422 4.10194 63.2754 1.94025 56.7698 1.05124C51.7666 0.367541 46.6976 0.446843 41.7345 1.27873C39.2613 1.69328 37.813 4.19778 38.4501 6.62326C39.0873 9.04874 41.5694 10.4717 44.0505 10.1071C47.8511 9.54855 51.7191 9.52689 55.5402 10.0491C60.8642 10.7766 65.9928 12.5457 70.6331 15.2552C75.2735 17.9648 79.3347 21.5619 82.5849 25.841C84.9175 28.9121 86.7997 32.2913 88.1811 35.8758C89.083 38.2158 91.5421 39.6781 93.9676 39.0409Z",fill:"currentFill"})]}),jsxRuntimeExports.jsx("span",{className:"sr-only",children:"Loading..."})]}),Gt?jsxRuntimeExports.jsx("div",{className:"flex flex-col",children:Gt.map((No,_n)=>jsxRuntimeExports.jsx("div",{children:No},_n))}):jsxRuntimeExports.jsx(jsxRuntimeExports.Fragment,{})]})})})}),jsxRuntimeExports.jsxs(Dialog,{open:d,onOpenChange:vn,children:[jsxRuntimeExports.jsx(DialogTrigger,{asChild:!0,children:jsxRuntimeExports.jsx(IconButton,{tooltip:"Settings",children:jsxRuntimeExports.jsx(Settings,{})})}),jsxRuntimeExports.jsxs(DialogContent,{className:"max-w-3xl h-[600px]",onOpenAutoFocus:No=>No.preventDefault(),children:[jsxRuntimeExports.jsx(DialogTitle,{children:"Settings"}),jsxRuntimeExports.jsx(Separator,{}),jsxRuntimeExports.jsxs("div",{className:"flex flex-row space-x-8 h-full",children:[jsxRuntimeExports.jsx("div",{className:"flex flex-col space-y-1",children:TAB_NAMES.map(No=>jsxRuntimeExports.jsx(Button,{variant:"ghost",onClick:()=>et(No),className:cn$1(b===No?"bg-muted ":"hover:bg-muted","justify-start"),children:No},No))}),jsxRuntimeExports.jsx(Separator,{orientation:"vertical"}),jsxRuntimeExports.jsx(Form,{...Kt,children:jsxRuntimeExports.jsx("div",{className:"flex w-full justify-center",children:jsxRuntimeExports.jsxs("form",{onSubmit:Kt.handleSubmit(rr),children:[b===TAB_MODEL?zo():jsxRuntimeExports.jsx(jsxRuntimeExports.Fragment,{}),b===TAB_GENERAL?t0():jsxRuntimeExports.jsx(jsxRuntimeExports.Fragment,{}),b===TAB_PLUGINS?Uo():jsxRuntimeExports.jsx(jsxRuntimeExports.Fragment,{}),jsxRuntimeExports.jsx("div",{className:"absolute right-10 bottom-6",children:jsxRuntimeExports.jsx(Button,{onClick:()=>vn(!1),children:"Ok"})})]})})})]})]})]})]})}var U$3=1,Y$1=.9,H$1=.8,J=.17,p=.1,u=.999,$=.9999,k$1=.99,m=/[\\\/_+.#"@\[\(\{&]/,B$1=/[\\\/_+.#"@\[\(\{&]/g,K$1=/[\s-]/,X$2=/[\s-]/g;function G$1(d,g,b,et,st,at,vt){if(at===g.length)return st===d.length?U$3:k$1;var Tt=`${st},${at}`;if(vt[Tt]!==void 0)return vt[Tt];for(var Ct=et.charAt(at),pt=b.indexOf(Ct,st),wt=0,$t,Lt,jt,Ft;pt>=0;)$t=G$1(d,g,b,et,pt+1,at+1,vt),$t>wt&&(pt===st?$t*=U$3:m.test(d.charAt(pt-1))?($t*=H$1,jt=d.slice(st,pt-1).match(B$1),jt&&st>0&&($t*=Math.pow(u,jt.length))):K$1.test(d.charAt(pt-1))?($t*=Y$1,Ft=d.slice(st,pt-1).match(X$2),Ft&&st>0&&($t*=Math.pow(u,Ft.length))):($t*=J,st>0&&($t*=Math.pow(u,pt-st))),d.charAt(pt)!==g.charAt(at)&&($t*=$)),($t<p&&b.charAt(pt-1)===et.charAt(at+1)||et.charAt(at+1)===et.charAt(at)&&b.charAt(pt-1)!==et.charAt(at))&&(Lt=G$1(d,g,b,et,pt+1,at+2,vt),Lt*p>$t&&($t=Lt*p)),$t>wt&&(wt=$t),pt=b.indexOf(Ct,pt+1);return vt[Tt]=wt,wt}function D$1(d){return d.toLowerCase().replace(X$2," ")}function W(d,g,b){return d=b&&b.length>0?`${d+" "+b.join(" ")}`:d,G$1(d,g,D$1(d),D$1(g),0,0,{})}var V$1='[cmdk-group=""]',X$1='[cmdk-group-items=""]',ge='[cmdk-group-heading=""]',Y='[cmdk-item=""]',le$1=`${Y}:not([aria-disabled="true"])`,Q$2="cmdk-item-select",M$2="data-value",Re=(d,g,b)=>W(d,g,b),ue=reactExports.createContext(void 0),G=()=>reactExports.useContext(ue),de=reactExports.createContext(void 0),Z$1=()=>reactExports.useContext(de),fe$2=reactExports.createContext(void 0),me$1=reactExports.forwardRef((d,g)=>{let b=k(()=>{var Tn,n0;return{search:"",value:(n0=(Tn=d.value)!=null?Tn:d.defaultValue)!=null?n0:"",filtered:{count:0,items:new Map,groups:new Set}}}),et=k(()=>new Set),st=k(()=>new Map),at=k(()=>new Map),vt=k(()=>new Set),Tt=pe(d),{label:Ct,children:pt,value:wt,onValueChange:$t,filter:Lt,shouldFilter:jt,loop:Ft,disablePointerSelection:Gt=!1,vimBindings:Ht=!0,...qt}=d,Kt=reactExports.useId(),rr=reactExports.useId(),ir=reactExports.useId(),or=reactExports.useRef(null),jr=Me$1();T$1(()=>{if(wt!==void 0){let Tn=wt.trim();b.current.value=Tn,qr.emit()}},[wt]),T$1(()=>{jr(6,t0)},[]);let qr=reactExports.useMemo(()=>({subscribe:Tn=>(vt.current.add(Tn),()=>vt.current.delete(Tn)),snapshot:()=>b.current,setState:(Tn,n0,Go)=>{var An,a0,u0;if(!Object.is(b.current[Tn],n0)){if(b.current[Tn]=n0,Tn==="search")zo(),ko(),jr(1,Xo);else if(Tn==="value"&&(Go||jr(5,t0),((An=Tt.current)==null?void 0:An.value)!==void 0)){let d0=n0??"";(u0=(a0=Tt.current).onValueChange)==null||u0.call(a0,d0);return}qr.emit()}},emit:()=>{vt.current.forEach(Tn=>Tn())}}),[]),Yr=reactExports.useMemo(()=>({value:(Tn,n0,Go)=>{var An;n0!==((An=at.current.get(Tn))==null?void 0:An.value)&&(at.current.set(Tn,{value:n0,keywords:Go}),b.current.filtered.items.set(Tn,vn(n0,Go)),jr(2,()=>{ko(),qr.emit()}))},item:(Tn,n0)=>(et.current.add(Tn),n0&&(st.current.has(n0)?st.current.get(n0).add(Tn):st.current.set(n0,new Set([Tn]))),jr(3,()=>{zo(),ko(),b.current.value||Xo(),qr.emit()}),()=>{at.current.delete(Tn),et.current.delete(Tn),b.current.filtered.items.delete(Tn);let Go=Uo();jr(4,()=>{zo(),(Go==null?void 0:Go.getAttribute("id"))===Tn&&Xo(),qr.emit()})}),group:Tn=>(st.current.has(Tn)||st.current.set(Tn,new Set),()=>{at.current.delete(Tn),st.current.delete(Tn)}),filter:()=>Tt.current.shouldFilter,label:Ct||d["aria-label"],disablePointerSelection:Gt,listId:Kt,inputId:ir,labelId:rr,listInnerRef:or}),[]);function vn(Tn,n0){var Go,An;let a0=(An=(Go=Tt.current)==null?void 0:Go.filter)!=null?An:Re;return Tn?a0(Tn,b.current.search,n0):0}function ko(){if(!b.current.search||Tt.current.shouldFilter===!1)return;let Tn=b.current.filtered.items,n0=[];b.current.filtered.groups.forEach(An=>{let a0=st.current.get(An),u0=0;a0.forEach(d0=>{let f0=Tn.get(d0);u0=Math.max(f0,u0)}),n0.push([An,u0])});let Go=or.current;No().sort((An,a0)=>{var u0,d0;let f0=An.getAttribute("id"),y0=a0.getAttribute("id");return((u0=Tn.get(y0))!=null?u0:0)-((d0=Tn.get(f0))!=null?d0:0)}).forEach(An=>{let a0=An.closest(X$1);a0?a0.appendChild(An.parentElement===a0?An:An.closest(`${X$1} > *`)):Go.appendChild(An.parentElement===Go?An:An.closest(`${X$1} > *`))}),n0.sort((An,a0)=>a0[1]-An[1]).forEach(An=>{let a0=or.current.querySelector(`${V$1}[${M$2}="${encodeURIComponent(An[0])}"]`);a0==null||a0.parentElement.appendChild(a0)})}function Xo(){let Tn=No().find(Go=>Go.getAttribute("aria-disabled")!=="true"),n0=Tn==null?void 0:Tn.getAttribute(M$2);qr.setState("value",n0||void 0)}function zo(){var Tn,n0,Go,An;if(!b.current.search||Tt.current.shouldFilter===!1){b.current.filtered.count=et.current.size;return}b.current.filtered.groups=new Set;let a0=0;for(let u0 of et.current){let d0=(n0=(Tn=at.current.get(u0))==null?void 0:Tn.value)!=null?n0:"",f0=(An=(Go=at.current.get(u0))==null?void 0:Go.keywords)!=null?An:[],y0=vn(d0,f0);b.current.filtered.items.set(u0,y0),y0>0&&a0++}for(let[u0,d0]of st.current)for(let f0 of d0)if(b.current.filtered.items.get(f0)>0){b.current.filtered.groups.add(u0);break}b.current.filtered.count=a0}function t0(){var Tn,n0,Go;let An=Uo();An&&(((Tn=An.parentElement)==null?void 0:Tn.firstChild)===An&&((Go=(n0=An.closest(V$1))==null?void 0:n0.querySelector(ge))==null||Go.scrollIntoView({block:"nearest"})),An.scrollIntoView({block:"nearest"}))}function Uo(){var Tn;return(Tn=or.current)==null?void 0:Tn.querySelector(`${Y}[aria-selected="true"]`)}function No(){var Tn;return Array.from((Tn=or.current)==null?void 0:Tn.querySelectorAll(le$1))}function _n(Tn){let n0=No()[Tn];n0&&qr.setState("value",n0.getAttribute(M$2))}function Kr(Tn){var n0;let Go=Uo(),An=No(),a0=An.findIndex(d0=>d0===Go),u0=An[a0+Tn];(n0=Tt.current)!=null&&n0.loop&&(u0=a0+Tn<0?An[An.length-1]:a0+Tn===An.length?An[0]:An[a0+Tn]),u0&&qr.setState("value",u0.getAttribute(M$2))}function e0(Tn){let n0=Uo(),Go=n0==null?void 0:n0.closest(V$1),An;for(;Go&&!An;)Go=Tn>0?we$2(Go,V$1):Ie(Go,V$1),An=Go==null?void 0:Go.querySelector(le$1);An?qr.setState("value",An.getAttribute(M$2)):Kr(Tn)}let Zr=()=>_n(No().length-1),Ro=Tn=>{Tn.preventDefault(),Tn.metaKey?Zr():Tn.altKey?e0(1):Kr(1)},Sn=Tn=>{Tn.preventDefault(),Tn.metaKey?_n(0):Tn.altKey?e0(-1):Kr(-1)};return reactExports.createElement($8927f6f2acc4f386$export$250ffa63cdc0d034.div,{ref:g,tabIndex:-1,...qt,"cmdk-root":"",onKeyDown:Tn=>{var n0;if((n0=qt.onKeyDown)==null||n0.call(qt,Tn),!Tn.defaultPrevented)switch(Tn.key){case"n":case"j":{Ht&&Tn.ctrlKey&&Ro(Tn);break}case"ArrowDown":{Ro(Tn);break}case"p":case"k":{Ht&&Tn.ctrlKey&&Sn(Tn);break}case"ArrowUp":{Sn(Tn);break}case"Home":{Tn.preventDefault(),_n(0);break}case"End":{Tn.preventDefault(),Zr();break}case"Enter":if(!Tn.nativeEvent.isComposing&&Tn.keyCode!==229){Tn.preventDefault();let Go=Uo();if(Go){let An=new Event(Q$2);Go.dispatchEvent(An)}}}}},reactExports.createElement("label",{"cmdk-label":"",htmlFor:Yr.inputId,id:Yr.labelId,style:De$2},Ct),F(d,Tn=>reactExports.createElement(de.Provider,{value:qr},reactExports.createElement(ue.Provider,{value:Yr},Tn))))}),be$1=reactExports.forwardRef((d,g)=>{var b,et;let st=reactExports.useId(),at=reactExports.useRef(null),vt=reactExports.useContext(fe$2),Tt=G(),Ct=pe(d),pt=(et=(b=Ct.current)==null?void 0:b.forceMount)!=null?et:vt==null?void 0:vt.forceMount;T$1(()=>{if(!pt)return Tt.item(st,vt==null?void 0:vt.id)},[pt]);let wt=ve$1(st,at,[d.value,d.children,at],d.keywords),$t=Z$1(),Lt=D(jr=>jr.value&&jr.value===wt.current),jt=D(jr=>pt||Tt.filter()===!1?!0:jr.search?jr.filtered.items.get(st)>0:!0);reactExports.useEffect(()=>{let jr=at.current;if(!(!jr||d.disabled))return jr.addEventListener(Q$2,Ft),()=>jr.removeEventListener(Q$2,Ft)},[jt,d.onSelect,d.disabled]);function Ft(){var jr,qr;Gt(),(qr=(jr=Ct.current).onSelect)==null||qr.call(jr,wt.current)}function Gt(){$t.setState("value",wt.current,!0)}if(!jt)return null;let{disabled:Ht,value:qt,onSelect:Kt,forceMount:rr,keywords:ir,...or}=d;return reactExports.createElement($8927f6f2acc4f386$export$250ffa63cdc0d034.div,{ref:N$1([at,g]),...or,id:st,"cmdk-item":"",role:"option","aria-disabled":!!Ht,"aria-selected":!!Lt,"data-disabled":!!Ht,"data-selected":!!Lt,onPointerMove:Ht||Tt.disablePointerSelection?void 0:Gt,onClick:Ht?void 0:Ft},d.children)}),he=reactExports.forwardRef((d,g)=>{let{heading:b,children:et,forceMount:st,...at}=d,vt=reactExports.useId(),Tt=reactExports.useRef(null),Ct=reactExports.useRef(null),pt=reactExports.useId(),wt=G(),$t=D(jt=>st||wt.filter()===!1?!0:jt.search?jt.filtered.groups.has(vt):!0);T$1(()=>wt.group(vt),[]),ve$1(vt,Tt,[d.value,d.heading,Ct]);let Lt=reactExports.useMemo(()=>({id:vt,forceMount:st}),[st]);return reactExports.createElement($8927f6f2acc4f386$export$250ffa63cdc0d034.div,{ref:N$1([Tt,g]),...at,"cmdk-group":"",role:"presentation",hidden:$t?void 0:!0},b&&reactExports.createElement("div",{ref:Ct,"cmdk-group-heading":"","aria-hidden":!0,id:pt},b),F(d,jt=>reactExports.createElement("div",{"cmdk-group-items":"",role:"group","aria-labelledby":b?pt:void 0},reactExports.createElement(fe$2.Provider,{value:Lt},jt))))}),ye$2=reactExports.forwardRef((d,g)=>{let{alwaysRender:b,...et}=d,st=reactExports.useRef(null),at=D(vt=>!vt.search);return!b&&!at?null:reactExports.createElement($8927f6f2acc4f386$export$250ffa63cdc0d034.div,{ref:N$1([st,g]),...et,"cmdk-separator":"",role:"separator"})}),Ee$1=reactExports.forwardRef((d,g)=>{let{onValueChange:b,...et}=d,st=d.value!=null,at=Z$1(),vt=D(wt=>wt.search),Tt=D(wt=>wt.value),Ct=G(),pt=reactExports.useMemo(()=>{var wt;let $t=(wt=Ct.listInnerRef.current)==null?void 0:wt.querySelector(`${Y}[${M$2}="${encodeURIComponent(Tt)}"]`);return $t==null?void 0:$t.getAttribute("id")},[]);return reactExports.useEffect(()=>{d.value!=null&&at.setState("search",d.value)},[d.value]),reactExports.createElement($8927f6f2acc4f386$export$250ffa63cdc0d034.input,{ref:g,...et,"cmdk-input":"",autoComplete:"off",autoCorrect:"off",spellCheck:!1,"aria-autocomplete":"list",role:"combobox","aria-expanded":!0,"aria-controls":Ct.listId,"aria-labelledby":Ct.labelId,"aria-activedescendant":pt,id:Ct.inputId,type:"text",value:st?d.value:vt,onChange:wt=>{st||at.setState("search",wt.target.value),b==null||b(wt.target.value)}})}),Se=reactExports.forwardRef((d,g)=>{let{children:b,label:et="Suggestions",...st}=d,at=reactExports.useRef(null),vt=reactExports.useRef(null),Tt=G();return reactExports.useEffect(()=>{if(vt.current&&at.current){let Ct=vt.current,pt=at.current,wt,$t=new ResizeObserver(()=>{wt=requestAnimationFrame(()=>{let Lt=Ct.offsetHeight;pt.style.setProperty("--cmdk-list-height",Lt.toFixed(1)+"px")})});return $t.observe(Ct),()=>{cancelAnimationFrame(wt),$t.unobserve(Ct)}}},[]),reactExports.createElement($8927f6f2acc4f386$export$250ffa63cdc0d034.div,{ref:N$1([at,g]),...st,"cmdk-list":"",role:"listbox","aria-label":et,id:Tt.listId},F(d,Ct=>reactExports.createElement("div",{ref:N$1([vt,Tt.listInnerRef]),"cmdk-list-sizer":""},Ct)))}),Ce=reactExports.forwardRef((d,g)=>{let{open:b,onOpenChange:et,overlayClassName:st,contentClassName:at,container:vt,...Tt}=d;return reactExports.createElement($5d3850c4d0b4e6c7$export$be92b6f5f03c0fe9,{open:b,onOpenChange:et},reactExports.createElement($5d3850c4d0b4e6c7$export$602eac185826482c,{container:vt},reactExports.createElement($5d3850c4d0b4e6c7$export$c6fdb837b070b4ff,{"cmdk-overlay":"",className:st}),reactExports.createElement($5d3850c4d0b4e6c7$export$7c6e2c02157bb7d2,{"aria-label":d.label,"cmdk-dialog":"",className:at},reactExports.createElement(me$1,{ref:g,...Tt}))))}),xe$1=reactExports.forwardRef((d,g)=>D(b=>b.filtered.count===0)?reactExports.createElement($8927f6f2acc4f386$export$250ffa63cdc0d034.div,{ref:g,...d,"cmdk-empty":"",role:"presentation"}):null),Pe$1=reactExports.forwardRef((d,g)=>{let{progress:b,children:et,label:st="Loading...",...at}=d;return reactExports.createElement($8927f6f2acc4f386$export$250ffa63cdc0d034.div,{ref:g,...at,"cmdk-loading":"",role:"progressbar","aria-valuenow":b,"aria-valuemin":0,"aria-valuemax":100,"aria-label":st},F(d,vt=>reactExports.createElement("div",{"aria-hidden":!0},vt)))}),He=Object.assign(me$1,{List:Se,Item:be$1,Input:Ee$1,Group:he,Separator:ye$2,Dialog:Ce,Empty:xe$1,Loading:Pe$1});function we$2(d,g){let b=d.nextElementSibling;for(;b;){if(b.matches(g))return b;b=b.nextElementSibling}}function Ie(d,g){let b=d.previousElementSibling;for(;b;){if(b.matches(g))return b;b=b.previousElementSibling}}function pe(d){let g=reactExports.useRef(d);return T$1(()=>{g.current=d}),g}var T$1=typeof window>"u"?reactExports.useEffect:reactExports.useLayoutEffect;function k(d){let g=reactExports.useRef();return g.current===void 0&&(g.current=d()),g}function N$1(d){return g=>{d.forEach(b=>{typeof b=="function"?b(g):b!=null&&(b.current=g)})}}function D(d){let g=Z$1(),b=()=>d(g.snapshot());return reactExports.useSyncExternalStore(g.subscribe,b,b)}function ve$1(d,g,b,et=[]){let st=reactExports.useRef(),at=G();return T$1(()=>{var vt;let Tt=(()=>{var pt;for(let wt of b){if(typeof wt=="string")return wt.trim();if(typeof wt=="object"&&"current"in wt)return wt.current?(pt=wt.current.textContent)==null?void 0:pt.trim():st.current}})(),Ct=et.map(pt=>pt.trim());at.value(d,Tt,Ct),(vt=g.current)==null||vt.setAttribute(M$2,Tt),st.current=Tt}),st}var Me$1=()=>{let[d,g]=reactExports.useState(),b=k(()=>new Map);return T$1(()=>{b.current.forEach(et=>et()),b.current=new Map},[d]),(et,st)=>{b.current.set(et,st),g({})}};function Te(d){let g=d.type;return typeof g=="function"?g(d.props):"render"in g?g.render(d.props):d}function F({asChild:d,children:g},b){return d&&reactExports.isValidElement(g)?reactExports.cloneElement(Te(g),{ref:g.ref},b(g.props.children)):b(g)}var De$2={position:"absolute",width:"1px",height:"1px",padding:"0",margin:"-1px",overflow:"hidden",clip:"rect(0, 0, 0, 0)",whiteSpace:"nowrap",borderWidth:"0"};const Command=reactExports.forwardRef(({className:d,...g},b)=>jsxRuntimeExports.jsx(He,{ref:b,className:cn$1("flex h-full w-full flex-col overflow-hidden rounded-md bg-popover text-popover-foreground",d),...g}));Command.displayName=He.displayName;const CommandInput=reactExports.forwardRef(({className:d,...g},b)=>jsxRuntimeExports.jsxs("div",{className:"flex items-center border-b px-3","cmdk-input-wrapper":"",children:[jsxRuntimeExports.jsx(Search,{className:"mr-2 h-4 w-4 shrink-0 opacity-50"}),jsxRuntimeExports.jsx(He.Input,{ref:b,className:cn$1("flex h-11 w-full rounded-md bg-transparent py-3 text-sm outline-none placeholder:text-muted-foreground disabled:cursor-not-allowed disabled:opacity-50",d),...g})]}));CommandInput.displayName=He.Input.displayName;const CommandList=reactExports.forwardRef(({className:d,...g},b)=>jsxRuntimeExports.jsx(He.List,{ref:b,className:cn$1("max-h-[300px] overflow-y-auto overflow-x-hidden",d),...g}));CommandList.displayName=He.List.displayName;const CommandEmpty=reactExports.forwardRef((d,g)=>jsxRuntimeExports.jsx(He.Empty,{ref:g,className:"py-6 text-center text-sm",...d}));CommandEmpty.displayName=He.Empty.displayName;const CommandGroup=reactExports.forwardRef(({className:d,...g},b)=>jsxRuntimeExports.jsx(He.Group,{ref:b,className:cn$1("overflow-hidden p-1 text-foreground [&_[cmdk-group-heading]]:px-2 [&_[cmdk-group-heading]]:py-1.5 [&_[cmdk-group-heading]]:text-xs [&_[cmdk-group-heading]]:font-medium [&_[cmdk-group-heading]]:text-muted-foreground",d),...g}));CommandGroup.displayName=He.Group.displayName;const CommandSeparator=reactExports.forwardRef(({className:d,...g},b)=>jsxRuntimeExports.jsx(He.Separator,{ref:b,className:cn$1("-mx-1 h-px bg-border",d),...g}));CommandSeparator.displayName=He.Separator.displayName;const CommandItem=reactExports.forwardRef(({className:d,...g},b)=>jsxRuntimeExports.jsx(He.Item,{ref:b,className:cn$1("relative flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none aria-selected:bg-accent aria-selected:text-accent-foreground data-[disabled=true]:pointer-events-none data-[disabled=true]:opacity-50",d),...g}));CommandItem.displayName=He.Item.displayName;const $cb5cc270b50c6fcd$var$POPOVER_NAME="Popover",[$cb5cc270b50c6fcd$var$createPopoverContext,$cb5cc270b50c6fcd$export$c8393c9e73286932]=$c512c27ab02ef895$export$50c7b4e9d9f19c1($cb5cc270b50c6fcd$var$POPOVER_NAME,[$cf1ac5d9fe0e8206$export$722aac194ae923]),$cb5cc270b50c6fcd$var$usePopperScope=$cf1ac5d9fe0e8206$export$722aac194ae923(),[$cb5cc270b50c6fcd$var$PopoverProvider,$cb5cc270b50c6fcd$var$usePopoverContext]=$cb5cc270b50c6fcd$var$createPopoverContext($cb5cc270b50c6fcd$var$POPOVER_NAME),$cb5cc270b50c6fcd$export$5b6b19405a83ff9d=d=>{const{__scopePopover:g,children:b,open:et,defaultOpen:st,onOpenChange:at,modal:vt=!1}=d,Tt=$cb5cc270b50c6fcd$var$usePopperScope(g),Ct=reactExports.useRef(null),[pt,wt]=reactExports.useState(!1),[$t=!1,Lt]=$71cd76cc60e0454e$export$6f32135080cb4c3({prop:et,defaultProp:st,onChange:at});return reactExports.createElement($cf1ac5d9fe0e8206$export$be92b6f5f03c0fe9,Tt,reactExports.createElement($cb5cc270b50c6fcd$var$PopoverProvider,{scope:g,contentId:$1746a345f3d73bb7$export$f680877a34711e37(),triggerRef:Ct,open:$t,onOpenChange:Lt,onOpenToggle:reactExports.useCallback(()=>Lt(jt=>!jt),[Lt]),hasCustomAnchor:pt,onCustomAnchorAdd:reactExports.useCallback(()=>wt(!0),[]),onCustomAnchorRemove:reactExports.useCallback(()=>wt(!1),[]),modal:vt},b))},$cb5cc270b50c6fcd$var$TRIGGER_NAME="PopoverTrigger",$cb5cc270b50c6fcd$export$7dacb05d26466c3=reactExports.forwardRef((d,g)=>{const{__scopePopover:b,...et}=d,st=$cb5cc270b50c6fcd$var$usePopoverContext($cb5cc270b50c6fcd$var$TRIGGER_NAME,b),at=$cb5cc270b50c6fcd$var$usePopperScope(b),vt=$6ed0406888f73fc4$export$c7b2cbe3552a0d05(g,st.triggerRef),Tt=reactExports.createElement($8927f6f2acc4f386$export$250ffa63cdc0d034.button,_extends$1({type:"button","aria-haspopup":"dialog","aria-expanded":st.open,"aria-controls":st.contentId,"data-state":$cb5cc270b50c6fcd$var$getState(st.open)},et,{ref:vt,onClick:$e42e1063c40fb3ef$export$b9ecd428b558ff10(d.onClick,st.onOpenToggle)}));return st.hasCustomAnchor?Tt:reactExports.createElement($cf1ac5d9fe0e8206$export$b688253958b8dfe7,_extends$1({asChild:!0},at),Tt)}),$cb5cc270b50c6fcd$var$PORTAL_NAME="PopoverPortal",[$cb5cc270b50c6fcd$var$PortalProvider,$cb5cc270b50c6fcd$var$usePortalContext]=$cb5cc270b50c6fcd$var$createPopoverContext($cb5cc270b50c6fcd$var$PORTAL_NAME,{forceMount:void 0}),$cb5cc270b50c6fcd$export$dd679ffb4362d2d4=d=>{const{__scopePopover:g,forceMount:b,children:et,container:st}=d,at=$cb5cc270b50c6fcd$var$usePopoverContext($cb5cc270b50c6fcd$var$PORTAL_NAME,g);return reactExports.createElement($cb5cc270b50c6fcd$var$PortalProvider,{scope:g,forceMount:b},reactExports.createElement($921a889cee6df7e8$export$99c2b779aa4e8b8b,{present:b||at.open},reactExports.createElement($f1701beae083dbae$export$602eac185826482c,{asChild:!0,container:st},et)))},$cb5cc270b50c6fcd$var$CONTENT_NAME="PopoverContent",$cb5cc270b50c6fcd$export$d7e1f420b25549ff=reactExports.forwardRef((d,g)=>{const b=$cb5cc270b50c6fcd$var$usePortalContext($cb5cc270b50c6fcd$var$CONTENT_NAME,d.__scopePopover),{forceMount:et=b.forceMount,...st}=d,at=$cb5cc270b50c6fcd$var$usePopoverContext($cb5cc270b50c6fcd$var$CONTENT_NAME,d.__scopePopover);return reactExports.createElement($921a889cee6df7e8$export$99c2b779aa4e8b8b,{present:et||at.open},at.modal?reactExports.createElement($cb5cc270b50c6fcd$var$PopoverContentModal,_extends$1({},st,{ref:g})):reactExports.createElement($cb5cc270b50c6fcd$var$PopoverContentNonModal,_extends$1({},st,{ref:g})))}),$cb5cc270b50c6fcd$var$PopoverContentModal=reactExports.forwardRef((d,g)=>{const b=$cb5cc270b50c6fcd$var$usePopoverContext($cb5cc270b50c6fcd$var$CONTENT_NAME,d.__scopePopover),et=reactExports.useRef(null),st=$6ed0406888f73fc4$export$c7b2cbe3552a0d05(g,et),at=reactExports.useRef(!1);return reactExports.useEffect(()=>{const vt=et.current;if(vt)return hideOthers(vt)},[]),reactExports.createElement(ReactRemoveScroll,{as:$5e63c961fc1ce211$export$8c6ed5c666ac1360,allowPinchZoom:!0},reactExports.createElement($cb5cc270b50c6fcd$var$PopoverContentImpl,_extends$1({},d,{ref:st,trapFocus:b.open,disableOutsidePointerEvents:!0,onCloseAutoFocus:$e42e1063c40fb3ef$export$b9ecd428b558ff10(d.onCloseAutoFocus,vt=>{var Tt;vt.preventDefault(),at.current||(Tt=b.triggerRef.current)===null||Tt===void 0||Tt.focus()}),onPointerDownOutside:$e42e1063c40fb3ef$export$b9ecd428b558ff10(d.onPointerDownOutside,vt=>{const Tt=vt.detail.originalEvent,Ct=Tt.button===0&&Tt.ctrlKey===!0,pt=Tt.button===2||Ct;at.current=pt},{checkForDefaultPrevented:!1}),onFocusOutside:$e42e1063c40fb3ef$export$b9ecd428b558ff10(d.onFocusOutside,vt=>vt.preventDefault(),{checkForDefaultPrevented:!1})})))}),$cb5cc270b50c6fcd$var$PopoverContentNonModal=reactExports.forwardRef((d,g)=>{const b=$cb5cc270b50c6fcd$var$usePopoverContext($cb5cc270b50c6fcd$var$CONTENT_NAME,d.__scopePopover),et=reactExports.useRef(!1),st=reactExports.useRef(!1);return reactExports.createElement($cb5cc270b50c6fcd$var$PopoverContentImpl,_extends$1({},d,{ref:g,trapFocus:!1,disableOutsidePointerEvents:!1,onCloseAutoFocus:at=>{var vt;if((vt=d.onCloseAutoFocus)===null||vt===void 0||vt.call(d,at),!at.defaultPrevented){var Tt;et.current||(Tt=b.triggerRef.current)===null||Tt===void 0||Tt.focus(),at.preventDefault()}et.current=!1,st.current=!1},onInteractOutside:at=>{var vt,Tt;(vt=d.onInteractOutside)===null||vt===void 0||vt.call(d,at),at.defaultPrevented||(et.current=!0,at.detail.originalEvent.type==="pointerdown"&&(st.current=!0));const Ct=at.target;((Tt=b.triggerRef.current)===null||Tt===void 0?void 0:Tt.contains(Ct))&&at.preventDefault(),at.detail.originalEvent.type==="focusin"&&st.current&&at.preventDefault()}}))}),$cb5cc270b50c6fcd$var$PopoverContentImpl=reactExports.forwardRef((d,g)=>{const{__scopePopover:b,trapFocus:et,onOpenAutoFocus:st,onCloseAutoFocus:at,disableOutsidePointerEvents:vt,onEscapeKeyDown:Tt,onPointerDownOutside:Ct,onFocusOutside:pt,onInteractOutside:wt,...$t}=d,Lt=$cb5cc270b50c6fcd$var$usePopoverContext($cb5cc270b50c6fcd$var$CONTENT_NAME,b),jt=$cb5cc270b50c6fcd$var$usePopperScope(b);return $3db38b7d1fb3fe6a$export$b7ece24a22aeda8c(),reactExports.createElement($d3863c46a17e8a28$export$20e40289641fbbb6,{asChild:!0,loop:!0,trapped:et,onMountAutoFocus:st,onUnmountAutoFocus:at},reactExports.createElement($5cb92bef7577960e$export$177fb62ff3ec1f22,{asChild:!0,disableOutsidePointerEvents:vt,onInteractOutside:wt,onEscapeKeyDown:Tt,onPointerDownOutside:Ct,onFocusOutside:pt,onDismiss:()=>Lt.onOpenChange(!1)},reactExports.createElement($cf1ac5d9fe0e8206$export$7c6e2c02157bb7d2,_extends$1({"data-state":$cb5cc270b50c6fcd$var$getState(Lt.open),role:"dialog",id:Lt.contentId},jt,$t,{ref:g,style:{...$t.style,"--radix-popover-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-popover-content-available-width":"var(--radix-popper-available-width)","--radix-popover-content-available-height":"var(--radix-popper-available-height)","--radix-popover-trigger-width":"var(--radix-popper-anchor-width)","--radix-popover-trigger-height":"var(--radix-popper-anchor-height)"}}))))});function $cb5cc270b50c6fcd$var$getState(d){return d?"open":"closed"}const $cb5cc270b50c6fcd$export$be92b6f5f03c0fe9=$cb5cc270b50c6fcd$export$5b6b19405a83ff9d,$cb5cc270b50c6fcd$export$41fb9f06171c75f4=$cb5cc270b50c6fcd$export$7dacb05d26466c3,$cb5cc270b50c6fcd$export$602eac185826482c=$cb5cc270b50c6fcd$export$dd679ffb4362d2d4,$cb5cc270b50c6fcd$export$7c6e2c02157bb7d2=$cb5cc270b50c6fcd$export$d7e1f420b25549ff,Popover=$cb5cc270b50c6fcd$export$be92b6f5f03c0fe9,PopoverTrigger=$cb5cc270b50c6fcd$export$41fb9f06171c75f4,PopoverContent=reactExports.forwardRef(({className:d,align:g="center",sideOffset:b=4,...et},st)=>jsxRuntimeExports.jsx($cb5cc270b50c6fcd$export$602eac185826482c,{children:jsxRuntimeExports.jsx($cb5cc270b50c6fcd$export$7c6e2c02157bb7d2,{ref:st,align:g,sideOffset:b,className:cn$1("z-50 w-72 rounded-md border bg-popover p-4 text-popover-foreground shadow-md outline-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",d),...et})}));PopoverContent.displayName=$cb5cc270b50c6fcd$export$7c6e2c02157bb7d2.displayName;const languages=[{label:"English",value:"en"},{label:"Espaol",value:"es"}];function LanguageSwitcher(){var vt;const[d,g]=useLanguageStore(Tt=>[Tt.language,Tt.setLanguage]),{i18n:{changeLanguage:b}}=useTranslation(),[et,st]=React.useState(!1),at=Tt=>{g(Tt),b(Tt),st(!1)};return jsxRuntimeExports.jsx("div",{children:jsxRuntimeExports.jsxs(Popover,{open:et,onOpenChange:st,children:[jsxRuntimeExports.jsx(PopoverTrigger,{asChild:!0,children:jsxRuntimeExports.jsxs(Button,{variant:"outline",role:"combobox",className:"w-[150px] justify-between",children:[d?(vt=languages.find(Tt=>Tt.value===d))==null?void 0:vt.label:"Select language",jsxRuntimeExports.jsx(ChevronsUpDown,{className:"ml-2 h-4 w-4 shrink-0 opacity-50"})]})}),jsxRuntimeExports.jsx(PopoverContent,{className:"w-[150px] p-2",children:jsxRuntimeExports.jsx(Command,{children:jsxRuntimeExports.jsx(CommandList,{children:jsxRuntimeExports.jsx(CommandGroup,{heading:"Suggestions",children:languages.map(Tt=>jsxRuntimeExports.jsxs(CommandItem,{onSelect:()=>at(Tt.value),children:[jsxRuntimeExports.jsx(Check,{className:`mr-2 h-4 w-4 ${Tt.value===d?"opacity-100":"opacity-0"}`}),Tt.label]},Tt.value))})})})})]})})}function useFirstMountState(){var d=reactExports.useRef(!0);return d.current?(d.current=!1,!0):d.current}var useUpdateEffect=function(d,g){var b=useFirstMountState();reactExports.useEffect(function(){if(!b)return d()},g)},noop$1=function(){};function on$1(d){for(var g=[],b=1;b<arguments.length;b++)g[b-1]=arguments[b];d&&d.addEventListener&&d.addEventListener.apply(d,g)}function off(d){for(var g=[],b=1;b<arguments.length;b++)g[b-1]=arguments[b];d&&d.removeEventListener&&d.removeEventListener.apply(d,g)}var isBrowser=typeof window<"u",toggleReducer=function(d,g){return typeof g=="boolean"?g:!d},useToggle=function(d){return reactExports.useReducer(toggleReducer,d)},defaultEvents=["mousedown","touchstart"],useClickAway=function(d,g,b){b===void 0&&(b=defaultEvents);var et=reactExports.useRef(g);reactExports.useEffect(function(){et.current=g},[g]),reactExports.useEffect(function(){for(var st=function(Ct){var pt=d.current;pt&&!pt.contains(Ct.target)&&et.current(Ct)},at=0,vt=b;at<vt.length;at++){var Tt=vt[at];on$1(document,Tt,st)}return function(){for(var Ct=0,pt=b;Ct<pt.length;Ct++){var wt=pt[Ct];off(document,wt,st)}}},[b,d])},useEffectOnce=function(d){reactExports.useEffect(d,[])},defaultTarget=isBrowser?window:null,isListenerType1=function(d){return!!d.addEventListener},isListenerType2=function(d){return!!d.on},useEvent=function(d,g,b,et){b===void 0&&(b=defaultTarget),reactExports.useEffect(function(){if(g&&b)return isListenerType1(b)?on$1(b,d,g,et):isListenerType2(b)&&b.on(d,g,et),function(){isListenerType1(b)?off(b,d,g,et):isListenerType2(b)&&b.off(d,g,et)}},[d,g,b,JSON.stringify(et)])},createKeyPredicate=function(d){return typeof d=="function"?d:typeof d=="string"?function(g){return g.key===d}:d?function(){return!0}:function(){return!1}},useKey=function(d,g,b,et){g===void 0&&(g=noop$1),b===void 0&&(b={}),et===void 0&&(et=[d]);var st=b.event,at=st===void 0?"keydown":st,vt=b.target,Tt=b.options,Ct=reactExports.useMemo(function(){var pt=createKeyPredicate(d),wt=function($t){if(pt($t))return g($t)};return wt},et);useEvent(at,Ct,vt,Tt)},useKeyPress=function(d){var g=reactExports.useState([!1,null]),b=g[0],et=g[1];return useKey(d,function(st){return et([!0,st])},{event:"keydown"},[b]),useKey(d,function(st){return et([!1,st])},{event:"keyup"},[b]),b},useKeyPressEvent=function(d,g,b,et){et===void 0&&(et=useKeyPress);var st=et(d),at=st[0],vt=st[1];useUpdateEffect(function(){!at&&b?b(vt):at&&g&&g(vt)},[at])},useUnmount=function(d){var g=reactExports.useRef(d);g.current=d,useEffectOnce(function(){return function(){return g.current()}})},useRafState=function(d){var g=reactExports.useRef(0),b=reactExports.useState(d),et=b[0],st=b[1],at=reactExports.useCallback(function(vt){cancelAnimationFrame(g.current),g.current=requestAnimationFrame(function(){st(vt)})},[]);return useUnmount(function(){cancelAnimationFrame(g.current)}),[et,at]},useWindowSize=function(d,g){d===void 0&&(d=1/0),g===void 0&&(g=1/0);var b=useRafState({width:isBrowser?window.innerWidth:d,height:isBrowser?window.innerHeight:g}),et=b[0],st=b[1];return reactExports.useEffect(function(){if(isBrowser){var at=function(){st({width:window.innerWidth,height:window.innerHeight})};return on$1(window,"resize",at),function(){off(window,"resize",at)}}},[]),et};const Textarea=reactExports.forwardRef(({className:d,...g},b)=>{const et=useStore(vt=>vt.updateAppState),st=()=>{et({disableShortCuts:!0})},at=()=>{et({disableShortCuts:!1})};return jsxRuntimeExports.jsx("textarea",{className:cn$1("flex min-h-[60px] w-full rounded-md border border-input bg-transparent px-3 py-2 text-sm shadow-sm placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50","overflow-auto",d),tabIndex:-1,ref:b,onFocus:st,onBlur:at,...g})});Textarea.displayName="Textarea";const PromptInput=()=>{const[d,g,b,et,st,at]=useStore(Ft=>[Ft.getIsProcessing(),Ft.settings.prompt,Ft.updateSettings,Ft.runInpainting,Ft.showPrevMask,Ft.hidePrevMask]),[vt,Tt]=useToggle(!1),Ct=reactExports.useRef(null);useClickAway(Ct,()=>{Ct!=null&&Ct.current&&Ct.current.blur()});const pt=Ft=>{Ft.preventDefault(),Ft.stopPropagation();const Gt=Ft.target;b({prompt:Gt.value})},wt=()=>{},$t=Ft=>{Ft.key==="Enter"&&Ft.ctrlKey&&g.length},Lt=()=>{st()},jt=()=>{at()};return jsxRuntimeExports.jsx("div",{className:"flex gap-4 relative w-full justify-center h-full",children:jsxRuntimeExports.jsxs("div",{className:"absolute flex gap-4",children:[jsxRuntimeExports.jsx(Textarea,{ref:Ct,placeholder:"I want to repaint of...",className:cn$1(vt?"focus:overflow-y-auto":"overflow-y-hidden","min-h-[32px] h-[32px] overflow-x-hidden focus:h-[120px] overflow-y-hidden transition-[height] w-[500px] py-1 px-3 bg-background resize-none"),style:{scrollbarGutter:"stable"},value:g,onInput:pt,onKeyUp:$t,onTransitionEnd:Tt}),jsxRuntimeExports.jsx(Button,{size:"sm",onClick:wt,disabled:d,onMouseEnter:Lt,onMouseLeave:jt,children:"Paint"})]})})},Header=()=>{const[d,g,b,et,st,at,vt,Tt,Ct,pt,wt,$t,Lt,jt]=useStore(Ft=>[Ft.file,Ft.customMask,Ft.isInpainting,Ft.serverConfig,Ft.runMannually(),Ft.settings.enableUploadMask,Ft.settings.model,Ft.setFile,Ft.setCustomFile,Ft.runInpainting,Ft.showPrevMask,Ft.hidePrevMask,Ft.imageHeight,Ft.imageWidth]);return jsxRuntimeExports.jsxs("header",{className:"h-[60px] px-6 py-4 absolute top-[0] flex justify-between items-center w-full z-20 border-b backdrop-filter backdrop-blur-md bg-background/70",children:[jsxRuntimeExports.jsx("div",{className:"flex items-center gap-1",children:jsxRuntimeExports.jsx(ImageUploadButton,{disabled:b,tooltip:"Upload image",onFileUpload:Ft=>{Tt(Ft)},children:jsxRuntimeExports.jsx(Image$1,{})})}),jsxRuntimeExports.jsx(PromptInput,{}),jsxRuntimeExports.jsxs("div",{className:"flex gap-1",children:[jsxRuntimeExports.jsx(LanguageSwitcher,{}),jsxRuntimeExports.jsx(Shortcuts,{}),jsxRuntimeExports.jsx(SettingsDialog,{})]})]})};function CursorArrowRaysIcon({title:d,titleId:g,...b},et){return reactExports.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:et,"aria-labelledby":g},b),d?reactExports.createElement("title",{id:g},d):null,reactExports.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15.042 21.672 13.684 16.6m0 0-2.51 2.225.569-9.47 5.227 7.917-3.286-.672ZM12 2.25V4.5m5.834.166-1.591 1.591M20.25 10.5H18M7.757 14.743l-1.59 1.59M6 10.5H3.75m4.007-4.243-1.59-1.59"}))}const ForwardRef=reactExports.forwardRef(CursorArrowRaysIcon);var roundNumber=function(d,g){return Number(d.toFixed(g))},checkIsNumber=function(d,g){return g},handleCallback=function(d,g,b){b&&typeof b=="function"&&b(d,g)},easeOut=function(d){return-Math.cos(d*Math.PI)/2+.5},linear=function(d){return d},easeInQuad=function(d){return d*d},easeOutQuad=function(d){return d*(2-d)},easeInOutQuad=function(d){return d<.5?2*d*d:-1+(4-2*d)*d},easeInCubic=function(d){return d*d*d},easeOutCubic=function(d){return--d*d*d+1},easeInOutCubic=function(d){return d<.5?4*d*d*d:(d-1)*(2*d-2)*(2*d-2)+1},easeInQuart=function(d){return d*d*d*d},easeOutQuart=function(d){return 1- --d*d*d*d},easeInOutQuart=function(d){return d<.5?8*d*d*d*d:1-8*--d*d*d*d},easeInQuint=function(d){return d*d*d*d*d},easeOutQuint=function(d){return 1+--d*d*d*d*d},easeInOutQuint=function(d){return d<.5?16*d*d*d*d*d:1+16*--d*d*d*d*d},animations={easeOut,linear,easeInQuad,easeOutQuad,easeInOutQuad,easeInCubic,easeOutCubic,easeInOutCubic,easeInQuart,easeOutQuart,easeInOutQuart,easeInQuint,easeOutQuint,easeInOutQuint},handleCancelAnimationFrame=function(d){typeof d=="number"&&cancelAnimationFrame(d)},handleCancelAnimation=function(d){d.mounted&&(handleCancelAnimationFrame(d.animation),d.animate=!1,d.animation=null,d.velocity=null)};function handleSetupAnimation(d,g,b,et){if(d.mounted){var st=new Date().getTime(),at=1;handleCancelAnimation(d),d.animation=function(){if(!d.mounted)return handleCancelAnimationFrame(d.animation);var vt=new Date().getTime()-st,Tt=vt/b,Ct=animations[g],pt=Ct(Tt);vt>=b?(et(at),d.animation=null):d.animation&&(et(pt),requestAnimationFrame(d.animation))},requestAnimationFrame(d.animation)}}function isValidTargetState(d){var g=d.scale,b=d.positionX,et=d.positionY;return!(Number.isNaN(g)||Number.isNaN(b)||Number.isNaN(et))}function animate(d,g,b,et){var st=isValidTargetState(g);if(!(!d.mounted||!st)){var at=d.setTransformState,vt=d.transformState,Tt=vt.scale,Ct=vt.positionX,pt=vt.positionY,wt=g.scale-Tt,$t=g.positionX-Ct,Lt=g.positionY-pt;b===0?at(g.scale,g.positionX,g.positionY):handleSetupAnimation(d,et,b,function(jt){var Ft=Tt+wt*jt,Gt=Ct+$t*jt,Ht=pt+Lt*jt;at(Ft,Gt,Ht)})}}function getComponentsSizes(d,g,b){var et=d.offsetWidth,st=d.offsetHeight,at=g.offsetWidth,vt=g.offsetHeight,Tt=at*b,Ct=vt*b,pt=et-Tt,wt=st-Ct;return{wrapperWidth:et,wrapperHeight:st,newContentWidth:Tt,newDiffWidth:pt,newContentHeight:Ct,newDiffHeight:wt}}var getBounds=function(d,g,b,et,st,at,vt){var Tt=d>g?b*(vt?1:.5):0,Ct=et>st?at*(vt?1:.5):0,pt=d-g-Tt,wt=Tt,$t=et-st-Ct,Lt=Ct;return{minPositionX:pt,maxPositionX:wt,minPositionY:$t,maxPositionY:Lt}},calculateBounds=function(d,g){var b=d.wrapperComponent,et=d.contentComponent,st=d.setup.centerZoomedOut;if(!b||!et)throw new Error("Components are not mounted");var at=getComponentsSizes(b,et,g),vt=at.wrapperWidth,Tt=at.wrapperHeight,Ct=at.newContentWidth,pt=at.newDiffWidth,wt=at.newContentHeight,$t=at.newDiffHeight,Lt=getBounds(vt,Ct,pt,Tt,wt,$t,!!st);return Lt},boundLimiter=function(d,g,b,et){return et?d<g?roundNumber(g,2):d>b?roundNumber(b,2):roundNumber(d,2):roundNumber(d,2)},handleCalculateBounds=function(d,g){var b=calculateBounds(d,g);return d.bounds=b,b};function getMouseBoundedPosition(d,g,b,et,st,at,vt){var Tt=b.minPositionX,Ct=b.minPositionY,pt=b.maxPositionX,wt=b.maxPositionY,$t=0,Lt=0;vt&&($t=st,Lt=at);var jt=boundLimiter(d,Tt-$t,pt+$t,et),Ft=boundLimiter(g,Ct-Lt,wt+Lt,et);return{x:jt,y:Ft}}function handleCalculateZoomPositions(d,g,b,et,st,at){var vt=d.transformState,Tt=vt.scale,Ct=vt.positionX,pt=vt.positionY,wt=et-Tt;if(typeof g!="number"||typeof b!="number")return console.error("Mouse X and Y position were not provided!"),{x:Ct,y:pt};var $t=Ct-g*wt,Lt=pt-b*wt,jt=getMouseBoundedPosition($t,Lt,st,at,0,0,null);return jt}function checkZoomBounds(d,g,b,et,st){var at=st?et:0,vt=g-at;return!Number.isNaN(b)&&d>=b?b:!Number.isNaN(g)&&d<=vt?vt:d}var isPanningStartAllowed=function(d,g){var b=d.setup.panning.excluded,et=d.isInitialized,st=d.wrapperComponent,at=g.target,vt="shadowRoot"in at&&"composedPath"in g,Tt=vt?g.composedPath().some(function(wt){return wt instanceof Element?st==null?void 0:st.contains(wt):!1}):st==null?void 0:st.contains(at),Ct=et&&at&&Tt;if(!Ct)return!1;var pt=isExcludedNode(at,b);return!pt},isPanningAllowed=function(d){var g=d.isInitialized,b=d.isPanning,et=d.setup,st=et.panning.disabled,at=g&&b&&!st;return!!at},handlePanningSetup=function(d,g){var b=d.transformState,et=b.positionX,st=b.positionY;d.isPanning=!0;var at=g.clientX,vt=g.clientY;d.startCoords={x:at-et,y:vt-st}},handleTouchPanningSetup=function(d,g){var b=g.touches,et=d.transformState,st=et.positionX,at=et.positionY;d.isPanning=!0;var vt=b.length===1;if(vt){var Tt=b[0].clientX,Ct=b[0].clientY;d.startCoords={x:Tt-st,y:Ct-at}}};function handlePanToBounds(d){var g=d.transformState,b=g.positionX,et=g.positionY,st=g.scale,at=d.setup,vt=at.disabled,Tt=at.limitToBounds,Ct=at.centerZoomedOut,pt=d.wrapperComponent;if(!(vt||!pt||!d.bounds)){var wt=d.bounds,$t=wt.maxPositionX,Lt=wt.minPositionX,jt=wt.maxPositionY,Ft=wt.minPositionY,Gt=b>$t||b<Lt,Ht=et>jt||et<Ft,qt=b>$t?pt.offsetWidth:d.setup.minPositionX||0,Kt=et>jt?pt.offsetHeight:d.setup.minPositionY||0,rr=handleCalculateZoomPositions(d,qt,Kt,st,d.bounds,Tt||Ct),ir=rr.x,or=rr.y;return{scale:st,positionX:Gt?ir:b,positionY:Ht?or:et}}}function handleNewPosition(d,g,b,et,st){var at=d.setup.limitToBounds,vt=d.wrapperComponent,Tt=d.bounds,Ct=d.transformState,pt=Ct.scale,wt=Ct.positionX,$t=Ct.positionY;if(!(vt===null||Tt===null||g===wt&&b===$t)){var Lt=getMouseBoundedPosition(g,b,Tt,at,et,st,vt),jt=Lt.x,Ft=Lt.y;d.setTransformState(pt,jt,Ft)}}var getPanningClientPosition=function(d,g,b){var et=d.startCoords,st=d.transformState,at=d.setup.panning,vt=at.lockAxisX,Tt=at.lockAxisY,Ct=st.positionX,pt=st.positionY;if(!et)return{x:Ct,y:pt};var wt=g-et.x,$t=b-et.y,Lt=vt?Ct:wt,jt=Tt?pt:$t;return{x:Lt,y:jt}},getPaddingValue=function(d,g){var b=d.setup,et=d.transformState,st=et.scale,at=b.minScale,vt=b.disablePadding;return g>0&&st>=at&&!vt?g:0},isVelocityCalculationAllowed=function(d){var g=d.mounted,b=d.setup,et=b.disabled,st=b.velocityAnimation,at=d.transformState.scale,vt=st.disabled,Tt=!vt||at>1||!et||g;return!!Tt},isVelocityAllowed=function(d){var g=d.mounted,b=d.velocity,et=d.bounds,st=d.setup,at=st.disabled,vt=st.velocityAnimation,Tt=d.transformState.scale,Ct=vt.disabled,pt=!Ct||Tt>1||!at||g;return!(!pt||!b||!et)};function getVelocityMoveTime(d,g){var b=d.setup.velocityAnimation,et=b.equalToMove,st=b.animationTime,at=b.sensitivity;return et?st*g*at:st}function getVelocityPosition(d,g,b,et,st,at,vt,Tt,Ct,pt){if(st){if(g>vt&&b>vt){var wt=vt+(d-vt)*pt;return wt>Ct?Ct:wt<vt?vt:wt}if(g<at&&b<at){var wt=at+(d-at)*pt;return wt<Tt?Tt:wt>at?at:wt}}return et?g:boundLimiter(d,at,vt,st)}function getSizeMultiplier(d,g){var b=1;return g?Math.min(b,d.offsetWidth/window.innerWidth):b}function handleCalculateVelocity(d,g){var b=isVelocityCalculationAllowed(d);if(b){var et=d.lastMousePosition,st=d.velocityTime,at=d.setup,vt=d.wrapperComponent,Tt=at.velocityAnimation.equalToMove,Ct=Date.now();if(et&&st&&vt){var pt=getSizeMultiplier(vt,Tt),wt=g.x-et.x,$t=g.y-et.y,Lt=wt/pt,jt=$t/pt,Ft=Ct-st,Gt=wt*wt+$t*$t,Ht=Math.sqrt(Gt)/Ft;d.velocity={velocityX:Lt,velocityY:jt,total:Ht}}d.lastMousePosition=g,d.velocityTime=Ct}}function handleVelocityPanning(d){var g=d.velocity,b=d.bounds,et=d.setup,st=d.wrapperComponent,at=isVelocityAllowed(d);if(!(!at||!g||!b||!st)){var vt=g.velocityX,Tt=g.velocityY,Ct=g.total,pt=b.maxPositionX,wt=b.minPositionX,$t=b.maxPositionY,Lt=b.minPositionY,jt=et.limitToBounds,Ft=et.alignmentAnimation,Gt=et.zoomAnimation,Ht=et.panning,qt=Ht.lockAxisY,Kt=Ht.lockAxisX,rr=Gt.animationType,ir=Ft.sizeX,or=Ft.sizeY,jr=Ft.velocityAlignmentTime,qr=jr,Yr=getVelocityMoveTime(d,Ct),vn=Math.max(Yr,qr),ko=getPaddingValue(d,ir),Xo=getPaddingValue(d,or),zo=ko*st.offsetWidth/100,t0=Xo*st.offsetHeight/100,Uo=pt+zo,No=wt-zo,_n=$t+t0,Kr=Lt-t0,e0=d.transformState,Zr=new Date().getTime();handleSetupAnimation(d,rr,vn,function(Ro){var Sn=d.transformState,Tn=Sn.scale,n0=Sn.positionX,Go=Sn.positionY,An=new Date().getTime()-Zr,a0=An/qr,u0=animations[Ft.animationType],d0=1-u0(Math.min(1,a0)),f0=1-Ro,y0=n0+vt*f0,b0=Go+Tt*f0,O0=getVelocityPosition(y0,e0.positionX,n0,Kt,jt,wt,pt,No,Uo,d0),C0=getVelocityPosition(b0,e0.positionY,Go,qt,jt,Lt,$t,Kr,_n,d0);(n0!==y0||Go!==b0)&&d.setTransformState(Tn,O0,C0)})}}function handlePanningStart(d,g){var b=d.transformState.scale;handleCancelAnimation(d),handleCalculateBounds(d,b),window.TouchEvent!==void 0&&g instanceof TouchEvent?handleTouchPanningSetup(d,g):handlePanningSetup(d,g)}function handleAlignToBounds(d){var g=d.transformState.scale,b=d.setup,et=b.minScale,st=b.alignmentAnimation,at=st.disabled,vt=st.sizeX,Tt=st.sizeY,Ct=st.animationTime,pt=st.animationType,wt=at||g<et||!vt&&!Tt;if(!wt){var $t=handlePanToBounds(d);$t&&animate(d,$t,Ct,pt)}}function handlePanning(d,g,b){var et=d.startCoords,st=d.setup,at=st.alignmentAnimation,vt=at.sizeX,Tt=at.sizeY;if(et){var Ct=getPanningClientPosition(d,g,b),pt=Ct.x,wt=Ct.y,$t=getPaddingValue(d,vt),Lt=getPaddingValue(d,Tt);handleCalculateVelocity(d,{x:pt,y:wt}),handleNewPosition(d,pt,wt,$t,Lt)}}function handlePanningEnd(d){if(d.isPanning){var g=d.setup.panning.velocityDisabled,b=d.velocity,et=d.wrapperComponent,st=d.contentComponent;d.isPanning=!1,d.animate=!1,d.animation=null;var at=et==null?void 0:et.getBoundingClientRect(),vt=st==null?void 0:st.getBoundingClientRect(),Tt=(at==null?void 0:at.width)||0,Ct=(at==null?void 0:at.height)||0,pt=(vt==null?void 0:vt.width)||0,wt=(vt==null?void 0:vt.height)||0,$t=Tt<pt||Ct<wt,Lt=!g&&b&&(b==null?void 0:b.total)>.1&&$t;Lt?handleVelocityPanning(d):handleAlignToBounds(d)}}function handleZoomToPoint(d,g,b,et){var st=d.setup,at=st.minScale,vt=st.maxScale,Tt=st.limitToBounds,Ct=checkZoomBounds(roundNumber(g,2),at,vt,0,!1),pt=handleCalculateBounds(d,Ct),wt=handleCalculateZoomPositions(d,b,et,Ct,pt,Tt),$t=wt.x,Lt=wt.y;return{scale:Ct,positionX:$t,positionY:Lt}}function handleAlignToScaleBounds(d,g,b){var et=d.transformState.scale,st=d.wrapperComponent,at=d.setup,vt=at.minScale,Tt=at.limitToBounds,Ct=at.zoomAnimation,pt=Ct.disabled,wt=Ct.animationTime,$t=Ct.animationType,Lt=pt||et>=vt;if((et>=1||Tt)&&handleAlignToBounds(d),!(Lt||!st||!d.mounted)){var jt=g||st.offsetWidth/2,Ft=b||st.offsetHeight/2,Gt=handleZoomToPoint(d,vt,jt,Ft);Gt&&animate(d,Gt,wt,$t)}}var __assign=function(){return __assign=Object.assign||function(g){for(var b,et=1,st=arguments.length;et<st;et++){b=arguments[et];for(var at in b)Object.prototype.hasOwnProperty.call(b,at)&&(g[at]=b[at])}return g},__assign.apply(this,arguments)};function __spreadArray(d,g,b){for(var et=0,st=g.length,at;et<st;et++)(at||!(et in g))&&(at||(at=Array.prototype.slice.call(g,0,et)),at[et]=g[et]);return d.concat(at||Array.prototype.slice.call(g))}var initialState={previousScale:1,scale:1,positionX:0,positionY:0},initialSetup={disabled:!1,minPositionX:null,maxPositionX:null,minPositionY:null,maxPositionY:null,minScale:1,maxScale:8,limitToBounds:!0,centerZoomedOut:!1,centerOnInit:!1,disablePadding:!1,smooth:!0,wheel:{step:.2,disabled:!1,smoothStep:.001,wheelDisabled:!1,touchPadDisabled:!1,activationKeys:[],excluded:[]},panning:{disabled:!1,velocityDisabled:!1,lockAxisX:!1,lockAxisY:!1,allowLeftClickPan:!0,allowMiddleClickPan:!0,allowRightClickPan:!0,wheelPanning:!1,activationKeys:[],excluded:[]},pinch:{step:5,disabled:!1,excluded:[]},doubleClick:{disabled:!1,step:.7,mode:"zoomIn",animationType:"easeOut",animationTime:200,excluded:[]},zoomAnimation:{disabled:!1,size:.4,animationTime:200,animationType:"easeOut"},alignmentAnimation:{disabled:!1,sizeX:100,sizeY:100,animationTime:200,velocityAlignmentTime:400,animationType:"easeOut"},velocityAnimation:{disabled:!1,sensitivity:1,animationTime:400,animationType:"easeOut",equalToMove:!0}},createState=function(d){var g,b,et,st;return{previousScale:(g=d.initialScale)!==null&&g!==void 0?g:initialState.scale,scale:(b=d.initialScale)!==null&&b!==void 0?b:initialState.scale,positionX:(et=d.initialPositionX)!==null&&et!==void 0?et:initialState.positionX,positionY:(st=d.initialPositionY)!==null&&st!==void 0?st:initialState.positionY}},createSetup=function(d){var g=__assign({},initialSetup);return Object.keys(d).forEach(function(b){var et=typeof d[b]<"u",st=typeof initialSetup[b]<"u";if(st&&et){var at=Object.prototype.toString.call(initialSetup[b]),vt=at==="[object Object]",Tt=at==="[object Array]";vt?g[b]=__assign(__assign({},initialSetup[b]),d[b]):Tt?g[b]=__spreadArray(__spreadArray([],initialSetup[b],!0),d[b]):g[b]=d[b]}}),g},handleCalculateButtonZoom=function(d,g,b){var et=d.transformState.scale,st=d.wrapperComponent,at=d.setup,vt=at.maxScale,Tt=at.minScale,Ct=at.zoomAnimation,pt=at.smooth,wt=Ct.size;if(!st)throw new Error("Wrapper is not mounted");var $t=pt?et*Math.exp(g*b):et+g*b,Lt=checkZoomBounds(roundNumber($t,3),Tt,vt,wt,!1);return Lt};function handleZoomToViewCenter(d,g,b,et,st){var at=d.wrapperComponent,vt=d.transformState,Tt=vt.scale,Ct=vt.positionX,pt=vt.positionY;if(!at)return console.error("No WrapperComponent found");var wt=at.offsetWidth,$t=at.offsetHeight,Lt=(wt/2-Ct)/Tt,jt=($t/2-pt)/Tt,Ft=handleCalculateButtonZoom(d,g,b),Gt=handleZoomToPoint(d,Ft,Lt,jt);if(!Gt)return console.error("Error during zoom event. New transformation state was not calculated.");animate(d,Gt,et,st)}function resetTransformations(d,g,b,et){var st=d.setup,at=d.wrapperComponent,vt=st.limitToBounds,Tt=createState(d.props),Ct=d.transformState,pt=Ct.scale,wt=Ct.positionX,$t=Ct.positionY;if(at){var Lt=calculateBounds(d,Tt.scale),jt=getMouseBoundedPosition(Tt.positionX,Tt.positionY,Lt,vt,0,0,at),Ft={scale:Tt.scale,positionX:jt.x,positionY:jt.y};pt===Tt.scale&&wt===Tt.positionX&&$t===Tt.positionY||(et==null||et(),animate(d,Ft,g,b))}}function getOffset(d,g,b,et){var st=d.getBoundingClientRect(),at=g.getBoundingClientRect(),vt=b.getBoundingClientRect(),Tt=at.x*et.scale,Ct=at.y*et.scale;return{x:(st.x-vt.x+Tt)/et.scale,y:(st.y-vt.y+Ct)/et.scale}}function calculateZoomToNode(d,g,b){var et=d.wrapperComponent,st=d.contentComponent,at=d.transformState,vt=d.setup,Tt=vt.limitToBounds,Ct=vt.minScale,pt=vt.maxScale;if(!et||!st)return at;var wt=et.getBoundingClientRect(),$t=g.getBoundingClientRect(),Lt=getOffset(g,et,st,at),jt=Lt.x,Ft=Lt.y,Gt=$t.width/at.scale,Ht=$t.height/at.scale,qt=et.offsetWidth/Gt,Kt=et.offsetHeight/Ht,rr=checkZoomBounds(b||Math.min(qt,Kt),Ct,pt,0,!1),ir=(wt.width-Gt*rr)/2,or=(wt.height-Ht*rr)/2,jr=(wt.left-jt)*rr+ir,qr=(wt.top-Ft)*rr+or,Yr=calculateBounds(d,rr),vn=getMouseBoundedPosition(jr,qr,Yr,Tt,0,0,et),ko=vn.x,Xo=vn.y;return{positionX:ko,positionY:Xo,scale:rr}}var zoomIn=function(d){return function(g,b,et){g===void 0&&(g=.5),b===void 0&&(b=300),et===void 0&&(et="easeOut"),handleZoomToViewCenter(d,1,g,b,et)}},zoomOut=function(d){return function(g,b,et){g===void 0&&(g=.5),b===void 0&&(b=300),et===void 0&&(et="easeOut"),handleZoomToViewCenter(d,-1,g,b,et)}},setTransform=function(d){return function(g,b,et,st,at){st===void 0&&(st=300),at===void 0&&(at="easeOut");var vt=d.transformState,Tt=vt.positionX,Ct=vt.positionY,pt=vt.scale,wt=d.wrapperComponent,$t=d.contentComponent,Lt=d.setup.disabled;if(!(Lt||!wt||!$t)){var jt={positionX:Number.isNaN(g)?Tt:g,positionY:Number.isNaN(b)?Ct:b,scale:Number.isNaN(et)?pt:et};animate(d,jt,st,at)}}},resetTransform=function(d){return function(g,b){g===void 0&&(g=200),b===void 0&&(b="easeOut"),resetTransformations(d,g,b)}},centerView=function(d){return function(g,b,et){b===void 0&&(b=200),et===void 0&&(et="easeOut");var st=d.transformState,at=d.wrapperComponent,vt=d.contentComponent;if(at&&vt){var Tt=getCenterPosition(g||st.scale,at,vt);animate(d,Tt,b,et)}}},zoomToElement=function(d){return function(g,b,et,st){et===void 0&&(et=600),st===void 0&&(st="easeOut"),handleCancelAnimation(d);var at=d.wrapperComponent,vt=typeof g=="string"?document.getElementById(g):g;if(at&&vt&&at.contains(vt)){var Tt=calculateZoomToNode(d,vt,b);animate(d,Tt,et,st)}}},getControls=function(d){return{instance:d,zoomIn:zoomIn(d),zoomOut:zoomOut(d),setTransform:setTransform(d),resetTransform:resetTransform(d),centerView:centerView(d),zoomToElement:zoomToElement(d)}},getState=function(d){return{instance:d,state:d.transformState}},getContext=function(d){var g={};return Object.assign(g,getState(d)),Object.assign(g,getControls(d)),g},passiveSupported=!1;function makePassiveEventOption(){try{var d={get passive(){return passiveSupported=!0,!1}};return d}catch{return passiveSupported=!1,passiveSupported}}var isExcludedNode=function(d,g){return g.some(function(b){return d.matches("".concat(b,", .").concat(b,", ").concat(b," *, .").concat(b," *"))})},cancelTimeout=function(d){d&&clearTimeout(d)},getTransformStyles=function(d,g,b){return"translate(".concat(d,"px, ").concat(g,"px) scale(").concat(b,")")},getCenterPosition=function(d,g,b){var et=b.offsetWidth*d,st=b.offsetHeight*d,at=(g.offsetWidth-et)/2,vt=(g.offsetHeight-st)/2;return{scale:d,positionX:at,positionY:vt}};function mergeRefs(d){return function(g){d.forEach(function(b){typeof b=="function"?b(g):b!=null&&(b.current=g)})}}var isWheelAllowed=function(d,g){var b=d.setup.wheel,et=b.disabled,st=b.wheelDisabled,at=b.touchPadDisabled,vt=b.excluded,Tt=d.isInitialized,Ct=d.isPanning,pt=g.target,wt=Tt&&!Ct&&!et&&pt;if(!wt||st&&!g.ctrlKey||at&&g.ctrlKey)return!1;var $t=isExcludedNode(pt,vt);return!$t},getDeltaY=function(d){return d?d.deltaY<0?1:-1:0};function getDelta(d,g){var b=getDeltaY(d),et=checkIsNumber(g,b);return et}function getMousePosition(d,g,b){var et=g.getBoundingClientRect(),st=0,at=0;if("clientX"in d)st=(d.clientX-et.left)/b,at=(d.clientY-et.top)/b;else{var vt=d.touches[0];st=(vt.clientX-et.left)/b,at=(vt.clientY-et.top)/b}return(Number.isNaN(st)||Number.isNaN(at))&&console.error("No mouse or touch offset found"),{x:st,y:at}}var handleCalculateWheelZoom=function(d,g,b,et,st){var at=d.transformState.scale,vt=d.wrapperComponent,Tt=d.setup,Ct=Tt.maxScale,pt=Tt.minScale,wt=Tt.zoomAnimation,$t=Tt.disablePadding,Lt=wt.size,jt=wt.disabled;if(!vt)throw new Error("Wrapper is not mounted");var Ft=at+g*b,Gt=et?!1:!jt,Ht=checkZoomBounds(roundNumber(Ft,3),pt,Ct,Lt,Gt&&!$t);return Ht},handleWheelZoomStop=function(d,g){var b=d.previousWheelEvent,et=d.transformState.scale,st=d.setup,at=st.maxScale,vt=st.minScale;return b?et<at||et>vt||Math.sign(b.deltaY)!==Math.sign(g.deltaY)||b.deltaY>0&&b.deltaY<g.deltaY||b.deltaY<0&&b.deltaY>g.deltaY||Math.sign(b.deltaY)!==Math.sign(g.deltaY):!1},isPinchStartAllowed=function(d,g){var b=d.setup.pinch,et=b.disabled,st=b.excluded,at=d.isInitialized,vt=g.target,Tt=at&&!et&&vt;if(!Tt)return!1;var Ct=isExcludedNode(vt,st);return!Ct},isPinchAllowed=function(d){var g=d.setup.pinch.disabled,b=d.isInitialized,et=d.pinchStartDistance,st=b&&!g&&et;return!!st},calculateTouchMidPoint=function(d,g,b){var et=b.getBoundingClientRect(),st=d.touches,at=roundNumber(st[0].clientX-et.left,5),vt=roundNumber(st[0].clientY-et.top,5),Tt=roundNumber(st[1].clientX-et.left,5),Ct=roundNumber(st[1].clientY-et.top,5);return{x:(at+Tt)/2/g,y:(vt+Ct)/2/g}},getTouchDistance=function(d){return Math.sqrt(Math.pow(d.touches[0].pageX-d.touches[1].pageX,2)+Math.pow(d.touches[0].pageY-d.touches[1].pageY,2))},calculatePinchZoom=function(d,g){var b=d.pinchStartScale,et=d.pinchStartDistance,st=d.setup,at=st.maxScale,vt=st.minScale,Tt=st.zoomAnimation,Ct=st.disablePadding,pt=Tt.size,wt=Tt.disabled;if(!b||et===null||!g)throw new Error("Pinch touches distance was not provided");if(g<0)return d.transformState.scale;var $t=g/et,Lt=$t*b;return checkZoomBounds(roundNumber(Lt,2),vt,at,pt,!wt&&!Ct)},wheelStopEventTime=160,wheelAnimationTime=100,handleWheelStart=function(d,g){var b=d.props,et=b.onWheelStart,st=b.onZoomStart;d.wheelStopEventTimer||(handleCancelAnimation(d),handleCallback(getContext(d),g,et),handleCallback(getContext(d),g,st))},handleWheelZoom=function(d,g){var b=d.props,et=b.onWheel,st=b.onZoom,at=d.contentComponent,vt=d.setup,Tt=d.transformState,Ct=Tt.scale,pt=vt.limitToBounds,wt=vt.centerZoomedOut,$t=vt.zoomAnimation,Lt=vt.wheel,jt=vt.disablePadding,Ft=vt.smooth,Gt=$t.size,Ht=$t.disabled,qt=Lt.step,Kt=Lt.smoothStep;if(!at)throw new Error("Component not mounted");g.preventDefault(),g.stopPropagation();var rr=getDelta(g,null),ir=Ft?Kt*Math.abs(g.deltaY):qt,or=handleCalculateWheelZoom(d,rr,ir,!g.ctrlKey);if(Ct!==or){var jr=handleCalculateBounds(d,or),qr=getMousePosition(g,at,Ct),Yr=Ht||Gt===0||wt||jt,vn=pt&&Yr,ko=handleCalculateZoomPositions(d,qr.x,qr.y,or,jr,vn),Xo=ko.x,zo=ko.y;d.previousWheelEvent=g,d.setTransformState(or,Xo,zo),handleCallback(getContext(d),g,et),handleCallback(getContext(d),g,st)}},handleWheelStop=function(d,g){var b=d.props,et=b.onWheelStop,st=b.onZoomStop;cancelTimeout(d.wheelAnimationTimer),d.wheelAnimationTimer=setTimeout(function(){d.mounted&&(handleAlignToScaleBounds(d,g.x,g.y),d.wheelAnimationTimer=null)},wheelAnimationTime);var at=handleWheelZoomStop(d,g);at&&(cancelTimeout(d.wheelStopEventTimer),d.wheelStopEventTimer=setTimeout(function(){d.mounted&&(d.wheelStopEventTimer=null,handleCallback(getContext(d),g,et),handleCallback(getContext(d),g,st))},wheelStopEventTime))},handlePinchStart=function(d,g){var b=getTouchDistance(g);d.pinchStartDistance=b,d.lastDistance=b,d.pinchStartScale=d.transformState.scale,d.isPanning=!1,handleCancelAnimation(d)},handlePinchZoom=function(d,g){var b=d.contentComponent,et=d.pinchStartDistance,st=d.transformState.scale,at=d.setup,vt=at.limitToBounds,Tt=at.centerZoomedOut,Ct=at.zoomAnimation,pt=Ct.disabled,wt=Ct.size;if(!(et===null||!b)){var $t=calculateTouchMidPoint(g,st,b);if(!(!Number.isFinite($t.x)||!Number.isFinite($t.y))){var Lt=getTouchDistance(g),jt=calculatePinchZoom(d,Lt);if(jt!==st){var Ft=handleCalculateBounds(d,jt),Gt=pt||wt===0||Tt,Ht=vt&&Gt,qt=handleCalculateZoomPositions(d,$t.x,$t.y,jt,Ft,Ht),Kt=qt.x,rr=qt.y;d.pinchMidpoint=$t,d.lastDistance=Lt,d.setTransformState(jt,Kt,rr)}}}},handlePinchStop=function(d){var g=d.pinchMidpoint;d.velocity=null,d.lastDistance=null,d.pinchMidpoint=null,d.pinchStartScale=null,d.pinchStartDistance=null,handleAlignToScaleBounds(d,g==null?void 0:g.x,g==null?void 0:g.y)},handleDoubleClickStop=function(d,g){var b=d.props.onZoomStop,et=d.setup.doubleClick.animationTime;cancelTimeout(d.doubleClickStopEventTimer),d.doubleClickStopEventTimer=setTimeout(function(){d.doubleClickStopEventTimer=null,handleCallback(getContext(d),g,b)},et)},handleDoubleClickResetMode=function(d,g){var b=d.props,et=b.onZoomStart,st=b.onZoom,at=d.setup.doubleClick,vt=at.animationTime,Tt=at.animationType;handleCallback(getContext(d),g,et),resetTransformations(d,vt,Tt,function(){return handleCallback(getContext(d),g,st)}),handleDoubleClickStop(d,g)};function getDoubleClickScale(d,g){return d==="toggle"?g===1?1:-1:d==="zoomOut"?-1:1}function handleDoubleClick(d,g){var b=d.setup,et=d.doubleClickStopEventTimer,st=d.transformState,at=d.contentComponent,vt=st.scale,Tt=d.props,Ct=Tt.onZoomStart,pt=Tt.onZoom,wt=b.doubleClick,$t=wt.disabled,Lt=wt.mode,jt=wt.step,Ft=wt.animationTime,Gt=wt.animationType;if(!$t&&!et){if(Lt==="reset")return handleDoubleClickResetMode(d,g);if(!at)return console.error("No ContentComponent found");var Ht=getDoubleClickScale(Lt,d.transformState.scale),qt=handleCalculateButtonZoom(d,Ht,jt);if(vt!==qt){handleCallback(getContext(d),g,Ct);var Kt=getMousePosition(g,at,vt),rr=handleZoomToPoint(d,qt,Kt.x,Kt.y);if(!rr)return console.error("Error during zoom event. New transformation state was not calculated.");handleCallback(getContext(d),g,pt),animate(d,rr,Ft,Gt),handleDoubleClickStop(d,g)}}}var isDoubleClickAllowed=function(d,g){var b=d.isInitialized,et=d.setup,st=d.wrapperComponent,at=et.doubleClick,vt=at.disabled,Tt=at.excluded,Ct=g.target,pt=st==null?void 0:st.contains(Ct),wt=b&&Ct&&pt&&!vt;if(!wt)return!1;var $t=isExcludedNode(Ct,Tt);return!$t},ZoomPanPinch=function(){function d(g){var b=this;this.mounted=!0,this.onChangeCallbacks=new Set,this.onInitCallbacks=new Set,this.wrapperComponent=null,this.contentComponent=null,this.isInitialized=!1,this.bounds=null,this.previousWheelEvent=null,this.wheelStopEventTimer=null,this.wheelAnimationTimer=null,this.isPanning=!1,this.isWheelPanning=!1,this.startCoords=null,this.lastTouch=null,this.distance=null,this.lastDistance=null,this.pinchStartDistance=null,this.pinchStartScale=null,this.pinchMidpoint=null,this.doubleClickStopEventTimer=null,this.velocity=null,this.velocityTime=null,this.lastMousePosition=null,this.animate=!1,this.animation=null,this.maxBounds=null,this.pressedKeys={},this.mount=function(){b.initializeWindowEvents()},this.unmount=function(){b.cleanupWindowEvents()},this.update=function(et){b.props=et,handleCalculateBounds(b,b.transformState.scale),b.setup=createSetup(et)},this.initializeWindowEvents=function(){var et,st,at=makePassiveEventOption(),vt=(et=b.wrapperComponent)===null||et===void 0?void 0:et.ownerDocument,Tt=vt==null?void 0:vt.defaultView;(st=b.wrapperComponent)===null||st===void 0||st.addEventListener("wheel",b.onWheelPanning,at),Tt==null||Tt.addEventListener("mousedown",b.onPanningStart,at),Tt==null||Tt.addEventListener("mousemove",b.onPanning,at),Tt==null||Tt.addEventListener("mouseup",b.onPanningStop,at),vt==null||vt.addEventListener("mouseleave",b.clearPanning,at),Tt==null||Tt.addEventListener("keyup",b.setKeyUnPressed,at),Tt==null||Tt.addEventListener("keydown",b.setKeyPressed,at)},this.cleanupWindowEvents=function(){var et,st,at=makePassiveEventOption(),vt=(et=b.wrapperComponent)===null||et===void 0?void 0:et.ownerDocument,Tt=vt==null?void 0:vt.defaultView;Tt==null||Tt.removeEventListener("mousedown",b.onPanningStart,at),Tt==null||Tt.removeEventListener("mousemove",b.onPanning,at),Tt==null||Tt.removeEventListener("mouseup",b.onPanningStop,at),vt==null||vt.removeEventListener("mouseleave",b.clearPanning,at),Tt==null||Tt.removeEventListener("keyup",b.setKeyUnPressed,at),Tt==null||Tt.removeEventListener("keydown",b.setKeyPressed,at),document.removeEventListener("mouseleave",b.clearPanning,at),handleCancelAnimation(b),(st=b.observer)===null||st===void 0||st.disconnect()},this.handleInitializeWrapperEvents=function(et){var st=makePassiveEventOption();et.addEventListener("wheel",b.onWheelZoom,st),et.addEventListener("dblclick",b.onDoubleClick,st),et.addEventListener("touchstart",b.onTouchPanningStart,st),et.addEventListener("touchmove",b.onTouchPanning,st),et.addEventListener("touchend",b.onTouchPanningStop,st)},this.handleInitialize=function(et){var st=b.setup.centerOnInit;b.applyTransformation(),b.onInitCallbacks.forEach(function(at){return at(getContext(b))}),st&&(b.setCenter(),b.observer=new ResizeObserver(function(){var at,vt=et.offsetWidth,Tt=et.offsetHeight;(vt>0||Tt>0)&&(b.onInitCallbacks.forEach(function(Ct){return Ct(getContext(b))}),b.setCenter(),(at=b.observer)===null||at===void 0||at.disconnect())}),setTimeout(function(){var at;(at=b.observer)===null||at===void 0||at.disconnect()},5e3),b.observer.observe(et))},this.onWheelZoom=function(et){var st=b.setup.disabled;if(!st){var at=isWheelAllowed(b,et);if(at){var vt=b.isPressingKeys(b.setup.wheel.activationKeys);vt&&(handleWheelStart(b,et),handleWheelZoom(b,et),handleWheelStop(b,et))}}},this.onWheelPanning=function(et){var st=b.setup,at=st.disabled,vt=st.wheel,Tt=st.panning;if(!(!b.wrapperComponent||!b.contentComponent||at||!vt.wheelDisabled||Tt.disabled||!Tt.wheelPanning||et.ctrlKey)){et.preventDefault(),et.stopPropagation();var Ct=b.transformState,pt=Ct.positionX,wt=Ct.positionY,$t=pt-et.deltaX,Lt=wt-et.deltaY,jt=Tt.lockAxisX?pt:$t,Ft=Tt.lockAxisY?wt:Lt,Gt=b.setup.alignmentAnimation,Ht=Gt.sizeX,qt=Gt.sizeY,Kt=getPaddingValue(b,Ht),rr=getPaddingValue(b,qt);jt===pt&&Ft===wt||handleNewPosition(b,jt,Ft,Kt,rr)}},this.onPanningStart=function(et){var st=b.setup.disabled,at=b.props.onPanningStart;if(!st){var vt=isPanningStartAllowed(b,et);if(vt){var Tt=b.isPressingKeys(b.setup.panning.activationKeys);Tt&&(et.button===0&&!b.setup.panning.allowLeftClickPan||et.button===1&&!b.setup.panning.allowMiddleClickPan||et.button===2&&!b.setup.panning.allowRightClickPan||(et.preventDefault(),et.stopPropagation(),handleCancelAnimation(b),handlePanningStart(b,et),handleCallback(getContext(b),et,at)))}}},this.onPanning=function(et){var st=b.setup.disabled,at=b.props.onPanning;if(!st){var vt=isPanningAllowed(b);if(vt){var Tt=b.isPressingKeys(b.setup.panning.activationKeys);Tt&&(et.preventDefault(),et.stopPropagation(),handlePanning(b,et.clientX,et.clientY),handleCallback(getContext(b),et,at))}}},this.onPanningStop=function(et){var st=b.props.onPanningStop;b.isPanning&&(handlePanningEnd(b),handleCallback(getContext(b),et,st))},this.onPinchStart=function(et){var st=b.setup.disabled,at=b.props,vt=at.onPinchingStart,Tt=at.onZoomStart;if(!st){var Ct=isPinchStartAllowed(b,et);Ct&&(handlePinchStart(b,et),handleCancelAnimation(b),handleCallback(getContext(b),et,vt),handleCallback(getContext(b),et,Tt))}},this.onPinch=function(et){var st=b.setup.disabled,at=b.props,vt=at.onPinching,Tt=at.onZoom;if(!st){var Ct=isPinchAllowed(b);Ct&&(et.preventDefault(),et.stopPropagation(),handlePinchZoom(b,et),handleCallback(getContext(b),et,vt),handleCallback(getContext(b),et,Tt))}},this.onPinchStop=function(et){var st=b.props,at=st.onPinchingStop,vt=st.onZoomStop;b.pinchStartScale&&(handlePinchStop(b),handleCallback(getContext(b),et,at),handleCallback(getContext(b),et,vt))},this.onTouchPanningStart=function(et){var st=b.setup.disabled,at=b.props.onPanningStart;if(!st){var vt=isPanningStartAllowed(b,et);if(vt){var Tt=b.lastTouch&&+new Date-b.lastTouch<200;if(Tt&&et.touches.length===1)b.onDoubleClick(et);else{b.lastTouch=+new Date,handleCancelAnimation(b);var Ct=et.touches,pt=Ct.length===1,wt=Ct.length===2;pt&&(handleCancelAnimation(b),handlePanningStart(b,et),handleCallback(getContext(b),et,at)),wt&&b.onPinchStart(et)}}}},this.onTouchPanning=function(et){var st=b.setup.disabled,at=b.props.onPanning;if(b.isPanning&&et.touches.length===1){if(st)return;var vt=isPanningAllowed(b);if(!vt)return;et.preventDefault(),et.stopPropagation();var Tt=et.touches[0];handlePanning(b,Tt.clientX,Tt.clientY),handleCallback(getContext(b),et,at)}else et.touches.length>1&&b.onPinch(et)},this.onTouchPanningStop=function(et){b.onPanningStop(et),b.onPinchStop(et)},this.onDoubleClick=function(et){var st=b.setup.disabled;if(!st){var at=isDoubleClickAllowed(b,et);at&&handleDoubleClick(b,et)}},this.clearPanning=function(et){b.isPanning&&b.onPanningStop(et)},this.setKeyPressed=function(et){b.pressedKeys[et.key]=!0},this.setKeyUnPressed=function(et){b.pressedKeys[et.key]=!1},this.isPressingKeys=function(et){return et.length?!!et.find(function(st){return b.pressedKeys[st]}):!0},this.setTransformState=function(et,st,at){var vt=b.props.onTransformed;if(!Number.isNaN(et)&&!Number.isNaN(st)&&!Number.isNaN(at)){et!==b.transformState.scale&&(b.transformState.previousScale=b.transformState.scale,b.transformState.scale=et),b.transformState.positionX=st,b.transformState.positionY=at,b.applyTransformation();var Tt=getContext(b);b.onChangeCallbacks.forEach(function(Ct){return Ct(Tt)}),handleCallback(Tt,{scale:et,positionX:st,positionY:at},vt)}else console.error("Detected NaN set state values")},this.setCenter=function(){if(b.wrapperComponent&&b.contentComponent){var et=getCenterPosition(b.transformState.scale,b.wrapperComponent,b.contentComponent);b.setTransformState(et.scale,et.positionX,et.positionY)}},this.handleTransformStyles=function(et,st,at){return b.props.customTransform?b.props.customTransform(et,st,at):getTransformStyles(et,st,at)},this.applyTransformation=function(){if(!(!b.mounted||!b.contentComponent)){var et=b.transformState,st=et.scale,at=et.positionX,vt=et.positionY,Tt=b.handleTransformStyles(at,vt,st);b.contentComponent.style.transform=Tt}},this.getContext=function(){return getContext(b)},this.onChange=function(et){return b.onChangeCallbacks.has(et)||b.onChangeCallbacks.add(et),function(){b.onChangeCallbacks.delete(et)}},this.onInit=function(et){return b.onInitCallbacks.has(et)||b.onInitCallbacks.add(et),function(){b.onInitCallbacks.delete(et)}},this.init=function(et,st){b.cleanupWindowEvents(),b.wrapperComponent=et,b.contentComponent=st,handleCalculateBounds(b,b.transformState.scale),b.handleInitializeWrapperEvents(et),b.handleInitialize(st),b.initializeWindowEvents(),b.isInitialized=!0;var at=getContext(b);handleCallback(at,void 0,b.props.onInit)},this.props=g,this.setup=createSetup(this.props),this.transformState=createState(this.props)}return d}(),Context=React.createContext(null),getContent=function(d,g){return typeof d=="function"?d(g):d},TransformWrapper=React.forwardRef(function(d,g){var b=reactExports.useRef(new ZoomPanPinch(d)).current,et=getContent(d.children,getControls(b));return reactExports.useImperativeHandle(g,function(){return getControls(b)},[b]),reactExports.useEffect(function(){b.update(d)},[b,d]),React.createElement(Context.Provider,{value:b},et)});React.forwardRef(function(d,g){var b=reactExports.useRef(null),et=reactExports.useContext(Context);return reactExports.useEffect(function(){return et.onChange(function(st){if(b.current){var at=0,vt=0;b.current.style.transform=et.handleTransformStyles(at,vt,1/st.instance.transformState.scale)}})},[et]),React.createElement("div",__assign({},d,{ref:mergeRefs([b,g])}))});function styleInject(d,g){g===void 0&&(g={});var b=g.insertAt;if(!(typeof document>"u")){var et=document.head||document.getElementsByTagName("head")[0],st=document.createElement("style");st.type="text/css",b==="top"&&et.firstChild?et.insertBefore(st,et.firstChild):et.appendChild(st),st.styleSheet?st.styleSheet.cssText=d:st.appendChild(document.createTextNode(d))}}var css_248z=`.transform-component-module_wrapper__SPB86 {
  position: relative;
  width: -moz-fit-content;
  width: fit-content;
  height: -moz-fit-content;
  height: fit-content;
  overflow: hidden;
  -webkit-touch-callout: none; /* iOS Safari */
  -webkit-user-select: none; /* Safari */
  -khtml-user-select: none; /* Konqueror HTML */
  -moz-user-select: none; /* Firefox */
  -ms-user-select: none; /* Internet Explorer/Edge */
  user-select: none;
  margin: 0;
  padding: 0;
}
.transform-component-module_content__FBWxo {
  display: flex;
  flex-wrap: wrap;
  width: -moz-fit-content;
  width: fit-content;
  height: -moz-fit-content;
  height: fit-content;
  margin: 0;
  padding: 0;
  transform-origin: 0% 0%;
}
.transform-component-module_content__FBWxo img {
  pointer-events: none;
}
`,styles={wrapper:"transform-component-module_wrapper__SPB86",content:"transform-component-module_content__FBWxo"};styleInject(css_248z);var TransformComponent=function(d){var g=d.children,b=d.wrapperClass,et=b===void 0?"":b,st=d.contentClass,at=st===void 0?"":st,vt=d.wrapperStyle,Tt=d.contentStyle,Ct=d.wrapperProps,pt=Ct===void 0?{}:Ct,wt=d.contentProps,$t=wt===void 0?{}:wt,Lt=reactExports.useContext(Context),jt=Lt.init,Ft=Lt.cleanupWindowEvents,Gt=reactExports.useRef(null),Ht=reactExports.useRef(null);return reactExports.useEffect(function(){var qt=Gt.current,Kt=Ht.current;return qt!==null&&Kt!==null&&jt&&(jt==null||jt(qt,Kt)),function(){Ft==null||Ft()}},[]),React.createElement("div",__assign({},pt,{ref:Gt,className:"react-transform-wrapper ".concat(styles.wrapper," ").concat(et),style:vt}),React.createElement("div",__assign({},$t,{ref:Ht,className:"react-transform-component ".concat(styles.content," ").concat(at),style:Tt}),g))};function useImage(d){const[g]=reactExports.useState(new Image),[b,et]=reactExports.useState(!1);return reactExports.useEffect(()=>{if(d)return g.onload=()=>{et(!0)},et(!1),g.src=URL.createObjectURL(d),()=>{g.onload=null}},[d,g]),[g,b]}const $faa2e61a3361514f$var$PAGE_KEYS=["PageUp","PageDown"],$faa2e61a3361514f$var$ARROW_KEYS=["ArrowUp","ArrowDown","ArrowLeft","ArrowRight"],$faa2e61a3361514f$var$BACK_KEYS={"from-left":["Home","PageDown","ArrowDown","ArrowLeft"],"from-right":["Home","PageDown","ArrowDown","ArrowRight"],"from-bottom":["Home","PageDown","ArrowDown","ArrowLeft"],"from-top":["Home","PageDown","ArrowUp","ArrowLeft"]},$faa2e61a3361514f$var$SLIDER_NAME="Slider",[$faa2e61a3361514f$var$Collection,$faa2e61a3361514f$var$useCollection,$faa2e61a3361514f$var$createCollectionScope]=$e02a7d9cb1dc128c$export$c74125a8e3af6bb2($faa2e61a3361514f$var$SLIDER_NAME),[$faa2e61a3361514f$var$createSliderContext,$faa2e61a3361514f$export$ef72632d7b901f97]=$c512c27ab02ef895$export$50c7b4e9d9f19c1($faa2e61a3361514f$var$SLIDER_NAME,[$faa2e61a3361514f$var$createCollectionScope]),[$faa2e61a3361514f$var$SliderProvider,$faa2e61a3361514f$var$useSliderContext]=$faa2e61a3361514f$var$createSliderContext($faa2e61a3361514f$var$SLIDER_NAME),$faa2e61a3361514f$export$472062a354075cee=reactExports.forwardRef((d,g)=>{const{name:b,min:et=0,max:st=100,step:at=1,orientation:vt="horizontal",disabled:Tt=!1,minStepsBetweenThumbs:Ct=0,defaultValue:pt=[et],value:wt,onValueChange:$t=()=>{},onValueCommit:Lt=()=>{},inverted:jt=!1,...Ft}=d,[Gt,Ht]=reactExports.useState(null),qt=$6ed0406888f73fc4$export$c7b2cbe3552a0d05(g,Uo=>Ht(Uo)),Kt=reactExports.useRef(new Set),rr=reactExports.useRef(0),ir=vt==="horizontal",or=Gt?!!Gt.closest("form"):!0,jr=ir?$faa2e61a3361514f$var$SliderHorizontal:$faa2e61a3361514f$var$SliderVertical,[qr=[],Yr]=$71cd76cc60e0454e$export$6f32135080cb4c3({prop:wt,defaultProp:pt,onChange:Uo=>{var No;(No=[...Kt.current][rr.current])===null||No===void 0||No.focus(),$t(Uo)}}),vn=reactExports.useRef(qr);function ko(Uo){const No=$faa2e61a3361514f$var$getClosestValueIndex(qr,Uo);t0(Uo,No)}function Xo(Uo){t0(Uo,rr.current)}function zo(){const Uo=vn.current[rr.current];qr[rr.current]!==Uo&&Lt(qr)}function t0(Uo,No,{commit:_n}={commit:!1}){const Kr=$faa2e61a3361514f$var$getDecimalCount(at),e0=$faa2e61a3361514f$var$roundValue(Math.round((Uo-et)/at)*at+et,Kr),Zr=$ae6933e535247d3d$export$7d15b64cf5a3a4c4(e0,[et,st]);Yr((Ro=[])=>{const Sn=$faa2e61a3361514f$var$getNextSortedValues(Ro,Zr,No);if($faa2e61a3361514f$var$hasMinStepsBetweenValues(Sn,Ct*at)){rr.current=Sn.indexOf(Zr);const Tn=String(Sn)!==String(Ro);return Tn&&_n&&Lt(Sn),Tn?Sn:Ro}else return Ro})}return reactExports.createElement($faa2e61a3361514f$var$SliderProvider,{scope:d.__scopeSlider,disabled:Tt,min:et,max:st,valueIndexToChangeRef:rr,thumbs:Kt.current,values:qr,orientation:vt},reactExports.createElement($faa2e61a3361514f$var$Collection.Provider,{scope:d.__scopeSlider},reactExports.createElement($faa2e61a3361514f$var$Collection.Slot,{scope:d.__scopeSlider},reactExports.createElement(jr,_extends$1({"aria-disabled":Tt,"data-disabled":Tt?"":void 0},Ft,{ref:qt,onPointerDown:$e42e1063c40fb3ef$export$b9ecd428b558ff10(Ft.onPointerDown,()=>{Tt||(vn.current=qr)}),min:et,max:st,inverted:jt,onSlideStart:Tt?void 0:ko,onSlideMove:Tt?void 0:Xo,onSlideEnd:Tt?void 0:zo,onHomeKeyDown:()=>!Tt&&t0(et,0,{commit:!0}),onEndKeyDown:()=>!Tt&&t0(st,qr.length-1,{commit:!0}),onStepKeyDown:({event:Uo,direction:No})=>{if(!Tt){const e0=$faa2e61a3361514f$var$PAGE_KEYS.includes(Uo.key)||Uo.shiftKey&&$faa2e61a3361514f$var$ARROW_KEYS.includes(Uo.key)?10:1,Zr=rr.current,Ro=qr[Zr],Sn=at*e0*No;t0(Ro+Sn,Zr,{commit:!0})}}})))),or&&qr.map((Uo,No)=>reactExports.createElement($faa2e61a3361514f$var$BubbleInput,{key:No,name:b?b+(qr.length>1?"[]":""):void 0,value:Uo})))}),[$faa2e61a3361514f$var$SliderOrientationProvider,$faa2e61a3361514f$var$useSliderOrientationContext]=$faa2e61a3361514f$var$createSliderContext($faa2e61a3361514f$var$SLIDER_NAME,{startEdge:"left",endEdge:"right",size:"width",direction:1}),$faa2e61a3361514f$var$SliderHorizontal=reactExports.forwardRef((d,g)=>{const{min:b,max:et,dir:st,inverted:at,onSlideStart:vt,onSlideMove:Tt,onSlideEnd:Ct,onStepKeyDown:pt,...wt}=d,[$t,Lt]=reactExports.useState(null),jt=$6ed0406888f73fc4$export$c7b2cbe3552a0d05(g,rr=>Lt(rr)),Ft=reactExports.useRef(),Gt=$f631663db3294ace$export$b39126d51d94e6f3(st),Ht=Gt==="ltr",qt=Ht&&!at||!Ht&&at;function Kt(rr){const ir=Ft.current||$t.getBoundingClientRect(),or=[0,ir.width],qr=$faa2e61a3361514f$var$linearScale(or,qt?[b,et]:[et,b]);return Ft.current=ir,qr(rr-ir.left)}return reactExports.createElement($faa2e61a3361514f$var$SliderOrientationProvider,{scope:d.__scopeSlider,startEdge:qt?"left":"right",endEdge:qt?"right":"left",direction:qt?1:-1,size:"width"},reactExports.createElement($faa2e61a3361514f$var$SliderImpl,_extends$1({dir:Gt,"data-orientation":"horizontal"},wt,{ref:jt,style:{...wt.style,"--radix-slider-thumb-transform":"translateX(-50%)"},onSlideStart:rr=>{const ir=Kt(rr.clientX);vt==null||vt(ir)},onSlideMove:rr=>{const ir=Kt(rr.clientX);Tt==null||Tt(ir)},onSlideEnd:()=>{Ft.current=void 0,Ct==null||Ct()},onStepKeyDown:rr=>{const or=$faa2e61a3361514f$var$BACK_KEYS[qt?"from-left":"from-right"].includes(rr.key);pt==null||pt({event:rr,direction:or?-1:1})}})))}),$faa2e61a3361514f$var$SliderVertical=reactExports.forwardRef((d,g)=>{const{min:b,max:et,inverted:st,onSlideStart:at,onSlideMove:vt,onSlideEnd:Tt,onStepKeyDown:Ct,...pt}=d,wt=reactExports.useRef(null),$t=$6ed0406888f73fc4$export$c7b2cbe3552a0d05(g,wt),Lt=reactExports.useRef(),jt=!st;function Ft(Gt){const Ht=Lt.current||wt.current.getBoundingClientRect(),qt=[0,Ht.height],rr=$faa2e61a3361514f$var$linearScale(qt,jt?[et,b]:[b,et]);return Lt.current=Ht,rr(Gt-Ht.top)}return reactExports.createElement($faa2e61a3361514f$var$SliderOrientationProvider,{scope:d.__scopeSlider,startEdge:jt?"bottom":"top",endEdge:jt?"top":"bottom",size:"height",direction:jt?1:-1},reactExports.createElement($faa2e61a3361514f$var$SliderImpl,_extends$1({"data-orientation":"vertical"},pt,{ref:$t,style:{...pt.style,"--radix-slider-thumb-transform":"translateY(50%)"},onSlideStart:Gt=>{const Ht=Ft(Gt.clientY);at==null||at(Ht)},onSlideMove:Gt=>{const Ht=Ft(Gt.clientY);vt==null||vt(Ht)},onSlideEnd:()=>{Lt.current=void 0,Tt==null||Tt()},onStepKeyDown:Gt=>{const qt=$faa2e61a3361514f$var$BACK_KEYS[jt?"from-bottom":"from-top"].includes(Gt.key);Ct==null||Ct({event:Gt,direction:qt?-1:1})}})))}),$faa2e61a3361514f$var$SliderImpl=reactExports.forwardRef((d,g)=>{const{__scopeSlider:b,onSlideStart:et,onSlideMove:st,onSlideEnd:at,onHomeKeyDown:vt,onEndKeyDown:Tt,onStepKeyDown:Ct,...pt}=d,wt=$faa2e61a3361514f$var$useSliderContext($faa2e61a3361514f$var$SLIDER_NAME,b);return reactExports.createElement($8927f6f2acc4f386$export$250ffa63cdc0d034.span,_extends$1({},pt,{ref:g,onKeyDown:$e42e1063c40fb3ef$export$b9ecd428b558ff10(d.onKeyDown,$t=>{$t.key==="Home"?(vt($t),$t.preventDefault()):$t.key==="End"?(Tt($t),$t.preventDefault()):$faa2e61a3361514f$var$PAGE_KEYS.concat($faa2e61a3361514f$var$ARROW_KEYS).includes($t.key)&&(Ct($t),$t.preventDefault())}),onPointerDown:$e42e1063c40fb3ef$export$b9ecd428b558ff10(d.onPointerDown,$t=>{const Lt=$t.target;Lt.setPointerCapture($t.pointerId),$t.preventDefault(),wt.thumbs.has(Lt)?Lt.focus():et($t)}),onPointerMove:$e42e1063c40fb3ef$export$b9ecd428b558ff10(d.onPointerMove,$t=>{$t.target.hasPointerCapture($t.pointerId)&&st($t)}),onPointerUp:$e42e1063c40fb3ef$export$b9ecd428b558ff10(d.onPointerUp,$t=>{const Lt=$t.target;Lt.hasPointerCapture($t.pointerId)&&(Lt.releasePointerCapture($t.pointerId),at($t))})}))}),$faa2e61a3361514f$var$TRACK_NAME="SliderTrack",$faa2e61a3361514f$export$105594979f116971=reactExports.forwardRef((d,g)=>{const{__scopeSlider:b,...et}=d,st=$faa2e61a3361514f$var$useSliderContext($faa2e61a3361514f$var$TRACK_NAME,b);return reactExports.createElement($8927f6f2acc4f386$export$250ffa63cdc0d034.span,_extends$1({"data-disabled":st.disabled?"":void 0,"data-orientation":st.orientation},et,{ref:g}))}),$faa2e61a3361514f$var$RANGE_NAME="SliderRange",$faa2e61a3361514f$export$a5cf38a7a000fe77=reactExports.forwardRef((d,g)=>{const{__scopeSlider:b,...et}=d,st=$faa2e61a3361514f$var$useSliderContext($faa2e61a3361514f$var$RANGE_NAME,b),at=$faa2e61a3361514f$var$useSliderOrientationContext($faa2e61a3361514f$var$RANGE_NAME,b),vt=reactExports.useRef(null),Tt=$6ed0406888f73fc4$export$c7b2cbe3552a0d05(g,vt),Ct=st.values.length,pt=st.values.map(Lt=>$faa2e61a3361514f$var$convertValueToPercentage(Lt,st.min,st.max)),wt=Ct>1?Math.min(...pt):0,$t=100-Math.max(...pt);return reactExports.createElement($8927f6f2acc4f386$export$250ffa63cdc0d034.span,_extends$1({"data-orientation":st.orientation,"data-disabled":st.disabled?"":void 0},et,{ref:Tt,style:{...d.style,[at.startEdge]:wt+"%",[at.endEdge]:$t+"%"}}))}),$faa2e61a3361514f$var$THUMB_NAME="SliderThumb",$faa2e61a3361514f$export$2c1b491743890dec=reactExports.forwardRef((d,g)=>{const b=$faa2e61a3361514f$var$useCollection(d.__scopeSlider),[et,st]=reactExports.useState(null),at=$6ed0406888f73fc4$export$c7b2cbe3552a0d05(g,Tt=>st(Tt)),vt=reactExports.useMemo(()=>et?b().findIndex(Tt=>Tt.ref.current===et):-1,[b,et]);return reactExports.createElement($faa2e61a3361514f$var$SliderThumbImpl,_extends$1({},d,{ref:at,index:vt}))}),$faa2e61a3361514f$var$SliderThumbImpl=reactExports.forwardRef((d,g)=>{const{__scopeSlider:b,index:et,...st}=d,at=$faa2e61a3361514f$var$useSliderContext($faa2e61a3361514f$var$THUMB_NAME,b),vt=$faa2e61a3361514f$var$useSliderOrientationContext($faa2e61a3361514f$var$THUMB_NAME,b),[Tt,Ct]=reactExports.useState(null),pt=$6ed0406888f73fc4$export$c7b2cbe3552a0d05(g,Ht=>Ct(Ht)),wt=$db6c3485150b8e66$export$1ab7ae714698c4b8(Tt),$t=at.values[et],Lt=$t===void 0?0:$faa2e61a3361514f$var$convertValueToPercentage($t,at.min,at.max),jt=$faa2e61a3361514f$var$getLabel(et,at.values.length),Ft=wt==null?void 0:wt[vt.size],Gt=Ft?$faa2e61a3361514f$var$getThumbInBoundsOffset(Ft,Lt,vt.direction):0;return reactExports.useEffect(()=>{if(Tt)return at.thumbs.add(Tt),()=>{at.thumbs.delete(Tt)}},[Tt,at.thumbs]),reactExports.createElement("span",{style:{transform:"var(--radix-slider-thumb-transform)",position:"absolute",[vt.startEdge]:`calc(${Lt}% + ${Gt}px)`}},reactExports.createElement($faa2e61a3361514f$var$Collection.ItemSlot,{scope:d.__scopeSlider},reactExports.createElement($8927f6f2acc4f386$export$250ffa63cdc0d034.span,_extends$1({role:"slider","aria-label":d["aria-label"]||jt,"aria-valuemin":at.min,"aria-valuenow":$t,"aria-valuemax":at.max,"aria-orientation":at.orientation,"data-orientation":at.orientation,"data-disabled":at.disabled?"":void 0,tabIndex:at.disabled?void 0:0},st,{ref:pt,style:$t===void 0?{display:"none"}:d.style,onFocus:$e42e1063c40fb3ef$export$b9ecd428b558ff10(d.onFocus,()=>{at.valueIndexToChangeRef.current=et})}))))}),$faa2e61a3361514f$var$BubbleInput=d=>{const{value:g,...b}=d,et=reactExports.useRef(null),st=$010c2913dbd2fe3d$export$5cae361ad82dce8b(g);return reactExports.useEffect(()=>{const at=et.current,vt=window.HTMLInputElement.prototype,Ct=Object.getOwnPropertyDescriptor(vt,"value").set;if(st!==g&&Ct){const pt=new Event("input",{bubbles:!0});Ct.call(at,g),at.dispatchEvent(pt)}},[st,g]),reactExports.createElement("input",_extends$1({style:{display:"none"}},b,{ref:et,defaultValue:g}))};function $faa2e61a3361514f$var$getNextSortedValues(d=[],g,b){const et=[...d];return et[b]=g,et.sort((st,at)=>st-at)}function $faa2e61a3361514f$var$convertValueToPercentage(d,g,b){const at=100/(b-g)*(d-g);return $ae6933e535247d3d$export$7d15b64cf5a3a4c4(at,[0,100])}function $faa2e61a3361514f$var$getLabel(d,g){return g>2?`Value ${d+1} of ${g}`:g===2?["Minimum","Maximum"][d]:void 0}function $faa2e61a3361514f$var$getClosestValueIndex(d,g){if(d.length===1)return 0;const b=d.map(st=>Math.abs(st-g)),et=Math.min(...b);return b.indexOf(et)}function $faa2e61a3361514f$var$getThumbInBoundsOffset(d,g,b){const et=d/2,at=$faa2e61a3361514f$var$linearScale([0,50],[0,et]);return(et-at(g)*b)*b}function $faa2e61a3361514f$var$getStepsBetweenValues(d){return d.slice(0,-1).map((g,b)=>d[b+1]-g)}function $faa2e61a3361514f$var$hasMinStepsBetweenValues(d,g){if(g>0){const b=$faa2e61a3361514f$var$getStepsBetweenValues(d);return Math.min(...b)>=g}return!0}function $faa2e61a3361514f$var$linearScale(d,g){return b=>{if(d[0]===d[1]||g[0]===g[1])return g[0];const et=(g[1]-g[0])/(d[1]-d[0]);return g[0]+et*(b-d[0])}}function $faa2e61a3361514f$var$getDecimalCount(d){return(String(d).split(".")[1]||"").length}function $faa2e61a3361514f$var$roundValue(d,g){const b=Math.pow(10,g);return Math.round(d*b)/b}const $faa2e61a3361514f$export$be92b6f5f03c0fe9=$faa2e61a3361514f$export$472062a354075cee,$faa2e61a3361514f$export$13921ac0cc260818=$faa2e61a3361514f$export$105594979f116971,$faa2e61a3361514f$export$9a58ef0d7ad3278c=$faa2e61a3361514f$export$a5cf38a7a000fe77,$faa2e61a3361514f$export$6521433ed15a34db=$faa2e61a3361514f$export$2c1b491743890dec,Slider=reactExports.forwardRef(({className:d,...g},b)=>jsxRuntimeExports.jsxs($faa2e61a3361514f$export$be92b6f5f03c0fe9,{ref:b,className:cn$1("relative flex w-full touch-none select-none items-center",d),tabIndex:-1,...g,children:[jsxRuntimeExports.jsx($faa2e61a3361514f$export$13921ac0cc260818,{className:"relative h-1.5 w-full grow overflow-hidden rounded-full bg-primary/20 data-[disabled]:cursor-not-allowed data-[disabled]:opacity-50",children:jsxRuntimeExports.jsx($faa2e61a3361514f$export$9a58ef0d7ad3278c,{className:"absolute h-full bg-primary data-[disabled]:cursor-not-allowed "})}),jsxRuntimeExports.jsx($faa2e61a3361514f$export$6521433ed15a34db,{tabIndex:-1,className:"block h-4 w-4 rounded-full border border-primary/60 bg-background shadow transition-colors focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring data-[disabled]:cursor-not-allowed"})]}));Slider.displayName=$faa2e61a3361514f$export$be92b6f5f03c0fe9.displayName;const DOC_MOVE_OPTS$1={capture:!0,passive:!1},DRAG_HANDLE_BORDER$1=2,clamp$1=(d,g,b,et,st,at)=>{if(d!==b&&g===et){if(d<0)return[0,et];if(d+g>at)return[at-et,et]}else{if(g<st)return d===b?[d,st]:[d+g-st,st];if(d<0)return[0,d+g];if(d+g>at)return[d,at-d]}return[d,g]},Cropper=d=>{const{minHeight:g,minWidth:b,maxHeight:et,maxWidth:st,scale:at,show:vt}=d,[Tt,Ct,pt,wt,{x:$t,y:Lt,width:jt,height:Ft},Gt,Ht,qt,Kt,rr,ir]=useStore(Ro=>[Ro.imageWidth,Ro.imageHeight,Ro.isInpainting,Ro.isSD(),Ro.cropperState,Ro.setCropperX,Ro.setCropperY,Ro.setCropperWidth,Ro.setCropperHeight,Ro.isCropperExtenderResizing,Ro.setIsCropperExtenderResizing]),[or,jr]=reactExports.useState(!1);reactExports.useEffect(()=>{Gt(Math.round((st-512)/2)),Ht(Math.round((et-512)/2))},[et,st,Tt,Ct]);const[qr,Yr]=reactExports.useState({initX:0,initY:0,initHeight:0,initWidth:0,startResizeX:0,startResizeY:0,ord:"top"}),vn=()=>{},ko=(Ro,Sn)=>clamp$1(Ro,Sn,$t,jt,b,st),Xo=(Ro,Sn)=>clamp$1(Ro,Sn,Lt,Ft,g,et),zo=Ro=>{if(pt)return;const Sn=Ro.clientX,Tn=Ro.clientY,n0=Math.round((Tn-qr.startResizeY)/at),Go=Math.round((Sn-qr.startResizeX)/at),An=()=>{const f0=qr.initHeight-n0,y0=qr.initY+n0,[b0,O0]=Xo(y0,f0);Kt(O0),Ht(b0)},a0=()=>{const f0=qr.initHeight+n0,[y0,b0]=Xo(qr.initY,f0);Kt(b0),Ht(y0)},u0=()=>{const f0=qr.initWidth-Go,y0=qr.initX+Go,[b0,O0]=ko(y0,f0);qt(O0),Gt(b0)},d0=()=>{const f0=qr.initWidth+Go,[y0,b0]=ko(qr.initX,f0);qt(b0),Gt(y0)};if(rr)switch(qr.ord){case"topleft":{An(),u0();break}case"topright":{An(),d0();break}case"bottomleft":{a0(),u0();break}case"bottomright":{a0(),d0();break}case"top":{An();break}case"right":{d0();break}case"bottom":{a0();break}case"left":{u0();break}}if(or){const f0=qr.initX+Go,y0=qr.initY+n0,[b0,O0]=ko(f0,qr.initWidth),[C0,v0]=Xo(y0,qr.initHeight);qt(O0),Kt(v0),Gt(b0),Ht(C0)}},t0=()=>{rr&&ir(!1),or&&jr(!1)};reactExports.useEffect(()=>{if(rr||or)return document.addEventListener("pointermove",zo,DOC_MOVE_OPTS$1),document.addEventListener("pointerup",t0,DOC_MOVE_OPTS$1),document.addEventListener("pointercancel",t0,DOC_MOVE_OPTS$1),()=>{document.removeEventListener("pointermove",zo,DOC_MOVE_OPTS$1),document.removeEventListener("pointerup",t0,DOC_MOVE_OPTS$1),document.removeEventListener("pointercancel",t0,DOC_MOVE_OPTS$1)}},[rr,or,jt,Ft,qr]);const Uo=Ro=>{const{ord:Sn}=Ro.target.dataset;Sn&&(ir(!0),Yr({initX:$t,initY:Lt,initHeight:Ft,initWidth:jt,startResizeX:Ro.clientX,startResizeY:Ro.clientY,ord:Sn}))},No=(Ro,Sn,Tn)=>{const An="w-[12px] h-[12px] z-[4] absolute content-[''] block border-2 border-primary borde pointer-events-auto hover:bg-primary";let a0="0",u0="0",d0=Tn,f0="-6px";return Tn===""&&(f0="50%",Sn==="left"||Sn==="right"?(d0="top",u0="-50%"):(d0="left",a0="-50%")),jsxRuntimeExports.jsx("div",{className:cn$1(An,Ro),style:{[Sn]:-6,[d0]:f0,transform:`translate(${a0}, ${u0}) scale(${1/at})`},"data-ord":Sn+Tn,"aria-label":Sn+Tn,tabIndex:-1,role:"button"})},_n=()=>jsxRuntimeExports.jsxs("div",{onFocus:vn,onPointerDown:Uo,className:"absolute top-0 h-full w-full",children:[jsxRuntimeExports.jsx("div",{className:"absolute pointer-events-auto top-0 left-0 w-full cursor-ns-resize h-[12px] mt-[-6px]","data-ord":"top"}),jsxRuntimeExports.jsx("div",{className:"absolute pointer-events-auto top-0 right-0 h-full cursor-ew-resize w-[12px] mr-[-6px]","data-ord":"right"}),jsxRuntimeExports.jsx("div",{className:"absolute pointer-events-auto bottom-0 left-0 w-full cursor-ns-resize h-[12px] mb-[-6px]","data-ord":"bottom"}),jsxRuntimeExports.jsx("div",{className:"absolute pointer-events-auto top-0 left-0 h-full cursor-ew-resize w-[12px] ml-[-6px]","data-ord":"left"}),No("cursor-nw-resize","top","left"),No("cursor-ne-resize","top","right"),No("cursor-sw-resize","bottom","left"),No("cursor-se-resize","bottom","right"),No("cursor-ns-resize","top",""),No("cursor-ns-resize","bottom",""),No("cursor-ew-resize","left",""),No("cursor-ew-resize","right","")]}),Kr=Ro=>{jr(!0),Yr({initX:$t,initY:Lt,initHeight:Ft,initWidth:jt,startResizeX:Ro.clientX,startResizeY:Ro.clientY,ord:""})},e0=()=>jsxRuntimeExports.jsxs("div",{className:twMerge("border absolute pointer-events-auto px-2 py-1 rounded-full hover:cursor-move bg-background","origin-top-left top-0 left-0"),style:{transform:`scale(${1/at*.8})`},onPointerDown:Kr,children:[jt," x ",Ft]}),Zr=()=>jsxRuntimeExports.jsx("div",{className:"outline-dashed outline-primary",style:{height:Ft,width:jt,outlineWidth:`${DRAG_HANDLE_BORDER$1/at*1.3}px`}});return vt===!1||!wt?null:jsxRuntimeExports.jsx("div",{className:"absolute h-full w-full overflow-hidden pointer-events-none z-[2]",children:jsxRuntimeExports.jsxs("div",{className:"relative pointer-events-none z-[2] [box-shadow:0_0_0_9999px_rgba(0,_0,_0,_0.5)]",style:{height:Ft,width:jt,left:$t,top:Lt},children:[Zr(),e0(),_n()]})})},Item=d=>{const{x:g,y:b,positive:et}=d,st=et?"bg-[rgba(21,_215,_121,_0.936)] outline-[rgba(98,255,179,0.31)]":"bg-[rgba(237,_49,_55,_0.942)] outline-[rgba(255,89,95,0.31)]";return jsxRuntimeExports.jsx("div",{className:`absolute h-[10px] w-[10px] rounded-[50%] ${st} outline-8 outline`,style:{left:g,top:b,transform:"translate(-50%, -50%)"}})},InteractiveSegPoints=()=>{const d=useStore(g=>g.interactiveSegState.clicks);return jsxRuntimeExports.jsx("div",{className:"absolute h-full w-full overflow-hidden pointer-events-none",children:d.map(g=>jsxRuntimeExports.jsx(Item,{x:g[0],y:g[1],positive:g[2]===1},g[3]))})},DOC_MOVE_OPTS={capture:!0,passive:!1},DRAG_HANDLE_BORDER=2,clamp=(d,g,b,et)=>g<et?d===b?[d,et]:[d+g-et,et]:[d,g],Extender=d=>{const{minHeight:g,minWidth:b,scale:et,show:st}=d,[at,vt,Tt,Ct,{x:pt,y:wt,width:$t,height:Lt},jt,Ft,Gt,Ht,qt,Kt,rr]=useStore(Kr=>[Kr.isInpainting,Kr.imageHeight,Kr.imageWidth,Kr.isSD(),Kr.extenderState,Kr.setExtenderX,Kr.setExtenderY,Kr.setExtenderWidth,Kr.setExtenderHeight,Kr.settings.extenderDirection,Kr.isCropperExtenderResizing,Kr.setIsCropperExtenderResizing]),[ir,or]=reactExports.useState({initX:0,initY:0,initHeight:0,initWidth:0,startResizeX:0,startResizeY:0,ord:"top"}),jr=()=>{},qr=(Kr,e0)=>clamp(Kr,e0,pt,b),Yr=(Kr,e0)=>clamp(Kr,e0,wt,g),vn=Kr=>{if(at)return;const e0=Kr.clientX,Zr=Kr.clientY,Ro=Math.round((Zr-ir.startResizeY)/et),Sn=Math.round((e0-ir.startResizeX)/et),Tn=()=>{const a0=ir.initHeight-Ro,u0=ir.initY+Ro;let d0=u0,f0=a0;if(qt===ExtenderDirection.xy)d0>0&&(d0=0,f0=ir.initHeight-Math.abs(ir.initY));else{const y0=Yr(u0,a0);d0=y0[0],f0=y0[1]}Ht(f0),Ft(d0)},n0=()=>{const a0=ir.initHeight+Ro;let[u0,d0]=Yr(ir.initY,a0);qt===ExtenderDirection.xy&&d0<Math.abs(u0)+vt&&(d0=Math.abs(u0)+vt),Ht(d0),Ft(u0)},Go=()=>{const a0=ir.initWidth-Sn,u0=ir.initX+Sn;let d0=u0,f0=a0;if(qt===ExtenderDirection.xy)d0>0&&(d0=0,f0=ir.initWidth-Math.abs(ir.initX));else{const y0=qr(u0,a0);d0=y0[0],f0=y0[1]}Gt(f0),jt(d0)},An=()=>{const a0=ir.initWidth+Sn;let[u0,d0]=qr(ir.initX,a0);qt===ExtenderDirection.xy&&d0<Math.abs(u0)+Tt&&(d0=Math.abs(u0)+Tt),Gt(d0),jt(u0)};if(Kt)switch(ir.ord){case"topleft":{Tn(),Go();break}case"topright":{Tn(),An();break}case"bottomleft":{n0(),Go();break}case"bottomright":{n0(),An();break}case"top":{Tn();break}case"right":{An();break}case"bottom":{n0();break}case"left":{Go();break}}},ko=()=>{Kt&&rr(!1)};reactExports.useEffect(()=>{if(Kt)return document.addEventListener("pointermove",vn,DOC_MOVE_OPTS),document.addEventListener("pointerup",ko,DOC_MOVE_OPTS),document.addEventListener("pointercancel",ko,DOC_MOVE_OPTS),()=>{document.removeEventListener("pointermove",vn,DOC_MOVE_OPTS),document.removeEventListener("pointerup",ko,DOC_MOVE_OPTS),document.removeEventListener("pointercancel",ko,DOC_MOVE_OPTS)}},[Kt,$t,Lt,ir]);const Xo=Kr=>{const{ord:e0}=Kr.target.dataset;e0&&(rr(!0),or({initX:pt,initY:wt,initHeight:Lt,initWidth:$t,startResizeX:Kr.clientX,startResizeY:Kr.clientY,ord:e0}))},zo=(Kr,e0,Zr)=>{const Tn="w-[12px] h-[12px] z-[4] absolute content-[''] block border-2 border-primary borde pointer-events-auto hover:bg-primary";let n0="0",Go="0",An=Zr,a0="-6px";return Zr===""&&(a0="50%",e0==="left"||e0==="right"?(An="top",Go="-50%"):(An="left",n0="-50%")),jsxRuntimeExports.jsx("div",{className:cn$1(Tn,Kr),style:{[e0]:-6,[An]:a0,transform:`translate(${n0}, ${Go}) scale(${1/et})`},"data-ord":e0+Zr,"aria-label":e0+Zr,tabIndex:-1,role:"button"})},t0=()=>jsxRuntimeExports.jsxs("div",{onFocus:jr,onPointerDown:Xo,className:"absolute top-0 h-full w-full",children:[[ExtenderDirection.y,ExtenderDirection.xy].includes(qt)?jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx("div",{className:"absolute pointer-events-auto top-0 left-0 w-full cursor-ns-resize h-[12px] mt-[-6px]","data-ord":"top"}),jsxRuntimeExports.jsx("div",{className:"absolute pointer-events-auto bottom-0 left-0 w-full cursor-ns-resize h-[12px] mb-[-6px]","data-ord":"bottom"}),zo("cursor-ns-resize","top",""),zo("cursor-ns-resize","bottom","")]}):jsxRuntimeExports.jsx(jsxRuntimeExports.Fragment,{}),[ExtenderDirection.x,ExtenderDirection.xy].includes(qt)?jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx("div",{className:"absolute pointer-events-auto top-0 right-0 h-full cursor-ew-resize w-[12px] mr-[-6px]","data-ord":"right"}),jsxRuntimeExports.jsx("div",{className:"absolute pointer-events-auto top-0 left-0 h-full cursor-ew-resize w-[12px] ml-[-6px]","data-ord":"left"}),zo("cursor-ew-resize","left",""),zo("cursor-ew-resize","right","")]}):jsxRuntimeExports.jsx(jsxRuntimeExports.Fragment,{}),qt===ExtenderDirection.xy?jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[zo("cursor-nw-resize","top","left"),zo("cursor-ne-resize","top","right"),zo("cursor-sw-resize","bottom","left"),zo("cursor-se-resize","bottom","right")]}):jsxRuntimeExports.jsx(jsxRuntimeExports.Fragment,{})]}),Uo=Kr=>{or({initX:pt,initY:wt,initHeight:Lt,initWidth:$t,startResizeX:Kr.clientX,startResizeY:Kr.clientY,ord:""})},No=()=>jsxRuntimeExports.jsxs("div",{className:twMerge("border absolute pointer-events-auto px-2 py-1 rounded-full bg-background","origin-top-left top-0 left-0"),style:{transform:`scale(${1/et*.8})`},onPointerDown:Uo,children:[$t," x ",Lt]}),_n=()=>jsxRuntimeExports.jsx("div",{className:cn$1("outline-dashed outline-primary"),style:{height:Lt,width:$t,outlineWidth:`${DRAG_HANDLE_BORDER/et*1.3}px`}});return st===!1||!Ct?null:jsxRuntimeExports.jsx("div",{className:"absolute h-full w-full pointer-events-none z-[2]",children:jsxRuntimeExports.jsxs("div",{className:"relative pointer-events-none z-[2] [box-shadow:0_0_0_9999px_rgba(0,_0,_0,_0.5)]",style:{height:Lt,width:$t,left:pt,top:wt},children:[_n(),No(),t0()]})})};function iota$1(d){for(var g=new Array(d),b=0;b<d;++b)g[b]=b;return g}var iota_1=iota$1;/*!
 * Determine if an object is a Buffer
 *
 * @author   Feross Aboukhadijeh <https://feross.org>
 * @license  MIT
 */var isBuffer_1=function(d){return d!=null&&(isBuffer$1(d)||isSlowBuffer(d)||!!d._isBuffer)};function isBuffer$1(d){return!!d.constructor&&typeof d.constructor.isBuffer=="function"&&d.constructor.isBuffer(d)}function isSlowBuffer(d){return typeof d.readFloatLE=="function"&&typeof d.slice=="function"&&isBuffer$1(d.slice(0,0))}var iota=iota_1,isBuffer=isBuffer_1,hasTypedArrays=typeof Float64Array<"u";function compare1st(d,g){return d[0]-g[0]}function order(){var d=this.stride,g=new Array(d.length),b;for(b=0;b<g.length;++b)g[b]=[Math.abs(d[b]),b];g.sort(compare1st);var et=new Array(g.length);for(b=0;b<et.length;++b)et[b]=g[b][1];return et}function compileConstructor(d,g){var b=["View",g,"d",d].join("");g<0&&(b="View_Nil"+d);var et=d==="generic";if(g===-1){var st="function "+b+"(a){this.data=a;};var proto="+b+".prototype;proto.dtype='"+d+"';proto.index=function(){return -1};proto.size=0;proto.dimension=-1;proto.shape=proto.stride=proto.order=[];proto.lo=proto.hi=proto.transpose=proto.step=function(){return new "+b+"(this.data);};proto.get=proto.set=function(){};proto.pick=function(){return null};return function construct_"+b+"(a){return new "+b+"(a);}",Gt=new Function(st);return Gt()}else if(g===0){var st="function "+b+"(a,d) {this.data = a;this.offset = d};var proto="+b+".prototype;proto.dtype='"+d+"';proto.index=function(){return this.offset};proto.dimension=0;proto.size=1;proto.shape=proto.stride=proto.order=[];proto.lo=proto.hi=proto.transpose=proto.step=function "+b+"_copy() {return new "+b+"(this.data,this.offset)};proto.pick=function "+b+"_pick(){return TrivialArray(this.data);};proto.valueOf=proto.get=function "+b+"_get(){return "+(et?"this.data.get(this.offset)":"this.data[this.offset]")+"};proto.set=function "+b+"_set(v){return "+(et?"this.data.set(this.offset,v)":"this.data[this.offset]=v")+"};return function construct_"+b+"(a,b,c,d){return new "+b+"(a,d)}",Gt=new Function("TrivialArray",st);return Gt(CACHED_CONSTRUCTORS[d][0])}var st=["'use strict'"],at=iota(g),vt=at.map(function(Ht){return"i"+Ht}),Tt="this.offset+"+at.map(function(Ht){return"this.stride["+Ht+"]*i"+Ht}).join("+"),Ct=at.map(function(Ht){return"b"+Ht}).join(","),pt=at.map(function(Ht){return"c"+Ht}).join(",");st.push("function "+b+"(a,"+Ct+","+pt+",d){this.data=a","this.shape=["+Ct+"]","this.stride=["+pt+"]","this.offset=d|0}","var proto="+b+".prototype","proto.dtype='"+d+"'","proto.dimension="+g),st.push("Object.defineProperty(proto,'size',{get:function "+b+"_size(){return "+at.map(function(Ht){return"this.shape["+Ht+"]"}).join("*"),"}})"),g===1?st.push("proto.order=[0]"):(st.push("Object.defineProperty(proto,'order',{get:"),g<4?(st.push("function "+b+"_order(){"),g===2?st.push("return (Math.abs(this.stride[0])>Math.abs(this.stride[1]))?[1,0]:[0,1]}})"):g===3&&st.push("var s0=Math.abs(this.stride[0]),s1=Math.abs(this.stride[1]),s2=Math.abs(this.stride[2]);if(s0>s1){if(s1>s2){return [2,1,0];}else if(s0>s2){return [1,2,0];}else{return [1,0,2];}}else if(s0>s2){return [2,0,1];}else if(s2>s1){return [0,1,2];}else{return [0,2,1];}}})")):st.push("ORDER})")),st.push("proto.set=function "+b+"_set("+vt.join(",")+",v){"),et?st.push("return this.data.set("+Tt+",v)}"):st.push("return this.data["+Tt+"]=v}"),st.push("proto.get=function "+b+"_get("+vt.join(",")+"){"),et?st.push("return this.data.get("+Tt+")}"):st.push("return this.data["+Tt+"]}"),st.push("proto.index=function "+b+"_index(",vt.join(),"){return "+Tt+"}"),st.push("proto.hi=function "+b+"_hi("+vt.join(",")+"){return new "+b+"(this.data,"+at.map(function(Ht){return["(typeof i",Ht,"!=='number'||i",Ht,"<0)?this.shape[",Ht,"]:i",Ht,"|0"].join("")}).join(",")+","+at.map(function(Ht){return"this.stride["+Ht+"]"}).join(",")+",this.offset)}");var wt=at.map(function(Ht){return"a"+Ht+"=this.shape["+Ht+"]"}),$t=at.map(function(Ht){return"c"+Ht+"=this.stride["+Ht+"]"});st.push("proto.lo=function "+b+"_lo("+vt.join(",")+"){var b=this.offset,d=0,"+wt.join(",")+","+$t.join(","));for(var Lt=0;Lt<g;++Lt)st.push("if(typeof i"+Lt+"==='number'&&i"+Lt+">=0){d=i"+Lt+"|0;b+=c"+Lt+"*d;a"+Lt+"-=d}");st.push("return new "+b+"(this.data,"+at.map(function(Ht){return"a"+Ht}).join(",")+","+at.map(function(Ht){return"c"+Ht}).join(",")+",b)}"),st.push("proto.step=function "+b+"_step("+vt.join(",")+"){var "+at.map(function(Ht){return"a"+Ht+"=this.shape["+Ht+"]"}).join(",")+","+at.map(function(Ht){return"b"+Ht+"=this.stride["+Ht+"]"}).join(",")+",c=this.offset,d=0,ceil=Math.ceil");for(var Lt=0;Lt<g;++Lt)st.push("if(typeof i"+Lt+"==='number'){d=i"+Lt+"|0;if(d<0){c+=b"+Lt+"*(a"+Lt+"-1);a"+Lt+"=ceil(-a"+Lt+"/d)}else{a"+Lt+"=ceil(a"+Lt+"/d)}b"+Lt+"*=d}");st.push("return new "+b+"(this.data,"+at.map(function(Ht){return"a"+Ht}).join(",")+","+at.map(function(Ht){return"b"+Ht}).join(",")+",c)}");for(var jt=new Array(g),Ft=new Array(g),Lt=0;Lt<g;++Lt)jt[Lt]="a[i"+Lt+"]",Ft[Lt]="b[i"+Lt+"]";st.push("proto.transpose=function "+b+"_transpose("+vt+"){"+vt.map(function(Ht,qt){return Ht+"=("+Ht+"===undefined?"+qt+":"+Ht+"|0)"}).join(";"),"var a=this.shape,b=this.stride;return new "+b+"(this.data,"+jt.join(",")+","+Ft.join(",")+",this.offset)}"),st.push("proto.pick=function "+b+"_pick("+vt+"){var a=[],b=[],c=this.offset");for(var Lt=0;Lt<g;++Lt)st.push("if(typeof i"+Lt+"==='number'&&i"+Lt+">=0){c=(c+this.stride["+Lt+"]*i"+Lt+")|0}else{a.push(this.shape["+Lt+"]);b.push(this.stride["+Lt+"])}");st.push("var ctor=CTOR_LIST[a.length+1];return ctor(this.data,a,b,c)}"),st.push("return function construct_"+b+"(data,shape,stride,offset){return new "+b+"(data,"+at.map(function(Ht){return"shape["+Ht+"]"}).join(",")+","+at.map(function(Ht){return"stride["+Ht+"]"}).join(",")+",offset)}");var Gt=new Function("CTOR_LIST","ORDER",st.join(`
`));return Gt(CACHED_CONSTRUCTORS[d],order)}function arrayDType(d){if(isBuffer(d))return"buffer";if(hasTypedArrays)switch(Object.prototype.toString.call(d)){case"[object Float64Array]":return"float64";case"[object Float32Array]":return"float32";case"[object Int8Array]":return"int8";case"[object Int16Array]":return"int16";case"[object Int32Array]":return"int32";case"[object Uint8Array]":return"uint8";case"[object Uint16Array]":return"uint16";case"[object Uint32Array]":return"uint32";case"[object Uint8ClampedArray]":return"uint8_clamped";case"[object BigInt64Array]":return"bigint64";case"[object BigUint64Array]":return"biguint64"}return Array.isArray(d)?"array":"generic"}var CACHED_CONSTRUCTORS={float32:[],float64:[],int8:[],int16:[],int32:[],uint8:[],uint16:[],uint32:[],array:[],uint8_clamped:[],bigint64:[],biguint64:[],buffer:[],generic:[]};function wrappedNDArrayCtor(d,g,b,et){if(d===void 0){var pt=CACHED_CONSTRUCTORS.array[0];return pt([])}else typeof d=="number"&&(d=[d]);g===void 0&&(g=[d.length]);var st=g.length;if(b===void 0){b=new Array(st);for(var at=st-1,vt=1;at>=0;--at)b[at]=vt,vt*=g[at]}if(et===void 0){et=0;for(var at=0;at<st;++at)b[at]<0&&(et-=(g[at]-1)*b[at])}for(var Tt=arrayDType(d),Ct=CACHED_CONSTRUCTORS[Tt];Ct.length<=st+1;)Ct.push(compileConstructor(Tt,Ct.length-1));var pt=Ct[st+1];return pt(d,g,b,et)}var ndarray=wrappedNDArrayCtor;const ndarray4=getDefaultExportFromCjs(ndarray);/*!
 * ONNX Runtime Web v1.18.0
 * Copyright (c) Microsoft Corporation. All rights reserved.
 * Licensed under the MIT License.
 */var vd$1=Object.create,Pn$1=Object.defineProperty,_d$1=Object.getOwnPropertyDescriptor,Od$1=Object.getOwnPropertyNames,Id$1=Object.getPrototypeOf,Sd$1=Object.prototype.hasOwnProperty,L$1=(d,g)=>()=>(d&&(g=d(d=0)),g),me=(d,g)=>()=>(g||d((g={exports:{}}).exports,g),g.exports),Sr=(d,g)=>{for(var b in g)Pn$1(d,b,{get:g[b],enumerable:!0})},Va$1=(d,g,b,et)=>{if(g&&typeof g=="object"||typeof g=="function")for(let st of Od$1(g))!Sd$1.call(d,st)&&st!==b&&Pn$1(d,st,{get:()=>g[st],enumerable:!(et=_d$1(g,st))||et.enumerable});return d},Ar=(d,g,b)=>(b=d!=null?vd$1(Id$1(d)):{},Va$1(!d||!d.__esModule?Pn$1(b,"default",{value:d,enumerable:!0}):b,d)),ar=d=>Va$1(Pn$1({},"__esModule",{value:!0}),d),En,sr$1,Pr$1,Ad$1,Dn$1,Ln$1=L$1(()=>{En=new Map,sr$1=[],Pr$1=(d,g,b)=>{if(g&&typeof g.init=="function"&&typeof g.createInferenceSessionHandler=="function"){let et=En.get(d);if(et===void 0)En.set(d,{backend:g,priority:b});else{if(et.priority>b)return;if(et.priority===b&&et.backend!==g)throw new Error(`cannot register backend "${d}" using priority ${b}`)}if(b>=0){let st=sr$1.indexOf(d);st!==-1&&sr$1.splice(st,1);for(let at=0;at<sr$1.length;at++)if(En.get(sr$1[at]).priority<=b){sr$1.splice(at,0,d);return}sr$1.push(d)}return}throw new TypeError("not a valid backend")},Ad$1=async d=>{let g=En.get(d);if(!g)return"backend not found.";if(g.initialized)return g.backend;if(g.aborted)return g.error;{let b=!!g.initPromise;try{return b||(g.initPromise=g.backend.init(d)),await g.initPromise,g.initialized=!0,g.backend}catch(et){return b||(g.error=`${et}`,g.aborted=!0),g.error}finally{delete g.initPromise}}},Dn$1=async d=>{let g=d.executionProviders||[],b=g.map(Ct=>typeof Ct=="string"?Ct:Ct.name),et=b.length===0?sr$1:b,st,at=[],vt=new Set;for(let Ct of et){let pt=await Ad$1(Ct);typeof pt=="string"?at.push({name:Ct,err:pt}):(st||(st=pt),st===pt&&vt.add(Ct))}if(!st)throw new Error(`no available backend found. ERR: ${at.map(Ct=>`[${Ct.name}] ${Ct.err}`).join(", ")}`);for(let{name:Ct,err:pt}of at)b.includes(Ct)&&console.warn(`removing requested execution provider "${Ct}" from session options because it is not available: ${pt}`);let Tt=g.filter(Ct=>vt.has(typeof Ct=="string"?Ct:Ct.name));return[st,new Proxy(d,{get:(Ct,pt)=>pt==="executionProviders"?Tt:Reflect.get(Ct,pt)})]}}),Wa=L$1(()=>{Ln$1()}),Ha$1,qa$1=L$1(()=>{Ha$1="1.18.0"}),ja$1,ut$1,Vo=L$1(()=>{qa$1(),ja$1="warning",ut$1={wasm:{},webgl:{},webgpu:{},versions:{common:Ha$1},set logLevel(d){if(d!==void 0){if(typeof d!="string"||["verbose","info","warning","error","fatal"].indexOf(d)===-1)throw new Error(`Unsupported logging level: ${d}`);ja$1=d}},get logLevel(){return ja$1}},Object.defineProperty(ut$1,"logLevel",{enumerable:!0})}),Z,Ya$1=L$1(()=>{Vo(),Z=ut$1}),Xa$1,Ka$1,Ja$1=L$1(()=>{Xa$1=(d,g)=>{let b=typeof document<"u"?document.createElement("canvas"):new OffscreenCanvas(1,1);b.width=d.dims[3],b.height=d.dims[2];let et=b.getContext("2d");if(et!=null){let st,at;(g==null?void 0:g.tensorLayout)!==void 0&&g.tensorLayout==="NHWC"?(st=d.dims[2],at=d.dims[3]):(st=d.dims[3],at=d.dims[2]);let vt=(g==null?void 0:g.format)!==void 0?g.format:"RGB",Tt=g==null?void 0:g.norm,Ct,pt;Tt===void 0||Tt.mean===void 0?Ct=[255,255,255,255]:typeof Tt.mean=="number"?Ct=[Tt.mean,Tt.mean,Tt.mean,Tt.mean]:(Ct=[Tt.mean[0],Tt.mean[1],Tt.mean[2],0],Tt.mean[3]!==void 0&&(Ct[3]=Tt.mean[3])),Tt===void 0||Tt.bias===void 0?pt=[0,0,0,0]:typeof Tt.bias=="number"?pt=[Tt.bias,Tt.bias,Tt.bias,Tt.bias]:(pt=[Tt.bias[0],Tt.bias[1],Tt.bias[2],0],Tt.bias[3]!==void 0&&(pt[3]=Tt.bias[3]));let wt=at*st,$t=0,Lt=wt,jt=wt*2,Ft=-1;vt==="RGBA"?($t=0,Lt=wt,jt=wt*2,Ft=wt*3):vt==="RGB"?($t=0,Lt=wt,jt=wt*2):vt==="RBG"&&($t=0,jt=wt,Lt=wt*2);for(let Gt=0;Gt<at;Gt++)for(let Ht=0;Ht<st;Ht++){let qt=(d.data[$t++]-pt[0])*Ct[0],Kt=(d.data[Lt++]-pt[1])*Ct[1],rr=(d.data[jt++]-pt[2])*Ct[2],ir=Ft===-1?255:(d.data[Ft++]-pt[3])*Ct[3];et.fillStyle="rgba("+qt+","+Kt+","+rr+","+ir+")",et.fillRect(Ht,Gt,1,1)}if("toDataURL"in b)return b.toDataURL();throw new Error("toDataURL is not supported")}else throw new Error("Can not access image data")},Ka$1=(d,g)=>{let b=typeof document<"u"?document.createElement("canvas").getContext("2d"):new OffscreenCanvas(1,1).getContext("2d"),et;if(b!=null){let st,at,vt;(g==null?void 0:g.tensorLayout)!==void 0&&g.tensorLayout==="NHWC"?(st=d.dims[2],at=d.dims[1],vt=d.dims[3]):(st=d.dims[3],at=d.dims[2],vt=d.dims[1]);let Tt=g!==void 0&&g.format!==void 0?g.format:"RGB",Ct=g==null?void 0:g.norm,pt,wt;Ct===void 0||Ct.mean===void 0?pt=[255,255,255,255]:typeof Ct.mean=="number"?pt=[Ct.mean,Ct.mean,Ct.mean,Ct.mean]:(pt=[Ct.mean[0],Ct.mean[1],Ct.mean[2],255],Ct.mean[3]!==void 0&&(pt[3]=Ct.mean[3])),Ct===void 0||Ct.bias===void 0?wt=[0,0,0,0]:typeof Ct.bias=="number"?wt=[Ct.bias,Ct.bias,Ct.bias,Ct.bias]:(wt=[Ct.bias[0],Ct.bias[1],Ct.bias[2],0],Ct.bias[3]!==void 0&&(wt[3]=Ct.bias[3]));let $t=at*st;if(g!==void 0&&(g.format!==void 0&&vt===4&&g.format!=="RGBA"||vt===3&&g.format!=="RGB"&&g.format!=="BGR"))throw new Error("Tensor format doesn't match input tensor dims");let Lt=4,jt=0,Ft=1,Gt=2,Ht=3,qt=0,Kt=$t,rr=$t*2,ir=-1;Tt==="RGBA"?(qt=0,Kt=$t,rr=$t*2,ir=$t*3):Tt==="RGB"?(qt=0,Kt=$t,rr=$t*2):Tt==="RBG"&&(qt=0,rr=$t,Kt=$t*2),et=b.createImageData(st,at);for(let or=0;or<at*st;jt+=Lt,Ft+=Lt,Gt+=Lt,Ht+=Lt,or++)et.data[jt]=(d.data[qt++]-wt[0])*pt[0],et.data[Ft]=(d.data[Kt++]-wt[1])*pt[1],et.data[Gt]=(d.data[rr++]-wt[2])*pt[2],et.data[Ht]=ir===-1?255:(d.data[ir++]-wt[3])*pt[3]}else throw new Error("Can not access image data");return et}}),Wo,Za$1,Qa$1,es$1,ts$1,rs$1=L$1(()=>{Cn(),Wo=(d,g)=>{if(d===void 0)throw new Error("Image buffer must be defined");if(g.height===void 0||g.width===void 0)throw new Error("Image height and width must be defined");if(g.tensorLayout==="NHWC")throw new Error("NHWC Tensor layout is not supported yet");let{height:b,width:et}=g,st=g.norm??{mean:255,bias:0},at,vt;typeof st.mean=="number"?at=[st.mean,st.mean,st.mean,st.mean]:at=[st.mean[0],st.mean[1],st.mean[2],st.mean[3]??255],typeof st.bias=="number"?vt=[st.bias,st.bias,st.bias,st.bias]:vt=[st.bias[0],st.bias[1],st.bias[2],st.bias[3]??0];let Tt=g.format!==void 0?g.format:"RGBA",Ct=g.tensorFormat!==void 0&&g.tensorFormat!==void 0?g.tensorFormat:"RGB",pt=b*et,wt=Ct==="RGBA"?new Float32Array(pt*4):new Float32Array(pt*3),$t=4,Lt=0,jt=1,Ft=2,Gt=3,Ht=0,qt=pt,Kt=pt*2,rr=-1;Tt==="RGB"&&($t=3,Lt=0,jt=1,Ft=2,Gt=-1),Ct==="RGBA"?rr=pt*3:Ct==="RBG"?(Ht=0,Kt=pt,qt=pt*2):Ct==="BGR"&&(Kt=0,qt=pt,Ht=pt*2);for(let ir=0;ir<pt;ir++,Lt+=$t,Ft+=$t,jt+=$t,Gt+=$t)wt[Ht++]=(d[Lt]+vt[0])/at[0],wt[qt++]=(d[jt]+vt[1])/at[1],wt[Kt++]=(d[Ft]+vt[2])/at[2],rr!==-1&&Gt!==-1&&(wt[rr++]=(d[Gt]+vt[3])/at[3]);return Ct==="RGBA"?new Je("float32",wt,[1,4,b,et]):new Je("float32",wt,[1,3,b,et])},Za$1=async(d,g)=>{let b=typeof HTMLImageElement<"u"&&d instanceof HTMLImageElement,et=typeof ImageData<"u"&&d instanceof ImageData,st=typeof ImageBitmap<"u"&&d instanceof ImageBitmap,at=typeof d=="string",vt,Tt=g??{},Ct=()=>{if(typeof document<"u")return document.createElement("canvas");if(typeof OffscreenCanvas<"u")return new OffscreenCanvas(1,1);throw new Error("Canvas is not supported")},pt=wt=>wt instanceof HTMLCanvasElement||wt instanceof OffscreenCanvas?wt.getContext("2d"):null;if(b){let wt=Ct();wt.width=d.width,wt.height=d.height;let $t=pt(wt);if($t!=null){let Lt=d.height,jt=d.width;if(g!==void 0&&g.resizedHeight!==void 0&&g.resizedWidth!==void 0&&(Lt=g.resizedHeight,jt=g.resizedWidth),g!==void 0){if(Tt=g,g.tensorFormat!==void 0)throw new Error("Image input config format must be RGBA for HTMLImageElement");Tt.tensorFormat="RGBA",Tt.height=Lt,Tt.width=jt}else Tt.tensorFormat="RGBA",Tt.height=Lt,Tt.width=jt;$t.drawImage(d,0,0),vt=$t.getImageData(0,0,jt,Lt).data}else throw new Error("Can not access image data")}else if(et){let wt,$t;if(g!==void 0&&g.resizedWidth!==void 0&&g.resizedHeight!==void 0?(wt=g.resizedHeight,$t=g.resizedWidth):(wt=d.height,$t=d.width),g!==void 0&&(Tt=g),Tt.format="RGBA",Tt.height=wt,Tt.width=$t,g!==void 0){let Lt=Ct();Lt.width=$t,Lt.height=wt;let jt=pt(Lt);if(jt!=null)jt.putImageData(d,0,0),vt=jt.getImageData(0,0,$t,wt).data;else throw new Error("Can not access image data")}else vt=d.data}else if(st){if(g===void 0)throw new Error("Please provide image config with format for Imagebitmap");let wt=Ct();wt.width=d.width,wt.height=d.height;let $t=pt(wt);if($t!=null){let Lt=d.height,jt=d.width;return $t.drawImage(d,0,0,jt,Lt),vt=$t.getImageData(0,0,jt,Lt).data,Tt.height=Lt,Tt.width=jt,Wo(vt,Tt)}else throw new Error("Can not access image data")}else{if(at)return new Promise((wt,$t)=>{let Lt=Ct(),jt=pt(Lt);if(!d||!jt)return $t();let Ft=new Image;Ft.crossOrigin="Anonymous",Ft.src=d,Ft.onload=()=>{Lt.width=Ft.width,Lt.height=Ft.height,jt.drawImage(Ft,0,0,Lt.width,Lt.height);let Gt=jt.getImageData(0,0,Lt.width,Lt.height);Tt.height=Lt.height,Tt.width=Lt.width,wt(Wo(Gt.data,Tt))}});throw new Error("Input data provided is not supported - aborted tensor creation")}if(vt!==void 0)return Wo(vt,Tt);throw new Error("Input data provided is not supported - aborted tensor creation")},Qa$1=(d,g)=>{let{width:b,height:et,download:st,dispose:at}=g,vt=[1,et,b,4];return new Je({location:"texture",type:"float32",texture:d,dims:vt,download:st,dispose:at})},es$1=(d,g)=>{let{dataType:b,dims:et,download:st,dispose:at}=g;return new Je({location:"gpu-buffer",type:b??"float32",gpuBuffer:d,dims:et,download:st,dispose:at})},ts$1=(d,g,b)=>new Je({location:"cpu-pinned",type:d,data:g,dims:b??[g.length]})}),ur$1,Qr$1,ns,os$1,is$1=L$1(()=>{ur$1=new Map([["float32",Float32Array],["uint8",Uint8Array],["int8",Int8Array],["uint16",Uint16Array],["int16",Int16Array],["int32",Int32Array],["bool",Uint8Array],["float64",Float64Array],["uint32",Uint32Array]]),Qr$1=new Map([[Float32Array,"float32"],[Uint8Array,"uint8"],[Int8Array,"int8"],[Uint16Array,"uint16"],[Int16Array,"int16"],[Int32Array,"int32"],[Float64Array,"float64"],[Uint32Array,"uint32"]]),ns=!1,os$1=()=>{if(!ns){ns=!0;let d=typeof BigInt64Array<"u"&&BigInt64Array.from,g=typeof BigUint64Array<"u"&&BigUint64Array.from,b=typeof Float16Array<"u"&&Float16Array.from;d&&(ur$1.set("int64",BigInt64Array),Qr$1.set(BigInt64Array,"int64")),g&&(ur$1.set("uint64",BigUint64Array),Qr$1.set(BigUint64Array,"uint64")),b?(ur$1.set("float16",Float16Array),Qr$1.set(Float16Array,"float16")):ur$1.set("float16",Uint16Array)}}}),as$1,ss$1,us$1=L$1(()=>{Cn(),as$1=d=>{let g=1;for(let b=0;b<d.length;b++){let et=d[b];if(typeof et!="number"||!Number.isSafeInteger(et))throw new TypeError(`dims[${b}] must be an integer, got: ${et}`);if(et<0)throw new RangeError(`dims[${b}] must be a non-negative integer, got: ${et}`);g*=et}return g},ss$1=(d,g)=>{switch(d.location){case"cpu":return new Je(d.type,d.data,g);case"cpu-pinned":return new Je({location:"cpu-pinned",data:d.data,type:d.type,dims:g});case"texture":return new Je({location:"texture",texture:d.texture,type:d.type,dims:g});case"gpu-buffer":return new Je({location:"gpu-buffer",gpuBuffer:d.gpuBuffer,type:d.type,dims:g});default:throw new Error(`tensorReshape: tensor location ${d.location} is not supported`)}}}),Je,Cn=L$1(()=>{Ja$1(),rs$1(),is$1(),us$1(),Je=class{constructor(d,g,b){os$1();let et,st;if(typeof d=="object"&&"location"in d)switch(this.dataLocation=d.location,et=d.type,st=d.dims,d.location){case"cpu-pinned":{let vt=ur$1.get(et);if(!vt)throw new TypeError(`unsupported type "${et}" to create tensor from pinned buffer`);if(!(d.data instanceof vt))throw new TypeError(`buffer should be of type ${vt.name}`);this.cpuData=d.data;break}case"texture":{if(et!=="float32")throw new TypeError(`unsupported type "${et}" to create tensor from texture`);this.gpuTextureData=d.texture,this.downloader=d.download,this.disposer=d.dispose;break}case"gpu-buffer":{if(et!=="float32"&&et!=="float16"&&et!=="int32"&&et!=="int64"&&et!=="uint32"&&et!=="uint8"&&et!=="bool")throw new TypeError(`unsupported type "${et}" to create tensor from gpu buffer`);this.gpuBufferData=d.gpuBuffer,this.downloader=d.download,this.disposer=d.dispose;break}default:throw new Error(`Tensor constructor: unsupported location '${this.dataLocation}'`)}else{let vt,Tt;if(typeof d=="string")if(et=d,Tt=b,d==="string"){if(!Array.isArray(g))throw new TypeError("A string tensor's data must be a string array.");vt=g}else{let Ct=ur$1.get(d);if(Ct===void 0)throw new TypeError(`Unsupported tensor type: ${d}.`);if(Array.isArray(g)){if(d==="float16"&&Ct===Uint16Array)throw new TypeError("Creating a float16 tensor from number array is not supported. Please use Uint16Array as data.");d==="uint64"||d==="int64"?vt=Ct.from(g,BigInt):vt=Ct.from(g)}else if(g instanceof Ct)vt=g;else throw new TypeError(`A ${et} tensor's data must be type of ${Ct}`)}else if(Tt=g,Array.isArray(d)){if(d.length===0)throw new TypeError("Tensor type cannot be inferred from an empty array.");let Ct=typeof d[0];if(Ct==="string")et="string",vt=d;else if(Ct==="boolean")et="bool",vt=Uint8Array.from(d);else throw new TypeError(`Invalid element type of data array: ${Ct}.`)}else{let Ct=Qr$1.get(d.constructor);if(Ct===void 0)throw new TypeError(`Unsupported type for tensor data: ${d.constructor}.`);et=Ct,vt=d}if(Tt===void 0)Tt=[vt.length];else if(!Array.isArray(Tt))throw new TypeError("A tensor's dims must be a number array");st=Tt,this.cpuData=vt,this.dataLocation="cpu"}let at=as$1(st);if(this.cpuData&&at!==this.cpuData.length)throw new Error(`Tensor's size(${at}) does not match data length(${this.cpuData.length}).`);this.type=et,this.dims=st,this.size=at}static async fromImage(d,g){return Za$1(d,g)}static fromTexture(d,g){return Qa$1(d,g)}static fromGpuBuffer(d,g){return es$1(d,g)}static fromPinnedBuffer(d,g,b){return ts$1(d,g,b)}toDataURL(d){return Xa$1(this,d)}toImageData(d){return Ka$1(this,d)}get data(){if(this.ensureValid(),!this.cpuData)throw new Error("The data is not on CPU. Use `getData()` to download GPU data to CPU, or use `texture` or `gpuBuffer` property to access the GPU data directly.");return this.cpuData}get location(){return this.dataLocation}get texture(){if(this.ensureValid(),!this.gpuTextureData)throw new Error("The data is not stored as a WebGL texture.");return this.gpuTextureData}get gpuBuffer(){if(this.ensureValid(),!this.gpuBufferData)throw new Error("The data is not stored as a WebGPU buffer.");return this.gpuBufferData}async getData(d){switch(this.ensureValid(),this.dataLocation){case"cpu":case"cpu-pinned":return this.data;case"texture":case"gpu-buffer":{if(!this.downloader)throw new Error("The current tensor is not created with a specified data downloader.");if(this.isDownloading)throw new Error("The current tensor is being downloaded.");try{this.isDownloading=!0;let g=await this.downloader();return this.downloader=void 0,this.dataLocation="cpu",this.cpuData=g,d&&this.disposer&&(this.disposer(),this.disposer=void 0),g}finally{this.isDownloading=!1}}default:throw new Error(`cannot get data from location: ${this.dataLocation}`)}}dispose(){if(this.isDownloading)throw new Error("The current tensor is being downloaded.");this.disposer&&(this.disposer(),this.disposer=void 0),this.cpuData=void 0,this.gpuTextureData=void 0,this.gpuBufferData=void 0,this.downloader=void 0,this.isDownloading=void 0,this.dataLocation="none"}ensureValid(){if(this.dataLocation==="none")throw new Error("The tensor is disposed.")}reshape(d){if(this.ensureValid(),this.downloader||this.disposer)throw new Error("Cannot reshape a tensor that owns GPU resource.");return ss$1(this,d)}}}),Me,Fn$1=L$1(()=>{Cn(),Me=Je}),ls$1,fs$1,lr$1,fr$1,Ho=L$1(()=>{Vo(),ls$1=(d,g)=>{(typeof ut$1.trace>"u"?!ut$1.wasm.trace:!ut$1.trace)||console.timeStamp(`${d}::ORT::${g}`)},fs$1=(d,g)=>{var st;let b=((st=new Error().stack)==null?void 0:st.split(/\r\n|\r|\n/g))||[],et=!1;for(let at=0;at<b.length;at++){if(et&&!b[at].includes("TRACE_FUNC")){let vt=`FUNC_${d}::${b[at].trim().split(" ")[1]}`;g&&(vt+=`::${g}`),ls$1("CPU",vt);return}b[at].includes("TRACE_FUNC")&&(et=!0)}},lr$1=d=>{(typeof ut$1.trace>"u"?!ut$1.wasm.trace:!ut$1.trace)||fs$1("BEGIN",d)},fr$1=d=>{(typeof ut$1.trace>"u"?!ut$1.wasm.trace:!ut$1.trace)||fs$1("END",d)}}),$n,cs$1=L$1(()=>{Ln$1(),Fn$1(),Ho(),$n=class VS{constructor(g){this.handler=g}async run(g,b,et){lr$1();let st={},at={};if(typeof g!="object"||g===null||g instanceof Me||Array.isArray(g))throw new TypeError("'feeds' must be an object that use input names as keys and OnnxValue as corresponding values.");let vt=!0;if(typeof b=="object"){if(b===null)throw new TypeError("Unexpected argument[1]: cannot be null.");if(b instanceof Me)throw new TypeError("'fetches' cannot be a Tensor");if(Array.isArray(b)){if(b.length===0)throw new TypeError("'fetches' cannot be an empty array.");vt=!1;for(let pt of b){if(typeof pt!="string")throw new TypeError("'fetches' must be a string array or an object.");if(this.outputNames.indexOf(pt)===-1)throw new RangeError(`'fetches' contains invalid output name: ${pt}.`);st[pt]=null}if(typeof et=="object"&&et!==null)at=et;else if(typeof et<"u")throw new TypeError("'options' must be an object.")}else{let pt=!1,wt=Object.getOwnPropertyNames(b);for(let $t of this.outputNames)if(wt.indexOf($t)!==-1){let Lt=b[$t];(Lt===null||Lt instanceof Me)&&(pt=!0,vt=!1,st[$t]=Lt)}if(pt){if(typeof et=="object"&&et!==null)at=et;else if(typeof et<"u")throw new TypeError("'options' must be an object.")}else at=b}}else if(typeof b<"u")throw new TypeError("Unexpected argument[1]: must be 'fetches' or 'options'.");for(let pt of this.inputNames)if(typeof g[pt]>"u")throw new Error(`input '${pt}' is missing in 'feeds'.`);if(vt)for(let pt of this.outputNames)st[pt]=null;let Tt=await this.handler.run(g,st,at),Ct={};for(let pt in Tt)if(Object.hasOwnProperty.call(Tt,pt)){let wt=Tt[pt];wt instanceof Me?Ct[pt]=wt:Ct[pt]=new Me(wt.type,wt.data,wt.dims)}return fr$1(),Ct}async release(){return this.handler.dispose()}static async create(g,b,et,st){lr$1();let at,vt={};if(typeof g=="string"){if(at=g,typeof b=="object"&&b!==null)vt=b;else if(typeof b<"u")throw new TypeError("'options' must be an object.")}else if(g instanceof Uint8Array){if(at=g,typeof b=="object"&&b!==null)vt=b;else if(typeof b<"u")throw new TypeError("'options' must be an object.")}else if(g instanceof ArrayBuffer||typeof SharedArrayBuffer<"u"&&g instanceof SharedArrayBuffer){let wt=g,$t=0,Lt=g.byteLength;if(typeof b=="object"&&b!==null)vt=b;else if(typeof b=="number"){if($t=b,!Number.isSafeInteger($t))throw new RangeError("'byteOffset' must be an integer.");if($t<0||$t>=wt.byteLength)throw new RangeError(`'byteOffset' is out of range [0, ${wt.byteLength}).`);if(Lt=g.byteLength-$t,typeof et=="number"){if(Lt=et,!Number.isSafeInteger(Lt))throw new RangeError("'byteLength' must be an integer.");if(Lt<=0||$t+Lt>wt.byteLength)throw new RangeError(`'byteLength' is out of range (0, ${wt.byteLength-$t}].`);if(typeof st=="object"&&st!==null)vt=st;else if(typeof st<"u")throw new TypeError("'options' must be an object.")}else if(typeof et<"u")throw new TypeError("'byteLength' must be a number.")}else if(typeof b<"u")throw new TypeError("'options' must be an object.");at=new Uint8Array(wt,$t,Lt)}else throw new TypeError("Unexpected argument[0]: must be 'path' or 'buffer'.");let[Tt,Ct]=await Dn$1(vt),pt=await Tt.createInferenceSessionHandler(at,Ct);return fr$1(),new VS(pt)}startProfiling(){this.handler.startProfiling()}endProfiling(){this.handler.endProfiling()}get inputNames(){return this.handler.inputNames}get outputNames(){return this.handler.outputNames}}}),Pd$1,ps$1=L$1(()=>{cs$1(),Pd$1=$n}),ds$1=L$1(()=>{}),hs$1=L$1(()=>{}),ms$1=L$1(()=>{}),bs$1=L$1(()=>{}),Ed$1,kn$1,gs$1=L$1(()=>{Ln$1(),Fn$1(),Ed$1="Training backend could not be resolved. Make sure you're using the correct configuration & WebAssembly files.",kn$1=class WS{constructor(g,b,et){this.handler=g,this.hasOptimizerModel=b,this.hasEvalModel=et}get trainingInputNames(){return this.handler.inputNames}get trainingOutputNames(){return this.handler.outputNames}get evalInputNames(){if(this.hasEvalModel)return this.handler.evalInputNames;throw new Error("This training session has no evalModel loaded.")}get evalOutputNames(){if(this.hasEvalModel)return this.handler.evalOutputNames;throw new Error("This training session has no evalModel loaded.")}static async create(g,b){let et=g.evalModel||"",st=g.optimizerModel||"",at=b||{},[vt,Tt]=await Dn$1(at);if(vt.createTrainingSessionHandler){let Ct=await vt.createTrainingSessionHandler(g.checkpointState,g.trainModel,et,st,Tt);return new WS(Ct,!!g.optimizerModel,!!g.evalModel)}else throw new Error(Ed$1)}typeNarrowingForRunStep(g,b,et,st,at){let vt={},Tt={};if(typeof et!="object"||et===null||et instanceof Me||Array.isArray(et))throw new TypeError("'feeds' must be an object that use input names as keys and OnnxValue as corresponding values.");let Ct=!0;if(typeof st=="object"){if(st===null)throw new TypeError("Unexpected argument[1]: cannot be null.");if(st instanceof Me)throw new TypeError("'fetches' cannot be a Tensor");if(Array.isArray(st)){if(st.length===0)throw new TypeError("'fetches' cannot be an empty array.");Ct=!1;for(let pt of st){if(typeof pt!="string")throw new TypeError("'fetches' must be a string array or an object.");if(b.indexOf(pt)===-1)throw new RangeError(`'fetches' contains invalid output name: ${pt}.`);vt[pt]=null}if(typeof at=="object"&&at!==null)Tt=at;else if(typeof at<"u")throw new TypeError("'options' must be an object.")}else{let pt=!1,wt=Object.getOwnPropertyNames(st);for(let $t of b)if(wt.indexOf($t)!==-1){let Lt=st[$t];(Lt===null||Lt instanceof Me)&&(pt=!0,Ct=!1,vt[$t]=Lt)}if(pt){if(typeof at=="object"&&at!==null)Tt=at;else if(typeof at<"u")throw new TypeError("'options' must be an object.")}else Tt=st}}else if(typeof st<"u")throw new TypeError("Unexpected argument[1]: must be 'fetches' or 'options'.");for(let pt of g)if(typeof et[pt]>"u")throw new Error(`input '${pt}' is missing in 'feeds'.`);if(Ct)for(let pt of b)vt[pt]=null;return[vt,Tt]}convertHandlerReturnTypeToMapOfTensors(g){let b={};for(let et in g)if(Object.hasOwnProperty.call(g,et)){let st=g[et];st instanceof Me?b[et]=st:b[et]=new Me(st.type,st.data,st.dims)}return b}async lazyResetGrad(){await this.handler.lazyResetGrad()}async runTrainStep(g,b,et){let[st,at]=this.typeNarrowingForRunStep(this.trainingInputNames,this.trainingOutputNames,g,b,et),vt=await this.handler.runTrainStep(g,st,at);return this.convertHandlerReturnTypeToMapOfTensors(vt)}async runOptimizerStep(g){if(this.hasOptimizerModel)await this.handler.runOptimizerStep(g||{});else throw new Error("This TrainingSession has no OptimizerModel loaded.")}async runEvalStep(g,b,et){if(this.hasEvalModel){let[st,at]=this.typeNarrowingForRunStep(this.evalInputNames,this.evalOutputNames,g,b,et),vt=await this.handler.runEvalStep(g,st,at);return this.convertHandlerReturnTypeToMapOfTensors(vt)}else throw new Error("This TrainingSession has no EvalModel loaded.")}async getParametersSize(g=!0){return this.handler.getParametersSize(g)}async loadParametersBuffer(g,b=!0){let et=await this.getParametersSize(b);if(g.length!==4*et)throw new Error("Size of the buffer passed into loadParametersBuffer must match the number of parameters in the model. Please use getParametersSize method to check.");return this.handler.loadParametersBuffer(g,b)}async getContiguousParameters(g=!0){return this.handler.getContiguousParameters(g)}async release(){return this.handler.dispose()}}}),Dd$1,ys$1=L$1(()=>{gs$1(),Dd$1=kn$1}),qo={};Sr(qo,{InferenceSession:()=>Pd$1,TRACE:()=>ls$1,TRACE_FUNC_BEGIN:()=>lr$1,TRACE_FUNC_END:()=>fr$1,Tensor:()=>Me,TrainingSession:()=>Dd$1,env:()=>Z,registerBackend:()=>Pr$1});var Ot$1=L$1(()=>{Wa(),Ya$1(),ps$1(),Fn$1(),ds$1(),hs$1(),Ho(),ms$1(),bs$1(),ys$1()});function Xt$1(d,g,b,et){if(g===void 0)return Cd$1(d);if(b===void 0)Bn$1(d,g);else if(typeof b=="number"&&et===void 0)Bn$1(d,g);else if(typeof b=="string"&&et===void 0)Bn$1(d,b,1,g);else if(typeof b=="string"&&typeof et=="number")Bn$1(d,b,et,g);else throw new TypeError("input is valid")}function Cd$1(d){return{verbose:Xt$1.verbose.bind(null,d),info:Xt$1.info.bind(null,d),warning:Xt$1.warning.bind(null,d),error:Xt$1.error.bind(null,d),fatal:Xt$1.fatal.bind(null,d)}}function Bn$1(d,g,b,et){let st=en$1[et||""]||en$1[""];xs$1[d]<xs$1[st.minimalSeverity]||(st.logDateTime&&(g=`${new Date().toISOString()}|${g}`),st.logSourceLocation,Ld$1[st.provider].log(d,g,et))}var jo,Yo,xs$1,Ld$1,ws$1,en$1,ce,Rn$1,Mn$1,Gn$1,Nn$1,lt$1=L$1(()=>{jo=class{log(d,g,b){}},Yo=class{log(d,g,b){console.log(`${this.color(d)} ${b?"\x1B[35m"+b+"\x1B[0m ":""}${g}`)}color(d){switch(d){case"verbose":return"\x1B[34;40mv\x1B[0m";case"info":return"\x1B[32mi\x1B[0m";case"warning":return"\x1B[30;43mw\x1B[0m";case"error":return"\x1B[31;40me\x1B[0m";case"fatal":return"\x1B[101mf\x1B[0m";default:throw new Error(`unsupported severity: ${d}`)}}},xs$1={verbose:1e3,info:2e3,warning:4e3,error:5e3,fatal:6e3},Ld$1={none:new jo,console:new Yo},ws$1={provider:"console",minimalSeverity:"warning",logDateTime:!0,logSourceLocation:!1},en$1={"":ws$1},(d=>{function g(pt,wt){d("verbose",pt,wt)}d.verbose=g;function b(pt,wt){d("info",pt,wt)}d.info=b;function et(pt,wt){d("warning",pt,wt)}d.warning=et;function st(pt,wt){d("error",pt,wt)}d.error=st;function at(pt,wt){d("fatal",pt,wt)}d.fatal=at;function vt(pt){en$1={},Tt("",pt||{})}d.reset=vt;function Tt(pt,wt){if(pt==="*")vt(wt);else{let $t=en$1[pt]||ws$1;en$1[pt]={provider:wt.provider||$t.provider,minimalSeverity:wt.minimalSeverity||$t.minimalSeverity,logDateTime:wt.logDateTime===void 0?$t.logDateTime:wt.logDateTime,logSourceLocation:wt.logSourceLocation===void 0?$t.logSourceLocation:wt.logSourceLocation}}}d.set=Tt;function Ct(pt){let wt={};pt.logLevel&&(wt.minimalSeverity=pt.logLevel),Tt("",wt)}d.setWithEnv=Ct})(Xt$1||(Xt$1={})),ce=Xt$1,Rn$1=class{constructor(d,g,b,et,st,at){this.category=d,this.name=g,this.startTime=b,this.endCallback=et,this.timer=st,this.ctx=at}async end(){return this.endCallback(this)}async checkTimer(){if(this.ctx===void 0||this.timer===void 0)throw new Error("No webgl timer found");return this.ctx.endTimer(),this.ctx.waitForQueryAndGetTime(this.timer)}},Mn$1=class{constructor(d,g,b,et){this.category=d,this.name=g,this.startTime=b,this.endTime=et}},Gn$1=class{constructor(d,g,b){this._started=!1,this._flushPointer=0,this._started=!1,this._maxNumberEvents=d===void 0?1e4:d,this._flushBatchSize=g===void 0?10:g,this._flushIntervalInMilliseconds=b===void 0?5e3:b}static create(d){return d===void 0?new this:new this(d.maxNumberEvents,d.flushBatchSize,d.flushIntervalInMilliseconds)}start(){this._started=!0,this._timingEvents=[],this._flushTime=Nn$1(),this._flushPointer=0}stop(){for(this._started=!1;this._flushPointer<this._timingEvents.length;this._flushPointer++)this.logOneEvent(this._timingEvents[this._flushPointer])}event(d,g,b,et){let st=this._started?this.begin(d,g,et):void 0,at=!1,vt=b();if(vt&&typeof vt.then=="function")return at=!0,new Promise((Tt,Ct)=>{vt.then(async pt=>{st&&await st.end(),Tt(pt)},async pt=>{st&&await st.end(),Ct(pt)})});if(!at&&st){let Tt=st.end();if(Tt&&typeof Tt.then=="function")return new Promise((Ct,pt)=>{Tt.then(()=>{Ct(vt)},wt=>{pt(wt)})})}return vt}begin(d,g,b){if(!this._started)throw new Error("profiler is not started yet");if(b===void 0){let et=Nn$1();return this.flush(et),new Rn$1(d,g,et,st=>this.endSync(st))}else{let et=b.beginTimer();return new Rn$1(d,g,0,async st=>this.end(st),et,b)}}async end(d){let g=await d.checkTimer();this._timingEvents.length<this._maxNumberEvents&&(this._timingEvents.push(new Mn$1(d.category,d.name,d.startTime,g)),this.flush(g))}endSync(d){let g=Nn$1();this._timingEvents.length<this._maxNumberEvents&&(this._timingEvents.push(new Mn$1(d.category,d.name,d.startTime,g)),this.flush(g))}logOneEvent(d){ce.verbose(`Profiler.${d.category}`,`${(d.endTime-d.startTime).toFixed(2)}ms on event '${d.name}' at ${d.endTime.toFixed(2)}`)}flush(d){if(this._timingEvents.length-this._flushPointer>=this._flushBatchSize||d-this._flushTime>=this._flushIntervalInMilliseconds){for(let g=this._flushPointer;this._flushPointer<g+this._flushBatchSize&&this._flushPointer<this._timingEvents.length;this._flushPointer++)this.logOneEvent(this._timingEvents[this._flushPointer]);this._flushTime=Nn$1()}}get started(){return this._started}},Nn$1=typeof performance<"u"&&performance.now?()=>performance.now():Date.now});function vs$1(d,g,b){for(let et of b){let st=et[0],at=et[1],vt=et[2],Tt=et[3],Ct=et[4];if(d.opType===st){for(let pt of g)if((pt.domain===at||pt.domain==="ai.onnx"&&at==="")&&Fd$1(pt.version,vt))return{opImpl:Tt,opInit:Ct}}}throw new TypeError(`cannot resolve operator '${d.opType}' with opsets: ${g.map(et=>`${et.domain||"ai.onnx"} v${et.version}`).join(", ")}`)}function Fd$1(d,g){if(g.endsWith("+")){let b=Number.parseInt(g.substring(0,g.length-1),10);return!isNaN(b)&&b<=d}else if(g.split("-").length===2){let b=g.split("-"),et=Number.parseInt(b[0],10),st=Number.parseInt(b[1],10);return!isNaN(et)&&!isNaN(st)&&et<=d&&d<=st}else return Number.parseInt(g,10)===d}var _s$1=L$1(()=>{}),Os$1=me(d=>{d.__esModule=!0;var g=function(){function b(et){if(!et)throw new TypeError("Invalid argument; `value` has no value.");this.value=b.EMPTY,et&&b.isGuid(et)&&(this.value=et)}return b.isGuid=function(et){var st=et.toString();return et&&(et instanceof b||b.validator.test(st))},b.create=function(){return new b([b.gen(2),b.gen(1),b.gen(1),b.gen(1),b.gen(3)].join("-"))},b.createEmpty=function(){return new b("emptyguid")},b.parse=function(et){return new b(et)},b.raw=function(){return[b.gen(2),b.gen(1),b.gen(1),b.gen(1),b.gen(3)].join("-")},b.gen=function(et){for(var st="",at=0;at<et;at++)st+=((1+Math.random())*65536|0).toString(16).substring(1);return st},b.prototype.equals=function(et){return b.isGuid(et)&&this.value===et.toString()},b.prototype.isEmpty=function(){return this.value===b.EMPTY},b.prototype.toString=function(){return this.value},b.prototype.toJSON=function(){return{value:this.value}},b.validator=new RegExp("^[a-z0-9]{8}-[a-z0-9]{4}-[a-z0-9]{4}-[a-z0-9]{4}-[a-z0-9]{12}$","i"),b.EMPTY="00000000-0000-0000-0000-000000000000",b}();d.Guid=g});function be(d,g,b){this.low=d|0,this.high=g|0,this.unsigned=!!b}function Xe(d){return(d&&d.__isLong__)===!0}function Is$1(d){var g=Math.clz32(d&-d);return d?31-g:g}function cr$1(d,g){var b,et,st;return g?(d>>>=0,(st=0<=d&&d<256)&&(et=As$1[d],et)?et:(b=le(d,0,!0),st&&(As$1[d]=b),b)):(d|=0,(st=-128<=d&&d<128)&&(et=Ss$1[d],et)?et:(b=le(d,d<0?-1:0,!1),st&&(Ss$1[d]=b),b))}function ct(d,g){if(isNaN(d))return g?zt$1:It;if(g){if(d<0)return zt$1;if(d>=Ls$1)return $s$1}else{if(d<=-Es$1)return nt$1;if(d+1>=Es$1)return Fs$1}return d<0?ct(-d,g).neg():le(d%Dr|0,d/Dr|0,g)}function le(d,g,b){return new be(d,g,b)}function Jo(d,g,b){if(d.length===0)throw Error("empty string");if(typeof g=="number"?(b=g,g=!1):g=!!g,d==="NaN"||d==="Infinity"||d==="+Infinity"||d==="-Infinity")return g?zt$1:It;if(b=b||10,b<2||36<b)throw RangeError("radix");var et;if((et=d.indexOf("-"))>0)throw Error("interior hyphen");if(et===0)return Jo(d.substring(1),g,b).neg();for(var st=ct(Un$1(b,8)),at=It,vt=0;vt<d.length;vt+=8){var Tt=Math.min(8,d.length-vt),Ct=parseInt(d.substring(vt,vt+Tt),b);if(Tt<8){var pt=ct(Un$1(b,Tt));at=at.mul(pt).add(ct(Ct))}else at=at.mul(st),at=at.add(ct(Ct))}return at.unsigned=g,at}function St$1(d,g){return typeof d=="number"?ct(d,g):typeof d=="string"?Jo(d,g):le(d.low,d.high,typeof g=="boolean"?g:d.unsigned)}var ft,Ss$1,As$1,Un$1,Ps$1,kd$1,Dr,Ls$1,Es$1,Ds$1,It,zt$1,Er$1,Cs$1,Ko,Fs$1,$s$1,nt$1,B,Vt,Zo=L$1(()=>{ft=null;try{ft=new WebAssembly.Instance(new WebAssembly.Module(new Uint8Array([0,97,115,109,1,0,0,0,1,13,2,96,0,1,127,96,4,127,127,127,127,1,127,3,7,6,0,1,1,1,1,1,6,6,1,127,1,65,0,11,7,50,6,3,109,117,108,0,1,5,100,105,118,95,115,0,2,5,100,105,118,95,117,0,3,5,114,101,109,95,115,0,4,5,114,101,109,95,117,0,5,8,103,101,116,95,104,105,103,104,0,0,10,191,1,6,4,0,35,0,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,126,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,127,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,128,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,129,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,130,34,4,66,32,135,167,36,0,32,4,167,11])),{}).exports}catch{}be.prototype.__isLong__,Object.defineProperty(be.prototype,"__isLong__",{value:!0}),be.isLong=Xe,Ss$1={},As$1={},be.fromInt=cr$1,be.fromNumber=ct,be.fromBits=le,Un$1=Math.pow,be.fromString=Jo,be.fromValue=St$1,Ps$1=65536,kd$1=1<<24,Dr=Ps$1*Ps$1,Ls$1=Dr*Dr,Es$1=Ls$1/2,Ds$1=cr$1(kd$1),It=cr$1(0),be.ZERO=It,zt$1=cr$1(0,!0),be.UZERO=zt$1,Er$1=cr$1(1),be.ONE=Er$1,Cs$1=cr$1(1,!0),be.UONE=Cs$1,Ko=cr$1(-1),be.NEG_ONE=Ko,Fs$1=le(-1,2147483647,!1),be.MAX_VALUE=Fs$1,$s$1=le(-1,-1,!0),be.MAX_UNSIGNED_VALUE=$s$1,nt$1=le(0,-2147483648,!1),be.MIN_VALUE=nt$1,B=be.prototype,B.toInt=function(){return this.unsigned?this.low>>>0:this.low},B.toNumber=function(){return this.unsigned?(this.high>>>0)*Dr+(this.low>>>0):this.high*Dr+(this.low>>>0)},B.toString=function(d){if(d=d||10,d<2||36<d)throw RangeError("radix");if(this.isZero())return"0";if(this.isNegative())if(this.eq(nt$1)){var g=ct(d),b=this.div(g),et=b.mul(g).sub(this);return b.toString(d)+et.toInt().toString(d)}else return"-"+this.neg().toString(d);for(var st=ct(Un$1(d,6),this.unsigned),at=this,vt="";;){var Tt=at.div(st),Ct=at.sub(Tt.mul(st)).toInt()>>>0,pt=Ct.toString(d);if(at=Tt,at.isZero())return pt+vt;for(;pt.length<6;)pt="0"+pt;vt=""+pt+vt}},B.getHighBits=function(){return this.high},B.getHighBitsUnsigned=function(){return this.high>>>0},B.getLowBits=function(){return this.low},B.getLowBitsUnsigned=function(){return this.low>>>0},B.getNumBitsAbs=function(){if(this.isNegative())return this.eq(nt$1)?64:this.neg().getNumBitsAbs();for(var d=this.high!=0?this.high:this.low,g=31;g>0&&!(d&1<<g);g--);return this.high!=0?g+33:g+1},B.isZero=function(){return this.high===0&&this.low===0},B.eqz=B.isZero,B.isNegative=function(){return!this.unsigned&&this.high<0},B.isPositive=function(){return this.unsigned||this.high>=0},B.isOdd=function(){return(this.low&1)===1},B.isEven=function(){return(this.low&1)===0},B.equals=function(d){return Xe(d)||(d=St$1(d)),this.unsigned!==d.unsigned&&this.high>>>31===1&&d.high>>>31===1?!1:this.high===d.high&&this.low===d.low},B.eq=B.equals,B.notEquals=function(d){return!this.eq(d)},B.neq=B.notEquals,B.ne=B.notEquals,B.lessThan=function(d){return this.comp(d)<0},B.lt=B.lessThan,B.lessThanOrEqual=function(d){return this.comp(d)<=0},B.lte=B.lessThanOrEqual,B.le=B.lessThanOrEqual,B.greaterThan=function(d){return this.comp(d)>0},B.gt=B.greaterThan,B.greaterThanOrEqual=function(d){return this.comp(d)>=0},B.gte=B.greaterThanOrEqual,B.ge=B.greaterThanOrEqual,B.compare=function(d){if(Xe(d)||(d=St$1(d)),this.eq(d))return 0;var g=this.isNegative(),b=d.isNegative();return g&&!b?-1:!g&&b?1:this.unsigned?d.high>>>0>this.high>>>0||d.high===this.high&&d.low>>>0>this.low>>>0?-1:1:this.sub(d).isNegative()?-1:1},B.comp=B.compare,B.negate=function(){return!this.unsigned&&this.eq(nt$1)?nt$1:this.not().add(Er$1)},B.neg=B.negate,B.add=function(d){Xe(d)||(d=St$1(d));var g=this.high>>>16,b=this.high&65535,et=this.low>>>16,st=this.low&65535,at=d.high>>>16,vt=d.high&65535,Tt=d.low>>>16,Ct=d.low&65535,pt=0,wt=0,$t=0,Lt=0;return Lt+=st+Ct,$t+=Lt>>>16,Lt&=65535,$t+=et+Tt,wt+=$t>>>16,$t&=65535,wt+=b+vt,pt+=wt>>>16,wt&=65535,pt+=g+at,pt&=65535,le($t<<16|Lt,pt<<16|wt,this.unsigned)},B.subtract=function(d){return Xe(d)||(d=St$1(d)),this.add(d.neg())},B.sub=B.subtract,B.multiply=function(d){if(this.isZero())return this;if(Xe(d)||(d=St$1(d)),ft){var g=ft.mul(this.low,this.high,d.low,d.high);return le(g,ft.get_high(),this.unsigned)}if(d.isZero())return this.unsigned?zt$1:It;if(this.eq(nt$1))return d.isOdd()?nt$1:It;if(d.eq(nt$1))return this.isOdd()?nt$1:It;if(this.isNegative())return d.isNegative()?this.neg().mul(d.neg()):this.neg().mul(d).neg();if(d.isNegative())return this.mul(d.neg()).neg();if(this.lt(Ds$1)&&d.lt(Ds$1))return ct(this.toNumber()*d.toNumber(),this.unsigned);var b=this.high>>>16,et=this.high&65535,st=this.low>>>16,at=this.low&65535,vt=d.high>>>16,Tt=d.high&65535,Ct=d.low>>>16,pt=d.low&65535,wt=0,$t=0,Lt=0,jt=0;return jt+=at*pt,Lt+=jt>>>16,jt&=65535,Lt+=st*pt,$t+=Lt>>>16,Lt&=65535,Lt+=at*Ct,$t+=Lt>>>16,Lt&=65535,$t+=et*pt,wt+=$t>>>16,$t&=65535,$t+=st*Ct,wt+=$t>>>16,$t&=65535,$t+=at*Tt,wt+=$t>>>16,$t&=65535,wt+=b*pt+et*Ct+st*Tt+at*vt,wt&=65535,le(Lt<<16|jt,wt<<16|$t,this.unsigned)},B.mul=B.multiply,B.divide=function(d){if(Xe(d)||(d=St$1(d)),d.isZero())throw Error("division by zero");if(ft){if(!this.unsigned&&this.high===-2147483648&&d.low===-1&&d.high===-1)return this;var g=(this.unsigned?ft.div_u:ft.div_s)(this.low,this.high,d.low,d.high);return le(g,ft.get_high(),this.unsigned)}if(this.isZero())return this.unsigned?zt$1:It;var b,et,st;if(this.unsigned){if(d.unsigned||(d=d.toUnsigned()),d.gt(this))return zt$1;if(d.gt(this.shru(1)))return Cs$1;st=zt$1}else{if(this.eq(nt$1)){if(d.eq(Er$1)||d.eq(Ko))return nt$1;if(d.eq(nt$1))return Er$1;var at=this.shr(1);return b=at.div(d).shl(1),b.eq(It)?d.isNegative()?Er$1:Ko:(et=this.sub(d.mul(b)),st=b.add(et.div(d)),st)}else if(d.eq(nt$1))return this.unsigned?zt$1:It;if(this.isNegative())return d.isNegative()?this.neg().div(d.neg()):this.neg().div(d).neg();if(d.isNegative())return this.div(d.neg()).neg();st=It}for(et=this;et.gte(d);){b=Math.max(1,Math.floor(et.toNumber()/d.toNumber()));for(var vt=Math.ceil(Math.log(b)/Math.LN2),Tt=vt<=48?1:Un$1(2,vt-48),Ct=ct(b),pt=Ct.mul(d);pt.isNegative()||pt.gt(et);)b-=Tt,Ct=ct(b,this.unsigned),pt=Ct.mul(d);Ct.isZero()&&(Ct=Er$1),st=st.add(Ct),et=et.sub(pt)}return st},B.div=B.divide,B.modulo=function(d){if(Xe(d)||(d=St$1(d)),ft){var g=(this.unsigned?ft.rem_u:ft.rem_s)(this.low,this.high,d.low,d.high);return le(g,ft.get_high(),this.unsigned)}return this.sub(this.div(d).mul(d))},B.mod=B.modulo,B.rem=B.modulo,B.not=function(){return le(~this.low,~this.high,this.unsigned)},B.countLeadingZeros=function(){return this.high?Math.clz32(this.high):Math.clz32(this.low)+32},B.clz=B.countLeadingZeros,B.countTrailingZeros=function(){return this.low?Is$1(this.low):Is$1(this.high)+32},B.ctz=B.countTrailingZeros,B.and=function(d){return Xe(d)||(d=St$1(d)),le(this.low&d.low,this.high&d.high,this.unsigned)},B.or=function(d){return Xe(d)||(d=St$1(d)),le(this.low|d.low,this.high|d.high,this.unsigned)},B.xor=function(d){return Xe(d)||(d=St$1(d)),le(this.low^d.low,this.high^d.high,this.unsigned)},B.shiftLeft=function(d){return Xe(d)&&(d=d.toInt()),(d&=63)===0?this:d<32?le(this.low<<d,this.high<<d|this.low>>>32-d,this.unsigned):le(0,this.low<<d-32,this.unsigned)},B.shl=B.shiftLeft,B.shiftRight=function(d){return Xe(d)&&(d=d.toInt()),(d&=63)===0?this:d<32?le(this.low>>>d|this.high<<32-d,this.high>>d,this.unsigned):le(this.high>>d-32,this.high>=0?0:-1,this.unsigned)},B.shr=B.shiftRight,B.shiftRightUnsigned=function(d){return Xe(d)&&(d=d.toInt()),(d&=63)===0?this:d<32?le(this.low>>>d|this.high<<32-d,this.high>>>d,this.unsigned):d===32?le(this.high,0,this.unsigned):le(this.high>>>d-32,0,this.unsigned)},B.shru=B.shiftRightUnsigned,B.shr_u=B.shiftRightUnsigned,B.rotateLeft=function(d){var g;return Xe(d)&&(d=d.toInt()),(d&=63)===0?this:d===32?le(this.high,this.low,this.unsigned):d<32?(g=32-d,le(this.low<<d|this.high>>>g,this.high<<d|this.low>>>g,this.unsigned)):(d-=32,g=32-d,le(this.high<<d|this.low>>>g,this.low<<d|this.high>>>g,this.unsigned))},B.rotl=B.rotateLeft,B.rotateRight=function(d){var g;return Xe(d)&&(d=d.toInt()),(d&=63)===0?this:d===32?le(this.high,this.low,this.unsigned):d<32?(g=32-d,le(this.high<<g|this.low>>>d,this.low<<g|this.high>>>d,this.unsigned)):(d-=32,g=32-d,le(this.low<<g|this.high>>>d,this.high<<g|this.low>>>d,this.unsigned))},B.rotr=B.rotateRight,B.toSigned=function(){return this.unsigned?le(this.low,this.high,!1):this},B.toUnsigned=function(){return this.unsigned?this:le(this.low,this.high,!0)},B.toBytes=function(d){return d?this.toBytesLE():this.toBytesBE()},B.toBytesLE=function(){var d=this.high,g=this.low;return[g&255,g>>>8&255,g>>>16&255,g>>>24,d&255,d>>>8&255,d>>>16&255,d>>>24]},B.toBytesBE=function(){var d=this.high,g=this.low;return[d>>>24,d>>>16&255,d>>>8&255,d&255,g>>>24,g>>>16&255,g>>>8&255,g&255]},be.fromBytes=function(d,g,b){return b?be.fromBytesLE(d,g):be.fromBytesBE(d,g)},be.fromBytesLE=function(d,g){return new be(d[0]|d[1]<<8|d[2]<<16|d[3]<<24,d[4]|d[5]<<8|d[6]<<16|d[7]<<24,g)},be.fromBytesBE=function(d,g){return new be(d[4]<<24|d[5]<<16|d[6]<<8|d[7],d[0]<<24|d[1]<<16|d[2]<<8|d[3],g)},Vt=be}),_$1,zn$1=L$1(()=>{_$1={},_$1.Offset,_$1.Table,_$1.SIZEOF_SHORT=2,_$1.SIZEOF_INT=4,_$1.FILE_IDENTIFIER_LENGTH=4,_$1.SIZE_PREFIX_LENGTH=4,_$1.Encoding={UTF8_BYTES:1,UTF16_STRING:2},_$1.int32=new Int32Array(2),_$1.float32=new Float32Array(_$1.int32.buffer),_$1.float64=new Float64Array(_$1.int32.buffer),_$1.isLittleEndian=new Uint16Array(new Uint8Array([1,0]).buffer)[0]===1,_$1.Long=function(d,g){this.low=d|0,this.high=g|0},_$1.Long.create=function(d,g){return d==0&&g==0?_$1.Long.ZERO:new _$1.Long(d,g)},_$1.Long.prototype.toFloat64=function(){return(this.low>>>0)+this.high*4294967296},_$1.Long.prototype.equals=function(d){return this.low==d.low&&this.high==d.high},_$1.Long.ZERO=new _$1.Long(0,0),_$1.Builder=function(d){if(d)var g=d;else var g=1024;this.bb=_$1.ByteBuffer.allocate(g),this.space=g,this.minalign=1,this.vtable=null,this.vtable_in_use=0,this.isNested=!1,this.object_start=0,this.vtables=[],this.vector_num_elems=0,this.force_defaults=!1},_$1.Builder.prototype.clear=function(){this.bb.clear(),this.space=this.bb.capacity(),this.minalign=1,this.vtable=null,this.vtable_in_use=0,this.isNested=!1,this.object_start=0,this.vtables=[],this.vector_num_elems=0,this.force_defaults=!1},_$1.Builder.prototype.forceDefaults=function(d){this.force_defaults=d},_$1.Builder.prototype.dataBuffer=function(){return this.bb},_$1.Builder.prototype.asUint8Array=function(){return this.bb.bytes().subarray(this.bb.position(),this.bb.position()+this.offset())},_$1.Builder.prototype.prep=function(d,g){d>this.minalign&&(this.minalign=d);for(var b=~(this.bb.capacity()-this.space+g)+1&d-1;this.space<b+d+g;){var et=this.bb.capacity();this.bb=_$1.Builder.growByteBuffer(this.bb),this.space+=this.bb.capacity()-et}this.pad(b)},_$1.Builder.prototype.pad=function(d){for(var g=0;g<d;g++)this.bb.writeInt8(--this.space,0)},_$1.Builder.prototype.writeInt8=function(d){this.bb.writeInt8(this.space-=1,d)},_$1.Builder.prototype.writeInt16=function(d){this.bb.writeInt16(this.space-=2,d)},_$1.Builder.prototype.writeInt32=function(d){this.bb.writeInt32(this.space-=4,d)},_$1.Builder.prototype.writeInt64=function(d){this.bb.writeInt64(this.space-=8,d)},_$1.Builder.prototype.writeFloat32=function(d){this.bb.writeFloat32(this.space-=4,d)},_$1.Builder.prototype.writeFloat64=function(d){this.bb.writeFloat64(this.space-=8,d)},_$1.Builder.prototype.addInt8=function(d){this.prep(1,0),this.writeInt8(d)},_$1.Builder.prototype.addInt16=function(d){this.prep(2,0),this.writeInt16(d)},_$1.Builder.prototype.addInt32=function(d){this.prep(4,0),this.writeInt32(d)},_$1.Builder.prototype.addInt64=function(d){this.prep(8,0),this.writeInt64(d)},_$1.Builder.prototype.addFloat32=function(d){this.prep(4,0),this.writeFloat32(d)},_$1.Builder.prototype.addFloat64=function(d){this.prep(8,0),this.writeFloat64(d)},_$1.Builder.prototype.addFieldInt8=function(d,g,b){(this.force_defaults||g!=b)&&(this.addInt8(g),this.slot(d))},_$1.Builder.prototype.addFieldInt16=function(d,g,b){(this.force_defaults||g!=b)&&(this.addInt16(g),this.slot(d))},_$1.Builder.prototype.addFieldInt32=function(d,g,b){(this.force_defaults||g!=b)&&(this.addInt32(g),this.slot(d))},_$1.Builder.prototype.addFieldInt64=function(d,g,b){(this.force_defaults||!g.equals(b))&&(this.addInt64(g),this.slot(d))},_$1.Builder.prototype.addFieldFloat32=function(d,g,b){(this.force_defaults||g!=b)&&(this.addFloat32(g),this.slot(d))},_$1.Builder.prototype.addFieldFloat64=function(d,g,b){(this.force_defaults||g!=b)&&(this.addFloat64(g),this.slot(d))},_$1.Builder.prototype.addFieldOffset=function(d,g,b){(this.force_defaults||g!=b)&&(this.addOffset(g),this.slot(d))},_$1.Builder.prototype.addFieldStruct=function(d,g,b){g!=b&&(this.nested(g),this.slot(d))},_$1.Builder.prototype.nested=function(d){if(d!=this.offset())throw new Error("FlatBuffers: struct must be serialized inline.")},_$1.Builder.prototype.notNested=function(){if(this.isNested)throw new Error("FlatBuffers: object serialization must not be nested.")},_$1.Builder.prototype.slot=function(d){this.vtable[d]=this.offset()},_$1.Builder.prototype.offset=function(){return this.bb.capacity()-this.space},_$1.Builder.growByteBuffer=function(d){var g=d.capacity();if(g&3221225472)throw new Error("FlatBuffers: cannot grow buffer beyond 2 gigabytes.");var b=g<<1,et=_$1.ByteBuffer.allocate(b);return et.setPosition(b-g),et.bytes().set(d.bytes(),b-g),et},_$1.Builder.prototype.addOffset=function(d){this.prep(_$1.SIZEOF_INT,0),this.writeInt32(this.offset()-d+_$1.SIZEOF_INT)},_$1.Builder.prototype.startObject=function(d){this.notNested(),this.vtable==null&&(this.vtable=[]),this.vtable_in_use=d;for(var g=0;g<d;g++)this.vtable[g]=0;this.isNested=!0,this.object_start=this.offset()},_$1.Builder.prototype.endObject=function(){if(this.vtable==null||!this.isNested)throw new Error("FlatBuffers: endObject called without startObject");this.addInt32(0);for(var d=this.offset(),g=this.vtable_in_use-1;g>=0&&this.vtable[g]==0;g--);for(var b=g+1;g>=0;g--)this.addInt16(this.vtable[g]!=0?d-this.vtable[g]:0);var et=2;this.addInt16(d-this.object_start);var st=(b+et)*_$1.SIZEOF_SHORT;this.addInt16(st);var at=0,vt=this.space;e:for(g=0;g<this.vtables.length;g++){var Tt=this.bb.capacity()-this.vtables[g];if(st==this.bb.readInt16(Tt)){for(var Ct=_$1.SIZEOF_SHORT;Ct<st;Ct+=_$1.SIZEOF_SHORT)if(this.bb.readInt16(vt+Ct)!=this.bb.readInt16(Tt+Ct))continue e;at=this.vtables[g];break}}return at?(this.space=this.bb.capacity()-d,this.bb.writeInt32(this.space,at-d)):(this.vtables.push(this.offset()),this.bb.writeInt32(this.bb.capacity()-d,this.offset()-d)),this.isNested=!1,d},_$1.Builder.prototype.finish=function(d,g,b){var et=b?_$1.SIZE_PREFIX_LENGTH:0;if(g){var st=g;if(this.prep(this.minalign,_$1.SIZEOF_INT+_$1.FILE_IDENTIFIER_LENGTH+et),st.length!=_$1.FILE_IDENTIFIER_LENGTH)throw new Error("FlatBuffers: file identifier must be length "+_$1.FILE_IDENTIFIER_LENGTH);for(var at=_$1.FILE_IDENTIFIER_LENGTH-1;at>=0;at--)this.writeInt8(st.charCodeAt(at))}this.prep(this.minalign,_$1.SIZEOF_INT+et),this.addOffset(d),et&&this.addInt32(this.bb.capacity()-this.space),this.bb.setPosition(this.space)},_$1.Builder.prototype.finishSizePrefixed=function(d,g){this.finish(d,g,!0)},_$1.Builder.prototype.requiredField=function(d,g){var b=this.bb.capacity()-d,et=b-this.bb.readInt32(b),st=this.bb.readInt16(et+g)!=0;if(!st)throw new Error("FlatBuffers: field "+g+" must be set")},_$1.Builder.prototype.startVector=function(d,g,b){this.notNested(),this.vector_num_elems=g,this.prep(_$1.SIZEOF_INT,d*g),this.prep(b,d*g)},_$1.Builder.prototype.endVector=function(){return this.writeInt32(this.vector_num_elems),this.offset()},_$1.Builder.prototype.createString=function(d){if(d instanceof Uint8Array)var g=d;else for(var g=[],b=0;b<d.length;){var et,st=d.charCodeAt(b++);if(st<55296||st>=56320)et=st;else{var at=d.charCodeAt(b++);et=(st<<10)+at+-56613888}et<128?g.push(et):(et<2048?g.push(et>>6&31|192):(et<65536?g.push(et>>12&15|224):g.push(et>>18&7|240,et>>12&63|128),g.push(et>>6&63|128)),g.push(et&63|128))}this.addInt8(0),this.startVector(1,g.length,1),this.bb.setPosition(this.space-=g.length);for(var b=0,vt=this.space,Tt=this.bb.bytes();b<g.length;b++)Tt[vt++]=g[b];return this.endVector()},_$1.Builder.prototype.createLong=function(d,g){return _$1.Long.create(d,g)},_$1.ByteBuffer=function(d){this.bytes_=d,this.position_=0},_$1.ByteBuffer.allocate=function(d){return new _$1.ByteBuffer(new Uint8Array(d))},_$1.ByteBuffer.prototype.clear=function(){this.position_=0},_$1.ByteBuffer.prototype.bytes=function(){return this.bytes_},_$1.ByteBuffer.prototype.position=function(){return this.position_},_$1.ByteBuffer.prototype.setPosition=function(d){this.position_=d},_$1.ByteBuffer.prototype.capacity=function(){return this.bytes_.length},_$1.ByteBuffer.prototype.readInt8=function(d){return this.readUint8(d)<<24>>24},_$1.ByteBuffer.prototype.readUint8=function(d){return this.bytes_[d]},_$1.ByteBuffer.prototype.readInt16=function(d){return this.readUint16(d)<<16>>16},_$1.ByteBuffer.prototype.readUint16=function(d){return this.bytes_[d]|this.bytes_[d+1]<<8},_$1.ByteBuffer.prototype.readInt32=function(d){return this.bytes_[d]|this.bytes_[d+1]<<8|this.bytes_[d+2]<<16|this.bytes_[d+3]<<24},_$1.ByteBuffer.prototype.readUint32=function(d){return this.readInt32(d)>>>0},_$1.ByteBuffer.prototype.readInt64=function(d){return new _$1.Long(this.readInt32(d),this.readInt32(d+4))},_$1.ByteBuffer.prototype.readUint64=function(d){return new _$1.Long(this.readUint32(d),this.readUint32(d+4))},_$1.ByteBuffer.prototype.readFloat32=function(d){return _$1.int32[0]=this.readInt32(d),_$1.float32[0]},_$1.ByteBuffer.prototype.readFloat64=function(d){return _$1.int32[_$1.isLittleEndian?0:1]=this.readInt32(d),_$1.int32[_$1.isLittleEndian?1:0]=this.readInt32(d+4),_$1.float64[0]},_$1.ByteBuffer.prototype.writeInt8=function(d,g){this.bytes_[d]=g},_$1.ByteBuffer.prototype.writeUint8=function(d,g){this.bytes_[d]=g},_$1.ByteBuffer.prototype.writeInt16=function(d,g){this.bytes_[d]=g,this.bytes_[d+1]=g>>8},_$1.ByteBuffer.prototype.writeUint16=function(d,g){this.bytes_[d]=g,this.bytes_[d+1]=g>>8},_$1.ByteBuffer.prototype.writeInt32=function(d,g){this.bytes_[d]=g,this.bytes_[d+1]=g>>8,this.bytes_[d+2]=g>>16,this.bytes_[d+3]=g>>24},_$1.ByteBuffer.prototype.writeUint32=function(d,g){this.bytes_[d]=g,this.bytes_[d+1]=g>>8,this.bytes_[d+2]=g>>16,this.bytes_[d+3]=g>>24},_$1.ByteBuffer.prototype.writeInt64=function(d,g){this.writeInt32(d,g.low),this.writeInt32(d+4,g.high)},_$1.ByteBuffer.prototype.writeUint64=function(d,g){this.writeUint32(d,g.low),this.writeUint32(d+4,g.high)},_$1.ByteBuffer.prototype.writeFloat32=function(d,g){_$1.float32[0]=g,this.writeInt32(d,_$1.int32[0])},_$1.ByteBuffer.prototype.writeFloat64=function(d,g){_$1.float64[0]=g,this.writeInt32(d,_$1.int32[_$1.isLittleEndian?0:1]),this.writeInt32(d+4,_$1.int32[_$1.isLittleEndian?1:0])},_$1.ByteBuffer.prototype.getBufferIdentifier=function(){if(this.bytes_.length<this.position_+_$1.SIZEOF_INT+_$1.FILE_IDENTIFIER_LENGTH)throw new Error("FlatBuffers: ByteBuffer is too short to contain an identifier.");for(var d="",g=0;g<_$1.FILE_IDENTIFIER_LENGTH;g++)d+=String.fromCharCode(this.readInt8(this.position_+_$1.SIZEOF_INT+g));return d},_$1.ByteBuffer.prototype.__offset=function(d,g){var b=d-this.readInt32(d);return g<this.readInt16(b)?this.readInt16(b+g):0},_$1.ByteBuffer.prototype.__union=function(d,g){return d.bb_pos=g+this.readInt32(g),d.bb=this,d},_$1.ByteBuffer.prototype.__string=function(d,g){d+=this.readInt32(d);var b=this.readInt32(d),et="",st=0;if(d+=_$1.SIZEOF_INT,g===_$1.Encoding.UTF8_BYTES)return this.bytes_.subarray(d,d+b);for(;st<b;){var at,vt=this.readUint8(d+st++);if(vt<192)at=vt;else{var Tt=this.readUint8(d+st++);if(vt<224)at=(vt&31)<<6|Tt&63;else{var Ct=this.readUint8(d+st++);if(vt<240)at=(vt&15)<<12|(Tt&63)<<6|Ct&63;else{var pt=this.readUint8(d+st++);at=(vt&7)<<18|(Tt&63)<<12|(Ct&63)<<6|pt&63}}}at<65536?et+=String.fromCharCode(at):(at-=65536,et+=String.fromCharCode((at>>10)+55296,(at&1023)+56320))}return et},_$1.ByteBuffer.prototype.__indirect=function(d){return d+this.readInt32(d)},_$1.ByteBuffer.prototype.__vector=function(d){return d+this.readInt32(d)+_$1.SIZEOF_INT},_$1.ByteBuffer.prototype.__vector_len=function(d){return this.readInt32(d+this.readInt32(d))},_$1.ByteBuffer.prototype.__has_identifier=function(d){if(d.length!=_$1.FILE_IDENTIFIER_LENGTH)throw new Error("FlatBuffers: file identifier must be length "+_$1.FILE_IDENTIFIER_LENGTH);for(var g=0;g<_$1.FILE_IDENTIFIER_LENGTH;g++)if(d.charCodeAt(g)!=this.readInt8(this.position_+_$1.SIZEOF_INT+g))return!1;return!0},_$1.ByteBuffer.prototype.createLong=function(d,g){return _$1.Long.create(d,g)}}),V,tn$1=L$1(()=>{zn$1(),(d=>{(g=>{(b=>{(et=>(et[et.UNDEFINED=0]="UNDEFINED",et[et.FLOAT=1]="FLOAT",et[et.INT=2]="INT",et[et.STRING=3]="STRING",et[et.TENSOR=4]="TENSOR",et[et.GRAPH=5]="GRAPH",et[et.FLOATS=6]="FLOATS",et[et.INTS=7]="INTS",et[et.STRINGS=8]="STRINGS",et[et.TENSORS=9]="TENSORS",et[et.GRAPHS=10]="GRAPHS",et[et.SPARSE_TENSOR=11]="SPARSE_TENSOR",et[et.SPARSE_TENSORS=12]="SPARSE_TENSORS"))(b.AttributeType||(b.AttributeType={}))})(g.fbs||(g.fbs={}))})(d.experimental||(d.experimental={}))})(V||(V={})),(d=>{(g=>{(b=>{(et=>(et[et.UNKNOWN=0]="UNKNOWN",et[et.VALUE=1]="VALUE",et[et.PARAM=2]="PARAM"))(b.DimensionValueType||(b.DimensionValueType={}))})(g.fbs||(g.fbs={}))})(d.experimental||(d.experimental={}))})(V||(V={})),(d=>{(g=>{(b=>{(et=>(et[et.UNDEFINED=0]="UNDEFINED",et[et.FLOAT=1]="FLOAT",et[et.UINT8=2]="UINT8",et[et.INT8=3]="INT8",et[et.UINT16=4]="UINT16",et[et.INT16=5]="INT16",et[et.INT32=6]="INT32",et[et.INT64=7]="INT64",et[et.STRING=8]="STRING",et[et.BOOL=9]="BOOL",et[et.FLOAT16=10]="FLOAT16",et[et.DOUBLE=11]="DOUBLE",et[et.UINT32=12]="UINT32",et[et.UINT64=13]="UINT64",et[et.COMPLEX64=14]="COMPLEX64",et[et.COMPLEX128=15]="COMPLEX128",et[et.BFLOAT16=16]="BFLOAT16",et[et.FLOAT8E4M3FN=17]="FLOAT8E4M3FN",et[et.FLOAT8E4M3FNUZ=18]="FLOAT8E4M3FNUZ",et[et.FLOAT8E5M2=19]="FLOAT8E5M2",et[et.FLOAT8E5M2FNUZ=20]="FLOAT8E5M2FNUZ"))(b.TensorDataType||(b.TensorDataType={}))})(g.fbs||(g.fbs={}))})(d.experimental||(d.experimental={}))})(V||(V={})),(d=>{(g=>{(b=>{(et=>(et[et.Primitive=0]="Primitive",et[et.Fused=1]="Fused"))(b.NodeType||(b.NodeType={}))})(g.fbs||(g.fbs={}))})(d.experimental||(d.experimental={}))})(V||(V={})),(d=>{(g=>{(b=>{(et=>(et[et.NONE=0]="NONE",et[et.tensor_type=1]="tensor_type",et[et.sequence_type=2]="sequence_type",et[et.map_type=3]="map_type"))(b.TypeInfoValue||(b.TypeInfoValue={}))})(g.fbs||(g.fbs={}))})(d.experimental||(d.experimental={}))})(V||(V={})),(d=>{(g=>{(b=>{class et{constructor(){this.bb=null,this.bb_pos=0}__init(at,vt){return this.bb_pos=at,this.bb=vt,this}static getRootAsShape(at,vt){return(vt||new et).__init(at.readInt32(at.position())+at.position(),at)}static getSizePrefixedRootAsShape(at,vt){return at.setPosition(at.position()+_$1.SIZE_PREFIX_LENGTH),(vt||new et).__init(at.readInt32(at.position())+at.position(),at)}dim(at,vt){let Tt=this.bb.__offset(this.bb_pos,4);return Tt?(vt||new d.experimental.fbs.Dimension).__init(this.bb.__indirect(this.bb.__vector(this.bb_pos+Tt)+at*4),this.bb):null}dimLength(){let at=this.bb.__offset(this.bb_pos,4);return at?this.bb.__vector_len(this.bb_pos+at):0}static startShape(at){at.startObject(1)}static addDim(at,vt){at.addFieldOffset(0,vt,0)}static createDimVector(at,vt){at.startVector(4,vt.length,4);for(let Tt=vt.length-1;Tt>=0;Tt--)at.addOffset(vt[Tt]);return at.endVector()}static startDimVector(at,vt){at.startVector(4,vt,4)}static endShape(at){return at.endObject()}static createShape(at,vt){return et.startShape(at),et.addDim(at,vt),et.endShape(at)}}b.Shape=et})(g.fbs||(g.fbs={}))})(d.experimental||(d.experimental={}))})(V||(V={})),(d=>{(g=>{(b=>{class et{constructor(){this.bb=null,this.bb_pos=0}__init(at,vt){return this.bb_pos=at,this.bb=vt,this}static getRootAsDimension(at,vt){return(vt||new et).__init(at.readInt32(at.position())+at.position(),at)}static getSizePrefixedRootAsDimension(at,vt){return at.setPosition(at.position()+_$1.SIZE_PREFIX_LENGTH),(vt||new et).__init(at.readInt32(at.position())+at.position(),at)}value(at){let vt=this.bb.__offset(this.bb_pos,4);return vt?(at||new d.experimental.fbs.DimensionValue).__init(this.bb.__indirect(this.bb_pos+vt),this.bb):null}denotation(at){let vt=this.bb.__offset(this.bb_pos,6);return vt?this.bb.__string(this.bb_pos+vt,at):null}static startDimension(at){at.startObject(2)}static addValue(at,vt){at.addFieldOffset(0,vt,0)}static addDenotation(at,vt){at.addFieldOffset(1,vt,0)}static endDimension(at){return at.endObject()}static createDimension(at,vt,Tt){return et.startDimension(at),et.addValue(at,vt),et.addDenotation(at,Tt),et.endDimension(at)}}b.Dimension=et})(g.fbs||(g.fbs={}))})(d.experimental||(d.experimental={}))})(V||(V={})),(d=>{(g=>{(b=>{class et{constructor(){this.bb=null,this.bb_pos=0}__init(at,vt){return this.bb_pos=at,this.bb=vt,this}static getRootAsDimensionValue(at,vt){return(vt||new et).__init(at.readInt32(at.position())+at.position(),at)}static getSizePrefixedRootAsDimensionValue(at,vt){return at.setPosition(at.position()+_$1.SIZE_PREFIX_LENGTH),(vt||new et).__init(at.readInt32(at.position())+at.position(),at)}dimType(){let at=this.bb.__offset(this.bb_pos,4);return at?this.bb.readInt8(this.bb_pos+at):0}dimValue(){let at=this.bb.__offset(this.bb_pos,6);return at?this.bb.readInt64(this.bb_pos+at):this.bb.createLong(0,0)}dimParam(at){let vt=this.bb.__offset(this.bb_pos,8);return vt?this.bb.__string(this.bb_pos+vt,at):null}static startDimensionValue(at){at.startObject(3)}static addDimType(at,vt){at.addFieldInt8(0,vt,0)}static addDimValue(at,vt){at.addFieldInt64(1,vt,at.createLong(0,0))}static addDimParam(at,vt){at.addFieldOffset(2,vt,0)}static endDimensionValue(at){return at.endObject()}static createDimensionValue(at,vt,Tt,Ct){return et.startDimensionValue(at),et.addDimType(at,vt),et.addDimValue(at,Tt),et.addDimParam(at,Ct),et.endDimensionValue(at)}}b.DimensionValue=et})(g.fbs||(g.fbs={}))})(d.experimental||(d.experimental={}))})(V||(V={})),(d=>{(g=>{(b=>{class et{constructor(){this.bb=null,this.bb_pos=0}__init(at,vt){return this.bb_pos=at,this.bb=vt,this}static getRootAsTensorTypeAndShape(at,vt){return(vt||new et).__init(at.readInt32(at.position())+at.position(),at)}static getSizePrefixedRootAsTensorTypeAndShape(at,vt){return at.setPosition(at.position()+_$1.SIZE_PREFIX_LENGTH),(vt||new et).__init(at.readInt32(at.position())+at.position(),at)}elemType(){let at=this.bb.__offset(this.bb_pos,4);return at?this.bb.readInt32(this.bb_pos+at):0}shape(at){let vt=this.bb.__offset(this.bb_pos,6);return vt?(at||new d.experimental.fbs.Shape).__init(this.bb.__indirect(this.bb_pos+vt),this.bb):null}static startTensorTypeAndShape(at){at.startObject(2)}static addElemType(at,vt){at.addFieldInt32(0,vt,0)}static addShape(at,vt){at.addFieldOffset(1,vt,0)}static endTensorTypeAndShape(at){return at.endObject()}static createTensorTypeAndShape(at,vt,Tt){return et.startTensorTypeAndShape(at),et.addElemType(at,vt),et.addShape(at,Tt),et.endTensorTypeAndShape(at)}}b.TensorTypeAndShape=et})(g.fbs||(g.fbs={}))})(d.experimental||(d.experimental={}))})(V||(V={})),(d=>{(g=>{(b=>{class et{constructor(){this.bb=null,this.bb_pos=0}__init(at,vt){return this.bb_pos=at,this.bb=vt,this}static getRootAsMapType(at,vt){return(vt||new et).__init(at.readInt32(at.position())+at.position(),at)}static getSizePrefixedRootAsMapType(at,vt){return at.setPosition(at.position()+_$1.SIZE_PREFIX_LENGTH),(vt||new et).__init(at.readInt32(at.position())+at.position(),at)}keyType(){let at=this.bb.__offset(this.bb_pos,4);return at?this.bb.readInt32(this.bb_pos+at):0}valueType(at){let vt=this.bb.__offset(this.bb_pos,6);return vt?(at||new d.experimental.fbs.TypeInfo).__init(this.bb.__indirect(this.bb_pos+vt),this.bb):null}static startMapType(at){at.startObject(2)}static addKeyType(at,vt){at.addFieldInt32(0,vt,0)}static addValueType(at,vt){at.addFieldOffset(1,vt,0)}static endMapType(at){return at.endObject()}static createMapType(at,vt,Tt){return et.startMapType(at),et.addKeyType(at,vt),et.addValueType(at,Tt),et.endMapType(at)}}b.MapType=et})(g.fbs||(g.fbs={}))})(d.experimental||(d.experimental={}))})(V||(V={})),(d=>{(g=>{(b=>{class et{constructor(){this.bb=null,this.bb_pos=0}__init(at,vt){return this.bb_pos=at,this.bb=vt,this}static getRootAsSequenceType(at,vt){return(vt||new et).__init(at.readInt32(at.position())+at.position(),at)}static getSizePrefixedRootAsSequenceType(at,vt){return at.setPosition(at.position()+_$1.SIZE_PREFIX_LENGTH),(vt||new et).__init(at.readInt32(at.position())+at.position(),at)}elemType(at){let vt=this.bb.__offset(this.bb_pos,4);return vt?(at||new d.experimental.fbs.TypeInfo).__init(this.bb.__indirect(this.bb_pos+vt),this.bb):null}static startSequenceType(at){at.startObject(1)}static addElemType(at,vt){at.addFieldOffset(0,vt,0)}static endSequenceType(at){return at.endObject()}static createSequenceType(at,vt){return et.startSequenceType(at),et.addElemType(at,vt),et.endSequenceType(at)}}b.SequenceType=et})(g.fbs||(g.fbs={}))})(d.experimental||(d.experimental={}))})(V||(V={})),(d=>{(g=>{(b=>{class et{constructor(){this.bb=null,this.bb_pos=0}__init(at,vt){return this.bb_pos=at,this.bb=vt,this}nodeIndex(){return this.bb.readUint32(this.bb_pos)}srcArgIndex(){return this.bb.readInt32(this.bb_pos+4)}dstArgIndex(){return this.bb.readInt32(this.bb_pos+8)}static createEdgeEnd(at,vt,Tt,Ct){return at.prep(4,12),at.writeInt32(Ct),at.writeInt32(Tt),at.writeInt32(vt),at.offset()}}b.EdgeEnd=et})(g.fbs||(g.fbs={}))})(d.experimental||(d.experimental={}))})(V||(V={})),(d=>{(g=>{(b=>{class et{constructor(){this.bb=null,this.bb_pos=0}__init(at,vt){return this.bb_pos=at,this.bb=vt,this}static getRootAsNodeEdge(at,vt){return(vt||new et).__init(at.readInt32(at.position())+at.position(),at)}static getSizePrefixedRootAsNodeEdge(at,vt){return at.setPosition(at.position()+_$1.SIZE_PREFIX_LENGTH),(vt||new et).__init(at.readInt32(at.position())+at.position(),at)}nodeIndex(){let at=this.bb.__offset(this.bb_pos,4);return at?this.bb.readUint32(this.bb_pos+at):0}inputEdges(at,vt){let Tt=this.bb.__offset(this.bb_pos,6);return Tt?(vt||new d.experimental.fbs.EdgeEnd).__init(this.bb.__vector(this.bb_pos+Tt)+at*12,this.bb):null}inputEdgesLength(){let at=this.bb.__offset(this.bb_pos,6);return at?this.bb.__vector_len(this.bb_pos+at):0}outputEdges(at,vt){let Tt=this.bb.__offset(this.bb_pos,8);return Tt?(vt||new d.experimental.fbs.EdgeEnd).__init(this.bb.__vector(this.bb_pos+Tt)+at*12,this.bb):null}outputEdgesLength(){let at=this.bb.__offset(this.bb_pos,8);return at?this.bb.__vector_len(this.bb_pos+at):0}static startNodeEdge(at){at.startObject(3)}static addNodeIndex(at,vt){at.addFieldInt32(0,vt,0)}static addInputEdges(at,vt){at.addFieldOffset(1,vt,0)}static startInputEdgesVector(at,vt){at.startVector(12,vt,4)}static addOutputEdges(at,vt){at.addFieldOffset(2,vt,0)}static startOutputEdgesVector(at,vt){at.startVector(12,vt,4)}static endNodeEdge(at){return at.endObject()}static createNodeEdge(at,vt,Tt,Ct){return et.startNodeEdge(at),et.addNodeIndex(at,vt),et.addInputEdges(at,Tt),et.addOutputEdges(at,Ct),et.endNodeEdge(at)}}b.NodeEdge=et})(g.fbs||(g.fbs={}))})(d.experimental||(d.experimental={}))})(V||(V={})),(d=>{(g=>{(b=>{class et{constructor(){this.bb=null,this.bb_pos=0}__init(at,vt){return this.bb_pos=at,this.bb=vt,this}static getRootAsNode(at,vt){return(vt||new et).__init(at.readInt32(at.position())+at.position(),at)}static getSizePrefixedRootAsNode(at,vt){return at.setPosition(at.position()+_$1.SIZE_PREFIX_LENGTH),(vt||new et).__init(at.readInt32(at.position())+at.position(),at)}name(at){let vt=this.bb.__offset(this.bb_pos,4);return vt?this.bb.__string(this.bb_pos+vt,at):null}docString(at){let vt=this.bb.__offset(this.bb_pos,6);return vt?this.bb.__string(this.bb_pos+vt,at):null}domain(at){let vt=this.bb.__offset(this.bb_pos,8);return vt?this.bb.__string(this.bb_pos+vt,at):null}sinceVersion(){let at=this.bb.__offset(this.bb_pos,10);return at?this.bb.readInt32(this.bb_pos+at):0}index(){let at=this.bb.__offset(this.bb_pos,12);return at?this.bb.readUint32(this.bb_pos+at):0}opType(at){let vt=this.bb.__offset(this.bb_pos,14);return vt?this.bb.__string(this.bb_pos+vt,at):null}type(){let at=this.bb.__offset(this.bb_pos,16);return at?this.bb.readInt32(this.bb_pos+at):0}executionProviderType(at){let vt=this.bb.__offset(this.bb_pos,18);return vt?this.bb.__string(this.bb_pos+vt,at):null}inputs(at,vt){let Tt=this.bb.__offset(this.bb_pos,20);return Tt?this.bb.__string(this.bb.__vector(this.bb_pos+Tt)+at*4,vt):null}inputsLength(){let at=this.bb.__offset(this.bb_pos,20);return at?this.bb.__vector_len(this.bb_pos+at):0}outputs(at,vt){let Tt=this.bb.__offset(this.bb_pos,22);return Tt?this.bb.__string(this.bb.__vector(this.bb_pos+Tt)+at*4,vt):null}outputsLength(){let at=this.bb.__offset(this.bb_pos,22);return at?this.bb.__vector_len(this.bb_pos+at):0}attributes(at,vt){let Tt=this.bb.__offset(this.bb_pos,24);return Tt?(vt||new d.experimental.fbs.Attribute).__init(this.bb.__indirect(this.bb.__vector(this.bb_pos+Tt)+at*4),this.bb):null}attributesLength(){let at=this.bb.__offset(this.bb_pos,24);return at?this.bb.__vector_len(this.bb_pos+at):0}inputArgCounts(at){let vt=this.bb.__offset(this.bb_pos,26);return vt?this.bb.readInt32(this.bb.__vector(this.bb_pos+vt)+at*4):0}inputArgCountsLength(){let at=this.bb.__offset(this.bb_pos,26);return at?this.bb.__vector_len(this.bb_pos+at):0}inputArgCountsArray(){let at=this.bb.__offset(this.bb_pos,26);return at?new Int32Array(this.bb.bytes().buffer,this.bb.bytes().byteOffset+this.bb.__vector(this.bb_pos+at),this.bb.__vector_len(this.bb_pos+at)):null}implicitInputs(at,vt){let Tt=this.bb.__offset(this.bb_pos,28);return Tt?this.bb.__string(this.bb.__vector(this.bb_pos+Tt)+at*4,vt):null}implicitInputsLength(){let at=this.bb.__offset(this.bb_pos,28);return at?this.bb.__vector_len(this.bb_pos+at):0}static startNode(at){at.startObject(13)}static addName(at,vt){at.addFieldOffset(0,vt,0)}static addDocString(at,vt){at.addFieldOffset(1,vt,0)}static addDomain(at,vt){at.addFieldOffset(2,vt,0)}static addSinceVersion(at,vt){at.addFieldInt32(3,vt,0)}static addIndex(at,vt){at.addFieldInt32(4,vt,0)}static addOpType(at,vt){at.addFieldOffset(5,vt,0)}static addType(at,vt){at.addFieldInt32(6,vt,0)}static addExecutionProviderType(at,vt){at.addFieldOffset(7,vt,0)}static addInputs(at,vt){at.addFieldOffset(8,vt,0)}static createInputsVector(at,vt){at.startVector(4,vt.length,4);for(let Tt=vt.length-1;Tt>=0;Tt--)at.addOffset(vt[Tt]);return at.endVector()}static startInputsVector(at,vt){at.startVector(4,vt,4)}static addOutputs(at,vt){at.addFieldOffset(9,vt,0)}static createOutputsVector(at,vt){at.startVector(4,vt.length,4);for(let Tt=vt.length-1;Tt>=0;Tt--)at.addOffset(vt[Tt]);return at.endVector()}static startOutputsVector(at,vt){at.startVector(4,vt,4)}static addAttributes(at,vt){at.addFieldOffset(10,vt,0)}static createAttributesVector(at,vt){at.startVector(4,vt.length,4);for(let Tt=vt.length-1;Tt>=0;Tt--)at.addOffset(vt[Tt]);return at.endVector()}static startAttributesVector(at,vt){at.startVector(4,vt,4)}static addInputArgCounts(at,vt){at.addFieldOffset(11,vt,0)}static createInputArgCountsVector(at,vt){at.startVector(4,vt.length,4);for(let Tt=vt.length-1;Tt>=0;Tt--)at.addInt32(vt[Tt]);return at.endVector()}static startInputArgCountsVector(at,vt){at.startVector(4,vt,4)}static addImplicitInputs(at,vt){at.addFieldOffset(12,vt,0)}static createImplicitInputsVector(at,vt){at.startVector(4,vt.length,4);for(let Tt=vt.length-1;Tt>=0;Tt--)at.addOffset(vt[Tt]);return at.endVector()}static startImplicitInputsVector(at,vt){at.startVector(4,vt,4)}static endNode(at){return at.endObject()}static createNode(at,vt,Tt,Ct,pt,wt,$t,Lt,jt,Ft,Gt,Ht,qt,Kt){return et.startNode(at),et.addName(at,vt),et.addDocString(at,Tt),et.addDomain(at,Ct),et.addSinceVersion(at,pt),et.addIndex(at,wt),et.addOpType(at,$t),et.addType(at,Lt),et.addExecutionProviderType(at,jt),et.addInputs(at,Ft),et.addOutputs(at,Gt),et.addAttributes(at,Ht),et.addInputArgCounts(at,qt),et.addImplicitInputs(at,Kt),et.endNode(at)}}b.Node=et})(g.fbs||(g.fbs={}))})(d.experimental||(d.experimental={}))})(V||(V={})),(d=>{(g=>{(b=>{class et{constructor(){this.bb=null,this.bb_pos=0}__init(at,vt){return this.bb_pos=at,this.bb=vt,this}static getRootAsValueInfo(at,vt){return(vt||new et).__init(at.readInt32(at.position())+at.position(),at)}static getSizePrefixedRootAsValueInfo(at,vt){return at.setPosition(at.position()+_$1.SIZE_PREFIX_LENGTH),(vt||new et).__init(at.readInt32(at.position())+at.position(),at)}name(at){let vt=this.bb.__offset(this.bb_pos,4);return vt?this.bb.__string(this.bb_pos+vt,at):null}docString(at){let vt=this.bb.__offset(this.bb_pos,6);return vt?this.bb.__string(this.bb_pos+vt,at):null}type(at){let vt=this.bb.__offset(this.bb_pos,8);return vt?(at||new d.experimental.fbs.TypeInfo).__init(this.bb.__indirect(this.bb_pos+vt),this.bb):null}static startValueInfo(at){at.startObject(3)}static addName(at,vt){at.addFieldOffset(0,vt,0)}static addDocString(at,vt){at.addFieldOffset(1,vt,0)}static addType(at,vt){at.addFieldOffset(2,vt,0)}static endValueInfo(at){return at.endObject()}static createValueInfo(at,vt,Tt,Ct){return et.startValueInfo(at),et.addName(at,vt),et.addDocString(at,Tt),et.addType(at,Ct),et.endValueInfo(at)}}b.ValueInfo=et})(g.fbs||(g.fbs={}))})(d.experimental||(d.experimental={}))})(V||(V={})),(d=>{(g=>{(b=>{class et{constructor(){this.bb=null,this.bb_pos=0}__init(at,vt){return this.bb_pos=at,this.bb=vt,this}static getRootAsTypeInfo(at,vt){return(vt||new et).__init(at.readInt32(at.position())+at.position(),at)}static getSizePrefixedRootAsTypeInfo(at,vt){return at.setPosition(at.position()+_$1.SIZE_PREFIX_LENGTH),(vt||new et).__init(at.readInt32(at.position())+at.position(),at)}denotation(at){let vt=this.bb.__offset(this.bb_pos,4);return vt?this.bb.__string(this.bb_pos+vt,at):null}valueType(){let at=this.bb.__offset(this.bb_pos,6);return at?this.bb.readUint8(this.bb_pos+at):0}value(at){let vt=this.bb.__offset(this.bb_pos,8);return vt?this.bb.__union(at,this.bb_pos+vt):null}static startTypeInfo(at){at.startObject(3)}static addDenotation(at,vt){at.addFieldOffset(0,vt,0)}static addValueType(at,vt){at.addFieldInt8(1,vt,0)}static addValue(at,vt){at.addFieldOffset(2,vt,0)}static endTypeInfo(at){return at.endObject()}static createTypeInfo(at,vt,Tt,Ct){return et.startTypeInfo(at),et.addDenotation(at,vt),et.addValueType(at,Tt),et.addValue(at,Ct),et.endTypeInfo(at)}}b.TypeInfo=et})(g.fbs||(g.fbs={}))})(d.experimental||(d.experimental={}))})(V||(V={})),(d=>{(g=>{(b=>{class et{constructor(){this.bb=null,this.bb_pos=0}__init(at,vt){return this.bb_pos=at,this.bb=vt,this}static getRootAsOperatorSetId(at,vt){return(vt||new et).__init(at.readInt32(at.position())+at.position(),at)}static getSizePrefixedRootAsOperatorSetId(at,vt){return at.setPosition(at.position()+_$1.SIZE_PREFIX_LENGTH),(vt||new et).__init(at.readInt32(at.position())+at.position(),at)}domain(at){let vt=this.bb.__offset(this.bb_pos,4);return vt?this.bb.__string(this.bb_pos+vt,at):null}version(){let at=this.bb.__offset(this.bb_pos,6);return at?this.bb.readInt64(this.bb_pos+at):this.bb.createLong(0,0)}static startOperatorSetId(at){at.startObject(2)}static addDomain(at,vt){at.addFieldOffset(0,vt,0)}static addVersion(at,vt){at.addFieldInt64(1,vt,at.createLong(0,0))}static endOperatorSetId(at){return at.endObject()}static createOperatorSetId(at,vt,Tt){return et.startOperatorSetId(at),et.addDomain(at,vt),et.addVersion(at,Tt),et.endOperatorSetId(at)}}b.OperatorSetId=et})(g.fbs||(g.fbs={}))})(d.experimental||(d.experimental={}))})(V||(V={})),(d=>{(g=>{(b=>{class et{constructor(){this.bb=null,this.bb_pos=0}__init(at,vt){return this.bb_pos=at,this.bb=vt,this}static getRootAsTensor(at,vt){return(vt||new et).__init(at.readInt32(at.position())+at.position(),at)}static getSizePrefixedRootAsTensor(at,vt){return at.setPosition(at.position()+_$1.SIZE_PREFIX_LENGTH),(vt||new et).__init(at.readInt32(at.position())+at.position(),at)}name(at){let vt=this.bb.__offset(this.bb_pos,4);return vt?this.bb.__string(this.bb_pos+vt,at):null}docString(at){let vt=this.bb.__offset(this.bb_pos,6);return vt?this.bb.__string(this.bb_pos+vt,at):null}dims(at){let vt=this.bb.__offset(this.bb_pos,8);return vt?this.bb.readInt64(this.bb.__vector(this.bb_pos+vt)+at*8):this.bb.createLong(0,0)}dimsLength(){let at=this.bb.__offset(this.bb_pos,8);return at?this.bb.__vector_len(this.bb_pos+at):0}dataType(){let at=this.bb.__offset(this.bb_pos,10);return at?this.bb.readInt32(this.bb_pos+at):0}rawData(at){let vt=this.bb.__offset(this.bb_pos,12);return vt?this.bb.readUint8(this.bb.__vector(this.bb_pos+vt)+at):0}rawDataLength(){let at=this.bb.__offset(this.bb_pos,12);return at?this.bb.__vector_len(this.bb_pos+at):0}rawDataArray(){let at=this.bb.__offset(this.bb_pos,12);return at?new Uint8Array(this.bb.bytes().buffer,this.bb.bytes().byteOffset+this.bb.__vector(this.bb_pos+at),this.bb.__vector_len(this.bb_pos+at)):null}stringData(at,vt){let Tt=this.bb.__offset(this.bb_pos,14);return Tt?this.bb.__string(this.bb.__vector(this.bb_pos+Tt)+at*4,vt):null}stringDataLength(){let at=this.bb.__offset(this.bb_pos,14);return at?this.bb.__vector_len(this.bb_pos+at):0}static startTensor(at){at.startObject(6)}static addName(at,vt){at.addFieldOffset(0,vt,0)}static addDocString(at,vt){at.addFieldOffset(1,vt,0)}static addDims(at,vt){at.addFieldOffset(2,vt,0)}static createDimsVector(at,vt){at.startVector(8,vt.length,8);for(let Tt=vt.length-1;Tt>=0;Tt--)at.addInt64(vt[Tt]);return at.endVector()}static startDimsVector(at,vt){at.startVector(8,vt,8)}static addDataType(at,vt){at.addFieldInt32(3,vt,0)}static addRawData(at,vt){at.addFieldOffset(4,vt,0)}static createRawDataVector(at,vt){at.startVector(1,vt.length,1);for(let Tt=vt.length-1;Tt>=0;Tt--)at.addInt8(vt[Tt]);return at.endVector()}static startRawDataVector(at,vt){at.startVector(1,vt,1)}static addStringData(at,vt){at.addFieldOffset(5,vt,0)}static createStringDataVector(at,vt){at.startVector(4,vt.length,4);for(let Tt=vt.length-1;Tt>=0;Tt--)at.addOffset(vt[Tt]);return at.endVector()}static startStringDataVector(at,vt){at.startVector(4,vt,4)}static endTensor(at){return at.endObject()}static createTensor(at,vt,Tt,Ct,pt,wt,$t){return et.startTensor(at),et.addName(at,vt),et.addDocString(at,Tt),et.addDims(at,Ct),et.addDataType(at,pt),et.addRawData(at,wt),et.addStringData(at,$t),et.endTensor(at)}}b.Tensor=et})(g.fbs||(g.fbs={}))})(d.experimental||(d.experimental={}))})(V||(V={})),(d=>{(g=>{(b=>{class et{constructor(){this.bb=null,this.bb_pos=0}__init(at,vt){return this.bb_pos=at,this.bb=vt,this}static getRootAsSparseTensor(at,vt){return(vt||new et).__init(at.readInt32(at.position())+at.position(),at)}static getSizePrefixedRootAsSparseTensor(at,vt){return at.setPosition(at.position()+_$1.SIZE_PREFIX_LENGTH),(vt||new et).__init(at.readInt32(at.position())+at.position(),at)}values(at){let vt=this.bb.__offset(this.bb_pos,4);return vt?(at||new d.experimental.fbs.Tensor).__init(this.bb.__indirect(this.bb_pos+vt),this.bb):null}indices(at){let vt=this.bb.__offset(this.bb_pos,6);return vt?(at||new d.experimental.fbs.Tensor).__init(this.bb.__indirect(this.bb_pos+vt),this.bb):null}dims(at){let vt=this.bb.__offset(this.bb_pos,8);return vt?this.bb.readInt64(this.bb.__vector(this.bb_pos+vt)+at*8):this.bb.createLong(0,0)}dimsLength(){let at=this.bb.__offset(this.bb_pos,8);return at?this.bb.__vector_len(this.bb_pos+at):0}static startSparseTensor(at){at.startObject(3)}static addValues(at,vt){at.addFieldOffset(0,vt,0)}static addIndices(at,vt){at.addFieldOffset(1,vt,0)}static addDims(at,vt){at.addFieldOffset(2,vt,0)}static createDimsVector(at,vt){at.startVector(8,vt.length,8);for(let Tt=vt.length-1;Tt>=0;Tt--)at.addInt64(vt[Tt]);return at.endVector()}static startDimsVector(at,vt){at.startVector(8,vt,8)}static endSparseTensor(at){return at.endObject()}static createSparseTensor(at,vt,Tt,Ct){return et.startSparseTensor(at),et.addValues(at,vt),et.addIndices(at,Tt),et.addDims(at,Ct),et.endSparseTensor(at)}}b.SparseTensor=et})(g.fbs||(g.fbs={}))})(d.experimental||(d.experimental={}))})(V||(V={})),(d=>{(g=>{(b=>{class et{constructor(){this.bb=null,this.bb_pos=0}__init(at,vt){return this.bb_pos=at,this.bb=vt,this}static getRootAsAttribute(at,vt){return(vt||new et).__init(at.readInt32(at.position())+at.position(),at)}static getSizePrefixedRootAsAttribute(at,vt){return at.setPosition(at.position()+_$1.SIZE_PREFIX_LENGTH),(vt||new et).__init(at.readInt32(at.position())+at.position(),at)}name(at){let vt=this.bb.__offset(this.bb_pos,4);return vt?this.bb.__string(this.bb_pos+vt,at):null}docString(at){let vt=this.bb.__offset(this.bb_pos,6);return vt?this.bb.__string(this.bb_pos+vt,at):null}type(){let at=this.bb.__offset(this.bb_pos,8);return at?this.bb.readInt32(this.bb_pos+at):0}f(){let at=this.bb.__offset(this.bb_pos,10);return at?this.bb.readFloat32(this.bb_pos+at):0}i(){let at=this.bb.__offset(this.bb_pos,12);return at?this.bb.readInt64(this.bb_pos+at):this.bb.createLong(0,0)}s(at){let vt=this.bb.__offset(this.bb_pos,14);return vt?this.bb.__string(this.bb_pos+vt,at):null}t(at){let vt=this.bb.__offset(this.bb_pos,16);return vt?(at||new d.experimental.fbs.Tensor).__init(this.bb.__indirect(this.bb_pos+vt),this.bb):null}g(at){let vt=this.bb.__offset(this.bb_pos,18);return vt?(at||new d.experimental.fbs.Graph).__init(this.bb.__indirect(this.bb_pos+vt),this.bb):null}floats(at){let vt=this.bb.__offset(this.bb_pos,20);return vt?this.bb.readFloat32(this.bb.__vector(this.bb_pos+vt)+at*4):0}floatsLength(){let at=this.bb.__offset(this.bb_pos,20);return at?this.bb.__vector_len(this.bb_pos+at):0}floatsArray(){let at=this.bb.__offset(this.bb_pos,20);return at?new Float32Array(this.bb.bytes().buffer,this.bb.bytes().byteOffset+this.bb.__vector(this.bb_pos+at),this.bb.__vector_len(this.bb_pos+at)):null}ints(at){let vt=this.bb.__offset(this.bb_pos,22);return vt?this.bb.readInt64(this.bb.__vector(this.bb_pos+vt)+at*8):this.bb.createLong(0,0)}intsLength(){let at=this.bb.__offset(this.bb_pos,22);return at?this.bb.__vector_len(this.bb_pos+at):0}strings(at,vt){let Tt=this.bb.__offset(this.bb_pos,24);return Tt?this.bb.__string(this.bb.__vector(this.bb_pos+Tt)+at*4,vt):null}stringsLength(){let at=this.bb.__offset(this.bb_pos,24);return at?this.bb.__vector_len(this.bb_pos+at):0}tensors(at,vt){let Tt=this.bb.__offset(this.bb_pos,26);return Tt?(vt||new d.experimental.fbs.Tensor).__init(this.bb.__indirect(this.bb.__vector(this.bb_pos+Tt)+at*4),this.bb):null}tensorsLength(){let at=this.bb.__offset(this.bb_pos,26);return at?this.bb.__vector_len(this.bb_pos+at):0}graphs(at,vt){let Tt=this.bb.__offset(this.bb_pos,28);return Tt?(vt||new d.experimental.fbs.Graph).__init(this.bb.__indirect(this.bb.__vector(this.bb_pos+Tt)+at*4),this.bb):null}graphsLength(){let at=this.bb.__offset(this.bb_pos,28);return at?this.bb.__vector_len(this.bb_pos+at):0}static startAttribute(at){at.startObject(13)}static addName(at,vt){at.addFieldOffset(0,vt,0)}static addDocString(at,vt){at.addFieldOffset(1,vt,0)}static addType(at,vt){at.addFieldInt32(2,vt,0)}static addF(at,vt){at.addFieldFloat32(3,vt,0)}static addI(at,vt){at.addFieldInt64(4,vt,at.createLong(0,0))}static addS(at,vt){at.addFieldOffset(5,vt,0)}static addT(at,vt){at.addFieldOffset(6,vt,0)}static addG(at,vt){at.addFieldOffset(7,vt,0)}static addFloats(at,vt){at.addFieldOffset(8,vt,0)}static createFloatsVector(at,vt){at.startVector(4,vt.length,4);for(let Tt=vt.length-1;Tt>=0;Tt--)at.addFloat32(vt[Tt]);return at.endVector()}static startFloatsVector(at,vt){at.startVector(4,vt,4)}static addInts(at,vt){at.addFieldOffset(9,vt,0)}static createIntsVector(at,vt){at.startVector(8,vt.length,8);for(let Tt=vt.length-1;Tt>=0;Tt--)at.addInt64(vt[Tt]);return at.endVector()}static startIntsVector(at,vt){at.startVector(8,vt,8)}static addStrings(at,vt){at.addFieldOffset(10,vt,0)}static createStringsVector(at,vt){at.startVector(4,vt.length,4);for(let Tt=vt.length-1;Tt>=0;Tt--)at.addOffset(vt[Tt]);return at.endVector()}static startStringsVector(at,vt){at.startVector(4,vt,4)}static addTensors(at,vt){at.addFieldOffset(11,vt,0)}static createTensorsVector(at,vt){at.startVector(4,vt.length,4);for(let Tt=vt.length-1;Tt>=0;Tt--)at.addOffset(vt[Tt]);return at.endVector()}static startTensorsVector(at,vt){at.startVector(4,vt,4)}static addGraphs(at,vt){at.addFieldOffset(12,vt,0)}static createGraphsVector(at,vt){at.startVector(4,vt.length,4);for(let Tt=vt.length-1;Tt>=0;Tt--)at.addOffset(vt[Tt]);return at.endVector()}static startGraphsVector(at,vt){at.startVector(4,vt,4)}static endAttribute(at){return at.endObject()}static createAttribute(at,vt,Tt,Ct,pt,wt,$t,Lt,jt,Ft,Gt,Ht,qt,Kt){return et.startAttribute(at),et.addName(at,vt),et.addDocString(at,Tt),et.addType(at,Ct),et.addF(at,pt),et.addI(at,wt),et.addS(at,$t),et.addT(at,Lt),et.addG(at,jt),et.addFloats(at,Ft),et.addInts(at,Gt),et.addStrings(at,Ht),et.addTensors(at,qt),et.addGraphs(at,Kt),et.endAttribute(at)}}b.Attribute=et})(g.fbs||(g.fbs={}))})(d.experimental||(d.experimental={}))})(V||(V={})),(d=>{(g=>{(b=>{class et{constructor(){this.bb=null,this.bb_pos=0}__init(at,vt){return this.bb_pos=at,this.bb=vt,this}static getRootAsGraph(at,vt){return(vt||new et).__init(at.readInt32(at.position())+at.position(),at)}static getSizePrefixedRootAsGraph(at,vt){return at.setPosition(at.position()+_$1.SIZE_PREFIX_LENGTH),(vt||new et).__init(at.readInt32(at.position())+at.position(),at)}initializers(at,vt){let Tt=this.bb.__offset(this.bb_pos,4);return Tt?(vt||new d.experimental.fbs.Tensor).__init(this.bb.__indirect(this.bb.__vector(this.bb_pos+Tt)+at*4),this.bb):null}initializersLength(){let at=this.bb.__offset(this.bb_pos,4);return at?this.bb.__vector_len(this.bb_pos+at):0}nodeArgs(at,vt){let Tt=this.bb.__offset(this.bb_pos,6);return Tt?(vt||new d.experimental.fbs.ValueInfo).__init(this.bb.__indirect(this.bb.__vector(this.bb_pos+Tt)+at*4),this.bb):null}nodeArgsLength(){let at=this.bb.__offset(this.bb_pos,6);return at?this.bb.__vector_len(this.bb_pos+at):0}nodes(at,vt){let Tt=this.bb.__offset(this.bb_pos,8);return Tt?(vt||new d.experimental.fbs.Node).__init(this.bb.__indirect(this.bb.__vector(this.bb_pos+Tt)+at*4),this.bb):null}nodesLength(){let at=this.bb.__offset(this.bb_pos,8);return at?this.bb.__vector_len(this.bb_pos+at):0}maxNodeIndex(){let at=this.bb.__offset(this.bb_pos,10);return at?this.bb.readUint32(this.bb_pos+at):0}nodeEdges(at,vt){let Tt=this.bb.__offset(this.bb_pos,12);return Tt?(vt||new d.experimental.fbs.NodeEdge).__init(this.bb.__indirect(this.bb.__vector(this.bb_pos+Tt)+at*4),this.bb):null}nodeEdgesLength(){let at=this.bb.__offset(this.bb_pos,12);return at?this.bb.__vector_len(this.bb_pos+at):0}inputs(at,vt){let Tt=this.bb.__offset(this.bb_pos,14);return Tt?this.bb.__string(this.bb.__vector(this.bb_pos+Tt)+at*4,vt):null}inputsLength(){let at=this.bb.__offset(this.bb_pos,14);return at?this.bb.__vector_len(this.bb_pos+at):0}outputs(at,vt){let Tt=this.bb.__offset(this.bb_pos,16);return Tt?this.bb.__string(this.bb.__vector(this.bb_pos+Tt)+at*4,vt):null}outputsLength(){let at=this.bb.__offset(this.bb_pos,16);return at?this.bb.__vector_len(this.bb_pos+at):0}sparseInitializers(at,vt){let Tt=this.bb.__offset(this.bb_pos,18);return Tt?(vt||new d.experimental.fbs.SparseTensor).__init(this.bb.__indirect(this.bb.__vector(this.bb_pos+Tt)+at*4),this.bb):null}sparseInitializersLength(){let at=this.bb.__offset(this.bb_pos,18);return at?this.bb.__vector_len(this.bb_pos+at):0}static startGraph(at){at.startObject(8)}static addInitializers(at,vt){at.addFieldOffset(0,vt,0)}static createInitializersVector(at,vt){at.startVector(4,vt.length,4);for(let Tt=vt.length-1;Tt>=0;Tt--)at.addOffset(vt[Tt]);return at.endVector()}static startInitializersVector(at,vt){at.startVector(4,vt,4)}static addNodeArgs(at,vt){at.addFieldOffset(1,vt,0)}static createNodeArgsVector(at,vt){at.startVector(4,vt.length,4);for(let Tt=vt.length-1;Tt>=0;Tt--)at.addOffset(vt[Tt]);return at.endVector()}static startNodeArgsVector(at,vt){at.startVector(4,vt,4)}static addNodes(at,vt){at.addFieldOffset(2,vt,0)}static createNodesVector(at,vt){at.startVector(4,vt.length,4);for(let Tt=vt.length-1;Tt>=0;Tt--)at.addOffset(vt[Tt]);return at.endVector()}static startNodesVector(at,vt){at.startVector(4,vt,4)}static addMaxNodeIndex(at,vt){at.addFieldInt32(3,vt,0)}static addNodeEdges(at,vt){at.addFieldOffset(4,vt,0)}static createNodeEdgesVector(at,vt){at.startVector(4,vt.length,4);for(let Tt=vt.length-1;Tt>=0;Tt--)at.addOffset(vt[Tt]);return at.endVector()}static startNodeEdgesVector(at,vt){at.startVector(4,vt,4)}static addInputs(at,vt){at.addFieldOffset(5,vt,0)}static createInputsVector(at,vt){at.startVector(4,vt.length,4);for(let Tt=vt.length-1;Tt>=0;Tt--)at.addOffset(vt[Tt]);return at.endVector()}static startInputsVector(at,vt){at.startVector(4,vt,4)}static addOutputs(at,vt){at.addFieldOffset(6,vt,0)}static createOutputsVector(at,vt){at.startVector(4,vt.length,4);for(let Tt=vt.length-1;Tt>=0;Tt--)at.addOffset(vt[Tt]);return at.endVector()}static startOutputsVector(at,vt){at.startVector(4,vt,4)}static addSparseInitializers(at,vt){at.addFieldOffset(7,vt,0)}static createSparseInitializersVector(at,vt){at.startVector(4,vt.length,4);for(let Tt=vt.length-1;Tt>=0;Tt--)at.addOffset(vt[Tt]);return at.endVector()}static startSparseInitializersVector(at,vt){at.startVector(4,vt,4)}static endGraph(at){return at.endObject()}static createGraph(at,vt,Tt,Ct,pt,wt,$t,Lt,jt){return et.startGraph(at),et.addInitializers(at,vt),et.addNodeArgs(at,Tt),et.addNodes(at,Ct),et.addMaxNodeIndex(at,pt),et.addNodeEdges(at,wt),et.addInputs(at,$t),et.addOutputs(at,Lt),et.addSparseInitializers(at,jt),et.endGraph(at)}}b.Graph=et})(g.fbs||(g.fbs={}))})(d.experimental||(d.experimental={}))})(V||(V={})),(d=>{(g=>{(b=>{class et{constructor(){this.bb=null,this.bb_pos=0}__init(at,vt){return this.bb_pos=at,this.bb=vt,this}static getRootAsModel(at,vt){return(vt||new et).__init(at.readInt32(at.position())+at.position(),at)}static getSizePrefixedRootAsModel(at,vt){return at.setPosition(at.position()+_$1.SIZE_PREFIX_LENGTH),(vt||new et).__init(at.readInt32(at.position())+at.position(),at)}irVersion(){let at=this.bb.__offset(this.bb_pos,4);return at?this.bb.readInt64(this.bb_pos+at):this.bb.createLong(0,0)}opsetImport(at,vt){let Tt=this.bb.__offset(this.bb_pos,6);return Tt?(vt||new d.experimental.fbs.OperatorSetId).__init(this.bb.__indirect(this.bb.__vector(this.bb_pos+Tt)+at*4),this.bb):null}opsetImportLength(){let at=this.bb.__offset(this.bb_pos,6);return at?this.bb.__vector_len(this.bb_pos+at):0}producerName(at){let vt=this.bb.__offset(this.bb_pos,8);return vt?this.bb.__string(this.bb_pos+vt,at):null}producerVersion(at){let vt=this.bb.__offset(this.bb_pos,10);return vt?this.bb.__string(this.bb_pos+vt,at):null}domain(at){let vt=this.bb.__offset(this.bb_pos,12);return vt?this.bb.__string(this.bb_pos+vt,at):null}modelVersion(){let at=this.bb.__offset(this.bb_pos,14);return at?this.bb.readInt64(this.bb_pos+at):this.bb.createLong(0,0)}docString(at){let vt=this.bb.__offset(this.bb_pos,16);return vt?this.bb.__string(this.bb_pos+vt,at):null}graph(at){let vt=this.bb.__offset(this.bb_pos,18);return vt?(at||new d.experimental.fbs.Graph).__init(this.bb.__indirect(this.bb_pos+vt),this.bb):null}graphDocString(at){let vt=this.bb.__offset(this.bb_pos,20);return vt?this.bb.__string(this.bb_pos+vt,at):null}static startModel(at){at.startObject(9)}static addIrVersion(at,vt){at.addFieldInt64(0,vt,at.createLong(0,0))}static addOpsetImport(at,vt){at.addFieldOffset(1,vt,0)}static createOpsetImportVector(at,vt){at.startVector(4,vt.length,4);for(let Tt=vt.length-1;Tt>=0;Tt--)at.addOffset(vt[Tt]);return at.endVector()}static startOpsetImportVector(at,vt){at.startVector(4,vt,4)}static addProducerName(at,vt){at.addFieldOffset(2,vt,0)}static addProducerVersion(at,vt){at.addFieldOffset(3,vt,0)}static addDomain(at,vt){at.addFieldOffset(4,vt,0)}static addModelVersion(at,vt){at.addFieldInt64(5,vt,at.createLong(0,0))}static addDocString(at,vt){at.addFieldOffset(6,vt,0)}static addGraph(at,vt){at.addFieldOffset(7,vt,0)}static addGraphDocString(at,vt){at.addFieldOffset(8,vt,0)}static endModel(at){return at.endObject()}static createModel(at,vt,Tt,Ct,pt,wt,$t,Lt,jt,Ft){return et.startModel(at),et.addIrVersion(at,vt),et.addOpsetImport(at,Tt),et.addProducerName(at,Ct),et.addProducerVersion(at,pt),et.addDomain(at,wt),et.addModelVersion(at,$t),et.addDocString(at,Lt),et.addGraph(at,jt),et.addGraphDocString(at,Ft),et.endModel(at)}}b.Model=et})(g.fbs||(g.fbs={}))})(d.experimental||(d.experimental={}))})(V||(V={})),(d=>{(g=>{(b=>{class et{constructor(){this.bb=null,this.bb_pos=0}__init(at,vt){return this.bb_pos=at,this.bb=vt,this}static getRootAsKernelCreateInfos(at,vt){return(vt||new et).__init(at.readInt32(at.position())+at.position(),at)}static getSizePrefixedRootAsKernelCreateInfos(at,vt){return at.setPosition(at.position()+_$1.SIZE_PREFIX_LENGTH),(vt||new et).__init(at.readInt32(at.position())+at.position(),at)}nodeIndices(at){let vt=this.bb.__offset(this.bb_pos,4);return vt?this.bb.readUint32(this.bb.__vector(this.bb_pos+vt)+at*4):0}nodeIndicesLength(){let at=this.bb.__offset(this.bb_pos,4);return at?this.bb.__vector_len(this.bb_pos+at):0}nodeIndicesArray(){let at=this.bb.__offset(this.bb_pos,4);return at?new Uint32Array(this.bb.bytes().buffer,this.bb.bytes().byteOffset+this.bb.__vector(this.bb_pos+at),this.bb.__vector_len(this.bb_pos+at)):null}kernelDefHashes(at){let vt=this.bb.__offset(this.bb_pos,6);return vt?this.bb.readUint64(this.bb.__vector(this.bb_pos+vt)+at*8):this.bb.createLong(0,0)}kernelDefHashesLength(){let at=this.bb.__offset(this.bb_pos,6);return at?this.bb.__vector_len(this.bb_pos+at):0}static startKernelCreateInfos(at){at.startObject(2)}static addNodeIndices(at,vt){at.addFieldOffset(0,vt,0)}static createNodeIndicesVector(at,vt){at.startVector(4,vt.length,4);for(let Tt=vt.length-1;Tt>=0;Tt--)at.addInt32(vt[Tt]);return at.endVector()}static startNodeIndicesVector(at,vt){at.startVector(4,vt,4)}static addKernelDefHashes(at,vt){at.addFieldOffset(1,vt,0)}static createKernelDefHashesVector(at,vt){at.startVector(8,vt.length,8);for(let Tt=vt.length-1;Tt>=0;Tt--)at.addInt64(vt[Tt]);return at.endVector()}static startKernelDefHashesVector(at,vt){at.startVector(8,vt,8)}static endKernelCreateInfos(at){return at.endObject()}static createKernelCreateInfos(at,vt,Tt){return et.startKernelCreateInfos(at),et.addNodeIndices(at,vt),et.addKernelDefHashes(at,Tt),et.endKernelCreateInfos(at)}}b.KernelCreateInfos=et})(g.fbs||(g.fbs={}))})(d.experimental||(d.experimental={}))})(V||(V={})),(d=>{(g=>{(b=>{class et{constructor(){this.bb=null,this.bb_pos=0}__init(at,vt){return this.bb_pos=at,this.bb=vt,this}static getRootAsSubGraphSessionState(at,vt){return(vt||new et).__init(at.readInt32(at.position())+at.position(),at)}static getSizePrefixedRootAsSubGraphSessionState(at,vt){return at.setPosition(at.position()+_$1.SIZE_PREFIX_LENGTH),(vt||new et).__init(at.readInt32(at.position())+at.position(),at)}graphId(at){let vt=this.bb.__offset(this.bb_pos,4);return vt?this.bb.__string(this.bb_pos+vt,at):null}sessionState(at){let vt=this.bb.__offset(this.bb_pos,6);return vt?(at||new d.experimental.fbs.SessionState).__init(this.bb.__indirect(this.bb_pos+vt),this.bb):null}static startSubGraphSessionState(at){at.startObject(2)}static addGraphId(at,vt){at.addFieldOffset(0,vt,0)}static addSessionState(at,vt){at.addFieldOffset(1,vt,0)}static endSubGraphSessionState(at){let vt=at.endObject();return at.requiredField(vt,4),vt}static createSubGraphSessionState(at,vt,Tt){return et.startSubGraphSessionState(at),et.addGraphId(at,vt),et.addSessionState(at,Tt),et.endSubGraphSessionState(at)}}b.SubGraphSessionState=et})(g.fbs||(g.fbs={}))})(d.experimental||(d.experimental={}))})(V||(V={})),(d=>{(g=>{(b=>{class et{constructor(){this.bb=null,this.bb_pos=0}__init(at,vt){return this.bb_pos=at,this.bb=vt,this}static getRootAsSessionState(at,vt){return(vt||new et).__init(at.readInt32(at.position())+at.position(),at)}static getSizePrefixedRootAsSessionState(at,vt){return at.setPosition(at.position()+_$1.SIZE_PREFIX_LENGTH),(vt||new et).__init(at.readInt32(at.position())+at.position(),at)}kernels(at){let vt=this.bb.__offset(this.bb_pos,4);return vt?(at||new d.experimental.fbs.KernelCreateInfos).__init(this.bb.__indirect(this.bb_pos+vt),this.bb):null}subGraphSessionStates(at,vt){let Tt=this.bb.__offset(this.bb_pos,6);return Tt?(vt||new d.experimental.fbs.SubGraphSessionState).__init(this.bb.__indirect(this.bb.__vector(this.bb_pos+Tt)+at*4),this.bb):null}subGraphSessionStatesLength(){let at=this.bb.__offset(this.bb_pos,6);return at?this.bb.__vector_len(this.bb_pos+at):0}static startSessionState(at){at.startObject(2)}static addKernels(at,vt){at.addFieldOffset(0,vt,0)}static addSubGraphSessionStates(at,vt){at.addFieldOffset(1,vt,0)}static createSubGraphSessionStatesVector(at,vt){at.startVector(4,vt.length,4);for(let Tt=vt.length-1;Tt>=0;Tt--)at.addOffset(vt[Tt]);return at.endVector()}static startSubGraphSessionStatesVector(at,vt){at.startVector(4,vt,4)}static endSessionState(at){return at.endObject()}static createSessionState(at,vt,Tt){return et.startSessionState(at),et.addKernels(at,vt),et.addSubGraphSessionStates(at,Tt),et.endSessionState(at)}}b.SessionState=et})(g.fbs||(g.fbs={}))})(d.experimental||(d.experimental={}))})(V||(V={})),(d=>{(g=>{(b=>{class et{constructor(){this.bb=null,this.bb_pos=0}__init(at,vt){return this.bb_pos=at,this.bb=vt,this}static getRootAsInferenceSession(at,vt){return(vt||new et).__init(at.readInt32(at.position())+at.position(),at)}static getSizePrefixedRootAsInferenceSession(at,vt){return at.setPosition(at.position()+_$1.SIZE_PREFIX_LENGTH),(vt||new et).__init(at.readInt32(at.position())+at.position(),at)}static bufferHasIdentifier(at){return at.__has_identifier("ORTM")}ortVersion(at){let vt=this.bb.__offset(this.bb_pos,4);return vt?this.bb.__string(this.bb_pos+vt,at):null}model(at){let vt=this.bb.__offset(this.bb_pos,6);return vt?(at||new d.experimental.fbs.Model).__init(this.bb.__indirect(this.bb_pos+vt),this.bb):null}sessionState(at){let vt=this.bb.__offset(this.bb_pos,8);return vt?(at||new d.experimental.fbs.SessionState).__init(this.bb.__indirect(this.bb_pos+vt),this.bb):null}static startInferenceSession(at){at.startObject(3)}static addOrtVersion(at,vt){at.addFieldOffset(0,vt,0)}static addModel(at,vt){at.addFieldOffset(1,vt,0)}static addSessionState(at,vt){at.addFieldOffset(2,vt,0)}static endInferenceSession(at){return at.endObject()}static finishInferenceSessionBuffer(at,vt){at.finish(vt,"ORTM")}static finishSizePrefixedInferenceSessionBuffer(at,vt){at.finish(vt,"ORTM",!0)}static createInferenceSession(at,vt,Tt,Ct){return et.startInferenceSession(at),et.addOrtVersion(at,vt),et.addModel(at,Tt),et.addSessionState(at,Ct),et.endInferenceSession(at)}}b.InferenceSession=et})(g.fbs||(g.fbs={}))})(d.experimental||(d.experimental={}))})(V||(V={}))}),Bs$1=me((d,g)=>{g.exports=b;function b(et,st){for(var at=new Array(arguments.length-1),vt=0,Tt=2,Ct=!0;Tt<arguments.length;)at[vt++]=arguments[Tt++];return new Promise(function(pt,wt){at[vt]=function($t){if(Ct)if(Ct=!1,$t)wt($t);else{for(var Lt=new Array(arguments.length-1),jt=0;jt<Lt.length;)Lt[jt++]=arguments[jt];pt.apply(null,Lt)}};try{et.apply(st||null,at)}catch($t){Ct&&(Ct=!1,wt($t))}})}}),Gs$1=me(d=>{var g=d;g.length=function(vt){var Tt=vt.length;if(!Tt)return 0;for(var Ct=0;--Tt%4>1&&vt.charAt(Tt)==="=";)++Ct;return Math.ceil(vt.length*3)/4-Ct};var b=new Array(64),et=new Array(123);for(st=0;st<64;)et[b[st]=st<26?st+65:st<52?st+71:st<62?st-4:st-59|43]=st++;var st;g.encode=function(vt,Tt,Ct){for(var pt=null,wt=[],$t=0,Lt=0,jt;Tt<Ct;){var Ft=vt[Tt++];switch(Lt){case 0:wt[$t++]=b[Ft>>2],jt=(Ft&3)<<4,Lt=1;break;case 1:wt[$t++]=b[jt|Ft>>4],jt=(Ft&15)<<2,Lt=2;break;case 2:wt[$t++]=b[jt|Ft>>6],wt[$t++]=b[Ft&63],Lt=0;break}$t>8191&&((pt||(pt=[])).push(String.fromCharCode.apply(String,wt)),$t=0)}return Lt&&(wt[$t++]=b[jt],wt[$t++]=61,Lt===1&&(wt[$t++]=61)),pt?($t&&pt.push(String.fromCharCode.apply(String,wt.slice(0,$t))),pt.join("")):String.fromCharCode.apply(String,wt.slice(0,$t))};var at="invalid encoding";g.decode=function(vt,Tt,Ct){for(var pt=Ct,wt=0,$t,Lt=0;Lt<vt.length;){var jt=vt.charCodeAt(Lt++);if(jt===61&&wt>1)break;if((jt=et[jt])===void 0)throw Error(at);switch(wt){case 0:$t=jt,wt=1;break;case 1:Tt[Ct++]=$t<<2|(jt&48)>>4,$t=jt,wt=2;break;case 2:Tt[Ct++]=($t&15)<<4|(jt&60)>>2,$t=jt,wt=3;break;case 3:Tt[Ct++]=($t&3)<<6|jt,wt=0;break}}if(wt===1)throw Error(at);return Ct-pt},g.test=function(vt){return/^(?:[A-Za-z0-9+/]{4})*(?:[A-Za-z0-9+/]{2}==|[A-Za-z0-9+/]{3}=)?$/.test(vt)}}),zs$1=me((d,g)=>{g.exports=b;function b(){this._listeners={}}b.prototype.on=function(et,st,at){return(this._listeners[et]||(this._listeners[et]=[])).push({fn:st,ctx:at||this}),this},b.prototype.off=function(et,st){if(et===void 0)this._listeners={};else if(st===void 0)this._listeners[et]=[];else for(var at=this._listeners[et],vt=0;vt<at.length;)at[vt].fn===st?at.splice(vt,1):++vt;return this},b.prototype.emit=function(et){var st=this._listeners[et];if(st){for(var at=[],vt=1;vt<arguments.length;)at.push(arguments[vt++]);for(vt=0;vt<st.length;)st[vt].fn.apply(st[vt++].ctx,at)}return this}}),Xs$1=me((d,g)=>{g.exports=b(b);function b(Tt){return typeof Float32Array<"u"?function(){var Ct=new Float32Array([-0]),pt=new Uint8Array(Ct.buffer),wt=pt[3]===128;function $t(Gt,Ht,qt){Ct[0]=Gt,Ht[qt]=pt[0],Ht[qt+1]=pt[1],Ht[qt+2]=pt[2],Ht[qt+3]=pt[3]}function Lt(Gt,Ht,qt){Ct[0]=Gt,Ht[qt]=pt[3],Ht[qt+1]=pt[2],Ht[qt+2]=pt[1],Ht[qt+3]=pt[0]}Tt.writeFloatLE=wt?$t:Lt,Tt.writeFloatBE=wt?Lt:$t;function jt(Gt,Ht){return pt[0]=Gt[Ht],pt[1]=Gt[Ht+1],pt[2]=Gt[Ht+2],pt[3]=Gt[Ht+3],Ct[0]}function Ft(Gt,Ht){return pt[3]=Gt[Ht],pt[2]=Gt[Ht+1],pt[1]=Gt[Ht+2],pt[0]=Gt[Ht+3],Ct[0]}Tt.readFloatLE=wt?jt:Ft,Tt.readFloatBE=wt?Ft:jt}():function(){function Ct(wt,$t,Lt,jt){var Ft=$t<0?1:0;if(Ft&&($t=-$t),$t===0)wt(1/$t>0?0:2147483648,Lt,jt);else if(isNaN($t))wt(2143289344,Lt,jt);else if($t>34028234663852886e22)wt((Ft<<31|2139095040)>>>0,Lt,jt);else if($t<11754943508222875e-54)wt((Ft<<31|Math.round($t/1401298464324817e-60))>>>0,Lt,jt);else{var Gt=Math.floor(Math.log($t)/Math.LN2),Ht=Math.round($t*Math.pow(2,-Gt)*8388608)&8388607;wt((Ft<<31|Gt+127<<23|Ht)>>>0,Lt,jt)}}Tt.writeFloatLE=Ct.bind(null,et),Tt.writeFloatBE=Ct.bind(null,st);function pt(wt,$t,Lt){var jt=wt($t,Lt),Ft=(jt>>31)*2+1,Gt=jt>>>23&255,Ht=jt&8388607;return Gt===255?Ht?NaN:Ft*(1/0):Gt===0?Ft*1401298464324817e-60*Ht:Ft*Math.pow(2,Gt-150)*(Ht+8388608)}Tt.readFloatLE=pt.bind(null,at),Tt.readFloatBE=pt.bind(null,vt)}(),typeof Float64Array<"u"?function(){var Ct=new Float64Array([-0]),pt=new Uint8Array(Ct.buffer),wt=pt[7]===128;function $t(Gt,Ht,qt){Ct[0]=Gt,Ht[qt]=pt[0],Ht[qt+1]=pt[1],Ht[qt+2]=pt[2],Ht[qt+3]=pt[3],Ht[qt+4]=pt[4],Ht[qt+5]=pt[5],Ht[qt+6]=pt[6],Ht[qt+7]=pt[7]}function Lt(Gt,Ht,qt){Ct[0]=Gt,Ht[qt]=pt[7],Ht[qt+1]=pt[6],Ht[qt+2]=pt[5],Ht[qt+3]=pt[4],Ht[qt+4]=pt[3],Ht[qt+5]=pt[2],Ht[qt+6]=pt[1],Ht[qt+7]=pt[0]}Tt.writeDoubleLE=wt?$t:Lt,Tt.writeDoubleBE=wt?Lt:$t;function jt(Gt,Ht){return pt[0]=Gt[Ht],pt[1]=Gt[Ht+1],pt[2]=Gt[Ht+2],pt[3]=Gt[Ht+3],pt[4]=Gt[Ht+4],pt[5]=Gt[Ht+5],pt[6]=Gt[Ht+6],pt[7]=Gt[Ht+7],Ct[0]}function Ft(Gt,Ht){return pt[7]=Gt[Ht],pt[6]=Gt[Ht+1],pt[5]=Gt[Ht+2],pt[4]=Gt[Ht+3],pt[3]=Gt[Ht+4],pt[2]=Gt[Ht+5],pt[1]=Gt[Ht+6],pt[0]=Gt[Ht+7],Ct[0]}Tt.readDoubleLE=wt?jt:Ft,Tt.readDoubleBE=wt?Ft:jt}():function(){function Ct(wt,$t,Lt,jt,Ft,Gt){var Ht=jt<0?1:0;if(Ht&&(jt=-jt),jt===0)wt(0,Ft,Gt+$t),wt(1/jt>0?0:2147483648,Ft,Gt+Lt);else if(isNaN(jt))wt(0,Ft,Gt+$t),wt(2146959360,Ft,Gt+Lt);else if(jt>17976931348623157e292)wt(0,Ft,Gt+$t),wt((Ht<<31|2146435072)>>>0,Ft,Gt+Lt);else{var qt;if(jt<22250738585072014e-324)qt=jt/5e-324,wt(qt>>>0,Ft,Gt+$t),wt((Ht<<31|qt/4294967296)>>>0,Ft,Gt+Lt);else{var Kt=Math.floor(Math.log(jt)/Math.LN2);Kt===1024&&(Kt=1023),qt=jt*Math.pow(2,-Kt),wt(qt*4503599627370496>>>0,Ft,Gt+$t),wt((Ht<<31|Kt+1023<<20|qt*1048576&1048575)>>>0,Ft,Gt+Lt)}}}Tt.writeDoubleLE=Ct.bind(null,et,0,4),Tt.writeDoubleBE=Ct.bind(null,st,4,0);function pt(wt,$t,Lt,jt,Ft){var Gt=wt(jt,Ft+$t),Ht=wt(jt,Ft+Lt),qt=(Ht>>31)*2+1,Kt=Ht>>>20&2047,rr=4294967296*(Ht&1048575)+Gt;return Kt===2047?rr?NaN:qt*(1/0):Kt===0?qt*5e-324*rr:qt*Math.pow(2,Kt-1075)*(rr+4503599627370496)}Tt.readDoubleLE=pt.bind(null,at,0,4),Tt.readDoubleBE=pt.bind(null,vt,4,0)}(),Tt}function et(Tt,Ct,pt){Ct[pt]=Tt&255,Ct[pt+1]=Tt>>>8&255,Ct[pt+2]=Tt>>>16&255,Ct[pt+3]=Tt>>>24}function st(Tt,Ct,pt){Ct[pt]=Tt>>>24,Ct[pt+1]=Tt>>>16&255,Ct[pt+2]=Tt>>>8&255,Ct[pt+3]=Tt&255}function at(Tt,Ct){return(Tt[Ct]|Tt[Ct+1]<<8|Tt[Ct+2]<<16|Tt[Ct+3]<<24)>>>0}function vt(Tt,Ct){return(Tt[Ct]<<24|Tt[Ct+1]<<16|Tt[Ct+2]<<8|Tt[Ct+3])>>>0}}),Ks$1=me((exports,module)=>{module.exports=inquire;function inquire(moduleName){try{var mod=eval("quire".replace(/^/,"re"))(moduleName);if(mod&&(mod.length||Object.keys(mod).length))return mod}catch(d){}return null}}),Zs$1=me(d=>{var g=d;g.length=function(b){for(var et=0,st=0,at=0;at<b.length;++at)st=b.charCodeAt(at),st<128?et+=1:st<2048?et+=2:(st&64512)===55296&&(b.charCodeAt(at+1)&64512)===56320?(++at,et+=4):et+=3;return et},g.read=function(b,et,st){var at=st-et;if(at<1)return"";for(var vt=null,Tt=[],Ct=0,pt;et<st;)pt=b[et++],pt<128?Tt[Ct++]=pt:pt>191&&pt<224?Tt[Ct++]=(pt&31)<<6|b[et++]&63:pt>239&&pt<365?(pt=((pt&7)<<18|(b[et++]&63)<<12|(b[et++]&63)<<6|b[et++]&63)-65536,Tt[Ct++]=55296+(pt>>10),Tt[Ct++]=56320+(pt&1023)):Tt[Ct++]=(pt&15)<<12|(b[et++]&63)<<6|b[et++]&63,Ct>8191&&((vt||(vt=[])).push(String.fromCharCode.apply(String,Tt)),Ct=0);return vt?(Ct&&vt.push(String.fromCharCode.apply(String,Tt.slice(0,Ct))),vt.join("")):String.fromCharCode.apply(String,Tt.slice(0,Ct))},g.write=function(b,et,st){for(var at=st,vt,Tt,Ct=0;Ct<b.length;++Ct)vt=b.charCodeAt(Ct),vt<128?et[st++]=vt:vt<2048?(et[st++]=vt>>6|192,et[st++]=vt&63|128):(vt&64512)===55296&&((Tt=b.charCodeAt(Ct+1))&64512)===56320?(vt=65536+((vt&1023)<<10)+(Tt&1023),++Ct,et[st++]=vt>>18|240,et[st++]=vt>>12&63|128,et[st++]=vt>>6&63|128,et[st++]=vt&63|128):(et[st++]=vt>>12|224,et[st++]=vt>>6&63|128,et[st++]=vt&63|128);return st-at}}),eu$1=me((d,g)=>{g.exports=b;function b(et,st,at){var vt=at||8192,Tt=vt>>>1,Ct=null,pt=vt;return function(wt){if(wt<1||wt>Tt)return et(wt);pt+wt>vt&&(Ct=et(vt),pt=0);var $t=st.call(Ct,pt,pt+=wt);return pt&7&&(pt=(pt|7)+1),$t}}}),ru$1=me((d,g)=>{g.exports=et;var b=Jt();function et(Tt,Ct){this.lo=Tt>>>0,this.hi=Ct>>>0}var st=et.zero=new et(0,0);st.toNumber=function(){return 0},st.zzEncode=st.zzDecode=function(){return this},st.length=function(){return 1};var at=et.zeroHash="\0\0\0\0\0\0\0\0";et.fromNumber=function(Tt){if(Tt===0)return st;var Ct=Tt<0;Ct&&(Tt=-Tt);var pt=Tt>>>0,wt=(Tt-pt)/4294967296>>>0;return Ct&&(wt=~wt>>>0,pt=~pt>>>0,++pt>4294967295&&(pt=0,++wt>4294967295&&(wt=0))),new et(pt,wt)},et.from=function(Tt){if(typeof Tt=="number")return et.fromNumber(Tt);if(b.isString(Tt))if(b.Long)Tt=b.Long.fromString(Tt);else return et.fromNumber(parseInt(Tt,10));return Tt.low||Tt.high?new et(Tt.low>>>0,Tt.high>>>0):st},et.prototype.toNumber=function(Tt){if(!Tt&&this.hi>>>31){var Ct=~this.lo+1>>>0,pt=~this.hi>>>0;return Ct||(pt=pt+1>>>0),-(Ct+pt*4294967296)}return this.lo+this.hi*4294967296},et.prototype.toLong=function(Tt){return b.Long?new b.Long(this.lo|0,this.hi|0,!!Tt):{low:this.lo|0,high:this.hi|0,unsigned:!!Tt}};var vt=String.prototype.charCodeAt;et.fromHash=function(Tt){return Tt===at?st:new et((vt.call(Tt,0)|vt.call(Tt,1)<<8|vt.call(Tt,2)<<16|vt.call(Tt,3)<<24)>>>0,(vt.call(Tt,4)|vt.call(Tt,5)<<8|vt.call(Tt,6)<<16|vt.call(Tt,7)<<24)>>>0)},et.prototype.toHash=function(){return String.fromCharCode(this.lo&255,this.lo>>>8&255,this.lo>>>16&255,this.lo>>>24,this.hi&255,this.hi>>>8&255,this.hi>>>16&255,this.hi>>>24)},et.prototype.zzEncode=function(){var Tt=this.hi>>31;return this.hi=((this.hi<<1|this.lo>>>31)^Tt)>>>0,this.lo=(this.lo<<1^Tt)>>>0,this},et.prototype.zzDecode=function(){var Tt=-(this.lo&1);return this.lo=((this.lo>>>1|this.hi<<31)^Tt)>>>0,this.hi=(this.hi>>>1^Tt)>>>0,this},et.prototype.length=function(){var Tt=this.lo,Ct=(this.lo>>>28|this.hi<<4)>>>0,pt=this.hi>>>24;return pt===0?Ct===0?Tt<16384?Tt<128?1:2:Tt<2097152?3:4:Ct<16384?Ct<128?5:6:Ct<2097152?7:8:pt<128?9:10}}),Jt=me(d=>{var g=d;g.asPromise=Bs$1(),g.base64=Gs$1(),g.EventEmitter=zs$1(),g.float=Xs$1(),g.inquire=Ks$1(),g.utf8=Zs$1(),g.pool=eu$1(),g.LongBits=ru$1(),g.isNode=!!(typeof global<"u"&&global&&global.process&&global.process.versions&&global.process.versions.node),g.global=g.isNode&&global||typeof window<"u"&&window||typeof self<"u"&&self||d,g.emptyArray=Object.freeze?Object.freeze([]):[],g.emptyObject=Object.freeze?Object.freeze({}):{},g.isInteger=Number.isInteger||function(st){return typeof st=="number"&&isFinite(st)&&Math.floor(st)===st},g.isString=function(st){return typeof st=="string"||st instanceof String},g.isObject=function(st){return st&&typeof st=="object"},g.isset=g.isSet=function(st,at){var vt=st[at];return vt!=null&&st.hasOwnProperty(at)?typeof vt!="object"||(Array.isArray(vt)?vt.length:Object.keys(vt).length)>0:!1},g.Buffer=function(){try{var st=g.inquire("buffer").Buffer;return st.prototype.utf8Write?st:null}catch{return null}}(),g._Buffer_from=null,g._Buffer_allocUnsafe=null,g.newBuffer=function(st){return typeof st=="number"?g.Buffer?g._Buffer_allocUnsafe(st):new g.Array(st):g.Buffer?g._Buffer_from(st):typeof Uint8Array>"u"?st:new Uint8Array(st)},g.Array=typeof Uint8Array<"u"?Uint8Array:Array,g.Long=g.global.dcodeIO&&g.global.dcodeIO.Long||g.global.Long||g.inquire("long"),g.key2Re=/^true|false|0|1$/,g.key32Re=/^-?(?:0|[1-9][0-9]*)$/,g.key64Re=/^(?:[\\x00-\\xff]{8}|-?(?:0|[1-9][0-9]*))$/,g.longToHash=function(st){return st?g.LongBits.from(st).toHash():g.LongBits.zeroHash},g.longFromHash=function(st,at){var vt=g.LongBits.fromHash(st);return g.Long?g.Long.fromBits(vt.lo,vt.hi,at):vt.toNumber(!!at)};function b(st,at,vt){for(var Tt=Object.keys(at),Ct=0;Ct<Tt.length;++Ct)(st[Tt[Ct]]===void 0||!vt)&&(st[Tt[Ct]]=at[Tt[Ct]]);return st}g.merge=b,g.lcFirst=function(st){return st.charAt(0).toLowerCase()+st.substring(1)};function et(st){function at(vt,Tt){if(!(this instanceof at))return new at(vt,Tt);Object.defineProperty(this,"message",{get:function(){return vt}}),Error.captureStackTrace?Error.captureStackTrace(this,at):Object.defineProperty(this,"stack",{value:new Error().stack||""}),Tt&&b(this,Tt)}return at.prototype=Object.create(Error.prototype,{constructor:{value:at,writable:!0,enumerable:!1,configurable:!0},name:{get:function(){return st},set:void 0,enumerable:!1,configurable:!0},toString:{value:function(){return this.name+": "+this.message},writable:!0,enumerable:!1,configurable:!0}}),at}g.newError=et,g.ProtocolError=et("ProtocolError"),g.oneOfGetter=function(st){for(var at={},vt=0;vt<st.length;++vt)at[st[vt]]=1;return function(){for(var Tt=Object.keys(this),Ct=Tt.length-1;Ct>-1;--Ct)if(at[Tt[Ct]]===1&&this[Tt[Ct]]!==void 0&&this[Tt[Ct]]!==null)return Tt[Ct]}},g.oneOfSetter=function(st){return function(at){for(var vt=0;vt<st.length;++vt)st[vt]!==at&&delete this[st[vt]]}},g.toJSONOptions={longs:String,enums:String,bytes:String,json:!0},g._configure=function(){var st=g.Buffer;if(!st){g._Buffer_from=g._Buffer_allocUnsafe=null;return}g._Buffer_from=st.from!==Uint8Array.from&&st.from||function(at,vt){return new st(at,vt)},g._Buffer_allocUnsafe=st.allocUnsafe||function(at){return new st(at)}}}),si$1=me((d,g)=>{g.exports=wt;var b=Jt(),et,st=b.LongBits,at=b.base64,vt=b.utf8;function Tt(Kt,rr,ir){this.fn=Kt,this.len=rr,this.next=void 0,this.val=ir}function Ct(){}function pt(Kt){this.head=Kt.head,this.tail=Kt.tail,this.len=Kt.len,this.next=Kt.states}function wt(){this.len=0,this.head=new Tt(Ct,0,0),this.tail=this.head,this.states=null}var $t=function(){return b.Buffer?function(){return(wt.create=function(){return new et})()}:function(){return new wt}};wt.create=$t(),wt.alloc=function(Kt){return new b.Array(Kt)},b.Array!==Array&&(wt.alloc=b.pool(wt.alloc,b.Array.prototype.subarray)),wt.prototype._push=function(Kt,rr,ir){return this.tail=this.tail.next=new Tt(Kt,rr,ir),this.len+=rr,this};function Lt(Kt,rr,ir){rr[ir]=Kt&255}function jt(Kt,rr,ir){for(;Kt>127;)rr[ir++]=Kt&127|128,Kt>>>=7;rr[ir]=Kt}function Ft(Kt,rr){this.len=Kt,this.next=void 0,this.val=rr}Ft.prototype=Object.create(Tt.prototype),Ft.prototype.fn=jt,wt.prototype.uint32=function(Kt){return this.len+=(this.tail=this.tail.next=new Ft((Kt=Kt>>>0)<128?1:Kt<16384?2:Kt<2097152?3:Kt<268435456?4:5,Kt)).len,this},wt.prototype.int32=function(Kt){return Kt<0?this._push(Gt,10,st.fromNumber(Kt)):this.uint32(Kt)},wt.prototype.sint32=function(Kt){return this.uint32((Kt<<1^Kt>>31)>>>0)};function Gt(Kt,rr,ir){for(;Kt.hi;)rr[ir++]=Kt.lo&127|128,Kt.lo=(Kt.lo>>>7|Kt.hi<<25)>>>0,Kt.hi>>>=7;for(;Kt.lo>127;)rr[ir++]=Kt.lo&127|128,Kt.lo=Kt.lo>>>7;rr[ir++]=Kt.lo}wt.prototype.uint64=function(Kt){var rr=st.from(Kt);return this._push(Gt,rr.length(),rr)},wt.prototype.int64=wt.prototype.uint64,wt.prototype.sint64=function(Kt){var rr=st.from(Kt).zzEncode();return this._push(Gt,rr.length(),rr)},wt.prototype.bool=function(Kt){return this._push(Lt,1,Kt?1:0)};function Ht(Kt,rr,ir){rr[ir]=Kt&255,rr[ir+1]=Kt>>>8&255,rr[ir+2]=Kt>>>16&255,rr[ir+3]=Kt>>>24}wt.prototype.fixed32=function(Kt){return this._push(Ht,4,Kt>>>0)},wt.prototype.sfixed32=wt.prototype.fixed32,wt.prototype.fixed64=function(Kt){var rr=st.from(Kt);return this._push(Ht,4,rr.lo)._push(Ht,4,rr.hi)},wt.prototype.sfixed64=wt.prototype.fixed64,wt.prototype.float=function(Kt){return this._push(b.float.writeFloatLE,4,Kt)},wt.prototype.double=function(Kt){return this._push(b.float.writeDoubleLE,8,Kt)};var qt=b.Array.prototype.set?function(Kt,rr,ir){rr.set(Kt,ir)}:function(Kt,rr,ir){for(var or=0;or<Kt.length;++or)rr[ir+or]=Kt[or]};wt.prototype.bytes=function(Kt){var rr=Kt.length>>>0;if(!rr)return this._push(Lt,1,0);if(b.isString(Kt)){var ir=wt.alloc(rr=at.length(Kt));at.decode(Kt,ir,0),Kt=ir}return this.uint32(rr)._push(qt,rr,Kt)},wt.prototype.string=function(Kt){var rr=vt.length(Kt);return rr?this.uint32(rr)._push(vt.write,rr,Kt):this._push(Lt,1,0)},wt.prototype.fork=function(){return this.states=new pt(this),this.head=this.tail=new Tt(Ct,0,0),this.len=0,this},wt.prototype.reset=function(){return this.states?(this.head=this.states.head,this.tail=this.states.tail,this.len=this.states.len,this.states=this.states.next):(this.head=this.tail=new Tt(Ct,0,0),this.len=0),this},wt.prototype.ldelim=function(){var Kt=this.head,rr=this.tail,ir=this.len;return this.reset().uint32(ir),ir&&(this.tail.next=Kt.next,this.tail=rr,this.len+=ir),this},wt.prototype.finish=function(){for(var Kt=this.head.next,rr=this.constructor.alloc(this.len),ir=0;Kt;)Kt.fn(Kt.val,rr,ir),ir+=Kt.len,Kt=Kt.next;return rr},wt._configure=function(Kt){et=Kt,wt.create=$t(),et._configure()}}),cu$1=me((d,g)=>{g.exports=st;var b=si$1();(st.prototype=Object.create(b.prototype)).constructor=st;var et=Jt();function st(){b.call(this)}st._configure=function(){st.alloc=et._Buffer_allocUnsafe,st.writeBytesBuffer=et.Buffer&&et.Buffer.prototype instanceof Uint8Array&&et.Buffer.prototype.set.name==="set"?function(vt,Tt,Ct){Tt.set(vt,Ct)}:function(vt,Tt,Ct){if(vt.copy)vt.copy(Tt,Ct,0,vt.length);else for(var pt=0;pt<vt.length;)Tt[Ct++]=vt[pt++]}},st.prototype.bytes=function(vt){et.isString(vt)&&(vt=et._Buffer_from(vt,"base64"));var Tt=vt.length>>>0;return this.uint32(Tt),Tt&&this._push(st.writeBytesBuffer,Tt,vt),this};function at(vt,Tt,Ct){vt.length<40?et.utf8.write(vt,Tt,Ct):Tt.utf8Write?Tt.utf8Write(vt,Ct):Tt.write(vt,Ct)}st.prototype.string=function(vt){var Tt=et.Buffer.byteLength(vt);return this.uint32(Tt),Tt&&this._push(at,Tt,vt),this},st._configure()}),fi$1=me((d,g)=>{g.exports=Tt;var b=Jt(),et,st=b.LongBits,at=b.utf8;function vt(jt,Ft){return RangeError("index out of range: "+jt.pos+" + "+(Ft||1)+" > "+jt.len)}function Tt(jt){this.buf=jt,this.pos=0,this.len=jt.length}var Ct=typeof Uint8Array<"u"?function(jt){if(jt instanceof Uint8Array||Array.isArray(jt))return new Tt(jt);throw Error("illegal buffer")}:function(jt){if(Array.isArray(jt))return new Tt(jt);throw Error("illegal buffer")},pt=function(){return b.Buffer?function(jt){return(Tt.create=function(Ft){return b.Buffer.isBuffer(Ft)?new et(Ft):Ct(Ft)})(jt)}:Ct};Tt.create=pt(),Tt.prototype._slice=b.Array.prototype.subarray||b.Array.prototype.slice,Tt.prototype.uint32=function(){var jt=4294967295;return function(){if(jt=(this.buf[this.pos]&127)>>>0,this.buf[this.pos++]<128||(jt=(jt|(this.buf[this.pos]&127)<<7)>>>0,this.buf[this.pos++]<128)||(jt=(jt|(this.buf[this.pos]&127)<<14)>>>0,this.buf[this.pos++]<128)||(jt=(jt|(this.buf[this.pos]&127)<<21)>>>0,this.buf[this.pos++]<128)||(jt=(jt|(this.buf[this.pos]&15)<<28)>>>0,this.buf[this.pos++]<128))return jt;if((this.pos+=5)>this.len)throw this.pos=this.len,vt(this,10);return jt}}(),Tt.prototype.int32=function(){return this.uint32()|0},Tt.prototype.sint32=function(){var jt=this.uint32();return jt>>>1^-(jt&1)|0};function wt(){var jt=new st(0,0),Ft=0;if(this.len-this.pos>4){for(;Ft<4;++Ft)if(jt.lo=(jt.lo|(this.buf[this.pos]&127)<<Ft*7)>>>0,this.buf[this.pos++]<128)return jt;if(jt.lo=(jt.lo|(this.buf[this.pos]&127)<<28)>>>0,jt.hi=(jt.hi|(this.buf[this.pos]&127)>>4)>>>0,this.buf[this.pos++]<128)return jt;Ft=0}else{for(;Ft<3;++Ft){if(this.pos>=this.len)throw vt(this);if(jt.lo=(jt.lo|(this.buf[this.pos]&127)<<Ft*7)>>>0,this.buf[this.pos++]<128)return jt}return jt.lo=(jt.lo|(this.buf[this.pos++]&127)<<Ft*7)>>>0,jt}if(this.len-this.pos>4){for(;Ft<5;++Ft)if(jt.hi=(jt.hi|(this.buf[this.pos]&127)<<Ft*7+3)>>>0,this.buf[this.pos++]<128)return jt}else for(;Ft<5;++Ft){if(this.pos>=this.len)throw vt(this);if(jt.hi=(jt.hi|(this.buf[this.pos]&127)<<Ft*7+3)>>>0,this.buf[this.pos++]<128)return jt}throw Error("invalid varint encoding")}Tt.prototype.bool=function(){return this.uint32()!==0};function $t(jt,Ft){return(jt[Ft-4]|jt[Ft-3]<<8|jt[Ft-2]<<16|jt[Ft-1]<<24)>>>0}Tt.prototype.fixed32=function(){if(this.pos+4>this.len)throw vt(this,4);return $t(this.buf,this.pos+=4)},Tt.prototype.sfixed32=function(){if(this.pos+4>this.len)throw vt(this,4);return $t(this.buf,this.pos+=4)|0};function Lt(){if(this.pos+8>this.len)throw vt(this,8);return new st($t(this.buf,this.pos+=4),$t(this.buf,this.pos+=4))}Tt.prototype.float=function(){if(this.pos+4>this.len)throw vt(this,4);var jt=b.float.readFloatLE(this.buf,this.pos);return this.pos+=4,jt},Tt.prototype.double=function(){if(this.pos+8>this.len)throw vt(this,4);var jt=b.float.readDoubleLE(this.buf,this.pos);return this.pos+=8,jt},Tt.prototype.bytes=function(){var jt=this.uint32(),Ft=this.pos,Gt=this.pos+jt;if(Gt>this.len)throw vt(this,jt);if(this.pos+=jt,Array.isArray(this.buf))return this.buf.slice(Ft,Gt);if(Ft===Gt){var Ht=b.Buffer;return Ht?Ht.alloc(0):new this.buf.constructor(0)}return this._slice.call(this.buf,Ft,Gt)},Tt.prototype.string=function(){var jt=this.bytes();return at.read(jt,0,jt.length)},Tt.prototype.skip=function(jt){if(typeof jt=="number"){if(this.pos+jt>this.len)throw vt(this,jt);this.pos+=jt}else do if(this.pos>=this.len)throw vt(this);while(this.buf[this.pos++]&128);return this},Tt.prototype.skipType=function(jt){switch(jt){case 0:this.skip();break;case 1:this.skip(8);break;case 2:this.skip(this.uint32());break;case 3:for(;(jt=this.uint32()&7)!==4;)this.skipType(jt);break;case 5:this.skip(4);break;default:throw Error("invalid wire type "+jt+" at offset "+this.pos)}return this},Tt._configure=function(jt){et=jt,Tt.create=pt(),et._configure();var Ft=b.Long?"toLong":"toNumber";b.merge(Tt.prototype,{int64:function(){return wt.call(this)[Ft](!1)},uint64:function(){return wt.call(this)[Ft](!0)},sint64:function(){return wt.call(this).zzDecode()[Ft](!1)},fixed64:function(){return Lt.call(this)[Ft](!0)},sfixed64:function(){return Lt.call(this)[Ft](!1)}})}}),xu=me((d,g)=>{g.exports=st;var b=fi$1();(st.prototype=Object.create(b.prototype)).constructor=st;var et=Jt();function st(at){b.call(this,at)}st._configure=function(){et.Buffer&&(st.prototype._slice=et.Buffer.prototype.slice)},st.prototype.string=function(){var at=this.uint32();return this.buf.utf8Slice?this.buf.utf8Slice(this.pos,this.pos=Math.min(this.pos+at,this.len)):this.buf.toString("utf-8",this.pos,this.pos=Math.min(this.pos+at,this.len))},st._configure()}),vu$1=me((d,g)=>{g.exports=et;var b=Jt();(et.prototype=Object.create(b.EventEmitter.prototype)).constructor=et;function et(st,at,vt){if(typeof st!="function")throw TypeError("rpcImpl must be a function");b.EventEmitter.call(this),this.rpcImpl=st,this.requestDelimited=!!at,this.responseDelimited=!!vt}et.prototype.rpcCall=function st(at,vt,Tt,Ct,pt){if(!Ct)throw TypeError("request must be specified");var wt=this;if(!pt)return b.asPromise(st,wt,at,vt,Tt,Ct);if(!wt.rpcImpl){setTimeout(function(){pt(Error("already ended"))},0);return}try{return wt.rpcImpl(at,vt[wt.requestDelimited?"encodeDelimited":"encode"](Ct).finish(),function($t,Lt){if($t)return wt.emit("error",$t,at),pt($t);if(Lt===null){wt.end(!0);return}if(!(Lt instanceof Tt))try{Lt=Tt[wt.responseDelimited?"decodeDelimited":"decode"](Lt)}catch(jt){return wt.emit("error",jt,at),pt(jt)}return wt.emit("data",Lt,at),pt(null,Lt)})}catch($t){wt.emit("error",$t,at),setTimeout(function(){pt($t)},0);return}},et.prototype.end=function(st){return this.rpcImpl&&(st||this.rpcImpl(null,null,null),this.rpcImpl=null,this.emit("end").off()),this}}),Ou$1=me(d=>{var g=d;g.Service=vu$1()}),Su$1=me((d,g)=>{g.exports={}}),Eu$1=me(d=>{var g=d;g.build="minimal",g.Writer=si$1(),g.BufferWriter=cu$1(),g.Reader=fi$1(),g.BufferReader=xu(),g.util=Jt(),g.rpc=Ou$1(),g.roots=Su$1(),g.configure=b;function b(){g.util._configure(),g.Writer._configure(g.BufferWriter),g.Reader._configure(g.BufferReader)}b()}),Lu$1=me((d,g)=>{g.exports=Eu$1()}),Cr=me((d,g)=>{var b=Lu$1(),et=b.Reader,st=b.Writer,at=b.util,vt=b.roots.default||(b.roots.default={});vt.onnx=function(){var Tt={};return Tt.Version=function(){var Ct={},pt=Object.create(Ct);return pt[Ct[0]="_START_VERSION"]=0,pt[Ct[1]="IR_VERSION_2017_10_10"]=1,pt[Ct[2]="IR_VERSION_2017_10_30"]=2,pt[Ct[3]="IR_VERSION_2017_11_3"]=3,pt[Ct[4]="IR_VERSION_2019_1_22"]=4,pt[Ct[5]="IR_VERSION_2019_3_18"]=5,pt[Ct[6]="IR_VERSION_2019_9_19"]=6,pt[Ct[7]="IR_VERSION_2020_5_8"]=7,pt[Ct[8]="IR_VERSION_2021_7_30"]=8,pt[Ct[9]="IR_VERSION"]=9,pt}(),Tt.AttributeProto=function(){function Ct(pt){if(this.floats=[],this.ints=[],this.strings=[],this.tensors=[],this.graphs=[],this.sparseTensors=[],this.typeProtos=[],pt)for(var wt=Object.keys(pt),$t=0;$t<wt.length;++$t)pt[wt[$t]]!=null&&(this[wt[$t]]=pt[wt[$t]])}return Ct.prototype.name="",Ct.prototype.refAttrName="",Ct.prototype.docString="",Ct.prototype.type=0,Ct.prototype.f=0,Ct.prototype.i=at.Long?at.Long.fromBits(0,0,!1):0,Ct.prototype.s=at.newBuffer([]),Ct.prototype.t=null,Ct.prototype.g=null,Ct.prototype.sparseTensor=null,Ct.prototype.tp=null,Ct.prototype.floats=at.emptyArray,Ct.prototype.ints=at.emptyArray,Ct.prototype.strings=at.emptyArray,Ct.prototype.tensors=at.emptyArray,Ct.prototype.graphs=at.emptyArray,Ct.prototype.sparseTensors=at.emptyArray,Ct.prototype.typeProtos=at.emptyArray,Ct.create=function(pt){return new Ct(pt)},Ct.encode=function(pt,wt){if(wt||(wt=st.create()),pt.name!=null&&Object.hasOwnProperty.call(pt,"name")&&wt.uint32(10).string(pt.name),pt.f!=null&&Object.hasOwnProperty.call(pt,"f")&&wt.uint32(21).float(pt.f),pt.i!=null&&Object.hasOwnProperty.call(pt,"i")&&wt.uint32(24).int64(pt.i),pt.s!=null&&Object.hasOwnProperty.call(pt,"s")&&wt.uint32(34).bytes(pt.s),pt.t!=null&&Object.hasOwnProperty.call(pt,"t")&&vt.onnx.TensorProto.encode(pt.t,wt.uint32(42).fork()).ldelim(),pt.g!=null&&Object.hasOwnProperty.call(pt,"g")&&vt.onnx.GraphProto.encode(pt.g,wt.uint32(50).fork()).ldelim(),pt.floats!=null&&pt.floats.length){wt.uint32(58).fork();for(var $t=0;$t<pt.floats.length;++$t)wt.float(pt.floats[$t]);wt.ldelim()}if(pt.ints!=null&&pt.ints.length){wt.uint32(66).fork();for(var $t=0;$t<pt.ints.length;++$t)wt.int64(pt.ints[$t]);wt.ldelim()}if(pt.strings!=null&&pt.strings.length)for(var $t=0;$t<pt.strings.length;++$t)wt.uint32(74).bytes(pt.strings[$t]);if(pt.tensors!=null&&pt.tensors.length)for(var $t=0;$t<pt.tensors.length;++$t)vt.onnx.TensorProto.encode(pt.tensors[$t],wt.uint32(82).fork()).ldelim();if(pt.graphs!=null&&pt.graphs.length)for(var $t=0;$t<pt.graphs.length;++$t)vt.onnx.GraphProto.encode(pt.graphs[$t],wt.uint32(90).fork()).ldelim();if(pt.docString!=null&&Object.hasOwnProperty.call(pt,"docString")&&wt.uint32(106).string(pt.docString),pt.tp!=null&&Object.hasOwnProperty.call(pt,"tp")&&vt.onnx.TypeProto.encode(pt.tp,wt.uint32(114).fork()).ldelim(),pt.typeProtos!=null&&pt.typeProtos.length)for(var $t=0;$t<pt.typeProtos.length;++$t)vt.onnx.TypeProto.encode(pt.typeProtos[$t],wt.uint32(122).fork()).ldelim();if(pt.type!=null&&Object.hasOwnProperty.call(pt,"type")&&wt.uint32(160).int32(pt.type),pt.refAttrName!=null&&Object.hasOwnProperty.call(pt,"refAttrName")&&wt.uint32(170).string(pt.refAttrName),pt.sparseTensor!=null&&Object.hasOwnProperty.call(pt,"sparseTensor")&&vt.onnx.SparseTensorProto.encode(pt.sparseTensor,wt.uint32(178).fork()).ldelim(),pt.sparseTensors!=null&&pt.sparseTensors.length)for(var $t=0;$t<pt.sparseTensors.length;++$t)vt.onnx.SparseTensorProto.encode(pt.sparseTensors[$t],wt.uint32(186).fork()).ldelim();return wt},Ct.encodeDelimited=function(pt,wt){return this.encode(pt,wt).ldelim()},Ct.decode=function(pt,wt){pt instanceof et||(pt=et.create(pt));for(var $t=wt===void 0?pt.len:pt.pos+wt,Lt=new vt.onnx.AttributeProto;pt.pos<$t;){var jt=pt.uint32();switch(jt>>>3){case 1:{Lt.name=pt.string();break}case 21:{Lt.refAttrName=pt.string();break}case 13:{Lt.docString=pt.string();break}case 20:{Lt.type=pt.int32();break}case 2:{Lt.f=pt.float();break}case 3:{Lt.i=pt.int64();break}case 4:{Lt.s=pt.bytes();break}case 5:{Lt.t=vt.onnx.TensorProto.decode(pt,pt.uint32());break}case 6:{Lt.g=vt.onnx.GraphProto.decode(pt,pt.uint32());break}case 22:{Lt.sparseTensor=vt.onnx.SparseTensorProto.decode(pt,pt.uint32());break}case 14:{Lt.tp=vt.onnx.TypeProto.decode(pt,pt.uint32());break}case 7:{if(Lt.floats&&Lt.floats.length||(Lt.floats=[]),(jt&7)===2)for(var Ft=pt.uint32()+pt.pos;pt.pos<Ft;)Lt.floats.push(pt.float());else Lt.floats.push(pt.float());break}case 8:{if(Lt.ints&&Lt.ints.length||(Lt.ints=[]),(jt&7)===2)for(var Ft=pt.uint32()+pt.pos;pt.pos<Ft;)Lt.ints.push(pt.int64());else Lt.ints.push(pt.int64());break}case 9:{Lt.strings&&Lt.strings.length||(Lt.strings=[]),Lt.strings.push(pt.bytes());break}case 10:{Lt.tensors&&Lt.tensors.length||(Lt.tensors=[]),Lt.tensors.push(vt.onnx.TensorProto.decode(pt,pt.uint32()));break}case 11:{Lt.graphs&&Lt.graphs.length||(Lt.graphs=[]),Lt.graphs.push(vt.onnx.GraphProto.decode(pt,pt.uint32()));break}case 23:{Lt.sparseTensors&&Lt.sparseTensors.length||(Lt.sparseTensors=[]),Lt.sparseTensors.push(vt.onnx.SparseTensorProto.decode(pt,pt.uint32()));break}case 15:{Lt.typeProtos&&Lt.typeProtos.length||(Lt.typeProtos=[]),Lt.typeProtos.push(vt.onnx.TypeProto.decode(pt,pt.uint32()));break}default:pt.skipType(jt&7);break}}return Lt},Ct.decodeDelimited=function(pt){return pt instanceof et||(pt=new et(pt)),this.decode(pt,pt.uint32())},Ct.verify=function(pt){if(typeof pt!="object"||pt===null)return"object expected";if(pt.name!=null&&pt.hasOwnProperty("name")&&!at.isString(pt.name))return"name: string expected";if(pt.refAttrName!=null&&pt.hasOwnProperty("refAttrName")&&!at.isString(pt.refAttrName))return"refAttrName: string expected";if(pt.docString!=null&&pt.hasOwnProperty("docString")&&!at.isString(pt.docString))return"docString: string expected";if(pt.type!=null&&pt.hasOwnProperty("type"))switch(pt.type){default:return"type: enum value expected";case 0:case 1:case 2:case 3:case 4:case 5:case 11:case 13:case 6:case 7:case 8:case 9:case 10:case 12:case 14:break}if(pt.f!=null&&pt.hasOwnProperty("f")&&typeof pt.f!="number")return"f: number expected";if(pt.i!=null&&pt.hasOwnProperty("i")&&!at.isInteger(pt.i)&&!(pt.i&&at.isInteger(pt.i.low)&&at.isInteger(pt.i.high)))return"i: integer|Long expected";if(pt.s!=null&&pt.hasOwnProperty("s")&&!(pt.s&&typeof pt.s.length=="number"||at.isString(pt.s)))return"s: buffer expected";if(pt.t!=null&&pt.hasOwnProperty("t")){var wt=vt.onnx.TensorProto.verify(pt.t);if(wt)return"t."+wt}if(pt.g!=null&&pt.hasOwnProperty("g")){var wt=vt.onnx.GraphProto.verify(pt.g);if(wt)return"g."+wt}if(pt.sparseTensor!=null&&pt.hasOwnProperty("sparseTensor")){var wt=vt.onnx.SparseTensorProto.verify(pt.sparseTensor);if(wt)return"sparseTensor."+wt}if(pt.tp!=null&&pt.hasOwnProperty("tp")){var wt=vt.onnx.TypeProto.verify(pt.tp);if(wt)return"tp."+wt}if(pt.floats!=null&&pt.hasOwnProperty("floats")){if(!Array.isArray(pt.floats))return"floats: array expected";for(var $t=0;$t<pt.floats.length;++$t)if(typeof pt.floats[$t]!="number")return"floats: number[] expected"}if(pt.ints!=null&&pt.hasOwnProperty("ints")){if(!Array.isArray(pt.ints))return"ints: array expected";for(var $t=0;$t<pt.ints.length;++$t)if(!at.isInteger(pt.ints[$t])&&!(pt.ints[$t]&&at.isInteger(pt.ints[$t].low)&&at.isInteger(pt.ints[$t].high)))return"ints: integer|Long[] expected"}if(pt.strings!=null&&pt.hasOwnProperty("strings")){if(!Array.isArray(pt.strings))return"strings: array expected";for(var $t=0;$t<pt.strings.length;++$t)if(!(pt.strings[$t]&&typeof pt.strings[$t].length=="number"||at.isString(pt.strings[$t])))return"strings: buffer[] expected"}if(pt.tensors!=null&&pt.hasOwnProperty("tensors")){if(!Array.isArray(pt.tensors))return"tensors: array expected";for(var $t=0;$t<pt.tensors.length;++$t){var wt=vt.onnx.TensorProto.verify(pt.tensors[$t]);if(wt)return"tensors."+wt}}if(pt.graphs!=null&&pt.hasOwnProperty("graphs")){if(!Array.isArray(pt.graphs))return"graphs: array expected";for(var $t=0;$t<pt.graphs.length;++$t){var wt=vt.onnx.GraphProto.verify(pt.graphs[$t]);if(wt)return"graphs."+wt}}if(pt.sparseTensors!=null&&pt.hasOwnProperty("sparseTensors")){if(!Array.isArray(pt.sparseTensors))return"sparseTensors: array expected";for(var $t=0;$t<pt.sparseTensors.length;++$t){var wt=vt.onnx.SparseTensorProto.verify(pt.sparseTensors[$t]);if(wt)return"sparseTensors."+wt}}if(pt.typeProtos!=null&&pt.hasOwnProperty("typeProtos")){if(!Array.isArray(pt.typeProtos))return"typeProtos: array expected";for(var $t=0;$t<pt.typeProtos.length;++$t){var wt=vt.onnx.TypeProto.verify(pt.typeProtos[$t]);if(wt)return"typeProtos."+wt}}return null},Ct.fromObject=function(pt){if(pt instanceof vt.onnx.AttributeProto)return pt;var wt=new vt.onnx.AttributeProto;switch(pt.name!=null&&(wt.name=String(pt.name)),pt.refAttrName!=null&&(wt.refAttrName=String(pt.refAttrName)),pt.docString!=null&&(wt.docString=String(pt.docString)),pt.type){default:if(typeof pt.type=="number"){wt.type=pt.type;break}break;case"UNDEFINED":case 0:wt.type=0;break;case"FLOAT":case 1:wt.type=1;break;case"INT":case 2:wt.type=2;break;case"STRING":case 3:wt.type=3;break;case"TENSOR":case 4:wt.type=4;break;case"GRAPH":case 5:wt.type=5;break;case"SPARSE_TENSOR":case 11:wt.type=11;break;case"TYPE_PROTO":case 13:wt.type=13;break;case"FLOATS":case 6:wt.type=6;break;case"INTS":case 7:wt.type=7;break;case"STRINGS":case 8:wt.type=8;break;case"TENSORS":case 9:wt.type=9;break;case"GRAPHS":case 10:wt.type=10;break;case"SPARSE_TENSORS":case 12:wt.type=12;break;case"TYPE_PROTOS":case 14:wt.type=14;break}if(pt.f!=null&&(wt.f=Number(pt.f)),pt.i!=null&&(at.Long?(wt.i=at.Long.fromValue(pt.i)).unsigned=!1:typeof pt.i=="string"?wt.i=parseInt(pt.i,10):typeof pt.i=="number"?wt.i=pt.i:typeof pt.i=="object"&&(wt.i=new at.LongBits(pt.i.low>>>0,pt.i.high>>>0).toNumber())),pt.s!=null&&(typeof pt.s=="string"?at.base64.decode(pt.s,wt.s=at.newBuffer(at.base64.length(pt.s)),0):pt.s.length>=0&&(wt.s=pt.s)),pt.t!=null){if(typeof pt.t!="object")throw TypeError(".onnx.AttributeProto.t: object expected");wt.t=vt.onnx.TensorProto.fromObject(pt.t)}if(pt.g!=null){if(typeof pt.g!="object")throw TypeError(".onnx.AttributeProto.g: object expected");wt.g=vt.onnx.GraphProto.fromObject(pt.g)}if(pt.sparseTensor!=null){if(typeof pt.sparseTensor!="object")throw TypeError(".onnx.AttributeProto.sparseTensor: object expected");wt.sparseTensor=vt.onnx.SparseTensorProto.fromObject(pt.sparseTensor)}if(pt.tp!=null){if(typeof pt.tp!="object")throw TypeError(".onnx.AttributeProto.tp: object expected");wt.tp=vt.onnx.TypeProto.fromObject(pt.tp)}if(pt.floats){if(!Array.isArray(pt.floats))throw TypeError(".onnx.AttributeProto.floats: array expected");wt.floats=[];for(var $t=0;$t<pt.floats.length;++$t)wt.floats[$t]=Number(pt.floats[$t])}if(pt.ints){if(!Array.isArray(pt.ints))throw TypeError(".onnx.AttributeProto.ints: array expected");wt.ints=[];for(var $t=0;$t<pt.ints.length;++$t)at.Long?(wt.ints[$t]=at.Long.fromValue(pt.ints[$t])).unsigned=!1:typeof pt.ints[$t]=="string"?wt.ints[$t]=parseInt(pt.ints[$t],10):typeof pt.ints[$t]=="number"?wt.ints[$t]=pt.ints[$t]:typeof pt.ints[$t]=="object"&&(wt.ints[$t]=new at.LongBits(pt.ints[$t].low>>>0,pt.ints[$t].high>>>0).toNumber())}if(pt.strings){if(!Array.isArray(pt.strings))throw TypeError(".onnx.AttributeProto.strings: array expected");wt.strings=[];for(var $t=0;$t<pt.strings.length;++$t)typeof pt.strings[$t]=="string"?at.base64.decode(pt.strings[$t],wt.strings[$t]=at.newBuffer(at.base64.length(pt.strings[$t])),0):pt.strings[$t].length>=0&&(wt.strings[$t]=pt.strings[$t])}if(pt.tensors){if(!Array.isArray(pt.tensors))throw TypeError(".onnx.AttributeProto.tensors: array expected");wt.tensors=[];for(var $t=0;$t<pt.tensors.length;++$t){if(typeof pt.tensors[$t]!="object")throw TypeError(".onnx.AttributeProto.tensors: object expected");wt.tensors[$t]=vt.onnx.TensorProto.fromObject(pt.tensors[$t])}}if(pt.graphs){if(!Array.isArray(pt.graphs))throw TypeError(".onnx.AttributeProto.graphs: array expected");wt.graphs=[];for(var $t=0;$t<pt.graphs.length;++$t){if(typeof pt.graphs[$t]!="object")throw TypeError(".onnx.AttributeProto.graphs: object expected");wt.graphs[$t]=vt.onnx.GraphProto.fromObject(pt.graphs[$t])}}if(pt.sparseTensors){if(!Array.isArray(pt.sparseTensors))throw TypeError(".onnx.AttributeProto.sparseTensors: array expected");wt.sparseTensors=[];for(var $t=0;$t<pt.sparseTensors.length;++$t){if(typeof pt.sparseTensors[$t]!="object")throw TypeError(".onnx.AttributeProto.sparseTensors: object expected");wt.sparseTensors[$t]=vt.onnx.SparseTensorProto.fromObject(pt.sparseTensors[$t])}}if(pt.typeProtos){if(!Array.isArray(pt.typeProtos))throw TypeError(".onnx.AttributeProto.typeProtos: array expected");wt.typeProtos=[];for(var $t=0;$t<pt.typeProtos.length;++$t){if(typeof pt.typeProtos[$t]!="object")throw TypeError(".onnx.AttributeProto.typeProtos: object expected");wt.typeProtos[$t]=vt.onnx.TypeProto.fromObject(pt.typeProtos[$t])}}return wt},Ct.toObject=function(pt,wt){wt||(wt={});var $t={};if((wt.arrays||wt.defaults)&&($t.floats=[],$t.ints=[],$t.strings=[],$t.tensors=[],$t.graphs=[],$t.typeProtos=[],$t.sparseTensors=[]),wt.defaults){if($t.name="",$t.f=0,at.Long){var Lt=new at.Long(0,0,!1);$t.i=wt.longs===String?Lt.toString():wt.longs===Number?Lt.toNumber():Lt}else $t.i=wt.longs===String?"0":0;wt.bytes===String?$t.s="":($t.s=[],wt.bytes!==Array&&($t.s=at.newBuffer($t.s))),$t.t=null,$t.g=null,$t.docString="",$t.tp=null,$t.type=wt.enums===String?"UNDEFINED":0,$t.refAttrName="",$t.sparseTensor=null}if(pt.name!=null&&pt.hasOwnProperty("name")&&($t.name=pt.name),pt.f!=null&&pt.hasOwnProperty("f")&&($t.f=wt.json&&!isFinite(pt.f)?String(pt.f):pt.f),pt.i!=null&&pt.hasOwnProperty("i")&&(typeof pt.i=="number"?$t.i=wt.longs===String?String(pt.i):pt.i:$t.i=wt.longs===String?at.Long.prototype.toString.call(pt.i):wt.longs===Number?new at.LongBits(pt.i.low>>>0,pt.i.high>>>0).toNumber():pt.i),pt.s!=null&&pt.hasOwnProperty("s")&&($t.s=wt.bytes===String?at.base64.encode(pt.s,0,pt.s.length):wt.bytes===Array?Array.prototype.slice.call(pt.s):pt.s),pt.t!=null&&pt.hasOwnProperty("t")&&($t.t=vt.onnx.TensorProto.toObject(pt.t,wt)),pt.g!=null&&pt.hasOwnProperty("g")&&($t.g=vt.onnx.GraphProto.toObject(pt.g,wt)),pt.floats&&pt.floats.length){$t.floats=[];for(var jt=0;jt<pt.floats.length;++jt)$t.floats[jt]=wt.json&&!isFinite(pt.floats[jt])?String(pt.floats[jt]):pt.floats[jt]}if(pt.ints&&pt.ints.length){$t.ints=[];for(var jt=0;jt<pt.ints.length;++jt)typeof pt.ints[jt]=="number"?$t.ints[jt]=wt.longs===String?String(pt.ints[jt]):pt.ints[jt]:$t.ints[jt]=wt.longs===String?at.Long.prototype.toString.call(pt.ints[jt]):wt.longs===Number?new at.LongBits(pt.ints[jt].low>>>0,pt.ints[jt].high>>>0).toNumber():pt.ints[jt]}if(pt.strings&&pt.strings.length){$t.strings=[];for(var jt=0;jt<pt.strings.length;++jt)$t.strings[jt]=wt.bytes===String?at.base64.encode(pt.strings[jt],0,pt.strings[jt].length):wt.bytes===Array?Array.prototype.slice.call(pt.strings[jt]):pt.strings[jt]}if(pt.tensors&&pt.tensors.length){$t.tensors=[];for(var jt=0;jt<pt.tensors.length;++jt)$t.tensors[jt]=vt.onnx.TensorProto.toObject(pt.tensors[jt],wt)}if(pt.graphs&&pt.graphs.length){$t.graphs=[];for(var jt=0;jt<pt.graphs.length;++jt)$t.graphs[jt]=vt.onnx.GraphProto.toObject(pt.graphs[jt],wt)}if(pt.docString!=null&&pt.hasOwnProperty("docString")&&($t.docString=pt.docString),pt.tp!=null&&pt.hasOwnProperty("tp")&&($t.tp=vt.onnx.TypeProto.toObject(pt.tp,wt)),pt.typeProtos&&pt.typeProtos.length){$t.typeProtos=[];for(var jt=0;jt<pt.typeProtos.length;++jt)$t.typeProtos[jt]=vt.onnx.TypeProto.toObject(pt.typeProtos[jt],wt)}if(pt.type!=null&&pt.hasOwnProperty("type")&&($t.type=wt.enums===String?vt.onnx.AttributeProto.AttributeType[pt.type]===void 0?pt.type:vt.onnx.AttributeProto.AttributeType[pt.type]:pt.type),pt.refAttrName!=null&&pt.hasOwnProperty("refAttrName")&&($t.refAttrName=pt.refAttrName),pt.sparseTensor!=null&&pt.hasOwnProperty("sparseTensor")&&($t.sparseTensor=vt.onnx.SparseTensorProto.toObject(pt.sparseTensor,wt)),pt.sparseTensors&&pt.sparseTensors.length){$t.sparseTensors=[];for(var jt=0;jt<pt.sparseTensors.length;++jt)$t.sparseTensors[jt]=vt.onnx.SparseTensorProto.toObject(pt.sparseTensors[jt],wt)}return $t},Ct.prototype.toJSON=function(){return this.constructor.toObject(this,b.util.toJSONOptions)},Ct.getTypeUrl=function(pt){return pt===void 0&&(pt="type.googleapis.com"),pt+"/onnx.AttributeProto"},Ct.AttributeType=function(){var pt={},wt=Object.create(pt);return wt[pt[0]="UNDEFINED"]=0,wt[pt[1]="FLOAT"]=1,wt[pt[2]="INT"]=2,wt[pt[3]="STRING"]=3,wt[pt[4]="TENSOR"]=4,wt[pt[5]="GRAPH"]=5,wt[pt[11]="SPARSE_TENSOR"]=11,wt[pt[13]="TYPE_PROTO"]=13,wt[pt[6]="FLOATS"]=6,wt[pt[7]="INTS"]=7,wt[pt[8]="STRINGS"]=8,wt[pt[9]="TENSORS"]=9,wt[pt[10]="GRAPHS"]=10,wt[pt[12]="SPARSE_TENSORS"]=12,wt[pt[14]="TYPE_PROTOS"]=14,wt}(),Ct}(),Tt.ValueInfoProto=function(){function Ct(pt){if(pt)for(var wt=Object.keys(pt),$t=0;$t<wt.length;++$t)pt[wt[$t]]!=null&&(this[wt[$t]]=pt[wt[$t]])}return Ct.prototype.name="",Ct.prototype.type=null,Ct.prototype.docString="",Ct.create=function(pt){return new Ct(pt)},Ct.encode=function(pt,wt){return wt||(wt=st.create()),pt.name!=null&&Object.hasOwnProperty.call(pt,"name")&&wt.uint32(10).string(pt.name),pt.type!=null&&Object.hasOwnProperty.call(pt,"type")&&vt.onnx.TypeProto.encode(pt.type,wt.uint32(18).fork()).ldelim(),pt.docString!=null&&Object.hasOwnProperty.call(pt,"docString")&&wt.uint32(26).string(pt.docString),wt},Ct.encodeDelimited=function(pt,wt){return this.encode(pt,wt).ldelim()},Ct.decode=function(pt,wt){pt instanceof et||(pt=et.create(pt));for(var $t=wt===void 0?pt.len:pt.pos+wt,Lt=new vt.onnx.ValueInfoProto;pt.pos<$t;){var jt=pt.uint32();switch(jt>>>3){case 1:{Lt.name=pt.string();break}case 2:{Lt.type=vt.onnx.TypeProto.decode(pt,pt.uint32());break}case 3:{Lt.docString=pt.string();break}default:pt.skipType(jt&7);break}}return Lt},Ct.decodeDelimited=function(pt){return pt instanceof et||(pt=new et(pt)),this.decode(pt,pt.uint32())},Ct.verify=function(pt){if(typeof pt!="object"||pt===null)return"object expected";if(pt.name!=null&&pt.hasOwnProperty("name")&&!at.isString(pt.name))return"name: string expected";if(pt.type!=null&&pt.hasOwnProperty("type")){var wt=vt.onnx.TypeProto.verify(pt.type);if(wt)return"type."+wt}return pt.docString!=null&&pt.hasOwnProperty("docString")&&!at.isString(pt.docString)?"docString: string expected":null},Ct.fromObject=function(pt){if(pt instanceof vt.onnx.ValueInfoProto)return pt;var wt=new vt.onnx.ValueInfoProto;if(pt.name!=null&&(wt.name=String(pt.name)),pt.type!=null){if(typeof pt.type!="object")throw TypeError(".onnx.ValueInfoProto.type: object expected");wt.type=vt.onnx.TypeProto.fromObject(pt.type)}return pt.docString!=null&&(wt.docString=String(pt.docString)),wt},Ct.toObject=function(pt,wt){wt||(wt={});var $t={};return wt.defaults&&($t.name="",$t.type=null,$t.docString=""),pt.name!=null&&pt.hasOwnProperty("name")&&($t.name=pt.name),pt.type!=null&&pt.hasOwnProperty("type")&&($t.type=vt.onnx.TypeProto.toObject(pt.type,wt)),pt.docString!=null&&pt.hasOwnProperty("docString")&&($t.docString=pt.docString),$t},Ct.prototype.toJSON=function(){return this.constructor.toObject(this,b.util.toJSONOptions)},Ct.getTypeUrl=function(pt){return pt===void 0&&(pt="type.googleapis.com"),pt+"/onnx.ValueInfoProto"},Ct}(),Tt.NodeProto=function(){function Ct(pt){if(this.input=[],this.output=[],this.attribute=[],pt)for(var wt=Object.keys(pt),$t=0;$t<wt.length;++$t)pt[wt[$t]]!=null&&(this[wt[$t]]=pt[wt[$t]])}return Ct.prototype.input=at.emptyArray,Ct.prototype.output=at.emptyArray,Ct.prototype.name="",Ct.prototype.opType="",Ct.prototype.domain="",Ct.prototype.attribute=at.emptyArray,Ct.prototype.docString="",Ct.create=function(pt){return new Ct(pt)},Ct.encode=function(pt,wt){if(wt||(wt=st.create()),pt.input!=null&&pt.input.length)for(var $t=0;$t<pt.input.length;++$t)wt.uint32(10).string(pt.input[$t]);if(pt.output!=null&&pt.output.length)for(var $t=0;$t<pt.output.length;++$t)wt.uint32(18).string(pt.output[$t]);if(pt.name!=null&&Object.hasOwnProperty.call(pt,"name")&&wt.uint32(26).string(pt.name),pt.opType!=null&&Object.hasOwnProperty.call(pt,"opType")&&wt.uint32(34).string(pt.opType),pt.attribute!=null&&pt.attribute.length)for(var $t=0;$t<pt.attribute.length;++$t)vt.onnx.AttributeProto.encode(pt.attribute[$t],wt.uint32(42).fork()).ldelim();return pt.docString!=null&&Object.hasOwnProperty.call(pt,"docString")&&wt.uint32(50).string(pt.docString),pt.domain!=null&&Object.hasOwnProperty.call(pt,"domain")&&wt.uint32(58).string(pt.domain),wt},Ct.encodeDelimited=function(pt,wt){return this.encode(pt,wt).ldelim()},Ct.decode=function(pt,wt){pt instanceof et||(pt=et.create(pt));for(var $t=wt===void 0?pt.len:pt.pos+wt,Lt=new vt.onnx.NodeProto;pt.pos<$t;){var jt=pt.uint32();switch(jt>>>3){case 1:{Lt.input&&Lt.input.length||(Lt.input=[]),Lt.input.push(pt.string());break}case 2:{Lt.output&&Lt.output.length||(Lt.output=[]),Lt.output.push(pt.string());break}case 3:{Lt.name=pt.string();break}case 4:{Lt.opType=pt.string();break}case 7:{Lt.domain=pt.string();break}case 5:{Lt.attribute&&Lt.attribute.length||(Lt.attribute=[]),Lt.attribute.push(vt.onnx.AttributeProto.decode(pt,pt.uint32()));break}case 6:{Lt.docString=pt.string();break}default:pt.skipType(jt&7);break}}return Lt},Ct.decodeDelimited=function(pt){return pt instanceof et||(pt=new et(pt)),this.decode(pt,pt.uint32())},Ct.verify=function(pt){if(typeof pt!="object"||pt===null)return"object expected";if(pt.input!=null&&pt.hasOwnProperty("input")){if(!Array.isArray(pt.input))return"input: array expected";for(var wt=0;wt<pt.input.length;++wt)if(!at.isString(pt.input[wt]))return"input: string[] expected"}if(pt.output!=null&&pt.hasOwnProperty("output")){if(!Array.isArray(pt.output))return"output: array expected";for(var wt=0;wt<pt.output.length;++wt)if(!at.isString(pt.output[wt]))return"output: string[] expected"}if(pt.name!=null&&pt.hasOwnProperty("name")&&!at.isString(pt.name))return"name: string expected";if(pt.opType!=null&&pt.hasOwnProperty("opType")&&!at.isString(pt.opType))return"opType: string expected";if(pt.domain!=null&&pt.hasOwnProperty("domain")&&!at.isString(pt.domain))return"domain: string expected";if(pt.attribute!=null&&pt.hasOwnProperty("attribute")){if(!Array.isArray(pt.attribute))return"attribute: array expected";for(var wt=0;wt<pt.attribute.length;++wt){var $t=vt.onnx.AttributeProto.verify(pt.attribute[wt]);if($t)return"attribute."+$t}}return pt.docString!=null&&pt.hasOwnProperty("docString")&&!at.isString(pt.docString)?"docString: string expected":null},Ct.fromObject=function(pt){if(pt instanceof vt.onnx.NodeProto)return pt;var wt=new vt.onnx.NodeProto;if(pt.input){if(!Array.isArray(pt.input))throw TypeError(".onnx.NodeProto.input: array expected");wt.input=[];for(var $t=0;$t<pt.input.length;++$t)wt.input[$t]=String(pt.input[$t])}if(pt.output){if(!Array.isArray(pt.output))throw TypeError(".onnx.NodeProto.output: array expected");wt.output=[];for(var $t=0;$t<pt.output.length;++$t)wt.output[$t]=String(pt.output[$t])}if(pt.name!=null&&(wt.name=String(pt.name)),pt.opType!=null&&(wt.opType=String(pt.opType)),pt.domain!=null&&(wt.domain=String(pt.domain)),pt.attribute){if(!Array.isArray(pt.attribute))throw TypeError(".onnx.NodeProto.attribute: array expected");wt.attribute=[];for(var $t=0;$t<pt.attribute.length;++$t){if(typeof pt.attribute[$t]!="object")throw TypeError(".onnx.NodeProto.attribute: object expected");wt.attribute[$t]=vt.onnx.AttributeProto.fromObject(pt.attribute[$t])}}return pt.docString!=null&&(wt.docString=String(pt.docString)),wt},Ct.toObject=function(pt,wt){wt||(wt={});var $t={};if((wt.arrays||wt.defaults)&&($t.input=[],$t.output=[],$t.attribute=[]),wt.defaults&&($t.name="",$t.opType="",$t.docString="",$t.domain=""),pt.input&&pt.input.length){$t.input=[];for(var Lt=0;Lt<pt.input.length;++Lt)$t.input[Lt]=pt.input[Lt]}if(pt.output&&pt.output.length){$t.output=[];for(var Lt=0;Lt<pt.output.length;++Lt)$t.output[Lt]=pt.output[Lt]}if(pt.name!=null&&pt.hasOwnProperty("name")&&($t.name=pt.name),pt.opType!=null&&pt.hasOwnProperty("opType")&&($t.opType=pt.opType),pt.attribute&&pt.attribute.length){$t.attribute=[];for(var Lt=0;Lt<pt.attribute.length;++Lt)$t.attribute[Lt]=vt.onnx.AttributeProto.toObject(pt.attribute[Lt],wt)}return pt.docString!=null&&pt.hasOwnProperty("docString")&&($t.docString=pt.docString),pt.domain!=null&&pt.hasOwnProperty("domain")&&($t.domain=pt.domain),$t},Ct.prototype.toJSON=function(){return this.constructor.toObject(this,b.util.toJSONOptions)},Ct.getTypeUrl=function(pt){return pt===void 0&&(pt="type.googleapis.com"),pt+"/onnx.NodeProto"},Ct}(),Tt.TrainingInfoProto=function(){function Ct(pt){if(this.initializationBinding=[],this.updateBinding=[],pt)for(var wt=Object.keys(pt),$t=0;$t<wt.length;++$t)pt[wt[$t]]!=null&&(this[wt[$t]]=pt[wt[$t]])}return Ct.prototype.initialization=null,Ct.prototype.algorithm=null,Ct.prototype.initializationBinding=at.emptyArray,Ct.prototype.updateBinding=at.emptyArray,Ct.create=function(pt){return new Ct(pt)},Ct.encode=function(pt,wt){if(wt||(wt=st.create()),pt.initialization!=null&&Object.hasOwnProperty.call(pt,"initialization")&&vt.onnx.GraphProto.encode(pt.initialization,wt.uint32(10).fork()).ldelim(),pt.algorithm!=null&&Object.hasOwnProperty.call(pt,"algorithm")&&vt.onnx.GraphProto.encode(pt.algorithm,wt.uint32(18).fork()).ldelim(),pt.initializationBinding!=null&&pt.initializationBinding.length)for(var $t=0;$t<pt.initializationBinding.length;++$t)vt.onnx.StringStringEntryProto.encode(pt.initializationBinding[$t],wt.uint32(26).fork()).ldelim();if(pt.updateBinding!=null&&pt.updateBinding.length)for(var $t=0;$t<pt.updateBinding.length;++$t)vt.onnx.StringStringEntryProto.encode(pt.updateBinding[$t],wt.uint32(34).fork()).ldelim();return wt},Ct.encodeDelimited=function(pt,wt){return this.encode(pt,wt).ldelim()},Ct.decode=function(pt,wt){pt instanceof et||(pt=et.create(pt));for(var $t=wt===void 0?pt.len:pt.pos+wt,Lt=new vt.onnx.TrainingInfoProto;pt.pos<$t;){var jt=pt.uint32();switch(jt>>>3){case 1:{Lt.initialization=vt.onnx.GraphProto.decode(pt,pt.uint32());break}case 2:{Lt.algorithm=vt.onnx.GraphProto.decode(pt,pt.uint32());break}case 3:{Lt.initializationBinding&&Lt.initializationBinding.length||(Lt.initializationBinding=[]),Lt.initializationBinding.push(vt.onnx.StringStringEntryProto.decode(pt,pt.uint32()));break}case 4:{Lt.updateBinding&&Lt.updateBinding.length||(Lt.updateBinding=[]),Lt.updateBinding.push(vt.onnx.StringStringEntryProto.decode(pt,pt.uint32()));break}default:pt.skipType(jt&7);break}}return Lt},Ct.decodeDelimited=function(pt){return pt instanceof et||(pt=new et(pt)),this.decode(pt,pt.uint32())},Ct.verify=function(pt){if(typeof pt!="object"||pt===null)return"object expected";if(pt.initialization!=null&&pt.hasOwnProperty("initialization")){var wt=vt.onnx.GraphProto.verify(pt.initialization);if(wt)return"initialization."+wt}if(pt.algorithm!=null&&pt.hasOwnProperty("algorithm")){var wt=vt.onnx.GraphProto.verify(pt.algorithm);if(wt)return"algorithm."+wt}if(pt.initializationBinding!=null&&pt.hasOwnProperty("initializationBinding")){if(!Array.isArray(pt.initializationBinding))return"initializationBinding: array expected";for(var $t=0;$t<pt.initializationBinding.length;++$t){var wt=vt.onnx.StringStringEntryProto.verify(pt.initializationBinding[$t]);if(wt)return"initializationBinding."+wt}}if(pt.updateBinding!=null&&pt.hasOwnProperty("updateBinding")){if(!Array.isArray(pt.updateBinding))return"updateBinding: array expected";for(var $t=0;$t<pt.updateBinding.length;++$t){var wt=vt.onnx.StringStringEntryProto.verify(pt.updateBinding[$t]);if(wt)return"updateBinding."+wt}}return null},Ct.fromObject=function(pt){if(pt instanceof vt.onnx.TrainingInfoProto)return pt;var wt=new vt.onnx.TrainingInfoProto;if(pt.initialization!=null){if(typeof pt.initialization!="object")throw TypeError(".onnx.TrainingInfoProto.initialization: object expected");wt.initialization=vt.onnx.GraphProto.fromObject(pt.initialization)}if(pt.algorithm!=null){if(typeof pt.algorithm!="object")throw TypeError(".onnx.TrainingInfoProto.algorithm: object expected");wt.algorithm=vt.onnx.GraphProto.fromObject(pt.algorithm)}if(pt.initializationBinding){if(!Array.isArray(pt.initializationBinding))throw TypeError(".onnx.TrainingInfoProto.initializationBinding: array expected");wt.initializationBinding=[];for(var $t=0;$t<pt.initializationBinding.length;++$t){if(typeof pt.initializationBinding[$t]!="object")throw TypeError(".onnx.TrainingInfoProto.initializationBinding: object expected");wt.initializationBinding[$t]=vt.onnx.StringStringEntryProto.fromObject(pt.initializationBinding[$t])}}if(pt.updateBinding){if(!Array.isArray(pt.updateBinding))throw TypeError(".onnx.TrainingInfoProto.updateBinding: array expected");wt.updateBinding=[];for(var $t=0;$t<pt.updateBinding.length;++$t){if(typeof pt.updateBinding[$t]!="object")throw TypeError(".onnx.TrainingInfoProto.updateBinding: object expected");wt.updateBinding[$t]=vt.onnx.StringStringEntryProto.fromObject(pt.updateBinding[$t])}}return wt},Ct.toObject=function(pt,wt){wt||(wt={});var $t={};if((wt.arrays||wt.defaults)&&($t.initializationBinding=[],$t.updateBinding=[]),wt.defaults&&($t.initialization=null,$t.algorithm=null),pt.initialization!=null&&pt.hasOwnProperty("initialization")&&($t.initialization=vt.onnx.GraphProto.toObject(pt.initialization,wt)),pt.algorithm!=null&&pt.hasOwnProperty("algorithm")&&($t.algorithm=vt.onnx.GraphProto.toObject(pt.algorithm,wt)),pt.initializationBinding&&pt.initializationBinding.length){$t.initializationBinding=[];for(var Lt=0;Lt<pt.initializationBinding.length;++Lt)$t.initializationBinding[Lt]=vt.onnx.StringStringEntryProto.toObject(pt.initializationBinding[Lt],wt)}if(pt.updateBinding&&pt.updateBinding.length){$t.updateBinding=[];for(var Lt=0;Lt<pt.updateBinding.length;++Lt)$t.updateBinding[Lt]=vt.onnx.StringStringEntryProto.toObject(pt.updateBinding[Lt],wt)}return $t},Ct.prototype.toJSON=function(){return this.constructor.toObject(this,b.util.toJSONOptions)},Ct.getTypeUrl=function(pt){return pt===void 0&&(pt="type.googleapis.com"),pt+"/onnx.TrainingInfoProto"},Ct}(),Tt.ModelProto=function(){function Ct(pt){if(this.opsetImport=[],this.metadataProps=[],this.trainingInfo=[],this.functions=[],pt)for(var wt=Object.keys(pt),$t=0;$t<wt.length;++$t)pt[wt[$t]]!=null&&(this[wt[$t]]=pt[wt[$t]])}return Ct.prototype.irVersion=at.Long?at.Long.fromBits(0,0,!1):0,Ct.prototype.opsetImport=at.emptyArray,Ct.prototype.producerName="",Ct.prototype.producerVersion="",Ct.prototype.domain="",Ct.prototype.modelVersion=at.Long?at.Long.fromBits(0,0,!1):0,Ct.prototype.docString="",Ct.prototype.graph=null,Ct.prototype.metadataProps=at.emptyArray,Ct.prototype.trainingInfo=at.emptyArray,Ct.prototype.functions=at.emptyArray,Ct.create=function(pt){return new Ct(pt)},Ct.encode=function(pt,wt){if(wt||(wt=st.create()),pt.irVersion!=null&&Object.hasOwnProperty.call(pt,"irVersion")&&wt.uint32(8).int64(pt.irVersion),pt.producerName!=null&&Object.hasOwnProperty.call(pt,"producerName")&&wt.uint32(18).string(pt.producerName),pt.producerVersion!=null&&Object.hasOwnProperty.call(pt,"producerVersion")&&wt.uint32(26).string(pt.producerVersion),pt.domain!=null&&Object.hasOwnProperty.call(pt,"domain")&&wt.uint32(34).string(pt.domain),pt.modelVersion!=null&&Object.hasOwnProperty.call(pt,"modelVersion")&&wt.uint32(40).int64(pt.modelVersion),pt.docString!=null&&Object.hasOwnProperty.call(pt,"docString")&&wt.uint32(50).string(pt.docString),pt.graph!=null&&Object.hasOwnProperty.call(pt,"graph")&&vt.onnx.GraphProto.encode(pt.graph,wt.uint32(58).fork()).ldelim(),pt.opsetImport!=null&&pt.opsetImport.length)for(var $t=0;$t<pt.opsetImport.length;++$t)vt.onnx.OperatorSetIdProto.encode(pt.opsetImport[$t],wt.uint32(66).fork()).ldelim();if(pt.metadataProps!=null&&pt.metadataProps.length)for(var $t=0;$t<pt.metadataProps.length;++$t)vt.onnx.StringStringEntryProto.encode(pt.metadataProps[$t],wt.uint32(114).fork()).ldelim();if(pt.trainingInfo!=null&&pt.trainingInfo.length)for(var $t=0;$t<pt.trainingInfo.length;++$t)vt.onnx.TrainingInfoProto.encode(pt.trainingInfo[$t],wt.uint32(162).fork()).ldelim();if(pt.functions!=null&&pt.functions.length)for(var $t=0;$t<pt.functions.length;++$t)vt.onnx.FunctionProto.encode(pt.functions[$t],wt.uint32(202).fork()).ldelim();return wt},Ct.encodeDelimited=function(pt,wt){return this.encode(pt,wt).ldelim()},Ct.decode=function(pt,wt){pt instanceof et||(pt=et.create(pt));for(var $t=wt===void 0?pt.len:pt.pos+wt,Lt=new vt.onnx.ModelProto;pt.pos<$t;){var jt=pt.uint32();switch(jt>>>3){case 1:{Lt.irVersion=pt.int64();break}case 8:{Lt.opsetImport&&Lt.opsetImport.length||(Lt.opsetImport=[]),Lt.opsetImport.push(vt.onnx.OperatorSetIdProto.decode(pt,pt.uint32()));break}case 2:{Lt.producerName=pt.string();break}case 3:{Lt.producerVersion=pt.string();break}case 4:{Lt.domain=pt.string();break}case 5:{Lt.modelVersion=pt.int64();break}case 6:{Lt.docString=pt.string();break}case 7:{Lt.graph=vt.onnx.GraphProto.decode(pt,pt.uint32());break}case 14:{Lt.metadataProps&&Lt.metadataProps.length||(Lt.metadataProps=[]),Lt.metadataProps.push(vt.onnx.StringStringEntryProto.decode(pt,pt.uint32()));break}case 20:{Lt.trainingInfo&&Lt.trainingInfo.length||(Lt.trainingInfo=[]),Lt.trainingInfo.push(vt.onnx.TrainingInfoProto.decode(pt,pt.uint32()));break}case 25:{Lt.functions&&Lt.functions.length||(Lt.functions=[]),Lt.functions.push(vt.onnx.FunctionProto.decode(pt,pt.uint32()));break}default:pt.skipType(jt&7);break}}return Lt},Ct.decodeDelimited=function(pt){return pt instanceof et||(pt=new et(pt)),this.decode(pt,pt.uint32())},Ct.verify=function(pt){if(typeof pt!="object"||pt===null)return"object expected";if(pt.irVersion!=null&&pt.hasOwnProperty("irVersion")&&!at.isInteger(pt.irVersion)&&!(pt.irVersion&&at.isInteger(pt.irVersion.low)&&at.isInteger(pt.irVersion.high)))return"irVersion: integer|Long expected";if(pt.opsetImport!=null&&pt.hasOwnProperty("opsetImport")){if(!Array.isArray(pt.opsetImport))return"opsetImport: array expected";for(var wt=0;wt<pt.opsetImport.length;++wt){var $t=vt.onnx.OperatorSetIdProto.verify(pt.opsetImport[wt]);if($t)return"opsetImport."+$t}}if(pt.producerName!=null&&pt.hasOwnProperty("producerName")&&!at.isString(pt.producerName))return"producerName: string expected";if(pt.producerVersion!=null&&pt.hasOwnProperty("producerVersion")&&!at.isString(pt.producerVersion))return"producerVersion: string expected";if(pt.domain!=null&&pt.hasOwnProperty("domain")&&!at.isString(pt.domain))return"domain: string expected";if(pt.modelVersion!=null&&pt.hasOwnProperty("modelVersion")&&!at.isInteger(pt.modelVersion)&&!(pt.modelVersion&&at.isInteger(pt.modelVersion.low)&&at.isInteger(pt.modelVersion.high)))return"modelVersion: integer|Long expected";if(pt.docString!=null&&pt.hasOwnProperty("docString")&&!at.isString(pt.docString))return"docString: string expected";if(pt.graph!=null&&pt.hasOwnProperty("graph")){var $t=vt.onnx.GraphProto.verify(pt.graph);if($t)return"graph."+$t}if(pt.metadataProps!=null&&pt.hasOwnProperty("metadataProps")){if(!Array.isArray(pt.metadataProps))return"metadataProps: array expected";for(var wt=0;wt<pt.metadataProps.length;++wt){var $t=vt.onnx.StringStringEntryProto.verify(pt.metadataProps[wt]);if($t)return"metadataProps."+$t}}if(pt.trainingInfo!=null&&pt.hasOwnProperty("trainingInfo")){if(!Array.isArray(pt.trainingInfo))return"trainingInfo: array expected";for(var wt=0;wt<pt.trainingInfo.length;++wt){var $t=vt.onnx.TrainingInfoProto.verify(pt.trainingInfo[wt]);if($t)return"trainingInfo."+$t}}if(pt.functions!=null&&pt.hasOwnProperty("functions")){if(!Array.isArray(pt.functions))return"functions: array expected";for(var wt=0;wt<pt.functions.length;++wt){var $t=vt.onnx.FunctionProto.verify(pt.functions[wt]);if($t)return"functions."+$t}}return null},Ct.fromObject=function(pt){if(pt instanceof vt.onnx.ModelProto)return pt;var wt=new vt.onnx.ModelProto;if(pt.irVersion!=null&&(at.Long?(wt.irVersion=at.Long.fromValue(pt.irVersion)).unsigned=!1:typeof pt.irVersion=="string"?wt.irVersion=parseInt(pt.irVersion,10):typeof pt.irVersion=="number"?wt.irVersion=pt.irVersion:typeof pt.irVersion=="object"&&(wt.irVersion=new at.LongBits(pt.irVersion.low>>>0,pt.irVersion.high>>>0).toNumber())),pt.opsetImport){if(!Array.isArray(pt.opsetImport))throw TypeError(".onnx.ModelProto.opsetImport: array expected");wt.opsetImport=[];for(var $t=0;$t<pt.opsetImport.length;++$t){if(typeof pt.opsetImport[$t]!="object")throw TypeError(".onnx.ModelProto.opsetImport: object expected");wt.opsetImport[$t]=vt.onnx.OperatorSetIdProto.fromObject(pt.opsetImport[$t])}}if(pt.producerName!=null&&(wt.producerName=String(pt.producerName)),pt.producerVersion!=null&&(wt.producerVersion=String(pt.producerVersion)),pt.domain!=null&&(wt.domain=String(pt.domain)),pt.modelVersion!=null&&(at.Long?(wt.modelVersion=at.Long.fromValue(pt.modelVersion)).unsigned=!1:typeof pt.modelVersion=="string"?wt.modelVersion=parseInt(pt.modelVersion,10):typeof pt.modelVersion=="number"?wt.modelVersion=pt.modelVersion:typeof pt.modelVersion=="object"&&(wt.modelVersion=new at.LongBits(pt.modelVersion.low>>>0,pt.modelVersion.high>>>0).toNumber())),pt.docString!=null&&(wt.docString=String(pt.docString)),pt.graph!=null){if(typeof pt.graph!="object")throw TypeError(".onnx.ModelProto.graph: object expected");wt.graph=vt.onnx.GraphProto.fromObject(pt.graph)}if(pt.metadataProps){if(!Array.isArray(pt.metadataProps))throw TypeError(".onnx.ModelProto.metadataProps: array expected");wt.metadataProps=[];for(var $t=0;$t<pt.metadataProps.length;++$t){if(typeof pt.metadataProps[$t]!="object")throw TypeError(".onnx.ModelProto.metadataProps: object expected");wt.metadataProps[$t]=vt.onnx.StringStringEntryProto.fromObject(pt.metadataProps[$t])}}if(pt.trainingInfo){if(!Array.isArray(pt.trainingInfo))throw TypeError(".onnx.ModelProto.trainingInfo: array expected");wt.trainingInfo=[];for(var $t=0;$t<pt.trainingInfo.length;++$t){if(typeof pt.trainingInfo[$t]!="object")throw TypeError(".onnx.ModelProto.trainingInfo: object expected");wt.trainingInfo[$t]=vt.onnx.TrainingInfoProto.fromObject(pt.trainingInfo[$t])}}if(pt.functions){if(!Array.isArray(pt.functions))throw TypeError(".onnx.ModelProto.functions: array expected");wt.functions=[];for(var $t=0;$t<pt.functions.length;++$t){if(typeof pt.functions[$t]!="object")throw TypeError(".onnx.ModelProto.functions: object expected");wt.functions[$t]=vt.onnx.FunctionProto.fromObject(pt.functions[$t])}}return wt},Ct.toObject=function(pt,wt){wt||(wt={});var $t={};if((wt.arrays||wt.defaults)&&($t.opsetImport=[],$t.metadataProps=[],$t.trainingInfo=[],$t.functions=[]),wt.defaults){if(at.Long){var Lt=new at.Long(0,0,!1);$t.irVersion=wt.longs===String?Lt.toString():wt.longs===Number?Lt.toNumber():Lt}else $t.irVersion=wt.longs===String?"0":0;if($t.producerName="",$t.producerVersion="",$t.domain="",at.Long){var Lt=new at.Long(0,0,!1);$t.modelVersion=wt.longs===String?Lt.toString():wt.longs===Number?Lt.toNumber():Lt}else $t.modelVersion=wt.longs===String?"0":0;$t.docString="",$t.graph=null}if(pt.irVersion!=null&&pt.hasOwnProperty("irVersion")&&(typeof pt.irVersion=="number"?$t.irVersion=wt.longs===String?String(pt.irVersion):pt.irVersion:$t.irVersion=wt.longs===String?at.Long.prototype.toString.call(pt.irVersion):wt.longs===Number?new at.LongBits(pt.irVersion.low>>>0,pt.irVersion.high>>>0).toNumber():pt.irVersion),pt.producerName!=null&&pt.hasOwnProperty("producerName")&&($t.producerName=pt.producerName),pt.producerVersion!=null&&pt.hasOwnProperty("producerVersion")&&($t.producerVersion=pt.producerVersion),pt.domain!=null&&pt.hasOwnProperty("domain")&&($t.domain=pt.domain),pt.modelVersion!=null&&pt.hasOwnProperty("modelVersion")&&(typeof pt.modelVersion=="number"?$t.modelVersion=wt.longs===String?String(pt.modelVersion):pt.modelVersion:$t.modelVersion=wt.longs===String?at.Long.prototype.toString.call(pt.modelVersion):wt.longs===Number?new at.LongBits(pt.modelVersion.low>>>0,pt.modelVersion.high>>>0).toNumber():pt.modelVersion),pt.docString!=null&&pt.hasOwnProperty("docString")&&($t.docString=pt.docString),pt.graph!=null&&pt.hasOwnProperty("graph")&&($t.graph=vt.onnx.GraphProto.toObject(pt.graph,wt)),pt.opsetImport&&pt.opsetImport.length){$t.opsetImport=[];for(var jt=0;jt<pt.opsetImport.length;++jt)$t.opsetImport[jt]=vt.onnx.OperatorSetIdProto.toObject(pt.opsetImport[jt],wt)}if(pt.metadataProps&&pt.metadataProps.length){$t.metadataProps=[];for(var jt=0;jt<pt.metadataProps.length;++jt)$t.metadataProps[jt]=vt.onnx.StringStringEntryProto.toObject(pt.metadataProps[jt],wt)}if(pt.trainingInfo&&pt.trainingInfo.length){$t.trainingInfo=[];for(var jt=0;jt<pt.trainingInfo.length;++jt)$t.trainingInfo[jt]=vt.onnx.TrainingInfoProto.toObject(pt.trainingInfo[jt],wt)}if(pt.functions&&pt.functions.length){$t.functions=[];for(var jt=0;jt<pt.functions.length;++jt)$t.functions[jt]=vt.onnx.FunctionProto.toObject(pt.functions[jt],wt)}return $t},Ct.prototype.toJSON=function(){return this.constructor.toObject(this,b.util.toJSONOptions)},Ct.getTypeUrl=function(pt){return pt===void 0&&(pt="type.googleapis.com"),pt+"/onnx.ModelProto"},Ct}(),Tt.StringStringEntryProto=function(){function Ct(pt){if(pt)for(var wt=Object.keys(pt),$t=0;$t<wt.length;++$t)pt[wt[$t]]!=null&&(this[wt[$t]]=pt[wt[$t]])}return Ct.prototype.key="",Ct.prototype.value="",Ct.create=function(pt){return new Ct(pt)},Ct.encode=function(pt,wt){return wt||(wt=st.create()),pt.key!=null&&Object.hasOwnProperty.call(pt,"key")&&wt.uint32(10).string(pt.key),pt.value!=null&&Object.hasOwnProperty.call(pt,"value")&&wt.uint32(18).string(pt.value),wt},Ct.encodeDelimited=function(pt,wt){return this.encode(pt,wt).ldelim()},Ct.decode=function(pt,wt){pt instanceof et||(pt=et.create(pt));for(var $t=wt===void 0?pt.len:pt.pos+wt,Lt=new vt.onnx.StringStringEntryProto;pt.pos<$t;){var jt=pt.uint32();switch(jt>>>3){case 1:{Lt.key=pt.string();break}case 2:{Lt.value=pt.string();break}default:pt.skipType(jt&7);break}}return Lt},Ct.decodeDelimited=function(pt){return pt instanceof et||(pt=new et(pt)),this.decode(pt,pt.uint32())},Ct.verify=function(pt){return typeof pt!="object"||pt===null?"object expected":pt.key!=null&&pt.hasOwnProperty("key")&&!at.isString(pt.key)?"key: string expected":pt.value!=null&&pt.hasOwnProperty("value")&&!at.isString(pt.value)?"value: string expected":null},Ct.fromObject=function(pt){if(pt instanceof vt.onnx.StringStringEntryProto)return pt;var wt=new vt.onnx.StringStringEntryProto;return pt.key!=null&&(wt.key=String(pt.key)),pt.value!=null&&(wt.value=String(pt.value)),wt},Ct.toObject=function(pt,wt){wt||(wt={});var $t={};return wt.defaults&&($t.key="",$t.value=""),pt.key!=null&&pt.hasOwnProperty("key")&&($t.key=pt.key),pt.value!=null&&pt.hasOwnProperty("value")&&($t.value=pt.value),$t},Ct.prototype.toJSON=function(){return this.constructor.toObject(this,b.util.toJSONOptions)},Ct.getTypeUrl=function(pt){return pt===void 0&&(pt="type.googleapis.com"),pt+"/onnx.StringStringEntryProto"},Ct}(),Tt.TensorAnnotation=function(){function Ct(pt){if(this.quantParameterTensorNames=[],pt)for(var wt=Object.keys(pt),$t=0;$t<wt.length;++$t)pt[wt[$t]]!=null&&(this[wt[$t]]=pt[wt[$t]])}return Ct.prototype.tensorName="",Ct.prototype.quantParameterTensorNames=at.emptyArray,Ct.create=function(pt){return new Ct(pt)},Ct.encode=function(pt,wt){if(wt||(wt=st.create()),pt.tensorName!=null&&Object.hasOwnProperty.call(pt,"tensorName")&&wt.uint32(10).string(pt.tensorName),pt.quantParameterTensorNames!=null&&pt.quantParameterTensorNames.length)for(var $t=0;$t<pt.quantParameterTensorNames.length;++$t)vt.onnx.StringStringEntryProto.encode(pt.quantParameterTensorNames[$t],wt.uint32(18).fork()).ldelim();return wt},Ct.encodeDelimited=function(pt,wt){return this.encode(pt,wt).ldelim()},Ct.decode=function(pt,wt){pt instanceof et||(pt=et.create(pt));for(var $t=wt===void 0?pt.len:pt.pos+wt,Lt=new vt.onnx.TensorAnnotation;pt.pos<$t;){var jt=pt.uint32();switch(jt>>>3){case 1:{Lt.tensorName=pt.string();break}case 2:{Lt.quantParameterTensorNames&&Lt.quantParameterTensorNames.length||(Lt.quantParameterTensorNames=[]),Lt.quantParameterTensorNames.push(vt.onnx.StringStringEntryProto.decode(pt,pt.uint32()));break}default:pt.skipType(jt&7);break}}return Lt},Ct.decodeDelimited=function(pt){return pt instanceof et||(pt=new et(pt)),this.decode(pt,pt.uint32())},Ct.verify=function(pt){if(typeof pt!="object"||pt===null)return"object expected";if(pt.tensorName!=null&&pt.hasOwnProperty("tensorName")&&!at.isString(pt.tensorName))return"tensorName: string expected";if(pt.quantParameterTensorNames!=null&&pt.hasOwnProperty("quantParameterTensorNames")){if(!Array.isArray(pt.quantParameterTensorNames))return"quantParameterTensorNames: array expected";for(var wt=0;wt<pt.quantParameterTensorNames.length;++wt){var $t=vt.onnx.StringStringEntryProto.verify(pt.quantParameterTensorNames[wt]);if($t)return"quantParameterTensorNames."+$t}}return null},Ct.fromObject=function(pt){if(pt instanceof vt.onnx.TensorAnnotation)return pt;var wt=new vt.onnx.TensorAnnotation;if(pt.tensorName!=null&&(wt.tensorName=String(pt.tensorName)),pt.quantParameterTensorNames){if(!Array.isArray(pt.quantParameterTensorNames))throw TypeError(".onnx.TensorAnnotation.quantParameterTensorNames: array expected");wt.quantParameterTensorNames=[];for(var $t=0;$t<pt.quantParameterTensorNames.length;++$t){if(typeof pt.quantParameterTensorNames[$t]!="object")throw TypeError(".onnx.TensorAnnotation.quantParameterTensorNames: object expected");wt.quantParameterTensorNames[$t]=vt.onnx.StringStringEntryProto.fromObject(pt.quantParameterTensorNames[$t])}}return wt},Ct.toObject=function(pt,wt){wt||(wt={});var $t={};if((wt.arrays||wt.defaults)&&($t.quantParameterTensorNames=[]),wt.defaults&&($t.tensorName=""),pt.tensorName!=null&&pt.hasOwnProperty("tensorName")&&($t.tensorName=pt.tensorName),pt.quantParameterTensorNames&&pt.quantParameterTensorNames.length){$t.quantParameterTensorNames=[];for(var Lt=0;Lt<pt.quantParameterTensorNames.length;++Lt)$t.quantParameterTensorNames[Lt]=vt.onnx.StringStringEntryProto.toObject(pt.quantParameterTensorNames[Lt],wt)}return $t},Ct.prototype.toJSON=function(){return this.constructor.toObject(this,b.util.toJSONOptions)},Ct.getTypeUrl=function(pt){return pt===void 0&&(pt="type.googleapis.com"),pt+"/onnx.TensorAnnotation"},Ct}(),Tt.GraphProto=function(){function Ct(pt){if(this.node=[],this.initializer=[],this.sparseInitializer=[],this.input=[],this.output=[],this.valueInfo=[],this.quantizationAnnotation=[],pt)for(var wt=Object.keys(pt),$t=0;$t<wt.length;++$t)pt[wt[$t]]!=null&&(this[wt[$t]]=pt[wt[$t]])}return Ct.prototype.node=at.emptyArray,Ct.prototype.name="",Ct.prototype.initializer=at.emptyArray,Ct.prototype.sparseInitializer=at.emptyArray,Ct.prototype.docString="",Ct.prototype.input=at.emptyArray,Ct.prototype.output=at.emptyArray,Ct.prototype.valueInfo=at.emptyArray,Ct.prototype.quantizationAnnotation=at.emptyArray,Ct.create=function(pt){return new Ct(pt)},Ct.encode=function(pt,wt){if(wt||(wt=st.create()),pt.node!=null&&pt.node.length)for(var $t=0;$t<pt.node.length;++$t)vt.onnx.NodeProto.encode(pt.node[$t],wt.uint32(10).fork()).ldelim();if(pt.name!=null&&Object.hasOwnProperty.call(pt,"name")&&wt.uint32(18).string(pt.name),pt.initializer!=null&&pt.initializer.length)for(var $t=0;$t<pt.initializer.length;++$t)vt.onnx.TensorProto.encode(pt.initializer[$t],wt.uint32(42).fork()).ldelim();if(pt.docString!=null&&Object.hasOwnProperty.call(pt,"docString")&&wt.uint32(82).string(pt.docString),pt.input!=null&&pt.input.length)for(var $t=0;$t<pt.input.length;++$t)vt.onnx.ValueInfoProto.encode(pt.input[$t],wt.uint32(90).fork()).ldelim();if(pt.output!=null&&pt.output.length)for(var $t=0;$t<pt.output.length;++$t)vt.onnx.ValueInfoProto.encode(pt.output[$t],wt.uint32(98).fork()).ldelim();if(pt.valueInfo!=null&&pt.valueInfo.length)for(var $t=0;$t<pt.valueInfo.length;++$t)vt.onnx.ValueInfoProto.encode(pt.valueInfo[$t],wt.uint32(106).fork()).ldelim();if(pt.quantizationAnnotation!=null&&pt.quantizationAnnotation.length)for(var $t=0;$t<pt.quantizationAnnotation.length;++$t)vt.onnx.TensorAnnotation.encode(pt.quantizationAnnotation[$t],wt.uint32(114).fork()).ldelim();if(pt.sparseInitializer!=null&&pt.sparseInitializer.length)for(var $t=0;$t<pt.sparseInitializer.length;++$t)vt.onnx.SparseTensorProto.encode(pt.sparseInitializer[$t],wt.uint32(122).fork()).ldelim();return wt},Ct.encodeDelimited=function(pt,wt){return this.encode(pt,wt).ldelim()},Ct.decode=function(pt,wt){pt instanceof et||(pt=et.create(pt));for(var $t=wt===void 0?pt.len:pt.pos+wt,Lt=new vt.onnx.GraphProto;pt.pos<$t;){var jt=pt.uint32();switch(jt>>>3){case 1:{Lt.node&&Lt.node.length||(Lt.node=[]),Lt.node.push(vt.onnx.NodeProto.decode(pt,pt.uint32()));break}case 2:{Lt.name=pt.string();break}case 5:{Lt.initializer&&Lt.initializer.length||(Lt.initializer=[]),Lt.initializer.push(vt.onnx.TensorProto.decode(pt,pt.uint32()));break}case 15:{Lt.sparseInitializer&&Lt.sparseInitializer.length||(Lt.sparseInitializer=[]),Lt.sparseInitializer.push(vt.onnx.SparseTensorProto.decode(pt,pt.uint32()));break}case 10:{Lt.docString=pt.string();break}case 11:{Lt.input&&Lt.input.length||(Lt.input=[]),Lt.input.push(vt.onnx.ValueInfoProto.decode(pt,pt.uint32()));break}case 12:{Lt.output&&Lt.output.length||(Lt.output=[]),Lt.output.push(vt.onnx.ValueInfoProto.decode(pt,pt.uint32()));break}case 13:{Lt.valueInfo&&Lt.valueInfo.length||(Lt.valueInfo=[]),Lt.valueInfo.push(vt.onnx.ValueInfoProto.decode(pt,pt.uint32()));break}case 14:{Lt.quantizationAnnotation&&Lt.quantizationAnnotation.length||(Lt.quantizationAnnotation=[]),Lt.quantizationAnnotation.push(vt.onnx.TensorAnnotation.decode(pt,pt.uint32()));break}default:pt.skipType(jt&7);break}}return Lt},Ct.decodeDelimited=function(pt){return pt instanceof et||(pt=new et(pt)),this.decode(pt,pt.uint32())},Ct.verify=function(pt){if(typeof pt!="object"||pt===null)return"object expected";if(pt.node!=null&&pt.hasOwnProperty("node")){if(!Array.isArray(pt.node))return"node: array expected";for(var wt=0;wt<pt.node.length;++wt){var $t=vt.onnx.NodeProto.verify(pt.node[wt]);if($t)return"node."+$t}}if(pt.name!=null&&pt.hasOwnProperty("name")&&!at.isString(pt.name))return"name: string expected";if(pt.initializer!=null&&pt.hasOwnProperty("initializer")){if(!Array.isArray(pt.initializer))return"initializer: array expected";for(var wt=0;wt<pt.initializer.length;++wt){var $t=vt.onnx.TensorProto.verify(pt.initializer[wt]);if($t)return"initializer."+$t}}if(pt.sparseInitializer!=null&&pt.hasOwnProperty("sparseInitializer")){if(!Array.isArray(pt.sparseInitializer))return"sparseInitializer: array expected";for(var wt=0;wt<pt.sparseInitializer.length;++wt){var $t=vt.onnx.SparseTensorProto.verify(pt.sparseInitializer[wt]);if($t)return"sparseInitializer."+$t}}if(pt.docString!=null&&pt.hasOwnProperty("docString")&&!at.isString(pt.docString))return"docString: string expected";if(pt.input!=null&&pt.hasOwnProperty("input")){if(!Array.isArray(pt.input))return"input: array expected";for(var wt=0;wt<pt.input.length;++wt){var $t=vt.onnx.ValueInfoProto.verify(pt.input[wt]);if($t)return"input."+$t}}if(pt.output!=null&&pt.hasOwnProperty("output")){if(!Array.isArray(pt.output))return"output: array expected";for(var wt=0;wt<pt.output.length;++wt){var $t=vt.onnx.ValueInfoProto.verify(pt.output[wt]);if($t)return"output."+$t}}if(pt.valueInfo!=null&&pt.hasOwnProperty("valueInfo")){if(!Array.isArray(pt.valueInfo))return"valueInfo: array expected";for(var wt=0;wt<pt.valueInfo.length;++wt){var $t=vt.onnx.ValueInfoProto.verify(pt.valueInfo[wt]);if($t)return"valueInfo."+$t}}if(pt.quantizationAnnotation!=null&&pt.hasOwnProperty("quantizationAnnotation")){if(!Array.isArray(pt.quantizationAnnotation))return"quantizationAnnotation: array expected";for(var wt=0;wt<pt.quantizationAnnotation.length;++wt){var $t=vt.onnx.TensorAnnotation.verify(pt.quantizationAnnotation[wt]);if($t)return"quantizationAnnotation."+$t}}return null},Ct.fromObject=function(pt){if(pt instanceof vt.onnx.GraphProto)return pt;var wt=new vt.onnx.GraphProto;if(pt.node){if(!Array.isArray(pt.node))throw TypeError(".onnx.GraphProto.node: array expected");wt.node=[];for(var $t=0;$t<pt.node.length;++$t){if(typeof pt.node[$t]!="object")throw TypeError(".onnx.GraphProto.node: object expected");wt.node[$t]=vt.onnx.NodeProto.fromObject(pt.node[$t])}}if(pt.name!=null&&(wt.name=String(pt.name)),pt.initializer){if(!Array.isArray(pt.initializer))throw TypeError(".onnx.GraphProto.initializer: array expected");wt.initializer=[];for(var $t=0;$t<pt.initializer.length;++$t){if(typeof pt.initializer[$t]!="object")throw TypeError(".onnx.GraphProto.initializer: object expected");wt.initializer[$t]=vt.onnx.TensorProto.fromObject(pt.initializer[$t])}}if(pt.sparseInitializer){if(!Array.isArray(pt.sparseInitializer))throw TypeError(".onnx.GraphProto.sparseInitializer: array expected");wt.sparseInitializer=[];for(var $t=0;$t<pt.sparseInitializer.length;++$t){if(typeof pt.sparseInitializer[$t]!="object")throw TypeError(".onnx.GraphProto.sparseInitializer: object expected");wt.sparseInitializer[$t]=vt.onnx.SparseTensorProto.fromObject(pt.sparseInitializer[$t])}}if(pt.docString!=null&&(wt.docString=String(pt.docString)),pt.input){if(!Array.isArray(pt.input))throw TypeError(".onnx.GraphProto.input: array expected");wt.input=[];for(var $t=0;$t<pt.input.length;++$t){if(typeof pt.input[$t]!="object")throw TypeError(".onnx.GraphProto.input: object expected");wt.input[$t]=vt.onnx.ValueInfoProto.fromObject(pt.input[$t])}}if(pt.output){if(!Array.isArray(pt.output))throw TypeError(".onnx.GraphProto.output: array expected");wt.output=[];for(var $t=0;$t<pt.output.length;++$t){if(typeof pt.output[$t]!="object")throw TypeError(".onnx.GraphProto.output: object expected");wt.output[$t]=vt.onnx.ValueInfoProto.fromObject(pt.output[$t])}}if(pt.valueInfo){if(!Array.isArray(pt.valueInfo))throw TypeError(".onnx.GraphProto.valueInfo: array expected");wt.valueInfo=[];for(var $t=0;$t<pt.valueInfo.length;++$t){if(typeof pt.valueInfo[$t]!="object")throw TypeError(".onnx.GraphProto.valueInfo: object expected");wt.valueInfo[$t]=vt.onnx.ValueInfoProto.fromObject(pt.valueInfo[$t])}}if(pt.quantizationAnnotation){if(!Array.isArray(pt.quantizationAnnotation))throw TypeError(".onnx.GraphProto.quantizationAnnotation: array expected");wt.quantizationAnnotation=[];for(var $t=0;$t<pt.quantizationAnnotation.length;++$t){if(typeof pt.quantizationAnnotation[$t]!="object")throw TypeError(".onnx.GraphProto.quantizationAnnotation: object expected");wt.quantizationAnnotation[$t]=vt.onnx.TensorAnnotation.fromObject(pt.quantizationAnnotation[$t])}}return wt},Ct.toObject=function(pt,wt){wt||(wt={});var $t={};if((wt.arrays||wt.defaults)&&($t.node=[],$t.initializer=[],$t.input=[],$t.output=[],$t.valueInfo=[],$t.quantizationAnnotation=[],$t.sparseInitializer=[]),wt.defaults&&($t.name="",$t.docString=""),pt.node&&pt.node.length){$t.node=[];for(var Lt=0;Lt<pt.node.length;++Lt)$t.node[Lt]=vt.onnx.NodeProto.toObject(pt.node[Lt],wt)}if(pt.name!=null&&pt.hasOwnProperty("name")&&($t.name=pt.name),pt.initializer&&pt.initializer.length){$t.initializer=[];for(var Lt=0;Lt<pt.initializer.length;++Lt)$t.initializer[Lt]=vt.onnx.TensorProto.toObject(pt.initializer[Lt],wt)}if(pt.docString!=null&&pt.hasOwnProperty("docString")&&($t.docString=pt.docString),pt.input&&pt.input.length){$t.input=[];for(var Lt=0;Lt<pt.input.length;++Lt)$t.input[Lt]=vt.onnx.ValueInfoProto.toObject(pt.input[Lt],wt)}if(pt.output&&pt.output.length){$t.output=[];for(var Lt=0;Lt<pt.output.length;++Lt)$t.output[Lt]=vt.onnx.ValueInfoProto.toObject(pt.output[Lt],wt)}if(pt.valueInfo&&pt.valueInfo.length){$t.valueInfo=[];for(var Lt=0;Lt<pt.valueInfo.length;++Lt)$t.valueInfo[Lt]=vt.onnx.ValueInfoProto.toObject(pt.valueInfo[Lt],wt)}if(pt.quantizationAnnotation&&pt.quantizationAnnotation.length){$t.quantizationAnnotation=[];for(var Lt=0;Lt<pt.quantizationAnnotation.length;++Lt)$t.quantizationAnnotation[Lt]=vt.onnx.TensorAnnotation.toObject(pt.quantizationAnnotation[Lt],wt)}if(pt.sparseInitializer&&pt.sparseInitializer.length){$t.sparseInitializer=[];for(var Lt=0;Lt<pt.sparseInitializer.length;++Lt)$t.sparseInitializer[Lt]=vt.onnx.SparseTensorProto.toObject(pt.sparseInitializer[Lt],wt)}return $t},Ct.prototype.toJSON=function(){return this.constructor.toObject(this,b.util.toJSONOptions)},Ct.getTypeUrl=function(pt){return pt===void 0&&(pt="type.googleapis.com"),pt+"/onnx.GraphProto"},Ct}(),Tt.TensorProto=function(){function Ct(pt){if(this.dims=[],this.floatData=[],this.int32Data=[],this.stringData=[],this.int64Data=[],this.externalData=[],this.doubleData=[],this.uint64Data=[],pt)for(var wt=Object.keys(pt),$t=0;$t<wt.length;++$t)pt[wt[$t]]!=null&&(this[wt[$t]]=pt[wt[$t]])}return Ct.prototype.dims=at.emptyArray,Ct.prototype.dataType=0,Ct.prototype.segment=null,Ct.prototype.floatData=at.emptyArray,Ct.prototype.int32Data=at.emptyArray,Ct.prototype.stringData=at.emptyArray,Ct.prototype.int64Data=at.emptyArray,Ct.prototype.name="",Ct.prototype.docString="",Ct.prototype.rawData=at.newBuffer([]),Ct.prototype.externalData=at.emptyArray,Ct.prototype.dataLocation=0,Ct.prototype.doubleData=at.emptyArray,Ct.prototype.uint64Data=at.emptyArray,Ct.create=function(pt){return new Ct(pt)},Ct.encode=function(pt,wt){if(wt||(wt=st.create()),pt.dims!=null&&pt.dims.length){wt.uint32(10).fork();for(var $t=0;$t<pt.dims.length;++$t)wt.int64(pt.dims[$t]);wt.ldelim()}if(pt.dataType!=null&&Object.hasOwnProperty.call(pt,"dataType")&&wt.uint32(16).int32(pt.dataType),pt.segment!=null&&Object.hasOwnProperty.call(pt,"segment")&&vt.onnx.TensorProto.Segment.encode(pt.segment,wt.uint32(26).fork()).ldelim(),pt.floatData!=null&&pt.floatData.length){wt.uint32(34).fork();for(var $t=0;$t<pt.floatData.length;++$t)wt.float(pt.floatData[$t]);wt.ldelim()}if(pt.int32Data!=null&&pt.int32Data.length){wt.uint32(42).fork();for(var $t=0;$t<pt.int32Data.length;++$t)wt.int32(pt.int32Data[$t]);wt.ldelim()}if(pt.stringData!=null&&pt.stringData.length)for(var $t=0;$t<pt.stringData.length;++$t)wt.uint32(50).bytes(pt.stringData[$t]);if(pt.int64Data!=null&&pt.int64Data.length){wt.uint32(58).fork();for(var $t=0;$t<pt.int64Data.length;++$t)wt.int64(pt.int64Data[$t]);wt.ldelim()}if(pt.name!=null&&Object.hasOwnProperty.call(pt,"name")&&wt.uint32(66).string(pt.name),pt.rawData!=null&&Object.hasOwnProperty.call(pt,"rawData")&&wt.uint32(74).bytes(pt.rawData),pt.doubleData!=null&&pt.doubleData.length){wt.uint32(82).fork();for(var $t=0;$t<pt.doubleData.length;++$t)wt.double(pt.doubleData[$t]);wt.ldelim()}if(pt.uint64Data!=null&&pt.uint64Data.length){wt.uint32(90).fork();for(var $t=0;$t<pt.uint64Data.length;++$t)wt.uint64(pt.uint64Data[$t]);wt.ldelim()}if(pt.docString!=null&&Object.hasOwnProperty.call(pt,"docString")&&wt.uint32(98).string(pt.docString),pt.externalData!=null&&pt.externalData.length)for(var $t=0;$t<pt.externalData.length;++$t)vt.onnx.StringStringEntryProto.encode(pt.externalData[$t],wt.uint32(106).fork()).ldelim();return pt.dataLocation!=null&&Object.hasOwnProperty.call(pt,"dataLocation")&&wt.uint32(112).int32(pt.dataLocation),wt},Ct.encodeDelimited=function(pt,wt){return this.encode(pt,wt).ldelim()},Ct.decode=function(pt,wt){pt instanceof et||(pt=et.create(pt));for(var $t=wt===void 0?pt.len:pt.pos+wt,Lt=new vt.onnx.TensorProto;pt.pos<$t;){var jt=pt.uint32();switch(jt>>>3){case 1:{if(Lt.dims&&Lt.dims.length||(Lt.dims=[]),(jt&7)===2)for(var Ft=pt.uint32()+pt.pos;pt.pos<Ft;)Lt.dims.push(pt.int64());else Lt.dims.push(pt.int64());break}case 2:{Lt.dataType=pt.int32();break}case 3:{Lt.segment=vt.onnx.TensorProto.Segment.decode(pt,pt.uint32());break}case 4:{if(Lt.floatData&&Lt.floatData.length||(Lt.floatData=[]),(jt&7)===2)for(var Ft=pt.uint32()+pt.pos;pt.pos<Ft;)Lt.floatData.push(pt.float());else Lt.floatData.push(pt.float());break}case 5:{if(Lt.int32Data&&Lt.int32Data.length||(Lt.int32Data=[]),(jt&7)===2)for(var Ft=pt.uint32()+pt.pos;pt.pos<Ft;)Lt.int32Data.push(pt.int32());else Lt.int32Data.push(pt.int32());break}case 6:{Lt.stringData&&Lt.stringData.length||(Lt.stringData=[]),Lt.stringData.push(pt.bytes());break}case 7:{if(Lt.int64Data&&Lt.int64Data.length||(Lt.int64Data=[]),(jt&7)===2)for(var Ft=pt.uint32()+pt.pos;pt.pos<Ft;)Lt.int64Data.push(pt.int64());else Lt.int64Data.push(pt.int64());break}case 8:{Lt.name=pt.string();break}case 12:{Lt.docString=pt.string();break}case 9:{Lt.rawData=pt.bytes();break}case 13:{Lt.externalData&&Lt.externalData.length||(Lt.externalData=[]),Lt.externalData.push(vt.onnx.StringStringEntryProto.decode(pt,pt.uint32()));break}case 14:{Lt.dataLocation=pt.int32();break}case 10:{if(Lt.doubleData&&Lt.doubleData.length||(Lt.doubleData=[]),(jt&7)===2)for(var Ft=pt.uint32()+pt.pos;pt.pos<Ft;)Lt.doubleData.push(pt.double());else Lt.doubleData.push(pt.double());break}case 11:{if(Lt.uint64Data&&Lt.uint64Data.length||(Lt.uint64Data=[]),(jt&7)===2)for(var Ft=pt.uint32()+pt.pos;pt.pos<Ft;)Lt.uint64Data.push(pt.uint64());else Lt.uint64Data.push(pt.uint64());break}default:pt.skipType(jt&7);break}}return Lt},Ct.decodeDelimited=function(pt){return pt instanceof et||(pt=new et(pt)),this.decode(pt,pt.uint32())},Ct.verify=function(pt){if(typeof pt!="object"||pt===null)return"object expected";if(pt.dims!=null&&pt.hasOwnProperty("dims")){if(!Array.isArray(pt.dims))return"dims: array expected";for(var wt=0;wt<pt.dims.length;++wt)if(!at.isInteger(pt.dims[wt])&&!(pt.dims[wt]&&at.isInteger(pt.dims[wt].low)&&at.isInteger(pt.dims[wt].high)))return"dims: integer|Long[] expected"}if(pt.dataType!=null&&pt.hasOwnProperty("dataType")&&!at.isInteger(pt.dataType))return"dataType: integer expected";if(pt.segment!=null&&pt.hasOwnProperty("segment")){var $t=vt.onnx.TensorProto.Segment.verify(pt.segment);if($t)return"segment."+$t}if(pt.floatData!=null&&pt.hasOwnProperty("floatData")){if(!Array.isArray(pt.floatData))return"floatData: array expected";for(var wt=0;wt<pt.floatData.length;++wt)if(typeof pt.floatData[wt]!="number")return"floatData: number[] expected"}if(pt.int32Data!=null&&pt.hasOwnProperty("int32Data")){if(!Array.isArray(pt.int32Data))return"int32Data: array expected";for(var wt=0;wt<pt.int32Data.length;++wt)if(!at.isInteger(pt.int32Data[wt]))return"int32Data: integer[] expected"}if(pt.stringData!=null&&pt.hasOwnProperty("stringData")){if(!Array.isArray(pt.stringData))return"stringData: array expected";for(var wt=0;wt<pt.stringData.length;++wt)if(!(pt.stringData[wt]&&typeof pt.stringData[wt].length=="number"||at.isString(pt.stringData[wt])))return"stringData: buffer[] expected"}if(pt.int64Data!=null&&pt.hasOwnProperty("int64Data")){if(!Array.isArray(pt.int64Data))return"int64Data: array expected";for(var wt=0;wt<pt.int64Data.length;++wt)if(!at.isInteger(pt.int64Data[wt])&&!(pt.int64Data[wt]&&at.isInteger(pt.int64Data[wt].low)&&at.isInteger(pt.int64Data[wt].high)))return"int64Data: integer|Long[] expected"}if(pt.name!=null&&pt.hasOwnProperty("name")&&!at.isString(pt.name))return"name: string expected";if(pt.docString!=null&&pt.hasOwnProperty("docString")&&!at.isString(pt.docString))return"docString: string expected";if(pt.rawData!=null&&pt.hasOwnProperty("rawData")&&!(pt.rawData&&typeof pt.rawData.length=="number"||at.isString(pt.rawData)))return"rawData: buffer expected";if(pt.externalData!=null&&pt.hasOwnProperty("externalData")){if(!Array.isArray(pt.externalData))return"externalData: array expected";for(var wt=0;wt<pt.externalData.length;++wt){var $t=vt.onnx.StringStringEntryProto.verify(pt.externalData[wt]);if($t)return"externalData."+$t}}if(pt.dataLocation!=null&&pt.hasOwnProperty("dataLocation"))switch(pt.dataLocation){default:return"dataLocation: enum value expected";case 0:case 1:break}if(pt.doubleData!=null&&pt.hasOwnProperty("doubleData")){if(!Array.isArray(pt.doubleData))return"doubleData: array expected";for(var wt=0;wt<pt.doubleData.length;++wt)if(typeof pt.doubleData[wt]!="number")return"doubleData: number[] expected"}if(pt.uint64Data!=null&&pt.hasOwnProperty("uint64Data")){if(!Array.isArray(pt.uint64Data))return"uint64Data: array expected";for(var wt=0;wt<pt.uint64Data.length;++wt)if(!at.isInteger(pt.uint64Data[wt])&&!(pt.uint64Data[wt]&&at.isInteger(pt.uint64Data[wt].low)&&at.isInteger(pt.uint64Data[wt].high)))return"uint64Data: integer|Long[] expected"}return null},Ct.fromObject=function(pt){if(pt instanceof vt.onnx.TensorProto)return pt;var wt=new vt.onnx.TensorProto;if(pt.dims){if(!Array.isArray(pt.dims))throw TypeError(".onnx.TensorProto.dims: array expected");wt.dims=[];for(var $t=0;$t<pt.dims.length;++$t)at.Long?(wt.dims[$t]=at.Long.fromValue(pt.dims[$t])).unsigned=!1:typeof pt.dims[$t]=="string"?wt.dims[$t]=parseInt(pt.dims[$t],10):typeof pt.dims[$t]=="number"?wt.dims[$t]=pt.dims[$t]:typeof pt.dims[$t]=="object"&&(wt.dims[$t]=new at.LongBits(pt.dims[$t].low>>>0,pt.dims[$t].high>>>0).toNumber())}if(pt.dataType!=null&&(wt.dataType=pt.dataType|0),pt.segment!=null){if(typeof pt.segment!="object")throw TypeError(".onnx.TensorProto.segment: object expected");wt.segment=vt.onnx.TensorProto.Segment.fromObject(pt.segment)}if(pt.floatData){if(!Array.isArray(pt.floatData))throw TypeError(".onnx.TensorProto.floatData: array expected");wt.floatData=[];for(var $t=0;$t<pt.floatData.length;++$t)wt.floatData[$t]=Number(pt.floatData[$t])}if(pt.int32Data){if(!Array.isArray(pt.int32Data))throw TypeError(".onnx.TensorProto.int32Data: array expected");wt.int32Data=[];for(var $t=0;$t<pt.int32Data.length;++$t)wt.int32Data[$t]=pt.int32Data[$t]|0}if(pt.stringData){if(!Array.isArray(pt.stringData))throw TypeError(".onnx.TensorProto.stringData: array expected");wt.stringData=[];for(var $t=0;$t<pt.stringData.length;++$t)typeof pt.stringData[$t]=="string"?at.base64.decode(pt.stringData[$t],wt.stringData[$t]=at.newBuffer(at.base64.length(pt.stringData[$t])),0):pt.stringData[$t].length>=0&&(wt.stringData[$t]=pt.stringData[$t])}if(pt.int64Data){if(!Array.isArray(pt.int64Data))throw TypeError(".onnx.TensorProto.int64Data: array expected");wt.int64Data=[];for(var $t=0;$t<pt.int64Data.length;++$t)at.Long?(wt.int64Data[$t]=at.Long.fromValue(pt.int64Data[$t])).unsigned=!1:typeof pt.int64Data[$t]=="string"?wt.int64Data[$t]=parseInt(pt.int64Data[$t],10):typeof pt.int64Data[$t]=="number"?wt.int64Data[$t]=pt.int64Data[$t]:typeof pt.int64Data[$t]=="object"&&(wt.int64Data[$t]=new at.LongBits(pt.int64Data[$t].low>>>0,pt.int64Data[$t].high>>>0).toNumber())}if(pt.name!=null&&(wt.name=String(pt.name)),pt.docString!=null&&(wt.docString=String(pt.docString)),pt.rawData!=null&&(typeof pt.rawData=="string"?at.base64.decode(pt.rawData,wt.rawData=at.newBuffer(at.base64.length(pt.rawData)),0):pt.rawData.length>=0&&(wt.rawData=pt.rawData)),pt.externalData){if(!Array.isArray(pt.externalData))throw TypeError(".onnx.TensorProto.externalData: array expected");wt.externalData=[];for(var $t=0;$t<pt.externalData.length;++$t){if(typeof pt.externalData[$t]!="object")throw TypeError(".onnx.TensorProto.externalData: object expected");wt.externalData[$t]=vt.onnx.StringStringEntryProto.fromObject(pt.externalData[$t])}}switch(pt.dataLocation){default:if(typeof pt.dataLocation=="number"){wt.dataLocation=pt.dataLocation;break}break;case"DEFAULT":case 0:wt.dataLocation=0;break;case"EXTERNAL":case 1:wt.dataLocation=1;break}if(pt.doubleData){if(!Array.isArray(pt.doubleData))throw TypeError(".onnx.TensorProto.doubleData: array expected");wt.doubleData=[];for(var $t=0;$t<pt.doubleData.length;++$t)wt.doubleData[$t]=Number(pt.doubleData[$t])}if(pt.uint64Data){if(!Array.isArray(pt.uint64Data))throw TypeError(".onnx.TensorProto.uint64Data: array expected");wt.uint64Data=[];for(var $t=0;$t<pt.uint64Data.length;++$t)at.Long?(wt.uint64Data[$t]=at.Long.fromValue(pt.uint64Data[$t])).unsigned=!0:typeof pt.uint64Data[$t]=="string"?wt.uint64Data[$t]=parseInt(pt.uint64Data[$t],10):typeof pt.uint64Data[$t]=="number"?wt.uint64Data[$t]=pt.uint64Data[$t]:typeof pt.uint64Data[$t]=="object"&&(wt.uint64Data[$t]=new at.LongBits(pt.uint64Data[$t].low>>>0,pt.uint64Data[$t].high>>>0).toNumber(!0))}return wt},Ct.toObject=function(pt,wt){wt||(wt={});var $t={};if((wt.arrays||wt.defaults)&&($t.dims=[],$t.floatData=[],$t.int32Data=[],$t.stringData=[],$t.int64Data=[],$t.doubleData=[],$t.uint64Data=[],$t.externalData=[]),wt.defaults&&($t.dataType=0,$t.segment=null,$t.name="",wt.bytes===String?$t.rawData="":($t.rawData=[],wt.bytes!==Array&&($t.rawData=at.newBuffer($t.rawData))),$t.docString="",$t.dataLocation=wt.enums===String?"DEFAULT":0),pt.dims&&pt.dims.length){$t.dims=[];for(var Lt=0;Lt<pt.dims.length;++Lt)typeof pt.dims[Lt]=="number"?$t.dims[Lt]=wt.longs===String?String(pt.dims[Lt]):pt.dims[Lt]:$t.dims[Lt]=wt.longs===String?at.Long.prototype.toString.call(pt.dims[Lt]):wt.longs===Number?new at.LongBits(pt.dims[Lt].low>>>0,pt.dims[Lt].high>>>0).toNumber():pt.dims[Lt]}if(pt.dataType!=null&&pt.hasOwnProperty("dataType")&&($t.dataType=pt.dataType),pt.segment!=null&&pt.hasOwnProperty("segment")&&($t.segment=vt.onnx.TensorProto.Segment.toObject(pt.segment,wt)),pt.floatData&&pt.floatData.length){$t.floatData=[];for(var Lt=0;Lt<pt.floatData.length;++Lt)$t.floatData[Lt]=wt.json&&!isFinite(pt.floatData[Lt])?String(pt.floatData[Lt]):pt.floatData[Lt]}if(pt.int32Data&&pt.int32Data.length){$t.int32Data=[];for(var Lt=0;Lt<pt.int32Data.length;++Lt)$t.int32Data[Lt]=pt.int32Data[Lt]}if(pt.stringData&&pt.stringData.length){$t.stringData=[];for(var Lt=0;Lt<pt.stringData.length;++Lt)$t.stringData[Lt]=wt.bytes===String?at.base64.encode(pt.stringData[Lt],0,pt.stringData[Lt].length):wt.bytes===Array?Array.prototype.slice.call(pt.stringData[Lt]):pt.stringData[Lt]}if(pt.int64Data&&pt.int64Data.length){$t.int64Data=[];for(var Lt=0;Lt<pt.int64Data.length;++Lt)typeof pt.int64Data[Lt]=="number"?$t.int64Data[Lt]=wt.longs===String?String(pt.int64Data[Lt]):pt.int64Data[Lt]:$t.int64Data[Lt]=wt.longs===String?at.Long.prototype.toString.call(pt.int64Data[Lt]):wt.longs===Number?new at.LongBits(pt.int64Data[Lt].low>>>0,pt.int64Data[Lt].high>>>0).toNumber():pt.int64Data[Lt]}if(pt.name!=null&&pt.hasOwnProperty("name")&&($t.name=pt.name),pt.rawData!=null&&pt.hasOwnProperty("rawData")&&($t.rawData=wt.bytes===String?at.base64.encode(pt.rawData,0,pt.rawData.length):wt.bytes===Array?Array.prototype.slice.call(pt.rawData):pt.rawData),pt.doubleData&&pt.doubleData.length){$t.doubleData=[];for(var Lt=0;Lt<pt.doubleData.length;++Lt)$t.doubleData[Lt]=wt.json&&!isFinite(pt.doubleData[Lt])?String(pt.doubleData[Lt]):pt.doubleData[Lt]}if(pt.uint64Data&&pt.uint64Data.length){$t.uint64Data=[];for(var Lt=0;Lt<pt.uint64Data.length;++Lt)typeof pt.uint64Data[Lt]=="number"?$t.uint64Data[Lt]=wt.longs===String?String(pt.uint64Data[Lt]):pt.uint64Data[Lt]:$t.uint64Data[Lt]=wt.longs===String?at.Long.prototype.toString.call(pt.uint64Data[Lt]):wt.longs===Number?new at.LongBits(pt.uint64Data[Lt].low>>>0,pt.uint64Data[Lt].high>>>0).toNumber(!0):pt.uint64Data[Lt]}if(pt.docString!=null&&pt.hasOwnProperty("docString")&&($t.docString=pt.docString),pt.externalData&&pt.externalData.length){$t.externalData=[];for(var Lt=0;Lt<pt.externalData.length;++Lt)$t.externalData[Lt]=vt.onnx.StringStringEntryProto.toObject(pt.externalData[Lt],wt)}return pt.dataLocation!=null&&pt.hasOwnProperty("dataLocation")&&($t.dataLocation=wt.enums===String?vt.onnx.TensorProto.DataLocation[pt.dataLocation]===void 0?pt.dataLocation:vt.onnx.TensorProto.DataLocation[pt.dataLocation]:pt.dataLocation),$t},Ct.prototype.toJSON=function(){return this.constructor.toObject(this,b.util.toJSONOptions)},Ct.getTypeUrl=function(pt){return pt===void 0&&(pt="type.googleapis.com"),pt+"/onnx.TensorProto"},Ct.DataType=function(){var pt={},wt=Object.create(pt);return wt[pt[0]="UNDEFINED"]=0,wt[pt[1]="FLOAT"]=1,wt[pt[2]="UINT8"]=2,wt[pt[3]="INT8"]=3,wt[pt[4]="UINT16"]=4,wt[pt[5]="INT16"]=5,wt[pt[6]="INT32"]=6,wt[pt[7]="INT64"]=7,wt[pt[8]="STRING"]=8,wt[pt[9]="BOOL"]=9,wt[pt[10]="FLOAT16"]=10,wt[pt[11]="DOUBLE"]=11,wt[pt[12]="UINT32"]=12,wt[pt[13]="UINT64"]=13,wt[pt[14]="COMPLEX64"]=14,wt[pt[15]="COMPLEX128"]=15,wt[pt[16]="BFLOAT16"]=16,wt[pt[17]="FLOAT8E4M3FN"]=17,wt[pt[18]="FLOAT8E4M3FNUZ"]=18,wt[pt[19]="FLOAT8E5M2"]=19,wt[pt[20]="FLOAT8E5M2FNUZ"]=20,wt}(),Ct.Segment=function(){function pt(wt){if(wt)for(var $t=Object.keys(wt),Lt=0;Lt<$t.length;++Lt)wt[$t[Lt]]!=null&&(this[$t[Lt]]=wt[$t[Lt]])}return pt.prototype.begin=at.Long?at.Long.fromBits(0,0,!1):0,pt.prototype.end=at.Long?at.Long.fromBits(0,0,!1):0,pt.create=function(wt){return new pt(wt)},pt.encode=function(wt,$t){return $t||($t=st.create()),wt.begin!=null&&Object.hasOwnProperty.call(wt,"begin")&&$t.uint32(8).int64(wt.begin),wt.end!=null&&Object.hasOwnProperty.call(wt,"end")&&$t.uint32(16).int64(wt.end),$t},pt.encodeDelimited=function(wt,$t){return this.encode(wt,$t).ldelim()},pt.decode=function(wt,$t){wt instanceof et||(wt=et.create(wt));for(var Lt=$t===void 0?wt.len:wt.pos+$t,jt=new vt.onnx.TensorProto.Segment;wt.pos<Lt;){var Ft=wt.uint32();switch(Ft>>>3){case 1:{jt.begin=wt.int64();break}case 2:{jt.end=wt.int64();break}default:wt.skipType(Ft&7);break}}return jt},pt.decodeDelimited=function(wt){return wt instanceof et||(wt=new et(wt)),this.decode(wt,wt.uint32())},pt.verify=function(wt){return typeof wt!="object"||wt===null?"object expected":wt.begin!=null&&wt.hasOwnProperty("begin")&&!at.isInteger(wt.begin)&&!(wt.begin&&at.isInteger(wt.begin.low)&&at.isInteger(wt.begin.high))?"begin: integer|Long expected":wt.end!=null&&wt.hasOwnProperty("end")&&!at.isInteger(wt.end)&&!(wt.end&&at.isInteger(wt.end.low)&&at.isInteger(wt.end.high))?"end: integer|Long expected":null},pt.fromObject=function(wt){if(wt instanceof vt.onnx.TensorProto.Segment)return wt;var $t=new vt.onnx.TensorProto.Segment;return wt.begin!=null&&(at.Long?($t.begin=at.Long.fromValue(wt.begin)).unsigned=!1:typeof wt.begin=="string"?$t.begin=parseInt(wt.begin,10):typeof wt.begin=="number"?$t.begin=wt.begin:typeof wt.begin=="object"&&($t.begin=new at.LongBits(wt.begin.low>>>0,wt.begin.high>>>0).toNumber())),wt.end!=null&&(at.Long?($t.end=at.Long.fromValue(wt.end)).unsigned=!1:typeof wt.end=="string"?$t.end=parseInt(wt.end,10):typeof wt.end=="number"?$t.end=wt.end:typeof wt.end=="object"&&($t.end=new at.LongBits(wt.end.low>>>0,wt.end.high>>>0).toNumber())),$t},pt.toObject=function(wt,$t){$t||($t={});var Lt={};if($t.defaults){if(at.Long){var jt=new at.Long(0,0,!1);Lt.begin=$t.longs===String?jt.toString():$t.longs===Number?jt.toNumber():jt}else Lt.begin=$t.longs===String?"0":0;if(at.Long){var jt=new at.Long(0,0,!1);Lt.end=$t.longs===String?jt.toString():$t.longs===Number?jt.toNumber():jt}else Lt.end=$t.longs===String?"0":0}return wt.begin!=null&&wt.hasOwnProperty("begin")&&(typeof wt.begin=="number"?Lt.begin=$t.longs===String?String(wt.begin):wt.begin:Lt.begin=$t.longs===String?at.Long.prototype.toString.call(wt.begin):$t.longs===Number?new at.LongBits(wt.begin.low>>>0,wt.begin.high>>>0).toNumber():wt.begin),wt.end!=null&&wt.hasOwnProperty("end")&&(typeof wt.end=="number"?Lt.end=$t.longs===String?String(wt.end):wt.end:Lt.end=$t.longs===String?at.Long.prototype.toString.call(wt.end):$t.longs===Number?new at.LongBits(wt.end.low>>>0,wt.end.high>>>0).toNumber():wt.end),Lt},pt.prototype.toJSON=function(){return this.constructor.toObject(this,b.util.toJSONOptions)},pt.getTypeUrl=function(wt){return wt===void 0&&(wt="type.googleapis.com"),wt+"/onnx.TensorProto.Segment"},pt}(),Ct.DataLocation=function(){var pt={},wt=Object.create(pt);return wt[pt[0]="DEFAULT"]=0,wt[pt[1]="EXTERNAL"]=1,wt}(),Ct}(),Tt.SparseTensorProto=function(){function Ct(pt){if(this.dims=[],pt)for(var wt=Object.keys(pt),$t=0;$t<wt.length;++$t)pt[wt[$t]]!=null&&(this[wt[$t]]=pt[wt[$t]])}return Ct.prototype.values=null,Ct.prototype.indices=null,Ct.prototype.dims=at.emptyArray,Ct.create=function(pt){return new Ct(pt)},Ct.encode=function(pt,wt){if(wt||(wt=st.create()),pt.values!=null&&Object.hasOwnProperty.call(pt,"values")&&vt.onnx.TensorProto.encode(pt.values,wt.uint32(10).fork()).ldelim(),pt.indices!=null&&Object.hasOwnProperty.call(pt,"indices")&&vt.onnx.TensorProto.encode(pt.indices,wt.uint32(18).fork()).ldelim(),pt.dims!=null&&pt.dims.length){wt.uint32(26).fork();for(var $t=0;$t<pt.dims.length;++$t)wt.int64(pt.dims[$t]);wt.ldelim()}return wt},Ct.encodeDelimited=function(pt,wt){return this.encode(pt,wt).ldelim()},Ct.decode=function(pt,wt){pt instanceof et||(pt=et.create(pt));for(var $t=wt===void 0?pt.len:pt.pos+wt,Lt=new vt.onnx.SparseTensorProto;pt.pos<$t;){var jt=pt.uint32();switch(jt>>>3){case 1:{Lt.values=vt.onnx.TensorProto.decode(pt,pt.uint32());break}case 2:{Lt.indices=vt.onnx.TensorProto.decode(pt,pt.uint32());break}case 3:{if(Lt.dims&&Lt.dims.length||(Lt.dims=[]),(jt&7)===2)for(var Ft=pt.uint32()+pt.pos;pt.pos<Ft;)Lt.dims.push(pt.int64());else Lt.dims.push(pt.int64());break}default:pt.skipType(jt&7);break}}return Lt},Ct.decodeDelimited=function(pt){return pt instanceof et||(pt=new et(pt)),this.decode(pt,pt.uint32())},Ct.verify=function(pt){if(typeof pt!="object"||pt===null)return"object expected";if(pt.values!=null&&pt.hasOwnProperty("values")){var wt=vt.onnx.TensorProto.verify(pt.values);if(wt)return"values."+wt}if(pt.indices!=null&&pt.hasOwnProperty("indices")){var wt=vt.onnx.TensorProto.verify(pt.indices);if(wt)return"indices."+wt}if(pt.dims!=null&&pt.hasOwnProperty("dims")){if(!Array.isArray(pt.dims))return"dims: array expected";for(var $t=0;$t<pt.dims.length;++$t)if(!at.isInteger(pt.dims[$t])&&!(pt.dims[$t]&&at.isInteger(pt.dims[$t].low)&&at.isInteger(pt.dims[$t].high)))return"dims: integer|Long[] expected"}return null},Ct.fromObject=function(pt){if(pt instanceof vt.onnx.SparseTensorProto)return pt;var wt=new vt.onnx.SparseTensorProto;if(pt.values!=null){if(typeof pt.values!="object")throw TypeError(".onnx.SparseTensorProto.values: object expected");wt.values=vt.onnx.TensorProto.fromObject(pt.values)}if(pt.indices!=null){if(typeof pt.indices!="object")throw TypeError(".onnx.SparseTensorProto.indices: object expected");wt.indices=vt.onnx.TensorProto.fromObject(pt.indices)}if(pt.dims){if(!Array.isArray(pt.dims))throw TypeError(".onnx.SparseTensorProto.dims: array expected");wt.dims=[];for(var $t=0;$t<pt.dims.length;++$t)at.Long?(wt.dims[$t]=at.Long.fromValue(pt.dims[$t])).unsigned=!1:typeof pt.dims[$t]=="string"?wt.dims[$t]=parseInt(pt.dims[$t],10):typeof pt.dims[$t]=="number"?wt.dims[$t]=pt.dims[$t]:typeof pt.dims[$t]=="object"&&(wt.dims[$t]=new at.LongBits(pt.dims[$t].low>>>0,pt.dims[$t].high>>>0).toNumber())}return wt},Ct.toObject=function(pt,wt){wt||(wt={});var $t={};if((wt.arrays||wt.defaults)&&($t.dims=[]),wt.defaults&&($t.values=null,$t.indices=null),pt.values!=null&&pt.hasOwnProperty("values")&&($t.values=vt.onnx.TensorProto.toObject(pt.values,wt)),pt.indices!=null&&pt.hasOwnProperty("indices")&&($t.indices=vt.onnx.TensorProto.toObject(pt.indices,wt)),pt.dims&&pt.dims.length){$t.dims=[];for(var Lt=0;Lt<pt.dims.length;++Lt)typeof pt.dims[Lt]=="number"?$t.dims[Lt]=wt.longs===String?String(pt.dims[Lt]):pt.dims[Lt]:$t.dims[Lt]=wt.longs===String?at.Long.prototype.toString.call(pt.dims[Lt]):wt.longs===Number?new at.LongBits(pt.dims[Lt].low>>>0,pt.dims[Lt].high>>>0).toNumber():pt.dims[Lt]}return $t},Ct.prototype.toJSON=function(){return this.constructor.toObject(this,b.util.toJSONOptions)},Ct.getTypeUrl=function(pt){return pt===void 0&&(pt="type.googleapis.com"),pt+"/onnx.SparseTensorProto"},Ct}(),Tt.TensorShapeProto=function(){function Ct(pt){if(this.dim=[],pt)for(var wt=Object.keys(pt),$t=0;$t<wt.length;++$t)pt[wt[$t]]!=null&&(this[wt[$t]]=pt[wt[$t]])}return Ct.prototype.dim=at.emptyArray,Ct.create=function(pt){return new Ct(pt)},Ct.encode=function(pt,wt){if(wt||(wt=st.create()),pt.dim!=null&&pt.dim.length)for(var $t=0;$t<pt.dim.length;++$t)vt.onnx.TensorShapeProto.Dimension.encode(pt.dim[$t],wt.uint32(10).fork()).ldelim();return wt},Ct.encodeDelimited=function(pt,wt){return this.encode(pt,wt).ldelim()},Ct.decode=function(pt,wt){pt instanceof et||(pt=et.create(pt));for(var $t=wt===void 0?pt.len:pt.pos+wt,Lt=new vt.onnx.TensorShapeProto;pt.pos<$t;){var jt=pt.uint32();switch(jt>>>3){case 1:{Lt.dim&&Lt.dim.length||(Lt.dim=[]),Lt.dim.push(vt.onnx.TensorShapeProto.Dimension.decode(pt,pt.uint32()));break}default:pt.skipType(jt&7);break}}return Lt},Ct.decodeDelimited=function(pt){return pt instanceof et||(pt=new et(pt)),this.decode(pt,pt.uint32())},Ct.verify=function(pt){if(typeof pt!="object"||pt===null)return"object expected";if(pt.dim!=null&&pt.hasOwnProperty("dim")){if(!Array.isArray(pt.dim))return"dim: array expected";for(var wt=0;wt<pt.dim.length;++wt){var $t=vt.onnx.TensorShapeProto.Dimension.verify(pt.dim[wt]);if($t)return"dim."+$t}}return null},Ct.fromObject=function(pt){if(pt instanceof vt.onnx.TensorShapeProto)return pt;var wt=new vt.onnx.TensorShapeProto;if(pt.dim){if(!Array.isArray(pt.dim))throw TypeError(".onnx.TensorShapeProto.dim: array expected");wt.dim=[];for(var $t=0;$t<pt.dim.length;++$t){if(typeof pt.dim[$t]!="object")throw TypeError(".onnx.TensorShapeProto.dim: object expected");wt.dim[$t]=vt.onnx.TensorShapeProto.Dimension.fromObject(pt.dim[$t])}}return wt},Ct.toObject=function(pt,wt){wt||(wt={});var $t={};if((wt.arrays||wt.defaults)&&($t.dim=[]),pt.dim&&pt.dim.length){$t.dim=[];for(var Lt=0;Lt<pt.dim.length;++Lt)$t.dim[Lt]=vt.onnx.TensorShapeProto.Dimension.toObject(pt.dim[Lt],wt)}return $t},Ct.prototype.toJSON=function(){return this.constructor.toObject(this,b.util.toJSONOptions)},Ct.getTypeUrl=function(pt){return pt===void 0&&(pt="type.googleapis.com"),pt+"/onnx.TensorShapeProto"},Ct.Dimension=function(){function pt($t){if($t)for(var Lt=Object.keys($t),jt=0;jt<Lt.length;++jt)$t[Lt[jt]]!=null&&(this[Lt[jt]]=$t[Lt[jt]])}pt.prototype.dimValue=null,pt.prototype.dimParam=null,pt.prototype.denotation="";var wt;return Object.defineProperty(pt.prototype,"value",{get:at.oneOfGetter(wt=["dimValue","dimParam"]),set:at.oneOfSetter(wt)}),pt.create=function($t){return new pt($t)},pt.encode=function($t,Lt){return Lt||(Lt=st.create()),$t.dimValue!=null&&Object.hasOwnProperty.call($t,"dimValue")&&Lt.uint32(8).int64($t.dimValue),$t.dimParam!=null&&Object.hasOwnProperty.call($t,"dimParam")&&Lt.uint32(18).string($t.dimParam),$t.denotation!=null&&Object.hasOwnProperty.call($t,"denotation")&&Lt.uint32(26).string($t.denotation),Lt},pt.encodeDelimited=function($t,Lt){return this.encode($t,Lt).ldelim()},pt.decode=function($t,Lt){$t instanceof et||($t=et.create($t));for(var jt=Lt===void 0?$t.len:$t.pos+Lt,Ft=new vt.onnx.TensorShapeProto.Dimension;$t.pos<jt;){var Gt=$t.uint32();switch(Gt>>>3){case 1:{Ft.dimValue=$t.int64();break}case 2:{Ft.dimParam=$t.string();break}case 3:{Ft.denotation=$t.string();break}default:$t.skipType(Gt&7);break}}return Ft},pt.decodeDelimited=function($t){return $t instanceof et||($t=new et($t)),this.decode($t,$t.uint32())},pt.verify=function($t){if(typeof $t!="object"||$t===null)return"object expected";var Lt={};if($t.dimValue!=null&&$t.hasOwnProperty("dimValue")&&(Lt.value=1,!at.isInteger($t.dimValue)&&!($t.dimValue&&at.isInteger($t.dimValue.low)&&at.isInteger($t.dimValue.high))))return"dimValue: integer|Long expected";if($t.dimParam!=null&&$t.hasOwnProperty("dimParam")){if(Lt.value===1)return"value: multiple values";if(Lt.value=1,!at.isString($t.dimParam))return"dimParam: string expected"}return $t.denotation!=null&&$t.hasOwnProperty("denotation")&&!at.isString($t.denotation)?"denotation: string expected":null},pt.fromObject=function($t){if($t instanceof vt.onnx.TensorShapeProto.Dimension)return $t;var Lt=new vt.onnx.TensorShapeProto.Dimension;return $t.dimValue!=null&&(at.Long?(Lt.dimValue=at.Long.fromValue($t.dimValue)).unsigned=!1:typeof $t.dimValue=="string"?Lt.dimValue=parseInt($t.dimValue,10):typeof $t.dimValue=="number"?Lt.dimValue=$t.dimValue:typeof $t.dimValue=="object"&&(Lt.dimValue=new at.LongBits($t.dimValue.low>>>0,$t.dimValue.high>>>0).toNumber())),$t.dimParam!=null&&(Lt.dimParam=String($t.dimParam)),$t.denotation!=null&&(Lt.denotation=String($t.denotation)),Lt},pt.toObject=function($t,Lt){Lt||(Lt={});var jt={};return Lt.defaults&&(jt.denotation=""),$t.dimValue!=null&&$t.hasOwnProperty("dimValue")&&(typeof $t.dimValue=="number"?jt.dimValue=Lt.longs===String?String($t.dimValue):$t.dimValue:jt.dimValue=Lt.longs===String?at.Long.prototype.toString.call($t.dimValue):Lt.longs===Number?new at.LongBits($t.dimValue.low>>>0,$t.dimValue.high>>>0).toNumber():$t.dimValue,Lt.oneofs&&(jt.value="dimValue")),$t.dimParam!=null&&$t.hasOwnProperty("dimParam")&&(jt.dimParam=$t.dimParam,Lt.oneofs&&(jt.value="dimParam")),$t.denotation!=null&&$t.hasOwnProperty("denotation")&&(jt.denotation=$t.denotation),jt},pt.prototype.toJSON=function(){return this.constructor.toObject(this,b.util.toJSONOptions)},pt.getTypeUrl=function($t){return $t===void 0&&($t="type.googleapis.com"),$t+"/onnx.TensorShapeProto.Dimension"},pt}(),Ct}(),Tt.TypeProto=function(){function Ct(wt){if(wt)for(var $t=Object.keys(wt),Lt=0;Lt<$t.length;++Lt)wt[$t[Lt]]!=null&&(this[$t[Lt]]=wt[$t[Lt]])}Ct.prototype.tensorType=null,Ct.prototype.sequenceType=null,Ct.prototype.mapType=null,Ct.prototype.optionalType=null,Ct.prototype.sparseTensorType=null,Ct.prototype.denotation="";var pt;return Object.defineProperty(Ct.prototype,"value",{get:at.oneOfGetter(pt=["tensorType","sequenceType","mapType","optionalType","sparseTensorType"]),set:at.oneOfSetter(pt)}),Ct.create=function(wt){return new Ct(wt)},Ct.encode=function(wt,$t){return $t||($t=st.create()),wt.tensorType!=null&&Object.hasOwnProperty.call(wt,"tensorType")&&vt.onnx.TypeProto.Tensor.encode(wt.tensorType,$t.uint32(10).fork()).ldelim(),wt.sequenceType!=null&&Object.hasOwnProperty.call(wt,"sequenceType")&&vt.onnx.TypeProto.Sequence.encode(wt.sequenceType,$t.uint32(34).fork()).ldelim(),wt.mapType!=null&&Object.hasOwnProperty.call(wt,"mapType")&&vt.onnx.TypeProto.Map.encode(wt.mapType,$t.uint32(42).fork()).ldelim(),wt.denotation!=null&&Object.hasOwnProperty.call(wt,"denotation")&&$t.uint32(50).string(wt.denotation),wt.sparseTensorType!=null&&Object.hasOwnProperty.call(wt,"sparseTensorType")&&vt.onnx.TypeProto.SparseTensor.encode(wt.sparseTensorType,$t.uint32(66).fork()).ldelim(),wt.optionalType!=null&&Object.hasOwnProperty.call(wt,"optionalType")&&vt.onnx.TypeProto.Optional.encode(wt.optionalType,$t.uint32(74).fork()).ldelim(),$t},Ct.encodeDelimited=function(wt,$t){return this.encode(wt,$t).ldelim()},Ct.decode=function(wt,$t){wt instanceof et||(wt=et.create(wt));for(var Lt=$t===void 0?wt.len:wt.pos+$t,jt=new vt.onnx.TypeProto;wt.pos<Lt;){var Ft=wt.uint32();switch(Ft>>>3){case 1:{jt.tensorType=vt.onnx.TypeProto.Tensor.decode(wt,wt.uint32());break}case 4:{jt.sequenceType=vt.onnx.TypeProto.Sequence.decode(wt,wt.uint32());break}case 5:{jt.mapType=vt.onnx.TypeProto.Map.decode(wt,wt.uint32());break}case 9:{jt.optionalType=vt.onnx.TypeProto.Optional.decode(wt,wt.uint32());break}case 8:{jt.sparseTensorType=vt.onnx.TypeProto.SparseTensor.decode(wt,wt.uint32());break}case 6:{jt.denotation=wt.string();break}default:wt.skipType(Ft&7);break}}return jt},Ct.decodeDelimited=function(wt){return wt instanceof et||(wt=new et(wt)),this.decode(wt,wt.uint32())},Ct.verify=function(wt){if(typeof wt!="object"||wt===null)return"object expected";var $t={};if(wt.tensorType!=null&&wt.hasOwnProperty("tensorType")){$t.value=1;{var Lt=vt.onnx.TypeProto.Tensor.verify(wt.tensorType);if(Lt)return"tensorType."+Lt}}if(wt.sequenceType!=null&&wt.hasOwnProperty("sequenceType")){if($t.value===1)return"value: multiple values";$t.value=1;{var Lt=vt.onnx.TypeProto.Sequence.verify(wt.sequenceType);if(Lt)return"sequenceType."+Lt}}if(wt.mapType!=null&&wt.hasOwnProperty("mapType")){if($t.value===1)return"value: multiple values";$t.value=1;{var Lt=vt.onnx.TypeProto.Map.verify(wt.mapType);if(Lt)return"mapType."+Lt}}if(wt.optionalType!=null&&wt.hasOwnProperty("optionalType")){if($t.value===1)return"value: multiple values";$t.value=1;{var Lt=vt.onnx.TypeProto.Optional.verify(wt.optionalType);if(Lt)return"optionalType."+Lt}}if(wt.sparseTensorType!=null&&wt.hasOwnProperty("sparseTensorType")){if($t.value===1)return"value: multiple values";$t.value=1;{var Lt=vt.onnx.TypeProto.SparseTensor.verify(wt.sparseTensorType);if(Lt)return"sparseTensorType."+Lt}}return wt.denotation!=null&&wt.hasOwnProperty("denotation")&&!at.isString(wt.denotation)?"denotation: string expected":null},Ct.fromObject=function(wt){if(wt instanceof vt.onnx.TypeProto)return wt;var $t=new vt.onnx.TypeProto;if(wt.tensorType!=null){if(typeof wt.tensorType!="object")throw TypeError(".onnx.TypeProto.tensorType: object expected");$t.tensorType=vt.onnx.TypeProto.Tensor.fromObject(wt.tensorType)}if(wt.sequenceType!=null){if(typeof wt.sequenceType!="object")throw TypeError(".onnx.TypeProto.sequenceType: object expected");$t.sequenceType=vt.onnx.TypeProto.Sequence.fromObject(wt.sequenceType)}if(wt.mapType!=null){if(typeof wt.mapType!="object")throw TypeError(".onnx.TypeProto.mapType: object expected");$t.mapType=vt.onnx.TypeProto.Map.fromObject(wt.mapType)}if(wt.optionalType!=null){if(typeof wt.optionalType!="object")throw TypeError(".onnx.TypeProto.optionalType: object expected");$t.optionalType=vt.onnx.TypeProto.Optional.fromObject(wt.optionalType)}if(wt.sparseTensorType!=null){if(typeof wt.sparseTensorType!="object")throw TypeError(".onnx.TypeProto.sparseTensorType: object expected");$t.sparseTensorType=vt.onnx.TypeProto.SparseTensor.fromObject(wt.sparseTensorType)}return wt.denotation!=null&&($t.denotation=String(wt.denotation)),$t},Ct.toObject=function(wt,$t){$t||($t={});var Lt={};return $t.defaults&&(Lt.denotation=""),wt.tensorType!=null&&wt.hasOwnProperty("tensorType")&&(Lt.tensorType=vt.onnx.TypeProto.Tensor.toObject(wt.tensorType,$t),$t.oneofs&&(Lt.value="tensorType")),wt.sequenceType!=null&&wt.hasOwnProperty("sequenceType")&&(Lt.sequenceType=vt.onnx.TypeProto.Sequence.toObject(wt.sequenceType,$t),$t.oneofs&&(Lt.value="sequenceType")),wt.mapType!=null&&wt.hasOwnProperty("mapType")&&(Lt.mapType=vt.onnx.TypeProto.Map.toObject(wt.mapType,$t),$t.oneofs&&(Lt.value="mapType")),wt.denotation!=null&&wt.hasOwnProperty("denotation")&&(Lt.denotation=wt.denotation),wt.sparseTensorType!=null&&wt.hasOwnProperty("sparseTensorType")&&(Lt.sparseTensorType=vt.onnx.TypeProto.SparseTensor.toObject(wt.sparseTensorType,$t),$t.oneofs&&(Lt.value="sparseTensorType")),wt.optionalType!=null&&wt.hasOwnProperty("optionalType")&&(Lt.optionalType=vt.onnx.TypeProto.Optional.toObject(wt.optionalType,$t),$t.oneofs&&(Lt.value="optionalType")),Lt},Ct.prototype.toJSON=function(){return this.constructor.toObject(this,b.util.toJSONOptions)},Ct.getTypeUrl=function(wt){return wt===void 0&&(wt="type.googleapis.com"),wt+"/onnx.TypeProto"},Ct.Tensor=function(){function wt($t){if($t)for(var Lt=Object.keys($t),jt=0;jt<Lt.length;++jt)$t[Lt[jt]]!=null&&(this[Lt[jt]]=$t[Lt[jt]])}return wt.prototype.elemType=0,wt.prototype.shape=null,wt.create=function($t){return new wt($t)},wt.encode=function($t,Lt){return Lt||(Lt=st.create()),$t.elemType!=null&&Object.hasOwnProperty.call($t,"elemType")&&Lt.uint32(8).int32($t.elemType),$t.shape!=null&&Object.hasOwnProperty.call($t,"shape")&&vt.onnx.TensorShapeProto.encode($t.shape,Lt.uint32(18).fork()).ldelim(),Lt},wt.encodeDelimited=function($t,Lt){return this.encode($t,Lt).ldelim()},wt.decode=function($t,Lt){$t instanceof et||($t=et.create($t));for(var jt=Lt===void 0?$t.len:$t.pos+Lt,Ft=new vt.onnx.TypeProto.Tensor;$t.pos<jt;){var Gt=$t.uint32();switch(Gt>>>3){case 1:{Ft.elemType=$t.int32();break}case 2:{Ft.shape=vt.onnx.TensorShapeProto.decode($t,$t.uint32());break}default:$t.skipType(Gt&7);break}}return Ft},wt.decodeDelimited=function($t){return $t instanceof et||($t=new et($t)),this.decode($t,$t.uint32())},wt.verify=function($t){if(typeof $t!="object"||$t===null)return"object expected";if($t.elemType!=null&&$t.hasOwnProperty("elemType")&&!at.isInteger($t.elemType))return"elemType: integer expected";if($t.shape!=null&&$t.hasOwnProperty("shape")){var Lt=vt.onnx.TensorShapeProto.verify($t.shape);if(Lt)return"shape."+Lt}return null},wt.fromObject=function($t){if($t instanceof vt.onnx.TypeProto.Tensor)return $t;var Lt=new vt.onnx.TypeProto.Tensor;if($t.elemType!=null&&(Lt.elemType=$t.elemType|0),$t.shape!=null){if(typeof $t.shape!="object")throw TypeError(".onnx.TypeProto.Tensor.shape: object expected");Lt.shape=vt.onnx.TensorShapeProto.fromObject($t.shape)}return Lt},wt.toObject=function($t,Lt){Lt||(Lt={});var jt={};return Lt.defaults&&(jt.elemType=0,jt.shape=null),$t.elemType!=null&&$t.hasOwnProperty("elemType")&&(jt.elemType=$t.elemType),$t.shape!=null&&$t.hasOwnProperty("shape")&&(jt.shape=vt.onnx.TensorShapeProto.toObject($t.shape,Lt)),jt},wt.prototype.toJSON=function(){return this.constructor.toObject(this,b.util.toJSONOptions)},wt.getTypeUrl=function($t){return $t===void 0&&($t="type.googleapis.com"),$t+"/onnx.TypeProto.Tensor"},wt}(),Ct.Sequence=function(){function wt($t){if($t)for(var Lt=Object.keys($t),jt=0;jt<Lt.length;++jt)$t[Lt[jt]]!=null&&(this[Lt[jt]]=$t[Lt[jt]])}return wt.prototype.elemType=null,wt.create=function($t){return new wt($t)},wt.encode=function($t,Lt){return Lt||(Lt=st.create()),$t.elemType!=null&&Object.hasOwnProperty.call($t,"elemType")&&vt.onnx.TypeProto.encode($t.elemType,Lt.uint32(10).fork()).ldelim(),Lt},wt.encodeDelimited=function($t,Lt){return this.encode($t,Lt).ldelim()},wt.decode=function($t,Lt){$t instanceof et||($t=et.create($t));for(var jt=Lt===void 0?$t.len:$t.pos+Lt,Ft=new vt.onnx.TypeProto.Sequence;$t.pos<jt;){var Gt=$t.uint32();switch(Gt>>>3){case 1:{Ft.elemType=vt.onnx.TypeProto.decode($t,$t.uint32());break}default:$t.skipType(Gt&7);break}}return Ft},wt.decodeDelimited=function($t){return $t instanceof et||($t=new et($t)),this.decode($t,$t.uint32())},wt.verify=function($t){if(typeof $t!="object"||$t===null)return"object expected";if($t.elemType!=null&&$t.hasOwnProperty("elemType")){var Lt=vt.onnx.TypeProto.verify($t.elemType);if(Lt)return"elemType."+Lt}return null},wt.fromObject=function($t){if($t instanceof vt.onnx.TypeProto.Sequence)return $t;var Lt=new vt.onnx.TypeProto.Sequence;if($t.elemType!=null){if(typeof $t.elemType!="object")throw TypeError(".onnx.TypeProto.Sequence.elemType: object expected");Lt.elemType=vt.onnx.TypeProto.fromObject($t.elemType)}return Lt},wt.toObject=function($t,Lt){Lt||(Lt={});var jt={};return Lt.defaults&&(jt.elemType=null),$t.elemType!=null&&$t.hasOwnProperty("elemType")&&(jt.elemType=vt.onnx.TypeProto.toObject($t.elemType,Lt)),jt},wt.prototype.toJSON=function(){return this.constructor.toObject(this,b.util.toJSONOptions)},wt.getTypeUrl=function($t){return $t===void 0&&($t="type.googleapis.com"),$t+"/onnx.TypeProto.Sequence"},wt}(),Ct.Map=function(){function wt($t){if($t)for(var Lt=Object.keys($t),jt=0;jt<Lt.length;++jt)$t[Lt[jt]]!=null&&(this[Lt[jt]]=$t[Lt[jt]])}return wt.prototype.keyType=0,wt.prototype.valueType=null,wt.create=function($t){return new wt($t)},wt.encode=function($t,Lt){return Lt||(Lt=st.create()),$t.keyType!=null&&Object.hasOwnProperty.call($t,"keyType")&&Lt.uint32(8).int32($t.keyType),$t.valueType!=null&&Object.hasOwnProperty.call($t,"valueType")&&vt.onnx.TypeProto.encode($t.valueType,Lt.uint32(18).fork()).ldelim(),Lt},wt.encodeDelimited=function($t,Lt){return this.encode($t,Lt).ldelim()},wt.decode=function($t,Lt){$t instanceof et||($t=et.create($t));for(var jt=Lt===void 0?$t.len:$t.pos+Lt,Ft=new vt.onnx.TypeProto.Map;$t.pos<jt;){var Gt=$t.uint32();switch(Gt>>>3){case 1:{Ft.keyType=$t.int32();break}case 2:{Ft.valueType=vt.onnx.TypeProto.decode($t,$t.uint32());break}default:$t.skipType(Gt&7);break}}return Ft},wt.decodeDelimited=function($t){return $t instanceof et||($t=new et($t)),this.decode($t,$t.uint32())},wt.verify=function($t){if(typeof $t!="object"||$t===null)return"object expected";if($t.keyType!=null&&$t.hasOwnProperty("keyType")&&!at.isInteger($t.keyType))return"keyType: integer expected";if($t.valueType!=null&&$t.hasOwnProperty("valueType")){var Lt=vt.onnx.TypeProto.verify($t.valueType);if(Lt)return"valueType."+Lt}return null},wt.fromObject=function($t){if($t instanceof vt.onnx.TypeProto.Map)return $t;var Lt=new vt.onnx.TypeProto.Map;if($t.keyType!=null&&(Lt.keyType=$t.keyType|0),$t.valueType!=null){if(typeof $t.valueType!="object")throw TypeError(".onnx.TypeProto.Map.valueType: object expected");Lt.valueType=vt.onnx.TypeProto.fromObject($t.valueType)}return Lt},wt.toObject=function($t,Lt){Lt||(Lt={});var jt={};return Lt.defaults&&(jt.keyType=0,jt.valueType=null),$t.keyType!=null&&$t.hasOwnProperty("keyType")&&(jt.keyType=$t.keyType),$t.valueType!=null&&$t.hasOwnProperty("valueType")&&(jt.valueType=vt.onnx.TypeProto.toObject($t.valueType,Lt)),jt},wt.prototype.toJSON=function(){return this.constructor.toObject(this,b.util.toJSONOptions)},wt.getTypeUrl=function($t){return $t===void 0&&($t="type.googleapis.com"),$t+"/onnx.TypeProto.Map"},wt}(),Ct.Optional=function(){function wt($t){if($t)for(var Lt=Object.keys($t),jt=0;jt<Lt.length;++jt)$t[Lt[jt]]!=null&&(this[Lt[jt]]=$t[Lt[jt]])}return wt.prototype.elemType=null,wt.create=function($t){return new wt($t)},wt.encode=function($t,Lt){return Lt||(Lt=st.create()),$t.elemType!=null&&Object.hasOwnProperty.call($t,"elemType")&&vt.onnx.TypeProto.encode($t.elemType,Lt.uint32(10).fork()).ldelim(),Lt},wt.encodeDelimited=function($t,Lt){return this.encode($t,Lt).ldelim()},wt.decode=function($t,Lt){$t instanceof et||($t=et.create($t));for(var jt=Lt===void 0?$t.len:$t.pos+Lt,Ft=new vt.onnx.TypeProto.Optional;$t.pos<jt;){var Gt=$t.uint32();switch(Gt>>>3){case 1:{Ft.elemType=vt.onnx.TypeProto.decode($t,$t.uint32());break}default:$t.skipType(Gt&7);break}}return Ft},wt.decodeDelimited=function($t){return $t instanceof et||($t=new et($t)),this.decode($t,$t.uint32())},wt.verify=function($t){if(typeof $t!="object"||$t===null)return"object expected";if($t.elemType!=null&&$t.hasOwnProperty("elemType")){var Lt=vt.onnx.TypeProto.verify($t.elemType);if(Lt)return"elemType."+Lt}return null},wt.fromObject=function($t){if($t instanceof vt.onnx.TypeProto.Optional)return $t;var Lt=new vt.onnx.TypeProto.Optional;if($t.elemType!=null){if(typeof $t.elemType!="object")throw TypeError(".onnx.TypeProto.Optional.elemType: object expected");Lt.elemType=vt.onnx.TypeProto.fromObject($t.elemType)}return Lt},wt.toObject=function($t,Lt){Lt||(Lt={});var jt={};return Lt.defaults&&(jt.elemType=null),$t.elemType!=null&&$t.hasOwnProperty("elemType")&&(jt.elemType=vt.onnx.TypeProto.toObject($t.elemType,Lt)),jt},wt.prototype.toJSON=function(){return this.constructor.toObject(this,b.util.toJSONOptions)},wt.getTypeUrl=function($t){return $t===void 0&&($t="type.googleapis.com"),$t+"/onnx.TypeProto.Optional"},wt}(),Ct.SparseTensor=function(){function wt($t){if($t)for(var Lt=Object.keys($t),jt=0;jt<Lt.length;++jt)$t[Lt[jt]]!=null&&(this[Lt[jt]]=$t[Lt[jt]])}return wt.prototype.elemType=0,wt.prototype.shape=null,wt.create=function($t){return new wt($t)},wt.encode=function($t,Lt){return Lt||(Lt=st.create()),$t.elemType!=null&&Object.hasOwnProperty.call($t,"elemType")&&Lt.uint32(8).int32($t.elemType),$t.shape!=null&&Object.hasOwnProperty.call($t,"shape")&&vt.onnx.TensorShapeProto.encode($t.shape,Lt.uint32(18).fork()).ldelim(),Lt},wt.encodeDelimited=function($t,Lt){return this.encode($t,Lt).ldelim()},wt.decode=function($t,Lt){$t instanceof et||($t=et.create($t));for(var jt=Lt===void 0?$t.len:$t.pos+Lt,Ft=new vt.onnx.TypeProto.SparseTensor;$t.pos<jt;){var Gt=$t.uint32();switch(Gt>>>3){case 1:{Ft.elemType=$t.int32();break}case 2:{Ft.shape=vt.onnx.TensorShapeProto.decode($t,$t.uint32());break}default:$t.skipType(Gt&7);break}}return Ft},wt.decodeDelimited=function($t){return $t instanceof et||($t=new et($t)),this.decode($t,$t.uint32())},wt.verify=function($t){if(typeof $t!="object"||$t===null)return"object expected";if($t.elemType!=null&&$t.hasOwnProperty("elemType")&&!at.isInteger($t.elemType))return"elemType: integer expected";if($t.shape!=null&&$t.hasOwnProperty("shape")){var Lt=vt.onnx.TensorShapeProto.verify($t.shape);if(Lt)return"shape."+Lt}return null},wt.fromObject=function($t){if($t instanceof vt.onnx.TypeProto.SparseTensor)return $t;var Lt=new vt.onnx.TypeProto.SparseTensor;if($t.elemType!=null&&(Lt.elemType=$t.elemType|0),$t.shape!=null){if(typeof $t.shape!="object")throw TypeError(".onnx.TypeProto.SparseTensor.shape: object expected");Lt.shape=vt.onnx.TensorShapeProto.fromObject($t.shape)}return Lt},wt.toObject=function($t,Lt){Lt||(Lt={});var jt={};return Lt.defaults&&(jt.elemType=0,jt.shape=null),$t.elemType!=null&&$t.hasOwnProperty("elemType")&&(jt.elemType=$t.elemType),$t.shape!=null&&$t.hasOwnProperty("shape")&&(jt.shape=vt.onnx.TensorShapeProto.toObject($t.shape,Lt)),jt},wt.prototype.toJSON=function(){return this.constructor.toObject(this,b.util.toJSONOptions)},wt.getTypeUrl=function($t){return $t===void 0&&($t="type.googleapis.com"),$t+"/onnx.TypeProto.SparseTensor"},wt}(),Ct}(),Tt.OperatorSetIdProto=function(){function Ct(pt){if(pt)for(var wt=Object.keys(pt),$t=0;$t<wt.length;++$t)pt[wt[$t]]!=null&&(this[wt[$t]]=pt[wt[$t]])}return Ct.prototype.domain="",Ct.prototype.version=at.Long?at.Long.fromBits(0,0,!1):0,Ct.create=function(pt){return new Ct(pt)},Ct.encode=function(pt,wt){return wt||(wt=st.create()),pt.domain!=null&&Object.hasOwnProperty.call(pt,"domain")&&wt.uint32(10).string(pt.domain),pt.version!=null&&Object.hasOwnProperty.call(pt,"version")&&wt.uint32(16).int64(pt.version),wt},Ct.encodeDelimited=function(pt,wt){return this.encode(pt,wt).ldelim()},Ct.decode=function(pt,wt){pt instanceof et||(pt=et.create(pt));for(var $t=wt===void 0?pt.len:pt.pos+wt,Lt=new vt.onnx.OperatorSetIdProto;pt.pos<$t;){var jt=pt.uint32();switch(jt>>>3){case 1:{Lt.domain=pt.string();break}case 2:{Lt.version=pt.int64();break}default:pt.skipType(jt&7);break}}return Lt},Ct.decodeDelimited=function(pt){return pt instanceof et||(pt=new et(pt)),this.decode(pt,pt.uint32())},Ct.verify=function(pt){return typeof pt!="object"||pt===null?"object expected":pt.domain!=null&&pt.hasOwnProperty("domain")&&!at.isString(pt.domain)?"domain: string expected":pt.version!=null&&pt.hasOwnProperty("version")&&!at.isInteger(pt.version)&&!(pt.version&&at.isInteger(pt.version.low)&&at.isInteger(pt.version.high))?"version: integer|Long expected":null},Ct.fromObject=function(pt){if(pt instanceof vt.onnx.OperatorSetIdProto)return pt;var wt=new vt.onnx.OperatorSetIdProto;return pt.domain!=null&&(wt.domain=String(pt.domain)),pt.version!=null&&(at.Long?(wt.version=at.Long.fromValue(pt.version)).unsigned=!1:typeof pt.version=="string"?wt.version=parseInt(pt.version,10):typeof pt.version=="number"?wt.version=pt.version:typeof pt.version=="object"&&(wt.version=new at.LongBits(pt.version.low>>>0,pt.version.high>>>0).toNumber())),wt},Ct.toObject=function(pt,wt){wt||(wt={});var $t={};if(wt.defaults)if($t.domain="",at.Long){var Lt=new at.Long(0,0,!1);$t.version=wt.longs===String?Lt.toString():wt.longs===Number?Lt.toNumber():Lt}else $t.version=wt.longs===String?"0":0;return pt.domain!=null&&pt.hasOwnProperty("domain")&&($t.domain=pt.domain),pt.version!=null&&pt.hasOwnProperty("version")&&(typeof pt.version=="number"?$t.version=wt.longs===String?String(pt.version):pt.version:$t.version=wt.longs===String?at.Long.prototype.toString.call(pt.version):wt.longs===Number?new at.LongBits(pt.version.low>>>0,pt.version.high>>>0).toNumber():pt.version),$t},Ct.prototype.toJSON=function(){return this.constructor.toObject(this,b.util.toJSONOptions)},Ct.getTypeUrl=function(pt){return pt===void 0&&(pt="type.googleapis.com"),pt+"/onnx.OperatorSetIdProto"},Ct}(),Tt.OperatorStatus=function(){var Ct={},pt=Object.create(Ct);return pt[Ct[0]="EXPERIMENTAL"]=0,pt[Ct[1]="STABLE"]=1,pt}(),Tt.FunctionProto=function(){function Ct(pt){if(this.input=[],this.output=[],this.attribute=[],this.attributeProto=[],this.node=[],this.opsetImport=[],pt)for(var wt=Object.keys(pt),$t=0;$t<wt.length;++$t)pt[wt[$t]]!=null&&(this[wt[$t]]=pt[wt[$t]])}return Ct.prototype.name="",Ct.prototype.input=at.emptyArray,Ct.prototype.output=at.emptyArray,Ct.prototype.attribute=at.emptyArray,Ct.prototype.attributeProto=at.emptyArray,Ct.prototype.node=at.emptyArray,Ct.prototype.docString="",Ct.prototype.opsetImport=at.emptyArray,Ct.prototype.domain="",Ct.create=function(pt){return new Ct(pt)},Ct.encode=function(pt,wt){if(wt||(wt=st.create()),pt.name!=null&&Object.hasOwnProperty.call(pt,"name")&&wt.uint32(10).string(pt.name),pt.input!=null&&pt.input.length)for(var $t=0;$t<pt.input.length;++$t)wt.uint32(34).string(pt.input[$t]);if(pt.output!=null&&pt.output.length)for(var $t=0;$t<pt.output.length;++$t)wt.uint32(42).string(pt.output[$t]);if(pt.attribute!=null&&pt.attribute.length)for(var $t=0;$t<pt.attribute.length;++$t)wt.uint32(50).string(pt.attribute[$t]);if(pt.node!=null&&pt.node.length)for(var $t=0;$t<pt.node.length;++$t)vt.onnx.NodeProto.encode(pt.node[$t],wt.uint32(58).fork()).ldelim();if(pt.docString!=null&&Object.hasOwnProperty.call(pt,"docString")&&wt.uint32(66).string(pt.docString),pt.opsetImport!=null&&pt.opsetImport.length)for(var $t=0;$t<pt.opsetImport.length;++$t)vt.onnx.OperatorSetIdProto.encode(pt.opsetImport[$t],wt.uint32(74).fork()).ldelim();if(pt.domain!=null&&Object.hasOwnProperty.call(pt,"domain")&&wt.uint32(82).string(pt.domain),pt.attributeProto!=null&&pt.attributeProto.length)for(var $t=0;$t<pt.attributeProto.length;++$t)vt.onnx.AttributeProto.encode(pt.attributeProto[$t],wt.uint32(90).fork()).ldelim();return wt},Ct.encodeDelimited=function(pt,wt){return this.encode(pt,wt).ldelim()},Ct.decode=function(pt,wt){pt instanceof et||(pt=et.create(pt));for(var $t=wt===void 0?pt.len:pt.pos+wt,Lt=new vt.onnx.FunctionProto;pt.pos<$t;){var jt=pt.uint32();switch(jt>>>3){case 1:{Lt.name=pt.string();break}case 4:{Lt.input&&Lt.input.length||(Lt.input=[]),Lt.input.push(pt.string());break}case 5:{Lt.output&&Lt.output.length||(Lt.output=[]),Lt.output.push(pt.string());break}case 6:{Lt.attribute&&Lt.attribute.length||(Lt.attribute=[]),Lt.attribute.push(pt.string());break}case 11:{Lt.attributeProto&&Lt.attributeProto.length||(Lt.attributeProto=[]),Lt.attributeProto.push(vt.onnx.AttributeProto.decode(pt,pt.uint32()));break}case 7:{Lt.node&&Lt.node.length||(Lt.node=[]),Lt.node.push(vt.onnx.NodeProto.decode(pt,pt.uint32()));break}case 8:{Lt.docString=pt.string();break}case 9:{Lt.opsetImport&&Lt.opsetImport.length||(Lt.opsetImport=[]),Lt.opsetImport.push(vt.onnx.OperatorSetIdProto.decode(pt,pt.uint32()));break}case 10:{Lt.domain=pt.string();break}default:pt.skipType(jt&7);break}}return Lt},Ct.decodeDelimited=function(pt){return pt instanceof et||(pt=new et(pt)),this.decode(pt,pt.uint32())},Ct.verify=function(pt){if(typeof pt!="object"||pt===null)return"object expected";if(pt.name!=null&&pt.hasOwnProperty("name")&&!at.isString(pt.name))return"name: string expected";if(pt.input!=null&&pt.hasOwnProperty("input")){if(!Array.isArray(pt.input))return"input: array expected";for(var wt=0;wt<pt.input.length;++wt)if(!at.isString(pt.input[wt]))return"input: string[] expected"}if(pt.output!=null&&pt.hasOwnProperty("output")){if(!Array.isArray(pt.output))return"output: array expected";for(var wt=0;wt<pt.output.length;++wt)if(!at.isString(pt.output[wt]))return"output: string[] expected"}if(pt.attribute!=null&&pt.hasOwnProperty("attribute")){if(!Array.isArray(pt.attribute))return"attribute: array expected";for(var wt=0;wt<pt.attribute.length;++wt)if(!at.isString(pt.attribute[wt]))return"attribute: string[] expected"}if(pt.attributeProto!=null&&pt.hasOwnProperty("attributeProto")){if(!Array.isArray(pt.attributeProto))return"attributeProto: array expected";for(var wt=0;wt<pt.attributeProto.length;++wt){var $t=vt.onnx.AttributeProto.verify(pt.attributeProto[wt]);if($t)return"attributeProto."+$t}}if(pt.node!=null&&pt.hasOwnProperty("node")){if(!Array.isArray(pt.node))return"node: array expected";for(var wt=0;wt<pt.node.length;++wt){var $t=vt.onnx.NodeProto.verify(pt.node[wt]);if($t)return"node."+$t}}if(pt.docString!=null&&pt.hasOwnProperty("docString")&&!at.isString(pt.docString))return"docString: string expected";if(pt.opsetImport!=null&&pt.hasOwnProperty("opsetImport")){if(!Array.isArray(pt.opsetImport))return"opsetImport: array expected";for(var wt=0;wt<pt.opsetImport.length;++wt){var $t=vt.onnx.OperatorSetIdProto.verify(pt.opsetImport[wt]);if($t)return"opsetImport."+$t}}return pt.domain!=null&&pt.hasOwnProperty("domain")&&!at.isString(pt.domain)?"domain: string expected":null},Ct.fromObject=function(pt){if(pt instanceof vt.onnx.FunctionProto)return pt;var wt=new vt.onnx.FunctionProto;if(pt.name!=null&&(wt.name=String(pt.name)),pt.input){if(!Array.isArray(pt.input))throw TypeError(".onnx.FunctionProto.input: array expected");wt.input=[];for(var $t=0;$t<pt.input.length;++$t)wt.input[$t]=String(pt.input[$t])}if(pt.output){if(!Array.isArray(pt.output))throw TypeError(".onnx.FunctionProto.output: array expected");wt.output=[];for(var $t=0;$t<pt.output.length;++$t)wt.output[$t]=String(pt.output[$t])}if(pt.attribute){if(!Array.isArray(pt.attribute))throw TypeError(".onnx.FunctionProto.attribute: array expected");wt.attribute=[];for(var $t=0;$t<pt.attribute.length;++$t)wt.attribute[$t]=String(pt.attribute[$t])}if(pt.attributeProto){if(!Array.isArray(pt.attributeProto))throw TypeError(".onnx.FunctionProto.attributeProto: array expected");wt.attributeProto=[];for(var $t=0;$t<pt.attributeProto.length;++$t){if(typeof pt.attributeProto[$t]!="object")throw TypeError(".onnx.FunctionProto.attributeProto: object expected");wt.attributeProto[$t]=vt.onnx.AttributeProto.fromObject(pt.attributeProto[$t])}}if(pt.node){if(!Array.isArray(pt.node))throw TypeError(".onnx.FunctionProto.node: array expected");wt.node=[];for(var $t=0;$t<pt.node.length;++$t){if(typeof pt.node[$t]!="object")throw TypeError(".onnx.FunctionProto.node: object expected");wt.node[$t]=vt.onnx.NodeProto.fromObject(pt.node[$t])}}if(pt.docString!=null&&(wt.docString=String(pt.docString)),pt.opsetImport){if(!Array.isArray(pt.opsetImport))throw TypeError(".onnx.FunctionProto.opsetImport: array expected");wt.opsetImport=[];for(var $t=0;$t<pt.opsetImport.length;++$t){if(typeof pt.opsetImport[$t]!="object")throw TypeError(".onnx.FunctionProto.opsetImport: object expected");wt.opsetImport[$t]=vt.onnx.OperatorSetIdProto.fromObject(pt.opsetImport[$t])}}return pt.domain!=null&&(wt.domain=String(pt.domain)),wt},Ct.toObject=function(pt,wt){wt||(wt={});var $t={};if((wt.arrays||wt.defaults)&&($t.input=[],$t.output=[],$t.attribute=[],$t.node=[],$t.opsetImport=[],$t.attributeProto=[]),wt.defaults&&($t.name="",$t.docString="",$t.domain=""),pt.name!=null&&pt.hasOwnProperty("name")&&($t.name=pt.name),pt.input&&pt.input.length){$t.input=[];for(var Lt=0;Lt<pt.input.length;++Lt)$t.input[Lt]=pt.input[Lt]}if(pt.output&&pt.output.length){$t.output=[];for(var Lt=0;Lt<pt.output.length;++Lt)$t.output[Lt]=pt.output[Lt]}if(pt.attribute&&pt.attribute.length){$t.attribute=[];for(var Lt=0;Lt<pt.attribute.length;++Lt)$t.attribute[Lt]=pt.attribute[Lt]}if(pt.node&&pt.node.length){$t.node=[];for(var Lt=0;Lt<pt.node.length;++Lt)$t.node[Lt]=vt.onnx.NodeProto.toObject(pt.node[Lt],wt)}if(pt.docString!=null&&pt.hasOwnProperty("docString")&&($t.docString=pt.docString),pt.opsetImport&&pt.opsetImport.length){$t.opsetImport=[];for(var Lt=0;Lt<pt.opsetImport.length;++Lt)$t.opsetImport[Lt]=vt.onnx.OperatorSetIdProto.toObject(pt.opsetImport[Lt],wt)}if(pt.domain!=null&&pt.hasOwnProperty("domain")&&($t.domain=pt.domain),pt.attributeProto&&pt.attributeProto.length){$t.attributeProto=[];for(var Lt=0;Lt<pt.attributeProto.length;++Lt)$t.attributeProto[Lt]=vt.onnx.AttributeProto.toObject(pt.attributeProto[Lt],wt)}return $t},Ct.prototype.toJSON=function(){return this.constructor.toObject(this,b.util.toJSONOptions)},Ct.getTypeUrl=function(pt){return pt===void 0&&(pt="type.googleapis.com"),pt+"/onnx.FunctionProto"},Ct}(),Tt}(),g.exports=vt});function Fr(d,g){if(!d)throw new Error(typeof g=="string"?g:g())}function sn$1(d){return new TextDecoder().decode(d)}var ye$1,hr$1,pi$1,Ze$1,jn$1,We$1,it,U$2,an$1,mr$1,br,gr$1,fe$1=L$1(()=>{zn$1(),Zo(),ye$1=Ar(Cr()),yr(),hr$1=class{static arraysEqual(d,g){if(d.length!==g.length)return!1;for(let b=0;b<d.length;b++)if(d[b]!==g[b])return!1;return!0}},pi$1=class{static preprocessInputShapes(d,g){let b=d.length===1?[1,d[0]]:d,et=g.length===1?[g[0],1]:g;return[b,et]}static postprocessOutputShape(d,g,b){g===1&&d.splice(d.length-2,1),b===1&&d.pop()}static calcMatMulShape(d,g){return d[1]!==g[0]?void 0:[d[0],g[1]]}},Ze$1=class Vx{static calcShape(g,b,et=!1){let st=g.length,at=b.length;if(st===0)return b;if(at===0)return g;let vt=Math.max(g.length,b.length),Tt=new Array(vt);if(et){if(st<2||at<2)return;let Ct=pi$1.calcMatMulShape([g[st-2],g[st-1]],[b[at-2],b[at-1]]);if(Ct===void 0)return;[Tt[vt-2],Tt[vt-1]]=Ct}for(let Ct=et?3:1;Ct<=vt;Ct++){let pt=st-Ct<0?1:g[st-Ct],wt=at-Ct<0?1:b[at-Ct];if(pt!==wt&&pt>1&&wt>1)return;Tt[vt-Ct]=Math.max(pt,wt)}return Tt}static index(g,b){let et=new Array(b.length);return Vx.fillIndex(g,b,et),et}static fillIndex(g,b,et){let st=g.length-b.length;for(let at=0;at<b.length;at++)et[at]=g[st+at]%b[at]}static calc(g,b,et,st,at){let vt=Vx.calcShape(g.dims,b.dims);if(vt){if(st&&!U$2.areEqual(vt,g.dims))return;let Tt=U$2.size(vt),Ct=st?g:new $e(vt,at||g.type);if(vt.length===0)Ct.set([],et(g.get([]),b.get([])));else{let pt=new Array(vt.length),wt=new Array(g.dims.length),$t=new Array(b.dims.length),Lt=0,jt=0,Ft=!1,Gt=!1;g.dims.length===0&&(Lt=g.get([]),Ft=!0),b.dims.length===0&&(jt=b.get([]),Gt=!0);let Ht;for(let qt=0;qt<Tt;qt++){Ht=qt;for(let Kt=vt.length-1;Kt>=0;Kt--)pt[Kt]=Ht%vt[Kt],Ht=Math.floor(Ht/vt[Kt]);Ft||(Vx.fillIndex(pt,g.dims,wt),Lt=g.get(wt)),Gt||(Vx.fillIndex(pt,b.dims,$t),jt=b.get($t)),Ct.set(pt,et(Lt,jt))}}return Ct}}static isValidBroadcast(g,b){let et=g.length,st=b.length;if(et>st)return!1;for(let at=1;at<=et;at++)if(g[et-at]!==1&&g[et-at]!==b[st-at])return!1;return!0}static getBroadcastDims(g,b){let et=g.length,st=[];for(let at=0;at<et;at++){let vt=et-1-at,Tt=g[vt]||1;(b[b.length-1-at]||1)>1&&Tt===1&&st.unshift(vt)}return st}},jn$1=class{static getShapeOfGemmResult(d,g,b,et,st){if(d.length!==2||b.length!==2)throw new Error("shape need to be of size 2");let at,vt,Tt;g?(at=d[1],vt=d[0]):(at=d[0],vt=d[1]);let Ct=-1;if(et?(Tt=b[0],Ct=1):(Tt=b[1],Ct=0),b[Ct]!==vt)throw new Error("dimension mismatch");if(at<=0||Tt<=0||vt<=0)throw new Error("invalid shape specified");if(st&&!Ze$1.isValidBroadcast(st,[at,Tt]))throw new Error("gemm: invalid bias shape for broadcast");return[at,Tt,vt]}},We$1=class Uw{static tensorDataTypeFromProto(g){switch(g){case ye$1.onnx.TensorProto.DataType.INT8:return"int8";case ye$1.onnx.TensorProto.DataType.UINT8:return"uint8";case ye$1.onnx.TensorProto.DataType.BOOL:return"bool";case ye$1.onnx.TensorProto.DataType.INT16:return"int16";case ye$1.onnx.TensorProto.DataType.UINT16:return"uint16";case ye$1.onnx.TensorProto.DataType.INT32:return"int32";case ye$1.onnx.TensorProto.DataType.UINT32:return"uint32";case ye$1.onnx.TensorProto.DataType.FLOAT:return"float32";case ye$1.onnx.TensorProto.DataType.DOUBLE:return"float64";case ye$1.onnx.TensorProto.DataType.STRING:return"string";case ye$1.onnx.TensorProto.DataType.INT64:return"int32";case ye$1.onnx.TensorProto.DataType.UINT64:return"uint32";default:throw new Error(`unsupported data type: ${ye$1.onnx.TensorProto.DataType[g]}`)}}static tensorDataTypeStringToEnum(g){switch(g){case"int8":return ye$1.onnx.TensorProto.DataType.INT8;case"uint8":return ye$1.onnx.TensorProto.DataType.UINT8;case"bool":return ye$1.onnx.TensorProto.DataType.BOOL;case"int16":return ye$1.onnx.TensorProto.DataType.INT16;case"uint16":return ye$1.onnx.TensorProto.DataType.UINT16;case"int32":return ye$1.onnx.TensorProto.DataType.INT32;case"uint32":return ye$1.onnx.TensorProto.DataType.UINT32;case"float32":return ye$1.onnx.TensorProto.DataType.FLOAT;case"float64":return ye$1.onnx.TensorProto.DataType.DOUBLE;case"string":return ye$1.onnx.TensorProto.DataType.STRING;case"int64":return ye$1.onnx.TensorProto.DataType.INT64;case"uint64":return ye$1.onnx.TensorProto.DataType.UINT64;default:throw new Error(`unsupported data type: ${g}`)}}static tensorDimsFromProto(g){return g.map(b=>Vt.isLong(b)?b.toNumber():b)}static tensorValueTypeFromProto(g){return{tensorType:Uw.tensorDataTypeFromProto(g.elemType),shape:{dims:Uw.tensorDimsFromProto(g.shape.dim.map(b=>b.dimValue))}}}static tensorDimsFromORTFormat(g){let b=[];for(let et=0;et<g.dimsLength();et++)b.push(it.longToNumber(g.dims(et)));return b}static tensorAttributesFromORTFormat(g){let b=[];for(let et=0;et<g.attributesLength();et++)b.push(g.attributes(et));return b}},it=class{static longToNumber(d,g){return Vt.isLong(d)?d.toNumber():d instanceof _$1.Long?Vt.fromValue({low:d.low,high:d.high,unsigned:g??!1}).toNumber():d}static isLong(d){return Vt.isLong(d)||d instanceof _$1.Long}},U$2=class w${static size(g){return w$.getSizeFromDimensionRange(g,0,g.length)}static sizeFromDimension(g,b){if(b<0||b>g.length)throw new Error(`invalid dimension of ${b} for sizeFromDimension as Tensor has ${g.length} dimensions.`);return w$.getSizeFromDimensionRange(g,b,g.length)}static sizeToDimension(g,b){if(b<0||b>g.length)throw new Error(`invalid dimension of ${b} for sizeToDimension as Tensor has ${g.length} dimensions.`);return w$.getSizeFromDimensionRange(g,0,b)}static getSizeFromDimensionRange(g,b,et){let st=1;for(let at=b;at<et;at++){if(g[at]<=0)throw new Error("cannot get valid size from specified dimension range. Most likely the range contains 0 or negative values in them.");st*=g[at]}return st}static computeStrides(g){let b=g.length;if(b===0)return[];if(b===1)return[1];let et=new Array(b);et[b-1]=1,et[b-2]=g[b-1];for(let st=b-3;st>=0;--st)et[st]=et[st+1]*g[st+1];return et}static transpose(g){return g.slice().reverse()}static indicesToOffset(g,b,et){et===void 0&&(et=g.length);let st=0;for(let at=0;at<et;++at)st+=b[at]*g[at];return st}static offsetToIndices(g,b){let et=b.length;if(et===0)return[];if(et===1)return[g*b[0]];let st=new Array(b.length);for(let at=0;at<st.length-1;++at)st[at]=Math.floor(g/b[at]),g-=st[at]*b[at];return st[st.length-1]=g,st}static normalizeAxis(g,b){if(g<-b&&g>=b)throw new Error("unsupported axis for this operation.");return g<0?g+b:g}static normalizeAxes(g,b){return g.map(et=>this.normalizeAxis(et,b))}static incrementIndex(g,b,et){if(b.length===0||g.length===0)throw new Error("Index incrementing unsupported for scalar Tensor");if(et===void 0)et=b.length;else if(et<=0||et>b.length)throw new Error("Incorrect axis to increment on");for(let st=et-1;st>=0&&(g[st]++,!(g[st]<b[st]));--st)g[st]=0}static calculateReshapedDims(g,b){if(b.length===0){if(g.length===0||w$.size(g)===1)return[];throw new Error("cannot reshape to a scalar Tensor")}let et=b.length,st=new Array(et),at=-1,vt=1;for(let Ct=0;Ct<et;Ct++){if(b[Ct]<-1)throw new Error("a dimension in shape hints cannot be less than -1");if(b[Ct]===-1){if(at!==-1)throw new Error("at most one dimension in shape hints can be -1");at=Ct}else{if(b[Ct]===0){if(Ct>=g.length)throw new Error("the dimension with value zero exceeds the dimension size of the input tensor");st[Ct]=g[Ct]}else st[Ct]=b[Ct];vt*=st[Ct]}}let Tt=w$.size(g);if(at!==-1){if(Tt%vt!==0)throw new Error(`the input tensor cannot be reshaped to the requested shape. Input shape: [${g}] Output shape: [${b}]`);st[at]=Tt/vt}else if(vt!==Tt)throw new Error("reshapedDims and originalDims don't have matching sizes");return st}static sortBasedOnPerm(g,b){return b?b.map(et=>g[et]):g.slice().reverse()}static padShape(g,b){let et=g.length;return g.map((st,at)=>st+b[at]+b[at+et])}static areEqual(g,b){return g.length!==b.length?!1:g.every((et,st)=>et===b[st])}static validateDimsAndCalcSize(g){if(g.length>6)throw new TypeError("Only rank 0 to 6 is supported for tensor shape.");let b=1;for(let et of g){if(!Number.isInteger(et))throw new TypeError(`Invalid shape: ${et} is not an integer`);if(et<0||et>2147483647)throw new TypeError(`Invalid shape: length ${et} is not allowed`);b*=et}return b}static flattenShape(g,b){b<0&&(b+=g.length);let et=g.reduce((at,vt)=>at*vt,1),st=g.slice(b).reduce((at,vt)=>at*vt,1);return[et/st,st]}static squeezeShape(g,b){let et=new Array;b=w$.normalizeAxes(b,g.length);for(let st=0;st<g.length;st++){let at=b.indexOf(st)>=0;if(at&&g[st]!==1)throw new Error("squeeze an axis of size different than 1");(b.length===0&&g[st]>1||b.length>0&&!at)&&et.push(g[st])}return et}static unsqueezeShape(g,b){let et=new Array(g.length+b.length);et.fill(0);for(let at=0;at<b.length;at++){let vt=w$.normalizeAxis(b[at],et.length);if(vt>=et.length)throw new Error("'axes' has an out of range axis");if(et[vt]!==0)throw new Error("'axes' has a duplicate axis");et[vt]=1}let st=0;for(let at=0;at<et.length;at++)et[at]===0&&(et[at]=g[st++]);if(st!==g.length)throw new Error("the unsqueezed dimension could not be established");return et}},an$1=class HS{static splitShape(g,b,et,st){if(et.length===0){if(!st)throw new Error("need to know number of outputs when the 'split' attribute is not specified");HS.determineSplit(g[b],st,et)}let at=[],vt=[0];for(let Tt=0;Tt<et.length;++Tt){Tt!==0&&vt.push(vt[Tt-1]+et[Tt-1]);let Ct=g.slice();Ct[b]=et[Tt],at.push(Ct)}return[at,vt]}static determineSplit(g,b,et){if(g%b!==0)throw new Error("cannot split tensor to equal sized parts");for(let st=0;st<b;++st)et.push(g/b)}},mr$1=class Wx{static adjustPoolAttributes(g,b,et,st,at,vt){if(!g&&et.length!==b.length-2)throw new Error("length of specified kernel shapes should be 2 less than length of input dimensions");if(g)for(let Tt=0;Tt<b.length-2;Tt++)Tt>=et.length?et.push(b[Tt+2]):et[Tt]=b[Tt+2];for(let Tt=0;Tt<et.length;Tt++)if(Tt<st.length){if(st[Tt]<0)throw new Error("strides should be greater than or equal to 1")}else st.push(1);for(let Tt=0;Tt<et.length;Tt++)if(Tt<at.length){if(at[Tt]<0)throw new Error("dilations should be greater than or equal to 1")}else at.push(1);for(let Tt=0;Tt<et.length*2;Tt++)if(Tt<vt.length){if(vt[Tt]<0)throw new Error("pad should be greater than or equal to 1")}else vt.push(0);for(let Tt=0;Tt<et.length;Tt++){if(et[Tt]<=0)throw new Error("kernel shapes need to be greater than 0");if(vt[Tt]>=et[Tt]||vt[Tt+et.length]>=et[Tt])throw new Error("pads should be smaller than kernel")}}static adjustPadsBasedOnAutoPad(g,b,et,st,at,vt){if(vt){if(at.length!==2*(g.length-2))throw new Error("length of pads should be twice the length of data dimensions");if(b.length!==g.length-2)throw new Error("length of strides should be the length of data dimensions");if(st.length!==g.length-2)throw new Error("length of kernel shapes should be the length of data dimensions");for(let Tt=0;Tt<g.length-2;Tt++)Wx.adjustPadAndReturnShape(g[Tt+2],b[Tt],et[Tt],st[Tt],at,Tt,Tt+g.length-2,vt)}}static computePoolOutputShape(g,b,et,st,at,vt,Tt){if(b.length<=0)throw new Error("input shape must be of size greater than 0");let Ct=[b[0],b[1]];return Wx.computeShapeHelper(g,b,Ct,et,st,at,vt,Tt),Ct}static computeConvOutputShape(g,b,et,st,at,vt,Tt){if(g.length<=0||b.length<=0)throw new Error("invalid input tensor dims or invalid filter tensor dims");let Ct=[g[0],b[0]];return Wx.computeShapeHelper(!1,g,Ct,et,st,at,vt,Tt),Ct}static computeShapeHelper(g,b,et,st,at,vt,Tt,Ct){if(g)for(let pt=0;pt<b.length-2;pt++)et.push(1);else for(let pt=0;pt<b.length-2;pt++)et.push(Wx.adjustPadAndReturnShape(b[pt+2],st[pt],at[pt],vt[pt],Tt,pt,pt+b.length-2,Ct))}static adjustPadAndReturnShape(g,b,et,st,at,vt,Tt,Ct){let pt=et*(st-1)+1;if(Ct&&Ct!=="NOTSET")switch(Ct){case"VALID":return at[vt]=0,at[Tt]=0,Math.floor((g-pt)/b+1);case"SAME_LOWER":case"SAME_UPPER":if(et!==1)throw new Error("Dilation not supported for SAME_UPPER or SAME_LOWER");{let wt=((g+b-1)/b-1)*b+st-g;return at[vt]=Math.floor(Ct==="SAME_LOWER"?(wt+1)/2:wt/2),at[Tt]=wt-at[vt],Math.floor((g+wt-st)/b+1)}default:throw new Error("Unsupported AutoPad type")}else return Math.floor((g+at[vt]+at[Tt]-pt)/b+1)}},br=-34028234663852886e22,gr$1=34028234663852886e22});function Hd$1(d){switch(d){case"bool":case"int8":case"uint8":return 1;case"int16":case"uint16":return 2;case"int32":case"uint32":case"float32":return 4;case"float64":return 8;default:throw new Error(`cannot calculate sizeof() on type ${d}`)}}function Fu$1(d){switch(d){case ne.onnx.TensorProto.DataType.UINT8:case ne.onnx.TensorProto.DataType.INT8:case ne.onnx.TensorProto.DataType.BOOL:return 1;case ne.onnx.TensorProto.DataType.UINT16:case ne.onnx.TensorProto.DataType.INT16:return 2;case ne.onnx.TensorProto.DataType.FLOAT:case ne.onnx.TensorProto.DataType.INT32:case ne.onnx.TensorProto.DataType.UINT32:return 4;case ne.onnx.TensorProto.DataType.INT64:case ne.onnx.TensorProto.DataType.DOUBLE:case ne.onnx.TensorProto.DataType.UINT64:return 8;default:throw new Error(`cannot calculate sizeof() on type ${ne.onnx.TensorProto.DataType[d]}`)}}function qd$1(d,g){return new(Bu$1(g))(d)}function Bu$1(d){switch(d){case"bool":case"uint8":return Uint8Array;case"int8":return Int8Array;case"int16":return Int16Array;case"uint16":return Uint16Array;case"int32":return Int32Array;case"uint32":return Uint32Array;case"int64":return BigInt64Array;case"float32":return Float32Array;case"float64":return Float64Array;default:throw new Error("unspecified error")}}function hi$1(d,g){if(g===ne.onnx.TensorProto.DataType.INT64||g===di$1.TensorDataType.INT64){if(d.greaterThanOrEqual(2147483648)||d.lessThan(-2147483648))throw new TypeError("int64 is not supported")}else if(g===ne.onnx.TensorProto.DataType.UINT32||g===di$1.TensorDataType.UINT32||g===ne.onnx.TensorProto.DataType.UINT64||g===di$1.TensorDataType.UINT64){if(d.greaterThanOrEqual(4294967296)||d.lessThan(0))throw new TypeError("uint64 is not supported")}else throw new TypeError(`not a LONG type: ${ne.onnx.TensorProto.DataType[g]}`);return d.toNumber()}function $u$1(d,g,b){switch(g){case ne.onnx.TensorProto.DataType.BOOL:case ne.onnx.TensorProto.DataType.UINT8:return d.getUint8(b);case ne.onnx.TensorProto.DataType.INT8:return d.getInt8(b);case ne.onnx.TensorProto.DataType.UINT16:return d.getUint16(b,!0);case ne.onnx.TensorProto.DataType.INT16:return d.getInt16(b,!0);case ne.onnx.TensorProto.DataType.FLOAT:return d.getFloat32(b,!0);case ne.onnx.TensorProto.DataType.INT32:return d.getInt32(b,!0);case ne.onnx.TensorProto.DataType.UINT32:return d.getUint32(b,!0);case ne.onnx.TensorProto.DataType.INT64:return hi$1(Vt.fromBits(d.getUint32(b,!0),d.getUint32(b+4,!0),!1),g);case ne.onnx.TensorProto.DataType.DOUBLE:return d.getFloat64(b,!0);case ne.onnx.TensorProto.DataType.UINT64:return hi$1(Vt.fromBits(d.getUint32(b,!0),d.getUint32(b+4,!0),!0),g);default:throw new Error(`cannot read from DataView for type ${ne.onnx.TensorProto.DataType[g]}`)}}var ku$1,ne,di$1,$e,yr=L$1(()=>{ku$1=Ar(Os$1()),Zo(),tn$1(),ne=Ar(Cr()),fe$1(),di$1=V.experimental.fbs,$e=class W2{constructor(g,b,et,st,at,vt=ku$1.Guid.create()){this.dims=g,this.type=b,this.dataProvider=et,this.asyncDataProvider=st,this.cache=at,this.dataId=vt,this.size=U$2.validateDimsAndCalcSize(g);let Tt=this.size,Ct=et===void 0&&st===void 0&&at===void 0;if(at!==void 0&&at.length!==Tt)throw new RangeError("Input dims doesn't match data length.");if(b==="string"){if(at!==void 0&&(!Array.isArray(at)||!at.every(pt=>typeof pt=="string")))throw new TypeError("cache should be a string array");Ct&&(this.cache=new Array(Tt))}else{if(at!==void 0){let pt=Bu$1(b);if(!(at instanceof pt))throw new TypeError(`cache should be type ${pt.name}`)}if(Ct){let pt=new ArrayBuffer(Tt*Hd$1(b));this.cache=qd$1(pt,b)}}}get data(){if(this.cache===void 0){let g=this.dataProvider(this.dataId);if(g.length!==this.size)throw new Error("Length of data provided by the Data Provider is inconsistent with the dims of this Tensor.");this.cache=g}return this.cache}get stringData(){if(this.type!=="string")throw new TypeError("data type is not string");return this.data}get integerData(){switch(this.type){case"uint8":case"int8":case"uint16":case"int16":case"int32":case"uint32":case"bool":return this.data;default:throw new TypeError("data type is not integer (uint8, int8, uint16, int16, int32, uint32, bool)")}}get floatData(){switch(this.type){case"float32":case"float64":return this.data;default:throw new TypeError("data type is not float (float32, float64)")}}get numberData(){if(this.type!=="string")return this.data;throw new TypeError("type cannot be non-number (string)")}get(g){return this.data[U$2.indicesToOffset(g,this.strides)]}set(g,b){this.data[U$2.indicesToOffset(g,this.strides)]=b}async getData(){return this.cache===void 0&&(this.cache=await this.asyncDataProvider(this.dataId)),this.cache}get strides(){return this._strides||(this._strides=U$2.computeStrides(this.dims)),this._strides}static fromProto(g){if(!g)throw new Error("cannot construct Value from an empty tensor");let b=We$1.tensorDataTypeFromProto(g.dataType),et=We$1.tensorDimsFromProto(g.dims),st=new W2(et,b);if(b==="string")g.stringData.forEach((at,vt)=>{st.data[vt]=sn$1(at)});else if(g.rawData&&typeof g.rawData.byteLength=="number"&&g.rawData.byteLength>0){let at=st.data,vt=new DataView(g.rawData.buffer,g.rawData.byteOffset,g.rawData.byteLength),Tt=Fu$1(g.dataType),Ct=g.rawData.byteLength/Tt;if(g.rawData.byteLength%Tt!==0)throw new Error("invalid buffer length");if(at.length!==Ct)throw new Error("buffer length mismatch");for(let pt=0;pt<Ct;pt++){let wt=$u$1(vt,g.dataType,pt*Tt);at[pt]=wt}}else{let at;switch(g.dataType){case ne.onnx.TensorProto.DataType.FLOAT:at=g.floatData;break;case ne.onnx.TensorProto.DataType.INT32:case ne.onnx.TensorProto.DataType.INT16:case ne.onnx.TensorProto.DataType.UINT16:case ne.onnx.TensorProto.DataType.INT8:case ne.onnx.TensorProto.DataType.UINT8:case ne.onnx.TensorProto.DataType.BOOL:at=g.int32Data;break;case ne.onnx.TensorProto.DataType.INT64:at=g.int64Data;break;case ne.onnx.TensorProto.DataType.DOUBLE:at=g.doubleData;break;case ne.onnx.TensorProto.DataType.UINT32:case ne.onnx.TensorProto.DataType.UINT64:at=g.uint64Data;break;default:throw new Error("unspecific error")}if(at==null)throw new Error("failed to populate data from a tensorproto value");let vt=st.data;if(vt.length!==at.length)throw new Error("array length mismatch");for(let Tt=0;Tt<at.length;Tt++){let Ct=at[Tt];Vt.isLong(Ct)?vt[Tt]=hi$1(Ct,g.dataType):vt[Tt]=Ct}}return st}static fromData(g,b,et){return new W2(b,et,void 0,void 0,g)}static fromOrtTensor(g){if(!g)throw new Error("cannot construct Value from an empty tensor");let b=We$1.tensorDimsFromORTFormat(g),et=We$1.tensorDataTypeFromProto(g.dataType()),st=new W2(b,et);if(et==="string")for(let at=0;at<g.stringDataLength();at++)st.data[at]=g.stringData(at);else if(g.rawDataArray()&&typeof g.rawDataLength()=="number"&&g.rawDataLength()>0){let at=st.data,vt=new DataView(g.rawDataArray().buffer,g.rawDataArray().byteOffset,g.rawDataLength()),Tt=Fu$1(g.dataType()),Ct=g.rawDataLength()/Tt;if(g.rawDataLength()%Tt!==0)throw new Error("invalid buffer length");if(at.length!==Ct)throw new Error("buffer length mismatch");for(let pt=0;pt<Ct;pt++){let wt=$u$1(vt,g.dataType(),pt*Tt);at[pt]=wt}}return st}}});function H(d){return d===1?jd$1:Yd$1}function Nu$1(d){let g=H(d);return`${g.version}
      precision highp float;
      ${g.attribute} vec3 position;
      ${g.attribute} vec2 textureCoord;

      ${g.varyingVertex} vec2 TexCoords;

      void main()
      {
          gl_Position = vec4(position, 1.0);
          TexCoords = textureCoord;
      }`}function Ru$1(d){let g=H(d);return`${g.version}
    precision highp float;
    precision highp int;
    precision highp sampler2D;
    ${g.varyingFrag} vec2 TexCoords;
    ${g.outputDeclaration}
    const vec2 halfCR = vec2(0.5, 0.5);

    // Custom vector types to handle higher dimenalities.
    struct ivec5
    {
      int x;
      int y;
      int z;
      int w;
      int u;
    };

    struct ivec6
    {
      int x;
      int y;
      int z;
      int w;
      int u;
      int v;
    };

    int imod(int x, int y) {
      return x - y * (x / y);
    }

    `}function Mu$1(d,g){let b=H(d);return`
  void main() {
    int indices[${g}];
    toVec(TexCoords, indices);
    vec4 result = vec4(process(indices));
    ${b.output} = result;
  }
  `}var jd$1,Yd$1,we$1=L$1(()=>{jd$1={version:"",attribute:"attribute",varyingVertex:"varying",varyingFrag:"varying",texture2D:"texture2D",output:"gl_FragColor",outputDeclaration:""},Yd$1={version:"#version 300 es",attribute:"in",varyingVertex:"out",varyingFrag:"in",texture2D:"texture",output:"outputColor",outputDeclaration:"out vec4 outputColor;"}}),ae=L$1(()=>{});async function mi$1(d,g=et=>0,b){return new Promise((et,st)=>{let at=0,vt=()=>{if(d()){et();return}at++;let Tt=g(at);setTimeout(vt,Tt)};vt()})}function Yn$1(d){return Fr(typeof d<"u"&&d.length!==0,()=>"empty string found for sampler name"),"get"+d.charAt(0).toUpperCase()+d.slice(1)}function Gu$1(d){return Fr(typeof d<"u"&&d.length!==0,()=>"empty string found for sampler name"),"get"+d.charAt(0).toUpperCase()+d.slice(1)+"AtOutCoords"}function $r(d,g){let b=JSON.parse(JSON.stringify(d));return b=g,b}function kr$1(d,g){return g.map(b=>d[b]).join(", ")}function Qe(d){if(d<=1)return"int";if(d===2)return"ivec2";if(d===3)return"ivec3";if(d===4)return"ivec4";if(d===5)return"ivec5";if(d===6)return"ivec6";throw Error(`GPU for rank ${d} is not yet supported`)}function Dt$1(d=6){return["x","y","z","w","u","v"].slice(0,d)}var Bt$1=L$1(()=>{fe$1()});function Xd$1(d,g){return Dt$1(g).map(b=>`${d}.${b}`)}function Br$1(d,g){return g===1?[d]:Xd$1(d,g)}function Nt(){return`
    float getChannel(vec4 frag, int dim) {
      int modCoord = imod(dim, 2);
      return modCoord == 0 ? frag.r : frag.g;
    }

    float getChannel(vec4 frag, vec2 innerDims) {
      vec2 modCoord = mod(innerDims, 2.);
      return modCoord.x == 0. ?
        (modCoord.y == 0. ? frag.r : frag.g) :
        (modCoord.y == 0. ? frag.b : frag.a);
    }
  `}var Tr=L$1(()=>{Bt$1()});function Jd(d,g,b){if(d===0)return"false";if(d===1)return`rc > ${g[0]}`;let et="";for(let st=d-2;st<d;st++)et+=`${b[st]} >= ${g[st-d+2]}`,st<d-1&&(et+="||");return et}function Zd(d,g){let b=d.length;if(b===0)return"getA(), 0, 0, 0";if(b===1)return`getA(rc),
            rc + 1 >= ${d[0]} ? 0. : getA(rc + 1),
            0, 0`;let et="r, c",st="r, cp1",at="rp1, c",vt="rp1, cp1",Tt="";if(b>2)for(let Ct=0;Ct<b-2;++Ct)Tt=Tt+`${g[Ct]},`;return`getA(${Tt}${et}),
          rEdge ? 0. : getA(${Tt}${at}),
          cEdge ? 0. : getA(${Tt}${st}),
          rEdge || cEdge ? 0. : getA(${Tt}${vt})`}function Qd(d,g,b,et){return d===0||d===1?"":`
    int r = ${g[d-2]};
    int c = ${g[d-1]};
    int rp1 = ${g[d-2]} + 1;
    int cp1 = ${g[d-1]} + 1;
    bool rEdge = rp1 >= ${et};
    bool cEdge = cp1 >= ${b};
    `}var Uu$1,Kd$1,zu$1,Vu$1=L$1(()=>{we$1(),ae(),Bt$1(),Tr(),Uu$1={name:"pack",inputNames:["A"],inputTypes:[1]},Kd$1=(d,g)=>{let b=H(d.session.backend.glContext.version),et=g.dims,st=et.length,at=g.dims.length,vt=Qe(at),Tt=Br$1("rc",at),Ct=Qd(at,Tt,et[et.length-2],et[et.length-1]),pt;st===0?pt=[1,1]:st===1?pt=[et[0],1]:pt=[et[at-1],et[at-2]];let wt=Jd(at,pt,Tt),$t=Zd(et,Tt),Lt=`
        void main() {
          ${vt} rc = getOutputCoords();

          if(${wt}) {
            ${b.output} = vec4(0);
          } else {
            ${Ct}

            ${b.output} = vec4(${$t});
          }
        }
      `;return{...Uu$1,hasMain:!0,output:{dims:g.dims,type:g.type,textureType:2},shaderSource:Lt}},zu$1=(d,g)=>({...Uu$1,get:()=>Kd$1(d,g)})});function bi(d){if(d.length===0)return[1,1,1];let g=1;for(let b=0;b<d.length-2;++b)g*=d[b];return[g,d.length>1?d[d.length-2]:1,d[d.length-1]]}function Hu$1(d,g){let b=!1;return d.length===0||g.length===0?b=!0:d.length<2||g.length<2?b=d[d.length-1]===g[g.length-1]:b=d[d.length-1]===g[g.length-1]&&d[d.length-2]===g[g.length-2],b}function rh(d){let g=U$2.computeStrides(d),b=["b","r","c"],et="index";return`
    ivec3 inputCoordsFromReshapedOutCoords(int index) {
      ${g.map((st,at)=>{let vt=`int ${b[at]} = ${et} / ${st}`,Tt=at===g.length-1?`int ${b[at+1]} = ${et} - ${b[at]} * ${st}`:`index -= ${b[at]} * ${st}`;return`${vt}; ${Tt};`}).join("")}
      return ivec3(b, r, c);
    }
  `}function nh(d){let g=U$2.computeStrides(d);return`
  int getFlattenedIndex(ivec3 coords) {
    // reverse y, z order
    return coords.x * ${g[0]} + coords.z * ${g[1]} + coords.y;
  }
`}var eh,th,Wu$1,qu$1=L$1(()=>{fe$1(),we$1(),ae(),Tr(),eh=d=>({name:"Reshape (packed)",inputTypes:[2],inputNames:["A"],cacheHint:`${d}`}),th=(d,g,b,et)=>{let st=g.dims,at=et,vt="";for(let pt=0;pt<4;pt++){let wt="";switch(pt){case 0:wt="outputCoords = rc;";break;case 1:wt="outputCoords = ivec3(rc.x, rc.y+1, rc.z);";break;case 2:wt="outputCoords = ivec3(rc.x, rc.y, rc.z+1);";break;case 3:wt="outputCoords = ivec3(rc.x, rc.y+1, rc.z+1);";break;default:throw new Error}vt+=`
        ${wt}
        ${pt>0?"if(outputCoords.y < rows && outputCoords.z < cols){":""}
          int flattenedIndex = getFlattenedIndex(outputCoords);

          ivec3 inputRC = inputCoordsFromReshapedOutCoords(flattenedIndex);
          vec2 innerDims = vec2(float(inputRC.y),float(inputRC.z));

          result[${pt}] = getChannel(getA(inputRC.x, inputRC.y, inputRC.z), innerDims);

        ${pt>0?"}":""}
      `}let Tt=H(d.session.backend.glContext.version),Ct=`
      ${rh(st)}
      ${nh(at)}
      ${Nt()}

      void main() {
        ivec3 rc = getOutputCoords();

        vec4 result = vec4(0.0);

        ivec3 outputCoords;
        int rows = ${at[2]};
        int cols = ${at[1]};

        ${vt}
        ${Tt.output} = result;
      }
    `;return{...b,output:{dims:at,type:g.type,textureType:2},shaderSource:Ct,hasMain:!0}},Wu$1=(d,g,b)=>{let et=eh(b);return{...et,get:()=>th(d,g,et,b)}}}),gi,ju$1=L$1(()=>{we$1(),ae(),gi=(d,g)=>{let b=g.shape,et=H(d.session.backend.glContext.version),st=`
    const float FLOAT_MAX = 1.70141184e38;
    const float FLOAT_MIN = 1.17549435e-38;

    bool isNaN(float val) {
      return (val < 1.0 || 0.0 < val || val == 0.0) ? false : true;
    }

    highp vec4 encodeAsUint8(highp float v) {
      if (isNaN(v)) {
        return vec4(255, 255, 255, 255);
      }

      highp float av = abs(v);

      if(av < FLOAT_MIN) {
        return vec4(0.0, 0.0, 0.0, 0.0);
      } else if(v > FLOAT_MAX) {
        return vec4(0.0, 0.0, 128.0, 127.0) / 255.0;
      } else if(v < -FLOAT_MAX) {
        return vec4(0.0, 0.0,  128.0, 255.0) / 255.0;
      }

      highp vec4 c = vec4(0,0,0,0);

      highp float e = floor(log2(av));
      highp float m = exp2(fract(log2(av))) - 1.0;

      c[2] = floor(128.0 * m);
      m -= c[2] / 128.0;
      c[1] = floor(32768.0 * m);
      m -= c[1] / 32768.0;
      c[0] = floor(8388608.0 * m);

      highp float ebias = e + 127.0;
      c[3] = floor(ebias / 2.0);
      ebias -= c[3] * 2.0;
      c[2] += floor(ebias) * 128.0;

      c[3] += 128.0 * step(0.0, -v);

      return c / 255.0;
    }

    void main() {
      float value = ${et.texture2D}(X,TexCoords).r;
      ${et.output} = encodeAsUint8(value);
    }`,at={name:"Uint8Encode",inputTypes:[0],inputNames:["X"],output:{dims:b,type:g.tensor.type,textureType:3},shaderSource:st,hasMain:!0};return d.executeProgram(at,[g.tensor])}});function ih(d,g){if(d===1)return"rc";let b="";for(let et=0;et<d;et++)b+=g[et],et<d-1&&(b+=",");return b}var Yu$1,oh,Xu$1,Ku$1=L$1(()=>{we$1(),ae(),Bt$1(),Tr(),Yu$1={name:"unpack",inputNames:["A"],inputTypes:[2]},oh=(d,g)=>{let b=g.dims.length,et=Br$1("rc",b),st=et.slice(-2),at=Qe(b),vt=Nt(),Tt=g.dims.length===0?"":ih(b,et),Ct=b<=1?"rc":`vec2(${st.join(",")})`,pt=H(d.session.backend.glContext.version),wt=`
    ${vt}
    void main() {
      ${at} rc = getOutputCoords();

       // Sample the texture with the coords to get the rgba channel value.
       vec4 packedInput = getA(${Tt});

       ${pt.output} = vec4(getChannel(packedInput, ${Ct}), 0, 0, 0);
     }
   `;return{...Yu$1,hasMain:!0,output:{dims:g.dims,type:g.type,textureType:0},shaderSource:wt}},Xu$1=(d,g)=>({...Yu$1,get:()=>oh(d,g)})}),Xn$1,un,Kn$1,ln=L$1(()=>{lt$1(),Xn$1=class{constructor(d,g=1){if(g===1)this.internalFormat=d.R32F,this.format=d.RED,this.textureType=d.FLOAT,this.channelSize=g;else if(g===4)this.internalFormat=d.RGBA32F,this.format=d.RGBA,this.textureType=d.FLOAT,this.channelSize=g;else throw new Error(`Invalid number of channels: ${g}`)}encode(d,g){let b,et;return d.constructor!==Float32Array&&(ce.warning("Encoder","data was not of type Float32; creating new Float32Array"),et=new Float32Array(d)),g*this.channelSize>d.length?(ce.warning("Encoder","Source data too small. Allocating larger array"),et=d,b=this.allocate(g*this.channelSize),et.forEach((st,at)=>b[at]=st)):(et=d,b=et),b}allocate(d){return new Float32Array(d*4)}decode(d,g){return this.channelSize===1?d.filter((b,et)=>et%4===0).subarray(0,g):d.subarray(0,g)}},un=class{constructor(d,g=1,b){if(g!==1&&g!==4)throw new Error(`Invalid number of channels: ${g}`);this.internalFormat=d.RGBA,this.format=d.RGBA,this.channelSize=g,this.textureType=b||d.FLOAT}encode(d,g){let b=d;return this.channelSize===1&&(ce.verbose("Encoder","Exploding into a larger array"),b=this.allocate(g),d.forEach((et,st)=>b[st*4]=et)),b}allocate(d){return new Float32Array(d*4)}decode(d,g){return this.channelSize===1?d.filter((b,et)=>et%4===0).subarray(0,g):d.subarray(0,g)}},Kn$1=class{constructor(d,g=1){if(this.channelSize=4,g===1)this.internalFormat=d.ALPHA,this.format=d.ALPHA,this.textureType=d.UNSIGNED_BYTE,this.channelSize=g;else if(g===4)this.internalFormat=d.RGBA,this.format=d.RGBA,this.textureType=d.UNSIGNED_BYTE,this.channelSize=g;else throw new Error(`Invalid number of channels: ${g}`)}encode(d,g){return new Uint8Array(d.buffer,d.byteOffset,d.byteLength)}allocate(d){return new Uint8Array(d*this.channelSize)}decode(d,g){if(d instanceof Uint8Array)return d.subarray(0,g);throw new Error(`Invalid array type: ${d.constructor}`)}}}),fn,Ju$1,yi,Zu$1=L$1(()=>{fe$1(),ae(),fn=(d,g,b)=>{let et=b===0||b===1?1:4,st=b===2,at=b===1||b===2,vt=b===4?g.length-1:void 0,Tt=b===4?g.map((Ct,pt)=>pt===g.length-1?Ct*4:Ct):void 0;return yi(d,g,et,Tt,{isPacked:st,reverseWH:at,breakAxis:vt})},Ju$1=(d,g,b)=>{let et=fn(d,g,b);return[et.width,et.height]},yi=(d,g,b=1,et,st)=>{let at=!!(st&&st.isPacked),[vt,Tt]=d.computeTextureWH(at&&et||g,st),Ct=g.length,pt=g.slice(0);if(Ct===0&&(pt=[1]),b===1)et=g;else if(at){if(b!==4)throw new Error("a packed texture must be 4-channel");et=g,Ct>0&&(pt[Ct-1]=Math.ceil(pt[Ct-1]/2)),Ct>1&&(pt[Ct-2]=Math.ceil(pt[Ct-2]/2))}else if(!et)throw new Error("Unpacked shape is needed when using channels > 1");return{width:vt,height:Tt,channels:b,isPacked:at,shape:pt,strides:U$2.computeStrides(pt),unpackedShape:et,reversedWH:st&&st.reverseWH}}}),sh,Jn$1,el$1=L$1(()=>{lt$1(),yr(),fe$1(),Vu$1(),qu$1(),ju$1(),Ku$1(),ln(),Zu$1(),ae(),sh=(d,g)=>{let b=g.map(st=>`${st.unpackedShape.join(",")};${st.width}x${st.height}`).join("_"),et=d.name;return d.cacheHint&&(et+="["+d.cacheHint+"]"),et+=":"+b,et},Jn$1=class{constructor(d){this.session=d,this.packedTextureDataCache=new Map,this.unpackedTextureDataCache=new Map}calculateTextureWidthAndHeight(d,g){return Ju$1(this.session.layoutStrategy,d,g)}executeProgram(d,g){if(g.length<d.inputNames.length)throw new Error(`Input size mustn't be less than ${d.inputNames.length}.`);if(d.inputNames.length!==d.inputTypes.length)throw new Error("input names size does not match input types");let b=[];for(let Ct=0;Ct<d.inputNames.length;++Ct)b[Ct]=this.getOrCreateTextureData(g[Ct],d.inputTypes[Ct]);let et=sh(d,b),st=this.session.programManager.getArtifact(et),at=st?st.programInfo:typeof d.get=="function"?d.get():d,vt=fn(this.session.layoutStrategy,at.output.dims,at.output.textureType),Tt=this.createTextureData(vt,at.output.type);return st||(st=this.session.programManager.build(at,b,Tt),this.session.programManager.setArtifact(et,st)),this.runProgram(st,b,Tt),Tt}run(d,g){return this.executeProgram(d,g).tensor}runProgram(d,g,b){for(let et=0;et<g.length;++et)if(!!g[et].isPacked!=(d.programInfo.inputTypes[et]===2))throw new Error(`input[${et}] property packed inconsistent`);if(!!b.isPacked!=(d.programInfo.output.textureType===2))throw new Error("output property packed inconsistent");this.session.programManager.run(d,g,b)}getOrCreateTextureData(d,g){let b=this.getTextureData(d.dataId,g===2);if(!b&&(b=this.getTextureData(d.dataId,g!==2),b))return g===2?this.pack(b):this.unpack(b);if(!b){let et=fn(this.session.layoutStrategy,d.dims,g);if(g===4){let st=d.dims;if(st.length===4){let at=[st[0],Math.ceil(st[1]*st[2]*st[3]/4)],vt=fn(this.session.layoutStrategy,at,g),Tt=d.numberData;if(st[1]*st[2]*st[3]%4!==0){let Ct=st[0],pt=st[1]*st[2]*st[3],wt=Math.ceil(pt*1/4)*4,$t=Ct*wt;Tt=new Float32Array($t);for(let Lt=0;Lt<Ct;++Lt){let jt=Lt*pt,Ft=Lt*wt+Lt%1*pt;Tt.set(d.numberData.subarray(jt,jt+pt),Ft)}}return this.createTextureData(vt,d.type,Tt,d,1)}}if(g===2){let st=yi(this.session.layoutStrategy,d.dims,1,[],{reverseWH:!0}),at=this.createTextureData(st,d.type,d.numberData,d,1);b=this.pack(at)}else b=this.createTextureData(et,d.type,d.numberData,d,1)}return b}createTextureDataFromLayoutBindTensor(d,g,b,et){return this.createTextureData(d,g,b,et,1)}createTextureData(d,g,b,et,st){ce.verbose("InferenceHandler",`Creating TextureData: layout:[${JSON.stringify(d)}]`);let at=this.session.textureManager.createTextureFromLayout(g,d,b,st);return this.createTextureDataFromTexture(d,g,at,et)}reshapeUnpacked(d,g){let b=this.getOrCreateTextureData(d,0),et={channels:b.channels,height:b.height,width:b.width,shape:g.length!==0?g:[1],strides:U$2.computeStrides(g),unpackedShape:g};return this.createTextureDataFromTexture(et,d.type,b.texture).tensor}reshapePacked(d,g){let b=this.getOrCreateTextureData(d,2);if(Hu$1(d.dims,g)){let Tt={channels:b.channels,height:b.height,width:b.width,shape:g.length!==0?g:[1],strides:U$2.computeStrides(g),unpackedShape:g,isPacked:!0};return this.createTextureDataFromTexture(Tt,d.type,b.texture).tensor}let et=bi(d.dims),st=bi(g),at=this.reshapePacked(d,et),vt=this.run(Wu$1(this,at,st),[at]);return this.reshapePacked(vt,g)}cast(d,g){let b=this.getOrCreateTextureData(d,0);return this.createTextureDataFromTexture(b,g,b.texture).tensor}createTextureDataFromTexture(d,g,b,et,st){let at={...d,tensor:et||new $e(d.unpackedShape,g,vt=>this.readTexture(at),async vt=>this.readTextureAsync(at),void 0,st),texture:b};return this.setTextureData(at.tensor.dataId,at,d.isPacked),at}getTextureData(d,g=!1){return this.session.isInitializer(d)?this.session.getTextureData(d,g):g?this.packedTextureDataCache.get(d):this.unpackedTextureDataCache.get(d)}setTextureData(d,g,b=!1){this.session.isInitializer(d)?this.session.setTextureData(d,g,b):(b?this.packedTextureDataCache:this.unpackedTextureDataCache).set(d,g)}isTextureLayoutCached(d,g=!1){return!!this.getTextureData(d.dataId,g)}dispose(){this.session.textureManager.clearActiveTextures(),this.packedTextureDataCache.forEach(d=>this.session.textureManager.releaseTexture(d)),this.packedTextureDataCache=new Map,this.unpackedTextureDataCache.forEach(d=>this.session.textureManager.releaseTexture(d)),this.unpackedTextureDataCache=new Map}readTexture(d){return d.isPacked?this.readTexture(this.unpack(d)):this.session.backend.glContext.isFloat32DownloadSupported?this.session.textureManager.readTexture(d,d.tensor.type,d.channels):this.session.textureManager.readUint8TextureAsFloat(gi(this,d))}async readTextureAsync(d){return d.isPacked?this.readTextureAsync(this.unpack(d)):this.session.backend.glContext.isFloat32DownloadSupported?this.session.textureManager.readTextureAsync(d,d.tensor.type,d.channels):this.session.textureManager.readUint8TextureAsFloat(gi(this,d))}pack(d){return this.executeProgram(zu$1(this,d.tensor),[d.tensor])}unpack(d){return this.executeProgram(Xu$1(this,d.tensor),[d.tensor])}}}),Ti,Q$1,Ue$1=L$1(()=>{Ti=class{constructor(d){Object.assign(this,d)}get cacheKey(){return this.key||(this.key=Object.getOwnPropertyNames(this).sort().map(d=>`${this[d]}`).join(";")),this.key}},Q$1=d=>new Ti(d)}),tl$1,rl$1,nl$1,uh,lh,ol$1=L$1(()=>{Ue$1(),we$1(),ae(),tl$1={name:"BatchNormalization",inputNames:["A","Scale","B","Mean","Variance"],inputTypes:[0,0,0,0,0]},rl$1=(d,g,b)=>(lh(g),[d.run({...tl$1,cacheHint:b.cacheKey,get:()=>uh(d,g,b)},g)]),nl$1=d=>{let g=d.attributes.getFloat("epsilon",1e-5),b=d.attributes.getFloat("momentum",.9),et=d.attributes.getInt("spatial",1);return Q$1({epsilon:g,momentum:b,spatial:et})},uh=(d,g,b)=>{let et=H(d.session.backend.glContext.version),st=g[0].dims.length,[at,vt]=d.calculateTextureWidthAndHeight(g[1].dims,0),Tt=`
  float process(int[${st}] indices) {
    vec2 position = offsetToCoords(indices[1], ${at}, ${vt});
    float scale = getColorAsFloat(${et.texture2D}(Scale, position));
    float mean = getColorAsFloat(${et.texture2D}(Mean, position));
    float variance = getColorAsFloat(${et.texture2D}(Variance, position));
    float b = getColorAsFloat(${et.texture2D}(B, position));

    return scale * ( (_A(indices) - mean) / sqrt(variance + float(${b.epsilon})) ) + b;
  }`;return{...tl$1,output:{dims:g[0].dims,type:g[0].type,textureType:0},shaderSource:Tt}},lh=d=>{if(!d||d.length!==5)throw new Error("BatchNormalization requires 5 inputs.");let g=d[0],b=d[1],et=d[2],st=d[3],at=d[4];if(g.dims.length<3||b.dims.length!==1||et.dims.length!==1||st.dims.length!==1||at.dims.length!==1)throw new Error("invalid input shape.");if(b.dims[0]!==g.dims[1]||et.dims[0]!==g.dims[1]||st.dims[0]!==g.dims[1]||at.dims[0]!==g.dims[1])throw new Error("invalid input shape.");if(g.type!=="float32"&&g.type!=="float64"||b.type!=="float32"&&b.type!=="float64"||et.type!=="float32"&&et.type!=="float64"||st.type!=="float32"&&st.type!=="float64"||at.type!=="float32"&&at.type!=="float64")throw new Error("invalid input tensor types.")}}),Zn$1,dt,R,cn,Qn$1,Wt$1=L$1(()=>{Zn$1=class{constructor(d,g,b,et){this.glContext=d,this.programInfo=g,this.inputTextureLayouts=b,this.outputTextureLayout=et}},dt=class{constructor(d){this.context=d}},R=class{constructor(d,g){this.routineBody=d,this.dependencies=g}},cn=class{constructor(d,g,b){this.name=d,b?this.dependencies=b:this.dependencies=[],g&&(this.routineBody=g)}addDependency(d){d&&this.dependencies.push(d)}},Qn$1=class{static returnOrderedNodes(d){if(!d||d.length===0)return[];if(d.length===1)return d;let g=new Set,b=new Set,et=new Array;return this.createOrderedNodes(d,g,b,et),et}static createOrderedNodes(d,g,b,et){for(let st=0;st<d.length;++st)this.dfsTraverse(d[st],g,b,et)}static dfsTraverse(d,g,b,et){if(!d||b.has(d.name))return;if(g.has(d.name))throw new Error("Cyclic dependency detected. Can't topologically sort routines needed for shader.");g.add(d.name);let st=d.dependencies;if(st&&st.length>0)for(let at=0;at<st.length;++at)this.dfsTraverse(st[at],g,b,et);et.push(d),b.add(d.name),g.delete(d.name)}}});function ch(){let d="add_";return{body:`
  float ${d}(float a, float b) {
    return a + b;
  }
  vec4 ${d}(vec4 v1, vec4 v2) {
    return v1 + v2;
  }
  `,name:d,type:0}}function ph(){let d="div_";return{body:`
  float ${d}(float a, float b) {
    return a / b;
  }
  vec4 ${d}(vec4 v1, vec4 v2) {
    return v1 / v2;
  }
  `,name:d,type:0}}function dh(){let d="mul_";return{body:`
  float ${d}(float a, float b) {
    return a * b;
  }
  vec4 ${d}(vec4 v1, vec4 v2) {
    return v1 * v2;
  }
  `,name:d,type:0}}function hh(){let d="sub_";return{body:`
  float ${d}(float a, float b) {
    return a - b;
  }
  vec4 ${d}(vec4 v1, vec4 v2) {
    return v1 - v2;
  }
  `,name:d,type:0}}function mh(){let d="equal_";return{body:`
  float ${d}(float a, float b) {
    return float(a == b);
  }
  vec4 ${d}(vec4 v1, vec4 v2) {
    return vec4(equal(v1, v2));
  }
  `,name:d,type:0}}function bh(){let d="greater_";return{body:`
  float ${d}(float a, float b) {
    return float(a > b);
  }
  vec4 ${d}(vec4 v1, vec4 v2) {
    return vec4( v1.r > v2.r ,
      v1.g > v2.g,
      v1.b > v2.b,
      v1.a > v2.a );
  }
  `,name:d,type:0}}function gh(){let d="less_";return{body:`
  float ${d}(float a, float b) {
    return float(a < b);
  }
  vec4 ${d}(vec4 v1, vec4 v2) {
    return vec4( v1.r < v2.r ,
                v1.g < v2.g,
                v1.b < v2.b,
                v1.a < v2.a );
  }
  `,name:d,type:0}}function yh(){let d="and_";return{body:`
  float ${d}(float a, float b) {
    return float( bool(a) && bool(b) );
  }
  vec4 ${d}(vec4 v1, vec4 v2) {
    bvec4 b1 = bvec4(v1);
    bvec4 b2 = bvec4(v2);
    return vec4( b1.r && b2.r ,
                b1.g && b2.g,
                b1.b && b2.b,
                b1.a && b2.a );
  }
  `,name:d,type:0}}function Th(){let d="or_";return{body:`
  float ${d}(float a, float b) {
    return float( bool(a) || bool(b) );
  }
  vec4 ${d}(vec4 v1, vec4 v2) {
    bvec4 b1 = bvec4(v1);
    bvec4 b2 = bvec4(v2);
    return vec4( b1.r || b2.r ,
                b1.g || b2.g,
                b1.b || b2.b,
                b1.a || b2.a );
  }
  `,name:d,type:0}}function xh(){let d="xor_";return{body:`
  float ${d}(float a, float b) {
    return float( bool(a) ^^ bool(b) );
  }
  vec4 ${d}(vec4 v1, vec4 v2) {
    bvec4 b1 = bvec4(v1);
    bvec4 b2 = bvec4(v2);
    return vec4( b1.r ^^ b2.r ,
                b1.g ^^ b2.g,
                b1.b ^^ b2.b,
                b1.a ^^ b2.a );
  }
  `,name:d,type:0}}function wh(){return _h("pow")}function vh(){let d="prelu_";return{body:`
  float ${d}(float a, float b) {
    return a < 0.0 ? a * b: a;
  }
  vec4 ${d}(vec4 v1, vec4 v2) {
    return vec4(
      v1.r < 0.0 ? v1.r * v2.r: v1.r,
      v1.g < 0.0 ? v1.g * v2.g: v1.g,
      v1.b < 0.0 ? v1.b * v2.b: v1.b,
      v1.a < 0.0 ? v1.a * v2.a: v1.a
      );
  }
  `,name:d,type:0}}function _h(d){let g=`${d}_`;return{body:`
  float ${g}(float a, float b) {
    return ${d}(a, b);
  }
  vec4 ${g}(vec4 v1, vec4 v2) {
    return ${d}(v1, v2);
  }
  `,name:g,type:0}}var ht,Oh,il$1,al$1,sl$1,ul$1,ll$1,fl$1,cl$1,pl$1,dl$1,hl$1,ml$1,bl$1,gl$1=L$1(()=>{fe$1(),Wt$1(),we$1(),ae(),ht=(d,g,b,et=g[0].type,st)=>{let at=d.session.pack?2:0;return{name:b.name,inputNames:["A","B"],inputTypes:[at,at],cacheHint:st,get:()=>Oh(d,g,b,et)}},Oh=(d,g,b,et=g[0].type)=>{let st=d.session.pack?2:0,at=!U$2.areEqual(g[0].dims,g[1].dims),vt=g[0].dims,Tt=d.session.pack;if(at){let wt=Ze$1.calcShape(g[0].dims,g[1].dims,!1);if(!wt)throw new Error("Can't perform binary op on the given tensors");vt=wt;let $t=vt.length,Lt=g[0].dims.length!==0?g[0].dims.length:1,jt=g[1].dims.length!==0?g[1].dims.length:1,Ft=g[0].dims.length!==0?"bcastIndices_A(indices, aindices);":"aindices[0] = 0;",Gt=g[1].dims.length!==0?"bcastIndices_B(indices, bindices);":"bindices[0] = 0;",Ht=H(d.session.backend.glContext.version),qt=Tt?`
      ${b.body}
      void main() {
        vec4 a = getAAtOutCoords();
        vec4 b = getBAtOutCoords();
        vec4 result = ${b.name}(a, b);
        ${Ht.output} = result;
      }`:`
      ${b.body}
      float process(int indices[${$t}]) {
        int aindices[${Lt}];
        int bindices[${jt}];
        ${Ft}
        ${Gt}
        return ${b.name}(_A(aindices), _B(bindices));
      }`;return{name:b.name,inputNames:["A","B"],inputTypes:[st,st],output:{dims:vt,type:et,textureType:st},shaderSource:qt,hasMain:Tt}}let Ct=H(d.session.backend.glContext.version),pt=`
    ${b.body}
    void main() {
      vec4 v1 = ${Ct.texture2D}(A, TexCoords);
      vec4 v2 = ${Ct.texture2D}(B, TexCoords);
      vec4 result = ${b.name}(v1, v2);
      ${Ct.output} = result;
    }
    `;return{name:b.name,inputNames:["A","B"],inputTypes:[st,st],output:{dims:g[0].dims,type:et,textureType:st},shaderSource:pt,hasMain:!0}},il$1=(d,g)=>[d.run(ht(d,g,ch()),g)],al$1=(d,g)=>[d.run(ht(d,g,yh(),"bool"),g)],sl$1=(d,g)=>[d.run(ht(d,g,ph()),g)],ul$1=(d,g)=>[d.run(ht(d,g,mh(),"bool"),g)],ll$1=(d,g)=>[d.run(ht(d,g,bh(),"bool"),g)],fl$1=(d,g)=>[d.run(ht(d,g,gh(),"bool"),g)],cl$1=(d,g)=>[d.run(ht(d,g,dh()),g)],pl$1=(d,g)=>[d.run(ht(d,g,Th(),"bool"),g)],dl$1=(d,g)=>[d.run(ht(d,g,wh()),g)],hl$1=(d,g)=>[d.run(ht(d,g,vh()),g)],ml$1=(d,g)=>[d.run(ht(d,g,hh()),g)],bl$1=(d,g)=>[d.run(ht(d,g,xh(),"bool"),g)]}),yl$1,Tl$1,Sh,xl$1=L$1(()=>{fe$1(),yl$1=(d,g,b)=>(Sh(g),[d.cast(g[0],b)]),Tl$1=d=>We$1.tensorDataTypeFromProto(d.attributes.getInt("to")),Sh=d=>{if(!d||d.length!==1)throw new Error("Cast requires 1 input.");if(d[0].type==="string")throw new Error("Invalid input type.")}}),Ah,Ph,wl$1,eo$1,vl$1=L$1(()=>{we$1(),ae(),Bt$1(),Tr(),Ah=(d,g)=>({name:"Concat (packed)",inputNames:Array.from({length:d},(b,et)=>`X${et}`),inputTypes:Array(d).fill(2),cacheHint:g}),Ph=(d,g,b,et)=>{let st=b[0].dims.slice();if(et>=st.length||et<-1*st.length)throw new Error("axis specified for concat doesn't match input dimensionality");et<0&&(et=st.length+et);let at=st.slice(0);for(let or=1;or<b.length;or++){let jr=b[or].dims.slice();for(let qr=0;qr<st.length;qr++)if(qr===et)at[et]+=jr[qr];else if(st[qr]!==jr[qr])throw new Error("non concat dimensions must match")}let vt=at.length,Tt=Br$1("coords",vt),Ct=Qe(vt),pt=Nt(),wt=b.map(or=>or.dims),$t=Dt$1(vt),Lt=new Array(wt.length-1);Lt[0]=wt[0][et];for(let or=1;or<Lt.length;or++)Lt[or]=Lt[or-1]+wt[or][et];let jt=$t[et],Ft=$t.slice(-2),Gt=$t.join(),Ht=`if (${jt} < ${Lt[0]}) {
        return getChannel(
            getX0(${Gt}), vec2(${Ft.join()}));
        }`;for(let or=1;or<Lt.length;or++){let jr=Lt[or-1];Ht+=`
            if (${jt} < ${Lt[or]}  && ${jt} >= ${Lt[or-1]}) {
              return getChannel(
                getX${or}(${eo$1($t,jt,jr)}),
                vec2(${eo$1(Ft,jt,jr)}));
            }`}let qt=Lt.length,Kt=Lt[Lt.length-1];Ht+=`
            return getChannel(
              getX${qt}(${eo$1($t,jt,Kt)}),
              vec2(${eo$1(Ft,jt,Kt)}));`;let rr=H(d.session.backend.glContext.version),ir=`
          ${pt}
          float getValue(${$t.map(or=>"int "+or)}) {
            ${Ht}
          }

          void main() {
            ${Ct} coords = getOutputCoords();
            int lastDim = coords.${$t[vt-1]};
            coords.${$t[vt-1]} = coords.${$t[vt-2]};
            coords.${$t[vt-2]} = lastDim;

            vec4 result = vec4(getValue(${Tt}), 0., 0., 0.);

            ${Tt[vt-1]} = ${Tt[vt-1]} + 1;
            if (${Tt[vt-1]} < ${at[vt-1]}) {
              result.g = getValue(${Tt});
            }

            ${Tt[vt-2]} = ${Tt[vt-2]} + 1;
            if (${Tt[vt-2]} < ${at[vt-2]}) {
              result.a = getValue(${Tt});
            }

            ${Tt[vt-1]} = ${Tt[vt-1]} - 1;
            if (${Tt[vt-2]} < ${at[vt-2]} &&
                ${Tt[vt-1]} < ${at[vt-1]}) {
              result.b = getValue(${Tt});
            }
            ${rr.output} = result;
          }
        `;return{...g,output:{dims:at,type:b[0].type,textureType:2},shaderSource:ir,hasMain:!0}},wl$1=(d,g,b)=>{let et=Ah(g.length,b.cacheKey);return{...et,get:()=>Ph(d,et,g,b.axis)}},eo$1=(d,g,b)=>{let et=d.indexOf(g);return d.map((st,at)=>at===et?`${st} - ${b}`:st).join()}}),_l$1,Eh,Dh,Lh,Ol$1,Ch,Fh,$h,Il$1,kh,Sl$1=L$1(()=>{Ue$1(),ae(),vl$1(),_l$1=(d,g,b)=>(kh(g),d.session.pack&&g[0].dims.length>1?[d.run(wl$1(d,g,b),g)]:[d.run(Lh(d,g,b),g)]),Eh=(d,g)=>({name:"Concat",inputNames:Array.from({length:d},(b,et)=>`X${et}`),inputTypes:Array(d).fill(0),cacheHint:g}),Dh=(d,g,b,et)=>{let st=b[0].dims.slice();if(et>=st.length||et<-1*st.length)throw new Error("axis specified for concat doesn't match input dimensionality");et<0&&(et=st.length+et);let at=st.slice(0);for(let jt=1;jt<b.length;jt++){let Ft=b[jt].dims.slice();for(let Gt=0;Gt<st.length;Gt++)if(Gt===et)at[et]+=Ft[Gt];else if(st[Gt]!==Ft[Gt])throw new Error("non concat dimensions must match")}let vt=at.length,Tt=new Array(b.length),Ct=0;for(let jt=0;jt<Tt.length;++jt)Ct+=b[jt].dims[et],Tt[jt]=Ct;let pt="";b.length<5?pt=Ol$1(Tt):pt=Ch(Tt);let wt=Fh(b.length,vt),$t=$h(Tt),Lt=`
        ${wt}
        ${$t}
        ${pt}
        float process(int indices[${vt}]) {
          int textureIndex = getTextureWhereDataResides (indices[${et}]);

          if(textureIndex != 0) {
            indices[${et}] = indices[${et}] - int(getSizeInConcatAxisValueFromIndex(textureIndex-int(1)));
          }

          return fetchDataFromCorrectTexture(textureIndex, indices);
        }`;return{...g,output:{dims:at,type:b[0].type,textureType:0},shaderSource:Lt}},Lh=(d,g,b)=>{let et=Eh(g.length,b.cacheKey);return{...et,get:()=>Dh(d,et,g,b.axis)}},Ol$1=d=>`int getTextureWhereDataResides(int index) {
      ${d.map((g,b)=>`if(index<${g}) {return ${b};}
`).join("")}
    }`,Ch=d=>Ol$1(d),Fh=(d,g)=>{let b=[`float fetchDataFromCorrectTexture(int textureIndex, int indices[${g}]) {`];for(let et=0;et<d;++et)et===0?b.push(`	if (textureIndex == ${et}) { return _X${et}(indices); }`):et===d-1?b.push(`	else { return _X${et}(indices); }`):b.push(`	else if (textureIndex == ${et}) { return _X${et}(indices); }`);return b.push("	}"),b.join(`
`)},$h=d=>{let g=["int getSizeInConcatAxisValueFromIndex(int index) {"];for(let b=0;b<d.length;++b)b===0?g.push(`	if (index == ${b}) { return ${d[b]}; }`):b===d.length-1?g.push(`	else { return ${d[b]}; }`):g.push(`	else if (index == ${b}) { return ${d[b]}; }`);return g.push("	}"),g.join(`
`)},Il$1=d=>Q$1({axis:d.attributes.getInt("axis")}),kh=d=>{if(!d||d.length<1)throw new Error("too few inputs");let g=d[0].type,b=d[0].dims.length;if(g==="string")throw new Error("string tensor is not supported yet");for(let et of d){if(et.type!==g)throw new Error("input tensors should be one type");if(et.dims.length!==b)throw new Error("input tensors should have the same shape")}}});function Bh(){return mt("abs")}function Nh(){return mt("acos")}function Rh(){return mt("asin")}function Mh(){return mt("atan")}function Gh(){return mt("ceil")}function Uh(){return mt("cos")}function zh(d){let g="elu";return{body:`
  const float alpha = float(${d});

  float ${g}_(float a) {
    return a >= 0.0 ? a: (exp(a) - 1.0) * alpha;
  }
  vec4 ${g}_(vec4 v) {
    return vec4(${g}_(v.x), ${g}_(v.y), ${g}_(v.z), ${g}_(v.w));
  }
  `,name:g,type:0}}function Vh(){return mt("exp")}function Wh(){return mt("floor")}function xi(d,g){let b="clip";return{body:`
  const float min = float(${d});
  const float max = float(${g});

  float ${b}_(float a) {
    return clamp(a, min, max);
  }
  vec4 ${b}_(vec4 v) {
    return clamp(v, min, max);
  }
  `,name:b,type:0}}function Hh(){let d="indentity";return{body:`
  float ${d}_(float a) {
    return a;
  }
  vec4 ${d}_(vec4 v) {
    return v;
  }
  `,name:d,type:0}}function qh(d){let g="leakyRelu";return{body:`
  const float alpha = float(${d});

  float ${g}_(float a) {
    return a < 0.0 ? a * alpha : a;
  }
  vec4 ${g}_(vec4 v) {
    return vec4(${g}_(v.x), ${g}_(v.y), ${g}_(v.z), ${g}_(v.w));
  }
  `,name:g,type:0}}function jh(){return mt("log")}function Yh(){let d="neg";return{body:`
  float ${d}_(float a) {
    return -a;
  }
  vec4 ${d}_(vec4 v) {
    return -v;
  }
  `,name:d,type:0}}function Xh(){let d="not";return{body:`
  float ${d}_(float a) {
    return float( ! bool(a) );
  }
  bool ${d}_(bool a) {
    return !a;
  }
  vec4 ${d}_(vec4 v) {
    return vec4(!bool(v.x), !bool(v.y), !bool(v.z), !bool(v.w));
  }
  bvec4 ${d}_(bvec4 v) {
    return bvec4(!v.x, !v.y, !v.z, !v.w);
  }
  `,name:d,type:0}}function Kh(){return mt("sin")}function wi(){let d="relu";return{body:`
  float ${d}_(float a) {
    return max( a, 0.0 );
  }
  vec4 ${d}_(vec4 v) {
    return max( v, 0.0 );
  }
  `,name:d,type:0}}function vi(){let d="sigmoid";return{body:`
  float ${d}_(float a) {
    return 1.0 / (1.0 + exp(-a));
  }
  vec4 ${d}_(vec4 v) {
    return 1.0 / (1.0 + exp(-v));
  }
  `,name:d,type:0}}function Jh(){return mt("sqrt")}function Zh(){return mt("tan")}function Qh(){let d="tanh";return{body:`
  float ${d}_(float a) {
    a = clamp(a, -10., 10.);
    a = exp(2.*a);
    return (a - 1.) / (a + 1.);
  }
  vec4 ${d}_(vec4 v) {
    v = clamp(v, -10., 10.);
    v = exp(2.*v);
    return (v - 1.) / (v + 1.);
  }
  `,name:d,type:0}}function mt(d){return{body:`
  float ${d}_(float a) {
    return ${d}(a);
  }
  vec4 ${d}_(vec4 v) {
    return ${d}(v);
  }
  `,name:d,type:0}}var em$1,Ee,Al$1,Pl$1,El$1,Dl$1,_i,Ll$1,Cl$1,tm$1,Fl$1,$l$1,kl$1,Bl$1,Nl$1,Rl$1,Oi$1,Ml$1,Gl$1,Ul$1,zl$1,Vl$1,Wl$1,Hl$1,ql$1,jl$1,Yl$1,Xl$1,Ii=L$1(()=>{Ue$1(),fe$1(),Wt$1(),we$1(),ae(),em$1=(d,g,b,et)=>{let st=d.session.pack?2:0,at=H(d.session.backend.glContext.version);return{...g,output:{dims:b.dims,type:b.type,textureType:st},shaderSource:`
     ${et.body}
     void main() {
       vec4 v = ${at.texture2D}(A, TexCoords);
       v = ${et.name}_(v);
       ${at.output} = v;
     }
     `,hasMain:!0}},Ee=(d,g,b,et)=>{let st=d.session.pack?2:0,at={name:b.name,inputTypes:[st],inputNames:["A"],cacheHint:et};return{...at,get:()=>em$1(d,at,g,b)}},Al$1=(d,g)=>[d.run(Ee(d,g[0],Bh()),g)],Pl$1=(d,g)=>[d.run(Ee(d,g[0],Nh()),g)],El$1=(d,g)=>[d.run(Ee(d,g[0],Rh()),g)],Dl$1=(d,g)=>[d.run(Ee(d,g[0],Mh()),g)],_i=(d,g,b)=>[d.run(Ee(d,g[0],xi(b.min,b.max),b.cacheKey),g)],Ll$1=d=>Q$1({min:d.attributes.getFloat("min",br),max:d.attributes.getFloat("max",gr$1)}),Cl$1=(d,g)=>{let b=tm$1(d,g);return _i(d,[g[0]],b)},tm$1=(d,g)=>{if(g.length>=3&&(!d.session.isInitializer(g[1].dataId)||!d.session.isInitializer(g[2].dataId)))throw new Error("dynamic clip attributes are not allowed");let b=g.length>=3?g[1].numberData[0]:br,et=g.length>=3?g[2].numberData[0]:gr$1;return Q$1({min:b,max:et})},Fl$1=(d,g)=>[d.run(Ee(d,g[0],Gh()),g)],$l$1=(d,g)=>[d.run(Ee(d,g[0],Uh()),g)],kl$1=(d,g,b)=>[d.run(Ee(d,g[0],zh(b.alpha),b.cacheKey),g)],Bl$1=d=>Q$1({alpha:d.attributes.getFloat("alpha",1)}),Nl$1=(d,g)=>[d.run(Ee(d,g[0],Vh()),g)],Rl$1=(d,g)=>[d.run(Ee(d,g[0],Wh()),g)],Oi$1=(d,g)=>[d.run(Ee(d,g[0],Hh()),g)],Ml$1=(d,g,b)=>[d.run(Ee(d,g[0],qh(b.alpha),b.cacheKey),g)],Gl$1=d=>Q$1({alpha:d.attributes.getFloat("alpha",.01)}),Ul$1=(d,g)=>[d.run(Ee(d,g[0],jh()),g)],zl$1=(d,g)=>[d.run(Ee(d,g[0],Yh()),g)],Vl$1=(d,g)=>[d.run(Ee(d,g[0],Xh()),g)],Wl$1=(d,g)=>[d.run(Ee(d,g[0],wi()),g)],Hl$1=(d,g)=>[d.run(Ee(d,g[0],vi()),g)],ql$1=(d,g)=>[d.run(Ee(d,g[0],Kh()),g)],jl$1=(d,g)=>[d.run(Ee(d,g[0],Jh()),g)],Yl$1=(d,g)=>[d.run(Ee(d,g[0],Zh()),g)],Xl$1=(d,g)=>[d.run(Ee(d,g[0],Qh()),g)]});function Rt(d){let g;switch(d.activation){case"Relu":g=wi();break;case"Sigmoid":g=vi();break;case"Clip":g=xi(d.clipMin,d.clipMax);break;default:return{activationFunction:"",applyActivation:""}}let b=g.name,et=g.body,st=`value = ${b}_(value);`;return{activationFunction:et,applyActivation:st}}var Nr,xr=L$1(()=>{fe$1(),Ii(),Nr=d=>{let g=d.getString("activation","");if(g==="Clip"){let[b,et]=d.getFloats("activation_params",[br,gr$1]);return{activation:g,clipMax:et,clipMin:b,activationCacheKey:`${g}:${b},${et}`}}return{activation:g,activationCacheKey:g}}}),nm$1,om$1,Kl$1,Jl$1=L$1(()=>{lt$1(),we$1(),ae(),to$1(),xr(),nm$1=(d,g)=>({name:"GroupedConv",inputNames:d?["X","W","Bias"]:["X","W"],inputTypes:d?[0,0,0]:[0,0],cacheHint:g}),om$1=(d,g,b,et)=>{let st=g.length>2?"value += getBias(output_channel);":"",at=g[0].dims.slice(),vt=g[1].dims.slice(),Tt=vt[0]/et.group;ce.verbose("GroupedConv",`autpPad:${et.autoPad}, dilations:${et.dilations}, group:${et.group}, kernelShape:${et.kernelShape}, pads:${et.pads}, strides:${et.strides}`);let Ct=Rr$1(at,vt,et.dilations,et.pads,et.strides),pt=H(d.session.backend.glContext.version),{activationFunction:wt,applyActivation:$t}=Rt(et),Lt=`
  const ivec2 strides = ivec2(${et.strides[0]}, ${et.strides[1]});
  const ivec2 pads = ivec2(${et.pads[0]}, ${et.pads[1]});
  ${wt}
  void main() {
    ivec4 coords = getOutputCoords();
    int batch = coords.x;
    int output_channel = coords.y;
    ivec2 xRCCorner = coords.zw * strides - pads;
    int group_id = output_channel / ${Tt};

    float value = 0.0;
    for (int wInChannel = 0; wInChannel < ${vt[1]}; wInChannel++) {
      int input_channel = group_id * ${vt[1]} + wInChannel;
      for (int wHeight = 0; wHeight < ${vt[2]}; wHeight++) {
        int xHeight = xRCCorner.x + wHeight * ${et.dilations[0]};

        if (xHeight < 0 || xHeight >= ${at[2]}) {
          continue;
        }

        for (int wWidth = 0; wWidth < ${vt[3]}; wWidth++) {
          int xWidth = xRCCorner.y + wWidth * ${et.dilations[1]};
          if (xWidth < 0 || xWidth >= ${at[3]}) {
            continue;
          }

          float xVal = getX(batch, input_channel, xWidth, xHeight);
          float wVal = getW(output_channel, wInChannel, wWidth, wHeight);
          value += xVal*wVal;
        }
      }
    }
    ${st}
    ${$t}
    ${pt.output} = vec4(value, .0, .0, .0);
  }
`;return{...b,output:{dims:Ct,type:g[0].type,textureType:0},shaderSource:Lt,hasMain:!0}},Kl$1=(d,g,b)=>{let et=nm$1(g.length>2,b.cacheKey);return{...et,get:()=>om$1(d,g,et,b)}}}),im$1,am$1,Zl$1,Ql$1=L$1(()=>{we$1(),ae(),Tr(),im$1=d=>({name:"Im2Col (packed)",inputNames:["A"],inputTypes:[2],cacheHint:d}),am$1=(d,g,b,et,st,at)=>{let vt=b.dims,Tt=et.dims,Ct=2,pt=3,wt=st.length,$t=[Tt[1]*Tt[2]*Tt[3],st[2]*st[3]],Lt=Tt[2]*Tt[3],jt=Nt(),Ft=H(d.session.backend.glContext.version),Gt="";for(let qt=0;qt<=1;qt++)for(let Kt=0;Kt<=1;Kt++)Gt+=`
            blockIndex = rc.x + ${Kt};
            pos = rc.y + ${qt};

            if(blockIndex < ${$t[1]} && pos < ${$t[0]}) {
              offsetY = int(blockIndex / (${st[wt-1]})) * ${at.strides[0]} -
                ${at.pads[0]};
              d0 = offsetY + ${at.dilations[0]} * (imod(pos, ${Lt}) / ${Tt[2]});

              if(d0 < ${vt[Ct]} && d0 >= 0) {
                offsetX = imod(blockIndex, ${st[wt-1]}) * ${at.strides[1]} -
                  ${at.pads[1]};
                d1 = offsetX + ${at.dilations[1]} * imod(imod(pos, ${Lt}), ${Tt[2]});

                if(d1 < ${vt[pt]} && d1 >= 0) {

                  ch = int(float(pos)/ ${Lt}.);
                    innerDims = vec2(d0, d1);
                    result[${qt*2+Kt}] = getChannel(
                      getA(0, ch, int(innerDims.x),
                      int(innerDims.y)), innerDims);
                }
              }
            }

          `;let Ht=`
      ${jt}

      void main() {
        ivec2 rc = getOutputCoords();
          vec4 result = vec4(0.0);
          int blockIndex, pos, offsetY, d0, offsetX, d1, ch;
          vec2 innerDims;
          ${Gt}
          ${Ft.output} = result;
      }
            `;return{...g,output:{dims:$t,type:b.type,textureType:2},shaderSource:Ht,hasMain:!0}},Zl$1=(d,g,b,et,st)=>{let at=im$1(st.cacheKey);return{...at,get:()=>am$1(d,at,g,b,et,st)}}});function um$1(d,g,b){let et=g[0].dims,st=g[1].dims,at=Ze$1.calcShape(et,st,!0);if(!at)throw new Error("Can't use matmul on the given tensors");let vt=Qe(at.length),Tt=Dt$1(),{activationFunction:Ct,applyActivation:pt}=Rt(b),wt=g.length>2,$t=wt?"value += getBiasForMatmul();":"",Lt=wt?`${Ai(vt,Tt,g[2].dims,at,!1)}`:"",jt=at.length,Ft=et.length,Gt=st.length,Ht=et[et.length-1],qt=`
    ${Ct}
    ${Lt}
    float process(int indices[${jt}]) {
        int a[${Ft}];
        int b[${Gt}];
        bcastMatmulIndices_A(indices, a);
        bcastMatmulIndices_B(indices, b);

        float value;
        for (int k=0; k<${Ht}; ++k) {
            a[${Ft-1}] = k;
            b[${Gt-2}] = k;
            value += _A(a) * _B(b);
        }
        ${$t}
        ${pt}
        return value;
    }`;return{...d,output:{dims:at,type:g[0].type,textureType:0},shaderSource:qt}}function Si(d,g){let b=sm$1(d.length>2,g.activationCacheKey);return{...b,get:()=>um$1(b,d,g)}}function Ai(d,g,b,et,st){let at="",vt=b.length,Tt=et.length,Ct=Tt-vt;Tt<2&&vt>0?at="coords":at=b.map((Lt,jt)=>`coords.${g[jt+Ct]}`).join(", ");let pt=Ze$1.getBroadcastDims(b,et).map(Lt=>`coords.${g[Lt+Ct]} = 0;`).join(`
`),wt=U$2.size(b)===1,$t="vec4(outputValue.xx, outputValue.yy)";return wt&&($t="vec4(outputValue.x)"),st?`
vec4 getBiasForMatmul() {
  ${d} coords = getOutputCoords();
  ${pt}
  vec4 outputValue = getBias(${at});
  return ${$t};
}`:`
float getBiasForMatmul() {
  ${d} coords = getOutputCoords();
  ${pt}
  return getBias(coords.x);
}`}var ef$1,tf$1,sm$1,lm$1,ro$1=L$1(()=>{fe$1(),ae(),Bt$1(),xr(),Pi$1(),ef$1=(d,g,b)=>(lm$1(g),d.session.pack?[d.run(no$1(d,g,b),g)]:[d.run(Si(g,b),g)]),tf$1=d=>Nr(d.attributes),sm$1=(d,g)=>({name:"MatMul",inputNames:d?["A","B","Bias"]:["A","B"],inputTypes:d?[0,0,0]:[0,0],cacheHint:g}),lm$1=d=>{if(!d||d.length!==2)throw new Error("MatMul requires 2 inputs.");if(d[0].dims[d[0].dims.length-1]!==d[1].dims[d[1].dims.length-2])throw new Error("shared dimension does not match.");if(d[0].type!=="float32"&&d[0].type!=="float64"||d[1].type!=="float32"&&d[1].type!=="float64")throw new Error("inputs should be float type");if(d[0].type!==d[1].type)throw new Error("inputs types should match")}});function pm$1(d,g,b,et){let st=[],at=[],vt=b[0].dims,Tt=b[1].dims,Ct=vt.length,pt=Tt.length,wt=et.length,$t=wt-Ct,Lt=wt-pt;st=vt.map((Kt,rr)=>`coords.${g[rr+$t]}`),st[Ct-1]="i*2",st.join(", "),at=Tt.map((Kt,rr)=>`coords.${g[rr+Lt]}`),at[pt-2]="i*2",at.join(", ");let jt=Ze$1.getBroadcastDims(vt,et),Ft=Ze$1.getBroadcastDims(Tt,et),Gt=jt.map(Kt=>`coords.${g[Kt+$t]} = 0;`).join(`
`),Ht=Ft.map(Kt=>`coords.${g[Kt+Lt]} = 0;`).join(`
`),qt=`int lastDim = coords.${g[wt-1]};
  coords.${g[wt-1]} = coords.${g[wt-2]};
  coords.${g[wt-2]} = lastDim;`;return`
vec4 getAAtOutCoordsMatmul(int i) {
  ${d} coords = getOutputCoords();
  ${qt}
  ${Gt}
  vec4 outputValue = getA(${st});
  return outputValue;
}

vec4 getBAtOutCoordsMatmul(int i) {
  ${d} coords = getOutputCoords();
  ${qt}
  ${Ht}
  vec4 outputValue = getB(${at});
  return outputValue;
}`}function dm$1(d,g){let b="";for(let et=0;et<g-2;et++)b+=`rc.${d[et]}, `;return b+=`rc.${d[g-2]}, i*2`,b}function hm$1(d,g){let b="";for(let et=0;et<g-2;et++)b+=`rc.${d[et]}, `;return b+=`i*2, rc.${d[g-1]}`,b}var fm$1,cm$1,no$1,Pi$1=L$1(()=>{fe$1(),we$1(),ae(),Bt$1(),xr(),ro$1(),fm$1=(d,g)=>({name:"MatMul (packed)",inputNames:d?["A","B","Bias"]:["A","B"],inputTypes:d?[2,2,2]:[2,2],cacheHint:g}),cm$1=(d,g,b,et)=>{let st=b.length>2,at=st?"value += getBiasForMatmul();":"",vt=b[0].dims,Tt=b[1].dims,Ct=Ze$1.calcShape(vt,Tt,!0),pt=!U$2.areEqual(b[0].dims,b[1].dims);if(!Ct)throw new Error("Can't use matmul on the given tensors");let wt=vt[vt.length-1],$t=Math.ceil(wt/2),Lt=vt.length,jt=Tt.length,Ft=H(d.session.backend.glContext.version),Gt=Qe(Ct.length),Ht=Ct.length,qt=Dt$1(),{activationFunction:Kt,applyActivation:rr}=Rt(et),ir=st?`${Ai(Gt,qt,b[2].dims,Ct,!0)}`:"",or=pt?`${pm$1(Gt,qt,b,Ct)}`:"",jr=pt?"getAAtOutCoordsMatmul(i)":`getA(${dm$1(qt,Lt)})`,qr=pt?"getBAtOutCoordsMatmul(i)":`getB(${hm$1(qt,jt)})`,Yr=pt?"":`${Gt} rc =
          getOutputCoords(); int lastDim = rc.${qt[Ht-1]}; rc.${qt[Ht-1]} =
          rc.${qt[Ht-2]}; rc.${qt[Ht-2]} = lastDim;
      `,vn=`
            ${or}
            ${ir}
            ${Kt}
            void main() {
              ${Yr}

              vec4 value = vec4(0);
              for (int i = 0; i < ${$t}; i++) {
                vec4 a = ${jr};
                vec4 b = ${qr};

                value += (a.rrbb * b.rgrg);
                value += (a.ggaa * b.baba);
              }
              ${at}
              ${rr}
              ${Ft.output} = value;
            }`;return{...g,output:{dims:Ct,type:b[0].type,textureType:2},shaderSource:vn,hasMain:!0}},no$1=(d,g,b)=>{let et=fm$1(g.length>2,b.activationCacheKey);return{...et,get:()=>cm$1(d,et,g,b)}}}),rf$1,nf$1=L$1(()=>{to$1(),Ql$1(),Pi$1(),rf$1=(d,g,b)=>{let et=g[0].dims,st=g[1].dims,at=Rr$1(et,st,b.dilations,b.pads,b.strides),vt=d.run(Zl$1(d,g[0],g[1],at,b),[g[0]]),Tt=d.reshapePacked(g[1],[st[0],st[1]*st[2]*st[3]]),Ct=g.length===3?[Tt,vt,g[2]]:[Tt,vt],pt=d.run(no$1(d,Ct,b),Ct);return d.reshapePacked(pt,at)}}),mm$1,bm$1,of$1,Ei,Di$1=L$1(()=>{ae(),mm$1=d=>({name:"Im2Col",inputNames:["X"],inputTypes:[0],cacheHint:d}),bm$1=(d,g,b,et,st,at)=>{let vt=b.dims,Tt=et.dims,Ct=st.length,pt=Ei(vt,Tt,st,4),wt=`
        const int XC = ${vt[1]};
        const int XH = ${vt[2]};
        const int XW = ${vt[3]};
        const int KH = ${at.kernelShape[0]};
        const int KW = ${at.kernelShape[1]};
        const int dilationH = ${at.dilations[0]};
        const int dilationW = ${at.dilations[1]};
        const int strideH = ${at.strides[0]};
        const int strideW = ${at.strides[1]};
        const int padH = ${at.pads[0]};
        const int padW = ${at.pads[1]};
        const int KHKW = KH*KW;
        const int XCKHKW = XC * KHKW;
        const int outputChannels = 4;
        vec4 process(int indices[${Ct}]) {
          int b  = indices[0]; // batch size
          int oh = indices[1] * strideH - padH; //output height
          int ow = indices[2] * strideW - padW; //output width
          int p = indices[3] * outputChannels; //patch
          vec4 value = vec4(0.0);
          for(int i=0; i < outputChannels; ++i) {
            if(p < XCKHKW) {
              int patchC = p / KHKW;
              int patchH = (p - patchC*KHKW) / KW;
              int patchW = (p - patchC*KHKW) - patchH * KW;
              int xh2 = oh + patchH * dilationH;
              int xw2 = ow + patchW * dilationW;
              int x[${vt.length}];
              x[0] = b;
              x[1] = patchC;
              x[2] = xh2;
              x[3] = xw2;
              if(xh2 >= 0 &&
                  xh2 < XH &&
                  xw2 >= 0 &&
                  xw2 < XW) {
                value[i] = _X(x);
              }
            }
            ++p;
          }
          return value;
        }
        `;return{...g,output:{dims:pt,type:b.type,textureType:4},shaderSource:wt}},of$1=(d,g,b,et,st)=>{let at=mm$1(st.cacheKey);return{...at,get:()=>bm$1(d,at,g,b,et,st)}},Ei=(d,g,b,et=4)=>[b[0],b[2],b[3],Math.ceil(d[1]*g[2]*g[3]/et)]}),gm$1,ym$1,af$1,sf$1=L$1(()=>{fe$1(),we$1(),ae(),xr(),Di$1(),gm$1=(d,g)=>({name:"ConvDotProduct",inputNames:d?["Im2Col","K","B"]:["Im2Col","K"],inputTypes:d?[0,4,0]:[0,4],cacheKey:g.activationCacheKey}),ym$1=(d,g,b,et,st)=>{let at=b[0].dims,vt=b[1].dims,Tt=[vt[0],Math.ceil(at[1]*vt[2]*vt[3]/4)],Ct=Ei(at,vt,et),[pt,wt]=d.calculateTextureWidthAndHeight(Tt,4),$t=U$2.computeStrides(Ct),[Lt,jt]=d.calculateTextureWidthAndHeight(Ct,4),Ft=et.length,Gt=b.length<3?"0.0":"_B(b)",Ht=Math.ceil(at[1]*vt[2]*vt[3]/4),{activationFunction:qt,applyActivation:Kt}=Rt(st),rr=H(d.session.backend.glContext.version),ir=`
${qt}
float process(int indices[${Ft}]) {
  int b[1];
  b[0] = indices[1];
  int im2col[4];
  im2col[0] = indices[0];
  im2col[1] = indices[2];
  im2col[2] = indices[3];
  int im2colOffset = im2col[0] * ${$t[0]} + im2col[1] * ${$t[1]} + im2col[2] * ${$t[2]};
  int kernelOffset = indices[1] * ${Tt[1]};
  float value = ${Gt};
  for (int i = 0; i < ${Ht}; ++i) {
    vec2 im2colCoords = offsetToCoords(im2colOffset, ${Lt}, ${jt});
    vec2 kernelCoords = offsetToCoords(kernelOffset, ${pt}, ${wt});
    value += dot(${rr.texture2D}(Im2Col, im2colCoords), ${rr.texture2D}(K, kernelCoords));
    ++im2colOffset;
    ++kernelOffset;
  }
  ${Kt}
  return value;
}`;return{...g,output:{dims:et,type:b[0].type,textureType:0},shaderSource:ir}},af$1=(d,g,b,et)=>{let st=gm$1(g.length>2,et);return{...st,get:()=>ym$1(d,st,g,b,et)}}}),Rr$1,Li$1,Tm$1,xm$1,wm$1,vm,Ci,_m$1,to$1=L$1(()=>{Ue$1(),fe$1(),Jl$1(),nf$1(),sf$1(),xr(),Di$1(),ro$1(),Rr$1=(d,g,b,et,st)=>{let at=d[0],vt=d.slice(2),Tt=vt.length,Ct=g[0],pt=g.slice(2).map(($t,Lt)=>$t+($t-1)*(b[Lt]-1)),wt=vt.map(($t,Lt)=>$t+et[Lt]+et[Lt+Tt]).map(($t,Lt)=>Math.floor(($t-pt[Lt]+st[Lt])/st[Lt]));return[at,Ct].concat(...wt)},Li$1=(d,g,b)=>(_m$1(g,b),Tm$1(d,g,b)),Tm$1=(d,g,b)=>{let et=vm(b,g),st=d.session.pack,at=et.kernelShape[0]===1&&et.kernelShape[1]===1;return et.group>1?[d.run(Kl$1(d,g,et),g)]:at&&st?[xm$1(d,g,et)]:st&&g[0].dims.length===4&&g[0].dims[0]===1&&!at?[rf$1(d,g,et)]:[wm$1(d,g,et)]},xm$1=(d,g,b)=>{let et=g[0].dims,st=g[1].dims,at=Rr$1(et,st,b.dilations,b.pads,b.strides),vt=d.reshapeUnpacked(g[0],[et[1],et[2]*et[3]]),Tt=d.reshapeUnpacked(g[1],[st[0],st[1]]),Ct=g.length>2?[Tt,vt,g[2]]:[Tt,vt],pt=d.run(Si(Ct,b),Ct);return d.reshapeUnpacked(pt,at)},wm$1=(d,g,b)=>{let et=g[0].dims,st=g[1].dims,at=Rr$1(et,st,b.dilations,b.pads,b.strides),vt=d.run(of$1(d,g[0],g[1],at,b),[g[0]]),Tt=g.length===3?[vt,g[1],g[2]]:[vt,g[1]];return d.run(af$1(d,g,at,b),Tt)},vm=(d,g)=>{let b=d.kernelShape.slice();if(d.kernelShape.length===0)for(let at=2;at<g[1].dims.length;++at)b.push(g[1].dims[at]);let et=d.pads.slice();mr$1.adjustPadsBasedOnAutoPad(g[0].dims,d.strides,d.dilations,b,et,d.autoPad);let st=Object.assign({},d);return Object.assign(st,{kernelShape:b,pads:et,cacheKey:d.cacheKey}),st},Ci=d=>{let g=d.attributes,b=Nr(g),et=g.getString("auto_pad","NOTSET"),st=g.getInts("dilations",[1,1]),at=g.getInt("group",1),vt=g.getInts("kernel_shape",[]),Tt=g.getInts("pads",[0,0,0,0]),Ct=g.getInts("strides",[1,1]);return Q$1({autoPad:et,dilations:st,group:at,kernelShape:vt,pads:Tt,strides:Ct,...b})},_m$1=(d,g)=>{if(!d||d.length!==2&&d.length!==3)throw new Error("Conv requires 2 or 3 inputs");if(d[0].dims.length!==4||d[1].dims.length!==4)throw new Error("currently only support 2-dimensional conv");let b=d[0].dims[1],et=d[1].dims[1]*g.group;if(b!==et)throw new Error("FILTER_IN_CHANNEL should be equal to DATA_CHANNEL");if(d.length===3&&(d[2].dims.length!==1||d[1].dims[0]!==d[2].dims[0]))throw new Error("invalid bias");let st=d[0].dims.length-2;if(g.dilations.length!==st)throw new Error(`dilations should be ${st}D`);if(g.strides.length!==st)throw new Error(`strides should be ${st}D`);if(g.pads.length!==st*2)throw new Error(`pads should be ${st*2}D`);if(g.kernelShape.length!==0&&g.kernelShape.length!==d[1].dims.length-2)throw new Error("invalid kernel shape");if(d[0].type!=="float32"||d[1].type!=="float32")throw new Error("Conv input(X,W) should be float tensor");if(d.length===3&&d[2].type!=="float32")throw new Error("Conv input(bias) should be float tensor")}}),Om$1,Im$1,Sm$1,uf$1,Am$1,Pm$1,Em$1,Dm$1,Lm$1,Cm$1,lf$1,Fm$1,ff$1=L$1(()=>{Ue$1(),we$1(),ae(),xr(),Om$1=(d,g,b,et,st,at)=>(d-1)*g+b+(et-1)*st+1-at,Im$1=(d,g,b,et,st)=>{let at=Math.floor(d/2);g==="SAME_UPPER"?(b[et]=at,b[st]=d-at):g==="SAME_LOWER"&&(b[et]=d-at,b[st]=at)},Sm$1=(d,g,b,et,st,at,vt,Tt)=>{let Ct=d.length-2,pt=Tt.length===0;for(let wt=0;wt<Ct;++wt){let $t=pt?d[wt+2]*at[wt]:Tt[wt],Lt=Om$1(d[wt+2],at[wt],st[wt],g[wt],b[wt],$t);Im$1(Lt,et,st,wt,wt+Ct),pt&&Tt.push(at[wt]*(d[wt+2]-1)+vt[wt]+(g[wt]-1)*b[wt]+1-st[wt]-st[wt+Ct])}},uf$1=(d,g,b)=>(Fm$1(g,b),Am$1(d,g,b)),Am$1=(d,g,b)=>{let et=Cm$1(b,g);return[Lm$1(d,g,et)]},Pm$1=(d,g)=>({name:"ConvTranspose",inputNames:d?["X","W","B"]:["X","W"],inputTypes:d?[0,0,0]:[0,0],cacheHint:g}),Em$1=(d,g,b,et)=>{let st=g.length>2?"getB(output_channel)":"0.0",at=g[0].dims,vt=g[1].dims,Tt=vt[1],Ct=vt[0]/et.group,pt=[g[0].dims[0],g[1].dims[1]*et.group,...et.outputShape],wt=H(d.session.backend.glContext.version),{activationFunction:$t,applyActivation:Lt}=Rt(et),jt=`
  const ivec2 strides = ivec2(${et.strides[0]}, ${et.strides[1]});
  const ivec2 pads = ivec2(${et.pads[0]}, ${et.pads[1]});
  ${$t}
  void main() {
    ivec4 coords = getOutputCoords();
    int batch = coords.x;
    int output_channel = coords.y;

    ivec2 loc = coords.zw + pads;

    int group_id = output_channel / ${Tt};
    int wOutChannel = output_channel - group_id * ${Tt};

    float value = ${st};
    for (int inChannelOffset = 0; inChannelOffset < ${Ct}; inChannelOffset++) {
      int input_channel = group_id * ${Ct} + inChannelOffset;
      for (int wWOff = 0; wWOff < ${vt[2]}; wWOff++) {
        for (int wHOff = 0; wHOff < ${vt[3]}; wHOff++) {
          ivec2 wOff = ivec2(wWOff * ${et.dilations[0]}, wHOff * ${et.dilations[1]});
          ivec2 wLoc = loc - wOff;
          ivec2 wLocIn = wLoc / strides;
          if (
            wLocIn * strides == wLoc &&
            wLocIn.x >= 0 && wLocIn.x < ${at[2]} &&
            wLocIn.y >= 0 && wLocIn.y < ${at[3]}
          ) {
            float xVal = getX(batch, input_channel, wLocIn.y, wLocIn.x);
            float wVal = getW(input_channel, wOutChannel, wHOff, wWOff);
            value += xVal * wVal;
          }
        }
      }
    }
    ${Lt}
    ${wt.output} = vec4(value, .0, .0, .0);
  }
`;return{...b,output:{dims:pt,type:g[0].type,textureType:0},shaderSource:jt,hasMain:!0}},Dm$1=(d,g,b)=>{let et=Pm$1(g.length>2,b.cacheKey);return{...et,get:()=>Em$1(d,g,et,b)}},Lm$1=(d,g,b)=>d.run(Dm$1(d,g,b),g),Cm$1=(d,g)=>{let b=d.kernelShape.slice();if(d.kernelShape.length===0)for(let Tt=2;Tt<g[1].dims.length;++Tt)b.push(g[1].dims[Tt]);let et=d.pads.slice(),st=d.outputShape.slice(),at=g[0].dims;Sm$1(at,b,d.dilations,d.autoPad,et,d.strides,d.outputPadding,st);let vt=Object.assign({},d);return Object.assign(vt,{kernelShape:b,pads:et,outputShape:st,cacheKey:d.cacheKey}),vt},lf$1=d=>{let g=d.attributes,b=Nr(g),et=g.getString("auto_pad","NOTSET"),st=g.getInts("dilations",[1,1]),at=g.getInt("group",1),vt=g.getInts("kernel_shape",[]),Tt=g.getInts("output_padding",[0,0]),Ct=g.getInts("output_shape",[]),pt=g.getInts("pads",[0,0,0,0]),wt=g.getInts("strides",[1,1]);return Q$1({autoPad:et,dilations:st,group:at,kernelShape:vt,outputPadding:Tt,outputShape:Ct,pads:pt,strides:wt,...b})},Fm$1=(d,g)=>{if(!d||d.length!==2&&d.length!==3)throw new Error("Conv requires 2 or 3 inputs");if(d[0].dims.length!==4||d[1].dims.length!==4)throw new Error("currently only support 2-dimensional conv");let b=d[0].dims[1],et=d[1].dims[0];if(b!==et)throw new Error("FILTER_IN_CHANNEL should be equal to DATA_CHANNEL");let st=d[1].dims[1]*g.group;if(d.length===3&&(d[2].dims.length!==1||d[2].dims[0]!==st))throw new Error("invalid bias");let at=d[0].dims.length-2;if(g.dilations.length!==at)throw new Error(`dilations should be ${at}D`);if(g.strides.length!==at)throw new Error(`strides should be ${at}D`);if(g.pads.length!==at*2)throw new Error(`pads should be ${at*2}D`);if(g.outputPadding.length!==at)throw new Error(`output_padding should be ${at}D`);if(g.kernelShape.length!==0&&g.kernelShape.length!==d[1].dims.length-2)throw new Error("invalid kernel shape");if(g.outputShape.length!==0&&g.outputShape.length!==d[0].dims.length-2)throw new Error("invalid output shape");if(d[0].type!=="float32"||d[1].type!=="float32")throw new Error("ConvTranspose input(X,W) should be float tensor");if(d.length===3&&d[2].type!=="float32")throw new Error("ConvTranspose input(bias) should be float tensor")}}),cf,wr,pf$1,$m$1,df,km$1,Bm$1,Nm$1,oo$1=L$1(()=>{Ue$1(),fe$1(),ae(),cf={name:"Transpose",inputNames:["A"],inputTypes:[0]},wr=(d,g,b)=>(Nm$1(g),[d.run({...cf,cacheHint:b.cacheKey,get:()=>$m$1(d,g[0],b.perm)},g)]),pf$1=d=>Q$1({perm:d.attributes.getInts("perm",[])}),$m$1=(d,g,b)=>{let et=g.dims;b=df(et,b);let st=km$1(et,b),at=et.length,vt=`
      ${Bm$1("perm",b,at)}
      float process(int indices[${at}]) {
        int a[${at}];
        perm(a, indices);
        return _A(a);
      }`;return{...cf,output:{dims:st,type:g.type,textureType:0},shaderSource:vt}},df=(d,g)=>(g&&g.length!==d.length&&(g=[...d.keys()].reverse()),g),km$1=(d,g)=>(g=df(d,g),U$2.sortBasedOnPerm(d,g)),Bm$1=(d,g,b)=>{let et=[];et.push(`void ${d}(out int a[${b}], int src[${b}]) {`);for(let st=0;st<b;++st)et.push(`	a[${g[st]}]=src[${st}];`);return et.push("	}"),et.join(`
`)},Nm$1=d=>{if(!d||d.length!==1)throw new Error("Transpose requires 1 input.");if(d[0].type!=="float32"&&d[0].type!=="float64")throw new Error("input should be float tensor")}}),hf$1,mf$1,Rm$1,bf=L$1(()=>{oo$1(),hf$1=(d,g,b)=>{Rm$1(g);let et=b.blocksize,st=et*et,at=b.mode==="DCR"?[0,3,4,1,5,2]:[0,1,4,2,5,3],vt=b.mode==="DCR"?[g[0].dims[0],et,et,g[0].dims[1]/st,g[0].dims[2],g[0].dims[3]]:[g[0].dims[0],g[0].dims[1]/st,et,et,g[0].dims[2],g[0].dims[3]],Tt=d.reshapeUnpacked(g[0],vt),Ct={perm:at,cacheKey:`${at}`},[pt]=wr(d,[Tt],Ct),wt=[g[0].dims[0],g[0].dims[1]/st,g[0].dims[2]*et,g[0].dims[3]*et];return[d.reshapeUnpacked(pt,wt)]},mf$1=d=>{let g=d.attributes.getInt("blocksize");if(g<1)throw new Error(`blocksize must be >= 1, but got : ${g} for DepthToSpace`);let b=d.attributes.getString("mode","DCR");if(b!=="DCR"&&b!=="CRD")throw new Error(`unrecognized mode: ${b} for DepthToSpace`);return{mode:b,blocksize:g}},Rm$1=d=>{if(d.length!==1)throw new Error(`DepthToSpace expect 1 inputs, but got ${d.length}`);if(d[0].type==="string"||d[0].dims.length!==4)throw new TypeError("DepthToSpace input should be a 4-D numeric tensor")}}),gf,yf,Mm$1,Tf=L$1(()=>{fe$1(),gf=(d,g,b)=>{Mm$1(g,b);let et=U$2.flattenShape(g[0].dims,b);return[d.reshapeUnpacked(g[0],et)]},yf=d=>d.attributes.getInt("axis",1),Mm$1=(d,g)=>{if(!d||d.length!==1)throw new Error("Flatten requires 1 input.");let b=d[0].dims.length;if(b===0)throw new Error("scalar tensor is not supported.");if(g<-b||g>b)throw new Error("Invalid axis");if(d[0].type==="string")throw new Error("string tensor is not supported.")}}),Qt,pn=L$1(()=>{Qt=["float32","float64","int32","int16","int8","uint16","uint32","uint8"]}),xf,wf,Gm$1,Um$1,zm$1,Vm$1,vf=L$1(()=>{Ue$1(),pn(),fe$1(),ae(),xf=(d,g,b)=>(Vm$1(g,b.axis),[d.run(zm$1(d,g,b),g)]),wf=d=>Q$1({axis:d.attributes.getInt("axis",0)}),Gm$1={name:"Gather",inputNames:["A","B"],inputTypes:[0,0]},Um$1=(d,g,b,et)=>{let st=b[0].dims.slice(),at=b[1].dims.slice(),vt=new Array(st.length+at.length-1);et=U$2.normalizeAxis(et,st.length);let Tt=[];for(let Lt=0;Lt<vt.length;Lt++)Lt<et?(vt[Lt]=st[Lt],Tt.push(`inputIdx[${Lt}] = outputIdx[${Lt}];`)):Lt<et+at.length?(vt[Lt]=at[Lt-et],Tt.push(`indexDataIdx[${Lt-et}] = outputIdx[${Lt}];`)):(vt[Lt]=st[Lt-at.length+1],Tt.push(`inputIdx[${Lt-at.length+1}] = outputIdx[${Lt}];`));let Ct=vt.length||1,pt=st.length,wt=at.length||1,$t=`
      float process(int outputIdx[${Ct}]) {
        int inputIdx[${pt}];
        int indexDataIdx[${wt}];
        indexDataIdx[0] = 0;
        ${Tt.join(`
        `)}
        int idx = int(_B(indexDataIdx));
        inputIdx[${et}] = idx < 0 ? idx + ${st[et]} : idx;
        return _A(inputIdx);
      }`;return{...g,output:{dims:vt,type:b[0].type,textureType:0},shaderSource:$t}},zm$1=(d,g,b)=>{let et={...Gm$1,cacheHint:b.cacheKey};return{...et,get:()=>Um$1(d,et,g,b.axis)}},Vm$1=(d,g)=>{if(!d||d.length!==2)throw new Error("Gather requires 2 inputs.");let b=d[0].dims.length;if(b<1)throw new Error("Invalid input shape.");if(g<-b||g>b-1)throw new Error("Invalid axis.");if(Qt.indexOf(d[0].type)===-1)throw new Error("Invaid input type.");if(d[1].type!=="int32"&&d[1].type!=="int16")throw new Error("Invaid input type.")}}),Fi$1,_f,Of,If,Wm$1,Hm$1,qm$1,Sf=L$1(()=>{Ue$1(),fe$1(),ae(),Fi$1=(d,g,b)=>(qm$1(g,b),[d.run(Wm$1(g,b),g)]),_f=(d,g)=>{let b=d.attributes.getInt("transA",0)!==0,et=d.attributes.getInt("transB",0)!==0,st=d.attributes.getFloat("alpha",1),at=d.attributes.getFloat("beta",1);return Q$1({transA:b,transB:et,alpha:st,beta:at,isOptionalC:g})},Of=d=>_f(d,!1),If=d=>_f(d,!0),Wm$1=(d,g)=>{let b={name:"Gemm",inputNames:d.length===3?["A","B","C"]:["A","B"],inputTypes:d.length===3?[0,0,0]:[0,0],key:g.cacheKey};return{...b,get:()=>Hm$1(b,d,g)}},Hm$1=(d,g,b)=>{let et=g[0].dims.slice(),st=g[1].dims.slice(),[at,vt]=jn$1.getShapeOfGemmResult(et,b.transA,st,b.transB,g.length===3?g[2].dims:void 0),Tt=[at,vt];if(!Tt)throw new Error("Can't use gemm on the given tensors");let Ct=et[et.length-1],pt="";b.transA&&(Ct=et[0]),b.transA&&b.transB?pt="value += _A_T(a) * _B_T(b);":b.transA&&!b.transB?pt="value += _A_T(a) * _B(b);":!b.transA&&b.transB?pt="value += _A(a) * _B_T(b);":!b.transA&&!b.transB&&(pt="value += _A(a) * _B(b);");let wt=Tt.length,$t=g.length===3?`int c[${g[2].dims.length}];`:"",Lt=g.length===3?"bcastIndices_C(indices, c);":"",jt=g.length===3?"value += beta * _C(c);":"",Ft=`
      float process(int indices[${wt}]) {
          int a[${wt}];
          int b[${wt}];
          ${$t}

          copyVec(indices, a);
          copyVec(indices, b);
          ${Lt}

          float value = 0.0;
          for (int k=0; k<${Ct}; ++k) {
              a[${wt-1}] = k;
              b[${wt-2}] = k;
              ${pt}
          }

          value = value * alpha;
          ${jt}
          return value;
      }`;return{...d,output:{dims:Tt,type:g[0].type,textureType:0},variables:[{name:"alpha",type:"float",data:b.alpha},{name:"beta",type:"float",data:b.beta}],shaderSource:Ft}},qm$1=(d,g)=>{if(!d)throw new Error("Input is missing");if(g.isOptionalC&&(d.length<2||d.length>3))throw new Error("Invaid input shape.");if(!g.isOptionalC&&d.length!==3)throw new Error("Gemm requires 3 inputs");if(d.length===3&&d[2].dims.length!==1&&d[2].dims.length!==2)throw new Error("Invalid input shape of C");if(d[0].type!=="float32"&&d[0].type!=="float64"||d[1].type!=="float32"&&d[1].type!=="float64"||d.length===3&&d[2].type!=="float32"&&d[2].type!=="float64")throw new Error("Invalid input type.");if(d[0].type!==d[1].type||d.length===3&&d[0].type!==d[2].type)throw new Error("Input types are mismatched")}}),Af,Pf,jm$1,Ym$1,Xm$1,Km$1,Jm$1,Ef=L$1(()=>{Ue$1(),ae(),Af=(d,g,b)=>(Jm$1(g),[d.run(Xm$1(d,g,b),g)]),Pf=d=>{let g=d.attributes.getFloat("scale"),b=d.attributes.getFloats("bias");return Q$1({scale:g,bias:b})},jm$1={name:"ImageScaler",inputNames:["X"],inputTypes:[0]},Ym$1=(d,g,b,et)=>{let st=b[0].dims.slice(),at=st.length,vt=`
      ${Km$1(et.bias.length)}
      float process(int indices[${at}]) {
        return _X(indices) * scale + getBias(bias, indices[1]);
      }`;return{...g,output:{dims:st,type:b[0].type,textureType:0},variables:[{name:"bias",type:"float",arrayLength:et.bias.length,data:et.bias},{name:"scale",type:"float",data:et.scale}],shaderSource:vt}},Xm$1=(d,g,b)=>{let et={...jm$1,cacheHint:b.cacheKey};return{...et,get:()=>Ym$1(d,et,g,b)}},Km$1=d=>{let g=[`float getBias(float bias[${d}], int channel) {`];for(let b=0;b<d;++b)b===0?g.push(`	if (channel == ${b}) { return bias[${b}]; }`):b===d-1?g.push(`	else { return bias[${b}]; }`):g.push(`	else if (channel == ${b}) { return bias[${b}]; }`);return g.push("	}"),g.join(`
`)},Jm$1=d=>{if(!d||d.length!==1)throw new Error("ImageScaler requires 1 input.");if(d[0].dims.length!==4)throw new Error("Invalid input shape.");if(d[0].type!=="float32"&&d[0].type!=="float64")throw new Error("Invalid input type.")}}),Lf,Cf,Df,Zm$1,Qm$1,eb,tb,rb,nb,Ff=L$1(()=>{we$1(),ae(),Lf=(d,g,b)=>{nb(g);let et=d.run(Qm$1(g[0]),g);return[d.run(rb(d,g[0],b,et.dims),[g[0],et,g[1],g[2]])]},Cf=d=>d.attributes.getFloat("epsilon",1e-5),Df={name:"InstanceNormalization_MeanAndVariance",inputNames:["X"],inputTypes:[0]},Zm$1=(d,g)=>{let b=g.dims.slice(),et=b[1],st=b[2]*b[3],at=[b[0],et],vt=`
      vec4 process(int[2] indices) {
        vec4 v = vec4(0.0);
        int a[4];
        a[0] = indices[0];
        a[1] = indices[1];
        float temp = 0.0;
        for(int a2=0; a2<${b[2]}; a2++) {
          a[2] = a2;
          for(int a3=0; a3<${b[3]}; a3++) {
            a[3] = a3;
            float x = _X(a);
            temp += x;
          }
        }
        float mean = temp / float(${st});
        temp = 0.0;
        for(int a2=0; a2<${b[2]}; a2++) {
          a[2] = a2;
          for(int a3=0; a3<${b[3]}; a3++) {
            a[3] = a3;
            float x = _X(a);
            temp += (x - mean) * (x - mean);
          }
        }
        v.r = mean;
        v.g = temp / float(${st});

        return v;
      }`;return{...d,output:{dims:at,type:g.type,textureType:4},shaderSource:vt}},Qm$1=d=>({...Df,get:()=>Zm$1(Df,d)}),eb={name:"InstanceNormalization_ComputeOutput",inputNames:["X","MeanAndVariance","Scale","B"],inputTypes:[0,4,0,0]},tb=(d,g,b,et,st)=>{let at=H(d.session.backend.glContext.version),[vt,Tt]=d.calculateTextureWidthAndHeight(st,4),[Ct,pt]=[vt/4,Tt],wt=`
      vec4 get_MeanAndVariance(int[2] mv) {
        int offset = indicesToOffset_MeanAndVariance(mv);
        vec2 coords = offsetToCoords(offset, ${Ct}, ${pt});
        return ${at.texture2D}(MeanAndVariance, coords);
      }

      float process(int[4] indices) {
        int mv[2];
        mv[0] = indices[0];
        mv[1] = indices[1];
        vec4 mean_and_variance = get_MeanAndVariance(mv);
        float mean = mean_and_variance.r;
        float variance = mean_and_variance.g;

        int sb[1];
        sb[0] = indices[1];
        float scale = _Scale(sb);
        float b = _B(sb);

        return scale * (_X(indices) - mean) / sqrt(variance + epsilon) + b;
      }`;return{...g,output:{dims:b.dims,type:b.type,textureType:0},variables:[{name:"epsilon",type:"float",data:et}],shaderSource:wt}},rb=(d,g,b,et)=>{let st={...eb,cacheHint:`${b}`};return{...st,get:()=>tb(d,st,g,b,et)}},nb=d=>{if(!d||d.length!==3)throw new Error("InstanceNormalization requires 3 inputs.");let g=d[0],b=d[1],et=d[2];if(g.dims.length<3||b.dims.length!==1||et.dims.length!==1)throw new Error("Invalid input shape.");if(b.dims[0]!==g.dims[1]||et.dims[0]!==g.dims[1])throw new Error("Input shapes are mismatched.");if(g.type!=="float32"&&g.type!=="float64"||b.type!=="float32"&&b.type!=="float64"||et.type!=="float32"&&et.type!=="float64")throw new Error("Invalid input type.");if(d[0].dims.length!==4)throw new Error("Only support 4-D input shape.")}});function ob(d,g){let b=d[0].dims[1],et=d[0].dims.length,st=-Math.floor((g.size-1)/2),at=Math.ceil((g.size-1)/2),vt=`float(${g.alpha}) / float(${g.size})`,Tt=`float(${g.bias})`,Ct=`float(${g.beta})`,pt=`
    float process(int indices[${et}]) {
        int c = indices[1];
        float x = _X(indices);
        float square_sum = 0.0;

        for (int i = ${st}; i <= ${at}; i++) {
          int idx = c + i;
          if (c >= 0 && c < ${b}) {
            indices[1] = idx;
            float j = _X(indices);
            square_sum += j * j;
          }
        }
        return x / pow(${Tt} + ${vt} * square_sum, ${Ct});
    }`;return{...Bf,cacheHint:g.cacheKey,output:{dims:d[0].dims,type:d[0].type,textureType:0},shaderSource:pt}}function ib(d,g){return{...Bf,cacheHint:g.cacheKey,get:()=>ob(d,g)}}var $f,kf,Bf,ab,Nf=L$1(()=>{Ue$1(),ae(),$f=(d,g,b)=>(ab(g),[d.run(ib(g,b),g)]),kf=d=>{let g=d.attributes.getFloat("alpha",1e-4),b=d.attributes.getFloat("beta",.75),et=d.attributes.getFloat("bias",1),st=d.attributes.getInt("size");return Q$1({alpha:g,beta:b,bias:et,size:st})},Bf={name:"LRN",inputNames:["X"],inputTypes:[0]},ab=d=>{if(!d||d.length!==1)throw new Error("LRN requires 1 input.");if(d[0].dims.length!==4)throw new Error('currently only support LRN for input with "NCHW" format');if(d[0].type!=="float32")throw new Error("input should be float type")}}),sb,$i,Rf,Mf,Gf,ub,lb,fb,cb,pb,db,hb,mb,Uf=L$1(()=>{Ue$1(),fe$1(),we$1(),ae(),sb={name:"Pad",inputNames:["A"],inputTypes:[0]},$i=(d,g,b)=>(fb(g),[d.run({...sb,cacheHint:b.cacheKey,get:()=>lb(d,g[0],b)},g)]),Rf=d=>{let g=d.attributes.getString("mode","constant"),b=d.attributes.getFloat("value",0),et=d.attributes.getInts("pads");return Q$1({mode:g,value:b,pads:et})},Mf=(d,g,b)=>{cb(g);let et=ub(d,g,b);return $i(d,[g[0]],et)},Gf=d=>d.attributes.getString("mode","constant"),ub=(d,g,b)=>{if(!d.session.isInitializer(g[1].dataId)||g.length>=3&&!d.session.isInitializer(g[2].dataId))throw new Error("dynamic pad attributes are not allowed");let et=Array.from(g[1].integerData),st=g.length>=3?g[2].floatData[0]:0;return Q$1({mode:b,pads:et,value:st})},lb=(d,g,b)=>{let et=U$2.padShape(g.dims.slice(),b.pads),st=et.length,at=`
      ${pb(d,g,b)}
      float process(int[${st}] indices) {
          return padA(indices);
      }`;return{name:"Pad",inputNames:["A"],inputTypes:[0],output:{dims:et,type:g.type,textureType:0},shaderSource:at}},fb=d=>{if(!d||d.length!==1)throw new Error("Pad requires 1 input");if(d[0].type!=="float32"&&d[0].type!=="float64")throw new Error("Invalid input type.")},cb=d=>{if(!d||d.length!==2&&d.length!==3)throw new Error("Pad requires 2 or 3 inputs");if(d[1].type!=="int32")throw new Error("Invalid input type.");if(d.length>=3&&d[2].type==="string")throw new Error("Invalid input type.")},pb=(d,g,b)=>{let et=H(d.session.backend.glContext.version),[st,at]=d.calculateTextureWidthAndHeight(g.dims,0),vt=U$2.computeStrides(g.dims);switch(b.mode){case"constant":return db(et,g.dims,vt,st,at,b.pads,b.value);case"reflect":return hb(et,g.dims,vt,st,at,b.pads);case"edge":return mb(et,g.dims,vt,st,at,b.pads);default:throw new Error("Invalid mode")}},db=(d,g,b,et,st,at,vt)=>{let Tt=g.length,Ct="";for(let pt=Tt-1;pt>=0;--pt)Ct+=`
        k = m[${pt}] - ${at[pt]};
        if (k < 0)  return constant;
        if (k >= ${g[pt]}) return constant;
        offset += k * ${b[pt]};
        `;return`
      float padA(int m[${Tt}]) {
        const float constant = float(${vt});
        int offset = 0;
        int k = 0;
        ${Ct}
        vec2 coords = offsetToCoords(offset, ${et}, ${st});
        float value = getColorAsFloat(${d.texture2D}(A, coords));
        return value;
      }
      `},hb=(d,g,b,et,st,at)=>{let vt=g.length,Tt="";for(let Ct=vt-1;Ct>=0;--Ct)Tt+=`
        k = m[${Ct}] - ${at[Ct]};
        if (k < 0) { k = -k; }
        {
          const int _2n_1 = ${2*(g[Ct]-1)};
          k = int( mod( float(k), float(_2n_1) ) ) ;
          if(k >= ${g[Ct]}) { k = _2n_1 - k; }
        }
        offset += k * ${b[Ct]};
        `;return`
      float padA(int m[${vt}]) {
        int offset = 0;
        int k = 0;
        ${Tt}
        vec2 coords = offsetToCoords(offset, ${et}, ${st});
        float value = getColorAsFloat(${d.texture2D}(A, coords));
        return value;
      }
      `},mb=(d,g,b,et,st,at)=>{let vt=g.length,Tt="";for(let Ct=vt-1;Ct>=0;--Ct)Tt+=`
        k = m[${Ct}] - ${at[Ct]};
        if (k < 0)  k = 0;
        if (k >= ${g[Ct]}) k = ${g[Ct]-1};
        offset += k * ${b[Ct]};
      `;return`
      float padA(int m[${vt}]) {
        int offset = 0;
        int k = 0;
        ${Tt}
        vec2 coords = offsetToCoords(offset, ${et}, ${st});
        float value = getColorAsFloat(${d.texture2D}(A, coords));
        return value;
      }
      `}}),Vf,Wf,Hf,qf,jf,Yf,Xf,Kf,Jf,bb,zf,Zf,ao$1,Qf,io$1,gb,ec=L$1(()=>{Ue$1(),fe$1(),ae(),Vf=(d,g,b)=>{ao$1(g);let et={name:"AveragePool",inputNames:["X"],inputTypes:[0],cacheHint:b.cacheKey};return[d.run({...et,get:()=>Hf(g,et,!1,b)},g)]},Wf=d=>{let g=d.attributes.getString("auto_pad","NOTSET"),b=d.attributes.getInt("ceil_mode",0),et=d.attributes.getInt("count_include_pad",0)!==0,st=d.attributes.getInts("kernel_shape"),at=d.attributes.getInts("strides",[]),vt=d.attributes.getInts("pads",[]);if(b!==0)throw new Error("using ceil() in shape computation is not yet supported for AveragePool");return Q$1({autoPad:g,ceilMode:b,countIncludePad:et,kernelShape:st,strides:at,pads:vt})},Hf=(d,g,b,et)=>{let[st,at]=Jf(d,et,b),vt=U$2.size(st.kernelShape),Tt="value += _X(x);",Ct="";st.countIncludePad?Ct+=`value /= float(${vt});`:Ct+=`value /= float(${vt} - pad);`;let pt=`
        ${Qf(d[0].dims,st,Tt,Ct,"0.0")}
      `;return{...g,output:{dims:at,type:d[0].type,textureType:0},shaderSource:pt}},qf=(d,g,b)=>{ao$1(g);let et={name:"GlobalAveragePool",inputNames:["X"],inputTypes:[0],cacheHint:`${b.countIncludePad}`};return[d.run({...et,get:()=>Hf(g,et,!0,b)},g)]},jf=d=>{let g=d.attributes.getInt("count_include_pad",0)!==0;return Q$1({autoPad:"",ceilMode:0,countIncludePad:g,kernelShape:[],strides:[],pads:[]})},Yf=(d,g,b)=>{ao$1(g);let et={name:"MaxPool",inputNames:["X"],inputTypes:[0],cacheHint:b.cacheKey};return[d.run({...et,get:()=>Kf(g,et,!1,b)},g)]},Xf=d=>{let g=d.attributes.getString("auto_pad","NOTSET"),b=d.attributes.getInt("ceil_mode",0),et=d.attributes.getInts("kernel_shape"),st=d.attributes.getInts("strides",[]),at=d.attributes.getInts("pads",[]),vt=d.attributes.getInt("storage_order",0),Tt=d.attributes.getInts("dilations",[]);if(vt!==0)throw new Error("column major storage order is not yet supported for MaxPool");if(b!==0)throw new Error("using ceil() in shape computation is not yet supported for MaxPool");return Q$1({autoPad:g,ceilMode:b,countIncludePad:!1,kernelShape:et,strides:st,pads:at,storageOrder:vt,dilations:Tt})},Kf=(d,g,b,et)=>{let[st,at]=Jf(d,et,b),vt=`
      value = max(_X(x), value);
    `,Tt="",Ct=`
      ${Qf(d[0].dims,st,vt,Tt,"-1e5")}
    `;return{...g,output:{dims:at,type:d[0].type,textureType:0},shaderSource:Ct}},Jf=(d,g,b)=>{let et=d[0].dims.slice(),st=Object.hasOwnProperty.call(g,"dilations"),at=g.kernelShape.slice(),vt=g.strides.slice(),Tt=st?g.dilations.slice():[],Ct=g.pads.slice();mr$1.adjustPoolAttributes(b,et,at,vt,Tt,Ct);let pt=mr$1.computePoolOutputShape(b,et,vt,Tt,at,Ct,g.autoPad),wt=Object.assign({},g);return st?Object.assign(wt,{kernelShape:at,strides:vt,pads:Ct,dilations:Tt,cacheKey:g.cacheKey}):Object.assign(wt,{kernelShape:at,strides:vt,pads:Ct,cacheKey:g.cacheKey}),[wt,pt]},bb={autoPad:"",ceilMode:0,countIncludePad:!1,kernelShape:[],strides:[],pads:[],storageOrder:0,dilations:[],cacheKey:""},zf={name:"GlobalMaxPool",inputNames:["X"],inputTypes:[0]},Zf=(d,g)=>(ao$1(g),[d.run({...zf,get:()=>Kf(g,zf,!0,bb)},g)]),ao$1=d=>{if(!d||d.length!==1)throw new Error("Pool ops requires 1 input.");if(d[0].type!=="float32"&&d[0].type!=="float64")throw new Error("Invalid input type.")},Qf=(d,g,b,et,st)=>{let at=d.length;if(g.kernelShape.length<=2){let vt=g.kernelShape[g.kernelShape.length-1],Tt=g.strides[g.strides.length-1],Ct=g.pads[g.pads.length/2-1],pt=g.pads[g.pads.length-1],wt=d[at-1],$t="",Lt="",jt="";if(Ct+pt!==0?$t=`
          for (int i = 0; i < ${vt}; i++) {
            x[${at} - 1] = indices[${at} - 1] * ${Tt} - ${Ct} + i;
            if (x[${at} - 1] < 0 || x[${at} - 1] >= ${wt}) {
              pad++;
              continue;
            }
            ${b}
          }`:$t=`
          for (int i = 0; i < ${vt}; i++) {
            x[${at} - 1] = indices[${at} - 1] * ${Tt} - ${Ct} + i;
            ${b}
          }`,g.kernelShape.length===2){let Ft=g.kernelShape[g.kernelShape.length-2],Gt=g.strides[g.strides.length-2],Ht=g.pads[g.pads.length/2-2],qt=g.pads[g.pads.length-2],Kt=d[at-2];Ht+qt!==0?Lt=`
            for (int j = 0; j < ${Ft}; j++) {
              x[${at} - 2] = indices[${at} - 2] * ${Gt} - ${Ht} + j;
              if (x[${at} - 2] < 0 || x[${at} - 2] >= ${Kt}) {
                pad+= ${vt};
                continue;
              }
          `:Lt=`
            for (int j = 0; j < ${Ft}; j++) {
              x[${at} - 2] = indices[${at} - 2] * ${Gt} - ${Ht} + j;
            `,jt=`
          }
        `}return`
        float process(int indices[${at}]) {
          int x[${at}];
          copyVec(indices, x);

          float value = ${st};
          int pad = 0;
          ${Lt}
          ${$t}
          ${jt}
          ${et}
          return value;
        }
      `}else{let vt=U$2.size(g.kernelShape),Tt=U$2.computeStrides(g.kernelShape),Ct=Tt.length,pt=g.pads.length,wt=gb(Ct),$t=io$1(d,"inputDims"),Lt=io$1(g.pads,"pads"),jt=io$1(Tt,"kernelStrides"),Ft=io$1(g.strides,"strides"),Gt=g.pads.reduce((qt,Kt)=>qt+Kt),Ht="";return Gt?Ht=`
            if (x[j] >= inputDims[j] || x[j] < 0) {
              pad++;
              isPad = true;
              break;
            }
          }
          if (!isPad) {
            ${b}
          }`:Ht=`
          }
          ${b}
        `,`
        ${wt}
        float process(int indices[${at}]) {
          int x[${at}];
          copyVec(indices, x);
          int offset[${Ct}];
          int pads[${pt}];
          int inputDims[${at}];
          int kernelStrides[${Ct}];
          int strides[${Ct}];
          ${Lt}
          ${$t}
          ${Ft}
          ${jt}

          float value = ${st};
          int pad = 0;
          bool isPad = false;
          for (int i = 0; i < ${vt}; i++) {
            offsetToIndices(i, kernelStrides, offset);
            isPad = false;
            for (int j = ${at} - ${Ct}; j < ${at}; j++) {
              x[j] = indices[j] * strides[j - ${at} + ${Ct}]
                + offset[j - ${at} + ${Ct}] - pads[j - 2];
              ${Ht}
          }
          ${et}

          return value;
        }
      `}},io$1=(d,g)=>{let b="";for(let et=0;et<d.length;et++)b+=`
      ${g}[${et}] = ${d[et]};
    `;return b},gb=d=>`
  void offsetToIndices(int offset, int[${d}] strides, out int[${d}] indices) {
    if (${d} == 0) {
      return;
    }
    for (int i = 0; i < ${d} - 1; ++i) {
      indices[i] = offset / strides[i];
      offset -= indices[i] * strides[i];
    }
    indices[${d} - 1] = offset;
  }`}),vr,er,yb,Tb,tc,rc,nc$1,oc$1,ic$1,ac$1,sc$1,uc$1=L$1(()=>{Ue$1(),pn(),fe$1(),ae(),vr=(d,g,b,et,st)=>{Tb(g);let at={name:et,inputNames:["A"],inputTypes:[0]};return[d.run({...at,cacheHint:b.cacheKey,get:()=>yb(d,g,b,et,st,at)},g)]},er=d=>{let g=d.attributes.getInts("axes",[]),b=d.attributes.getInt("keepdims",1)===1;return Q$1({axes:g,keepDims:b})},yb=(d,g,b,et,st,at)=>{let vt=[],Tt=g[0].dims.length||1,Ct=[],pt=U$2.normalizeAxes(b.axes,g[0].dims.length),wt=st(g,pt),$t=wt[1];for(let jt=0;jt<g[0].dims.length;jt++)pt.indexOf(jt)>=0||pt.length===0?(b.keepDims&&vt.push(1),$t=`
          for(int j${jt} = 0; j${jt} < ${g[0].dims[jt]}; j${jt}++) {
            inputIdx[${jt}] = j${jt};
            ${$t}
          }`):(Ct.push(`inputIdx[${jt}] = outputIdx[${vt.length}];`),vt.push(g[0].dims[jt]));let Lt=`
      float process(int outputIdx[${vt.length||1}]) {
        float value;                 // final result
        int inputIdx[${Tt}];      // addressing input data
        ${Ct.join(`
`)}
        ${wt[0]}       // init ops for reduce max/min
        ${$t}
        ${wt[2]}       // final computation for reduce mean
        return value;
      }`;return{...at,output:{dims:vt,type:g[0].type,textureType:0},shaderSource:Lt}},Tb=d=>{if(!d||d.length!==1)throw new Error("Reduce op requires 1 input.");if(Qt.indexOf(d[0].type)===-1)throw new Error("Invalid input type.")},tc=(d,g,b)=>vr(d,g,b,"ReduceSum",()=>["value = 0.0;","value += _A(inputIdx);",""]),rc=(d,g,b)=>vr(d,g,b,"ReduceMean",(et,st)=>{let at=1;for(let vt=0;vt<et[0].dims.length;vt++)(st.indexOf(vt)>=0||st.length===0)&&(at*=et[0].dims[vt]);return["value = 0.0;","value += _A(inputIdx);",`value /= ${at}.;`]}),nc$1=(d,g,b)=>vr(d,g,b,"ReduceMax",(et,st)=>{let at=[];for(let vt=0;vt<et[0].dims.length;vt++)(st.indexOf(vt)>=0||st.length===0)&&at.push(`inputIdx[${vt}] = 0;`);return[`${at.join(`
`)}
value = _A(inputIdx);`,"value = max(value, _A(inputIdx));",""]}),oc$1=(d,g,b)=>vr(d,g,b,"ReduceMin",(et,st)=>{let at=[];for(let vt=0;vt<et[0].dims.length;vt++)(st.indexOf(vt)>=0||st.length===0)&&at.push(`inputIdx[${vt}] = 0;`);return[`${at.join(`
`)}
value = _A(inputIdx);`,"value = min(value, _A(inputIdx));",""]}),ic$1=(d,g,b)=>vr(d,g,b,"ReduceProd",()=>["value = 1.0;","value *= _A(inputIdx);",""]),ac$1=(d,g,b)=>vr(d,g,b,"ReduceLogSum",()=>["value = 0.0;","value += _A(inputIdx);","value = log(value);"]),sc$1=(d,g,b)=>vr(d,g,b,"ReduceLogSumSquare",()=>["float t; value = 0.0;","t = _A(inputIdx); value += t * t;",""])}),lc$1,fc$1=L$1(()=>{fe$1(),lc$1=(d,g)=>{let b=U$2.calculateReshapedDims(g[0].dims,g[1].integerData);return d.session.pack?[d.reshapePacked(g[0],b)]:[d.reshapeUnpacked(g[0],b)]}}),cc$1,ki,pc$1,dc$1,dn,xb,Bi$1,so$1,Ni=L$1(()=>{Ue$1(),we$1(),ae(),cc$1={name:"Upsample",inputNames:["X"],inputTypes:[0]},ki=(d,g,b)=>(Bi$1(g,b),[d.run({...cc$1,cacheHint:b.cacheKey,get:()=>xb(d,g,b)},g)]),pc$1=d=>dn(d,7),dc$1=d=>dn(d,9),dn=(d,g)=>{let b=g>=10,et=d.attributes.getString("mode","nearest");if(et!=="nearest"&&et!=="linear"&&(g<11||et!=="cubic"))throw new Error(`unrecognized mode: ${et}`);let st=[];g<9&&(st=d.attributes.getFloats("scales"),so$1(st,et,b));let at=d.attributes.getFloat("extrapolation_value",0),vt=g>10?d.attributes.getString("coordinate_transformation_mode","half_pixel"):"asymmetric";if(["asymmetric","pytorch_half_pixel","tf_half_pixel_for_nn","align_corners","tf_crop_and_resize","half_pixel"].indexOf(vt)===-1)throw new Error(`coordinate_transform_mode '${vt}' is not supported`);let Tt=vt==="tf_crop_and_resize",Ct=Tt,pt=et==="nearest"&&g>=11?d.attributes.getString("nearest_mode","round_prefer_floor"):"";if(["round_prefer_floor","round_prefer_ceil","floor","ceil",""].indexOf(pt)===-1)throw new Error(`nearest_mode '${pt}' is not supported`);let wt=d.attributes.getFloat("cubic_coeff_a",-.75),$t=d.attributes.getInt("exclude_outside",0)!==0;if($t&&et!=="cubic")throw new Error("exclude_outside can be set to 1 only when mode is CUBIC.");let Lt=g<11?!0:et==="nearest"&&vt==="asymmetric"&&pt==="floor",jt=0,Ft=0,Gt=0;return g>10?d.inputs.length>2?(jt=1,Ft=2,Gt=3):(Ft=1,Gt=2):g===9&&(Ft=1),Q$1({opset:g,isResize:b,mode:et,scales:st,extrapolationValue:at,coordinateTransformMode:vt,useExtrapolation:Ct,needRoiInput:Tt,nearestMode:pt,cubicCoefficientA:wt,excludeOutside:$t,useNearest2xOptimization:Lt,roiInputIdx:jt,scalesInputIdx:Ft,sizesInputIdx:Gt})},xb=(d,g,b)=>{let et=H(d.session.backend.glContext.version),[st,at]=d.calculateTextureWidthAndHeight(g[0].dims,0),vt=g[0].dims.map((Gt,Ht)=>Math.floor(Gt*b.scales[Ht])),[Tt,Ct]=d.calculateTextureWidthAndHeight(vt,0),pt=vt.length,wt=new Array(pt),$t=new Array(pt),Lt=`
      int output_pitches[${pt}];
      int input_pitches[${pt}];
      `;for(let Gt=pt-1;Gt>=0;Gt--)wt[Gt]=Gt===pt-1?1:wt[Gt+1]*vt[Gt+1],$t[Gt]=Gt===pt-1?1:$t[Gt+1]*g[0].dims[Gt+1],Lt+=`
        output_pitches[${Gt}] = ${wt[Gt]};
        input_pitches[${Gt}] = ${$t[Gt]};
        `;let jt=`
      float getInputFloat(int index) {
        vec2 coords = offsetToCoords(index, ${st}, ${at});
        float value = getColorAsFloat(${et.texture2D}(X, coords));
        return value;
      }
      `,Ft=b.mode==="nearest"?`
    ${jt}
    float process(int indices[${pt}]) {
      int input_index = 0;
      int output_index = coordsToOffset(TexCoords, ${Tt}, ${Ct});

      ${Lt}

      int d, m;
      for (int dim = 0; dim < ${pt}; ++dim) {
        d = output_index / output_pitches[dim];
        m = output_index - d * output_pitches[dim];
        output_index = m;

        if (scales[dim] != 1 && d > 0) {
          int d2 = d / scales[dim];
          m = d - d2 * scales[dim];
          d = d2;
        }
        input_index += input_pitches[dim] * d;
      }

      return getInputFloat(input_index);
    }`:pt===4?`
    ${jt}
    float process(int indices[4]) {
      int input_index = 0;
      int output_index = coordsToOffset(TexCoords, ${Tt}, ${Ct});

      ${Lt}

      int m;
      int index_of_dim0, index_of_dim1, index_of_dim2, index_of_dim3;
      index_of_dim0 = output_index / output_pitches[0];
      m = output_index - index_of_dim0 * output_pitches[0];
      index_of_dim1 = m / output_pitches[1];
      m = m - index_of_dim1 * output_pitches[1];
      index_of_dim2 = m / output_pitches[2];
      m = m - index_of_dim2 * output_pitches[2];
      index_of_dim3 = m;

      int index_of_input_dim2, index_of_input_dim3, x_offset, y_offset;
      index_of_input_dim2 = index_of_dim2 / scales[2];
      y_offset = index_of_dim2 - index_of_input_dim2 * scales[2];
      index_of_input_dim3 = index_of_dim3 / scales[3];
      x_offset = index_of_dim3 - index_of_input_dim3 * scales[3];

      input_index = index_of_dim0 * input_pitches[0] +
            index_of_dim1 * input_pitches[1] +
            index_of_input_dim2 * input_pitches[2] +
            index_of_input_dim3;

      float x00 = getInputFloat(input_index);
      float x10, x01, x11;

      bool end_of_dim2 = false;
      if (index_of_input_dim2 == (${g[0].dims[2]} - 1)) {
        // It's the end in dimension 2
        x01 = x00;
        end_of_dim2 = true;
      } else {
        x01 = getInputFloat(input_index + input_pitches[2]);
      }

      if (index_of_input_dim3 == (input_pitches[2] - 1)) {
        // It's the end in dimension 3
        x10 = x00;
        x11 = x01;
      }
      else {
        x10 = getInputFloat(input_index + 1);
        x11 = end_of_dim2 ? x10 : getInputFloat(input_index + input_pitches[2] + 1);
      }

      float y0 = x00 + float(y_offset) * (x01 - x00) / float(scales[2]);
      float y1 = x10 + float(y_offset) * (x11 - x10) / float(scales[2]);
      return y0 + float(x_offset) * (y1 - y0) / float(scales[3]);
    }`:`
    ${jt}
    float process(int indices[2]) {
      int input_index = 0;
      int output_index = coordsToOffset(TexCoords, ${Tt}, ${Ct});

      ${Lt}

      int m;
      int index_of_dim0, index_of_dim1;
      index_of_dim0 = output_index / output_pitches[0];
      m = output_index - index_of_dim0 * output_pitches[0];
      index_of_dim1 = m;

      int index_of_input_dim0, index_of_input_dim1, x_offset, y_offset;
      index_of_input_dim0 = index_of_dim0 / scales[0];
      y_offset = index_of_dim0 - index_of_input_dim0 * scales[0];
      index_of_input_dim1 = index_of_dim1 / scales[1];
      x_offset = index_of_dim1 - index_of_input_dim1 * scales[1];

      input_index = index_of_input_dim0 * input_pitches[0] + index_of_input_dim1;

      float x00 = getInputFloat(input_index);
      float x10, x01, x11;

      bool end_of_dim0 = false;
      if (index_of_input_dim0 == (${g[0].dims[0]} - 1)) {
        // It's the end in dimension 0
        x01 = x00;
        end_of_dim0 = true;
      } else {
        x01 = getInputFloat(input_index + input_pitches[0]);
      }

      if (index_of_input_dim1 == (input_pitches[0] - 1)) {
        // It's the end in dimension 1
        x10 = x00;
        x11 = x01;
      }
      else {
        x10 = getInputFloat(input_index + 1);
        x11 = end_of_dim0 ? x10 : getInputFloat(input_index + input_pitches[0] + 1);
      }

      float y0 = x00 + float(y_offset) * (x01 - x00) / float(scales[0]);
      float y1 = x10 + float(y_offset) * (x11 - x10) / float(scales[0]);
      return y0 + float(x_offset) * (y1 - y0) / float(scales[1]);
    }`;return{...cc$1,output:{dims:vt,type:g[0].type,textureType:0},shaderSource:Ft,variables:[{name:"scales",type:"int",arrayLength:b.scales.length,data:b.scales.map(Gt=>Math.ceil(Gt))}]}},Bi$1=(d,g)=>{if(!d||g.opset<9&&d.length!==1||g.opset>=9&&g.opset<11&&d.length!==2||g.opset>=11&&d.length<2)throw new Error("invalid inputs.");if(g.scales.length>0&&d[0].dims.length!==g.scales.length)throw new Error("Invalid input shape.");if(d[0].type==="string")throw new Error("Invalid input tensor types.")},so$1=(d,g,b)=>{if(b){for(let et of d)if(et<=0)throw new Error("Scale value should be greater than 0.")}else for(let et of d)if(et<1)throw new Error("Scale value should be greater than or equal to 1.");if((g==="linear"||g==="cubic")&&d.length!==2&&(d.length!==4||d[0]!==1||d[1]!==1))throw new Error(`'Linear' mode and 'Cubic' mode only support 2-D inputs ('Bilinear', 'Bicubic')         or 4-D inputs with the corresponding outermost 2 scale values being 1         in the ${b?"Resize":"Upsample"} opeartor.`)}}),Ri$1,Mi$1,hc,mc$1,wb,vb,_b,Ob,bc$1=L$1(()=>{we$1(),ae(),Bt$1(),Tr(),Ni(),Ri$1={name:"Resize",inputNames:["A"],inputTypes:[2]},Mi$1=(d,g,b)=>(Bi$1(g,b),[d.run({...Ri$1,cacheHint:b.cacheKey,get:()=>wb(d,g,b)},g)]),hc=d=>dn(d,10),mc$1=d=>dn(d,11),wb=(d,g,b)=>{let et=H(d.session.backend.glContext.version),[st,at]=vb(g,b);if(st.every(Kt=>Kt===1)&&b.coordinateTransformMode!=="tf_crop_and_resize")return{...Ri$1,output:{dims:at,type:g[0].type,textureType:2},hasMain:!0,shaderSource:`void main() {
                    vec4 v = ${et.texture2D}(X, TexCoords);
                    ${et.output} = v;
                }`};let vt=at.length;if(vt<2)throw new Error(`output dimension should be at least 2, but got ${vt}`);let Tt=at[vt-2],Ct=at[vt-1],pt=g[0].dims;if(vt!==pt.length)throw new Error(`output dimension should match input ${pt.length}, but got ${vt}`);let wt=pt[vt-2],$t=pt[vt-1],Lt=st[vt-2],jt=st[vt-1],Ft="";if(b.mode!=="linear")throw new Error(`resize (packed) does not support mode: '${b.mode}'`);switch(b.coordinateTransformMode){case"asymmetric":Ft=`
                    vec4 getSourceFracIndex(ivec4 coords) {
                        return vec4(coords) / scaleWHWH;
                    }
                `;break;case"half_pixel":Ft=`
                    vec4 getSourceFracIndex(ivec4 coords) {
                        return (vec4(coords) + 0.5) / scaleWHWH - 0.5;
                    }
                `;break;case"pytorch_half_pixel":Ft=`
                    vec4 getSourceFracIndex(ivec4 coords) {
                        vec4 fcoords = vec4(coords);
                        return vec4(
                            ${Ct}.0 > 1.0 ? (fcoords.x + 0.5) / scaleWHWH.x - 0.5 : 0.0,
                            ${Tt}.0 > 1.0 ? (fcoords.y + 0.5) / scaleWHWH.y - 0.5 : 0.0,
                            ${Ct}.0 > 1.0 ? (fcoords.z + 0.5) / scaleWHWH.z - 0.5 : 0.0,
                            ${Tt}.0 > 1.0 ? (fcoords.w + 0.5) / scaleWHWH.w - 0.5 : 0.0
                          );
                    }
                `;break;case"align_corners":Ft=`
                    vec4 getSourceFracIndex(ivec4 coords) {
                        vec4 resized = vec4(${Ct}.0 - 1.0, ${Tt}.0 - 1.0, ${Ct}.0 - 1.0,
                            ${Tt}.0 - 1.0);
                        vec4 original = vec4(${$t}.0 - 1.0, ${wt}.0 - 1.0, ${$t}.0 - 1.0,
                            ${wt}.0 - 1.0);
                        vec4 new_scale = original / resized;
                        return vec4(coords) * new_scale;
                    }
                `;break;default:throw new Error(`resize (packed) does not support coordinateTransformMode:                                 '${b.coordinateTransformMode}'`)}let Gt=Qe(vt),Ht=Nt(),qt=`
            const vec2 inputWH = vec2(${wt}.0, ${$t}.0);
            const vec4 scaleWHWH = vec4(float(${Lt}), float(${jt}), float(${Lt}), float(${jt}));
            ${Ht}
            ${Ft}
            float getAValue(int x10, int r, int c, int d) {
                return getChannel(getA(x10, r, c, d), vec2(c, d));
            }
            void main() {
                ${Gt} rc = getOutputCoords();

                int batch = rc[0];
                int depth = rc[1];

                // retrieve the 4 coordinates that is used in the 4 packed output values.
                ivec4 coords = ivec4(rc.wz, rc.w + 1, rc.z + 1);

                // calculate the source index in fraction
                vec4 sourceFrac = getSourceFracIndex(coords);

                // get the lower and upper bound of the 4 values that will be packed into one texel.
                ivec4 x00 = ivec4(max(sourceFrac.xy, vec2(0.0)), min(inputWH - 1.0, ceil(sourceFrac.xy)));
                ivec4 x01 = ivec4(max(sourceFrac.xw, vec2(0.0)), min(inputWH - 1.0, ceil(sourceFrac.xw)));
                ivec4 x10 = ivec4(max(sourceFrac.zy, vec2(0.0)), min(inputWH - 1.0, ceil(sourceFrac.zy)));
                ivec4 x11 = ivec4(max(sourceFrac.zw, vec2(0.0)), min(inputWH - 1.0, ceil(sourceFrac.zw)));

                bool hasNextRow = rc.w < ${Tt-1};
                bool hasNextCol = rc.z < ${Ct-1};

                // pack x00, x01, x10, x11's top-left corner into one vec4 structure
                vec4 topLeft = vec4(
                    getAValue(batch, depth, x00.x, x00.y),
                    hasNextCol ? getAValue(batch, depth, x01.x, x01.y) : 0.0,
                    hasNextRow ? getAValue(batch, depth, x10.x, x10.y) : 0.0,
                    (hasNextRow && hasNextCol) ? getAValue(batch, depth, x11.x, x11.y) : 0.0);

                // pack x00, x01, x10, x11's top-right corner into one vec4 structure
                vec4 topRight = vec4(
                    getAValue(batch, depth, x00.x, x00.w),
                    hasNextCol ? getAValue(batch, depth, x01.x, x01.w) : 0.0,
                    hasNextRow ? getAValue(batch, depth, x10.x, x10.w) : 0.0,
                    (hasNextRow && hasNextCol) ? getAValue(batch, depth, x11.x, x11.w) : 0.0);

                // pack x00, x01, x10, x11's bottom-left corner into one vec4 structure
                vec4 bottomLeft = vec4(
                    getAValue(batch, depth, x00.z, x00.y),
                    hasNextCol ? getAValue(batch, depth, x01.z, x01.y) : 0.0,
                    hasNextRow ? getAValue(batch, depth, x10.z, x10.y) : 0.0,
                    (hasNextRow && hasNextCol) ? getAValue(batch, depth, x11.z, x11.y) : 0.0);

                // pack x00, x01, x10, x11's bottom-right corner into one vec4 structure
                vec4 bottomRight = vec4(
                    getAValue(batch, depth, x00.z, x00.w),
                    hasNextCol ? getAValue(batch, depth, x01.z, x01.w) : 0.0,
                    hasNextRow ? getAValue(batch, depth, x10.z, x10.w) : 0.0,
                    (hasNextRow && hasNextCol) ? getAValue(batch, depth, x11.z, x11.w) : 0.0);

                // calculate the interpolation fraction on u and v direction
                vec4 frac = vec4(sourceFrac) - floor(sourceFrac);
                vec4 clampFrac = clamp(frac, vec4(0.0), vec4(1.0));

                vec4 top = mix(topLeft, topRight, clampFrac.ywyw);
                vec4 bottom = mix(bottomLeft, bottomRight, clampFrac.ywyw);
                vec4 newValue = mix(top, bottom, clampFrac.xxzz);

                ${et.output} = vec4(newValue);
            }
        `;return{...Ri$1,output:{dims:at,type:g[0].type,textureType:2},hasMain:!0,shaderSource:qt}},vb=(d,g)=>{let b=d[0].dims,et=g.scales,st;if(et.length===0){let vt=d[g.scalesInputIdx];if(vt&&vt.size!==0){if(d[g.sizesInputIdx])throw new Error("Only one of scales or sizes must be provided as input.");et=_b(vt,g.mode,g.isResize)}else{let Tt=d[g.sizesInputIdx];if(!Tt||Tt.size===0)throw new Error("Either scales or sizes MUST be provided as input.");st=Array.from(Tt.integerData),et=Ob(st,b,g.mode,g.isResize)}}else if(d[g.sizesInputIdx])throw new Error("Only one of scales or sizes must be provided as input.");let at=st||b.map((vt,Tt)=>Math.floor(vt*et[Tt]));return[et,at]},_b=(d,g,b)=>{let et=Array.from(d.floatData);return so$1(et,g,b),et},Ob=(d,g,b,et)=>{let st=g.length,at=new Array(st);for(let vt=0,Tt=st;vt<Tt;vt++)if(g[vt]===0){if(d[vt]!==0)throw new Error("Input dim is zero but required output dim is non-zero.");at[vt]=1}else at[vt]=d[vt]/g[vt];return so$1(at,b,et),at}}),gc$1,Ib,yc$1=L$1(()=>{yr(),gc$1=(d,g)=>(Ib(g),[new $e([g[0].dims.length],"int32",void 0,void 0,new Int32Array(g[0].dims))]),Ib=d=>{if(!d||d.length!==1)throw new Error("Shape requires 1 input.")}}),Gi$1,Tc$1,xc$1,wc$1,Sb,vc$1,Ab,Pb,_c$1=L$1(()=>{Ue$1(),pn(),fe$1(),ae(),Gi$1={name:"Slice",inputNames:["A"],inputTypes:[0]},Tc$1=(d,g,b)=>(Sb(g),[d.run({...Gi$1,cacheHint:b.cacheKey,get:()=>wc$1(d,g[0],b)},g)]),xc$1=d=>{let g=d.attributes.getInts("starts"),b=d.attributes.getInts("ends"),et=d.attributes.getInts("axes",[]);return Q$1({starts:g,ends:b,axes:et})},wc$1=(d,g,b)=>{let et=b.axes.length===0?g.dims.slice(0).map((wt,$t)=>$t):b.axes,st=U$2.normalizeAxes(et,g.dims.length),at=b.starts.map((wt,$t)=>wt>g.dims[st[$t]]-1?g.dims[st[$t]]:U$2.normalizeAxis(wt,g.dims[st[$t]])),vt=b.ends.map((wt,$t)=>wt>g.dims[st[$t]]-1?g.dims[st[$t]]:U$2.normalizeAxis(wt,g.dims[st[$t]])),Tt=g.dims.slice(),Ct=[];for(let wt=0;wt<st.length;wt++)Tt[st[wt]]=vt[wt]-at[wt],at[wt]>0&&Ct.push(`outputIdx[${st[wt]}] += ${at[wt]};`);let pt=`
      float process(int outputIdx[${Tt.length}]) {
        ${Ct.join(`
      `)}
        return _A(outputIdx);
      }`;return{...Gi$1,output:{dims:Tt,type:g.type,textureType:0},shaderSource:pt}},Sb=d=>{if(!d||d.length!==1)throw new Error("Slice requires 1 input.");if(Qt.indexOf(d[0].type)===-1)throw new Error("Invalid input type.")},vc$1=(d,g)=>{Pb(g);let b=Ab(d,g);return[d.run({...Gi$1,cacheHint:b.cacheKey,get:()=>wc$1(d,g[0],b)},[g[0]])]},Ab=(d,g)=>{if(!d.session.isInitializer(g[1].dataId)||!d.session.isInitializer(g[2].dataId)||g.length>=4&&!d.session.isInitializer(g[3].dataId)||g.length>=5&&!d.session.isInitializer(g[4].dataId))throw new Error("dynamic slice attributes are not allowed");if(g.length>=5&&g[4].integerData.some(vt=>vt!==1))throw new Error("currently non-1 steps is not supported for Slice");let b=Array.from(g[1].integerData),et=Array.from(g[2].integerData),st=g.length>=4?Array.from(g[3].integerData):[],at=`${st};${b};${et}`;return{starts:b,ends:et,axes:st,cacheKey:at}},Pb=d=>{if(!d||d.length<3||d.length>5)throw new Error("Invalid input number.");if(d[1].type!=="int32"||d[1].dims.length!==1)throw new Error("Invalid input type.");if(d[2].type!=="int32"||d[2].dims.length!==1)throw new Error("Invalid input type.");if(d.length>=4&&(d[3].type!=="int32"||d[3].dims.length!==1))throw new Error("Invalid input type.");if(d.length>=5&&(d[4].type!=="int32"||d[4].dims.length!==1))throw new Error("Invalid input type.")}}),Oc$1,Ic$1,Sc$1,Ac$1,Pc$1,Ec$1,Dc$1,Lc$1,Eb,Db,Lb,Cc$1,Fc$1=L$1(()=>{Ue$1(),fe$1(),we$1(),ae(),oo$1(),Oc$1={name:"SoftmaxComputeMax",inputNames:["A"],inputTypes:[0]},Ic$1={name:"SoftmaxComputeScale",inputNames:["A","Max"],inputTypes:[0,0]},Sc$1={name:"SoftMax",inputNames:["A","Max","Norm"],inputTypes:[0,0,0]},Ac$1=(d,g,b)=>{Cc$1(g);let et=g[0].dims.slice(),st=U$2.normalizeAxis(b.axis,et.length),at=U$2.sizeToDimension(et,st),vt=U$2.sizeFromDimension(et,st);return Lc$1(d,g,b,at,vt)},Pc$1=d=>Q$1({axis:d.attributes.getInt("axis",1)}),Ec$1=d=>Q$1({axis:d.attributes.getInt("axis",-1)}),Dc$1=(d,g,b)=>{Cc$1(g);let et=g[0].dims.slice(),st=U$2.normalizeAxis(b.axis,et.length),at=et.length,vt=st!==at-1,Tt=[],Ct=[],pt=[],wt;vt&&(Ct=Array.from({length:at}).map((Ft,Gt)=>Gt),Ct[st]=at-1,Ct[at-1]=st,Ct.map(Ft=>Tt.push(et[Ft])),wt=Q$1({perm:Ct}),pt=wr(d,g,wt));let $t=vt?U$2.sizeToDimension(Tt,at-1):U$2.sizeToDimension(et,at-1),Lt=vt?U$2.sizeFromDimension(Tt,at-1):U$2.sizeFromDimension(et,at-1),jt=Lc$1(d,vt?pt:g,b,$t,Lt);return vt?wr(d,jt,wt):jt},Lc$1=(d,g,b,et,st)=>{let at=Eb(d,g[0],et,st,[et]),vt=d.run({...Oc$1,cacheHint:b.cacheKey,get:()=>at},g),Tt=Db(d,g[0],et,st,at.output.dims,[et]),Ct=d.run({...Ic$1,cacheHint:b.cacheKey,get:()=>Tt},[g[0],vt]),pt=Lb(d,g[0],et,st,at.output.dims,Tt.output.dims);return[d.run({...Sc$1,cacheHint:b.cacheKey,get:()=>pt},[g[0],vt,Ct])]},Eb=(d,g,b,et,st)=>{let[at,vt]=d.calculateTextureWidthAndHeight(g.dims,0),Tt=st.length;if(b<1||et<1)throw new Error("Logical row count N and feature count D must be greater than or equal to 1");if(st.length!==1)throw new Error("Dimensionality of the output should be 1");if(st[0]!==b)throw new Error("Shape of the output should be equal to logical row count");let Ct=H(d.session.backend.glContext.version),pt=`
      float process(int[${Tt}] indices) {
        int logical_row_start_offset = indices[0] * ${et};

        float max = getColorAsFloat(${Ct.texture2D}(A, offsetToCoords(logical_row_start_offset, ${at},
        ${vt} )));
        for(int i=1; i<${et}; ++i)
        {
          float current = getColorAsFloat(${Ct.texture2D}(A, offsetToCoords(logical_row_start_offset + i,
            ${at}, ${vt})));
          if(current > max)
          max = current;
        }

        return max;
      }`;return{...Oc$1,output:{dims:st,type:g.type,textureType:0},shaderSource:pt}},Db=(d,g,b,et,st,at)=>{let[vt,Tt]=d.calculateTextureWidthAndHeight(g.dims,0),Ct=at.length;if(b<1||et<1)throw new Error("Logical row count N and feature count D must be greater than or equal to 1");if(at.length!==1)throw new Error("Dimensionality of the output should be 1");if(at[0]!==b)throw new Error("Shape of the output should be equal to logical row count");if(st.length!==1)throw new Error("Dimensionality of the intermediate results should be 1");if(st[0]!==b)throw new Error("Shape of the intermediate results should be equal to logical row count");let pt=H(d.session.backend.glContext.version),wt=`
      float process(int[${Ct}] indices) {
        int logical_row_start_offset = indices[0] * ${et};

        float norm_factor = 0.0;
        float max = _Max(indices);
        for(int i=0; i<${et}; ++i)
        {
          norm_factor += exp(getColorAsFloat(${pt.texture2D}(A, offsetToCoords(logical_row_start_offset + i,
            ${vt}, ${Tt}))) - max);
        }

        return norm_factor;
      }`;return{...Ic$1,output:{dims:at,type:g.type,textureType:0},shaderSource:wt}},Lb=(d,g,b,et,st,at)=>{let[vt,Tt]=d.calculateTextureWidthAndHeight(g.dims,0),Ct=g.dims.length;if(b<1||et<1)throw new Error("Logical row count N and feature count D must be greater than or equal to 1");if(st.length!==1||at.length!==1)throw new Error("Dimensionality of the intermediate results should be 1");if(st[0]!==b||at[0]!==b)throw new Error("Shape of the intermediate results should be equal to logical row count");let pt=`
      float process(int[${Ct}] indices) {

      // get offset of current logical tensor index from the 2-D texture coordinates (TexCoords)
      int offset = coordsToOffset(TexCoords, ${vt}, ${Tt});

      //determine the logical row for this index
      int logical_row_index[1];
      logical_row_index[0] = offset / ${et};

      float norm_factor = _Norm(logical_row_index);

      // avoid possible division by 0
      // if norm_facor is 0, all elements are zero
      // if so, return 0
      if(norm_factor == 0.0)
        return 0.0;

      return exp(_A(indices) - _Max(logical_row_index)) / norm_factor;
    }`;return{...Sc$1,output:{dims:g.dims,type:g.type,textureType:0},shaderSource:pt}},Cc$1=d=>{if(!d||d.length!==1)throw new Error("Softmax requires 1 input.");if(d[0].type!=="float32"&&d[0].type!=="float64")throw new Error("Invalid input type")}}),$c$1,kc$1,Bc$1,Cb,Fb,$b,Nc$1=L$1(()=>{Ue$1(),fe$1(),ae(),$c$1={name:"Split",inputNames:["A"],inputTypes:[0]},kc$1=(d,g,b)=>{$b(g);let et=U$2.normalizeAxis(b.axis,g[0].dims.length),st=Cb(d,g,et,b),at=[];for(let vt=0;vt<st;++vt)at.push(d.run({...$c$1,cacheHint:`${b.cacheKey};${vt}`,get:()=>Fb(d,g[0],b,et,vt)},g));return at},Bc$1=d=>{let g=d.attributes.getInt("axis",0),b=d.attributes.getInts("split",[]),et=d.outputs.length;return Q$1({axis:g,split:b,numOutputs:et})},Cb=(d,g,b,et)=>{let[,st]=an$1.splitShape(g[0].dims,b,et.split,et.numOutputs);return st.length},Fb=(d,g,b,et,st)=>{let[at,vt]=an$1.splitShape(g.dims,et,b.split,b.numOutputs),Tt=vt[st],Ct=at[st],pt=`
      float process(int indices[${Ct.length}]) {
        indices[${et}] += ${Tt};
        return _A(indices);
      }
    `;return{...$c$1,cacheHint:`${b.cacheKey}:${st}`,output:{dims:Ct,type:g.type,textureType:0},shaderSource:pt}},$b=d=>{if(!d||d.length!==1)throw new Error("Split requires one input.");if(d[0].type!=="int8"&&d[0].type!=="uint8"&&d[0].type!=="int16"&&d[0].type!=="uint16"&&d[0].type!=="int32"&&d[0].type!=="uint32"&&d[0].type!=="float32"&&d[0].type!=="float64"&&d[0].type!=="bool")throw new Error("Invalid input type.")}}),Ui$1,Rc$1,Mc$1,kb,Bb,Gc$1=L$1(()=>{fe$1(),Ui$1=(d,g,b)=>{kb(g);let et=U$2.squeezeShape(g[0].dims,b);return[d.reshapeUnpacked(g[0],et)]},Rc$1=(d,g)=>(Bb(g),Ui$1(d,[g[0]],Array.from(g[1].integerData))),Mc$1=d=>d.attributes.getInts("axes"),kb=d=>{if(!d||d.length!==1)throw new Error("Squeeze requires 1 input.");if(d[0].type==="string")throw new Error("invalid input tensor types.")},Bb=d=>{if(!d||d.length!==2)throw new Error("Squeeze requires 2 inputs.");if(d[1].type!=="int32")throw new Error("Invalid input type.")}}),Uc$1,Nb,Rb,zc$1=L$1(()=>{we$1(),ae(),Uc$1=(d,g)=>{Rb(g);let b={name:"Sum",inputNames:g.map((et,st)=>`X${st}`),inputTypes:new Array(g.length).fill(0)};return[d.run({...b,get:()=>Nb(d,g,b)},g)]},Nb=(d,g,b)=>{let et=H(d.session.backend.glContext.version),st=g[0].dims.slice(),at=`
      void main() {
        vec4 result = ${g.map((vt,Tt)=>`${et.texture2D}(X${Tt},TexCoords)`).join(" + ")};
        ${et.output} = result;
      }
    `;return{...b,output:{dims:st,type:g[0].type,textureType:0},hasMain:!0,shaderSource:at}},Rb=d=>{if(!d||d.length===0)throw new Error("Sum requires inputs.");let g=d[0].dims.length;for(let b=1;b<d.length;b++){if(g!==d[b].dims.length)throw new Error("Input shapes are mismatched.");for(let et=0;et<g;et++)if(d[0].dims[et]!==d[b].dims[et])throw new Error("Input shapes are not matched.")}if(d[0].type!=="float32"&&d[0].type!=="float64")throw new Error("Invalid input type.");for(let b=1;b<d.length;b++)if(d[0].type!==d[b].type)throw new Error("Input types are not matched.")}}),Vc$1,Mb,Gb,Wc$1=L$1(()=>{pn(),ae(),Vc$1=(d,g)=>{Gb(g);let b={name:"Tile",inputNames:["A"],inputTypes:[0]};return[d.run({...b,get:()=>Mb(d,g,b)},g)]},Mb=(d,g,b)=>{let et=g[0].dims.slice(),st=new Array(et.length),at=[];for(let Ct=0;Ct<et.length;Ct++)st[Ct]=et[Ct]*g[1].numberData[Ct],at.push(`inputIdx[${Ct}] = int(mod(float(outputIdx[${Ct}]), ${et[Ct]}.));`);let vt=st.length,Tt=`
      float process(int outputIdx[${vt}]) {
        int inputIdx[${vt}];
        ${at.join(`
`)}
        return _A(inputIdx);
      }
    `;return{...b,output:{dims:st,type:g[0].type,textureType:0},shaderSource:Tt}},Gb=d=>{if(!d||d.length!==2)throw new Error("Tile requires 2 input.");if(d[1].dims.length!==1)throw new Error("The second input shape must 1 dimension.");if(d[1].dims[0]!==d[0].dims.length)throw new Error("Invalid input shape.");if(Qt.indexOf(d[0].type)===-1)throw new Error("Invalid input type.");if(d[1].type!=="int32"&&d[1].type!=="int16")throw new Error("Invalid repeat type.")}}),zi$1,Hc$1,qc$1,Ub,zb,jc$1=L$1(()=>{fe$1(),zi$1=(d,g,b)=>{Ub(g);let et=U$2.unsqueezeShape(g[0].dims,b);return[d.reshapeUnpacked(g[0],et)]},Hc$1=(d,g)=>(zb(g),zi$1(d,[g[0]],Array.from(g[1].integerData))),qc$1=d=>d.attributes.getInts("axes"),Ub=d=>{if(!d||d.length!==1)throw new Error("Unsqueeze requires 1 input.");if(d[0].type==="string")throw new Error("invalid input tensor types.")},zb=d=>{if(!d||d.length!==2)throw new Error("Unsqueeze requires 2 inputs.");if(d[1].type!=="int32")throw new Error("Invalid input type.")}}),Yc$1,Xc$1=L$1(()=>{ol$1(),gl$1(),xl$1(),Sl$1(),to$1(),ff$1(),bf(),Tf(),vf(),Sf(),Ef(),Ff(),Nf(),ro$1(),Uf(),ec(),uc$1(),fc$1(),bc$1(),yc$1(),_c$1(),Fc$1(),Nc$1(),Gc$1(),zc$1(),Wc$1(),oo$1(),Ii(),jc$1(),Ni(),Yc$1=[["Abs","","6+",Al$1],["Acos","","7+",Pl$1],["Add","","7+",il$1],["And","","7+",al$1],["Asin","","7+",El$1],["Atan","","7+",Dl$1],["AveragePool","","7+",Vf,Wf],["BatchNormalization","","7+",rl$1,nl$1],["Cast","","6+",yl$1,Tl$1],["Ceil","","6+",Fl$1],["Clip","","6-10",_i,Ll$1],["Clip","","11+",Cl$1],["Concat","","4+",_l$1,Il$1],["Conv","","1+",Li$1,Ci],["ConvTranspose","","1+",uf$1,lf$1],["Cos","","7+",$l$1],["Div","","7+",sl$1],["Dropout","","7+",Oi$1],["DepthToSpace","","1+",hf$1,mf$1],["Equal","","7+",ul$1],["Elu","","6+",kl$1,Bl$1],["Exp","","6+",Nl$1],["Flatten","","1+",gf,yf],["Floor","","6+",Rl$1],["FusedConv","com.microsoft","1+",Li$1,Ci],["Gather","","1+",xf,wf],["Gemm","","7-10",Fi$1,Of],["Gemm","","11+",Fi$1,If],["GlobalAveragePool","","1+",qf,jf],["GlobalMaxPool","","1+",Zf],["Greater","","7+",ll$1],["Identity","","1+",Oi$1],["ImageScaler","","1+",Af,Pf],["InstanceNormalization","","6+",Lf,Cf],["LeakyRelu","","6+",Ml$1,Gl$1],["Less","","7+",fl$1],["LRN","","1+",$f,kf],["Log","","6+",Ul$1],["MatMul","","1+",ef$1,tf$1],["MaxPool","","1+",Yf,Xf],["Mul","","7+",cl$1],["Neg","","6+",zl$1],["Not","","1+",Vl$1],["Or","","7+",pl$1],["Pad","","2-10",$i,Rf],["Pad","","11+",Mf,Gf],["Pow","","7+",dl$1],["PRelu","","7+",hl$1],["ReduceLogSum","","1+",ac$1,er],["ReduceMax","","1+",nc$1,er],["ReduceMean","","1+",rc,er],["ReduceMin","","1+",oc$1,er],["ReduceProd","","1+",ic$1,er],["ReduceSum","","1-12",tc,er],["ReduceSumSquare","","1+",sc$1,er],["Relu","","6+",Wl$1],["Reshape","","5+",lc$1],["Resize","","10",Mi$1,hc],["Resize","","11+",Mi$1,mc$1],["Shape","","1+",gc$1],["Sigmoid","","6+",Hl$1],["Sin","","7+",ql$1],["Slice","","10+",vc$1],["Slice","","1-9",Tc$1,xc$1],["Softmax","","1-12",Ac$1,Pc$1],["Softmax","","13+",Dc$1,Ec$1],["Split","","2-12",kc$1,Bc$1],["Sqrt","","6+",jl$1],["Squeeze","","1-12",Ui$1,Mc$1],["Squeeze","","13+",Rc$1],["Sub","","7+",ml$1],["Sum","","6+",Uc$1],["Tan","","7+",Yl$1],["Tanh","","6+",Xl$1],["Tile","","6+",Vc$1],["Transpose","","1+",wr,pf$1],["Upsample","","7-8",ki,pc$1],["Upsample","","9",ki,dc$1],["Unsqueeze","","1-12",zi$1,qc$1],["Unsqueeze","","13+",Hc$1],["Xor","","7+",bl$1]]});function Jc$1(d){let g={},b;for(;(b=Kc$1.exec(d))!==null;){let et=b[3].split(",").map(st=>{let at=st.trim().split(" ");return at&&at.length===2?{type:at[0],name:at[1]}:null}).filter(st=>st!==null);g[b[2]]={params:et,body:b[4]}}for(let et in g){let st=Vb.replace("__FUNC__",et),at=new RegExp(st,"gm");for(;(b=at.exec(d))!==null;){let vt=b[1],Tt=b[2],Ct=b[3].split(","),pt=vt?`${vt} ${Tt};`:"",wt=g[et].body,$t="";g[et].params.forEach((jt,Ft)=>{jt&&($t+=`${jt.type} ${jt.name} = ${Ct[Ft]};
`)}),wt=`${$t}
 ${wt}`,wt=wt.replace("return",`${Tt} = `);let Lt=`
      ${pt}
      {
        ${wt}
      }
      `;d=d.replace(b[0],Lt)}}return d=d.replace(Kc$1,""),d}var Kc$1,Vb,Zc$1=L$1(()=>{Kc$1=/@inline[\s\n\r]+(\w+)[\s\n\r]+([0-9a-zA-Z_]+)\s*\(([^)]*)\)\s*{(([^}]|[\n\r])*)}/gm,Vb="(\\w+)?\\s+([_0-9a-zA-Z]+)\\s+=\\s+__FUNC__\\((.*)\\)\\s*;"});function Mr(d,g){let b=[],et=[];for(let st=0;st<d.length;++st)d[st]!==1&&(b.push(d[st]),et.push(st));return{newShape:b,keptDims:et}}function qb(d){if(d.length===0)return 1;let g=d[0];for(let b=1;b<d.length;b++)g*=d[b];return g}function Qc$1(d){let g=Math.ceil(Math.sqrt(d));return[g,Math.ceil(d/g)]}var uo$1,Vi=L$1(()=>{lt$1(),fe$1(),uo$1=class{constructor(d){this.maxTextureSize=d}computeTextureWH(d,g){let b=this.computeTexture(d,g);return g&&g.isPacked&&(b[0]/=2,b[1]/=2),g&&g.reverseWH?[b[1],b[0]]:b}computeTexture(d,g){let b=g&&g.isPacked;if(d.length===0)return b?[2,2]:[1,1];let et=this.maxTextureSize;if(g&&g.breakAxis!==void 0){let vt=g.breakAxis>=d.length?1:d.slice(g.breakAxis).reduce((Ct,pt)=>Ct*pt),Tt=g.breakAxis<=0?1:d.slice(0,g.breakAxis).reduce((Ct,pt)=>Ct*pt);if(vt>et||Tt>et)ce.verbose("TextureLayout",`Given width/height preferences were unattainable: shape:${d}, breakAxis:${g.breakAxis}`);else return[vt,Tt]}let st=d.slice(0);b&&(et=et*2,st=st.map((vt,Tt)=>Tt>=st.length-2?st[Tt]%2===0?st[Tt]:st[Tt]+1:st[Tt]),st.length===1&&(st=[2,st[0]])),st.length!==2&&(st=Mr(st).newShape);let at=qb(st);return st.length<=1&&at<=et?[1,at]:st.length===2&&st[0]<=et&&st[1]<=et?st:st.length===3&&st[0]*st[1]<=et&&st[2]<=et?[st[0]*st[1],st[2]]:st.length===3&&st[0]<=et&&st[1]*st[2]<=et?[st[0],st[1]*st[2]]:st.length===4&&st[0]*st[1]*st[2]<=et&&st[3]<=et?[st[0]*st[1]*st[2],st[3]]:st.length===4&&st[0]<=et&&st[1]*st[2]*st[3]<=et?[st[0],st[1]*st[2]*st[3]]:b?Qc$1(at/4).map(vt=>vt*2):Qc$1(at)}}}),lo$1,ep$1=L$1(()=>{fe$1(),Wt$1(),we$1(),Vi(),Bt$1(),lo$1=class extends dt{constructor(d){super(d)}getFunctions(){return{...this.offsetToCoords(),...this.coordsToOffset(),...this.toVec(),...this.valueFrom(),...this.getCommonUtilFuncs(),...this.getInputsSamplingSnippets(),...this.getOutputSamplingSnippet()}}getCustomTypes(){return{}}offsetToCoords(){let d="offsetToCoords";return{offsetToCoords:new R(`
      vec2 ${d}(int offset, int width, int height) {
        int t = offset / width;
        int s = offset - t*width;
        vec2 coords = (vec2(s,t) + vec2(0.5,0.5)) / vec2(width, height);
        return coords;
      }
      `)}}coordsToOffset(){let d="coordsToOffset";return{coordsToOffset:new R(`
      int ${d}(vec2 coords, int width, int height) {
        float s = coords.s * float(width);
        float t = coords.t * float(height);
        int offset = int(t) * width + int(s);
        return offset;
      }
      `)}}getOutputSamplingSnippet(){let d=this.context.outputTextureLayout;return d.isPacked?this.getPackedOutputSamplingSnippet(d):this.getUnpackedOutputSamplingSnippet(d)}getPackedOutputSamplingSnippet(d){let g=d.unpackedShape,b=[d.width,d.height],et={},st="getOutputCoords";switch(g.length){case 0:et[st]=this.getOutputScalarCoords();break;case 1:et[st]=this.getOutputPacked1DCoords(g,b);break;case 2:et[st]=this.getOutputPacked2DCoords(g,b);break;case 3:et[st]=this.getOutputPacked3DCoords(g,b);break;default:et[st]=this.getOutputPackedNDCoords(g,b)}let at=`
      void setOutput(vec4 val) {
        ${H(this.context.glContext.version).output} = val;
      }
    `,vt="floatTextureSetRGBA";return et[vt]=new R(at),et}getUnpackedOutputSamplingSnippet(d){let g=d.unpackedShape,b=[d.width,d.height],et={},st="getOutputCoords";switch(g.length){case 0:et[st]=this.getOutputScalarCoords();break;case 1:et[st]=this.getOutputUnpacked1DCoords(g,b);break;case 2:et[st]=this.getOutputUnpacked2DCoords(g,b);break;case 3:et[st]=this.getOutputUnpacked3DCoords(g,b);break;case 4:et[st]=this.getOutputUnpacked4DCoords(g,b);break;case 5:et[st]=this.getOutputUnpacked5DCoords(g,b);break;case 6:et[st]=this.getOutputUnpacked6DCoords(g,b);break;default:throw new Error(`Unsupported output dimensionality: ${g.length}`)}let at=`
        void setOutput(float val) {
          ${H(this.context.glContext.version).output} = vec4(val, 0, 0, 0);
        }
    `,vt="floatTextureSetR";return et[vt]=new R(at),et}getOutputScalarCoords(){return new R(`
      int getOutputCoords() {
        return 0;
      }
    `)}getOutputPacked1DCoords(d,g){let b=g,et="";return b[0]===1?(et=`
          int getOutputCoords() {
            return 2 * int(TexCoords.y * ${b[1]}.0);
          }
        `,new R(et)):b[1]===1?(et=`
          int getOutputCoords() {
            return 2 * int(TexCoords.x * ${b[0]}.0);
          }
        `,new R(et)):(et=`
        int getOutputCoords() {
          ivec2 resTexRC = ivec2(TexCoords.xy *
                                 vec2(${b[0]}, ${b[1]}));
          return 2 * (resTexRC.y * ${b[0]} + resTexRC.x);
        }
      `,new R(et))}getOutputPacked2DCoords(d,g){let b="";if(hr$1.arraysEqual(d,g))return b=`
        ivec2 getOutputCoords() {
          return 2 * ivec2(TexCoords.xy * vec2(${g[0]}, ${g[1]}));
        }
      `,new R(b);let et=g,st=Math.ceil(d[1]/2);return b=`
        ivec2 getOutputCoords() {
          ivec2 resTexRC = ivec2(TexCoords.xy *
                                vec2(${et[0]}, ${et[1]}));

          int index = resTexRC.y * ${et[0]} + resTexRC.x;

          // reverse r and c order for packed texture
          int r = imod(index, ${st}) * 2;
          int c = 2 * (index / ${st});

          return ivec2(r, c);
        }
      `,new R(b)}getOutputPacked3DCoords(d,g){let b=[g[0],g[1]],et=Math.ceil(d[2]/2),st=et*Math.ceil(d[1]/2),at=`
        ivec3 getOutputCoords() {
          ivec2 resTexRC = ivec2(TexCoords.xy *
                                vec2(${b[0]}, ${b[1]}));
          int index = resTexRC.y * ${b[0]} + resTexRC.x;

          int b = index / ${st};
          index -= b * ${st};

          // reverse r and c order for packed texture
          int r = imod(index, ${et}) * 2;
          int c = 2 * (index / ${et});

          return ivec3(b, r, c);
        }
      `;return new R(at)}getOutputPackedNDCoords(d,g){let b=[g[0],g[1]],et=Math.ceil(d[d.length-1]/2),st=et*Math.ceil(d[d.length-2]/2),at=st,vt="",Tt="b, r, c";for(let pt=2;pt<d.length-1;pt++)at*=d[d.length-pt-1],vt=`
      int b${pt} = index / ${at};
      index -= b${pt} * ${at};
    `+vt,Tt=`b${pt}, `+Tt;let Ct=`
      ivec${d.length} getOutputCoords() {
        ivec2 resTexRC = ivec2(TexCoords.xy *
                              vec2(${b[0]}, ${b[1]}));
        int index = resTexRC.y * ${b[0]} + resTexRC.x;

        ${vt}

        int b = index / ${st};
        index -= b * ${st};

        // reverse r and c order for packed texture
        int r = imod(index, ${et}) * 2;
        int c = 2 * (index / ${et});

        return ivec${d.length}(${Tt});
      }
    `;return new R(Ct)}getOutputUnpacked1DCoords(d,g){let b=`
        int getOutputCoords() {
          ivec2 resTexRC = ivec2(TexCoords.xy *
                                vec2(${g[0]}, ${g[1]}));
          return resTexRC.y * ${g[0]} + resTexRC.x;
        }
      `;return new R(b)}getOutputUnpacked2DCoords(d,g){let b=`
        ivec2 getOutputCoords() {
          ivec2 resTexRC = ivec2(TexCoords.xy *
                                vec2(${g[0]}, ${g[1]}));
          int index = resTexRC.y * ${g[0]} + resTexRC.x;
          int r = index / ${d[1]};
          int c = index - r * ${d[1]};
          return ivec2(r, c);
        }
      `;return new R(b)}getOutputUnpacked3DCoords(d,g){let b="",et=d.length,st=null;et<2&&(st=[]),st=new Array(et-1),st[et-2]=d[et-1];for(let Tt=et-3;Tt>=0;--Tt)st[Tt]=st[Tt+1]*d[Tt+1];let at=["r","c","d"],vt=st.map((Tt,Ct)=>{let pt=`int ${at[Ct]} = index / ${Tt}`,wt=Ct===st.length-1?`int ${at[Ct+1]} = index - ${at[Ct]} * ${Tt}`:`index -= ${at[Ct]} * ${Tt}`;return`${pt}; ${wt};`}).join("");return b=`
        ivec3 getOutputCoords() {
          ivec2 resTexRC = ivec2(TexCoords.xy *
                                vec2(${g[0]}, ${g[1]}));
          int index = resTexRC.y * ${g[0]} + resTexRC.x;
          ${vt}
          return ivec3(r, c, d);
        }
      `,new R(b)}getOutputUnpacked4DCoords(d,g){let b="",et=d.length,st=null;et<2&&(st=[]),st=new Array(et-1),st[et-2]=d[et-1];for(let Tt=et-3;Tt>=0;--Tt)st[Tt]=st[Tt+1]*d[Tt+1];let at=["r","c","d","d2"],vt=st.map((Tt,Ct)=>{let pt=`int ${at[Ct]} = index / ${Tt}`,wt=Ct===st.length-1?`int ${at[Ct+1]} = index - ${at[Ct]} * ${Tt}`:`index -= ${at[Ct]} * ${Tt}`;return`${pt}; ${wt};`}).join("");return b=`
      ivec4 getOutputCoords() {
          ivec2 resTexRC = ivec2(TexCoords.xy *
                                vec2(${g[0]}, ${g[1]}));
          int index = resTexRC.y * ${g[0]} + resTexRC.x;
          ${vt}
          return ivec4(r, c, d, d2);
        }
      `,new R(b)}getOutputUnpacked5DCoords(d,g){let b="",et=d.length,st=null;et<2&&(st=[]),st=new Array(et-1),st[et-2]=d[et-1];for(let Tt=et-3;Tt>=0;--Tt)st[Tt]=st[Tt+1]*d[Tt+1];let at=["r","c","d","d2","d3"],vt=st.map((Tt,Ct)=>{let pt=`int ${at[Ct]} = index / ${Tt}`,wt=Ct===st.length-1?`int ${at[Ct+1]} = index - ${at[Ct]} * ${Tt}`:`index -= ${at[Ct]} * ${Tt}`;return`${pt}; ${wt};`}).join("");return b=`
      ivec5 getOutputCoords() {
          ivec2 resTexRC = ivec2(TexCoords.xy *
                                vec2(${g[0]}, ${g[1]}));
          int index = resTexRC.y * ${g[0]} + resTexRC.x;
          ${vt}
          return ivec5(r, c, d, d2, d3);
        }
      `,new R(b)}getOutputUnpacked6DCoords(d,g){let b="",et=d.length,st=null;et<2&&(st=[]),st=new Array(et-1),st[et-2]=d[et-1];for(let Tt=et-3;Tt>=0;--Tt)st[Tt]=st[Tt+1]*d[Tt+1];let at=["r","c","d","d2","d3","d4"],vt=st.map((Tt,Ct)=>{let pt=`int ${at[Ct]} = index / ${Tt}`,wt=Ct===st.length-1?`int ${at[Ct+1]} = index - ${at[Ct]} * ${Tt}`:`index -= ${at[Ct]} * ${Tt}`;return`${pt}; ${wt};`}).join("");return b=`
     ivec6 getOutputCoords() {
         ivec2 resTexRC = ivec2(TexCoords.xy *
                               vec2(${g[0]}, ${g[1]}));
         int index = resTexRC.y * ${g[0]} + resTexRC.x;
         ${vt}
         return ivec6(r, c, d, d2, d3, d4);
       }
     `,new R(b)}getCommonUtilFuncs(){let d={},g="uvFromFlat";d[g]=new R(`
    vec2 uvFromFlat(int texNumR, int texNumC, int index) {
      int texC = index / texNumR;
      int texR = index - texC * texNumR;
      // TODO: swap texR, texC order in following function so row is corresponding to u and column is corresponding to
      //       v.
      return (vec2(texR, texC) + halfCR) / vec2(texNumR, texNumC);
    }
    `),g="packedUVfrom1D",d[g]=new R(`
      vec2 packedUVfrom1D(int texNumR, int texNumC, int index) {
        int texelIndex = index / 2;
        int texR = texelIndex / texNumC;
        int texC = texelIndex - texR * texNumC;
        return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);
      }
      `),g="packedUVfrom2D",d[g]=new R(`
      vec2 packedUVfrom2D(int texNumR, int texNumC, int texelsInLogicalRow, int row, int col) {
        int texelIndex = (row / 2) * texelsInLogicalRow + (col / 2);
        int texR = texelIndex / texNumC;
        int texC = texelIndex - texR * texNumC;
        return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);
      }
      `),g="packedUVfrom3D",d[g]=new R(`
      vec2 packedUVfrom3D(int texNumR, int texNumC,
          int texelsInBatch, int texelsInLogicalRow, int b,
          int row, int col) {
        int index = b * texelsInBatch + (row / 2) * texelsInLogicalRow + (col / 2);
        int texR = index / texNumC;
        int texC = index - texR * texNumC;
        return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);
      }
      `),g="sampleTexture";let b=H(this.context.glContext.version);return d[g]=new R(`
        float sampleTexture(sampler2D textureSampler, vec2 uv) {
            return ${b.texture2D}(textureSampler, uv).r;
        }`),d}getInputsSamplingSnippets(){let d={},g=this.context.outputTextureLayout;return this.context.programInfo.inputNames.forEach((b,et)=>{let st=this.context.inputTextureLayouts[et],at=Yn$1(b);st.isPacked?d[at]=this.getPackedSamplerFromInput(at,b,st):d[at]=this.getUnpackedSamplerFromInput(at,b,st);let vt=Gu$1(b);st.unpackedShape.length<=g.unpackedShape.length&&(st.isPacked?d[vt]=this.getPackedSamplerAtOutputCoords(vt,st,g,b):d[vt]=this.getUnpackedSamplerAtOutputCoords(vt,st,g,b))}),d}getPackedSamplerAtOutputCoords(d,g,b,et){let st=g.unpackedShape,at=b.unpackedShape,vt=Yn$1(et),Tt=st.length,Ct=at.length,pt=Ze$1.getBroadcastDims(st,at),wt=Qe(Ct),$t=Ct-Tt,Lt,jt=Dt$1();Tt===0?Lt="":Ct<2&&pt.length>=1?Lt="coords = 0;":Lt=pt.map(ir=>`coords.${jt[ir+$t]} = 0;`).join(`
`);let Ft="";Ct<2&&Tt>0?Ft="coords":Ft=st.map((ir,or)=>`coords.${jt[or+$t]}`).join(", ");let Gt="return outputValue;",Ht=U$2.size(st)===1,qt=U$2.size(at)===1;if(Tt===1&&!Ht&&!qt)Gt=`
        return vec4(outputValue.xy, outputValue.xy);
      `;else if(Ht&&!qt)Ct===1?Gt=`
          return vec4(outputValue.x, outputValue.x, 0., 0.);
        `:Gt=`
          return vec4(outputValue.x);
        `;else if(pt.length){let ir=Tt-2,or=Tt-1;pt.indexOf(ir)>-1&&pt.indexOf(or)>-1?Gt="return vec4(outputValue.x);":pt.indexOf(ir)>-1?Gt="return vec4(outputValue.x, outputValue.y, outputValue.x, outputValue.y);":pt.indexOf(or)>-1&&(Gt="return vec4(outputValue.xx, outputValue.zz);")}let Kt=`
        int lastDim = coords.${jt[Ct-1]};
        coords.${jt[Ct-1]} = coords.${jt[Ct-2]};
        coords.${jt[Ct-2]} = lastDim;
      `,rr=`
      vec4 ${d}() {
        ${wt} coords = getOutputCoords();
        ${Kt}
        ${Lt}
        vec4 outputValue = ${vt}(${Ft});
        ${Gt}
      }
    `;return new R(rr,["coordinates.getOutputCoords"])}getUnpackedSamplerAtOutputCoords(d,g,b,et){let st=[b.width,b.height],at=[g.width,g.height],vt=g.unpackedShape.length,Tt=b.unpackedShape.length,Ct=g.unpackedShape,pt=b.unpackedShape,wt=Yn$1(et);if(vt===Tt&&hr$1.arraysEqual(at,st)){let Kt=`
          float ${d}() {
            return sampleTexture(${et}, TexCoords);
          }
        `;return new R(Kt,["coordinates.sampleTexture"])}let $t=Qe(Tt),Lt=Ze$1.getBroadcastDims(Ct,pt),jt=Tt-vt,Ft,Gt=Dt$1();vt===0?Ft="":Tt<2&&Lt.length>=1?Ft="coords = 0;":Ft=Lt.map(Kt=>`coords.${Gt[Kt+jt]} = 0;`).join(`
`);let Ht="";Tt<2&&vt>0?Ht="coords":Ht=g.unpackedShape.map((Kt,rr)=>`coords.${Gt[rr+jt]}`).join(", ");let qt=`
        float ${d}() {
          ${$t} coords = getOutputCoords();
          ${Ft}
          return ${wt}(${Ht});
        }
      `;return new R(qt,["coordinates.getOutputCoords"])}getPackedSamplerFromInput(d,g,b){switch(b.unpackedShape.length){case 0:return this.getPackedSamplerScalar(d,g);case 1:return this.getPackedSampler1D(d,g,b);case 2:return this.getPackedSampler2D(d,g,b);case 3:return this.getPackedSampler3D(d,g,b);default:return this.getPackedSamplerND(d,g,b)}}getUnpackedSamplerFromInput(d,g,b){let et=b.unpackedShape;switch(et.length){case 0:return this.getUnpackedSamplerScalar(d,g,b);case 1:return this.getUnpackedSampler1D(d,g,b);case 2:return this.getUnpackedSampler2D(d,g,b);case 3:return this.getUnpackedSampler3D(d,g,b);case 4:return this.getUnpackedSampler4D(d,g,b);case 5:return this.getUnpackedSampler5D(d,g,b);case 6:return this.getUnpackedSampler6D(d,g,b);default:throw new Error(`Unsupported dimension ${et.length}-D`)}}getPackedSamplerScalar(d,g){let b=H(this.context.glContext.version),et=`
          vec4 ${d}() {
            return ${b.texture2D}(${g}, halfCR);
          }
        `;return new R(et)}getPackedSampler1D(d,g,b){let et=[b.width,b.height],st=[et[1],et[0]],at=H(this.context.glContext.version),vt=`vec4 ${d}(int index) {
      vec2 uv = packedUVfrom1D(
      ${st[0]}, ${st[1]}, index);
      return ${at.texture2D}(${g}, uv);
    }`;return new R(vt,["coordinates.packedUVfrom1D"])}getPackedSampler2D(d,g,b){let et=b.unpackedShape,st=[b.width,b.height],at=H(this.context.glContext.version),vt=st[0],Tt=st[1];if(st!=null&&hr$1.arraysEqual(et,st)){let $t=`vec4 ${d}(int row, int col) {
        vec2 uv = (vec2(col, row) + halfCR) / vec2(${Tt}.0, ${vt}.0);
        return ${at.texture2D}(${g}, uv);
      }`;return new R($t)}let Ct=st,pt=Math.ceil(et[1]/2),wt=`vec4 ${d}(int row, int col) {
      vec2 uv = packedUVfrom2D(${Ct[1]}, ${Ct[0]}, ${pt}, row, col);
      return ${at.texture2D}(${g}, uv);
    }`;return new R(wt,["coordinates.packedUVfrom2D"])}getPackedSampler3D(d,g,b){let et=b.unpackedShape,st=[b.width,b.height],at=[st[0],st[1]],vt=H(this.context.glContext.version);if(et[0]===1){let Lt=et.slice(1),jt=[1,2],Ft=$r(et,Lt),Gt=["b","row","col"],Ht=JSON.parse(JSON.stringify(b));Ht.unpackedShape=Ft;let qt=this.getPackedSamplerFromInput(d,g,Ht),Kt=`${qt.routineBody}
      vec4 ${d}(int b, int row, int col) {
        return ${d}(${kr$1(Gt,jt)});
      } `;return new R(Kt,qt.dependencies)}let Tt=at[0],Ct=at[1],pt=Math.ceil(et[2]/2),wt=pt*Math.ceil(et[1]/2),$t=`vec4 ${d}(int b, int row, int col) {
      vec2 uv = packedUVfrom3D(
        ${Ct}, ${Tt}, ${wt}, ${pt}, b, row, col);
      return ${vt.texture2D}(${g}, uv);}`;return new R($t,["coordinates.packedUVfrom3D"])}getPackedSamplerND(d,g,b){let et=b.unpackedShape,st=et.length,at=[b.width,b.height],vt=H(this.context.glContext.version),Tt=[at[0],at[1]],Ct=Tt[1],pt=Tt[0],wt=Math.ceil(et[st-1]/2),$t=wt*Math.ceil(et[st-2]/2),Lt="int b, int row, int col",jt=`b * ${$t} + (row / 2) * ${wt} + (col / 2)`;for(let Gt=2;Gt<st-1;Gt++)Lt=`int b${Gt}, `+Lt,$t*=et[st-Gt-1],jt=`b${Gt} * ${$t} + `+jt;let Ft=`vec4 ${d}(${Lt}) {
      int index = ${jt};
      int texR = index / ${pt};
      int texC = index - texR * ${pt};
      vec2 uv = (vec2(texC, texR) + halfCR) / vec2(${pt}, ${Ct});
      return ${vt.texture2D}(${g}, uv);
    }`;return new R(Ft)}getUnpackedSamplerScalar(d,g,b){let[et,st]=[b.width,b.height];if(et===1&&st===1){let vt=`
          float ${d}() {
            return sampleTexture(${g}, halfCR);
          }
        `;return new R(vt,["coordinates.sampleTexture"])}let at=`
        float ${d}() {
          int offset_${g} = coordsToOffset(TexCoords, ${et}, ${st});
          vec2 uv = uvFromFlat(${et}, ${st}, offset_${g});
          return sampleTexture(${g}, uv);
        }
      `;return new R(at,["coordinates.uvFromFlat","coordinates.sampleTexture","coordinates.coordsToOffset"])}getUnpackedSampler1D(d,g,b){let et=b.width,st=b.height;if(st===1&&et===1){let vt=`
        float ${d}(int index) {
          return sampleTexture(${g}, halfCR);
        }
      `;return new R(vt,["coordinates.sampleTexture"])}if(st===1){let vt=`
          float ${d}(int index) {
            vec2 uv = vec2((float(index) + 0.5) / ${et}.0, 0.5);
            return sampleTexture(${g}, uv);
          }
        `;return new R(vt,["coordinates.sampleTexture"])}if(et===1){let vt=`
          float ${d}(int index) {
            vec2 uv = vec2(0.5, (float(index) + 0.5) / ${st}.0);
            return sampleTexture(${g}, uv);
          }
        `;return new R(vt,["coordinates.sampleTexture"])}let at=`
        float ${d}(int index) {
          vec2 uv = uvFromFlat(${et}, ${st}, index);
          return sampleTexture(${g}, uv);
        }
      `;return new R(at,["coordinates.uvFromFlat","coordinates.sampleTexture"])}getUnpackedSampler2D(d,g,b){let et=b.unpackedShape,st=[b.height,b.width];if(st!=null&&hr$1.arraysEqual(et,st)){let $t=st[1],Lt=st[0],jt=`
          float ${d}(int row, int col) {
            vec2 uv = (vec2(row, col) + halfCR) / vec2(${$t}.0, ${Lt}.0);
            return sampleTexture(${g}, uv);
          }
        `;return new R(jt,["coordinates.sampleTexture"])}let{newShape:at,keptDims:vt}=Mr(et),Tt=at;if(Tt.length<et.length){let $t=$r(et,Tt),Lt=JSON.parse(JSON.stringify(b));Lt.unpackedShape=$t;let jt=["col","row"],Ft=`
          ${this.getUnpackedSamplerFromInput(d,g,Lt).routineBody}
          float ${d}(int row, int col) {
            return ${d}(${kr$1(jt,vt)});
          }
        `;return new R(Ft,["coordinates.sampleTexture"])}let Ct=st[1],pt=st[0];if(pt===1){let $t=`
          float ${d}(int row, int col) {
            int offset_${g} = coordsToOffset(TexCoords, ${Ct}, ${pt});
            float index = dot(vec3(row, col, offset_${g}), vec3(${et[1]}, 1, 1));
            vec2 uv = vec2(0.5, (index + 0.5) / ${Ct}.0);
            return sampleTexture(${g}, uv);
          }
        `;return new R($t,["coordinates.sampleTexture","coordinates.coordsToOffset"])}if(Ct===1){let $t=`
          float ${d}(int row, int col) {
            int offset_${g} = coordsToOffset(TexCoords, ${Ct}, ${pt});
            float index = dot(vec3(row, col, offset_${g}), vec3(${et[1]}, 1, 1));
            vec2 uv = vec2((index + 0.5) / ${pt}.0, 0.5);
            return sampleTexture(${g}, uv);
          }
        `;return new R($t,["coordinates.sampleTexture","coordinates.coordsToOffset"])}let wt=`
        float ${d}(int row, int col) {
          int index = col * ${et[1]} + row;
          vec2 uv = uvFromFlat(${Ct}, ${pt}, index);
          return sampleTexture(${g}, uv);
        }
      `;return new R(wt,["coordinates.uvFromFlat","coordinates.sampleTexture","coordinates.coordsToOffset"])}getUnpackedSampler3D(d,g,b){let et=b.unpackedShape,st=et[1]*et[2],at=et[2],{newShape:vt,keptDims:Tt}=Mr(et),Ct=vt;if(Ct.length<et.length){let Lt=$r(et,Ct),jt=["batch","col","row"],Ft=JSON.parse(JSON.stringify(b));Ft.unpackedShape=Lt;let Gt=this.getUnpackedSamplerFromInput(d,g,Ft),Ht=Tt.reverse(),qt=`
          ${Gt.routineBody}
          float ${d}(int batch, int row, int col) {
            return ${d}(${kr$1(jt,Ht)});
          }
        `;return new R(qt,Gt.dependencies)}let pt=b.width,wt=b.height,$t=`
          float ${d}(int depth, int row, int col) {
            // Explicitly use integer operations as dot() only works on floats.
            int index = depth * ${st} + col * ${at} + row;
            vec2 uv = uvFromFlat(${pt}, ${wt}, index);
            return sampleTexture(${g}, uv);
          }
      `;return new R($t,["coordinates.uvFromFlat","coordinates.sampleTexture","coordinates.coordsToOffset"])}getUnpackedSampler4D(d,g,b){let et=b.unpackedShape,st=et[3],at=et[2]*st,vt=et[1]*at,Tt=b.width,Ct=b.height,pt=`
        float ${d}(int row, int col, int depth, int depth2) {
          int index = row * ${vt} + col * ${at} +
              depth2 * ${st} + depth;
          vec2 uv = uvFromFlat(${Tt}, ${Ct}, index);
          return sampleTexture(${g}, uv);
        }
      `;return new R(pt,["coordinates.uvFromFlat","coordinates.sampleTexture"])}getUnpackedSampler5D(d,g,b){let et=b.unpackedShape,st=et[4],at=et[3]*st,vt=et[2]*at,Tt=et[1]*vt,{newShape:Ct,keptDims:pt}=Mr(et);if(Ct.length<et.length){let jt=$r(et,Ct),Ft=["row","col","depth","depth2","depth3"],Gt=JSON.parse(JSON.stringify(b));Gt.unpackedShape=jt;let Ht=`
          ${this.getUnpackedSamplerFromInput(d,g,Gt).routineBody}
          float ${d}(int row, int col, int depth, int depth2, int depth3) {
            return ${d}(${kr$1(Ft,pt)});
          }
        `;return new R(Ht,["coordinates.sampleTexture","coordinates.uvFromFlat"])}let wt=b.width,$t=b.height,Lt=`
        float ${d}(int row, int col, int depth, int depth2, int depth3) {
          int index = row * ${Tt} + col * ${vt} + depth * ${at} +
          depth3 * ${st} + depth2;
          vec2 uv = uvFromFlat(${wt}, ${$t}, index);
          return sampleTexture(${g}, uv);
        }
      `;return new R(Lt,["coordinates.sampleTexture","coordinates.uvFromFlat"])}getUnpackedSampler6D(d,g,b){let et=b.unpackedShape,st=et[5],at=et[4]*st,vt=et[3]*at,Tt=et[2]*vt,Ct=et[1]*Tt,{newShape:pt,keptDims:wt}=Mr(et);if(pt.length<et.length){let Ft=$r(et,pt),Gt=["row","col","depth","depth2","depth3","depth4"],Ht=JSON.parse(JSON.stringify(b));Ht.unpackedShape=Ft;let qt=`
            ${this.getUnpackedSamplerFromInput(d,g,Ht).routineBody}
            float ${d}(int row, int col, int depth,
              int depth2, int depth3, int depth4) {
              return ${d}(${kr$1(Gt,wt)});
            }
          `;return new R(qt,["coordinates.sampleTexture","coordinates.uvFromFlat"])}let $t=b.width,Lt=b.height,jt=`
          float ${d}(int row, int col, int depth,
            int depth2, int depth3, int depth4) {
            int index = row * ${Ct} + col * ${Tt} + depth * ${vt} +
            depth2 * ${at} + depth3 * ${st} + depth4;
            vec2 uv = uvFromFlat(${$t}, ${Lt}, index);
            return sampleTexture(${g}, uv);
          }
        `;return new R(jt,["coordinates.uvFromFlat","coordinates.sampleTexture","coordinates.coordsToOffset"])}toVec(){let d=this.context.outputTextureLayout,g=d.shape.length,b=d.strides,et=d.width,st=d.height,at=[];for(let Tt=0;Tt<g-1;++Tt)at.push(`
        c[${Tt}] = offset / ${b[Tt]};`),at.push(`
        offset -= c[${Tt}] * ${b[Tt]};`);at.push(`
        c[${g-1}] = offset;`);let vt=`
      void toVec(vec2 texCoords, out int c[${g}]) {
        int offset = coordsToOffset(texCoords, ${et}, ${st});
        ${at.join("")}
      }
      void toVec(int offset, out int c[${g}]) {
        ${at.join("")}
      }
    `;return{toVec:new R(vt,["coordinates.coordsToOffset"])}}valueFrom(){let d={};return this.context.programInfo.inputNames.forEach((g,b)=>{let et=this.context.inputTextureLayouts[b],st=(et.unpackedShape.length>0?et.unpackedShape:et.shape).length,at=`_${g}`;d[at]=new R(this.getValueFromSingle(g,st,et.width,et.height,!1),[`shapeUtils.indicesToOffset${at}`,"coordinates.offsetToCoords","fragcolor.getColorAsFloat"]),at=at+"_T",d[at]=new R(this.getValueFromSingle(g,st,et.width,et.height,!0),[`shapeUtils.indicesToOffset${at}`,"coordinates.offsetToCoords","fragcolor.getColorAsFloat"])}),d}getValueFromSingle(d,g,b,et,st){let at=`_${d}`;st&&(at=at+"_T");let vt=H(this.context.glContext.version);return`
        float ${at}(int m[${g}]) {
          int offset = indicesToOffset${at}(m);
          vec2 coords = offsetToCoords(offset, ${b}, ${et});
          float value = getColorAsFloat(${vt.texture2D}(${d}, coords));
          return value;
        }
        `}getPackedValueFrom(d,g,b,et,st){let at=`_${d}_Pack`;st&&(at=at+"_T");let vt=H(this.context.glContext.version);return`
        vec4 ${at}(int m[${g}]) {
          int offset = indicesToOffset_${d}(m);
          vec2 coords = offsetToCoords(offset, ${b}, ${et});
          return ${vt.texture2D}(${d}, coords);
        }
        `}}}),fo$1,tp$1=L$1(()=>{Wt$1(),fo$1=class Vw extends dt{constructor(g){super(g)}getFunctions(){return{...this.encodeFloat32(),...this.decodeFloat32()}}getCustomTypes(){return{}}encodeFloat32(){return{encode:new R(`highp vec4 encode(highp float f) {
        return vec4(f, 0.0, 0.0, 0.0);
      }
        `)}}decodeFloat32(){return{decode:new R(`highp float decode(highp vec4 rgba) {
        return rgba.r;
      }
        `)}}encodeUint8(){let g=Vw.isLittleEndian()?"rgba.rgba=rgba.abgr;":"";return{encode:new R(`
      highp vec4 encode(highp float f) {
        highp float F = abs(f);
        highp float Sign = step(0.0,-f);
        highp float Exponent = floor(log2(F));
        highp float Mantissa = (exp2(- Exponent) * F);
        Exponent = floor(log2(F) + 127.0) + floor(log2(Mantissa));
        highp vec4 rgba;
        rgba[0] = 128.0 * Sign  + floor(Exponent*exp2(-1.0));
        rgba[1] = 128.0 * mod(Exponent,2.0) + mod(floor(Mantissa*128.0),128.0);
        rgba[2] = floor(mod(floor(Mantissa*exp2(23.0 -8.0)),exp2(8.0)));
        rgba[3] = floor(exp2(23.0)*mod(Mantissa,exp2(-15.0)));
        ${g}
        rgba = rgba / 255.0; // values need to be normalized to [0,1]
        return rgba;
    }
        `)}}decodeUint8(){let g=Vw.isLittleEndian()?"rgba.rgba=rgba.abgr;":"";return{decode:new R(`
        highp float decode(highp vec4 rgba) {
          rgba = rgba * 255.0; // values need to be de-normalized from [0,1] to [0,255]
          ${g}
          highp float Sign = 1.0 - step(128.0,rgba[0])*2.0;
          highp float Exponent = 2.0 * mod(rgba[0],128.0) + step(128.0,rgba[1]) - 127.0;
          highp float Mantissa = mod(rgba[1],128.0)*65536.0 + rgba[2]*256.0 +rgba[3] + float(0x800000);
          highp float Result =  Sign * exp2(Exponent) * (Mantissa * exp2(-23.0 ));
          return Result;
      }
        `)}}static isLittleEndian(){let g=new ArrayBuffer(4),b=new Uint32Array(g),et=new Uint8Array(g);if(b[0]=3735928559,et[0]===239)return!0;if(et[0]===222)return!1;throw new Error("unknown endianness")}}}),co$1,rp$1=L$1(()=>{Wt$1(),we$1(),co$1=class extends dt{constructor(d){super(d)}getFunctions(){return{...this.setFragColor(),...this.getColorAsFloat()}}getCustomTypes(){return{}}setFragColor(){let d=H(this.context.glContext.version);return{setFragColor:new R(`
        void setFragColor(float value) {
            ${d.output} = encode(value);
        }
        `,["encoding.encode"])}}getColorAsFloat(){return{getColorAsFloat:new R(`
        float getColorAsFloat(vec4 color) {
            return decode(color);
        }
        `,["encoding.decode"])}}}}),po$1,np$1=L$1(()=>{Wt$1(),po$1=class Hx extends dt{constructor(g){super(g)}getFunctions(){return{...this.bcastIndex(),...this.bcastMatmulIndex(),...this.offsetToIndices(),...this.indicesToOffset(),...this.incrementIndices()}}getCustomTypes(){return{}}bcastIndex(){let g=this.context.outputTextureLayout.shape.length,b={};return this.context.programInfo.inputNames.forEach((et,st)=>{let at=this.context.inputTextureLayouts[st].unpackedShape;if(at.length<=g){let vt=at.length,Tt=g-vt,Ct=`bcastIndices_${et}`,pt="";for(let $t=0;$t<vt;++$t)pt+=`
          realIndices[${$t}] = int( mod(float(bcastedIndices[${Tt+$t}]), ${at[$t]}.0) );
          `;let wt=`
        void ${Ct} (int bcastedIndices[${g}], out int realIndices[${vt}]) {
          ${pt}
        }
        `;b[Ct]=new R(wt)}}),b}bcastMatmulIndex(){let g=this.context.outputTextureLayout.shape.length,b={};return this.context.programInfo.inputNames.forEach((et,st)=>{let at=this.context.inputTextureLayouts[st].shape;if(!(at.length<2||at.length>g)){let vt=at.length,Tt=g-vt,Ct=`bcastMatmulIndices_${et}`,pt="";for(let $t=0;$t<vt-2;++$t)pt+=`
          realIndices[${$t}] = int( mod(float(bcastedIndices[${Tt+$t}]), ${at[$t]}.0) );
          `;let wt=`
        void ${Ct}(int bcastedIndices[${g}], out int realIndices[${vt}]) {
          ${pt}
          realIndices[${vt-1}] = bcastedIndices[${g-1}];
          realIndices[${vt-2}] = bcastedIndices[${g-2}];
        }
        `;b[Ct]=new R(wt)}}),b}indicesToOffset(){let g={};return this.context.programInfo.inputNames.forEach((b,et)=>{let st=this.context.inputTextureLayouts[et].shape,at=this.context.inputTextureLayouts[et].strides,vt=st.length,Tt=`indicesToOffset_${b}`;g[Tt]=new R(Hx.indexToOffsetSingle(Tt,vt,at)),Tt=`indicesToOffset_${b}_T`,g[Tt]=new R(Hx.indexToOffsetSingle(Tt,vt,at.slice().reverse()))}),g}static indexToOffsetSingle(g,b,et){let st="";for(let at=b-1;at>=0;--at)st+=`
        offset += indices[${at}] * ${et[at]};
        `;return`
      int ${g}(int indices[${b}]) {
        int offset = 0;
        ${st}
        return offset;
      }
      `}offsetToIndices(){let g={};return this.context.programInfo.inputNames.forEach((b,et)=>{let st=this.context.inputTextureLayouts[et].shape,at=this.context.inputTextureLayouts[et].strides,vt=st.length,Tt=`offsetToIndices_${b}`;g[Tt]=new R(Hx.offsetToIndicesSingle(Tt,vt,at)),Tt=`offsetToIndices_${b}_T`,g[Tt]=new R(Hx.offsetToIndicesSingle(Tt,vt,at.slice().reverse()))}),g}static offsetToIndicesSingle(g,b,et){let st=[];for(let at=0;at<b-1;++at)st.push(`
      indices[${at}] = offset / ${et[at]};`),st.push(`
        offset -= indices[${at}] * ${et[at]};`);return st.push(`
      indices[${b-1}] = offset;`),`
      void ${g}(int offset, out int indices[${b}]) {
        ${st.join("")}
      }
      `}incrementIndices(){let g={};return this.context.programInfo.inputNames.forEach((b,et)=>{let st=this.context.inputTextureLayouts[et].shape,at=st.length,vt=`incrementIndices_${b}`,Tt="";for(let pt=0;pt<at;++pt)Tt+=`
        shape[${pt}] = ${st[pt]};`;let Ct=`
        void ${vt}(int axis, out int indices[${at}]) {
          int shape[${at}];
          ${Tt};
          for(int i = ${at} -1 ; i >= 0; --i) {
            if(i > axis) continue;
            indices[i] += 1;
            if(indices[i] < shape[i]) {
              break;
            }
            indices[i] = 0;
          }
        }
        `;g[vt]=new R(Ct)}),g}}}),ho$1,op$1=L$1(()=>{Wt$1(),ho$1=class extends dt{constructor(d){super(d)}getCustomTypes(){return{}}getFunctions(){return{...this.binaryVecFunctions(),...this.copyVec(),...this.setVecItem(),...this.getVecItem()}}binaryVecFunctions(){let d=this.context.outputTextureLayout.shape.length,g={add:"+=",sub:"-=",mul:"*=",div:"/="},b={};for(let et in g){let st=`${et}Vec`,at="";for(let Tt=0;Tt<d;++Tt)at+=`
          dest[${Tt}] ${g[et]} src[${Tt}];
          `;let vt=`
        void ${st}(int src[${d}], out int dest[${d}]) {
          ${at}
        }
        `;b[st]=new R(vt)}return b}copyVec(){let d=this.context.outputTextureLayout.shape.length,g="";for(let et=0;et<d;++et)g+=`
        dest[${et}] = src[${et}];
        `;let b=`
      void copyVec(int src[${d}], out int dest[${d}]) {
        ${g}
      }
      `;return{copyVec:new R(b)}}setVecItem(){let d=this.context.outputTextureLayout.shape.length,g=`
        if(index < 0)
            index =${d} + index;
        if (index == 0)
            m[0] = value;
        `;for(let et=1;et<d-1;++et)g+=`
        else if (index == ${et})
            m[${et}] = value;
            `;g+=`
        else
            m[${d-1}] = value;
        `;let b=`
      void setVecItem(out int m[${d}], int index, int value) {
        ${g}
      }
        `;return{setVecItem:new R(b)}}getVecItem(){let d=this.context.outputTextureLayout.shape.length,g=`
        if(index < 0)
            index = ${d} + index;
        if (index == 0)
            return m[0];
      `;for(let et=1;et<d-1;++et)g+=`
        else if (index == ${et})
            return m[${et}];
      `;g+=`
        else
            return m[${d-1}];
        `;let b=`
      int getVecItem(int m[${d}], int index) {
        ${g}
      }
    `;return{getVecItem:new R(b)}}}}),Wi$1,ip$1=L$1(()=>{ep$1(),tp$1(),rp$1(),np$1(),op$1(),Wi$1={encoding:fo$1,fragcolor:co$1,vec:ho$1,shapeUtils:po$1,coordinates:lo$1}}),mo$1,ap$1=L$1(()=>{Wt$1(),Zc$1(),ip$1(),we$1(),mo$1=class{constructor(d,g,b,et){this.libs={},this.glslLibRoutineDependencyGraph={},this.context=new Zn$1(d,g,b,et),Object.keys(Wi$1).forEach(at=>{let vt=new Wi$1[at](this.context);this.libs[at]=vt});let st=this.glslLibRoutineDependencyGraph;for(let at in this.libs){let vt=this.libs[at].getFunctions();for(let Tt in vt){let Ct=at+"."+Tt,pt;st[Ct]?(pt=st[Ct],pt.routineBody=vt[Tt].routineBody):(pt=new cn(Ct,vt[Tt].routineBody),st[Ct]=pt);let wt=vt[Tt].dependencies;if(wt)for(let $t=0;$t<wt.length;++$t)if(st[wt[$t]])pt.addDependency(st[wt[$t]]);else{let Lt=new cn(wt[$t]);st[wt[$t]]=Lt,pt.addDependency(Lt)}}}}preprocess(){let d=this.context.programInfo,g=d.shaderSource;return this.context.programInfo.hasMain||(g=`${g}
      ${Mu$1(this.context.glContext.version,this.context.outputTextureLayout.shape.length)}`),g=Jc$1(g),`${Ru$1(this.context.glContext.version)}
    ${this.getUniforms(d.inputNames,d.variables)}
    ${this.getImports(g)}
    ${g}`}getImports(d){let g=this.selectGlslLibRoutinesToBeIncluded(d);if(g.length===0)return"";let b="";for(let et=0;et<g.length;++et)if(g[et].routineBody)b+=g[et].routineBody+`
`;else throw new Error(`Missing body for the Glsl Library routine: ${g[et].name}`);return b}selectGlslLibRoutinesToBeIncluded(d){let g=[];return Object.keys(this.glslLibRoutineDependencyGraph).forEach(b=>{let et=b.split(".")[1];d.indexOf(et)!==-1&&g.push(this.glslLibRoutineDependencyGraph[b])}),Qn$1.returnOrderedNodes(g)}getUniforms(d,g){let b=[];if(d)for(let et of d)b.push(`uniform sampler2D ${et};`);if(g)for(let et of g)b.push(`uniform ${et.type} ${et.name}${et.arrayLength?`[${et.arrayLength}]`:""};`);return b.join(`
`)}}}),bo$1,sp$1=L$1(()=>{Ot$1(),lt$1(),ap$1(),we$1(),bo$1=class{constructor(d,g,b){this.profiler=d,this.glContext=g,this.textureLayoutStrategy=b,this.repo=new Map,this.attributesBound=!1}getArtifact(d){return this.repo.get(d)}setArtifact(d,g){this.repo.set(d,g)}run(d,g,b){this.profiler.event("op",`ProgramManager.run ${d.programInfo.name??"unknown kernel"}`,()=>{let et=this.glContext.gl,st=d.program;et.useProgram(st);try{this.bindOutput(b),this.attributesBound||this.bindAttributes(d.attribLocations),this.bindUniforms(d.uniformLocations,d.programInfo.variables??[],g)}catch(at){throw ce.error("ProgramManager",d.programInfo.shaderSource),at}this.profiler.event("backend","GlContext.draw()",()=>{this.glContext.draw()})},this.glContext)}dispose(){this.vertexShader&&this.glContext.deleteShader(this.vertexShader),this.repo.forEach(d=>this.glContext.deleteProgram(d.program))}build(d,g,b){return this.profiler.event("backend","ProgramManager.build",()=>{let et=new mo$1(this.glContext,d,g,b),st=et.preprocess(),at=this.compile(st);return{programInfo:d,program:at,uniformLocations:this.getUniformLocations(at,et.context.programInfo.inputNames,et.context.programInfo.variables),attribLocations:this.getAttribLocations(at)}})}compile(d){if(!this.vertexShader){ce.verbose("ProrgramManager","Compiling and caching Vertex shader for the first time");let et=Nu$1(this.glContext.version);this.vertexShader=this.glContext.compileShader(et,this.glContext.gl.VERTEX_SHADER)}Z.debug&&ce.verbose("ProrgramManager",`FragShader:
${d}
`);let g=this.glContext.compileShader(d,this.glContext.gl.FRAGMENT_SHADER),b=this.glContext.createProgram(this.vertexShader,g);return this.glContext.deleteShader(g),b}bindOutput(d){let g=d.width,b=d.height;ce.verbose("ProrgramManager",`Binding output texture to Framebuffer: w/h=${g}/${b}, shape=${d.shape}, type=${d.tensor.type}`),this.glContext.attachFramebuffer(d.texture,g,b)}bindAttributes(d){let g=d.position,b=d.textureCoord;this.glContext.setVertexAttributes(g,b),this.attributesBound=!0}bindUniforms(d,g,b){var at;let et=this.glContext.gl,st=0;for(let{name:vt,type:Tt,location:Ct,arrayLength:pt}of d){let wt=(at=g.find($t=>$t.name===vt))==null?void 0:at.data;if(Tt!=="sampler2D"&&!wt)throw new Error(`variable '${vt}' does not have data defined in program info`);switch(Tt){case"sampler2D":this.bindTexture(b[st],Ct,st),st++;break;case"float":pt?et.uniform1fv(Ct,wt):et.uniform1f(Ct,wt);break;case"int":pt?et.uniform1iv(Ct,wt):et.uniform1i(Ct,wt);break;default:throw new Error(`Uniform not implemented: ${Tt}`)}}}bindTexture(d,g,b){this.glContext.bindTextureToUniform(d.texture,b,g)}getAttribLocations(d){return{position:this.getAttribLocation(d,"position"),textureCoord:this.getAttribLocation(d,"textureCoord")}}getUniformLocations(d,g,b){let et=[];if(g)for(let st of g)et.push({name:st,type:"sampler2D",location:this.getUniformLocation(d,st)});if(b)for(let st of b)et.push({...st,location:this.getUniformLocation(d,st.name)});return et}getUniformLocation(d,g){let b=this.glContext.gl.getUniformLocation(d,g);if(b===null)throw new Error(`Uniform ${g} not found.`);return b}getAttribLocation(d,g){return this.glContext.gl.getAttribLocation(d,g)}}}),go$1,up$1=L$1(()=>{lt$1(),ln(),go$1=class{constructor(d,g,b,et){this.glContext=d,this.layoutStrategy=g,this.profiler=b,this.config=et,this.pendingRead=new Map,et.reuseTextures&&(this.inUseTextures=new Map,this.idleTextures=new Map,this.textureLookup=new Map)}createTextureFromLayout(d,g,b,et){let st=this.toEncoderType(d),at=this.glContext.getEncoder(st,g.channels||1,et);if(g.isPacked&&et===1)throw new Error("not implemented");let vt=g.width,Tt=g.height,Ct,pt;if(this.config.reuseTextures){Ct=`${vt}x${Tt}_${at.format}_${at.internalFormat}_${at.textureType}`,pt=this.inUseTextures.get(Ct),pt||(pt=[],this.inUseTextures.set(Ct,pt));let $t=this.idleTextures.get(Ct);if($t&&$t.length>0){let Lt=$t.pop();return pt.push(Lt),et===1&&this.glContext.updateTexture(Lt,vt,Tt,at,this.toTextureData(d,b)),Lt}}ce.verbose("TextureManager",`Creating new texture of size ${g.width}x${g.height}`);let wt=this.glContext.allocateTexture(vt,Tt,at,this.toTextureData(d,b));return this.config.reuseTextures&&(pt.push(wt),this.textureLookup.set(wt,Ct)),wt}readTexture(d,g,b){return b||(b=1),this.profiler.event("backend","TextureManager.readTexture",()=>{let et=d.shape.reduce((at,vt)=>at*vt)*b,st=this.glContext.readTexture(d.texture,d.width,d.height,et,this.toEncoderType(g),b);return this.toTensorData(g,st)})}async readTextureAsync(d,g,b){let et=d.tensor.dataId;if(b||(b=1),this.pendingRead.has(et)){let st=this.pendingRead.get(et);return new Promise(at=>st==null?void 0:st.push(at))}return this.profiler.event("backend","TextureManager.readTextureAsync",async()=>{this.pendingRead.set(et,[]);let st=d.shape.reduce((Ct,pt)=>Ct*pt)*b;await this.glContext.createAndWaitForFence();let at=this.glContext.readTexture(d.texture,d.width,d.height,st,this.toEncoderType(g),b),vt=this.toTensorData(g,at),Tt=this.pendingRead.get(et);return this.pendingRead.delete(et),Tt==null||Tt.forEach(Ct=>Ct(vt)),vt})}readUint8TextureAsFloat(d){return this.profiler.event("backend","TextureManager.readUint8TextureAsFloat",()=>{let g=d.shape.reduce((et,st)=>et*st),b=this.glContext.readTexture(d.texture,d.width,d.height,g*4,"byte",4);return new Float32Array(b.buffer,b.byteOffset,g)})}releaseTexture(d,g){let b;if(this.config.reuseTextures&&(b=this.textureLookup.get(d.texture),b)){g&&this.textureLookup.delete(b);let et=this.inUseTextures.get(b);if(et){let st=et.indexOf(d.texture);if(st!==-1){et.splice(st,1);let at=this.idleTextures.get(b);at||(at=[],this.idleTextures.set(b,at)),at.push(d.texture)}}}(!b||g)&&(ce.verbose("TextureManager",`Deleting texture of size ${d.width}x${d.height}`),this.glContext.deleteTexture(d.texture))}toTensorData(d,g){switch(d){case"int16":return g instanceof Int16Array?g:Int16Array.from(g);case"int32":return g instanceof Int32Array?g:Int32Array.from(g);case"int8":return g instanceof Int8Array?g:Int8Array.from(g);case"uint16":return g instanceof Uint16Array?g:Uint16Array.from(g);case"uint32":return g instanceof Uint32Array?g:Uint32Array.from(g);case"uint8":case"bool":return g instanceof Uint8Array?g:Uint8Array.from(g);case"float32":return g instanceof Float32Array?g:Float32Array.from(g);case"float64":return g instanceof Float64Array?g:Float64Array.from(g);default:throw new Error(`TensorData type ${d} is not supported`)}}toTextureData(d,g){if(g)return g instanceof Float32Array?g:new Float32Array(g)}toEncoderType(d){return"float"}clearActiveTextures(){this.glContext.clearActiveTextures()}}}),yo$1,lp$1=L$1(()=>{lt$1(),_s$1(),el$1(),Xc$1(),sp$1(),Vi(),up$1(),yo$1=class{constructor(d,g){this.backend=d,this.context=g,this.layoutStrategy=new uo$1(d.glContext.maxTextureSize),this.programManager=new bo$1(this.context.profiler,d.glContext,this.layoutStrategy),this.textureManager=new go$1(d.glContext,this.layoutStrategy,this.context.profiler,{reuseTextures:d.textureCacheMode==="full"}),this.packedTextureDataCache=new Map,this.unpackedTextureDataCache=new Map,this.pack=d.pack,this.pack2unpackMap=new Map,this.unpack2packMap=new Map}createInferenceHandler(){return new Jn$1(this)}onGraphInitialized(d){let g=d.getValues().filter(b=>b.from===-1&&b.tensor).map(b=>b.tensor.dataId);this.initializers=new Set(g)}isInitializer(d){return this.initializers?this.initializers.has(d):!1}addInitializer(d){this.initializers.add(d)}getTextureData(d,g){return g?this.packedTextureDataCache.get(d):this.unpackedTextureDataCache.get(d)}setTextureData(d,g,b=!1){ce.verbose("WebGLSessionHandler","Storing Texture data in cache"),b?this.packedTextureDataCache.set(d,g):this.unpackedTextureDataCache.set(d,g)}dispose(){this.programManager.dispose(),this.textureManager.clearActiveTextures(),this.packedTextureDataCache.forEach(d=>this.textureManager.releaseTexture(d,!0)),this.packedTextureDataCache=new Map,this.unpackedTextureDataCache.forEach(d=>this.textureManager.releaseTexture(d,!0)),this.unpackedTextureDataCache=new Map}resolve(d,g,b){let et=vs$1(d,g,Yc$1);return{impl:et.opImpl,context:et.opInit?et.opInit(d,b):d}}}});function jb(d){let g=0;for(;g<d.length&&d[g]();++g);return g-1}var hn,fp$1=L$1(()=>{Ot$1(),ln(),ln(),Bt$1(),hn=class{constructor(d,g){this.frameBufferBound=!1,this.itemsToPoll=[],this.gl=d,this.version=g,this.getExtensions(),this.vertexbuffer=this.createVertexbuffer(),this.framebuffer=this.createFramebuffer(),this.queryVitalParameters()}allocateTexture(d,g,b,et){let st=this.gl,at=st.createTexture();st.bindTexture(st.TEXTURE_2D,at),st.texParameteri(st.TEXTURE_2D,st.TEXTURE_MIN_FILTER,st.NEAREST),st.texParameteri(st.TEXTURE_2D,st.TEXTURE_MAG_FILTER,st.NEAREST),st.texParameteri(st.TEXTURE_2D,st.TEXTURE_WRAP_S,st.CLAMP_TO_EDGE),st.texParameteri(st.TEXTURE_2D,st.TEXTURE_WRAP_T,st.CLAMP_TO_EDGE);let vt=et?b.encode(et,d*g):null;return st.texImage2D(st.TEXTURE_2D,0,b.internalFormat,d,g,0,b.format,b.textureType,vt),this.checkError(),at}updateTexture(d,g,b,et,st){let at=this.gl;at.bindTexture(at.TEXTURE_2D,d);let vt=et.encode(st,g*b);at.texSubImage2D(at.TEXTURE_2D,0,0,0,g,b,et.format,et.textureType,vt),this.checkError()}attachFramebuffer(d,g,b){let et=this.gl;et.bindTexture(et.TEXTURE_2D,d),et.bindFramebuffer(et.FRAMEBUFFER,this.framebuffer),et.framebufferTexture2D(et.FRAMEBUFFER,et.COLOR_ATTACHMENT0,et.TEXTURE_2D,d,0),this.checkError(),et.viewport(0,0,g,b),et.scissor(0,0,g,b)}readTexture(d,g,b,et,st,at){let vt=this.gl;at||(at=1),this.frameBufferBound||this.attachFramebuffer(d,g,b);let Tt=this.getEncoder(st,at),Ct=Tt.allocate(g*b);return vt.bindTexture(vt.TEXTURE_2D,d),vt.framebufferTexture2D(vt.FRAMEBUFFER,vt.COLOR_ATTACHMENT0,vt.TEXTURE_2D,d,0),vt.readPixels(0,0,g,b,vt.RGBA,Tt.textureType,Ct),this.checkError(),Tt.decode(Ct,et)}isFramebufferReady(){return!0}getActiveTexture(){let d=this.gl;return`TEXTURE${d.getParameter(this.gl.ACTIVE_TEXTURE)-d.TEXTURE0}`}getTextureBinding(){return this.gl.getParameter(this.gl.TEXTURE_BINDING_2D)}getFramebufferBinding(){return this.gl.getParameter(this.gl.FRAMEBUFFER_BINDING)}setVertexAttributes(d,g){let b=this.gl;b.vertexAttribPointer(d,3,b.FLOAT,!1,20,0),b.enableVertexAttribArray(d),g!==-1&&(b.vertexAttribPointer(g,2,b.FLOAT,!1,20,12),b.enableVertexAttribArray(g)),this.checkError()}createProgram(d,g){let b=this.gl,et=b.createProgram();return b.attachShader(et,d),b.attachShader(et,g),b.linkProgram(et),et}compileShader(d,g){let b=this.gl,et=b.createShader(g);if(!et)throw new Error(`createShader() returned null with type ${g}`);if(b.shaderSource(et,d),b.compileShader(et),b.getShaderParameter(et,b.COMPILE_STATUS)===!1)throw new Error(`Failed to compile shader: ${b.getShaderInfoLog(et)}
Shader source:
${d}`);return et}deleteShader(d){this.gl.deleteShader(d)}bindTextureToUniform(d,g,b){let et=this.gl;et.activeTexture(et.TEXTURE0+g),this.checkError(),et.bindTexture(et.TEXTURE_2D,d),this.checkError(),et.uniform1i(b,g),this.checkError()}draw(){this.gl.drawArrays(this.gl.TRIANGLE_STRIP,0,4),this.checkError()}checkError(){if(Z.debug){let d=this.gl,g=d.getError(),b="";switch(g){case d.NO_ERROR:return;case d.INVALID_ENUM:b="INVALID_ENUM";break;case d.INVALID_VALUE:b="INVALID_VALUE";break;case d.INVALID_OPERATION:b="INVALID_OPERATION";break;case d.INVALID_FRAMEBUFFER_OPERATION:b="INVALID_FRAMEBUFFER_OPERATION";break;case d.OUT_OF_MEMORY:b="OUT_OF_MEMORY";break;case d.CONTEXT_LOST_WEBGL:b="CONTEXT_LOST_WEBGL";break;default:b=`Unknown WebGL Error: ${g.toString(16)}`}throw new Error(b)}}deleteTexture(d){this.gl.deleteTexture(d)}deleteProgram(d){this.gl.deleteProgram(d)}getEncoder(d,g,b=0){if(this.version===2)return new Xn$1(this.gl,g);switch(d){case"float":return b===1||this.isRenderFloat32Supported?new un(this.gl,g):new un(this.gl,g,this.textureHalfFloatExtension.HALF_FLOAT_OES);case"int":throw new Error("not implemented");case"byte":return new Kn$1(this.gl,g);default:throw new Error(`Invalid dataType: ${d}`)}}clearActiveTextures(){let d=this.gl;for(let g=0;g<this.maxTextureImageUnits;++g)d.activeTexture(d.TEXTURE0+g),d.bindTexture(d.TEXTURE_2D,null)}dispose(){if(this.disposed)return;let d=this.gl;d.bindFramebuffer(d.FRAMEBUFFER,null),d.deleteFramebuffer(this.framebuffer),d.bindBuffer(d.ARRAY_BUFFER,null),d.deleteBuffer(this.vertexbuffer),d.bindBuffer(d.ELEMENT_ARRAY_BUFFER,null),d.finish(),this.disposed=!0}createDefaultGeometry(){return new Float32Array([-1,1,0,0,1,-1,-1,0,0,0,1,1,0,1,1,1,-1,0,1,0])}createVertexbuffer(){let d=this.gl,g=d.createBuffer();if(!g)throw new Error("createBuffer() returned null");let b=this.createDefaultGeometry();return d.bindBuffer(d.ARRAY_BUFFER,g),d.bufferData(d.ARRAY_BUFFER,b,d.STATIC_DRAW),this.checkError(),g}createFramebuffer(){let d=this.gl.createFramebuffer();if(!d)throw new Error("createFramebuffer returned null");return d}queryVitalParameters(){let d=this.gl;if(this.isFloatTextureAttachableToFrameBuffer=this.checkFloatTextureAttachableToFrameBuffer(),this.isRenderFloat32Supported=this.checkRenderFloat32(),this.isFloat32DownloadSupported=this.checkFloat32Download(),this.version===1&&!this.textureHalfFloatExtension&&!this.isRenderFloat32Supported)throw new Error("both float32 and float16 TextureType are not supported");this.isBlendSupported=!this.isRenderFloat32Supported||this.checkFloat32Blend(),this.maxTextureSize=d.getParameter(d.MAX_TEXTURE_SIZE),this.maxTextureImageUnits=d.getParameter(d.MAX_TEXTURE_IMAGE_UNITS),this.version}getExtensions(){this.version===2?(this.colorBufferFloatExtension=this.gl.getExtension("EXT_color_buffer_float"),this.disjointTimerQueryWebgl2Extension=this.gl.getExtension("EXT_disjoint_timer_query_webgl2")):(this.textureFloatExtension=this.gl.getExtension("OES_texture_float"),this.textureHalfFloatExtension=this.gl.getExtension("OES_texture_half_float"))}checkFloatTextureAttachableToFrameBuffer(){let d=this.gl,g=d.createTexture();d.bindTexture(d.TEXTURE_2D,g);let b=this.version===2?d.RGBA32F:d.RGBA;d.texImage2D(d.TEXTURE_2D,0,b,1,1,0,d.RGBA,d.FLOAT,null);let et=d.createFramebuffer();d.bindFramebuffer(d.FRAMEBUFFER,et),d.framebufferTexture2D(d.FRAMEBUFFER,d.COLOR_ATTACHMENT0,d.TEXTURE_2D,g,0);let st=d.checkFramebufferStatus(d.FRAMEBUFFER)===d.FRAMEBUFFER_COMPLETE;return d.bindTexture(d.TEXTURE_2D,null),d.bindFramebuffer(d.FRAMEBUFFER,null),d.deleteTexture(g),d.deleteFramebuffer(et),st}checkRenderFloat32(){if(this.version===2){if(!this.colorBufferFloatExtension)return!1}else if(!this.textureFloatExtension)return!1;return this.isFloatTextureAttachableToFrameBuffer}checkFloat32Download(){if(this.version===2){if(!this.colorBufferFloatExtension)return!1}else if(!this.textureFloatExtension||!this.gl.getExtension("WEBGL_color_buffer_float"))return!1;return this.isFloatTextureAttachableToFrameBuffer}checkFloat32Blend(){let d=this.gl,g,b,et,st,at;try{g=d.createTexture(),b=d.createFramebuffer(),d.bindTexture(d.TEXTURE_2D,g);let vt=this.version===2?d.RGBA32F:d.RGBA;return d.texImage2D(d.TEXTURE_2D,0,vt,1,1,0,d.RGBA,d.FLOAT,null),d.bindFramebuffer(d.FRAMEBUFFER,b),d.framebufferTexture2D(d.FRAMEBUFFER,d.COLOR_ATTACHMENT0,d.TEXTURE_2D,g,0),d.enable(d.BLEND),et=d.createShader(d.VERTEX_SHADER),!et||(d.shaderSource(et,"void main(){}"),d.compileShader(et),st=d.createShader(d.FRAGMENT_SHADER),!st)||(d.shaderSource(st,"precision highp float;void main(){gl_FragColor=vec4(0.5);}"),d.compileShader(st),at=d.createProgram(),!at)?!1:(d.attachShader(at,et),d.attachShader(at,st),d.linkProgram(at),d.useProgram(at),d.drawArrays(d.POINTS,0,1),d.getError()===d.NO_ERROR)}finally{d.disable(d.BLEND),at&&d.deleteProgram(at),et&&d.deleteShader(et),st&&d.deleteShader(st),b&&(d.bindFramebuffer(d.FRAMEBUFFER,null),d.deleteFramebuffer(b)),g&&(d.bindTexture(d.TEXTURE_2D,null),d.deleteTexture(g))}}beginTimer(){if(this.version===2&&this.disjointTimerQueryWebgl2Extension){let d=this.gl,g=this.disjointTimerQueryWebgl2Extension,b=d.createQuery();return d.beginQuery(g.TIME_ELAPSED_EXT,b),b}else throw new Error("WebGL1 profiling currently not supported.")}endTimer(){if(this.version===2&&this.disjointTimerQueryWebgl2Extension){let d=this.gl,g=this.disjointTimerQueryWebgl2Extension;d.endQuery(g.TIME_ELAPSED_EXT);return}else throw new Error("WebGL1 profiling currently not supported")}isTimerResultAvailable(d){let g=!1,b=!1;if(this.version===2&&this.disjointTimerQueryWebgl2Extension){let et=this.gl,st=this.disjointTimerQueryWebgl2Extension;g=et.getQueryParameter(d,et.QUERY_RESULT_AVAILABLE),b=et.getParameter(st.GPU_DISJOINT_EXT)}else throw new Error("WebGL1 profiling currently not supported");return g&&!b}getTimerResult(d){let g=0;if(this.version===2){let b=this.gl;g=b.getQueryParameter(d,b.QUERY_RESULT),b.deleteQuery(d)}else throw new Error("WebGL1 profiling currently not supported");return g/1e6}async waitForQueryAndGetTime(d){return await mi$1(()=>this.isTimerResultAvailable(d)),this.getTimerResult(d)}async createAndWaitForFence(){let d=this.createFence(this.gl);return this.pollFence(d)}createFence(d){let g,b=d,et=b.fenceSync(b.SYNC_GPU_COMMANDS_COMPLETE,0);return d.flush(),et===null?g=()=>!0:g=()=>{let st=b.clientWaitSync(et,0,0);return st===b.ALREADY_SIGNALED||st===b.CONDITION_SATISFIED},{query:et,isFencePassed:g}}async pollFence(d){return new Promise(g=>{this.addItemToPoll(()=>d.isFencePassed(),()=>g())})}pollItems(){let d=jb(this.itemsToPoll.map(g=>g.isDoneFn));for(let g=0;g<=d;++g){let{resolveFn:b}=this.itemsToPoll[g];b()}this.itemsToPoll=this.itemsToPoll.slice(d+1)}async addItemToPoll(d,g){this.itemsToPoll.push({isDoneFn:d,resolveFn:g}),!(this.itemsToPoll.length>1)&&await mi$1(()=>(this.pollItems(),this.itemsToPoll.length===0))}}});function Hi$1(d){let g;if((!d||d==="webgl2")&&"webgl2"in Gr?g=Gr.webgl2:(!d||d==="webgl")&&"webgl"in Gr&&(g=Gr.webgl),!g)try{let et=Xb();g=cp$1(et,d)}catch{let et=Yb();g=cp$1(et,d)}d=d||g.version===1?"webgl":"webgl2";let b=g.gl;return Gr[d]=g,b.isContextLost()?(delete Gr[d],Hi$1(d)):(b.disable(b.DEPTH_TEST),b.disable(b.STENCIL_TEST),b.disable(b.BLEND),b.disable(b.DITHER),b.disable(b.POLYGON_OFFSET_FILL),b.disable(b.SAMPLE_COVERAGE),b.enable(b.SCISSOR_TEST),b.enable(b.CULL_FACE),b.cullFace(b.BACK),g)}function cp$1(d,g){let b={alpha:!1,depth:!1,antialias:!1,stencil:!1,preserveDrawingBuffer:!1,premultipliedAlpha:!1,failIfMajorPerformanceCaveat:!1},et,st=b;if((!g||g==="webgl2")&&(et=d.getContext("webgl2",st),et))try{return new hn(et,2)}catch(at){ce.warning("GlContextFactory",`failed to create WebGLContext using contextId 'webgl2'. Error: ${at}`)}if((!g||g==="webgl")&&(et=d.getContext("webgl",st)||d.getContext("experimental-webgl",st),et))try{return new hn(et,1)}catch(at){ce.warning("GlContextFactory",`failed to create WebGLContext using contextId 'webgl' or 'experimental-webgl'. Error: ${at}`)}throw new Error("WebGL is not supported")}function Yb(){if(typeof document>"u")throw new TypeError("failed to create canvas: document is not supported");let d=document.createElement("canvas");return d.width=1,d.height=1,d}function Xb(){if(typeof OffscreenCanvas>"u")throw new TypeError("failed to create offscreen canvas: OffscreenCanvas is not supported");return new OffscreenCanvas(1,1)}var Gr,pp$1=L$1(()=>{lt$1(),fp$1(),Gr={}}),To$1,dp$1=L$1(()=>{Ot$1(),lt$1(),lp$1(),pp$1(),To$1=class{get contextId(){return Z.webgl.contextId}set contextId(d){Z.webgl.contextId=d}get matmulMaxBatchSize(){return Z.webgl.matmulMaxBatchSize}set matmulMaxBatchSize(d){Z.webgl.matmulMaxBatchSize=d}get textureCacheMode(){return Z.webgl.textureCacheMode}set textureCacheMode(d){Z.webgl.textureCacheMode=d}get pack(){return Z.webgl.pack}set pack(d){Z.webgl.pack=d}get async(){return Z.webgl.async}set async(d){Z.webgl.async=d}initialize(){try{return this.glContext=Hi$1(this.contextId),typeof this.matmulMaxBatchSize!="number"&&(this.matmulMaxBatchSize=16),typeof this.textureCacheMode!="string"&&(this.textureCacheMode="full"),typeof this.pack!="boolean"&&(this.pack=!1),typeof this.async!="boolean"&&(this.async=!1),ce.setWithEnv(Z),Z.webgl.context||Object.defineProperty(Z.webgl,"context",{value:this.glContext.gl}),ce.verbose("WebGLBackend",`Created WebGLContext: ${typeof this.glContext} with matmulMaxBatchSize: ${this.matmulMaxBatchSize}; textureCacheMode: ${this.textureCacheMode}; pack: ${this.pack}; async: ${this.async}.`),!0}catch(d){return ce.warning("WebGLBackend",`Unable to initialize WebGLBackend. ${d}`),!1}}createSessionHandler(d){return new yo$1(this,d)}dispose(){this.glContext.dispose()}}});async function qi$1(d){if(d){let g=typeof d=="string"?[d]:d;for(let b of g){let et=hp$1.get(b);if(et)return et;let st=await Jb(b);if(st)return st}}else return qi$1(["webgl"]);throw new Error("no available backend to use")}async function Jb(d){let g=Kb;if(typeof g[d]<"u"&&Zb(g[d])){let b=g[d],et=b.initialize();if(typeof et=="object"&&"then"in et&&(et=await et),et)return hp$1.set(d,b),b}}function Zb(d){let g=d;return"initialize"in g&&typeof g.initialize=="function"&&"createSessionHandler"in g&&typeof g.createSessionHandler=="function"&&"dispose"in g&&typeof g.dispose=="function"}var hp$1,Kb,mp$1=L$1(()=>{dp$1(),hp$1=new Map,Kb={webgl:new To$1}}),ji$1,xo$1,bp=L$1(()=>{lt$1(),ji$1=class{constructor(d,g){this.op=d,this.node=g}},xo$1=class{constructor(d,g,b){this.graph=d,this.profiler=b,this.initialize(g)}initialize(d){this.profiler.event("session","ExecutionPlan.initialize",()=>{let g=this.graph.getNodes();if(g.length!==d.length)throw new Error("The size of nodes and OPs do not match.");this._ops=d.map((b,et)=>new ji$1(b,g[et])),this.reset(),this._starter=[],this._ops.forEach((b,et)=>{let st=!0;for(let at of b.node.inputs)if(!this._values[at]&&this.graph.getInputIndices().indexOf(at)===-1){st=!1;break}st&&this._starter.push(et)})})}reset(){this._values=this.graph.getValues().map(d=>d.tensor)}async execute(d,g){return this.profiler.event("session","ExecutionPlan.execute",async()=>{this.reset();let b=d.createInferenceHandler(),et=this.graph.getInputIndices();if(g.length!==et.length)throw new Error(`number of input tensors don't match the number of inputs to the model: actual: ${g.length} expected: ${et.length}`);g.forEach((pt,wt)=>{let $t=et[wt];this._values[$t]=pt});let st=this._starter.slice(0),at=this.graph.getValues(),vt=this.graph.getNodes(),Tt=0;for(;Tt<st.length;){let pt=st[Tt++],wt=this._ops[pt],$t=wt.node.inputs.map(Gt=>this._values[Gt]);if($t.indexOf(void 0)!==-1)throw new Error(`unresolved input detected: op: ${wt.node}`);let Lt=$t;ce.verbose("ExecPlan",`Runing op:${wt.node.name} (${Lt.map((Gt,Ht)=>`'${wt.node.inputs[Ht]}': ${Gt.type}[${Gt.dims.join(",")}]`).join(", ")})`);let jt=await this.profiler.event("node",wt.node.name,async()=>wt.op.impl(b,Lt,wt.op.context));if(jt.length!==wt.node.outputs.length)throw new Error("the size of output does not match model definition.");jt.forEach((Gt,Ht)=>{let qt=wt.node.outputs[Ht];if(this._values[qt])throw new Error(`output [${qt}] already has value: op:${wt.node.name}`);this._values[qt]=Gt});let Ft=new Set;jt.forEach((Gt,Ht)=>{let qt=wt.node.outputs[Ht];for(let Kt of at[qt].to){let rr=vt[Kt],ir=!0;for(let or of rr.inputs)if(!this._values[or]){ir=!1;break}ir&&Ft.add(Kt)}}),st.push(...Ft)}let Ct=[];for(let pt=0;pt<this.graph.getOutputIndices().length;pt++){let wt=this.graph.getOutputIndices()[pt],$t=this._values[wt];if($t===void 0)throw new Error(`required output [${wt}] does not have value`);wt===0?await $t.getData():$t.data,Ct.push($t)}return ce.verbose("ExecPlan","disposing of inferenceHandler"),b.dispose(),Ct})}}}),oe,bt,mn,gp$1=L$1(()=>{tn$1(),oe=Ar(Cr()),yr(),fe$1(),bt=V.experimental.fbs,mn=class Gx{constructor(g){if(this._attributes=new Map,g!=null){for(let b of g)b instanceof oe.onnx.AttributeProto?this._attributes.set(b.name,[Gx.getValue(b),Gx.getType(b)]):b instanceof bt.Attribute&&this._attributes.set(b.name(),[Gx.getValue(b),Gx.getType(b)]);if(this._attributes.size<g.length)throw new Error("duplicated attribute names")}}set(g,b,et){this._attributes.set(g,[et,b])}delete(g){this._attributes.delete(g)}getFloat(g,b){return this.get(g,"float",b)}getInt(g,b){return this.get(g,"int",b)}getString(g,b){return this.get(g,"string",b)}getTensor(g,b){return this.get(g,"tensor",b)}getFloats(g,b){return this.get(g,"floats",b)}getInts(g,b){return this.get(g,"ints",b)}getStrings(g,b){return this.get(g,"strings",b)}getTensors(g,b){return this.get(g,"tensors",b)}get(g,b,et){let st=this._attributes.get(g);if(st===void 0){if(et!==void 0)return et;throw new Error(`required attribute not found: ${g}`)}if(st[1]!==b)throw new Error(`type mismatch: expected ${b} but got ${st[1]}`);return st[0]}static getType(g){let b=g instanceof oe.onnx.AttributeProto?g.type:g.type();switch(b){case oe.onnx.AttributeProto.AttributeType.FLOAT:return"float";case oe.onnx.AttributeProto.AttributeType.INT:return"int";case oe.onnx.AttributeProto.AttributeType.STRING:return"string";case oe.onnx.AttributeProto.AttributeType.TENSOR:return"tensor";case oe.onnx.AttributeProto.AttributeType.FLOATS:return"floats";case oe.onnx.AttributeProto.AttributeType.INTS:return"ints";case oe.onnx.AttributeProto.AttributeType.STRINGS:return"strings";case oe.onnx.AttributeProto.AttributeType.TENSORS:return"tensors";default:throw new Error(`attribute type is not supported yet: ${oe.onnx.AttributeProto.AttributeType[b]}`)}}static getValue(g){let b=g instanceof oe.onnx.AttributeProto?g.type:g.type();if(b===oe.onnx.AttributeProto.AttributeType.GRAPH||b===oe.onnx.AttributeProto.AttributeType.GRAPHS)throw new Error("graph attribute is not supported yet");let et=this.getValueNoCheck(g);if(b===oe.onnx.AttributeProto.AttributeType.INT&&it.isLong(et))return it.longToNumber(et);if(b===oe.onnx.AttributeProto.AttributeType.INTS){let st=et,at=new Array(st.length);for(let vt=0;vt<st.length;vt++){let Tt=st[vt];at[vt]=it.longToNumber(Tt)}return at}if(b===oe.onnx.AttributeProto.AttributeType.TENSOR)return g instanceof oe.onnx.AttributeProto?$e.fromProto(et):$e.fromOrtTensor(et);if(b===oe.onnx.AttributeProto.AttributeType.TENSORS){if(g instanceof oe.onnx.AttributeProto)return et.map(st=>$e.fromProto(st));if(g instanceof bt.Attribute)return et.map(st=>$e.fromOrtTensor(st))}return b===oe.onnx.AttributeProto.AttributeType.STRING&&g instanceof oe.onnx.AttributeProto?sn$1(et):b===oe.onnx.AttributeProto.AttributeType.STRINGS&&g instanceof oe.onnx.AttributeProto?et.map(sn$1):et}static getValueNoCheck(g){return g instanceof oe.onnx.AttributeProto?this.getValueNoCheckFromOnnxFormat(g):this.getValueNoCheckFromOrtFormat(g)}static getValueNoCheckFromOnnxFormat(g){switch(g.type){case oe.onnx.AttributeProto.AttributeType.FLOAT:return g.f;case oe.onnx.AttributeProto.AttributeType.INT:return g.i;case oe.onnx.AttributeProto.AttributeType.STRING:return g.s;case oe.onnx.AttributeProto.AttributeType.TENSOR:return g.t;case oe.onnx.AttributeProto.AttributeType.GRAPH:return g.g;case oe.onnx.AttributeProto.AttributeType.FLOATS:return g.floats;case oe.onnx.AttributeProto.AttributeType.INTS:return g.ints;case oe.onnx.AttributeProto.AttributeType.STRINGS:return g.strings;case oe.onnx.AttributeProto.AttributeType.TENSORS:return g.tensors;case oe.onnx.AttributeProto.AttributeType.GRAPHS:return g.graphs;default:throw new Error(`unsupported attribute type: ${oe.onnx.AttributeProto.AttributeType[g.type]}`)}}static getValueNoCheckFromOrtFormat(g){switch(g.type()){case bt.AttributeType.FLOAT:return g.f();case bt.AttributeType.INT:return g.i();case bt.AttributeType.STRING:return g.s();case bt.AttributeType.TENSOR:return g.t();case bt.AttributeType.GRAPH:return g.g();case bt.AttributeType.FLOATS:return g.floatsArray();case bt.AttributeType.INTS:{let b=[];for(let et=0;et<g.intsLength();et++)b.push(g.ints(et));return b}case bt.AttributeType.STRINGS:{let b=[];for(let et=0;et<g.stringsLength();et++)b.push(g.strings(et));return b}case bt.AttributeType.TENSORS:{let b=[];for(let et=0;et<g.tensorsLength();et++)b.push(g.tensors(et));return b}default:throw new Error(`unsupported attribute type: ${bt.AttributeType[g.type()]}`)}}}}),Xi$1,wo$1,Ki$1,Mt$1,vo$1,Yi$1,yp$1=L$1(()=>{gp$1(),tn$1(),Xi$1=Ar(Cr()),yr(),fe$1(),wo$1=V.experimental.fbs,Ki$1={from:(d,g)=>new Yi$1(d,g)},Mt$1=class{constructor(d){this._from=void 0,this._to=[],this.tensor=void 0,this.type=void 0,d&&(this.type=We$1.tensorValueTypeFromProto(d.type.tensorType))}get from(){return this._from}get to(){return this._to}},vo$1=class{constructor(d,g){d instanceof Xi$1.onnx.NodeProto?(this.name=d.name,this.opType=d.opType,this.attributes=new mn(d.attribute)):d instanceof wo$1.Node&&(this.name=g??d.name(),this.opType=d.opType(),this.attributes=new mn(We$1.tensorAttributesFromORTFormat(d))),this.inputs=[],this.outputs=[],this.executeNode=!0}},Yi$1=class{constructor(d,g){if(!d)throw new TypeError("graph is empty");this.buildGraph(d),this.transformGraph(g),this.checkIsAcyclic()}getInputIndices(){return this._allInputIndices}getInputNames(){return this._allInputNames}getOutputIndices(){return this._allOutputIndices}getOutputNames(){return this._allOutputNames}getValues(){return this._allData}getNodes(){return this._nodes}buildGraph(d){if(d instanceof Xi$1.onnx.GraphProto)this.buildGraphFromOnnxFormat(d);else if(d instanceof wo$1.Graph)this.buildGraphFromOrtFormat(d);else throw new TypeError("Graph type is not supported.")}buildGraphFromOnnxFormat(d){let g=new Map;this._allData=[],this._allInputIndices=[],this._allInputNames=[],this._allOutputIndices=[],this._allOutputNames=[],this._nodes=[];let b=new Map;if(!d.input)throw new Error("missing information in graph: input");let et=[];for(let st of d.input){if(g.has(st.name))throw new Error(`duplicated input name: ${st.name}`);let at=this._allData.push(new Mt$1(st))-1;g.set(st.name,at),et.push(st.name)}if(!d.initializer)throw new Error("missing information in graph: initializer");for(let st of d.initializer){let at=g.get(st.name);if(at===void 0){let vt=new Mt$1;vt.type={shape:{dims:We$1.tensorDimsFromProto(st.dims)},tensorType:We$1.tensorDataTypeFromProto(st.dataType)},at=this._allData.push(vt)-1,g.set(st.name,at)}this._allData[at]._from=-1,this._allData[at].tensor=$e.fromProto(st)}for(let st=0;st<this._allData.length;st++)this._allData[st].tensor||(this._allInputIndices.push(st),this._allInputNames.push(et[st]));if(!d.output)throw new Error("missing information in graph: output");for(let st of d.output){if(g.has(st.name))throw new Error(`duplicated output name: ${st.name}`);let at=this._allData.push(new Mt$1(st))-1;g.set(st.name,at),this._allOutputIndices.push(at),this._allOutputNames.push(st.name)}if(!d.node)throw new Error("missing information in graph: node");for(let st of d.node){if(!st.name)for(let vt=0;;vt++){let Tt=`unnamed_${st.opType}_${vt}`;if(!b.has(Tt)){st.name=Tt;break}}if(b.has(st.name))throw new Error(`duplicated node name: ${st.name}`);let at=this._nodes.push(new vo$1(st))-1;b.set(st.name,at)}for(let st=0;st<this._nodes.length;st++){let at=this._nodes[st],vt=d.node[st];if(!vt.output)throw new Error(`missing output for node: ${vt.name}`);for(let Tt of vt.output){let Ct=g.get(Tt);if(typeof Ct>"u"&&(Ct=this._allData.push(new Mt$1)-1,g.set(Tt,Ct)),at.outputs.push(Ct),this._allData[Ct]._from!==void 0)throw new Error(`multiple nodes output to one data value: ${Ct}`);if(this._allData[Ct]._from=st,vt.opType==="Constant"){if(!vt.attribute||vt.attribute.length!==1||!vt.attribute[0].t)throw new Error("missing attributes or missing tensor value in attributes for this Constant operator");if(!vt.output||vt.output.length!==1)throw new Error("missing output or incorrect number of outputs for this Constant operator");at.outputs.pop(),at.executeNode=!1,this._allData[Ct]._from=-1,this._allData[Ct].tensor=$e.fromProto(vt.attribute[0].t)}}}for(let st=0;st<this._nodes.length;st++){let at=this._nodes[st],vt=d.node[st];if(!vt.input)throw new Error(`missing input for node: ${vt.name}`);for(let Tt of vt.input){let Ct=g.get(Tt);if(typeof Ct>"u"){if(Tt===""&&(vt.input.length===3||vt.input.length===4)&&vt.opType==="Resize")continue;throw new Error(`unrecognized input '${Tt}' for node: ${vt.name}`)}at.inputs.push(Ct),this._allData[Ct]._to.push(st)}}return!0}buildGraphFromOrtFormat(d){var st,at,vt;let g=new Map;this._allData=[],this._allInputIndices=[],this._allInputNames=[],this._allOutputIndices=[],this._allOutputNames=[],this._nodes=[];let b=new Map,et=[];for(let Tt=0;Tt<d.inputsLength();Tt++){let Ct=d.inputs(Tt);if(g.has(Ct))throw new Error(`duplicated input name: ${Ct}`);for(let pt=0;pt<d.nodeArgsLength();pt++)if(((st=d.nodeArgs(pt))==null?void 0:st.name())===Ct){let wt=new Mt$1;if(((vt=(at=d.nodeArgs(pt))==null?void 0:at.type())==null?void 0:vt.valueType())!==wo$1.TypeInfoValue.tensor_type)throw new Error("Unexpected value type for the nodeArg.");let $t=d.nodeArgs(pt).type().value(new wo$1.TensorTypeAndShape),Lt=We$1.tensorDataTypeFromProto($t.elemType()),jt=$t.shape(),Ft=[];for(let Ht=0;Ht<jt.dimLength();Ht++)Ft.push(it.longToNumber(jt.dim(Ht).value().dimValue()));wt.type={shape:{dims:Ft},tensorType:Lt};let Gt=this._allData.push(wt)-1;g.set(Ct,Gt),et.push(Ct)}}for(let Tt=0;Tt<d.initializersLength();Tt++){let Ct=d.initializers(Tt),pt=g.get(Ct.name());if(pt===void 0){let wt=new Mt$1,$t=We$1.tensorDimsFromORTFormat(Ct),Lt=We$1.tensorDataTypeFromProto(Ct.dataType());wt.type={shape:{dims:$t},tensorType:Lt},pt=this._allData.push(wt)-1,g.set(Ct.name(),pt)}this._allData[pt]._from=-1,this._allData[pt].tensor=$e.fromOrtTensor(Ct)}for(let Tt=0;Tt<this._allData.length;Tt++)this._allData[Tt].tensor||(this._allInputIndices.push(Tt),this._allInputNames.push(et[Tt]));for(let Tt=0;Tt<d.outputsLength();Tt++){let Ct=d.outputs(Tt);if(g.has(Ct))throw new Error(`duplicated output name: ${Ct}`);let pt=this._allData.push(new Mt$1)-1;g.set(Ct,pt),this._allOutputIndices.push(pt),this._allOutputNames.push(Ct)}if(!d.nodes)throw new Error("missing information in graph: node");for(let Tt=0;Tt<d.nodesLength();Tt++){let Ct=d.nodes(Tt),pt=Ct.name();if(!pt)for(let $t=0;pt=`unnamed_${Ct.opType()}_${$t}`,!!b.has(pt);$t++);if(b.has(pt))throw new Error(`duplicated node name: ${pt}`);let wt=this._nodes.push(new vo$1(Ct,pt))-1;b.set(pt,wt)}for(let Tt=0;Tt<this._nodes.length;Tt++){let Ct=this._nodes[Tt],pt=d.nodes(Tt);if(pt==null)throw new Error(`No node exists at index ${Tt}`);if((pt==null?void 0:pt.outputsLength())===0)throw new Error(`missing output for node: ${pt.name}`);for(let wt=0;wt<(pt==null?void 0:pt.outputsLength());wt++){let $t=pt==null?void 0:pt.outputs(wt),Lt=g.get($t);if(typeof Lt>"u"&&(Lt=this._allData.push(new Mt$1)-1,g.set($t,Lt)),Ct.outputs.push(Lt),this._allData[Lt]._from!==void 0)throw new Error(`multiple nodes output to one data value: ${Lt}`);if(this._allData[Lt]._from=Tt,pt.opType()==="Constant"){if(pt.attributesLength()!==1||!pt.attributes(0).t())throw new Error("missing attributes or missing tensor value in attributes for this Constant operator");if(pt.outputsLength()!==1)throw new Error("missing output or incorrect number of outputs for this Constant operator");Ct.outputs.pop(),Ct.executeNode=!1,this._allData[Lt]._from=-1,this._allData[Lt].tensor=$e.fromOrtTensor(pt.attributes(0).t())}}}for(let Tt=0;Tt<this._nodes.length;Tt++){let Ct=this._nodes[Tt],pt=d.nodes(Tt);if(pt.inputsLength()===0)throw new Error(`missing input for node: ${pt.name}`);for(let wt=0;wt<pt.inputsLength();wt++){let $t=pt.inputs(wt),Lt=g.get($t);if(typeof Lt>"u")throw new Error(`unrecognized input '${$t}' for node: ${pt.name()}`);Ct.inputs.push(Lt),this._allData[Lt]._to.push(Tt)}}}checkIsAcyclic(){let d=new Set;this._allInputIndices.forEach(et=>{this._allData[et]._to.forEach(st=>{d.add(st)})});let g=Array.from(d),b=new Array(this._nodes.length).fill("white");for(;g.length>0;){let et=g.pop();b[et]==="gray"?b[et]="black":(g.push(et),b[et]="gray",this._nodes[et].outputs.forEach(st=>{let at=this._allData[st];if(typeof at.tensor<"u")throw new Error("node outputs should not be initialized");if(at._from!==et)throw new Error("from property of the Value object doesn't match index of Node being processed");at._to.forEach(vt=>{if(b[vt]==="gray")throw new Error("model graph is cyclic");b[vt]==="white"&&g.push(vt)})}))}}transformGraph(d){this.removeAllIdentityNodes(),this.removeAllDropoutNodes(),this.fuseConvActivationNodes(),d&&d.transformGraph(this),this.finalizeGraph()}finalizeGraph(){let d=0,g=new Array(this._nodes.length,0),b=0;for(let et=0;et<this._nodes.length;et++)g[et]=b,this._nodes[et].executeNode?(b!==et&&(this._nodes[b]=this._nodes[et]),b++):this._nodes[et].outputs.forEach(st=>{this._allData[st]._from=-2});this._nodes.splice(b,this._nodes.length-b);for(let et=0;et<this._allData.length;et++){let st=this._allData[et];st._from!==void 0&&st._from!==-1&&st._from!==-2&&(st._from=g[st._from]);for(let at=0;at<st._to.length;at++)if(st._to[at]>=0)st._to[at]=g[st._to[at]];else throw new Error("Trying to update a removed node")}d=0;for(let et=0;et<this._allData.length;et++){if(this._allData[et].from===-2&&this._allOutputIndices.indexOf(et+d)===-1){d++,this._allData.splice(et,1),et--;continue}if(d>0){let st=-1;this._allData[et].from!==void 0&&this._allData[et].from!==-1?(st=this._nodes[this._allData[et].from].outputs.indexOf(et+d),st!==-1&&(this._nodes[this._allData[et].from].outputs[st]=et)):(st=this._allInputIndices.indexOf(et+d),st!==-1&&(this._allInputIndices[st]=et)),this._allData[et].to.forEach(at=>{st=this._nodes[at].inputs.indexOf(et+d),st!==-1&&(this._nodes[at].inputs[st]=et)}),this._allData[et].to.length===0&&(st=this._allOutputIndices.indexOf(et+d),st!==-1&&(this._allOutputIndices[st]=et))}}}deleteNode(d){let g=this._nodes[d];if(g.outputs.length>1){for(let vt=1;vt<g.outputs.length;vt++)if(this._allData[g.outputs[vt]].to.length>0)throw new Error("Node deletion with more than one output connected to other nodes is not supported. ")}g.executeNode=!1;let b=g.inputs[0],et=g.outputs[0],st=this._allData[et].to;for(let vt=0;vt<g.inputs.length;vt++){let Tt=this._allData[g.inputs[vt]].to.indexOf(d);if(Tt===-1)throw new Error("The Value object doesn't have the current Node in it's 'to' property ");this._allData[g.inputs[vt]].to.splice(Tt,1)}this._allData[et]._to=[];let at=this._allOutputIndices.indexOf(et);if(at!==-1&&(this._allOutputIndices[at]=b),st&&st.length>0)for(let vt of st){let Tt=this._nodes[vt].inputs.indexOf(et);if(Tt===-1)throw new Error("The Node object doesn't have the output Value in it's 'inputs' property ");this._nodes[vt].inputs[Tt]=b,this._allData[b].to.push(vt)}}removeAllDropoutNodes(){let d=0;for(let g of this._nodes){if(g.opType==="Dropout"){if(g.inputs.length!==1)throw new Error("Dropout nodes should only contain one input. ");if(g.outputs.length!==1&&g.outputs.length!==2)throw new Error("Dropout nodes should contain either 1 or 2 output(s)");if(g.outputs.length===2&&this._allData[g.outputs[1]]._to.length!==0)throw new Error("Dropout nodes's second output should not be referenced by other nodes");this.deleteNode(d)}d++}}removeAllIdentityNodes(){let d=0;for(let g of this._nodes)g.opType==="Identity"&&this.deleteNode(d),d++}isActivation(d){switch(d.opType){case"Relu":case"Sigmoid":case"Clip":return!0;default:return!1}}fuseConvActivationNodes(){for(let d of this._nodes)if(d.opType==="Conv"){let g=this._allData[d.outputs[0]]._to;if(g.length===1&&this.isActivation(this._nodes[g[0]])){let b=this._nodes[g[0]];if(b.opType==="Clip")if(b.inputs.length===1)try{d.attributes.set("activation_params","floats",[b.attributes.getFloat("min"),b.attributes.getFloat("max")])}catch{d.attributes.set("activation_params","floats",[br,gr$1])}else if(b.inputs.length>=3&&this._allData[b.inputs[1]].tensor!==void 0&&this._allData[b.inputs[2]].tensor!==void 0)d.attributes.set("activation_params","floats",[this._allData[b.inputs[1]].tensor.floatData[0],this._allData[b.inputs[2]].tensor.floatData[0]]);else continue;d.attributes.set("activation","string",b.opType),this.deleteNode(g[0])}}}}}),Tp$1,Qb,_o$1,xp$1=L$1(()=>{zn$1(),yp$1(),tn$1(),Tp$1=Ar(Cr()),fe$1(),Qb=V.experimental.fbs,_o$1=class{constructor(){}load(d,g,b){let et;if(!b)try{this.loadFromOnnxFormat(d,g);return}catch(st){if(b!==void 0)throw st;et=st}try{this.loadFromOrtFormat(d,g)}catch(st){throw b!==void 0?st:new Error(`Failed to load model as ONNX format: ${et}
as ORT format: ${st}`)}}loadFromOnnxFormat(d,g){let b=Tp$1.onnx.ModelProto.decode(d);if(it.longToNumber(b.irVersion)<3)throw new Error("only support ONNX model with IR_VERSION>=3");this._opsets=b.opsetImport.map(et=>({domain:et.domain,version:it.longToNumber(et.version)})),this._graph=Ki$1.from(b.graph,g)}loadFromOrtFormat(d,g){let b=new _$1.ByteBuffer(d),et=Qb.InferenceSession.getRootAsInferenceSession(b).model();if(it.longToNumber(et.irVersion())<3)throw new Error("only support ONNX model with IR_VERSION>=3");this._opsets=[];for(let st=0;st<et.opsetImportLength();st++){let at=et.opsetImport(st);this._opsets.push({domain:at==null?void 0:at.domain(),version:it.longToNumber(at.version())})}this._graph=Ki$1.from(et.graph(),g)}get graph(){return this._graph}get opsets(){return this._opsets}}}),Oo,wp$1=L$1(()=>{mp$1(),bp(),lt$1(),xp$1(),Oo=class{constructor(d={}){this._initialized=!1,this.backendHint=d.backendHint,this.profiler=Gn$1.create(d.profiler),this.context={profiler:this.profiler,graphInputTypes:[],graphInputDims:[]}}get inputNames(){return this._model.graph.getInputNames()}get outputNames(){return this._model.graph.getOutputNames()}startProfiling(){this.profiler.start()}endProfiling(){this.profiler.stop()}async loadModel(d,g,b){await this.profiler.event("session","Session.loadModel",async()=>{let et=await qi$1(this.backendHint);if(this.sessionHandler=et.createSessionHandler(this.context),this._model=new _o$1,typeof d=="string"){let st=d.endsWith(".ort");if(typeof process<"u"&&process.versions&&process.versions.node){let at=await(void 0)(d);this.initialize(at,st)}else{let at=await(await fetch(d)).arrayBuffer();this.initialize(new Uint8Array(at),st)}}else if(ArrayBuffer.isView(d))this.initialize(d);else{let st=new Uint8Array(d,g||0,b||d.byteLength);this.initialize(st)}})}initialize(d,g){if(this._initialized)throw new Error("already initialized");this.profiler.event("session","Session.initialize",()=>{let b=this.sessionHandler.transformGraph?this.sessionHandler:void 0;this._model.load(d,b,g),this.sessionHandler.onGraphInitialized&&this.sessionHandler.onGraphInitialized(this._model.graph),this.initializeOps(this._model.graph),this._executionPlan=new xo$1(this._model.graph,this._ops,this.profiler)}),this._initialized=!0}async run(d){if(!this._initialized)throw new Error("session not initialized yet");return this.profiler.event("session","Session.run",async()=>{let g=this.normalizeAndValidateInputs(d),b=await this._executionPlan.execute(this.sessionHandler,g);return this.createOutput(b)})}normalizeAndValidateInputs(d){let g=this._model.graph.getInputNames();if(Array.isArray(d)){if(d.length!==g.length)throw new Error(`incorrect input array length: expected ${g.length} but got ${d.length}`)}else{if(d.size!==g.length)throw new Error(`incorrect input map size: expected ${g.length} but got ${d.size}`);let b=new Array(d.size),et=0;for(let st=0;st<g.length;++st){let at=d.get(g[st]);if(!at)throw new Error(`missing input tensor for: '${name}'`);b[et++]=at}d=b}if(!this.context.graphInputTypes||this.context.graphInputTypes.length===0||!this.context.graphInputDims||this.context.graphInputDims.length===0){let b=this._model.graph.getInputIndices(),et=this._model.graph.getValues(),st=new Array(b.length);for(let at=0;at<b.length;++at){let vt=et[b[at]];st[at]=vt.type.shape.dims,this.context.graphInputTypes.push(vt.type.tensorType),this.context.graphInputDims.push(d[at].dims)}this.validateInputTensorDims(st,d,!0)}else this.validateInputTensorDims(this.context.graphInputDims,d,!1);return this.validateInputTensorTypes(this.context.graphInputTypes,d),d}validateInputTensorTypes(d,g){for(let b=0;b<g.length;b++){let et=d[b],st=g[b].type;if(et!==st)throw new Error(`input tensor[${b}] check failed: expected type '${et}' but got ${st}`)}}validateInputTensorDims(d,g,b){for(let et=0;et<g.length;et++){let st=d[et],at=g[et].dims;if(!this.compareTensorDims(st,at,b))throw new Error(`input tensor[${et}] check failed: expected shape '[${st.join(",")}]' but got [${at.join(",")}]`)}}compareTensorDims(d,g,b){if(d.length!==g.length)return!1;for(let et=0;et<d.length;++et)if(d[et]!==g[et]&&(!b||d[et]!==0))return!1;return!0}createOutput(d){let g=this._model.graph.getOutputNames();if(d.length!==g.length)throw new Error("expected number of outputs do not match number of generated outputs");let b=new Map;for(let et=0;et<g.length;++et)b.set(g[et],d[et]);return b}initializeOps(d){let g=d.getNodes();this._ops=new Array(g.length);for(let b=0;b<g.length;b++)this._ops[b]=this.sessionHandler.resolve(g[b],this._model.opsets,d)}}}),Io$1,vp$1=L$1(()=>{Ot$1(),yr(),Io$1=class{constructor(d){this.session=d,this.inputNames=this.session.inputNames,this.outputNames=this.session.outputNames}async dispose(){}async run(d,g,b){let et=new Map;for(let vt in d)if(Object.hasOwnProperty.call(d,vt)){let Tt=d[vt];et.set(vt,new $e(Tt.dims,Tt.type,void 0,void 0,Tt.data))}let st=await this.session.run(et),at={};return st.forEach((vt,Tt)=>{at[Tt]=new Me(vt.type,vt.data,vt.dims)}),at}startProfiling(){this.session.startProfiling()}endProfiling(){this.session.endProfiling()}}}),_p$1={};Sr(_p$1,{onnxjsBackend:()=>tg});var Ji$1,tg,Op$1=L$1(()=>{wp$1(),vp$1(),Ji$1=class{async init(){}async createInferenceSessionHandler(d,g){let b=new Oo(g);return typeof d=="string"?await b.loadModel(d):await b.loadModel(d),new Io$1(b)}},tg=new Ji$1}),Zi$1={};Sr(Zi$1,{createReadStream:()=>Ip$1,readFile:()=>rg,readFileSync:()=>ng});var rg,ng,Ip$1,Qi$1=L$1(()=>{rg=void 0,ng=void 0,Ip$1=void 0}),ea={};Sr(ea,{join:()=>og});var og,ta=L$1(()=>{og=void 0}),Pp$1=me((d,g)=>{var b=(()=>{var st;var et=typeof document<"u"?(st=document.currentScript)==null?void 0:st.src:void 0;return typeof __filename<"u"&&(et||(et=__filename)),function(at={}){var vt=at,Tt,Ct,pt=new Promise((c0,P0)=>{Tt=c0,Ct=P0}),wt=Object.assign({},vt),$t="./this.program",Lt=typeof window=="object",jt=typeof importScripts=="function",Ft=typeof process=="object"&&typeof process.versions=="object"&&typeof process.versions.node=="string",Gt="",Ht,qt,Kt;if(Ft){var rr=(Qi$1(),ar(Zi$1)),ir=(ta(),ar(ea));Gt=jt?ir.dirname(Gt)+"/":__dirname+"/",Ht=(c0,P0)=>(c0=Tn(c0)?new URL(c0):ir.normalize(c0),rr.readFileSync(c0,P0?void 0:"utf8")),Kt=c0=>(c0=Ht(c0,!0),c0.buffer||(c0=new Uint8Array(c0)),c0),qt=(c0,P0,R0,B0=!0)=>{c0=Tn(c0)?new URL(c0):ir.normalize(c0),rr.readFile(c0,B0?void 0:"utf8",(W0,s1)=>{W0?R0(W0):P0(B0?s1.buffer:s1)})},!vt.thisProgram&&1<process.argv.length&&($t=process.argv[1].replace(/\\/g,"/")),process.argv.slice(2)}else(Lt||jt)&&(jt?Gt=self.location.href:typeof document<"u"&&document.currentScript&&(Gt=document.currentScript.src),et&&(Gt=et),Gt.startsWith("blob:")?Gt="":Gt=Gt.substr(0,Gt.replace(/[?#].*/,"").lastIndexOf("/")+1),Ht=c0=>{var P0=new XMLHttpRequest;return P0.open("GET",c0,!1),P0.send(null),P0.responseText},jt&&(Kt=c0=>{var P0=new XMLHttpRequest;return P0.open("GET",c0,!1),P0.responseType="arraybuffer",P0.send(null),new Uint8Array(P0.response)}),qt=(c0,P0,R0)=>{var B0=new XMLHttpRequest;B0.open("GET",c0,!0),B0.responseType="arraybuffer",B0.onload=()=>{B0.status==200||B0.status==0&&B0.response?P0(B0.response):R0()},B0.onerror=R0,B0.send(null)});var or=console.log.bind(console),jr=console.error.bind(console);Object.assign(vt,wt),wt=null;var qr,Yr=!1,vn,ko,Xo,zo,t0;function Uo(){var c0=qr.buffer;vt.HEAP8=vn=new Int8Array(c0),vt.HEAP16=new Int16Array(c0),vt.HEAPU8=ko=new Uint8Array(c0),vt.HEAPU16=new Uint16Array(c0),vt.HEAP32=Xo=new Int32Array(c0),vt.HEAPU32=zo=new Uint32Array(c0),vt.HEAPF32=new Float32Array(c0),vt.HEAPF64=t0=new Float64Array(c0)}var No=[],_n=[],Kr=[],e0=0,Zr=null;function Ro(c0){throw c0="Aborted("+c0+")",jr(c0),Yr=!0,c0=new WebAssembly.RuntimeError(c0+". Build with -sASSERTIONS for more info."),Ct(c0),c0}var Sn=c0=>c0.startsWith("data:application/octet-stream;base64,"),Tn=c0=>c0.startsWith("file://"),n0;if(n0="ort-wasm.wasm",!Sn(n0)){var Go=n0;n0=vt.locateFile?vt.locateFile(Go,Gt):Gt+Go}function An(c0){if(Kt)return Kt(c0);throw"both async and sync fetching of the wasm failed"}function a0(c0){if(Lt||jt){if(typeof fetch=="function"&&!Tn(c0))return fetch(c0,{credentials:"same-origin"}).then(P0=>{if(!P0.ok)throw`failed to load wasm binary file at '${c0}'`;return P0.arrayBuffer()}).catch(()=>An(c0));if(qt)return new Promise((P0,R0)=>{qt(c0,B0=>P0(new Uint8Array(B0)),R0)})}return Promise.resolve().then(()=>An(c0))}function u0(c0,P0,R0){return a0(c0).then(B0=>WebAssembly.instantiate(B0,P0)).then(R0,B0=>{jr(`failed to asynchronously prepare wasm: ${B0}`),Ro(B0)})}function d0(c0,P0){var R0=n0;return typeof WebAssembly.instantiateStreaming!="function"||Sn(R0)||Tn(R0)||Ft||typeof fetch!="function"?u0(R0,c0,P0):fetch(R0,{credentials:"same-origin"}).then(B0=>WebAssembly.instantiateStreaming(B0,c0).then(P0,function(W0){return jr(`wasm streaming compile failed: ${W0}`),jr("falling back to ArrayBuffer instantiation"),u0(R0,c0,P0)}))}var f0,y0={798088:(c0,P0,R0,B0)=>{if(typeof vt>"u"||!vt.ya)return 1;if(c0=k0(c0>>>0),c0.startsWith("./")&&(c0=c0.substring(2)),c0=vt.ya.get(c0),!c0)return 2;if(P0>>>=0,R0>>>=0,P0+R0>c0.byteLength)return 3;try{return ko.set(c0.subarray(P0,P0+R0),B0>>>0>>>0),0}catch{return 4}}};class b0{constructor(P0){this.wa=P0-24}}var O0=0,C0=typeof TextDecoder<"u"?new TextDecoder("utf8"):void 0,v0=(c0,P0,R0)=>{P0>>>=0;var B0=P0+R0;for(R0=P0;c0[R0]&&!(R0>=B0);)++R0;if(16<R0-P0&&c0.buffer&&C0)return C0.decode(c0.subarray(P0,R0));for(B0="";P0<R0;){var W0=c0[P0++];if(W0&128){var s1=c0[P0++]&63;if((W0&224)==192)B0+=String.fromCharCode((W0&31)<<6|s1);else{var E1=c0[P0++]&63;W0=(W0&240)==224?(W0&15)<<12|s1<<6|E1:(W0&7)<<18|s1<<12|E1<<6|c0[P0++]&63,65536>W0?B0+=String.fromCharCode(W0):(W0-=65536,B0+=String.fromCharCode(55296|W0>>10,56320|W0&1023))}}else B0+=String.fromCharCode(W0)}return B0},k0=(c0,P0)=>(c0>>>=0)?v0(ko,c0,P0):"",N0=c0=>{for(var P0=0,R0=0;R0<c0.length;++R0){var B0=c0.charCodeAt(R0);127>=B0?P0++:2047>=B0?P0+=2:55296<=B0&&57343>=B0?(P0+=4,++R0):P0+=3}return P0},w0=(c0,P0,R0,B0)=>{if(R0>>>=0,!(0<B0))return 0;var W0=R0;B0=R0+B0-1;for(var s1=0;s1<c0.length;++s1){var E1=c0.charCodeAt(s1);if(55296<=E1&&57343>=E1){var Q1=c0.charCodeAt(++s1);E1=65536+((E1&1023)<<10)|Q1&1023}if(127>=E1){if(R0>=B0)break;P0[R0++>>>0]=E1}else{if(2047>=E1){if(R0+1>=B0)break;P0[R0++>>>0]=192|E1>>6}else{if(65535>=E1){if(R0+2>=B0)break;P0[R0++>>>0]=224|E1>>12}else{if(R0+3>=B0)break;P0[R0++>>>0]=240|E1>>18,P0[R0++>>>0]=128|E1>>12&63}P0[R0++>>>0]=128|E1>>6&63}P0[R0++>>>0]=128|E1&63}}return P0[R0>>>0]=0,R0-W0},r0=c0=>c0%4===0&&(c0%100!==0||c0%400===0),p0=[0,31,60,91,121,152,182,213,244,274,305,335],$0=[0,31,59,90,120,151,181,212,243,273,304,334],A0=[],g0={},E0=()=>{if(!F0){var c0={USER:"web_user",LOGNAME:"web_user",PATH:"/",PWD:"/",HOME:"/home/web_user",LANG:(typeof navigator=="object"&&navigator.languages&&navigator.languages[0]||"C").replace("-","_")+".UTF-8",_:$t||"./this.program"},P0;for(P0 in g0)g0[P0]===void 0?delete c0[P0]:c0[P0]=g0[P0];var R0=[];for(P0 in c0)R0.push(`${P0}=${c0[P0]}`);F0=R0}return F0},F0,K0=[null,[],[]],l1=[31,29,31,30,31,30,31,31,30,31,30,31],n1=[31,28,31,30,31,30,31,31,30,31,30,31];function x1(c0){var P0=Array(N0(c0)+1);return w0(c0,P0,0,P0.length),P0}function u1(c0,P0,R0,B0){function W0(j0,N1,T0){for(j0=typeof j0=="number"?j0.toString():j0||"";j0.length<N1;)j0=T0[0]+j0;return j0}function s1(j0,N1){return W0(j0,N1,"0")}function E1(j0,N1){function T0(O1){return 0>O1?-1:0<O1?1:0}var c1;return(c1=T0(j0.getFullYear()-N1.getFullYear()))===0&&(c1=T0(j0.getMonth()-N1.getMonth()))===0&&(c1=T0(j0.getDate()-N1.getDate())),c1}function Q1(j0){switch(j0.getDay()){case 0:return new Date(j0.getFullYear()-1,11,29);case 1:return j0;case 2:return new Date(j0.getFullYear(),0,3);case 3:return new Date(j0.getFullYear(),0,2);case 4:return new Date(j0.getFullYear(),0,1);case 5:return new Date(j0.getFullYear()-1,11,31);case 6:return new Date(j0.getFullYear()-1,11,30)}}function K1(j0){var N1=j0.sa;for(j0=new Date(new Date(j0.ta+1900,0,1).getTime());0<N1;){var T0=j0.getMonth(),c1=(r0(j0.getFullYear())?l1:n1)[T0];if(N1>c1-j0.getDate())N1-=c1-j0.getDate()+1,j0.setDate(1),11>T0?j0.setMonth(T0+1):(j0.setMonth(0),j0.setFullYear(j0.getFullYear()+1));else{j0.setDate(j0.getDate()+N1);break}}return T0=new Date(j0.getFullYear()+1,0,4),N1=Q1(new Date(j0.getFullYear(),0,4)),T0=Q1(T0),0>=E1(N1,j0)?0>=E1(T0,j0)?j0.getFullYear()+1:j0.getFullYear():j0.getFullYear()-1}c0>>>=0,P0>>>=0,R0>>>=0,B0>>>=0;var W1=zo[B0+40>>>2>>>0];B0={Ba:Xo[B0>>>2>>>0],Aa:Xo[B0+4>>>2>>>0],ua:Xo[B0+8>>>2>>>0],xa:Xo[B0+12>>>2>>>0],va:Xo[B0+16>>>2>>>0],ta:Xo[B0+20>>>2>>>0],na:Xo[B0+24>>>2>>>0],sa:Xo[B0+28>>>2>>>0],Da:Xo[B0+32>>>2>>>0],za:Xo[B0+36>>>2>>>0],Ca:W1?k0(W1):""},R0=k0(R0),W1={"%c":"%a %b %d %H:%M:%S %Y","%D":"%m/%d/%y","%F":"%Y-%m-%d","%h":"%b","%r":"%I:%M:%S %p","%R":"%H:%M","%T":"%H:%M:%S","%x":"%m/%d/%y","%X":"%H:%M:%S","%Ec":"%c","%EC":"%C","%Ex":"%m/%d/%y","%EX":"%H:%M:%S","%Ey":"%y","%EY":"%Y","%Od":"%d","%Oe":"%e","%OH":"%H","%OI":"%I","%Om":"%m","%OM":"%M","%OS":"%S","%Ou":"%u","%OU":"%U","%OV":"%V","%Ow":"%w","%OW":"%W","%Oy":"%y"};for(var nv in W1)R0=R0.replace(new RegExp(nv,"g"),W1[nv]);var Nv="Sunday Monday Tuesday Wednesday Thursday Friday Saturday".split(" "),pv="January February March April May June July August September October November December".split(" ");W1={"%a":j0=>Nv[j0.na].substring(0,3),"%A":j0=>Nv[j0.na],"%b":j0=>pv[j0.va].substring(0,3),"%B":j0=>pv[j0.va],"%C":j0=>s1((j0.ta+1900)/100|0,2),"%d":j0=>s1(j0.xa,2),"%e":j0=>W0(j0.xa,2," "),"%g":j0=>K1(j0).toString().substring(2),"%G":K1,"%H":j0=>s1(j0.ua,2),"%I":j0=>(j0=j0.ua,j0==0?j0=12:12<j0&&(j0-=12),s1(j0,2)),"%j":j0=>{for(var N1=0,T0=0;T0<=j0.va-1;N1+=(r0(j0.ta+1900)?l1:n1)[T0++]);return s1(j0.xa+N1,3)},"%m":j0=>s1(j0.va+1,2),"%M":j0=>s1(j0.Aa,2),"%n":()=>`
`,"%p":j0=>0<=j0.ua&&12>j0.ua?"AM":"PM","%S":j0=>s1(j0.Ba,2),"%t":()=>"	","%u":j0=>j0.na||7,"%U":j0=>s1(Math.floor((j0.sa+7-j0.na)/7),2),"%V":j0=>{var N1=Math.floor((j0.sa+7-(j0.na+6)%7)/7);if(2>=(j0.na+371-j0.sa-2)%7&&N1++,N1)N1==53&&(T0=(j0.na+371-j0.sa)%7,T0==4||T0==3&&r0(j0.ta)||(N1=1));else{N1=52;var T0=(j0.na+7-j0.sa-1)%7;(T0==4||T0==5&&r0(j0.ta%400-1))&&N1++}return s1(N1,2)},"%w":j0=>j0.na,"%W":j0=>s1(Math.floor((j0.sa+7-(j0.na+6)%7)/7),2),"%y":j0=>(j0.ta+1900).toString().substring(2),"%Y":j0=>j0.ta+1900,"%z":j0=>{j0=j0.za;var N1=0<=j0;return j0=Math.abs(j0)/60,(N1?"+":"-")+("0000"+(j0/60*100+j0%60)).slice(-4)},"%Z":j0=>j0.Ca,"%%":()=>"%"},R0=R0.replace(/%%/g,"\0\0");for(nv in W1)R0.includes(nv)&&(R0=R0.replace(new RegExp(nv,"g"),W1[nv](B0)));return R0=R0.replace(/\0\0/g,"%"),nv=x1(R0),nv.length>P0?0:(vn.set(nv,c0>>>0),nv.length-1)}var P1={a:function(c0,P0,R0){c0>>>=0;var B0=new b0(c0);throw zo[B0.wa+16>>>2>>>0]=0,zo[B0.wa+4>>>2>>>0]=P0>>>0,zo[B0.wa+8>>>2>>>0]=R0>>>0,O0=c0,O0},e:function(){return 0},H:function(){},x:function(){},z:function(){},J:function(){return 0},F:function(){},A:function(){},E:function(){},g:function(){},y:function(){},v:function(){},G:function(){},w:function(){},k:()=>1,I:function(c0,P0,R0){return P0>>>=0,ko.copyWithin(c0>>>0>>>0,P0>>>0,P0+(R0>>>0)>>>0)},n:function(c0,P0,R0){c0=P0+2097152>>>0<4194305-!!c0?(c0>>>0)+4294967296*P0:NaN,R0>>>=0,c0=new Date(1e3*c0),Xo[R0>>>2>>>0]=c0.getUTCSeconds(),Xo[R0+4>>>2>>>0]=c0.getUTCMinutes(),Xo[R0+8>>>2>>>0]=c0.getUTCHours(),Xo[R0+12>>>2>>>0]=c0.getUTCDate(),Xo[R0+16>>>2>>>0]=c0.getUTCMonth(),Xo[R0+20>>>2>>>0]=c0.getUTCFullYear()-1900,Xo[R0+24>>>2>>>0]=c0.getUTCDay(),Xo[R0+28>>>2>>>0]=(c0.getTime()-Date.UTC(c0.getUTCFullYear(),0,1,0,0,0,0))/864e5|0},o:function(c0,P0,R0){c0=P0+2097152>>>0<4194305-!!c0?(c0>>>0)+4294967296*P0:NaN,R0>>>=0,c0=new Date(1e3*c0),Xo[R0>>>2>>>0]=c0.getSeconds(),Xo[R0+4>>>2>>>0]=c0.getMinutes(),Xo[R0+8>>>2>>>0]=c0.getHours(),Xo[R0+12>>>2>>>0]=c0.getDate(),Xo[R0+16>>>2>>>0]=c0.getMonth(),Xo[R0+20>>>2>>>0]=c0.getFullYear()-1900,Xo[R0+24>>>2>>>0]=c0.getDay(),Xo[R0+28>>>2>>>0]=(r0(c0.getFullYear())?p0:$0)[c0.getMonth()]+c0.getDate()-1|0,Xo[R0+36>>>2>>>0]=-(60*c0.getTimezoneOffset()),P0=new Date(c0.getFullYear(),6,1).getTimezoneOffset();var B0=new Date(c0.getFullYear(),0,1).getTimezoneOffset();Xo[R0+32>>>2>>>0]=(P0!=B0&&c0.getTimezoneOffset()==Math.min(B0,P0))|0},p:function(c0){c0>>>=0;var P0=new Date(Xo[c0+20>>>2>>>0]+1900,Xo[c0+16>>>2>>>0],Xo[c0+12>>>2>>>0],Xo[c0+8>>>2>>>0],Xo[c0+4>>>2>>>0],Xo[c0>>>2>>>0],0),R0=Xo[c0+32>>>2>>>0],B0=P0.getTimezoneOffset(),W0=new Date(P0.getFullYear(),6,1).getTimezoneOffset(),s1=new Date(P0.getFullYear(),0,1).getTimezoneOffset(),E1=Math.min(s1,W0);return 0>R0?Xo[c0+32>>>2>>>0]=+(W0!=s1&&E1==B0):0<R0!=(E1==B0)&&(W0=Math.max(s1,W0),P0.setTime(P0.getTime()+6e4*((0<R0?E1:W0)-B0))),Xo[c0+24>>>2>>>0]=P0.getDay(),Xo[c0+28>>>2>>>0]=(r0(P0.getFullYear())?p0:$0)[P0.getMonth()]+P0.getDate()-1|0,Xo[c0>>>2>>>0]=P0.getSeconds(),Xo[c0+4>>>2>>>0]=P0.getMinutes(),Xo[c0+8>>>2>>>0]=P0.getHours(),Xo[c0+12>>>2>>>0]=P0.getDate(),Xo[c0+16>>>2>>>0]=P0.getMonth(),Xo[c0+20>>>2>>>0]=P0.getYear(),c0=P0.getTime(),c0=isNaN(c0)?-1:c0/1e3,v1((f0=c0,1<=+Math.abs(f0)?0<f0?+Math.floor(f0/4294967296)>>>0:~~+Math.ceil((f0-+(~~f0>>>0))/4294967296)>>>0:0)),c0>>>0},l:function(){return-52},m:function(){},t:function(c0,P0,R0,B0){R0>>>=0,B0>>>=0;var W0=new Date().getFullYear(),s1=new Date(W0,0,1),E1=new Date(W0,6,1);W0=s1.getTimezoneOffset();var Q1=E1.getTimezoneOffset();zo[c0>>>0>>>2>>>0]=60*Math.max(W0,Q1),Xo[P0>>>0>>>2>>>0]=+(W0!=Q1),c0=K1=>K1.toLocaleTimeString(void 0,{hour12:!1,timeZoneName:"short"}).split(" ")[1],s1=c0(s1),E1=c0(E1),Q1<W0?(w0(s1,ko,R0,17),w0(E1,ko,B0,17)):(w0(s1,ko,B0,17),w0(E1,ko,R0,17))},d:()=>{Ro("")},B:function(c0,P0,R0){c0>>>=0,P0>>>=0,R0>>>=0,A0.length=0;for(var B0;B0=ko[P0++>>>0];){var W0=B0!=105;W0&=B0!=112,R0+=W0&&R0%8?4:0,A0.push(B0==112?zo[R0>>>2>>>0]:B0==105?Xo[R0>>>2>>>0]:t0[R0>>>3>>>0]),R0+=W0?8:4}return y0[c0](...A0)},h:()=>Date.now(),u:function(){return 4294901760},b:()=>performance.now(),s:function(c0){c0>>>=0;var P0=ko.length;if(4294901760<c0)return!1;for(var R0=1;4>=R0;R0*=2){var B0=P0*(1+.2/R0);B0=Math.min(B0,c0+100663296);var W0=Math;B0=Math.max(c0,B0);e:{W0=(W0.min.call(W0,4294901760,B0+(65536-B0%65536)%65536)-qr.buffer.byteLength+65535)/65536;try{qr.grow(W0),Uo();var s1=1;break e}catch{}s1=void 0}if(s1)return!0}return!1},C:function(c0,P0){c0>>>=0,P0>>>=0;var R0=0;return E0().forEach((B0,W0)=>{var s1=P0+R0;for(W0=zo[c0+4*W0>>>2>>>0]=s1,s1=0;s1<B0.length;++s1)vn[W0++>>>0]=B0.charCodeAt(s1);vn[W0>>>0]=0,R0+=B0.length+1}),0},D:function(c0,P0){c0>>>=0,P0>>>=0;var R0=E0();zo[c0>>>2>>>0]=R0.length;var B0=0;return R0.forEach(W0=>B0+=W0.length+1),zo[P0>>>2>>>0]=B0,0},f:()=>52,j:function(){return 52},q:function(){return 70},i:function(c0,P0,R0,B0){P0>>>=0,R0>>>=0,B0>>>=0;for(var W0=0,s1=0;s1<R0;s1++){var E1=zo[P0>>>2>>>0],Q1=zo[P0+4>>>2>>>0];P0+=8;for(var K1=0;K1<Q1;K1++){var W1=ko[E1+K1>>>0],nv=K0[c0];W1===0||W1===10?((c0===1?or:jr)(v0(nv,0)),nv.length=0):nv.push(W1)}W0+=Q1}return zo[B0>>>2>>>0]=W0,0},r:u1,c:function(c0,P0,R0,B0){return u1(c0>>>0,P0>>>0,R0>>>0,B0>>>0)}},i1=function(){function c0(R0){return i1=R0.exports,i1=cv(),qr=i1.K,Uo(),_n.unshift(i1.L),e0--,e0==0&&Zr&&(R0=Zr,Zr=null,R0()),i1}var P0={a:P1};if(e0++,vt.instantiateWasm)try{return vt.instantiateWasm(P0,c0)}catch(R0){jr(`Module.instantiateWasm callback failed with error: ${R0}`),Ct(R0)}return d0(P0,function(R0){c0(R0.instance)}).catch(Ct),{}}();vt._OrtInit=(c0,P0)=>(vt._OrtInit=i1.M)(c0,P0),vt._OrtGetLastError=(c0,P0)=>(vt._OrtGetLastError=i1.N)(c0,P0),vt._OrtCreateSessionOptions=(c0,P0,R0,B0,W0,s1,E1,Q1,K1,W1)=>(vt._OrtCreateSessionOptions=i1.O)(c0,P0,R0,B0,W0,s1,E1,Q1,K1,W1),vt._OrtAppendExecutionProvider=(c0,P0)=>(vt._OrtAppendExecutionProvider=i1.P)(c0,P0),vt._OrtAddFreeDimensionOverride=(c0,P0,R0)=>(vt._OrtAddFreeDimensionOverride=i1.Q)(c0,P0,R0),vt._OrtAddSessionConfigEntry=(c0,P0,R0)=>(vt._OrtAddSessionConfigEntry=i1.R)(c0,P0,R0),vt._OrtReleaseSessionOptions=c0=>(vt._OrtReleaseSessionOptions=i1.S)(c0),vt._OrtCreateSession=(c0,P0,R0)=>(vt._OrtCreateSession=i1.T)(c0,P0,R0),vt._OrtReleaseSession=c0=>(vt._OrtReleaseSession=i1.U)(c0),vt._OrtGetInputOutputCount=(c0,P0,R0)=>(vt._OrtGetInputOutputCount=i1.V)(c0,P0,R0),vt._OrtGetInputName=(c0,P0)=>(vt._OrtGetInputName=i1.W)(c0,P0),vt._OrtGetOutputName=(c0,P0)=>(vt._OrtGetOutputName=i1.X)(c0,P0),vt._OrtFree=c0=>(vt._OrtFree=i1.Y)(c0),vt._OrtCreateTensor=(c0,P0,R0,B0,W0,s1)=>(vt._OrtCreateTensor=i1.Z)(c0,P0,R0,B0,W0,s1),vt._OrtGetTensorData=(c0,P0,R0,B0,W0)=>(vt._OrtGetTensorData=i1._)(c0,P0,R0,B0,W0),vt._OrtReleaseTensor=c0=>(vt._OrtReleaseTensor=i1.$)(c0),vt._OrtCreateRunOptions=(c0,P0,R0,B0)=>(vt._OrtCreateRunOptions=i1.aa)(c0,P0,R0,B0),vt._OrtAddRunConfigEntry=(c0,P0,R0)=>(vt._OrtAddRunConfigEntry=i1.ba)(c0,P0,R0),vt._OrtReleaseRunOptions=c0=>(vt._OrtReleaseRunOptions=i1.ca)(c0),vt._OrtCreateBinding=c0=>(vt._OrtCreateBinding=i1.da)(c0),vt._OrtBindInput=(c0,P0,R0)=>(vt._OrtBindInput=i1.ea)(c0,P0,R0),vt._OrtBindOutput=(c0,P0,R0,B0)=>(vt._OrtBindOutput=i1.fa)(c0,P0,R0,B0),vt._OrtClearBoundOutputs=c0=>(vt._OrtClearBoundOutputs=i1.ga)(c0),vt._OrtReleaseBinding=c0=>(vt._OrtReleaseBinding=i1.ha)(c0),vt._OrtRunWithBinding=(c0,P0,R0,B0,W0)=>(vt._OrtRunWithBinding=i1.ia)(c0,P0,R0,B0,W0),vt._OrtRun=(c0,P0,R0,B0,W0,s1,E1,Q1)=>(vt._OrtRun=i1.ja)(c0,P0,R0,B0,W0,s1,E1,Q1),vt._OrtEndProfiling=c0=>(vt._OrtEndProfiling=i1.ka)(c0),vt._malloc=c0=>(vt._malloc=i1.la)(c0),vt._free=c0=>(vt._free=i1.ma)(c0);var v1=c0=>(v1=i1.oa)(c0),_1=c0=>(_1=i1.pa)(c0),X1=c0=>(X1=i1.qa)(c0),t1=()=>(t1=i1.ra)();function cv(){var c0=i1;c0=Object.assign({},c0);var P0=R0=>B0=>R0(B0)>>>0;return c0.la=P0(c0.la),c0.qa=P0(c0.qa),c0.ra=(R0=>()=>R0()>>>0)(c0.ra),c0}vt.stackSave=()=>t1(),vt.stackRestore=c0=>_1(c0),vt.stackAlloc=c0=>X1(c0),vt.UTF8ToString=k0,vt.stringToUTF8=(c0,P0,R0)=>w0(c0,ko,P0,R0),vt.lengthBytesUTF8=N0;var S1;Zr=function c0(){S1||ev(),S1||(Zr=c0)};function ev(){if(!(0<e0)){if(vt.preRun)for(typeof vt.preRun=="function"&&(vt.preRun=[vt.preRun]);vt.preRun.length;){var c0=vt.preRun.shift();No.unshift(c0)}for(;0<No.length;)No.shift()(vt);if(!(0<e0||S1||(S1=!0,vt.calledRun=!0,Yr))){for(;0<_n.length;)_n.shift()(vt);for(Tt(vt);0<Kr.length;)Kr.shift()(vt)}}}return ev(),pt}})();typeof d=="object"&&typeof g=="object"?g.exports=b:typeof define=="function"&&define.amd&&define([],()=>b)}),Ep$1=me(()=>{}),Dp$1=me(()=>{}),Lp$1={};Sr(Lp$1,{cpus:()=>ig});var ig,Cp$1=L$1(()=>{ig=void 0}),kp$1=me((d,g)=>{var b=(()=>{var st;var et=typeof document<"u"?(st=document.currentScript)==null?void 0:st.src:void 0;return typeof __filename<"u"&&(et||(et=__filename)),function(at={}){function vt(){return Kr.buffer!=Sn.buffer&&a0(),Sn}function Tt(){return Kr.buffer!=Sn.buffer&&a0(),Tn}function Ct(){return Kr.buffer!=Sn.buffer&&a0(),n0}function pt(){return Kr.buffer!=Sn.buffer&&a0(),Go}function wt(){return Kr.buffer!=Sn.buffer&&a0(),An}var $t=at,Lt,jt,Ft=new Promise((Mo,Ir)=>{Lt=Mo,jt=Ir}),Gt=Object.assign({},$t),Ht="./this.program",qt=(Mo,Ir)=>{throw Ir},Kt=typeof window=="object",rr=typeof importScripts=="function",ir=typeof process=="object"&&typeof process.versions=="object"&&typeof process.versions.node=="string",or=$t.ENVIRONMENT_IS_PTHREAD||!1,jr="";function qr(Mo){return $t.locateFile?$t.locateFile(Mo,jr):jr+Mo}var Yr,vn,ko;if(ir){var Xo=(Qi$1(),ar(Zi$1)),zo=(ta(),ar(ea));jr=rr?zo.dirname(jr)+"/":__dirname+"/",Yr=(Mo,Ir)=>(Mo=N0(Mo)?new URL(Mo):zo.normalize(Mo),Xo.readFileSync(Mo,Ir?void 0:"utf8")),ko=Mo=>(Mo=Yr(Mo,!0),Mo.buffer||(Mo=new Uint8Array(Mo)),Mo),vn=(Mo,Ir,Xr,In=!0)=>{Mo=N0(Mo)?new URL(Mo):zo.normalize(Mo),Xo.readFile(Mo,In?void 0:"utf8",(Qo,s0)=>{Qo?Xr(Qo):Ir(In?s0.buffer:s0)})},!$t.thisProgram&&1<process.argv.length&&(Ht=process.argv[1].replace(/\\/g,"/")),process.argv.slice(2),qt=(Mo,Ir)=>{throw process.exitCode=Mo,Ir},global.Worker=Ep$1().Worker}else(Kt||rr)&&(rr?jr=self.location.href:typeof document<"u"&&document.currentScript&&(jr=document.currentScript.src),typeof et<"u"&&et&&(jr=et),jr.startsWith("blob:")?jr="":jr=jr.substr(0,jr.replace(/[?#].*/,"").lastIndexOf("/")+1),ir||(Yr=Mo=>{var Ir=new XMLHttpRequest;return Ir.open("GET",Mo,!1),Ir.send(null),Ir.responseText},rr&&(ko=Mo=>{var Ir=new XMLHttpRequest;return Ir.open("GET",Mo,!1),Ir.responseType="arraybuffer",Ir.send(null),new Uint8Array(Ir.response)}),vn=(Mo,Ir,Xr)=>{var In=new XMLHttpRequest;In.open("GET",Mo,!0),In.responseType="arraybuffer",In.onload=()=>{In.status==200||In.status==0&&In.response?Ir(In.response):Xr()},In.onerror=Xr,In.send(null)}));ir&&typeof performance>"u"&&(global.performance=Dp$1().performance);var t0=console.log.bind(console),Uo=console.error.bind(console);ir&&(t0=(...Mo)=>Xo.writeSync(1,Mo.join(" ")+`
`),Uo=(...Mo)=>Xo.writeSync(2,Mo.join(" ")+`
`));var No=t0,_n=Uo;Object.assign($t,Gt),Gt=null;var Kr,e0,Zr=!1,Ro,Sn,Tn,n0,Go,An;function a0(){var Mo=Kr.buffer;$t.HEAP8=Sn=new Int8Array(Mo),$t.HEAP16=new Int16Array(Mo),$t.HEAPU8=Tn=new Uint8Array(Mo),$t.HEAPU16=new Uint16Array(Mo),$t.HEAP32=n0=new Int32Array(Mo),$t.HEAPU32=Go=new Uint32Array(Mo),$t.HEAPF32=new Float32Array(Mo),$t.HEAPF64=An=new Float64Array(Mo)}var u0=16777216;if(or)Kr=$t.wasmMemory;else if($t.wasmMemory)Kr=$t.wasmMemory;else if(Kr=new WebAssembly.Memory({initial:u0/65536,maximum:65536,shared:!0}),!(Kr.buffer instanceof SharedArrayBuffer))throw _n("requested a shared WebAssembly.Memory but the returned buffer is not a SharedArrayBuffer, indicating that while the browser has SharedArrayBuffer it does not have WebAssembly threads support - you may need to set a flag"),ir&&_n("(on node you may need: --experimental-wasm-threads --experimental-wasm-bulk-memory and/or recent version)"),Error("bad memory");a0(),u0=Kr.buffer.byteLength;var d0=[],f0=[],y0=[],b0=0,O0=null;function C0(){if(b0--,b0==0&&O0){var Mo=O0;O0=null,Mo()}}function v0(Mo){throw Mo="Aborted("+Mo+")",_n(Mo),Zr=!0,Ro=1,Mo=new WebAssembly.RuntimeError(Mo+". Build with -sASSERTIONS for more info."),jt(Mo),Mo}var k0=Mo=>Mo.startsWith("data:application/octet-stream;base64,"),N0=Mo=>Mo.startsWith("file://"),w0;w0="ort-wasm-threaded.wasm",k0(w0)||(w0=qr(w0));function r0(Mo){if(ko)return ko(Mo);throw"both async and sync fetching of the wasm failed"}function p0(Mo){if(Kt||rr){if(typeof fetch=="function"&&!N0(Mo))return fetch(Mo,{credentials:"same-origin"}).then(Ir=>{if(!Ir.ok)throw`failed to load wasm binary file at '${Mo}'`;return Ir.arrayBuffer()}).catch(()=>r0(Mo));if(vn)return new Promise((Ir,Xr)=>{vn(Mo,In=>Ir(new Uint8Array(In)),Xr)})}return Promise.resolve().then(()=>r0(Mo))}function $0(Mo,Ir,Xr){return p0(Mo).then(In=>WebAssembly.instantiate(In,Ir)).then(Xr,In=>{_n(`failed to asynchronously prepare wasm: ${In}`),v0(In)})}function A0(Mo,Ir){var Xr=w0;return typeof WebAssembly.instantiateStreaming!="function"||k0(Xr)||N0(Xr)||ir||typeof fetch!="function"?$0(Xr,Mo,Ir):fetch(Xr,{credentials:"same-origin"}).then(In=>WebAssembly.instantiateStreaming(In,Mo).then(Ir,function(Qo){return _n(`wasm streaming compile failed: ${Qo}`),_n("falling back to ArrayBuffer instantiation"),$0(Xr,Mo,Ir)}))}var g0,E0={799444:(Mo,Ir,Xr,In)=>{if(typeof $t>"u"||!$t.bb)return 1;if(Mo=Q1(Mo>>>0),Mo.startsWith("./")&&(Mo=Mo.substring(2)),Mo=$t.bb.get(Mo),!Mo)return 2;if(Ir>>>=0,Xr>>>=0,In>>>=0,Ir+Xr>Mo.byteLength)return 3;try{return Tt().set(Mo.subarray(Ir,Ir+Xr),In>>>0),0}catch{return 4}}};function F0(Mo){this.name="ExitStatus",this.message=`Program terminated with exit(${Mo})`,this.status=Mo}var K0=Mo=>{Mo.terminate(),Mo.onmessage=()=>{}},l1=Mo=>{t1.Oa.length==0&&(_1(),t1.Xa(t1.Oa[0]));var Ir=t1.Oa.pop();if(!Ir)return 6;t1.Pa.push(Ir),t1.La[Mo.Na]=Ir,Ir.Na=Mo.Na;var Xr={cmd:"run",start_routine:Mo.gb,arg:Mo.cb,pthread_ptr:Mo.Na};return ir&&Ir.unref(),Ir.postMessage(Xr,Mo.mb),0},n1=0,x1=Mo=>{var Ir=kv();return Mo=Mo(),Tv(Ir),Mo},u1=(Mo,Ir,...Xr)=>x1(()=>{for(var In=Xr.length,Qo=ky(8*In),s0=Qo>>>3,x0=0;x0<Xr.length;x0++){var H0=Xr[x0];wt()[s0+x0>>>0]=H0}return Py(Mo,0,In,Qo,Ir)});function P1(Mo){var Ir;if(or)return u1(0,1,Mo);Ro=Mo,0<n1||(t1.hb(),(Ir=$t.onExit)==null||Ir.call($t,Mo),Zr=!0),qt(Mo,new F0(Mo))}var i1=Mo=>{if(Ro=Mo,or)throw S1(Mo),"unwind";P1(Mo)};function v1(){for(var Mo=$t.numThreads;Mo--;)_1();d0.unshift(()=>{b0++,X1(()=>C0())})}function _1(){var Mo=qr("ort-wasm-threaded.worker.js");Mo=new Worker(Mo),t1.Oa.push(Mo)}function X1(Mo){or?Mo():Promise.all(t1.Oa.map(t1.Xa)).then(Mo)}var t1={Oa:[],Pa:[],ab:[],La:{},Va(){or?(t1.receiveObjectTransfer=t1.fb,t1.threadInitTLS=t1.$a,t1.setExitStatus=t1.Za):v1()},Za:Mo=>Ro=Mo,pb:["$terminateWorker"],hb:()=>{for(var Mo of t1.Pa)K0(Mo);for(Mo of t1.Oa)K0(Mo);t1.Oa=[],t1.Pa=[],t1.La=[]},Ya:Mo=>{var Ir=Mo.Na;delete t1.La[Ir],t1.Oa.push(Mo),t1.Pa.splice(t1.Pa.indexOf(Mo),1),Mo.Na=0,jv(Ir)},fb(){},$a(){t1.ab.forEach(Mo=>Mo())},Xa:Mo=>new Promise(Ir=>{Mo.onmessage=s0=>{s0=s0.data;var x0=s0.cmd;if(s0.targetThread&&s0.targetThread!=Fy()){var H0=t1.La[s0.targetThread];H0?H0.postMessage(s0,s0.transferList):_n(`Internal error! Worker sent a message "${x0}" to target pthread ${s0.targetThread}, but that thread no longer exists!`)}else x0==="checkMailbox"?wv():x0==="spawnThread"?l1(s0):x0==="cleanupThread"?t1.Ya(t1.La[s0.thread]):x0==="killThread"?(s0=s0.thread,x0=t1.La[s0],delete t1.La[s0],K0(x0),jv(s0),t1.Pa.splice(t1.Pa.indexOf(x0),1),x0.Na=0):x0==="cancelThread"?t1.La[s0.thread].postMessage({cmd:"cancel"}):x0==="loaded"?(Mo.loaded=!0,ir&&!Mo.Na&&Mo.unref(),Ir(Mo)):x0==="alert"?alert(`Thread ${s0.threadId}: ${s0.text}`):s0.target==="setimmediate"?Mo.postMessage(s0):x0==="callHandler"?$t[s0.handler](...s0.args):x0&&_n(`worker sent an unknown command ${x0}`)},Mo.onerror=s0=>{throw _n(`worker sent an error! ${s0.filename}:${s0.lineno}: ${s0.message}`),s0},ir&&(Mo.on("message",s0=>Mo.onmessage({data:s0})),Mo.on("error",s0=>Mo.onerror(s0)));var Xr=[],In=["onExit"],Qo;for(Qo of In)$t.hasOwnProperty(Qo)&&Xr.push(Qo);Mo.postMessage({cmd:"load",handlers:Xr,urlOrBlob:$t.mainScriptUrlOrBlob||et,wasmMemory:Kr,wasmModule:e0})})};$t.PThread=t1;var cv=Mo=>{for(;0<Mo.length;)Mo.shift()($t)};$t.establishStackSpace=()=>{var Mo=Fy(),Ir=pt()[Mo+52>>>2>>>0];Mo=pt()[Mo+56>>>2>>>0],my(Ir,Ir-Mo),Tv(Ir)};function S1(Mo){if(or)return u1(1,0,Mo);i1(Mo)}var ev=[],c0;$t.invokeEntryPoint=(Mo,Ir)=>{n1=0;var Xr=ev[Mo];Xr||(Mo>=ev.length&&(ev.length=Mo+1),ev[Mo]=Xr=c0.get(Mo)),Mo=Xr(Ir),0<n1?t1.Za(Mo):yv(Mo)};class P0{constructor(Ir){this.Ua=Ir-24}Va(Ir,Xr){pt()[this.Ua+16>>>2>>>0]=0,pt()[this.Ua+4>>>2>>>0]=Ir,pt()[this.Ua+8>>>2>>>0]=Xr}}var R0=0;function B0(Mo,Ir,Xr,In){return or?u1(2,1,Mo,Ir,Xr,In):W0(Mo,Ir,Xr,In)}function W0(Mo,Ir,Xr,In){if(Mo>>>=0,Ir>>>=0,Xr>>>=0,In>>>=0,typeof SharedArrayBuffer>"u")return _n("Current environment does not support SharedArrayBuffer, pthreads are not available!"),6;var Qo=[];return or&&Qo.length===0?B0(Mo,Ir,Xr,In):(Mo={gb:Xr,Na:Mo,cb:In,mb:Qo},or?(Mo.ob="spawnThread",postMessage(Mo,Qo),0):l1(Mo))}var s1=typeof TextDecoder<"u"?new TextDecoder("utf8"):void 0,E1=(Mo,Ir,Xr)=>{Ir>>>=0;var In=Ir+Xr;for(Xr=Ir;Mo[Xr]&&!(Xr>=In);)++Xr;if(16<Xr-Ir&&Mo.buffer&&s1)return s1.decode(Mo.buffer instanceof SharedArrayBuffer?Mo.slice(Ir,Xr):Mo.subarray(Ir,Xr));for(In="";Ir<Xr;){var Qo=Mo[Ir++];if(Qo&128){var s0=Mo[Ir++]&63;if((Qo&224)==192)In+=String.fromCharCode((Qo&31)<<6|s0);else{var x0=Mo[Ir++]&63;Qo=(Qo&240)==224?(Qo&15)<<12|s0<<6|x0:(Qo&7)<<18|s0<<12|x0<<6|Mo[Ir++]&63,65536>Qo?In+=String.fromCharCode(Qo):(Qo-=65536,In+=String.fromCharCode(55296|Qo>>10,56320|Qo&1023))}}else In+=String.fromCharCode(Qo)}return In},Q1=(Mo,Ir)=>(Mo>>>=0)?E1(Tt(),Mo,Ir):"";function K1(Mo,Ir,Xr){return or?u1(3,1,Mo,Ir,Xr):0}function W1(Mo,Ir){if(or)return u1(4,1,Mo,Ir)}var nv=Mo=>{for(var Ir=0,Xr=0;Xr<Mo.length;++Xr){var In=Mo.charCodeAt(Xr);127>=In?Ir++:2047>=In?Ir+=2:55296<=In&&57343>=In?(Ir+=4,++Xr):Ir+=3}return Ir},Nv=(Mo,Ir,Xr,In)=>{if(Xr>>>=0,!(0<In))return 0;var Qo=Xr;In=Xr+In-1;for(var s0=0;s0<Mo.length;++s0){var x0=Mo.charCodeAt(s0);if(55296<=x0&&57343>=x0){var H0=Mo.charCodeAt(++s0);x0=65536+((x0&1023)<<10)|H0&1023}if(127>=x0){if(Xr>=In)break;Ir[Xr++>>>0]=x0}else{if(2047>=x0){if(Xr+1>=In)break;Ir[Xr++>>>0]=192|x0>>6}else{if(65535>=x0){if(Xr+2>=In)break;Ir[Xr++>>>0]=224|x0>>12}else{if(Xr+3>=In)break;Ir[Xr++>>>0]=240|x0>>18,Ir[Xr++>>>0]=128|x0>>12&63}Ir[Xr++>>>0]=128|x0>>6&63}Ir[Xr++>>>0]=128|x0&63}}return Ir[Xr>>>0]=0,Xr-Qo},pv=(Mo,Ir,Xr)=>Nv(Mo,Tt(),Ir,Xr);function j0(Mo,Ir){if(or)return u1(5,1,Mo,Ir)}function N1(Mo,Ir,Xr){if(or)return u1(6,1,Mo,Ir,Xr)}function T0(Mo,Ir,Xr){return or?u1(7,1,Mo,Ir,Xr):0}function c1(Mo,Ir){if(or)return u1(8,1,Mo,Ir)}function O1(Mo,Ir,Xr){if(or)return u1(9,1,Mo,Ir,Xr)}function T1(Mo,Ir,Xr,In){if(or)return u1(10,1,Mo,Ir,Xr,In)}function d1(Mo,Ir,Xr,In){if(or)return u1(11,1,Mo,Ir,Xr,In)}function lv(Mo,Ir,Xr,In){if(or)return u1(12,1,Mo,Ir,Xr,In)}function iv(Mo){if(or)return u1(13,1,Mo)}function dv(Mo,Ir){if(or)return u1(14,1,Mo,Ir)}function uv(Mo,Ir,Xr){if(or)return u1(15,1,Mo,Ir,Xr)}function Rv(Mo){Mo>>>=0,typeof Atomics.nb=="function"&&(Atomics.nb(Ct(),Mo>>>2,Mo).value.then(wv),Mo+=128,Atomics.store(Ct(),Mo>>>2,1))}$t.__emscripten_thread_mailbox_await=Rv;var wv=()=>{var Mo=Fy();if(Mo&&(Rv(Mo),Mo=hy,!Zr))try{if(Mo(),!(0<n1))try{or?yv(Ro):i1(Ro)}catch(Ir){Ir instanceof F0||Ir=="unwind"||qt(1,Ir)}}catch(Ir){Ir instanceof F0||Ir=="unwind"||qt(1,Ir)}};$t.checkMailbox=wv;var Uv=[],_v=Mo=>Mo%4===0&&(Mo%100!==0||Mo%400===0),iy=[0,31,60,91,121,152,182,213,244,274,305,335],Sy=[0,31,59,90,120,151,181,212,243,273,304,334];function Sv(Mo,Ir,Xr,In,Qo,s0,x0,H0){return or?u1(16,1,Mo,Ir,Xr,In,Qo,s0,x0,H0):-52}function Av(Mo,Ir,Xr,In,Qo,s0,x0){if(or)return u1(17,1,Mo,Ir,Xr,In,Qo,s0,x0)}var Qv=[],Ey={},Lv=()=>{if(!Ky){var Mo={USER:"web_user",LOGNAME:"web_user",PATH:"/",PWD:"/",HOME:"/home/web_user",LANG:(typeof navigator=="object"&&navigator.languages&&navigator.languages[0]||"C").replace("-","_")+".UTF-8",_:Ht||"./this.program"},Ir;for(Ir in Ey)Ey[Ir]===void 0?delete Mo[Ir]:Mo[Ir]=Ey[Ir];var Xr=[];for(Ir in Mo)Xr.push(`${Ir}=${Mo[Ir]}`);Ky=Xr}return Ky},Ky;function hv(Mo,Ir){if(or)return u1(18,1,Mo,Ir);Mo>>>=0,Ir>>>=0;var Xr=0;return Lv().forEach((In,Qo)=>{var s0=Ir+Xr;for(Qo=pt()[Mo+4*Qo>>>2>>>0]=s0,s0=0;s0<In.length;++s0)vt()[Qo++>>>0]=In.charCodeAt(s0);vt()[Qo>>>0]=0,Xr+=In.length+1}),0}function Ty(Mo,Ir){if(or)return u1(19,1,Mo,Ir);Mo>>>=0,Ir>>>=0;var Xr=Lv();pt()[Mo>>>2>>>0]=Xr.length;var In=0;return Xr.forEach(Qo=>In+=Qo.length+1),pt()[Ir>>>2>>>0]=In,0}function py(Mo){return or?u1(20,1,Mo):52}function Pv(Mo,Ir,Xr,In){return or?u1(21,1,Mo,Ir,Xr,In):52}function Cy(Mo,Ir,Xr,In,Qo){return or?u1(22,1,Mo,Ir,Xr,In,Qo):70}var mv=[null,[],[]];function Ev(Mo,Ir,Xr,In){if(or)return u1(23,1,Mo,Ir,Xr,In);Ir>>>=0,Xr>>>=0,In>>>=0;for(var Qo=0,s0=0;s0<Xr;s0++){var x0=pt()[Ir>>>2>>>0],H0=pt()[Ir+4>>>2>>>0];Ir+=8;for(var Z0=0;Z0<H0;Z0++){var r1=Tt()[x0+Z0>>>0],e1=mv[Mo];r1===0||r1===10?((Mo===1?No:_n)(E1(e1,0)),e1.length=0):e1.push(r1)}Qo+=H0}return pt()[In>>>2>>>0]=Qo,0}var oy=[31,29,31,30,31,30,31,31,30,31,30,31],Zy=[31,28,31,30,31,30,31,31,30,31,30,31];function Qy(Mo){var Ir=Array(nv(Mo)+1);return Nv(Mo,Ir,0,Ir.length),Ir}var Oy=(Mo,Ir)=>{vt().set(Mo,Ir>>>0)};function d$(Mo,Ir,Xr,In){function Qo(L0,M0,f1){for(L0=typeof L0=="number"?L0.toString():L0||"";L0.length<M0;)L0=f1[0]+L0;return L0}function s0(L0,M0){return Qo(L0,M0,"0")}function x0(L0,M0){function f1(z1){return 0>z1?-1:0<z1?1:0}var p1;return(p1=f1(L0.getFullYear()-M0.getFullYear()))===0&&(p1=f1(L0.getMonth()-M0.getMonth()))===0&&(p1=f1(L0.getDate()-M0.getDate())),p1}function H0(L0){switch(L0.getDay()){case 0:return new Date(L0.getFullYear()-1,11,29);case 1:return L0;case 2:return new Date(L0.getFullYear(),0,3);case 3:return new Date(L0.getFullYear(),0,2);case 4:return new Date(L0.getFullYear(),0,1);case 5:return new Date(L0.getFullYear()-1,11,31);case 6:return new Date(L0.getFullYear()-1,11,30)}}function Z0(L0){var M0=L0.Qa;for(L0=new Date(new Date(L0.Ra+1900,0,1).getTime());0<M0;){var f1=L0.getMonth(),p1=(_v(L0.getFullYear())?oy:Zy)[f1];if(M0>p1-L0.getDate())M0-=p1-L0.getDate()+1,L0.setDate(1),11>f1?L0.setMonth(f1+1):(L0.setMonth(0),L0.setFullYear(L0.getFullYear()+1));else{L0.setDate(L0.getDate()+M0);break}}return f1=new Date(L0.getFullYear()+1,0,4),M0=H0(new Date(L0.getFullYear(),0,4)),f1=H0(f1),0>=x0(M0,L0)?0>=x0(f1,L0)?L0.getFullYear()+1:L0.getFullYear():L0.getFullYear()-1}Mo>>>=0,Ir>>>=0,Xr>>>=0,In>>>=0;var r1=pt()[In+40>>>2>>>0];In={kb:Ct()[In>>>2>>>0],jb:Ct()[In+4>>>2>>>0],Sa:Ct()[In+8>>>2>>>0],Wa:Ct()[In+12>>>2>>>0],Ta:Ct()[In+16>>>2>>>0],Ra:Ct()[In+20>>>2>>>0],Ma:Ct()[In+24>>>2>>>0],Qa:Ct()[In+28>>>2>>>0],qb:Ct()[In+32>>>2>>>0],ib:Ct()[In+36>>>2>>>0],lb:r1?Q1(r1):""},Xr=Q1(Xr),r1={"%c":"%a %b %d %H:%M:%S %Y","%D":"%m/%d/%y","%F":"%Y-%m-%d","%h":"%b","%r":"%I:%M:%S %p","%R":"%H:%M","%T":"%H:%M:%S","%x":"%m/%d/%y","%X":"%H:%M:%S","%Ec":"%c","%EC":"%C","%Ex":"%m/%d/%y","%EX":"%H:%M:%S","%Ey":"%y","%EY":"%Y","%Od":"%d","%Oe":"%e","%OH":"%H","%OI":"%I","%Om":"%m","%OM":"%M","%OS":"%S","%Ou":"%u","%OU":"%U","%OV":"%V","%Ow":"%w","%OW":"%W","%Oy":"%y"};for(var e1 in r1)Xr=Xr.replace(new RegExp(e1,"g"),r1[e1]);var $1="Sunday Monday Tuesday Wednesday Thursday Friday Saturday".split(" "),B1="January February March April May June July August September October November December".split(" ");r1={"%a":L0=>$1[L0.Ma].substring(0,3),"%A":L0=>$1[L0.Ma],"%b":L0=>B1[L0.Ta].substring(0,3),"%B":L0=>B1[L0.Ta],"%C":L0=>s0((L0.Ra+1900)/100|0,2),"%d":L0=>s0(L0.Wa,2),"%e":L0=>Qo(L0.Wa,2," "),"%g":L0=>Z0(L0).toString().substring(2),"%G":Z0,"%H":L0=>s0(L0.Sa,2),"%I":L0=>(L0=L0.Sa,L0==0?L0=12:12<L0&&(L0-=12),s0(L0,2)),"%j":L0=>{for(var M0=0,f1=0;f1<=L0.Ta-1;M0+=(_v(L0.Ra+1900)?oy:Zy)[f1++]);return s0(L0.Wa+M0,3)},"%m":L0=>s0(L0.Ta+1,2),"%M":L0=>s0(L0.jb,2),"%n":()=>`
`,"%p":L0=>0<=L0.Sa&&12>L0.Sa?"AM":"PM","%S":L0=>s0(L0.kb,2),"%t":()=>"	","%u":L0=>L0.Ma||7,"%U":L0=>s0(Math.floor((L0.Qa+7-L0.Ma)/7),2),"%V":L0=>{var M0=Math.floor((L0.Qa+7-(L0.Ma+6)%7)/7);if(2>=(L0.Ma+371-L0.Qa-2)%7&&M0++,M0)M0==53&&(f1=(L0.Ma+371-L0.Qa)%7,f1==4||f1==3&&_v(L0.Ra)||(M0=1));else{M0=52;var f1=(L0.Ma+7-L0.Qa-1)%7;(f1==4||f1==5&&_v(L0.Ra%400-1))&&M0++}return s0(M0,2)},"%w":L0=>L0.Ma,"%W":L0=>s0(Math.floor((L0.Qa+7-(L0.Ma+6)%7)/7),2),"%y":L0=>(L0.Ra+1900).toString().substring(2),"%Y":L0=>L0.Ra+1900,"%z":L0=>{L0=L0.ib;var M0=0<=L0;return L0=Math.abs(L0)/60,(M0?"+":"-")+("0000"+(L0/60*100+L0%60)).slice(-4)},"%Z":L0=>L0.lb,"%%":()=>"%"},Xr=Xr.replace(/%%/g,"\0\0");for(e1 in r1)Xr.includes(e1)&&(Xr=Xr.replace(new RegExp(e1,"g"),r1[e1](In)));return Xr=Xr.replace(/\0\0/g,"%"),e1=Qy(Xr),e1.length>Ir?0:(Oy(e1,Mo),e1.length-1)}t1.Va();var Jy=[P1,S1,B0,K1,W1,j0,N1,T0,c1,O1,T1,d1,lv,iv,dv,uv,Sv,Av,hv,Ty,py,Pv,Cy,Ev],Ay={b:function(Mo,Ir,Xr){throw Mo>>>=0,new P0(Mo).Va(Ir>>>0,Xr>>>0),R0=Mo,R0},L:function(Mo){w1(Mo>>>0,!rr,1,!Kt,131072,!1),t1.$a()},j:function(Mo){Mo>>>=0,or?postMessage({cmd:"cleanupThread",thread:Mo}):t1.Ya(t1.La[Mo])},H:W0,h:K1,S:W1,D:j0,F:N1,T:T0,Q:c1,J:O1,P:T1,n:d1,E:lv,B:iv,R:dv,C:uv,p:()=>1,z:function(Mo,Ir){Mo>>>=0,Mo==Ir>>>0?setTimeout(wv):or?postMessage({targetThread:Mo,cmd:"checkMailbox"}):(Mo=t1.La[Mo])&&Mo.postMessage({cmd:"checkMailbox"})},I:function(Mo,Ir,Xr,In,Qo){Ir>>>=0,Xr>>>=0,Uv.length=In,Qo=Qo>>>0>>>3;for(var s0=0;s0<In;s0++)Uv[s0]=wt()[Qo+s0>>>0];return Mo=Ir?E0[Ir]:Jy[Mo],t1.eb=Xr,Xr=Mo(...Uv),t1.eb=0,Xr},K:Rv,o:function(Mo){ir&&t1.La[Mo>>>0].ref()},s:function(Mo,Ir,Xr){Mo=Ir+2097152>>>0<4194305-!!Mo?(Mo>>>0)+4294967296*Ir:NaN,Xr>>>=0,Mo=new Date(1e3*Mo),Ct()[Xr>>>2>>>0]=Mo.getUTCSeconds(),Ct()[Xr+4>>>2>>>0]=Mo.getUTCMinutes(),Ct()[Xr+8>>>2>>>0]=Mo.getUTCHours(),Ct()[Xr+12>>>2>>>0]=Mo.getUTCDate(),Ct()[Xr+16>>>2>>>0]=Mo.getUTCMonth(),Ct()[Xr+20>>>2>>>0]=Mo.getUTCFullYear()-1900,Ct()[Xr+24>>>2>>>0]=Mo.getUTCDay(),Mo=(Mo.getTime()-Date.UTC(Mo.getUTCFullYear(),0,1,0,0,0,0))/864e5|0,Ct()[Xr+28>>>2>>>0]=Mo},t:function(Mo,Ir,Xr){Mo=Ir+2097152>>>0<4194305-!!Mo?(Mo>>>0)+4294967296*Ir:NaN,Xr>>>=0,Mo=new Date(1e3*Mo),Ct()[Xr>>>2>>>0]=Mo.getSeconds(),Ct()[Xr+4>>>2>>>0]=Mo.getMinutes(),Ct()[Xr+8>>>2>>>0]=Mo.getHours(),Ct()[Xr+12>>>2>>>0]=Mo.getDate(),Ct()[Xr+16>>>2>>>0]=Mo.getMonth(),Ct()[Xr+20>>>2>>>0]=Mo.getFullYear()-1900,Ct()[Xr+24>>>2>>>0]=Mo.getDay(),Ir=(_v(Mo.getFullYear())?iy:Sy)[Mo.getMonth()]+Mo.getDate()-1|0,Ct()[Xr+28>>>2>>>0]=Ir,Ct()[Xr+36>>>2>>>0]=-(60*Mo.getTimezoneOffset()),Ir=new Date(Mo.getFullYear(),6,1).getTimezoneOffset();var In=new Date(Mo.getFullYear(),0,1).getTimezoneOffset();Mo=(Ir!=In&&Mo.getTimezoneOffset()==Math.min(In,Ir))|0,Ct()[Xr+32>>>2>>>0]=Mo},u:function(Mo){Mo>>>=0;var Ir=new Date(Ct()[Mo+20>>>2>>>0]+1900,Ct()[Mo+16>>>2>>>0],Ct()[Mo+12>>>2>>>0],Ct()[Mo+8>>>2>>>0],Ct()[Mo+4>>>2>>>0],Ct()[Mo>>>2>>>0],0),Xr=Ct()[Mo+32>>>2>>>0],In=Ir.getTimezoneOffset(),Qo=new Date(Ir.getFullYear(),6,1).getTimezoneOffset(),s0=new Date(Ir.getFullYear(),0,1).getTimezoneOffset(),x0=Math.min(s0,Qo);return 0>Xr?Ct()[Mo+32>>>2>>>0]=+(Qo!=s0&&x0==In):0<Xr!=(x0==In)&&(Qo=Math.max(s0,Qo),Ir.setTime(Ir.getTime()+6e4*((0<Xr?x0:Qo)-In))),Ct()[Mo+24>>>2>>>0]=Ir.getDay(),Xr=(_v(Ir.getFullYear())?iy:Sy)[Ir.getMonth()]+Ir.getDate()-1|0,Ct()[Mo+28>>>2>>>0]=Xr,Ct()[Mo>>>2>>>0]=Ir.getSeconds(),Ct()[Mo+4>>>2>>>0]=Ir.getMinutes(),Ct()[Mo+8>>>2>>>0]=Ir.getHours(),Ct()[Mo+12>>>2>>>0]=Ir.getDate(),Ct()[Mo+16>>>2>>>0]=Ir.getMonth(),Ct()[Mo+20>>>2>>>0]=Ir.getYear(),Mo=Ir.getTime(),Mo=isNaN(Mo)?-1:Mo/1e3,ay((g0=Mo,1<=+Math.abs(g0)?0<g0?+Math.floor(g0/4294967296)>>>0:~~+Math.ceil((g0-+(~~g0>>>0))/4294967296)>>>0:0)),Mo>>>0},q:Sv,r:Av,y:function(Mo,Ir,Xr,In){Mo>>>=0,Ir>>>=0,Xr>>>=0,In>>>=0;var Qo=new Date().getFullYear(),s0=new Date(Qo,0,1),x0=new Date(Qo,6,1);Qo=s0.getTimezoneOffset();var H0=x0.getTimezoneOffset(),Z0=Math.max(Qo,H0);pt()[Mo>>>2>>>0]=60*Z0,Ct()[Ir>>>2>>>0]=+(Qo!=H0),Mo=r1=>r1.toLocaleTimeString(void 0,{hour12:!1,timeZoneName:"short"}).split(" ")[1],s0=Mo(s0),x0=Mo(x0),H0<Qo?(pv(s0,Xr,17),pv(x0,In,17)):(pv(s0,In,17),pv(x0,Xr,17))},c:()=>{v0("")},O:function(Mo,Ir,Xr){Mo>>>=0,Ir>>>=0,Xr>>>=0,Qv.length=0;for(var In;In=Tt()[Ir++>>>0];){var Qo=In!=105;Qo&=In!=112,Xr+=Qo&&Xr%8?4:0,Qv.push(In==112?pt()[Xr>>>2>>>0]:In==105?Ct()[Xr>>>2>>>0]:wt()[Xr>>>3>>>0]),Xr+=Qo?8:4}return E0[Mo](...Qv)},k:()=>{},i:()=>Date.now(),U:()=>{throw n1+=1,"unwind"},A:function(){return 4294901760},e:()=>performance.timeOrigin+performance.now(),f:()=>ir?(Cp$1(),ar(Lp$1)).cpus().length:navigator.hardwareConcurrency,x:function(Mo){Mo>>>=0;var Ir=Tt().length;if(Mo<=Ir||4294901760<Mo)return!1;for(var Xr=1;4>=Xr;Xr*=2){var In=Ir*(1+.2/Xr);In=Math.min(In,Mo+100663296);var Qo=Math;In=Math.max(Mo,In);e:{Qo=(Qo.min.call(Qo,4294901760,In+(65536-In%65536)%65536)-Kr.buffer.byteLength+65535)/65536;try{Kr.grow(Qo),a0();var s0=1;break e}catch{}s0=void 0}if(s0)return!0}return!1},M:hv,N:Ty,G:i1,g:py,m:Pv,v:Cy,l:Ev,a:Kr||$t.wasmMemory,w:d$,d:function(Mo,Ir,Xr,In){return d$(Mo>>>0,Ir>>>0,Xr>>>0,In>>>0)}},b1=function(){function Mo(Xr,In){return b1=Xr.exports,b1=Dv(),t1.ab.push(b1.ya),c0=b1.za,f0.unshift(b1.V),e0=In,C0(),b1}var Ir={a:Ay};if(b0++,$t.instantiateWasm)try{return $t.instantiateWasm(Ir,Mo)}catch(Xr){_n(`Module.instantiateWasm callback failed with error: ${Xr}`),jt(Xr)}return A0(Ir,function(Xr){Mo(Xr.instance,Xr.module)}).catch(jt),{}}();$t._OrtInit=(Mo,Ir)=>($t._OrtInit=b1.W)(Mo,Ir),$t._OrtGetLastError=(Mo,Ir)=>($t._OrtGetLastError=b1.X)(Mo,Ir),$t._OrtCreateSessionOptions=(Mo,Ir,Xr,In,Qo,s0,x0,H0,Z0,r1)=>($t._OrtCreateSessionOptions=b1.Y)(Mo,Ir,Xr,In,Qo,s0,x0,H0,Z0,r1),$t._OrtAppendExecutionProvider=(Mo,Ir)=>($t._OrtAppendExecutionProvider=b1.Z)(Mo,Ir),$t._OrtAddFreeDimensionOverride=(Mo,Ir,Xr)=>($t._OrtAddFreeDimensionOverride=b1._)(Mo,Ir,Xr),$t._OrtAddSessionConfigEntry=(Mo,Ir,Xr)=>($t._OrtAddSessionConfigEntry=b1.$)(Mo,Ir,Xr),$t._OrtReleaseSessionOptions=Mo=>($t._OrtReleaseSessionOptions=b1.aa)(Mo),$t._OrtCreateSession=(Mo,Ir,Xr)=>($t._OrtCreateSession=b1.ba)(Mo,Ir,Xr),$t._OrtReleaseSession=Mo=>($t._OrtReleaseSession=b1.ca)(Mo),$t._OrtGetInputOutputCount=(Mo,Ir,Xr)=>($t._OrtGetInputOutputCount=b1.da)(Mo,Ir,Xr),$t._OrtGetInputName=(Mo,Ir)=>($t._OrtGetInputName=b1.ea)(Mo,Ir),$t._OrtGetOutputName=(Mo,Ir)=>($t._OrtGetOutputName=b1.fa)(Mo,Ir),$t._OrtFree=Mo=>($t._OrtFree=b1.ga)(Mo),$t._OrtCreateTensor=(Mo,Ir,Xr,In,Qo,s0)=>($t._OrtCreateTensor=b1.ha)(Mo,Ir,Xr,In,Qo,s0),$t._OrtGetTensorData=(Mo,Ir,Xr,In,Qo)=>($t._OrtGetTensorData=b1.ia)(Mo,Ir,Xr,In,Qo),$t._OrtReleaseTensor=Mo=>($t._OrtReleaseTensor=b1.ja)(Mo),$t._OrtCreateRunOptions=(Mo,Ir,Xr,In)=>($t._OrtCreateRunOptions=b1.ka)(Mo,Ir,Xr,In),$t._OrtAddRunConfigEntry=(Mo,Ir,Xr)=>($t._OrtAddRunConfigEntry=b1.la)(Mo,Ir,Xr),$t._OrtReleaseRunOptions=Mo=>($t._OrtReleaseRunOptions=b1.ma)(Mo),$t._OrtCreateBinding=Mo=>($t._OrtCreateBinding=b1.na)(Mo),$t._OrtBindInput=(Mo,Ir,Xr)=>($t._OrtBindInput=b1.oa)(Mo,Ir,Xr),$t._OrtBindOutput=(Mo,Ir,Xr,In)=>($t._OrtBindOutput=b1.pa)(Mo,Ir,Xr,In),$t._OrtClearBoundOutputs=Mo=>($t._OrtClearBoundOutputs=b1.qa)(Mo),$t._OrtReleaseBinding=Mo=>($t._OrtReleaseBinding=b1.ra)(Mo),$t._OrtRunWithBinding=(Mo,Ir,Xr,In,Qo)=>($t._OrtRunWithBinding=b1.sa)(Mo,Ir,Xr,In,Qo),$t._OrtRun=(Mo,Ir,Xr,In,Qo,s0,x0,H0)=>($t._OrtRun=b1.ta)(Mo,Ir,Xr,In,Qo,s0,x0,H0),$t._OrtEndProfiling=Mo=>($t._OrtEndProfiling=b1.ua)(Mo);var Fy=$t._pthread_self=()=>(Fy=$t._pthread_self=b1.va)();$t._malloc=Mo=>($t._malloc=b1.wa)(Mo),$t._free=Mo=>($t._free=b1.xa)(Mo),$t.__emscripten_tls_init=()=>($t.__emscripten_tls_init=b1.ya)();var w1=$t.__emscripten_thread_init=(Mo,Ir,Xr,In,Qo,s0)=>(w1=$t.__emscripten_thread_init=b1.Aa)(Mo,Ir,Xr,In,Qo,s0);$t.__emscripten_thread_crashed=()=>($t.__emscripten_thread_crashed=b1.Ba)();var Py=(Mo,Ir,Xr,In,Qo)=>(Py=b1.Ca)(Mo,Ir,Xr,In,Qo),jv=Mo=>(jv=b1.Da)(Mo),yv=$t.__emscripten_thread_exit=Mo=>(yv=$t.__emscripten_thread_exit=b1.Ea)(Mo),hy=()=>(hy=b1.Fa)(),ay=Mo=>(ay=b1.Ga)(Mo),my=(Mo,Ir)=>(my=b1.Ha)(Mo,Ir),Tv=Mo=>(Tv=b1.Ia)(Mo),ky=Mo=>(ky=b1.Ja)(Mo),kv=()=>(kv=b1.Ka)();function Dv(){var Mo=b1;Mo=Object.assign({},Mo);var Ir=In=>()=>In()>>>0,Xr=In=>Qo=>In(Qo)>>>0;return Mo.va=Ir(Mo.va),Mo.wa=Xr(Mo.wa),Mo.emscripten_main_runtime_thread_id=Ir(Mo.emscripten_main_runtime_thread_id),Mo.Ja=Xr(Mo.Ja),Mo.Ka=Ir(Mo.Ka),Mo}$t.wasmMemory=Kr,$t.stackSave=()=>kv(),$t.stackRestore=Mo=>Tv(Mo),$t.stackAlloc=Mo=>ky(Mo),$t.keepRuntimeAlive=()=>0<n1,$t.UTF8ToString=Q1,$t.stringToUTF8=pv,$t.lengthBytesUTF8=nv,$t.ExitStatus=F0,$t.PThread=t1;var gy;O0=function Mo(){gy||Vv(),gy||(O0=Mo)};function Vv(){if(!(0<b0))if(or)Lt($t),or||cv(f0),startWorker($t);else{if($t.preRun)for(typeof $t.preRun=="function"&&($t.preRun=[$t.preRun]);$t.preRun.length;)d0.unshift($t.preRun.shift());cv(d0),0<b0||gy||(gy=!0,$t.calledRun=!0,Zr||(or||cv(f0),Lt($t),or||cv(y0)))}}return Vv(),Ft}})();typeof d=="object"&&typeof g=="object"?g.exports=b:typeof define=="function"&&define.amd&&define([],()=>b)}),Bp$1=me((d,g)=>{g.exports='"use strict";var Module={},ENVIRONMENT_IS_NODE=typeof process=="object"&&typeof process.versions=="object"&&typeof process.versions.node=="string";if(ENVIRONMENT_IS_NODE){var nodeWorkerThreads=require("worker_threads"),parentPort=nodeWorkerThreads.parentPort;parentPort.on("message",e=>onmessage({data:e}));var fs=require("fs"),vm=require("vm");Object.assign(global,{self:global,require,Module,location:{href:__filename},Worker:nodeWorkerThreads.Worker,importScripts:e=>vm.runInThisContext(fs.readFileSync(e,"utf8"),{filename:e}),postMessage:e=>parentPort.postMessage(e),performance:global.performance||{now:Date.now}})}var initializedJS=!1;function threadPrintErr(...e){var a=e.join(" ");if(ENVIRONMENT_IS_NODE){fs.writeSync(2,a+`\n`);return}console.error(a)}function threadAlert(...e){var a=e.join(" ");postMessage({cmd:"alert",text:a,threadId:Module._pthread_self()})}var err=threadPrintErr;self.alert=threadAlert,Module.instantiateWasm=(e,a)=>{var r=Module.wasmModule;Module.wasmModule=null;var t=new WebAssembly.Instance(r,e);return a(t)},self.onunhandledrejection=e=>{throw e.reason||e};function handleMessage(e){try{if(e.data.cmd==="load"){let r=[];self.onmessage=t=>r.push(t),self.startWorker=t=>{Module=t,postMessage({cmd:"loaded"});for(let s of r)handleMessage(s);self.onmessage=handleMessage},Module.wasmModule=e.data.wasmModule;for(const t of e.data.handlers)Module[t]=(...s)=>{postMessage({cmd:"callHandler",handler:t,args:s})};if(Module.wasmMemory=e.data.wasmMemory,Module.buffer=Module.wasmMemory.buffer,Module.ENVIRONMENT_IS_PTHREAD=!0,typeof e.data.urlOrBlob=="string")importScripts(e.data.urlOrBlob);else{var a=URL.createObjectURL(e.data.urlOrBlob);importScripts(a),URL.revokeObjectURL(a)}ortWasmThreaded(Module)}else if(e.data.cmd==="run"){Module.__emscripten_thread_init(e.data.pthread_ptr,0,0,1),Module.__emscripten_thread_mailbox_await(e.data.pthread_ptr),Module.establishStackSpace(),Module.PThread.receiveObjectTransfer(e.data),Module.PThread.threadInitTLS(),initializedJS||(initializedJS=!0);try{Module.invokeEntryPoint(e.data.start_routine,e.data.arg)}catch(r){if(r!="unwind")throw r}}else e.data.cmd==="cancel"?Module._pthread_self()&&Module.__emscripten_thread_exit(-1):e.data.target==="setimmediate"||(e.data.cmd==="checkMailbox"?initializedJS&&Module.checkMailbox():e.data.cmd&&(err(`worker.js received unknown command ${e.data.cmd}`),err(e.data)))}catch(r){throw Module.__emscripten_thread_crashed?.(),r}}self.onmessage=handleMessage;\n'}),Rp$1,sg,oa$1,ia$1,So$1,Np$1,ug,lg,fg,Mp$1,De$1,Ur=L$1(()=>{Rp$1=Pp$1(),sg=kp$1(),ia$1=!1,So$1=!1,Np$1=!1,ug=d=>{if(d===1)return!1;if(typeof SharedArrayBuffer>"u")return typeof self<"u"&&!self.crossOriginIsolated&&console.warn("env.wasm.numThreads is set to "+d+", but this will not work unless you enable crossOriginIsolated mode. See https://web.dev/cross-origin-isolation-guide/ for more info."),!1;typeof process<"u"&&process.versions&&process.versions.node&&console.warn("env.wasm.numThreads is set to "+d+", however, currently onnxruntime-web does not support multi-threads in Node.js. Please consider using onnxruntime-node for performance critical scenarios.");try{return typeof MessageChannel<"u"&&new MessageChannel().port1.postMessage(new SharedArrayBuffer(1)),WebAssembly.validate(new Uint8Array([0,97,115,109,1,0,0,0,1,4,1,96,0,0,3,2,1,0,5,4,1,3,1,1,10,11,1,9,0,65,0,254,16,2,0,26,11]))}catch{return!1}},lg=()=>{try{return WebAssembly.validate(new Uint8Array([0,97,115,109,1,0,0,0,1,4,1,96,0,0,3,2,1,0,10,30,1,28,0,65,0,253,15,253,12,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,253,186,1,26,11]))}catch{return!1}},fg=(d,g)=>d?g?"ort-wasm-simd-threaded.wasm":"ort-wasm-simd.wasm":g?"ort-wasm-threaded.wasm":"ort-wasm.wasm",Mp$1=async d=>{if(ia$1)return Promise.resolve();if(So$1)throw new Error("multiple calls to 'initializeWebAssembly()' detected.");if(Np$1)throw new Error("previous call to 'initializeWebAssembly()' failed.");So$1=!0;let g=d.initTimeout,b=d.numThreads,et=d.simd,st=ug(b),at=et&&lg(),vt=d.wasmPaths,Tt=typeof vt=="string"?vt:void 0,Ct=fg(at,st),pt=typeof vt=="object"?vt[Ct]:void 0,wt=!1,$t=[];if(g>0&&$t.push(new Promise(Lt=>{setTimeout(()=>{wt=!0,Lt()},g)})),$t.push(new Promise((Lt,jt)=>{let Ft=st?sg:Rp$1,Gt={locateFile:(Ht,qt)=>st&&Ht.endsWith(".worker.js")&&typeof Blob<"u"?URL.createObjectURL(new Blob([Bp$1()],{type:"text/javascript"})):Ht.endsWith(".wasm")?pt||(Tt??qt)+Ct:qt+Ht};if(st)if(Gt.numThreads=b,typeof Blob>"u")Gt.mainScriptUrlOrBlob=(void 0)(__dirname,"ort-wasm-threaded.js");else{let Ht=`var ortWasmThreaded=${Ft.toString()};`;Gt.mainScriptUrlOrBlob=new Blob([Ht],{type:"text/javascript"})}Ft(Gt).then(Ht=>{So$1=!1,ia$1=!0,oa$1=Ht,Lt()},Ht=>{So$1=!1,Np$1=!0,jt(Ht)})})),await Promise.race($t),wt)throw new Error(`WebAssembly backend initializing failed due to timeout: ${g}ms`)},De$1=()=>{if(ia$1&&oa$1)return oa$1;throw new Error("WebAssembly is not initialized yet.")}}),ve,bn,_e$1,Ao=L$1(()=>{Ur(),ve=(d,g)=>{let b=De$1(),et=b.lengthBytesUTF8(d)+1,st=b._malloc(et);return b.stringToUTF8(d,st,et),g.push(st),st},bn=(d,g,b,et)=>{if(typeof d=="object"&&d!==null){if(b.has(d))throw new Error("Circular reference in options");b.add(d)}Object.entries(d).forEach(([st,at])=>{let vt=g?g+st:st;if(typeof at=="object")bn(at,vt+".",b,et);else if(typeof at=="string"||typeof at=="number")et(vt,at.toString());else if(typeof at=="boolean")et(vt,at?"1":"0");else throw new Error(`Can't handle extra config type: ${typeof at}`)})},_e$1=d=>{let g=De$1(),b=g.stackSave();try{let et=g.stackAlloc(8);g._OrtGetLastError(et,et+4);let st=g.HEAP32[et/4],at=g.HEAPU32[et/4+1],vt=at?g.UTF8ToString(at):"";throw new Error(`${d} ERROR_CODE: ${st}, ERROR_MESSAGE: ${vt}`)}finally{g.stackRestore(b)}}}),Gp$1,Up$1=L$1(()=>{Ur(),Ao(),Gp$1=d=>{let g=De$1(),b=0,et=[],st=d||{};try{if((d==null?void 0:d.logSeverityLevel)===void 0)st.logSeverityLevel=2;else if(typeof d.logSeverityLevel!="number"||!Number.isInteger(d.logSeverityLevel)||d.logSeverityLevel<0||d.logSeverityLevel>4)throw new Error(`log serverity level is not valid: ${d.logSeverityLevel}`);if((d==null?void 0:d.logVerbosityLevel)===void 0)st.logVerbosityLevel=0;else if(typeof d.logVerbosityLevel!="number"||!Number.isInteger(d.logVerbosityLevel))throw new Error(`log verbosity level is not valid: ${d.logVerbosityLevel}`);(d==null?void 0:d.terminate)===void 0&&(st.terminate=!1);let at=0;return(d==null?void 0:d.tag)!==void 0&&(at=ve(d.tag,et)),b=g._OrtCreateRunOptions(st.logSeverityLevel,st.logVerbosityLevel,!!st.terminate,at),b===0&&_e$1("Can't create run options."),(d==null?void 0:d.extra)!==void 0&&bn(d.extra,"",new WeakSet,(vt,Tt)=>{let Ct=ve(vt,et),pt=ve(Tt,et);g._OrtAddRunConfigEntry(b,Ct,pt)!==0&&_e$1(`Can't set a run config entry: ${vt} - ${Tt}.`)}),[b,et]}catch(at){throw b!==0&&g._OrtReleaseRunOptions(b),et.forEach(vt=>g._free(vt)),at}}}),cg,pg,dg,hg,zp$1,Vp$1=L$1(()=>{Ur(),Ao(),cg=d=>{switch(d){case"disabled":return 0;case"basic":return 1;case"extended":return 2;case"all":return 99;default:throw new Error(`unsupported graph optimization level: ${d}`)}},pg=d=>{switch(d){case"sequential":return 0;case"parallel":return 1;default:throw new Error(`unsupported execution mode: ${d}`)}},dg=d=>{d.extra||(d.extra={}),d.extra.session||(d.extra.session={});let g=d.extra.session;g.use_ort_model_bytes_directly||(g.use_ort_model_bytes_directly="1"),d.executionProviders&&d.executionProviders.some(b=>(typeof b=="string"?b:b.name)==="webgpu")&&(d.enableMemPattern=!1)},hg=(d,g,b)=>{for(let et of g){let st=typeof et=="string"?et:et.name;switch(st){case"webnn":if(st="WEBNN",typeof et!="string"){let vt=et;if(vt!=null&&vt.deviceType){let Tt=ve("deviceType",b),Ct=ve(vt.deviceType,b);De$1()._OrtAddSessionConfigEntry(d,Tt,Ct)!==0&&_e$1(`Can't set a session config entry: 'deviceType' - ${vt.deviceType}.`)}if(vt!=null&&vt.numThreads){let Tt=vt.numThreads;(typeof Tt!="number"||!Number.isInteger(Tt)||Tt<0)&&(Tt=0);let Ct=ve("numThreads",b),pt=ve(Tt.toString(),b);De$1()._OrtAddSessionConfigEntry(d,Ct,pt)!==0&&_e$1(`Can't set a session config entry: 'numThreads' - ${vt.numThreads}.`)}if(vt!=null&&vt.powerPreference){let Tt=ve("powerPreference",b),Ct=ve(vt.powerPreference,b);De$1()._OrtAddSessionConfigEntry(d,Tt,Ct)!==0&&_e$1(`Can't set a session config entry: 'powerPreference' - ${vt.powerPreference}.`)}}break;case"webgpu":if(st="JS",typeof et!="string"){let vt=et;if(vt!=null&&vt.preferredLayout){if(vt.preferredLayout!=="NCHW"&&vt.preferredLayout!=="NHWC")throw new Error(`preferredLayout must be either 'NCHW' or 'NHWC': ${vt.preferredLayout}`);let Tt=ve("preferredLayout",b),Ct=ve(vt.preferredLayout,b);De$1()._OrtAddSessionConfigEntry(d,Tt,Ct)!==0&&_e$1(`Can't set a session config entry: 'preferredLayout' - ${vt.preferredLayout}.`)}}break;case"wasm":case"cpu":continue;default:throw new Error(`not supported execution provider: ${st}`)}let at=ve(st,b);De$1()._OrtAppendExecutionProvider(d,at)!==0&&_e$1(`Can't append execution provider: ${st}.`)}},zp$1=d=>{let g=De$1(),b=0,et=[],st=d||{};dg(st);try{let at=cg(st.graphOptimizationLevel??"all"),vt=pg(st.executionMode??"sequential"),Tt=typeof st.logId=="string"?ve(st.logId,et):0,Ct=st.logSeverityLevel??2;if(!Number.isInteger(Ct)||Ct<0||Ct>4)throw new Error(`log serverity level is not valid: ${Ct}`);let pt=st.logVerbosityLevel??0;if(!Number.isInteger(pt)||pt<0||pt>4)throw new Error(`log verbosity level is not valid: ${pt}`);let wt=typeof st.optimizedModelFilePath=="string"?ve(st.optimizedModelFilePath,et):0;if(b=g._OrtCreateSessionOptions(at,!!st.enableCpuMemArena,!!st.enableMemPattern,vt,!!st.enableProfiling,0,Tt,Ct,pt,wt),b===0&&_e$1("Can't create session options."),st.executionProviders&&hg(b,st.executionProviders,et),st.enableGraphCapture!==void 0){if(typeof st.enableGraphCapture!="boolean")throw new Error(`enableGraphCapture must be a boolean value: ${st.enableGraphCapture}`);let $t=ve("enableGraphCapture",et),Lt=ve(st.enableGraphCapture.toString(),et);g._OrtAddSessionConfigEntry(b,$t,Lt)!==0&&_e$1(`Can't set a session config entry: 'enableGraphCapture' - ${st.enableGraphCapture}.`)}if(st.freeDimensionOverrides)for(let[$t,Lt]of Object.entries(st.freeDimensionOverrides)){if(typeof $t!="string")throw new Error(`free dimension override name must be a string: ${$t}`);if(typeof Lt!="number"||!Number.isInteger(Lt)||Lt<0)throw new Error(`free dimension override value must be a non-negative integer: ${Lt}`);let jt=ve($t,et);g._OrtAddFreeDimensionOverride(b,jt,Lt)!==0&&_e$1(`Can't set a free dimension override: ${$t} - ${Lt}.`)}return st.extra!==void 0&&bn(st.extra,"",new WeakSet,($t,Lt)=>{let jt=ve($t,et),Ft=ve(Lt,et);g._OrtAddSessionConfigEntry(b,jt,Ft)!==0&&_e$1(`Can't set a session config entry: ${$t} - ${Lt}.`)}),[b,et]}catch(at){throw b!==0&&g._OrtReleaseSessionOptions(b),et.forEach(vt=>g._free(vt)),at}}}),aa$1,Wp$1,sa$1,Hp$1,qp$1,Po,jp$1,ua$1=L$1(()=>{aa$1=d=>{switch(d){case"int8":return 3;case"uint8":return 2;case"bool":return 9;case"int16":return 5;case"uint16":return 4;case"int32":return 6;case"uint32":return 12;case"float16":return 10;case"float32":return 1;case"float64":return 11;case"string":return 8;case"int64":return 7;case"uint64":return 13;default:throw new Error(`unsupported data type: ${d}`)}},Wp$1=d=>{switch(d){case 3:return"int8";case 2:return"uint8";case 9:return"bool";case 5:return"int16";case 4:return"uint16";case 6:return"int32";case 12:return"uint32";case 10:return"float16";case 1:return"float32";case 11:return"float64";case 8:return"string";case 7:return"int64";case 13:return"uint64";default:throw new Error(`unsupported data type: ${d}`)}},sa$1=d=>[void 0,4,1,1,2,2,4,8,void 0,1,2,8,4,8,void 0,void 0,void 0][d],Hp$1=d=>{switch(d){case"float16":return typeof Float16Array<"u"&&Float16Array.from?Float16Array:Uint16Array;case"float32":return Float32Array;case"uint8":return Uint8Array;case"int8":return Int8Array;case"uint16":return Uint16Array;case"int16":return Int16Array;case"int32":return Int32Array;case"bool":return Uint8Array;case"float64":return Float64Array;case"uint32":return Uint32Array;case"int64":return BigInt64Array;case"uint64":return BigUint64Array;default:throw new Error(`unsupported type: ${d}`)}},qp$1=d=>{switch(d){case"verbose":return 0;case"info":return 1;case"warning":return 2;case"error":return 3;case"fatal":return 4;default:throw new Error(`unsupported logging level: ${d}`)}},Po=d=>d==="float32"||d==="float16"||d==="int32"||d==="int64"||d==="uint32"||d==="uint8"||d==="bool",jp$1=d=>{switch(d){case"none":return 0;case"cpu":return 1;case"cpu-pinned":return 2;case"texture":return 3;case"gpu-buffer":return 4;default:throw new Error(`unsupported data location: ${d}`)}}}),gn,la$1=L$1(()=>{gn=async d=>{if(typeof d=="string")if(typeof process<"u"&&process.versions&&process.versions.node)try{return new Uint8Array(await(void 0)(d))}catch(g){if(g.code==="ERR_FS_FILE_TOO_LARGE"){let b=(void 0)(d),et=[];for await(let st of b)et.push(st);return new Uint8Array(Buffer.concat(et))}throw g}else{let g=await fetch(d);if(!g.ok)throw new Error(`failed to load external data file: ${d}`);let b=g.headers.get("Content-Length"),et=b?parseInt(b,10):0;if(et<1073741824)return new Uint8Array(await g.arrayBuffer());{if(!g.body)throw new Error(`failed to load external data file: ${d}, no response body.`);let st=g.body.getReader(),at;try{at=new ArrayBuffer(et)}catch(Tt){if(Tt instanceof RangeError){let Ct=Math.ceil(et/65536);at=new WebAssembly.Memory({initial:Ct,maximum:Ct}).buffer}else throw Tt}let vt=0;for(;;){let{done:Tt,value:Ct}=await st.read();if(Tt)break;let pt=Ct.byteLength;new Uint8Array(at,vt,pt).set(Ct),vt+=pt}return new Uint8Array(at,0,et)}}else return d instanceof Blob?new Uint8Array(await d.arrayBuffer()):d instanceof Uint8Array?d:new Uint8Array(d)}}),mg,Xp$1,Kp$1,zr$1,bg,fa$1,Jp$1,Zp$1,Yp$1,Qp$1,ed$1,td$1,rd$1=L$1(()=>{Up$1(),Vp$1(),ua$1(),Ur(),Ao(),la$1(),mg=(d,g)=>{De$1()._OrtInit(d,g)!==0&&_e$1("Can't initialize onnxruntime.")},Xp$1=async d=>{mg(d.wasm.numThreads,qp$1(d.logLevel))},Kp$1=async(d,g)=>{},zr$1=new Map,bg=d=>{let g=De$1(),b=g.stackSave();try{let et=g.stackAlloc(8);return g._OrtGetInputOutputCount(d,et,et+4)!==0&&_e$1("Can't get session input/output count."),[g.HEAP32[et/4],g.HEAP32[et/4+1]]}finally{g.stackRestore(b)}},fa$1=d=>{let g=De$1(),b=g._malloc(d.byteLength);if(b===0)throw new Error(`Can't create a session. failed to allocate a buffer of size ${d.byteLength}.`);return g.HEAPU8.set(d,b),[b,d.byteLength]},Jp$1=async(d,g)=>{var wt;let b,et,st=De$1();Array.isArray(d)?[b,et]=d:d.buffer===st.HEAPU8.buffer?[b,et]=[d.byteOffset,d.byteLength]:[b,et]=fa$1(d);let at=0,vt=0,Tt=[],Ct=[],pt=[];try{if([vt,Tt]=zp$1(g),(g==null?void 0:g.externalData)&&st.mountExternalData){let Kt=[];for(let rr of g.externalData){let ir=typeof rr=="string"?rr:rr.path;Kt.push(gn(typeof rr=="string"?rr:rr.data).then(or=>{st.mountExternalData(ir,or)}))}await Promise.all(Kt)}at=await st._OrtCreateSession(b,et,vt),at===0&&_e$1("Can't create a session.");let[$t,Lt]=bg(at),jt=!!(g!=null&&g.enableGraphCapture),Ft=[],Gt=[],Ht=[];for(let Kt=0;Kt<$t;Kt++){let rr=st._OrtGetInputName(at,Kt);rr===0&&_e$1("Can't get an input name."),Ct.push(rr),Ft.push(st.UTF8ToString(rr))}for(let Kt=0;Kt<Lt;Kt++){let rr=st._OrtGetOutputName(at,Kt);rr===0&&_e$1("Can't get an output name."),pt.push(rr);let ir=st.UTF8ToString(rr);Gt.push(ir)}return zr$1.set(at,[at,Ct,pt,null,jt,!1]),[at,Ft,Gt]}catch($t){throw Ct.forEach(Lt=>st._OrtFree(Lt)),pt.forEach(Lt=>st._OrtFree(Lt)),at!==0&&st._OrtReleaseSession(at),$t}finally{st._free(b),vt!==0&&st._OrtReleaseSessionOptions(vt),Tt.forEach($t=>st._free($t)),(wt=st.unmountExternalData)==null||wt.call(st)}},Zp$1=d=>{var Ct;let g=De$1(),b=zr$1.get(d);if(!b)throw new Error(`cannot release session. invalid session id: ${d}`);let[et,st,at,vt,Tt]=b;vt&&(Tt&&g._OrtClearBoundOutputs(vt.handle),g._OrtReleaseBinding(vt.handle)),(Ct=g.jsepOnReleaseSession)==null||Ct.call(g,d),st.forEach(pt=>g._OrtFree(pt)),at.forEach(pt=>g._OrtFree(pt)),g._OrtReleaseSession(et),zr$1.delete(d)},Yp$1=(d,g,b,et,st,at=!1)=>{if(!d){g.push(0);return}let vt=De$1(),Tt=d[0],Ct=d[1],pt=d[3],wt,$t;if(Tt==="string"&&pt==="gpu-buffer")throw new Error("String tensor is not supported on GPU.");if(at&&pt!=="gpu-buffer")throw new Error(`External buffer must be provided for input/output index ${st} when enableGraphCapture is true.`);if(pt==="gpu-buffer"){let Ft=d[2].gpuBuffer,Gt=sa$1(aa$1(Tt));$t=Ct.reduce((qt,Kt)=>qt*Kt,1)*Gt;let Ht=vt.jsepRegisterBuffer;if(!Ht)throw new Error('Tensor location "gpu-buffer" is not supported without using WebGPU.');wt=Ht(et,st,Ft,$t)}else{let Ft=d[2];if(Array.isArray(Ft)){$t=4*Ft.length,wt=vt._malloc($t),b.push(wt);let Gt=wt/4;for(let Ht=0;Ht<Ft.length;Ht++){if(typeof Ft[Ht]!="string")throw new TypeError(`tensor data at index ${Ht} is not a string`);vt.HEAPU32[Gt++]=ve(Ft[Ht],b)}}else $t=Ft.byteLength,wt=vt._malloc($t),b.push(wt),vt.HEAPU8.set(new Uint8Array(Ft.buffer,Ft.byteOffset,$t),wt)}let Lt=vt.stackSave(),jt=vt.stackAlloc(4*Ct.length);try{let Ft=jt/4;Ct.forEach(Ht=>vt.HEAP32[Ft++]=Ht);let Gt=vt._OrtCreateTensor(aa$1(Tt),wt,$t,jt,Ct.length,jp$1(pt));Gt===0&&_e$1(`Can't create tensor for input/output. session=${et}, index=${st}.`),g.push(Gt)}finally{vt.stackRestore(Lt)}},Qp$1=async(d,g,b,et,st,at)=>{var vn;let vt=De$1(),Tt=zr$1.get(d);if(!Tt)throw new Error(`cannot run inference. invalid session id: ${d}`);let Ct=Tt[0],pt=Tt[1],wt=Tt[2],$t=Tt[3],Lt=Tt[4];Tt[5];let jt=g.length,Ft=et.length,Gt=0,Ht=[],qt=[],Kt=[],rr=[],ir=vt.stackSave(),or=vt.stackAlloc(jt*4),jr=vt.stackAlloc(jt*4),qr=vt.stackAlloc(Ft*4),Yr=vt.stackAlloc(Ft*4);try{[Gt,Ht]=Gp$1(at);for(let _n=0;_n<jt;_n++)Yp$1(b[_n],qt,rr,d,g[_n],Lt);for(let _n=0;_n<Ft;_n++)Yp$1(st[_n],Kt,rr,d,jt+et[_n],Lt);let ko=or/4,Xo=jr/4,zo=qr/4,t0=Yr/4;for(let _n=0;_n<jt;_n++)vt.HEAPU32[ko++]=qt[_n],vt.HEAPU32[Xo++]=pt[g[_n]];for(let _n=0;_n<Ft;_n++)vt.HEAPU32[zo++]=Kt[_n],vt.HEAPU32[t0++]=wt[et[_n]];(vn=vt.jsepOnRunStart)==null||vn.call(vt,Ct);let Uo;Uo=await vt._OrtRun(Ct,jr,or,jt,Yr,Ft,qr,Gt),Uo!==0&&_e$1("failed to call OrtRun().");let No=[];for(let _n=0;_n<Ft;_n++){let Kr=vt.HEAPU32[qr/4+_n];if(Kr===Kt[_n]){No.push(st[_n]);continue}let e0=vt.stackSave(),Zr=vt.stackAlloc(4*4),Ro=!1,Sn,Tn=0;try{vt._OrtGetTensorData(Kr,Zr,Zr+4,Zr+8,Zr+12)!==0&&_e$1(`Can't access output tensor data on index ${_n}.`);let n0=Zr/4,Go=vt.HEAPU32[n0++];Tn=vt.HEAPU32[n0++];let An=vt.HEAPU32[n0++],a0=vt.HEAPU32[n0++],u0=[];for(let y0=0;y0<a0;y0++)u0.push(vt.HEAPU32[An/4+y0]);vt._OrtFree(An);let d0=u0.reduce((y0,b0)=>y0*b0,1);Sn=Wp$1(Go);let f0=$t==null?void 0:$t.outputPreferredLocations[et[_n]];if(Sn==="string"){if(f0==="gpu-buffer")throw new Error("String tensor is not supported on GPU.");let y0=[],b0=Tn/4;for(let O0=0;O0<d0;O0++){let C0=vt.HEAPU32[b0++],v0=O0===d0-1?void 0:vt.HEAPU32[b0]-C0;y0.push(vt.UTF8ToString(C0,v0))}No.push([Sn,u0,y0,"cpu"])}else if(f0==="gpu-buffer"&&d0>0){let y0=vt.jsepGetBuffer;if(!y0)throw new Error('preferredLocation "gpu-buffer" is not supported without using WebGPU.');let b0=y0(Tn),O0=sa$1(Go);if(O0===void 0||!Po(Sn))throw new Error(`Unsupported data type: ${Sn}`);Ro=!0,No.push([Sn,u0,{gpuBuffer:b0,download:vt.jsepCreateDownloader(b0,d0*O0,Sn),dispose:()=>{vt._OrtReleaseTensor(Kr)}},"gpu-buffer"])}else{let y0=Hp$1(Sn),b0=new y0(d0);new Uint8Array(b0.buffer,b0.byteOffset,b0.byteLength).set(vt.HEAPU8.subarray(Tn,Tn+b0.byteLength)),No.push([Sn,u0,b0,"cpu"])}}finally{vt.stackRestore(e0),Sn==="string"&&Tn&&vt._free(Tn),Ro||vt._OrtReleaseTensor(Kr)}}return $t&&!Lt&&(vt._OrtClearBoundOutputs($t.handle),zr$1.set(d,[Ct,pt,wt,$t,Lt,!1])),No}finally{vt.stackRestore(ir),qt.forEach(ko=>vt._OrtReleaseTensor(ko)),Kt.forEach(ko=>vt._OrtReleaseTensor(ko)),rr.forEach(ko=>vt._free(ko)),Gt!==0&&vt._OrtReleaseRunOptions(Gt),Ht.forEach(ko=>vt._free(ko))}},ed$1=d=>{let g=De$1(),b=zr$1.get(d);if(!b)throw new Error("invalid session id");let et=b[0],st=g._OrtEndProfiling(et);st===0&&_e$1("Can't get an profile file name."),g._OrtFree(st)},td$1=d=>{let g=[];for(let b of d){let et=b[2];!Array.isArray(et)&&"buffer"in et&&g.push(et.buffer)}return g}}),nd$1=me((d,g)=>{g.exports='/*!\n * ONNX Runtime Web v1.18.0\n * Copyright (c) Microsoft Corporation. All rights reserved.\n * Licensed under the MIT License.\n */\n"use strict";(()=>{var vt=Object.defineProperty;var qr=Object.getOwnPropertyDescriptor;var Vr=Object.getOwnPropertyNames;var Jr=Object.prototype.hasOwnProperty;var _t=(i,c)=>()=>(i&&(c=i(i=0)),c);var Ke=(i,c)=>()=>(c||i((c={exports:{}}).exports,c),c.exports),Et=(i,c)=>{for(var a in c)vt(i,a,{get:c[a],enumerable:!0})},Xr=(i,c,a,h)=>{if(c&&typeof c=="object"||typeof c=="function")for(let f of Vr(c))!Jr.call(i,f)&&f!==a&&vt(i,f,{get:()=>c[f],enumerable:!(h=qr(c,f))||h.enumerable});return i};var et=i=>Xr(vt({},"__esModule",{value:!0}),i);var St={};Et(St,{createReadStream:()=>lr,readFile:()=>Qr,readFileSync:()=>Zr});var Qr,Zr,lr,At=_t(()=>{Qr=void 0,Zr=void 0,lr=void 0});var Tt={};Et(Tt,{join:()=>Kr});var Kr,Mt=_t(()=>{Kr=void 0});var pr=Ke((dr,Ct)=>{"use strict";var cr=(()=>{var i=typeof document<"u"?document.currentScript?.src:void 0;return typeof __filename<"u"&&(i||=__filename),function(c={}){var a=c,h,f,w=new Promise((t,o)=>{h=t,f=o}),g=Object.assign({},a),s="./this.program",S=typeof window=="object",x=typeof importScripts=="function",H=typeof process=="object"&&typeof process.versions=="object"&&typeof process.versions.node=="string",A="",I,V,R;if(H){var B=(At(),et(St)),D=(Mt(),et(Tt));A=x?D.dirname(A)+"/":__dirname+"/",I=(t,o)=>(t=ce(t)?new URL(t):D.normalize(t),B.readFileSync(t,o?void 0:"utf8")),R=t=>(t=I(t,!0),t.buffer||(t=new Uint8Array(t)),t),V=(t,o,u,m=!0)=>{t=ce(t)?new URL(t):D.normalize(t),B.readFile(t,m?void 0:"utf8",(O,E)=>{O?u(O):o(m?E.buffer:E)})},!a.thisProgram&&1<process.argv.length&&(s=process.argv[1].replace(/\\\\/g,"/")),process.argv.slice(2)}else(S||x)&&(x?A=self.location.href:typeof document<"u"&&document.currentScript&&(A=document.currentScript.src),i&&(A=i),A.startsWith("blob:")?A="":A=A.substr(0,A.replace(/[?#].*/,"").lastIndexOf("/")+1),I=t=>{var o=new XMLHttpRequest;return o.open("GET",t,!1),o.send(null),o.responseText},x&&(R=t=>{var o=new XMLHttpRequest;return o.open("GET",t,!1),o.responseType="arraybuffer",o.send(null),new Uint8Array(o.response)}),V=(t,o,u)=>{var m=new XMLHttpRequest;m.open("GET",t,!0),m.responseType="arraybuffer",m.onload=()=>{m.status==200||m.status==0&&m.response?o(m.response):u()},m.onerror=u,m.send(null)});var T=console.log.bind(console),L=console.error.bind(console);Object.assign(a,g),g=null;var W,de=!1,pe,Z,_,J,Pe;function le(){var t=W.buffer;a.HEAP8=pe=new Int8Array(t),a.HEAP16=new Int16Array(t),a.HEAPU8=Z=new Uint8Array(t),a.HEAPU16=new Uint16Array(t),a.HEAP32=_=new Int32Array(t),a.HEAPU32=J=new Uint32Array(t),a.HEAPF32=new Float32Array(t),a.HEAPF64=Pe=new Float64Array(t)}var Ie=[],ne=[],X=[],we=0,me=null,F=null;function ie(t){throw t="Aborted("+t+")",L(t),de=!0,t=new WebAssembly.RuntimeError(t+". Build with -sASSERTIONS for more info."),f(t),t}var xe=t=>t.startsWith("data:application/octet-stream;base64,"),ce=t=>t.startsWith("file://"),be;if(be="ort-wasm.wasm",!xe(be)){var ae=be;be=a.locateFile?a.locateFile(ae,A):A+ae}function K(t){if(R)return R(t);throw"both async and sync fetching of the wasm failed"}function je(t){if(S||x){if(typeof fetch=="function"&&!ce(t))return fetch(t,{credentials:"same-origin"}).then(o=>{if(!o.ok)throw`failed to load wasm binary file at \'${t}\'`;return o.arrayBuffer()}).catch(()=>K(t));if(V)return new Promise((o,u)=>{V(t,m=>o(new Uint8Array(m)),u)})}return Promise.resolve().then(()=>K(t))}function Oe(t,o,u){return je(t).then(m=>WebAssembly.instantiate(m,o)).then(u,m=>{L(`failed to asynchronously prepare wasm: ${m}`),ie(m)})}function Ue(t,o){var u=be;return typeof WebAssembly.instantiateStreaming!="function"||xe(u)||ce(u)||H||typeof fetch!="function"?Oe(u,t,o):fetch(u,{credentials:"same-origin"}).then(m=>WebAssembly.instantiateStreaming(m,t).then(o,function(O){return L(`wasm streaming compile failed: ${O}`),L("falling back to ArrayBuffer instantiation"),Oe(u,t,o)}))}var ve,Ae={798088:(t,o,u,m)=>{if(typeof a>"u"||!a.ya)return 1;if(t=ue(t>>>0),t.startsWith("./")&&(t=t.substring(2)),t=a.ya.get(t),!t)return 2;if(o>>>=0,u>>>=0,o+u>t.byteLength)return 3;try{return Z.set(t.subarray(o,o+u),m>>>0>>>0),0}catch{return 4}}};class _e{constructor(o){this.wa=o-24}}var ge=0,Be=0,te=typeof TextDecoder<"u"?new TextDecoder("utf8"):void 0,re=(t,o,u)=>{o>>>=0;var m=o+u;for(u=o;t[u]&&!(u>=m);)++u;if(16<u-o&&t.buffer&&te)return te.decode(t.subarray(o,u));for(m="";o<u;){var O=t[o++];if(O&128){var E=t[o++]&63;if((O&224)==192)m+=String.fromCharCode((O&31)<<6|E);else{var U=t[o++]&63;O=(O&240)==224?(O&15)<<12|E<<6|U:(O&7)<<18|E<<12|U<<6|t[o++]&63,65536>O?m+=String.fromCharCode(O):(O-=65536,m+=String.fromCharCode(55296|O>>10,56320|O&1023))}}else m+=String.fromCharCode(O)}return m},ue=(t,o)=>(t>>>=0)?re(Z,t,o):"",Ee=t=>{for(var o=0,u=0;u<t.length;++u){var m=t.charCodeAt(u);127>=m?o++:2047>=m?o+=2:55296<=m&&57343>=m?(o+=4,++u):o+=3}return o},Se=(t,o,u,m)=>{if(u>>>=0,!(0<m))return 0;var O=u;m=u+m-1;for(var E=0;E<t.length;++E){var U=t.charCodeAt(E);if(55296<=U&&57343>=U){var ee=t.charCodeAt(++E);U=65536+((U&1023)<<10)|ee&1023}if(127>=U){if(u>=m)break;o[u++>>>0]=U}else{if(2047>=U){if(u+1>=m)break;o[u++>>>0]=192|U>>6}else{if(65535>=U){if(u+2>=m)break;o[u++>>>0]=224|U>>12}else{if(u+3>=m)break;o[u++>>>0]=240|U>>18,o[u++>>>0]=128|U>>12&63}o[u++>>>0]=128|U>>6&63}o[u++>>>0]=128|U&63}}return o[u>>>0]=0,u-O},Le=t=>t%4===0&&(t%100!==0||t%400===0),ze=[0,31,60,91,121,152,182,213,244,274,305,335],rt=[0,31,59,90,120,151,181,212,243,273,304,334],Te=[],Ge={},ke=()=>{if(!We){var t={USER:"web_user",LOGNAME:"web_user",PATH:"/",PWD:"/",HOME:"/home/web_user",LANG:(typeof navigator=="object"&&navigator.languages&&navigator.languages[0]||"C").replace("-","_")+".UTF-8",_:s||"./this.program"},o;for(o in Ge)Ge[o]===void 0?delete t[o]:t[o]=Ge[o];var u=[];for(o in t)u.push(`${o}=${t[o]}`);We=u}return We},We,nt=[null,[],[]],De=[31,29,31,30,31,30,31,31,30,31,30,31],at=[31,28,31,30,31,30,31,31,30,31,30,31];function G(t){var o=Array(Ee(t)+1);return Se(t,o,0,o.length),o}function qe(t,o,u,m){function O(d,k,$){for(d=typeof d=="number"?d.toString():d||"";d.length<k;)d=$[0]+d;return d}function E(d,k){return O(d,k,"0")}function U(d,k){function $(Ze){return 0>Ze?-1:0<Ze?1:0}var Me;return(Me=$(d.getFullYear()-k.getFullYear()))===0&&(Me=$(d.getMonth()-k.getMonth()))===0&&(Me=$(d.getDate()-k.getDate())),Me}function ee(d){switch(d.getDay()){case 0:return new Date(d.getFullYear()-1,11,29);case 1:return d;case 2:return new Date(d.getFullYear(),0,3);case 3:return new Date(d.getFullYear(),0,2);case 4:return new Date(d.getFullYear(),0,1);case 5:return new Date(d.getFullYear()-1,11,31);case 6:return new Date(d.getFullYear()-1,11,30)}}function ye(d){var k=d.sa;for(d=new Date(new Date(d.ta+1900,0,1).getTime());0<k;){var $=d.getMonth(),Me=(Le(d.getFullYear())?De:at)[$];if(k>Me-d.getDate())k-=Me-d.getDate()+1,d.setDate(1),11>$?d.setMonth($+1):(d.setMonth(0),d.setFullYear(d.getFullYear()+1));else{d.setDate(d.getDate()+k);break}}return $=new Date(d.getFullYear()+1,0,4),k=ee(new Date(d.getFullYear(),0,4)),$=ee($),0>=U(k,d)?0>=U($,d)?d.getFullYear()+1:d.getFullYear():d.getFullYear()-1}t>>>=0,o>>>=0,u>>>=0,m>>>=0;var oe=J[m+40>>>2>>>0];m={Ba:_[m>>>2>>>0],Aa:_[m+4>>>2>>>0],ua:_[m+8>>>2>>>0],xa:_[m+12>>>2>>>0],va:_[m+16>>>2>>>0],ta:_[m+20>>>2>>>0],na:_[m+24>>>2>>>0],sa:_[m+28>>>2>>>0],Da:_[m+32>>>2>>>0],za:_[m+36>>>2>>>0],Ca:oe?ue(oe):""},u=ue(u),oe={"%c":"%a %b %d %H:%M:%S %Y","%D":"%m/%d/%y","%F":"%Y-%m-%d","%h":"%b","%r":"%I:%M:%S %p","%R":"%H:%M","%T":"%H:%M:%S","%x":"%m/%d/%y","%X":"%H:%M:%S","%Ec":"%c","%EC":"%C","%Ex":"%m/%d/%y","%EX":"%H:%M:%S","%Ey":"%y","%EY":"%Y","%Od":"%d","%Oe":"%e","%OH":"%H","%OI":"%I","%Om":"%m","%OM":"%M","%OS":"%S","%Ou":"%u","%OU":"%U","%OV":"%V","%Ow":"%w","%OW":"%W","%Oy":"%y"};for(var se in oe)u=u.replace(new RegExp(se,"g"),oe[se]);var Qe="Sunday Monday Tuesday Wednesday Thursday Friday Saturday".split(" "),Re="January February March April May June July August September October November December".split(" ");oe={"%a":d=>Qe[d.na].substring(0,3),"%A":d=>Qe[d.na],"%b":d=>Re[d.va].substring(0,3),"%B":d=>Re[d.va],"%C":d=>E((d.ta+1900)/100|0,2),"%d":d=>E(d.xa,2),"%e":d=>O(d.xa,2," "),"%g":d=>ye(d).toString().substring(2),"%G":ye,"%H":d=>E(d.ua,2),"%I":d=>(d=d.ua,d==0?d=12:12<d&&(d-=12),E(d,2)),"%j":d=>{for(var k=0,$=0;$<=d.va-1;k+=(Le(d.ta+1900)?De:at)[$++]);return E(d.xa+k,3)},"%m":d=>E(d.va+1,2),"%M":d=>E(d.Aa,2),"%n":()=>`\n`,"%p":d=>0<=d.ua&&12>d.ua?"AM":"PM","%S":d=>E(d.Ba,2),"%t":()=>"	","%u":d=>d.na||7,"%U":d=>E(Math.floor((d.sa+7-d.na)/7),2),"%V":d=>{var k=Math.floor((d.sa+7-(d.na+6)%7)/7);if(2>=(d.na+371-d.sa-2)%7&&k++,k)k==53&&($=(d.na+371-d.sa)%7,$==4||$==3&&Le(d.ta)||(k=1));else{k=52;var $=(d.na+7-d.sa-1)%7;($==4||$==5&&Le(d.ta%400-1))&&k++}return E(k,2)},"%w":d=>d.na,"%W":d=>E(Math.floor((d.sa+7-(d.na+6)%7)/7),2),"%y":d=>(d.ta+1900).toString().substring(2),"%Y":d=>d.ta+1900,"%z":d=>{d=d.za;var k=0<=d;return d=Math.abs(d)/60,(k?"+":"-")+("0000"+(d/60*100+d%60)).slice(-4)},"%Z":d=>d.Ca,"%%":()=>"%"},u=u.replace(/%%/g,"\\0\\0");for(se in oe)u.includes(se)&&(u=u.replace(new RegExp(se,"g"),oe[se](m)));return u=u.replace(/\\0\\0/g,"%"),se=G(u),se.length>o?0:(pe.set(se,t>>>0),se.length-1)}var Ve={a:function(t,o,u){t>>>=0;var m=new _e(t);throw J[m.wa+16>>>2>>>0]=0,J[m.wa+4>>>2>>>0]=o>>>0,J[m.wa+8>>>2>>>0]=u>>>0,ge=t,Be++,ge},e:function(){return 0},H:function(){},x:function(){},z:function(){},J:function(){return 0},F:function(){},A:function(){},E:function(){},g:function(){},y:function(){},v:function(){},G:function(){},w:function(){},k:()=>1,I:function(t,o,u){return o>>>=0,Z.copyWithin(t>>>0>>>0,o>>>0,o+(u>>>0)>>>0)},n:function(t,o,u){t=o+2097152>>>0<4194305-!!t?(t>>>0)+4294967296*o:NaN,u>>>=0,t=new Date(1e3*t),_[u>>>2>>>0]=t.getUTCSeconds(),_[u+4>>>2>>>0]=t.getUTCMinutes(),_[u+8>>>2>>>0]=t.getUTCHours(),_[u+12>>>2>>>0]=t.getUTCDate(),_[u+16>>>2>>>0]=t.getUTCMonth(),_[u+20>>>2>>>0]=t.getUTCFullYear()-1900,_[u+24>>>2>>>0]=t.getUTCDay(),_[u+28>>>2>>>0]=(t.getTime()-Date.UTC(t.getUTCFullYear(),0,1,0,0,0,0))/864e5|0},o:function(t,o,u){t=o+2097152>>>0<4194305-!!t?(t>>>0)+4294967296*o:NaN,u>>>=0,t=new Date(1e3*t),_[u>>>2>>>0]=t.getSeconds(),_[u+4>>>2>>>0]=t.getMinutes(),_[u+8>>>2>>>0]=t.getHours(),_[u+12>>>2>>>0]=t.getDate(),_[u+16>>>2>>>0]=t.getMonth(),_[u+20>>>2>>>0]=t.getFullYear()-1900,_[u+24>>>2>>>0]=t.getDay(),_[u+28>>>2>>>0]=(Le(t.getFullYear())?ze:rt)[t.getMonth()]+t.getDate()-1|0,_[u+36>>>2>>>0]=-(60*t.getTimezoneOffset()),o=new Date(t.getFullYear(),6,1).getTimezoneOffset();var m=new Date(t.getFullYear(),0,1).getTimezoneOffset();_[u+32>>>2>>>0]=(o!=m&&t.getTimezoneOffset()==Math.min(m,o))|0},p:function(t){t>>>=0;var o=new Date(_[t+20>>>2>>>0]+1900,_[t+16>>>2>>>0],_[t+12>>>2>>>0],_[t+8>>>2>>>0],_[t+4>>>2>>>0],_[t>>>2>>>0],0),u=_[t+32>>>2>>>0],m=o.getTimezoneOffset(),O=new Date(o.getFullYear(),6,1).getTimezoneOffset(),E=new Date(o.getFullYear(),0,1).getTimezoneOffset(),U=Math.min(E,O);return 0>u?_[t+32>>>2>>>0]=+(O!=E&&U==m):0<u!=(U==m)&&(O=Math.max(E,O),o.setTime(o.getTime()+6e4*((0<u?U:O)-m))),_[t+24>>>2>>>0]=o.getDay(),_[t+28>>>2>>>0]=(Le(o.getFullYear())?ze:rt)[o.getMonth()]+o.getDate()-1|0,_[t>>>2>>>0]=o.getSeconds(),_[t+4>>>2>>>0]=o.getMinutes(),_[t+8>>>2>>>0]=o.getHours(),_[t+12>>>2>>>0]=o.getDate(),_[t+16>>>2>>>0]=o.getMonth(),_[t+20>>>2>>>0]=o.getYear(),t=o.getTime(),t=isNaN(t)?-1:t/1e3,Je((ve=t,1<=+Math.abs(ve)?0<ve?+Math.floor(ve/4294967296)>>>0:~~+Math.ceil((ve-+(~~ve>>>0))/4294967296)>>>0:0)),t>>>0},l:function(){return-52},m:function(){},t:function(t,o,u,m){u>>>=0,m>>>=0;var O=new Date().getFullYear(),E=new Date(O,0,1),U=new Date(O,6,1);O=E.getTimezoneOffset();var ee=U.getTimezoneOffset();J[t>>>0>>>2>>>0]=60*Math.max(O,ee),_[o>>>0>>>2>>>0]=+(O!=ee),t=ye=>ye.toLocaleTimeString(void 0,{hour12:!1,timeZoneName:"short"}).split(" ")[1],E=t(E),U=t(U),ee<O?(Se(E,Z,u,17),Se(U,Z,m,17)):(Se(E,Z,m,17),Se(U,Z,u,17))},d:()=>{ie("")},B:function(t,o,u){t>>>=0,o>>>=0,u>>>=0,Te.length=0;for(var m;m=Z[o++>>>0];){var O=m!=105;O&=m!=112,u+=O&&u%8?4:0,Te.push(m==112?J[u>>>2>>>0]:m==105?_[u>>>2>>>0]:Pe[u>>>3>>>0]),u+=O?8:4}return Ae[t](...Te)},h:()=>Date.now(),u:function(){return 4294901760},b:()=>performance.now(),s:function(t){t>>>=0;var o=Z.length;if(4294901760<t)return!1;for(var u=1;4>=u;u*=2){var m=o*(1+.2/u);m=Math.min(m,t+100663296);var O=Math;m=Math.max(t,m);e:{O=(O.min.call(O,4294901760,m+(65536-m%65536)%65536)-W.buffer.byteLength+65535)/65536;try{W.grow(O),le();var E=1;break e}catch{}E=void 0}if(E)return!0}return!1},C:function(t,o){t>>>=0,o>>>=0;var u=0;return ke().forEach((m,O)=>{var E=o+u;for(O=J[t+4*O>>>2>>>0]=E,E=0;E<m.length;++E)pe[O++>>>0]=m.charCodeAt(E);pe[O>>>0]=0,u+=m.length+1}),0},D:function(t,o){t>>>=0,o>>>=0;var u=ke();J[t>>>2>>>0]=u.length;var m=0;return u.forEach(O=>m+=O.length+1),J[o>>>2>>>0]=m,0},f:()=>52,j:function(){return 52},q:function(){return 70},i:function(t,o,u,m){o>>>=0,u>>>=0,m>>>=0;for(var O=0,E=0;E<u;E++){var U=J[o>>>2>>>0],ee=J[o+4>>>2>>>0];o+=8;for(var ye=0;ye<ee;ye++){var oe=Z[U+ye>>>0],se=nt[t];oe===0||oe===10?((t===1?T:L)(re(se,0)),se.length=0):se.push(oe)}O+=ee}return J[m>>>2>>>0]=O,0},r:qe,c:function(t,o,u,m){return qe(t>>>0,o>>>0,u>>>0,m>>>0)}},P=function(){function t(u){return P=u.exports,P=st(),W=P.K,le(),ne.unshift(P.L),we--,we==0&&(me!==null&&(clearInterval(me),me=null),F&&(u=F,F=null,u())),P}var o={a:Ve};if(we++,a.instantiateWasm)try{return a.instantiateWasm(o,t)}catch(u){L(`Module.instantiateWasm callback failed with error: ${u}`),f(u)}return Ue(o,function(u){t(u.instance)}).catch(f),{}}();a._OrtInit=(t,o)=>(a._OrtInit=P.M)(t,o),a._OrtGetLastError=(t,o)=>(a._OrtGetLastError=P.N)(t,o),a._OrtCreateSessionOptions=(t,o,u,m,O,E,U,ee,ye,oe)=>(a._OrtCreateSessionOptions=P.O)(t,o,u,m,O,E,U,ee,ye,oe),a._OrtAppendExecutionProvider=(t,o)=>(a._OrtAppendExecutionProvider=P.P)(t,o),a._OrtAddFreeDimensionOverride=(t,o,u)=>(a._OrtAddFreeDimensionOverride=P.Q)(t,o,u),a._OrtAddSessionConfigEntry=(t,o,u)=>(a._OrtAddSessionConfigEntry=P.R)(t,o,u),a._OrtReleaseSessionOptions=t=>(a._OrtReleaseSessionOptions=P.S)(t),a._OrtCreateSession=(t,o,u)=>(a._OrtCreateSession=P.T)(t,o,u),a._OrtReleaseSession=t=>(a._OrtReleaseSession=P.U)(t),a._OrtGetInputOutputCount=(t,o,u)=>(a._OrtGetInputOutputCount=P.V)(t,o,u),a._OrtGetInputName=(t,o)=>(a._OrtGetInputName=P.W)(t,o),a._OrtGetOutputName=(t,o)=>(a._OrtGetOutputName=P.X)(t,o),a._OrtFree=t=>(a._OrtFree=P.Y)(t),a._OrtCreateTensor=(t,o,u,m,O,E)=>(a._OrtCreateTensor=P.Z)(t,o,u,m,O,E),a._OrtGetTensorData=(t,o,u,m,O)=>(a._OrtGetTensorData=P._)(t,o,u,m,O),a._OrtReleaseTensor=t=>(a._OrtReleaseTensor=P.$)(t),a._OrtCreateRunOptions=(t,o,u,m)=>(a._OrtCreateRunOptions=P.aa)(t,o,u,m),a._OrtAddRunConfigEntry=(t,o,u)=>(a._OrtAddRunConfigEntry=P.ba)(t,o,u),a._OrtReleaseRunOptions=t=>(a._OrtReleaseRunOptions=P.ca)(t),a._OrtCreateBinding=t=>(a._OrtCreateBinding=P.da)(t),a._OrtBindInput=(t,o,u)=>(a._OrtBindInput=P.ea)(t,o,u),a._OrtBindOutput=(t,o,u,m)=>(a._OrtBindOutput=P.fa)(t,o,u,m),a._OrtClearBoundOutputs=t=>(a._OrtClearBoundOutputs=P.ga)(t),a._OrtReleaseBinding=t=>(a._OrtReleaseBinding=P.ha)(t),a._OrtRunWithBinding=(t,o,u,m,O)=>(a._OrtRunWithBinding=P.ia)(t,o,u,m,O),a._OrtRun=(t,o,u,m,O,E,U,ee)=>(a._OrtRun=P.ja)(t,o,u,m,O,E,U,ee),a._OrtEndProfiling=t=>(a._OrtEndProfiling=P.ka)(t),a._malloc=t=>(a._malloc=P.la)(t),a._free=t=>(a._free=P.ma)(t);var Je=t=>(Je=P.oa)(t),ot=t=>(ot=P.pa)(t),M=t=>(M=P.qa)(t),Ne=()=>(Ne=P.ra)();function st(){var t=P;t=Object.assign({},t);var o=u=>m=>u(m)>>>0;return t.la=o(t.la),t.qa=o(t.qa),t.ra=(u=>()=>u()>>>0)(t.ra),t}a.stackSave=()=>Ne(),a.stackRestore=t=>ot(t),a.stackAlloc=t=>M(t),a.UTF8ToString=ue,a.stringToUTF8=(t,o,u)=>Se(t,Z,o,u),a.lengthBytesUTF8=Ee;var Fe;F=function t(){Fe||Xe(),Fe||(F=t)};function Xe(){if(!(0<we)){if(a.preRun)for(typeof a.preRun=="function"&&(a.preRun=[a.preRun]);a.preRun.length;){var t=a.preRun.shift();Ie.unshift(t)}for(;0<Ie.length;)Ie.shift()(a);if(!(0<we||Fe||(Fe=!0,a.calledRun=!0,de))){for(;0<ne.length;)ne.shift()(a);for(h(a);0<X.length;)X.shift()(a)}}}return Xe(),w}})();typeof dr=="object"&&typeof Ct=="object"?Ct.exports=cr:typeof define=="function"&&define.amd&&define([],()=>cr)});var mr=Ke(()=>{});var gr=Ke(()=>{});var hr={};Et(hr,{cpus:()=>en});var en,br=_t(()=>{en=void 0});var Or=Ke((wr,Dt)=>{"use strict";var yr=(()=>{var i=typeof document<"u"?document.currentScript?.src:void 0;return typeof __filename<"u"&&(i||=__filename),function(c={}){function a(){return X.buffer!=ie.buffer&&K(),ie}function h(){return X.buffer!=ie.buffer&&K(),xe}function f(){return X.buffer!=ie.buffer&&K(),ce}function w(){return X.buffer!=ie.buffer&&K(),be}function g(){return X.buffer!=ie.buffer&&K(),ae}var s=c,S,x,H=new Promise((e,r)=>{S=e,x=r}),A=Object.assign({},s),I="./this.program",V=(e,r)=>{throw r},R=typeof window=="object",B=typeof importScripts=="function",D=typeof process=="object"&&typeof process.versions=="object"&&typeof process.versions.node=="string",T=s.ENVIRONMENT_IS_PTHREAD||!1,L="";function W(e){return s.locateFile?s.locateFile(e,L):L+e}var de,pe,Z;if(D){var _=(At(),et(St)),J=(Mt(),et(Tt));L=B?J.dirname(L)+"/":__dirname+"/",de=(e,r)=>(e=ue(e)?new URL(e):J.normalize(e),_.readFileSync(e,r?void 0:"utf8")),Z=e=>(e=de(e,!0),e.buffer||(e=new Uint8Array(e)),e),pe=(e,r,n,l=!0)=>{e=ue(e)?new URL(e):J.normalize(e),_.readFile(e,l?void 0:"utf8",(y,b)=>{y?n(y):r(l?b.buffer:b)})},!s.thisProgram&&1<process.argv.length&&(I=process.argv[1].replace(/\\\\/g,"/")),process.argv.slice(2),V=(e,r)=>{throw process.exitCode=e,r},global.Worker=mr().Worker}else(R||B)&&(B?L=self.location.href:typeof document<"u"&&document.currentScript&&(L=document.currentScript.src),typeof i<"u"&&i&&(L=i),L.startsWith("blob:")?L="":L=L.substr(0,L.replace(/[?#].*/,"").lastIndexOf("/")+1),D||(de=e=>{var r=new XMLHttpRequest;return r.open("GET",e,!1),r.send(null),r.responseText},B&&(Z=e=>{var r=new XMLHttpRequest;return r.open("GET",e,!1),r.responseType="arraybuffer",r.send(null),new Uint8Array(r.response)}),pe=(e,r,n)=>{var l=new XMLHttpRequest;l.open("GET",e,!0),l.responseType="arraybuffer",l.onload=()=>{l.status==200||l.status==0&&l.response?r(l.response):n()},l.onerror=n,l.send(null)}));D&&typeof performance>"u"&&(global.performance=gr().performance);var Pe=console.log.bind(console),le=console.error.bind(console);D&&(Pe=(...e)=>_.writeSync(1,e.join(" ")+`\n`),le=(...e)=>_.writeSync(2,e.join(" ")+`\n`));var Ie=Pe,ne=le;Object.assign(s,A),A=null;var X,we,me=!1,F,ie,xe,ce,be,ae;function K(){var e=X.buffer;s.HEAP8=ie=new Int8Array(e),s.HEAP16=new Int16Array(e),s.HEAPU8=xe=new Uint8Array(e),s.HEAPU16=new Uint16Array(e),s.HEAP32=ce=new Int32Array(e),s.HEAPU32=be=new Uint32Array(e),s.HEAPF32=new Float32Array(e),s.HEAPF64=ae=new Float64Array(e)}var je=16777216;if(T)X=s.wasmMemory;else if(s.wasmMemory)X=s.wasmMemory;else if(X=new WebAssembly.Memory({initial:je/65536,maximum:65536,shared:!0}),!(X.buffer instanceof SharedArrayBuffer))throw ne("requested a shared WebAssembly.Memory but the returned buffer is not a SharedArrayBuffer, indicating that while the browser has SharedArrayBuffer it does not have WebAssembly threads support - you may need to set a flag"),D&&ne("(on node you may need: --experimental-wasm-threads --experimental-wasm-bulk-memory and/or recent version)"),Error("bad memory");K(),je=X.buffer.byteLength;var Oe=[],Ue=[],ve=[],Ae=0,_e=null,ge=null;function Be(){if(Ae--,Ae==0&&(_e!==null&&(clearInterval(_e),_e=null),ge)){var e=ge;ge=null,e()}}function te(e){throw e="Aborted("+e+")",ne(e),me=!0,F=1,e=new WebAssembly.RuntimeError(e+". Build with -sASSERTIONS for more info."),x(e),e}var re=e=>e.startsWith("data:application/octet-stream;base64,"),ue=e=>e.startsWith("file://"),Ee;Ee="ort-wasm-threaded.wasm",re(Ee)||(Ee=W(Ee));function Se(e){if(Z)return Z(e);throw"both async and sync fetching of the wasm failed"}function Le(e){if(R||B){if(typeof fetch=="function"&&!ue(e))return fetch(e,{credentials:"same-origin"}).then(r=>{if(!r.ok)throw`failed to load wasm binary file at \'${e}\'`;return r.arrayBuffer()}).catch(()=>Se(e));if(pe)return new Promise((r,n)=>{pe(e,l=>r(new Uint8Array(l)),n)})}return Promise.resolve().then(()=>Se(e))}function ze(e,r,n){return Le(e).then(l=>WebAssembly.instantiate(l,r)).then(n,l=>{ne(`failed to asynchronously prepare wasm: ${l}`),te(l)})}function rt(e,r){var n=Ee;return typeof WebAssembly.instantiateStreaming!="function"||re(n)||ue(n)||D||typeof fetch!="function"?ze(n,e,r):fetch(n,{credentials:"same-origin"}).then(l=>WebAssembly.instantiateStreaming(l,e).then(r,function(y){return ne(`wasm streaming compile failed: ${y}`),ne("falling back to ArrayBuffer instantiation"),ze(n,e,r)}))}var Te,Ge={799444:(e,r,n,l)=>{if(typeof s>"u"||!s.bb)return 1;if(e=ee(e>>>0),e.startsWith("./")&&(e=e.substring(2)),e=s.bb.get(e),!e)return 2;if(r>>>=0,n>>>=0,l>>>=0,r+n>e.byteLength)return 3;try{return h().set(e.subarray(r,r+n),l>>>0),0}catch{return 4}}};function ke(e){this.name="ExitStatus",this.message=`Program terminated with exit(${e})`,this.status=e}var We=e=>{e.terminate(),e.onmessage=()=>{}},nt=e=>{M.Oa.length==0&&(Je(),M.Xa(M.Oa[0]));var r=M.Oa.pop();if(!r)return 6;M.Pa.push(r),M.La[e.Na]=r,r.Na=e.Na;var n={cmd:"run",start_routine:e.gb,arg:e.cb,pthread_ptr:e.Na};return D&&r.unref(),r.postMessage(n,e.mb),0},De=0,at=e=>{var r=Ot();return e=e(),ft(r),e},G=(e,r,...n)=>at(()=>{for(var l=n.length,y=wt(8*l),b=y>>>3,v=0;v<n.length;v++){var z=n[v];g()[b+v>>>0]=z}return rr(e,0,l,y,r)});function qe(e){if(T)return G(0,1,e);F=e,0<De||(M.hb(),s.onExit?.(e),me=!0),V(e,new ke(e))}var Ve=e=>{if(F=e,T)throw st(e),"unwind";qe(e)};function P(){for(var e=s.numThreads;e--;)Je();Oe.unshift(()=>{Ae++,ot(()=>Be())})}function Je(){var e=W("ort-wasm-threaded.worker.js");e=new Worker(e),M.Oa.push(e)}function ot(e){T?e():Promise.all(M.Oa.map(M.Xa)).then(e)}var M={Oa:[],Pa:[],ab:[],La:{},Va(){T?(M.receiveObjectTransfer=M.fb,M.threadInitTLS=M.$a,M.setExitStatus=M.Za):P()},Za:e=>F=e,pb:["$terminateWorker"],hb:()=>{for(var e of M.Pa)We(e);for(e of M.Oa)We(e);M.Oa=[],M.Pa=[],M.La=[]},Ya:e=>{var r=e.Na;delete M.La[r],M.Oa.push(e),M.Pa.splice(M.Pa.indexOf(e),1),e.Na=0,bt(r)},fb(){},$a(){M.ab.forEach(e=>e())},Xa:e=>new Promise(r=>{e.onmessage=b=>{b=b.data;var v=b.cmd;if(b.targetThread&&b.targetThread!=ut()){var z=M.La[b.targetThread];z?z.postMessage(b,b.transferList):ne(`Internal error! Worker sent a message "${v}" to target pthread ${b.targetThread}, but that thread no longer exists!`)}else v==="checkMailbox"?it():v==="spawnThread"?nt(b):v==="cleanupThread"?M.Ya(M.La[b.thread]):v==="killThread"?(b=b.thread,v=M.La[b],delete M.La[b],We(v),bt(b),M.Pa.splice(M.Pa.indexOf(v),1),v.Na=0):v==="cancelThread"?M.La[b.thread].postMessage({cmd:"cancel"}):v==="loaded"?(e.loaded=!0,D&&!e.Na&&e.unref(),r(e)):v==="alert"?alert(`Thread ${b.threadId}: ${b.text}`):b.target==="setimmediate"?e.postMessage(b):v==="callHandler"?s[b.handler](...b.args):v&&ne(`worker sent an unknown command ${v}`)},e.onerror=b=>{throw ne(`worker sent an error! ${b.filename}:${b.lineno}: ${b.message}`),b},D&&(e.on("message",b=>e.onmessage({data:b})),e.on("error",b=>e.onerror(b)));var n=[],l=["onExit"],y;for(y of l)s.hasOwnProperty(y)&&n.push(y);e.postMessage({cmd:"load",handlers:n,urlOrBlob:s.mainScriptUrlOrBlob||i,wasmMemory:X,wasmModule:we})})};s.PThread=M;var Ne=e=>{for(;0<e.length;)e.shift()(s)};s.establishStackSpace=()=>{var e=ut(),r=w()[e+52>>>2>>>0];e=w()[e+56>>>2>>>0],or(r,r-e),ft(r)};function st(e){if(T)return G(1,0,e);Ve(e)}var Fe=[],Xe;s.invokeEntryPoint=(e,r)=>{De=0;var n=Fe[e];n||(e>=Fe.length&&(Fe.length=e+1),Fe[e]=n=Xe.get(e)),e=n(r),0<De?M.Za(e):yt(e)};class t{constructor(r){this.Ua=r-24}Va(r,n){w()[this.Ua+16>>>2>>>0]=0,w()[this.Ua+4>>>2>>>0]=r,w()[this.Ua+8>>>2>>>0]=n}}var o=0,u=0;function m(e,r,n,l){return T?G(2,1,e,r,n,l):O(e,r,n,l)}function O(e,r,n,l){if(e>>>=0,r>>>=0,n>>>=0,l>>>=0,typeof SharedArrayBuffer>"u")return ne("Current environment does not support SharedArrayBuffer, pthreads are not available!"),6;var y=[];return T&&y.length===0?m(e,r,n,l):(e={gb:n,Na:e,cb:l,mb:y},T?(e.ob="spawnThread",postMessage(e,y),0):nt(e))}var E=typeof TextDecoder<"u"?new TextDecoder("utf8"):void 0,U=(e,r,n)=>{r>>>=0;var l=r+n;for(n=r;e[n]&&!(n>=l);)++n;if(16<n-r&&e.buffer&&E)return E.decode(e.buffer instanceof SharedArrayBuffer?e.slice(r,n):e.subarray(r,n));for(l="";r<n;){var y=e[r++];if(y&128){var b=e[r++]&63;if((y&224)==192)l+=String.fromCharCode((y&31)<<6|b);else{var v=e[r++]&63;y=(y&240)==224?(y&15)<<12|b<<6|v:(y&7)<<18|b<<12|v<<6|e[r++]&63,65536>y?l+=String.fromCharCode(y):(y-=65536,l+=String.fromCharCode(55296|y>>10,56320|y&1023))}}else l+=String.fromCharCode(y)}return l},ee=(e,r)=>(e>>>=0)?U(h(),e,r):"";function ye(e,r,n){return T?G(3,1,e,r,n):0}function oe(e,r){if(T)return G(4,1,e,r)}var se=e=>{for(var r=0,n=0;n<e.length;++n){var l=e.charCodeAt(n);127>=l?r++:2047>=l?r+=2:55296<=l&&57343>=l?(r+=4,++n):r+=3}return r},Qe=(e,r,n,l)=>{if(n>>>=0,!(0<l))return 0;var y=n;l=n+l-1;for(var b=0;b<e.length;++b){var v=e.charCodeAt(b);if(55296<=v&&57343>=v){var z=e.charCodeAt(++b);v=65536+((v&1023)<<10)|z&1023}if(127>=v){if(n>=l)break;r[n++>>>0]=v}else{if(2047>=v){if(n+1>=l)break;r[n++>>>0]=192|v>>6}else{if(65535>=v){if(n+2>=l)break;r[n++>>>0]=224|v>>12}else{if(n+3>=l)break;r[n++>>>0]=240|v>>18,r[n++>>>0]=128|v>>12&63}r[n++>>>0]=128|v>>6&63}r[n++>>>0]=128|v&63}}return r[n>>>0]=0,n-y},Re=(e,r,n)=>Qe(e,h(),r,n);function d(e,r){if(T)return G(5,1,e,r)}function k(e,r,n){if(T)return G(6,1,e,r,n)}function $(e,r,n){return T?G(7,1,e,r,n):0}function Me(e,r){if(T)return G(8,1,e,r)}function Ze(e,r,n){if(T)return G(9,1,e,r,n)}function Rt(e,r,n,l){if(T)return G(10,1,e,r,n,l)}function It(e,r,n,l){if(T)return G(11,1,e,r,n,l)}function Bt(e,r,n,l){if(T)return G(12,1,e,r,n,l)}function kt(e){if(T)return G(13,1,e)}function Wt(e,r){if(T)return G(14,1,e,r)}function Nt(e,r,n){if(T)return G(15,1,e,r,n)}function dt(e){e>>>=0,typeof Atomics.nb=="function"&&(Atomics.nb(f(),e>>>2,e).value.then(it),e+=128,Atomics.store(f(),e>>>2,1))}s.__emscripten_thread_mailbox_await=dt;var it=()=>{var e=ut();if(e&&(dt(e),e=nr,!me))try{if(e(),!(0<De))try{T?yt(F):Ve(F)}catch(r){r instanceof ke||r=="unwind"||V(1,r)}}catch(r){r instanceof ke||r=="unwind"||V(1,r)}};s.checkMailbox=it;var pt=[],$e=e=>e%4===0&&(e%100!==0||e%400===0),Ht=[0,31,60,91,121,152,182,213,244,274,305,335],Gt=[0,31,59,90,120,151,181,212,243,273,304,334];function $t(e,r,n,l,y,b,v,z){return T?G(16,1,e,r,n,l,y,b,v,z):-52}function Yt(e,r,n,l,y,b,v){if(T)return G(17,1,e,r,n,l,y,b,v)}var mt=[],gt={},jt=()=>{if(!ht){var e={USER:"web_user",LOGNAME:"web_user",PATH:"/",PWD:"/",HOME:"/home/web_user",LANG:(typeof navigator=="object"&&navigator.languages&&navigator.languages[0]||"C").replace("-","_")+".UTF-8",_:I||"./this.program"},r;for(r in gt)gt[r]===void 0?delete e[r]:e[r]=gt[r];var n=[];for(r in e)n.push(`${r}=${e[r]}`);ht=n}return ht},ht;function zt(e,r){if(T)return G(18,1,e,r);e>>>=0,r>>>=0;var n=0;return jt().forEach((l,y)=>{var b=r+n;for(y=w()[e+4*y>>>2>>>0]=b,b=0;b<l.length;++b)a()[y++>>>0]=l.charCodeAt(b);a()[y>>>0]=0,n+=l.length+1}),0}function qt(e,r){if(T)return G(19,1,e,r);e>>>=0,r>>>=0;var n=jt();w()[e>>>2>>>0]=n.length;var l=0;return n.forEach(y=>l+=y.length+1),w()[r>>>2>>>0]=l,0}function Vt(e){return T?G(20,1,e):52}function Jt(e,r,n,l){return T?G(21,1,e,r,n,l):52}function Xt(e,r,n,l,y){return T?G(22,1,e,r,n,l,y):70}var Hr=[null,[],[]];function Qt(e,r,n,l){if(T)return G(23,1,e,r,n,l);r>>>=0,n>>>=0,l>>>=0;for(var y=0,b=0;b<n;b++){var v=w()[r>>>2>>>0],z=w()[r+4>>>2>>>0];r+=8;for(var Ce=0;Ce<z;Ce++){var fe=h()[v+Ce>>>0],he=Hr[e];fe===0||fe===10?((e===1?Ie:ne)(U(he,0)),he.length=0):he.push(fe)}y+=z}return w()[l>>>2>>>0]=y,0}var Zt=[31,29,31,30,31,30,31,31,30,31,30,31],Kt=[31,28,31,30,31,30,31,31,30,31,30,31];function Gr(e){var r=Array(se(e)+1);return Qe(e,r,0,r.length),r}var $r=(e,r)=>{a().set(e,r>>>0)};function er(e,r,n,l){function y(p,N,q){for(p=typeof p=="number"?p.toString():p||"";p.length<N;)p=q[0]+p;return p}function b(p,N){return y(p,N,"0")}function v(p,N){function q(fr){return 0>fr?-1:0<fr?1:0}var He;return(He=q(p.getFullYear()-N.getFullYear()))===0&&(He=q(p.getMonth()-N.getMonth()))===0&&(He=q(p.getDate()-N.getDate())),He}function z(p){switch(p.getDay()){case 0:return new Date(p.getFullYear()-1,11,29);case 1:return p;case 2:return new Date(p.getFullYear(),0,3);case 3:return new Date(p.getFullYear(),0,2);case 4:return new Date(p.getFullYear(),0,1);case 5:return new Date(p.getFullYear()-1,11,31);case 6:return new Date(p.getFullYear()-1,11,30)}}function Ce(p){var N=p.Qa;for(p=new Date(new Date(p.Ra+1900,0,1).getTime());0<N;){var q=p.getMonth(),He=($e(p.getFullYear())?Zt:Kt)[q];if(N>He-p.getDate())N-=He-p.getDate()+1,p.setDate(1),11>q?p.setMonth(q+1):(p.setMonth(0),p.setFullYear(p.getFullYear()+1));else{p.setDate(p.getDate()+N);break}}return q=new Date(p.getFullYear()+1,0,4),N=z(new Date(p.getFullYear(),0,4)),q=z(q),0>=v(N,p)?0>=v(q,p)?p.getFullYear()+1:p.getFullYear():p.getFullYear()-1}e>>>=0,r>>>=0,n>>>=0,l>>>=0;var fe=w()[l+40>>>2>>>0];l={kb:f()[l>>>2>>>0],jb:f()[l+4>>>2>>>0],Sa:f()[l+8>>>2>>>0],Wa:f()[l+12>>>2>>>0],Ta:f()[l+16>>>2>>>0],Ra:f()[l+20>>>2>>>0],Ma:f()[l+24>>>2>>>0],Qa:f()[l+28>>>2>>>0],qb:f()[l+32>>>2>>>0],ib:f()[l+36>>>2>>>0],lb:fe?ee(fe):""},n=ee(n),fe={"%c":"%a %b %d %H:%M:%S %Y","%D":"%m/%d/%y","%F":"%Y-%m-%d","%h":"%b","%r":"%I:%M:%S %p","%R":"%H:%M","%T":"%H:%M:%S","%x":"%m/%d/%y","%X":"%H:%M:%S","%Ec":"%c","%EC":"%C","%Ex":"%m/%d/%y","%EX":"%H:%M:%S","%Ey":"%y","%EY":"%Y","%Od":"%d","%Oe":"%e","%OH":"%H","%OI":"%I","%Om":"%m","%OM":"%M","%OS":"%S","%Ou":"%u","%OU":"%U","%OV":"%V","%Ow":"%w","%OW":"%W","%Oy":"%y"};for(var he in fe)n=n.replace(new RegExp(he,"g"),fe[he]);var ir="Sunday Monday Tuesday Wednesday Thursday Friday Saturday".split(" "),ur="January February March April May June July August September October November December".split(" ");fe={"%a":p=>ir[p.Ma].substring(0,3),"%A":p=>ir[p.Ma],"%b":p=>ur[p.Ta].substring(0,3),"%B":p=>ur[p.Ta],"%C":p=>b((p.Ra+1900)/100|0,2),"%d":p=>b(p.Wa,2),"%e":p=>y(p.Wa,2," "),"%g":p=>Ce(p).toString().substring(2),"%G":Ce,"%H":p=>b(p.Sa,2),"%I":p=>(p=p.Sa,p==0?p=12:12<p&&(p-=12),b(p,2)),"%j":p=>{for(var N=0,q=0;q<=p.Ta-1;N+=($e(p.Ra+1900)?Zt:Kt)[q++]);return b(p.Wa+N,3)},"%m":p=>b(p.Ta+1,2),"%M":p=>b(p.jb,2),"%n":()=>`\n`,"%p":p=>0<=p.Sa&&12>p.Sa?"AM":"PM","%S":p=>b(p.kb,2),"%t":()=>"	","%u":p=>p.Ma||7,"%U":p=>b(Math.floor((p.Qa+7-p.Ma)/7),2),"%V":p=>{var N=Math.floor((p.Qa+7-(p.Ma+6)%7)/7);if(2>=(p.Ma+371-p.Qa-2)%7&&N++,N)N==53&&(q=(p.Ma+371-p.Qa)%7,q==4||q==3&&$e(p.Ra)||(N=1));else{N=52;var q=(p.Ma+7-p.Qa-1)%7;(q==4||q==5&&$e(p.Ra%400-1))&&N++}return b(N,2)},"%w":p=>p.Ma,"%W":p=>b(Math.floor((p.Qa+7-(p.Ma+6)%7)/7),2),"%y":p=>(p.Ra+1900).toString().substring(2),"%Y":p=>p.Ra+1900,"%z":p=>{p=p.ib;var N=0<=p;return p=Math.abs(p)/60,(N?"+":"-")+("0000"+(p/60*100+p%60)).slice(-4)},"%Z":p=>p.lb,"%%":()=>"%"},n=n.replace(/%%/g,"\\0\\0");for(he in fe)n.includes(he)&&(n=n.replace(new RegExp(he,"g"),fe[he](l)));return n=n.replace(/\\0\\0/g,"%"),he=Gr(n),he.length>r?0:($r(he,e),he.length-1)}M.Va();var Yr=[qe,st,m,ye,oe,d,k,$,Me,Ze,Rt,It,Bt,kt,Wt,Nt,$t,Yt,zt,qt,Vt,Jt,Xt,Qt],jr={b:function(e,r,n){throw e>>>=0,new t(e).Va(r>>>0,n>>>0),o=e,u++,o},L:function(e){tr(e>>>0,!B,1,!R,131072,!1),M.$a()},j:function(e){e>>>=0,T?postMessage({cmd:"cleanupThread",thread:e}):M.Ya(M.La[e])},H:O,h:ye,S:oe,D:d,F:k,T:$,Q:Me,J:Ze,P:Rt,n:It,E:Bt,B:kt,R:Wt,C:Nt,p:()=>1,z:function(e,r){e>>>=0,e==r>>>0?setTimeout(it):T?postMessage({targetThread:e,cmd:"checkMailbox"}):(e=M.La[e])&&e.postMessage({cmd:"checkMailbox"})},I:function(e,r,n,l,y){r>>>=0,n>>>=0,pt.length=l,y=y>>>0>>>3;for(var b=0;b<l;b++)pt[b]=g()[y+b>>>0];return e=r?Ge[r]:Yr[e],M.eb=n,n=e(...pt),M.eb=0,n},K:dt,o:function(e){D&&M.La[e>>>0].ref()},s:function(e,r,n){e=r+2097152>>>0<4194305-!!e?(e>>>0)+4294967296*r:NaN,n>>>=0,e=new Date(1e3*e),f()[n>>>2>>>0]=e.getUTCSeconds(),f()[n+4>>>2>>>0]=e.getUTCMinutes(),f()[n+8>>>2>>>0]=e.getUTCHours(),f()[n+12>>>2>>>0]=e.getUTCDate(),f()[n+16>>>2>>>0]=e.getUTCMonth(),f()[n+20>>>2>>>0]=e.getUTCFullYear()-1900,f()[n+24>>>2>>>0]=e.getUTCDay(),e=(e.getTime()-Date.UTC(e.getUTCFullYear(),0,1,0,0,0,0))/864e5|0,f()[n+28>>>2>>>0]=e},t:function(e,r,n){e=r+2097152>>>0<4194305-!!e?(e>>>0)+4294967296*r:NaN,n>>>=0,e=new Date(1e3*e),f()[n>>>2>>>0]=e.getSeconds(),f()[n+4>>>2>>>0]=e.getMinutes(),f()[n+8>>>2>>>0]=e.getHours(),f()[n+12>>>2>>>0]=e.getDate(),f()[n+16>>>2>>>0]=e.getMonth(),f()[n+20>>>2>>>0]=e.getFullYear()-1900,f()[n+24>>>2>>>0]=e.getDay(),r=($e(e.getFullYear())?Ht:Gt)[e.getMonth()]+e.getDate()-1|0,f()[n+28>>>2>>>0]=r,f()[n+36>>>2>>>0]=-(60*e.getTimezoneOffset()),r=new Date(e.getFullYear(),6,1).getTimezoneOffset();var l=new Date(e.getFullYear(),0,1).getTimezoneOffset();e=(r!=l&&e.getTimezoneOffset()==Math.min(l,r))|0,f()[n+32>>>2>>>0]=e},u:function(e){e>>>=0;var r=new Date(f()[e+20>>>2>>>0]+1900,f()[e+16>>>2>>>0],f()[e+12>>>2>>>0],f()[e+8>>>2>>>0],f()[e+4>>>2>>>0],f()[e>>>2>>>0],0),n=f()[e+32>>>2>>>0],l=r.getTimezoneOffset(),y=new Date(r.getFullYear(),6,1).getTimezoneOffset(),b=new Date(r.getFullYear(),0,1).getTimezoneOffset(),v=Math.min(b,y);return 0>n?f()[e+32>>>2>>>0]=+(y!=b&&v==l):0<n!=(v==l)&&(y=Math.max(b,y),r.setTime(r.getTime()+6e4*((0<n?v:y)-l))),f()[e+24>>>2>>>0]=r.getDay(),n=($e(r.getFullYear())?Ht:Gt)[r.getMonth()]+r.getDate()-1|0,f()[e+28>>>2>>>0]=n,f()[e>>>2>>>0]=r.getSeconds(),f()[e+4>>>2>>>0]=r.getMinutes(),f()[e+8>>>2>>>0]=r.getHours(),f()[e+12>>>2>>>0]=r.getDate(),f()[e+16>>>2>>>0]=r.getMonth(),f()[e+20>>>2>>>0]=r.getYear(),e=r.getTime(),e=isNaN(e)?-1:e/1e3,ar((Te=e,1<=+Math.abs(Te)?0<Te?+Math.floor(Te/4294967296)>>>0:~~+Math.ceil((Te-+(~~Te>>>0))/4294967296)>>>0:0)),e>>>0},q:$t,r:Yt,y:function(e,r,n,l){e>>>=0,r>>>=0,n>>>=0,l>>>=0;var y=new Date().getFullYear(),b=new Date(y,0,1),v=new Date(y,6,1);y=b.getTimezoneOffset();var z=v.getTimezoneOffset(),Ce=Math.max(y,z);w()[e>>>2>>>0]=60*Ce,f()[r>>>2>>>0]=+(y!=z),e=fe=>fe.toLocaleTimeString(void 0,{hour12:!1,timeZoneName:"short"}).split(" ")[1],b=e(b),v=e(v),z<y?(Re(b,n,17),Re(v,l,17)):(Re(b,l,17),Re(v,n,17))},c:()=>{te("")},O:function(e,r,n){e>>>=0,r>>>=0,n>>>=0,mt.length=0;for(var l;l=h()[r++>>>0];){var y=l!=105;y&=l!=112,n+=y&&n%8?4:0,mt.push(l==112?w()[n>>>2>>>0]:l==105?f()[n>>>2>>>0]:g()[n>>>3>>>0]),n+=y?8:4}return Ge[e](...mt)},k:()=>{},i:()=>Date.now(),U:()=>{throw De+=1,"unwind"},A:function(){return 4294901760},e:()=>performance.timeOrigin+performance.now(),f:()=>D?(br(),et(hr)).cpus().length:navigator.hardwareConcurrency,x:function(e){e>>>=0;var r=h().length;if(e<=r||4294901760<e)return!1;for(var n=1;4>=n;n*=2){var l=r*(1+.2/n);l=Math.min(l,e+100663296);var y=Math;l=Math.max(e,l);e:{y=(y.min.call(y,4294901760,l+(65536-l%65536)%65536)-X.buffer.byteLength+65535)/65536;try{X.grow(y),K();var b=1;break e}catch{}b=void 0}if(b)return!0}return!1},M:zt,N:qt,G:Ve,g:Vt,m:Jt,v:Xt,l:Qt,a:X||s.wasmMemory,w:er,d:function(e,r,n,l){return er(e>>>0,r>>>0,n>>>0,l>>>0)}},C=function(){function e(n,l){return C=n.exports,C=zr(),M.ab.push(C.ya),Xe=C.za,Ue.unshift(C.V),we=l,Be(),C}var r={a:jr};if(Ae++,s.instantiateWasm)try{return s.instantiateWasm(r,e)}catch(n){ne(`Module.instantiateWasm callback failed with error: ${n}`),x(n)}return rt(r,function(n){e(n.instance,n.module)}).catch(x),{}}();s._OrtInit=(e,r)=>(s._OrtInit=C.W)(e,r),s._OrtGetLastError=(e,r)=>(s._OrtGetLastError=C.X)(e,r),s._OrtCreateSessionOptions=(e,r,n,l,y,b,v,z,Ce,fe)=>(s._OrtCreateSessionOptions=C.Y)(e,r,n,l,y,b,v,z,Ce,fe),s._OrtAppendExecutionProvider=(e,r)=>(s._OrtAppendExecutionProvider=C.Z)(e,r),s._OrtAddFreeDimensionOverride=(e,r,n)=>(s._OrtAddFreeDimensionOverride=C._)(e,r,n),s._OrtAddSessionConfigEntry=(e,r,n)=>(s._OrtAddSessionConfigEntry=C.$)(e,r,n),s._OrtReleaseSessionOptions=e=>(s._OrtReleaseSessionOptions=C.aa)(e),s._OrtCreateSession=(e,r,n)=>(s._OrtCreateSession=C.ba)(e,r,n),s._OrtReleaseSession=e=>(s._OrtReleaseSession=C.ca)(e),s._OrtGetInputOutputCount=(e,r,n)=>(s._OrtGetInputOutputCount=C.da)(e,r,n),s._OrtGetInputName=(e,r)=>(s._OrtGetInputName=C.ea)(e,r),s._OrtGetOutputName=(e,r)=>(s._OrtGetOutputName=C.fa)(e,r),s._OrtFree=e=>(s._OrtFree=C.ga)(e),s._OrtCreateTensor=(e,r,n,l,y,b)=>(s._OrtCreateTensor=C.ha)(e,r,n,l,y,b),s._OrtGetTensorData=(e,r,n,l,y)=>(s._OrtGetTensorData=C.ia)(e,r,n,l,y),s._OrtReleaseTensor=e=>(s._OrtReleaseTensor=C.ja)(e),s._OrtCreateRunOptions=(e,r,n,l)=>(s._OrtCreateRunOptions=C.ka)(e,r,n,l),s._OrtAddRunConfigEntry=(e,r,n)=>(s._OrtAddRunConfigEntry=C.la)(e,r,n),s._OrtReleaseRunOptions=e=>(s._OrtReleaseRunOptions=C.ma)(e),s._OrtCreateBinding=e=>(s._OrtCreateBinding=C.na)(e),s._OrtBindInput=(e,r,n)=>(s._OrtBindInput=C.oa)(e,r,n),s._OrtBindOutput=(e,r,n,l)=>(s._OrtBindOutput=C.pa)(e,r,n,l),s._OrtClearBoundOutputs=e=>(s._OrtClearBoundOutputs=C.qa)(e),s._OrtReleaseBinding=e=>(s._OrtReleaseBinding=C.ra)(e),s._OrtRunWithBinding=(e,r,n,l,y)=>(s._OrtRunWithBinding=C.sa)(e,r,n,l,y),s._OrtRun=(e,r,n,l,y,b,v,z)=>(s._OrtRun=C.ta)(e,r,n,l,y,b,v,z),s._OrtEndProfiling=e=>(s._OrtEndProfiling=C.ua)(e);var ut=s._pthread_self=()=>(ut=s._pthread_self=C.va)();s._malloc=e=>(s._malloc=C.wa)(e),s._free=e=>(s._free=C.xa)(e),s.__emscripten_tls_init=()=>(s.__emscripten_tls_init=C.ya)();var tr=s.__emscripten_thread_init=(e,r,n,l,y,b)=>(tr=s.__emscripten_thread_init=C.Aa)(e,r,n,l,y,b);s.__emscripten_thread_crashed=()=>(s.__emscripten_thread_crashed=C.Ba)();var rr=(e,r,n,l,y)=>(rr=C.Ca)(e,r,n,l,y),bt=e=>(bt=C.Da)(e),yt=s.__emscripten_thread_exit=e=>(yt=s.__emscripten_thread_exit=C.Ea)(e),nr=()=>(nr=C.Fa)(),ar=e=>(ar=C.Ga)(e),or=(e,r)=>(or=C.Ha)(e,r),ft=e=>(ft=C.Ia)(e),wt=e=>(wt=C.Ja)(e),Ot=()=>(Ot=C.Ka)();function zr(){var e=C;e=Object.assign({},e);var r=l=>()=>l()>>>0,n=l=>y=>l(y)>>>0;return e.va=r(e.va),e.wa=n(e.wa),e.emscripten_main_runtime_thread_id=r(e.emscripten_main_runtime_thread_id),e.Ja=n(e.Ja),e.Ka=r(e.Ka),e}s.wasmMemory=X,s.stackSave=()=>Ot(),s.stackRestore=e=>ft(e),s.stackAlloc=e=>wt(e),s.keepRuntimeAlive=()=>0<De,s.UTF8ToString=ee,s.stringToUTF8=Re,s.lengthBytesUTF8=se,s.ExitStatus=ke,s.PThread=M;var lt;ge=function e(){lt||sr(),lt||(ge=e)};function sr(){if(!(0<Ae))if(T)S(s),T||Ne(Ue),startWorker(s);else{if(s.preRun)for(typeof s.preRun=="function"&&(s.preRun=[s.preRun]);s.preRun.length;)Oe.unshift(s.preRun.shift());Ne(Oe),0<Ae||lt||(lt=!0,s.calledRun=!0,me||(T||Ne(Ue),S(s),T||Ne(ve)))}}return sr(),H}})();typeof wr=="object"&&typeof Dt=="object"?Dt.exports=yr:typeof define=="function"&&define.amd&&define([],()=>yr)});var vr=Ke((yn,tn)=>{tn.exports=\'"use strict";var Module={},ENVIRONMENT_IS_NODE=typeof process=="object"&&typeof process.versions=="object"&&typeof process.versions.node=="string";if(ENVIRONMENT_IS_NODE){var nodeWorkerThreads=require("worker_threads"),parentPort=nodeWorkerThreads.parentPort;parentPort.on("message",e=>onmessage({data:e}));var fs=require("fs"),vm=require("vm");Object.assign(global,{self:global,require,Module,location:{href:__filename},Worker:nodeWorkerThreads.Worker,importScripts:e=>vm.runInThisContext(fs.readFileSync(e,"utf8"),{filename:e}),postMessage:e=>parentPort.postMessage(e),performance:global.performance||{now:Date.now}})}var initializedJS=!1;function threadPrintErr(...e){var a=e.join(" ");if(ENVIRONMENT_IS_NODE){fs.writeSync(2,a+`\\n`);return}console.error(a)}function threadAlert(...e){var a=e.join(" ");postMessage({cmd:"alert",text:a,threadId:Module._pthread_self()})}var err=threadPrintErr;self.alert=threadAlert,Module.instantiateWasm=(e,a)=>{var r=Module.wasmModule;Module.wasmModule=null;var t=new WebAssembly.Instance(r,e);return a(t)},self.onunhandledrejection=e=>{throw e.reason||e};function handleMessage(e){try{if(e.data.cmd==="load"){let r=[];self.onmessage=t=>r.push(t),self.startWorker=t=>{Module=t,postMessage({cmd:"loaded"});for(let s of r)handleMessage(s);self.onmessage=handleMessage},Module.wasmModule=e.data.wasmModule;for(const t of e.data.handlers)Module[t]=(...s)=>{postMessage({cmd:"callHandler",handler:t,args:s})};if(Module.wasmMemory=e.data.wasmMemory,Module.buffer=Module.wasmMemory.buffer,Module.ENVIRONMENT_IS_PTHREAD=!0,typeof e.data.urlOrBlob=="string")importScripts(e.data.urlOrBlob);else{var a=URL.createObjectURL(e.data.urlOrBlob);importScripts(a),URL.revokeObjectURL(a)}ortWasmThreaded(Module)}else if(e.data.cmd==="run"){Module.__emscripten_thread_init(e.data.pthread_ptr,0,0,1),Module.__emscripten_thread_mailbox_await(e.data.pthread_ptr),Module.establishStackSpace(),Module.PThread.receiveObjectTransfer(e.data),Module.PThread.threadInitTLS(),initializedJS||(initializedJS=!0);try{Module.invokeEntryPoint(e.data.start_routine,e.data.arg)}catch(r){if(r!="unwind")throw r}}else e.data.cmd==="cancel"?Module._pthread_self()&&Module.__emscripten_thread_exit(-1):e.data.target==="setimmediate"||(e.data.cmd==="checkMailbox"?initializedJS&&Module.checkMailbox():e.data.cmd&&(err(`worker.js received unknown command ${e.data.cmd}`),err(e.data)))}catch(r){throw Module.__emscripten_thread_crashed?.(),r}}self.onmessage=handleMessage;\\n\'});var Er;Er=pr();var rn=Or(),Ft,Pt=!1,ct=!1,_r=!1,nn=i=>{if(i===1)return!1;if(typeof SharedArrayBuffer>"u")return typeof self<"u"&&!self.crossOriginIsolated&&console.warn("env.wasm.numThreads is set to "+i+", but this will not work unless you enable crossOriginIsolated mode. See https://web.dev/cross-origin-isolation-guide/ for more info."),!1;typeof process<"u"&&process.versions&&process.versions.node&&console.warn("env.wasm.numThreads is set to "+i+", however, currently onnxruntime-web does not support multi-threads in Node.js. Please consider using onnxruntime-node for performance critical scenarios.");try{return typeof MessageChannel<"u"&&new MessageChannel().port1.postMessage(new SharedArrayBuffer(1)),WebAssembly.validate(new Uint8Array([0,97,115,109,1,0,0,0,1,4,1,96,0,0,3,2,1,0,5,4,1,3,1,1,10,11,1,9,0,65,0,254,16,2,0,26,11]))}catch{return!1}},an=()=>{try{return WebAssembly.validate(new Uint8Array([0,97,115,109,1,0,0,0,1,4,1,96,0,0,3,2,1,0,10,30,1,28,0,65,0,253,15,253,12,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,253,186,1,26,11]))}catch{return!1}},on=(i,c)=>i?c?"ort-wasm-simd-threaded.wasm":"ort-wasm-simd.wasm":c?"ort-wasm-threaded.wasm":"ort-wasm.wasm",Sr=async i=>{if(Pt)return Promise.resolve();if(ct)throw new Error("multiple calls to \'initializeWebAssembly()\' detected.");if(_r)throw new Error("previous call to \'initializeWebAssembly()\' failed.");ct=!0;let c=i.initTimeout,a=i.numThreads,h=i.simd,f=nn(a),w=h&&an(),g=i.wasmPaths,s=typeof g=="string"?g:void 0,S=on(w,f),x=typeof g=="object"?g[S]:void 0,H=!1,A=[];if(c>0&&A.push(new Promise(I=>{setTimeout(()=>{H=!0,I()},c)})),A.push(new Promise((I,V)=>{let R=f?rn:Er,B={locateFile:(D,T)=>f&&D.endsWith(".worker.js")&&typeof Blob<"u"?URL.createObjectURL(new Blob([vr()],{type:"text/javascript"})):D.endsWith(".wasm")?x||(s??T)+S:T+D};if(f)if(B.numThreads=a,typeof Blob>"u")B.mainScriptUrlOrBlob=(void 0)(__dirname,"ort-wasm-threaded.js");else{let D=`var ortWasmThreaded=${R.toString()};`;B.mainScriptUrlOrBlob=new Blob([D],{type:"text/javascript"})}R(B).then(D=>{ct=!1,Pt=!0,Ft=D,I()},D=>{ct=!1,_r=!0,V(D)})})),await Promise.race(A),H)throw new Error(`WebAssembly backend initializing failed due to timeout: ${c}ms`)},Q=()=>{if(Pt&&Ft)return Ft;throw new Error("WebAssembly is not initialized yet.")};var Y=(i,c)=>{let a=Q(),h=a.lengthBytesUTF8(i)+1,f=a._malloc(h);return a.stringToUTF8(i,f,h),c.push(f),f},tt=(i,c,a,h)=>{if(typeof i=="object"&&i!==null){if(a.has(i))throw new Error("Circular reference in options");a.add(i)}Object.entries(i).forEach(([f,w])=>{let g=c?c+f:f;if(typeof w=="object")tt(w,g+".",a,h);else if(typeof w=="string"||typeof w=="number")h(g,w.toString());else if(typeof w=="boolean")h(g,w?"1":"0");else throw new Error(`Can\'t handle extra config type: ${typeof w}`)})},j=i=>{let c=Q(),a=c.stackSave();try{let h=c.stackAlloc(8);c._OrtGetLastError(h,h+4);let f=c.HEAP32[h/4],w=c.HEAPU32[h/4+1],g=w?c.UTF8ToString(w):"";throw new Error(`${i} ERROR_CODE: ${f}, ERROR_MESSAGE: ${g}`)}finally{c.stackRestore(a)}};var Ar=i=>{let c=Q(),a=0,h=[],f=i||{};try{if(i?.logSeverityLevel===void 0)f.logSeverityLevel=2;else if(typeof i.logSeverityLevel!="number"||!Number.isInteger(i.logSeverityLevel)||i.logSeverityLevel<0||i.logSeverityLevel>4)throw new Error(`log serverity level is not valid: ${i.logSeverityLevel}`);if(i?.logVerbosityLevel===void 0)f.logVerbosityLevel=0;else if(typeof i.logVerbosityLevel!="number"||!Number.isInteger(i.logVerbosityLevel))throw new Error(`log verbosity level is not valid: ${i.logVerbosityLevel}`);i?.terminate===void 0&&(f.terminate=!1);let w=0;return i?.tag!==void 0&&(w=Y(i.tag,h)),a=c._OrtCreateRunOptions(f.logSeverityLevel,f.logVerbosityLevel,!!f.terminate,w),a===0&&j("Can\'t create run options."),i?.extra!==void 0&&tt(i.extra,"",new WeakSet,(g,s)=>{let S=Y(g,h),x=Y(s,h);c._OrtAddRunConfigEntry(a,S,x)!==0&&j(`Can\'t set a run config entry: ${g} - ${s}.`)}),[a,h]}catch(w){throw a!==0&&c._OrtReleaseRunOptions(a),h.forEach(g=>c._free(g)),w}};var sn=i=>{switch(i){case"disabled":return 0;case"basic":return 1;case"extended":return 2;case"all":return 99;default:throw new Error(`unsupported graph optimization level: ${i}`)}},un=i=>{switch(i){case"sequential":return 0;case"parallel":return 1;default:throw new Error(`unsupported execution mode: ${i}`)}},fn=i=>{i.extra||(i.extra={}),i.extra.session||(i.extra.session={});let c=i.extra.session;c.use_ort_model_bytes_directly||(c.use_ort_model_bytes_directly="1"),i.executionProviders&&i.executionProviders.some(a=>(typeof a=="string"?a:a.name)==="webgpu")&&(i.enableMemPattern=!1)},ln=(i,c,a)=>{for(let h of c){let f=typeof h=="string"?h:h.name;switch(f){case"webnn":if(f="WEBNN",typeof h!="string"){let g=h;if(g?.deviceType){let s=Y("deviceType",a),S=Y(g.deviceType,a);Q()._OrtAddSessionConfigEntry(i,s,S)!==0&&j(`Can\'t set a session config entry: \'deviceType\' - ${g.deviceType}.`)}if(g?.numThreads){let s=g.numThreads;(typeof s!="number"||!Number.isInteger(s)||s<0)&&(s=0);let S=Y("numThreads",a),x=Y(s.toString(),a);Q()._OrtAddSessionConfigEntry(i,S,x)!==0&&j(`Can\'t set a session config entry: \'numThreads\' - ${g.numThreads}.`)}if(g?.powerPreference){let s=Y("powerPreference",a),S=Y(g.powerPreference,a);Q()._OrtAddSessionConfigEntry(i,s,S)!==0&&j(`Can\'t set a session config entry: \'powerPreference\' - ${g.powerPreference}.`)}}break;case"webgpu":if(f="JS",typeof h!="string"){let g=h;if(g?.preferredLayout){if(g.preferredLayout!=="NCHW"&&g.preferredLayout!=="NHWC")throw new Error(`preferredLayout must be either \'NCHW\' or \'NHWC\': ${g.preferredLayout}`);let s=Y("preferredLayout",a),S=Y(g.preferredLayout,a);Q()._OrtAddSessionConfigEntry(i,s,S)!==0&&j(`Can\'t set a session config entry: \'preferredLayout\' - ${g.preferredLayout}.`)}}break;case"wasm":case"cpu":continue;default:throw new Error(`not supported execution provider: ${f}`)}let w=Y(f,a);Q()._OrtAppendExecutionProvider(i,w)!==0&&j(`Can\'t append execution provider: ${f}.`)}},Tr=i=>{let c=Q(),a=0,h=[],f=i||{};fn(f);try{let w=sn(f.graphOptimizationLevel??"all"),g=un(f.executionMode??"sequential"),s=typeof f.logId=="string"?Y(f.logId,h):0,S=f.logSeverityLevel??2;if(!Number.isInteger(S)||S<0||S>4)throw new Error(`log serverity level is not valid: ${S}`);let x=f.logVerbosityLevel??0;if(!Number.isInteger(x)||x<0||x>4)throw new Error(`log verbosity level is not valid: ${x}`);let H=typeof f.optimizedModelFilePath=="string"?Y(f.optimizedModelFilePath,h):0;if(a=c._OrtCreateSessionOptions(w,!!f.enableCpuMemArena,!!f.enableMemPattern,g,!!f.enableProfiling,0,s,S,x,H),a===0&&j("Can\'t create session options."),f.executionProviders&&ln(a,f.executionProviders,h),f.enableGraphCapture!==void 0){if(typeof f.enableGraphCapture!="boolean")throw new Error(`enableGraphCapture must be a boolean value: ${f.enableGraphCapture}`);let A=Y("enableGraphCapture",h),I=Y(f.enableGraphCapture.toString(),h);c._OrtAddSessionConfigEntry(a,A,I)!==0&&j(`Can\'t set a session config entry: \'enableGraphCapture\' - ${f.enableGraphCapture}.`)}if(f.freeDimensionOverrides)for(let[A,I]of Object.entries(f.freeDimensionOverrides)){if(typeof A!="string")throw new Error(`free dimension override name must be a string: ${A}`);if(typeof I!="number"||!Number.isInteger(I)||I<0)throw new Error(`free dimension override value must be a non-negative integer: ${I}`);let V=Y(A,h);c._OrtAddFreeDimensionOverride(a,V,I)!==0&&j(`Can\'t set a free dimension override: ${A} - ${I}.`)}return f.extra!==void 0&&tt(f.extra,"",new WeakSet,(A,I)=>{let V=Y(A,h),R=Y(I,h);c._OrtAddSessionConfigEntry(a,V,R)!==0&&j(`Can\'t set a session config entry: ${A} - ${I}.`)}),[a,h]}catch(w){throw a!==0&&c._OrtReleaseSessionOptions(a),h.forEach(g=>c._free(g)),w}};var xt=i=>{switch(i){case"int8":return 3;case"uint8":return 2;case"bool":return 9;case"int16":return 5;case"uint16":return 4;case"int32":return 6;case"uint32":return 12;case"float16":return 10;case"float32":return 1;case"float64":return 11;case"string":return 8;case"int64":return 7;case"uint64":return 13;default:throw new Error(`unsupported data type: ${i}`)}},Mr=i=>{switch(i){case 3:return"int8";case 2:return"uint8";case 9:return"bool";case 5:return"int16";case 4:return"uint16";case 6:return"int32";case 12:return"uint32";case 10:return"float16";case 1:return"float32";case 11:return"float64";case 8:return"string";case 7:return"int64";case 13:return"uint64";default:throw new Error(`unsupported data type: ${i}`)}},Ut=i=>[void 0,4,1,1,2,2,4,8,void 0,1,2,8,4,8,void 0,void 0,void 0][i],Cr=i=>{switch(i){case"float16":return typeof Float16Array<"u"&&Float16Array.from?Float16Array:Uint16Array;case"float32":return Float32Array;case"uint8":return Uint8Array;case"int8":return Int8Array;case"uint16":return Uint16Array;case"int16":return Int16Array;case"int32":return Int32Array;case"bool":return Uint8Array;case"float64":return Float64Array;case"uint32":return Uint32Array;case"int64":return BigInt64Array;case"uint64":return BigUint64Array;default:throw new Error(`unsupported type: ${i}`)}},Dr=i=>{switch(i){case"verbose":return 0;case"info":return 1;case"warning":return 2;case"error":return 3;case"fatal":return 4;default:throw new Error(`unsupported logging level: ${i}`)}},Fr=i=>i==="float32"||i==="float16"||i==="int32"||i==="int64"||i==="uint32"||i==="uint8"||i==="bool",Pr=i=>{switch(i){case"none":return 0;case"cpu":return 1;case"cpu-pinned":return 2;case"texture":return 3;case"gpu-buffer":return 4;default:throw new Error(`unsupported data location: ${i}`)}};var xr=async i=>{if(typeof i=="string")if(typeof process<"u"&&process.versions&&process.versions.node)try{return new Uint8Array(await(void 0)(i))}catch(c){if(c.code==="ERR_FS_FILE_TOO_LARGE"){let a=(void 0)(i),h=[];for await(let f of a)h.push(f);return new Uint8Array(Buffer.concat(h))}throw c}else{let c=await fetch(i);if(!c.ok)throw new Error(`failed to load external data file: ${i}`);let a=c.headers.get("Content-Length"),h=a?parseInt(a,10):0;if(h<1073741824)return new Uint8Array(await c.arrayBuffer());{if(!c.body)throw new Error(`failed to load external data file: ${i}, no response body.`);let f=c.body.getReader(),w;try{w=new ArrayBuffer(h)}catch(s){if(s instanceof RangeError){let S=Math.ceil(h/65536);w=new WebAssembly.Memory({initial:S,maximum:S}).buffer}else throw s}let g=0;for(;;){let{done:s,value:S}=await f.read();if(s)break;let x=S.byteLength;new Uint8Array(w,g,x).set(S),g+=x}return new Uint8Array(w,0,h)}}else return i instanceof Blob?new Uint8Array(await i.arrayBuffer()):i instanceof Uint8Array?i:new Uint8Array(i)};var cn=(i,c)=>{Q()._OrtInit(i,c)!==0&&j("Can\'t initialize onnxruntime.")},Lr=async i=>{cn(i.wasm.numThreads,Dr(i.logLevel))},Rr=async(i,c)=>{},Ye=new Map,dn=i=>{let c=Q(),a=c.stackSave();try{let h=c.stackAlloc(8);return c._OrtGetInputOutputCount(i,h,h+4)!==0&&j("Can\'t get session input/output count."),[c.HEAP32[h/4],c.HEAP32[h/4+1]]}finally{c.stackRestore(a)}},Lt=i=>{let c=Q(),a=c._malloc(i.byteLength);if(a===0)throw new Error(`Can\'t create a session. failed to allocate a buffer of size ${i.byteLength}.`);return c.HEAPU8.set(i,a),[a,i.byteLength]},Ir=async(i,c)=>{let a,h,f=Q();Array.isArray(i)?[a,h]=i:i.buffer===f.HEAPU8.buffer?[a,h]=[i.byteOffset,i.byteLength]:[a,h]=Lt(i);let w=0,g=0,s=0,S=[],x=[],H=[];try{if([g,S]=Tr(c),c?.externalData&&f.mountExternalData){let L=[];for(let W of c.externalData){let de=typeof W=="string"?W:W.path;L.push(xr(typeof W=="string"?W:W.data).then(pe=>{f.mountExternalData(de,pe)}))}await Promise.all(L)}w=await f._OrtCreateSession(a,h,g),w===0&&j("Can\'t create a session.");let[A,I]=dn(w),V=!!c?.enableGraphCapture,R=[],B=[],D=[];for(let L=0;L<A;L++){let W=f._OrtGetInputName(w,L);W===0&&j("Can\'t get an input name."),x.push(W),R.push(f.UTF8ToString(W))}for(let L=0;L<I;L++){let W=f._OrtGetOutputName(w,L);W===0&&j("Can\'t get an output name."),H.push(W);let de=f.UTF8ToString(W);B.push(de)}let T=null;return Ye.set(w,[w,x,H,T,V,!1]),[w,R,B]}catch(A){throw x.forEach(I=>f._OrtFree(I)),H.forEach(I=>f._OrtFree(I)),s!==0&&f._OrtReleaseBinding(s),w!==0&&f._OrtReleaseSession(w),A}finally{f._free(a),g!==0&&f._OrtReleaseSessionOptions(g),S.forEach(A=>f._free(A)),f.unmountExternalData?.()}},Br=i=>{let c=Q(),a=Ye.get(i);if(!a)throw new Error(`cannot release session. invalid session id: ${i}`);let[h,f,w,g,s]=a;g&&(s&&c._OrtClearBoundOutputs(g.handle),c._OrtReleaseBinding(g.handle)),c.jsepOnReleaseSession?.(i),f.forEach(S=>c._OrtFree(S)),w.forEach(S=>c._OrtFree(S)),c._OrtReleaseSession(h),Ye.delete(i)},Ur=(i,c,a,h,f,w=!1)=>{if(!i){c.push(0);return}let g=Q(),s=i[0],S=i[1],x=i[3],H,A;if(s==="string"&&x==="gpu-buffer")throw new Error("String tensor is not supported on GPU.");if(w&&x!=="gpu-buffer")throw new Error(`External buffer must be provided for input/output index ${f} when enableGraphCapture is true.`);if(x==="gpu-buffer"){let R=i[2].gpuBuffer,B=Ut(xt(s));A=S.reduce((T,L)=>T*L,1)*B;let D=g.jsepRegisterBuffer;if(!D)throw new Error(\'Tensor location "gpu-buffer" is not supported without using WebGPU.\');H=D(h,f,R,A)}else{let R=i[2];if(Array.isArray(R)){A=4*R.length,H=g._malloc(A),a.push(H);let B=H/4;for(let D=0;D<R.length;D++){if(typeof R[D]!="string")throw new TypeError(`tensor data at index ${D} is not a string`);g.HEAPU32[B++]=Y(R[D],a)}}else A=R.byteLength,H=g._malloc(A),a.push(H),g.HEAPU8.set(new Uint8Array(R.buffer,R.byteOffset,A),H)}let I=g.stackSave(),V=g.stackAlloc(4*S.length);try{let R=V/4;S.forEach(D=>g.HEAP32[R++]=D);let B=g._OrtCreateTensor(xt(s),H,A,V,S.length,Pr(x));B===0&&j(`Can\'t create tensor for input/output. session=${h}, index=${f}.`),c.push(B)}finally{g.stackRestore(I)}},kr=async(i,c,a,h,f,w)=>{let g=Q(),s=Ye.get(i);if(!s)throw new Error(`cannot run inference. invalid session id: ${i}`);let S=s[0],x=s[1],H=s[2],A=s[3],I=s[4],V=s[5],R=c.length,B=h.length,D=0,T=[],L=[],W=[],de=[],pe=g.stackSave(),Z=g.stackAlloc(R*4),_=g.stackAlloc(R*4),J=g.stackAlloc(B*4),Pe=g.stackAlloc(B*4);try{[D,T]=Ar(w);for(let F=0;F<R;F++)Ur(a[F],L,de,i,c[F],I);for(let F=0;F<B;F++)Ur(f[F],W,de,i,R+h[F],I);let le=Z/4,Ie=_/4,ne=J/4,X=Pe/4;for(let F=0;F<R;F++)g.HEAPU32[le++]=L[F],g.HEAPU32[Ie++]=x[c[F]];for(let F=0;F<B;F++)g.HEAPU32[ne++]=W[F],g.HEAPU32[X++]=H[h[F]];g.jsepOnRunStart?.(S);let we;we=await g._OrtRun(S,_,Z,R,Pe,B,J,D),we!==0&&j("failed to call OrtRun().");let me=[];for(let F=0;F<B;F++){let ie=g.HEAPU32[J/4+F];if(ie===W[F]){me.push(f[F]);continue}let xe=g.stackSave(),ce=g.stackAlloc(4*4),be=!1,ae,K=0;try{g._OrtGetTensorData(ie,ce,ce+4,ce+8,ce+12)!==0&&j(`Can\'t access output tensor data on index ${F}.`);let Oe=ce/4,Ue=g.HEAPU32[Oe++];K=g.HEAPU32[Oe++];let ve=g.HEAPU32[Oe++],Ae=g.HEAPU32[Oe++],_e=[];for(let te=0;te<Ae;te++)_e.push(g.HEAPU32[ve/4+te]);g._OrtFree(ve);let ge=_e.reduce((te,re)=>te*re,1);ae=Mr(Ue);let Be=A?.outputPreferredLocations[h[F]];if(ae==="string"){if(Be==="gpu-buffer")throw new Error("String tensor is not supported on GPU.");let te=[],re=K/4;for(let ue=0;ue<ge;ue++){let Ee=g.HEAPU32[re++],Se=ue===ge-1?void 0:g.HEAPU32[re]-Ee;te.push(g.UTF8ToString(Ee,Se))}me.push([ae,_e,te,"cpu"])}else if(Be==="gpu-buffer"&&ge>0){let te=g.jsepGetBuffer;if(!te)throw new Error(\'preferredLocation "gpu-buffer" is not supported without using WebGPU.\');let re=te(K),ue=Ut(Ue);if(ue===void 0||!Fr(ae))throw new Error(`Unsupported data type: ${ae}`);be=!0,me.push([ae,_e,{gpuBuffer:re,download:g.jsepCreateDownloader(re,ge*ue,ae),dispose:()=>{g._OrtReleaseTensor(ie)}},"gpu-buffer"])}else{let te=Cr(ae),re=new te(ge);new Uint8Array(re.buffer,re.byteOffset,re.byteLength).set(g.HEAPU8.subarray(K,K+re.byteLength)),me.push([ae,_e,re,"cpu"])}}finally{g.stackRestore(xe),ae==="string"&&K&&g._free(K),be||g._OrtReleaseTensor(ie)}}return A&&!I&&(g._OrtClearBoundOutputs(A.handle),Ye.set(i,[S,x,H,A,I,!1])),me}finally{g.stackRestore(pe),L.forEach(le=>g._OrtReleaseTensor(le)),W.forEach(le=>g._OrtReleaseTensor(le)),de.forEach(le=>g._free(le)),D!==0&&g._OrtReleaseRunOptions(D),T.forEach(le=>g._free(le))}},Wr=i=>{let c=Q(),a=Ye.get(i);if(!a)throw new Error("invalid session id");let h=a[0],f=c._OrtEndProfiling(h);f===0&&j("Can\'t get an profile file name."),c._OrtFree(f)},Nr=i=>{let c=[];for(let a of i){let h=a[2];!Array.isArray(h)&&"buffer"in h&&c.push(h.buffer)}return c};self.onmessage=i=>{let{type:c,in:a}=i.data;try{switch(c){case"init-wasm":Sr(a.wasm).then(()=>{Lr(a).then(()=>{postMessage({type:c})},h=>{postMessage({type:c,err:h})})},h=>{postMessage({type:c,err:h})});break;case"init-ep":{let{epName:h,env:f}=a;Rr(f,h).then(()=>{postMessage({type:c})},w=>{postMessage({type:c,err:w})});break}case"copy-from":{let{buffer:h}=a,f=Lt(h);postMessage({type:c,out:f});break}case"create":{let{model:h,options:f}=a;Ir(h,f).then(w=>{postMessage({type:c,out:w})},w=>{postMessage({type:c,err:w})});break}case"release":Br(a),postMessage({type:c});break;case"run":{let{sessionId:h,inputIndices:f,inputs:w,outputIndices:g,options:s}=a;kr(h,f,w,g,new Array(g.length).fill(null),s).then(S=>{S.some(x=>x[3]!=="cpu")?postMessage({type:c,err:"Proxy does not support non-cpu tensor location."}):postMessage({type:c,out:S},Nr([...w,...S]))},S=>{postMessage({type:c,err:S})});break}case"end-profiling":Wr(a),postMessage({type:c});break;default:}}catch(h){postMessage({type:c,err:h})}};})();\n'}),_r,gt$1,yn,Do,Lo,ca$1,pa$1,Vr,Wr,Tg,Eo,od$1,id$1,ad$1,sd$1,ud$1,ld$1,fd$1,da$1=L$1(()=>{var d;Ot$1(),rd$1(),Ur(),_r=()=>!!Z.wasm.proxy&&typeof document<"u",yn=!1,Do=!1,Lo=!1,pa$1=new Map,Vr=(g,b)=>{let et=pa$1.get(g);et?et.push(b):pa$1.set(g,[b])},Wr=()=>{if(yn||!Do||Lo||!gt$1)throw new Error("worker not ready")},Tg=g=>{switch(g.data.type){case"init-wasm":yn=!1,g.data.err?(Lo=!0,ca$1[1](g.data.err)):(Do=!0,ca$1[0]());break;case"init-ep":case"copy-from":case"create":case"release":case"run":case"end-profiling":{let b=pa$1.get(g.data.type);g.data.err?b.shift()[1](g.data.err):b.shift()[0](g.data.out);break}}},Eo=typeof document<"u"?(d=document==null?void 0:document.currentScript)==null?void 0:d.src:void 0,od$1=async()=>{if(!Do){if(yn)throw new Error("multiple calls to 'initWasm()' detected.");if(Lo)throw new Error("previous call to 'initWasm()' failed.");if(yn=!0,_r())return Z.wasm.wasmPaths===void 0&&Eo&&Eo.indexOf("blob:")!==0&&(Z.wasm.wasmPaths=Eo.substr(0,+Eo.lastIndexOf("/")+1)),new Promise((g,b)=>{gt$1==null||gt$1.terminate();let et=URL.createObjectURL(new Blob([nd$1()],{type:"text/javascript"}));gt$1=new Worker(et,{name:"ort-wasm-proxy-worker"}),gt$1.onerror=at=>b(at),gt$1.onmessage=Tg,URL.revokeObjectURL(et),ca$1=[g,b];let st={type:"init-wasm",in:Z};gt$1.postMessage(st)});try{await Mp$1(Z.wasm),await Xp$1(Z),Do=!0}catch(g){throw Lo=!0,g}finally{yn=!1}}},id$1=async g=>{if(_r())return Wr(),new Promise((b,et)=>{Vr("init-ep",[b,et]);let st={type:"init-ep",in:{epName:g,env:Z}};gt$1.postMessage(st)});await Kp$1(Z,g)},ad$1=async g=>_r()?(Wr(),new Promise((b,et)=>{Vr("copy-from",[b,et]);let st={type:"copy-from",in:{buffer:g}};gt$1.postMessage(st,[g.buffer])})):fa$1(g),sd$1=async(g,b)=>{if(_r()){if(b!=null&&b.preferredOutputLocation)throw new Error('session option "preferredOutputLocation" is not supported for proxy.');return Wr(),new Promise((et,st)=>{Vr("create",[et,st]);let at={type:"create",in:{model:g,options:{...b}}},vt=[];g instanceof Uint8Array&&vt.push(g.buffer),gt$1.postMessage(at,vt)})}else return Jp$1(g,b)},ud$1=async g=>{if(_r())return Wr(),new Promise((b,et)=>{Vr("release",[b,et]);let st={type:"release",in:g};gt$1.postMessage(st)});Zp$1(g)},ld$1=async(g,b,et,st,at,vt)=>{if(_r()){if(et.some(Tt=>Tt[3]!=="cpu"))throw new Error("input tensor on GPU is not supported for proxy.");if(at.some(Tt=>Tt))throw new Error("pre-allocated output tensor is not supported for proxy.");return Wr(),new Promise((Tt,Ct)=>{Vr("run",[Tt,Ct]);let pt=et,wt={type:"run",in:{sessionId:g,inputIndices:b,inputs:pt,outputIndices:st,options:vt}};gt$1.postMessage(wt,td$1(pt))})}else return Qp$1(g,b,et,st,at,vt)},fd$1=async g=>{if(_r())return Wr(),new Promise((b,et)=>{Vr("end-profiling",[b,et]);let st={type:"end-profiling",in:g};gt$1.postMessage(st)});ed$1(g)}}),cd$1,xg,Co$1,pd$1=L$1(()=>{Ot$1(),da$1(),ua$1(),la$1(),cd$1=(d,g)=>{switch(d.location){case"cpu":return[d.type,d.dims,d.data,"cpu"];case"gpu-buffer":return[d.type,d.dims,{gpuBuffer:d.gpuBuffer},"gpu-buffer"];default:throw new Error(`invalid data location: ${d.location} for ${g()}`)}},xg=d=>{switch(d[3]){case"cpu":return new Me(d[0],d[2],d[1]);case"gpu-buffer":{let g=d[0];if(!Po(g))throw new Error(`not supported data type: ${g} for deserializing GPU tensor`);let{gpuBuffer:b,download:et,dispose:st}=d[2];return Me.fromGpuBuffer(b,{dataType:g,dims:d[1],download:et,dispose:st})}default:throw new Error(`invalid data location: ${d[3]}`)}},Co$1=class{async fetchModelAndCopyToWasmMemory(d){return ad$1(await gn(d))}async loadModel(d,g){lr$1();let b;typeof d=="string"?typeof process<"u"&&process.versions&&process.versions.node?b=await gn(d):b=await this.fetchModelAndCopyToWasmMemory(d):b=d,[this.sessionId,this.inputNames,this.outputNames]=await sd$1(b,g),fr$1()}async dispose(){return ud$1(this.sessionId)}async run(d,g,b){lr$1();let et=[],st=[];Object.entries(d).forEach($t=>{let Lt=$t[0],jt=$t[1],Ft=this.inputNames.indexOf(Lt);if(Ft===-1)throw new Error(`invalid input '${Lt}'`);et.push(jt),st.push(Ft)});let at=[],vt=[];Object.entries(g).forEach($t=>{let Lt=$t[0],jt=$t[1],Ft=this.outputNames.indexOf(Lt);if(Ft===-1)throw new Error(`invalid output '${Lt}'`);at.push(jt),vt.push(Ft)});let Tt=et.map(($t,Lt)=>cd$1($t,()=>`input "${this.inputNames[st[Lt]]}"`)),Ct=at.map(($t,Lt)=>$t?cd$1($t,()=>`output "${this.outputNames[vt[Lt]]}"`):null),pt=await ld$1(this.sessionId,st,Tt,vt,Ct,b),wt={};for(let $t=0;$t<pt.length;$t++)wt[this.outputNames[vt[$t]]]=at[$t]??xg(pt[$t]);return fr$1(),wt}startProfiling(){}endProfiling(){fd$1(this.sessionId)}}}),wg,Fo,dd$1=L$1(()=>{Ot$1(),da$1(),pd$1(),wg=()=>{if((typeof Z.wasm.initTimeout!="number"||Z.wasm.initTimeout<0)&&(Z.wasm.initTimeout=0),typeof Z.wasm.simd!="boolean"&&(Z.wasm.simd=!0),typeof Z.wasm.proxy!="boolean"&&(Z.wasm.proxy=!1),typeof Z.wasm.trace!="boolean"&&(Z.wasm.trace=!1),typeof Z.wasm.numThreads!="number"||!Number.isInteger(Z.wasm.numThreads)||Z.wasm.numThreads<=0){(typeof self<"u"&&!self.crossOriginIsolated||typeof process<"u"&&process.versions&&process.versions.node)&&(Z.wasm.numThreads=1);let d=typeof navigator>"u"?(void 0)().length:navigator.hardwareConcurrency;Z.wasm.numThreads=Math.min(4,Math.ceil((d||1)/2))}},Fo=class{async init(d){wg(),await od$1(),await id$1(d)}async createInferenceSessionHandler(d,g){let b=new Co$1;return await b.loadModel(d,g),Promise.resolve(b)}}}),hd$1={};Sr(hd$1,{wasmBackend:()=>vg});var vg,md$1=L$1(()=>{dd$1(),vg=new Fo});Ot$1();Ot$1();Ot$1();var Ts$1="1.18.0",jO=qo;{let d=(Op$1(),ar(_p$1)).onnxjsBackend;Pr$1("webgl",d,-10)}{let d=(md$1(),ar(hd$1)).wasmBackend;Pr$1("cpu",d,10),Pr$1("wasm",d,10)}Object.defineProperty(Z.versions,"web",{value:Ts$1,enumerable:!0});/*! Bundled license information:

long/index.js:
  (**
   * @license
   * Copyright 2009 The Closure Library Authors
   * Copyright 2020 Daniel Wirtz / The long.js Authors.
   *
   * Licensed under the Apache License, Version 2.0 (the "License");
   * you may not use this file except in compliance with the License.
   * You may obtain a copy of the License at
   *
   *     http://www.apache.org/licenses/LICENSE-2.0
   *
   * Unless required by applicable law or agreed to in writing, software
   * distributed under the License is distributed on an "AS IS" BASIS,
   * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
   * See the License for the specific language governing permissions and
   * limitations under the License.
   *
   * SPDX-License-Identifier: Apache-2.0
   *)
*/const ort_cpu=Object.freeze(Object.defineProperty({__proto__:null,get InferenceSession(){return Pd$1},get TRACE(){return ls$1},get TRACE_FUNC_BEGIN(){return lr$1},get TRACE_FUNC_END(){return fr$1},get Tensor(){return Me},get TrainingSession(){return Dd$1},default:jO,get env(){return Z},get registerBackend(){return Pr$1}},Symbol.toStringTag,{value:"Module"}));/*!
 * ONNX Runtime Web v1.18.0
 * Copyright (c) Microsoft Corporation. All rights reserved.
 * Licensed under the MIT License.
 */var Oi=Object.defineProperty,nc=Object.getOwnPropertyDescriptor,ic=Object.getOwnPropertyNames,oc=Object.prototype.hasOwnProperty,j=(d,g)=>()=>(d&&(g=d(d=0)),g),Er=(d,g)=>()=>(g||d((g={exports:{}}).exports,g),g.exports),kr=(d,g)=>{for(var b in g)Oi(d,b,{get:g[b],enumerable:!0})},ac=(d,g,b,et)=>{if(g&&typeof g=="object"||typeof g=="function")for(let st of ic(g))!oc.call(d,st)&&st!==b&&Oi(d,st,{get:()=>g[st],enumerable:!(et=nc(g,st))||et.enumerable});return d},sr=d=>ac(Oi({},"__esModule",{value:!0}),d),kn,ur,lr,sc,On,Pn=j(()=>{kn=new Map,ur=[],lr=(d,g,b)=>{if(g&&typeof g.init=="function"&&typeof g.createInferenceSessionHandler=="function"){let et=kn.get(d);if(et===void 0)kn.set(d,{backend:g,priority:b});else{if(et.priority>b)return;if(et.priority===b&&et.backend!==g)throw new Error(`cannot register backend "${d}" using priority ${b}`)}if(b>=0){let st=ur.indexOf(d);st!==-1&&ur.splice(st,1);for(let at=0;at<ur.length;at++)if(kn.get(ur[at]).priority<=b){ur.splice(at,0,d);return}ur.push(d)}return}throw new TypeError("not a valid backend")},sc=async d=>{let g=kn.get(d);if(!g)return"backend not found.";if(g.initialized)return g.backend;if(g.aborted)return g.error;{let b=!!g.initPromise;try{return b||(g.initPromise=g.backend.init(d)),await g.initPromise,g.initialized=!0,g.backend}catch(et){return b||(g.error=`${et}`,g.aborted=!0),g.error}finally{delete g.initPromise}}},On=async d=>{let g=d.executionProviders||[],b=g.map(Ct=>typeof Ct=="string"?Ct:Ct.name),et=b.length===0?ur:b,st,at=[],vt=new Set;for(let Ct of et){let pt=await sc(Ct);typeof pt=="string"?at.push({name:Ct,err:pt}):(st||(st=pt),st===pt&&vt.add(Ct))}if(!st)throw new Error(`no available backend found. ERR: ${at.map(Ct=>`[${Ct.name}] ${Ct.err}`).join(", ")}`);for(let{name:Ct,err:pt}of at)b.includes(Ct)&&console.warn(`removing requested execution provider "${Ct}" from session options because it is not available: ${pt}`);let Tt=g.filter(Ct=>vt.has(typeof Ct=="string"?Ct:Ct.name));return[st,new Proxy(d,{get:(Ct,pt)=>pt==="executionProviders"?Tt:Reflect.get(Ct,pt)})]}}),ra=j(()=>{Pn()}),na,ia=j(()=>{na="1.18.0"}),oa,gt,Pi=j(()=>{ia(),oa="warning",gt={wasm:{},webgl:{},webgpu:{},versions:{common:na},set logLevel(d){if(d!==void 0){if(typeof d!="string"||["verbose","info","warning","error","fatal"].indexOf(d)===-1)throw new Error(`Unsupported logging level: ${d}`);oa=d}},get logLevel(){return oa}},Object.defineProperty(gt,"logLevel",{enumerable:!0})}),ke,aa=j(()=>{Pi(),ke=gt}),sa,ua,la=j(()=>{sa=(d,g)=>{let b=typeof document<"u"?document.createElement("canvas"):new OffscreenCanvas(1,1);b.width=d.dims[3],b.height=d.dims[2];let et=b.getContext("2d");if(et!=null){let st,at;(g==null?void 0:g.tensorLayout)!==void 0&&g.tensorLayout==="NHWC"?(st=d.dims[2],at=d.dims[3]):(st=d.dims[3],at=d.dims[2]);let vt=(g==null?void 0:g.format)!==void 0?g.format:"RGB",Tt=g==null?void 0:g.norm,Ct,pt;Tt===void 0||Tt.mean===void 0?Ct=[255,255,255,255]:typeof Tt.mean=="number"?Ct=[Tt.mean,Tt.mean,Tt.mean,Tt.mean]:(Ct=[Tt.mean[0],Tt.mean[1],Tt.mean[2],0],Tt.mean[3]!==void 0&&(Ct[3]=Tt.mean[3])),Tt===void 0||Tt.bias===void 0?pt=[0,0,0,0]:typeof Tt.bias=="number"?pt=[Tt.bias,Tt.bias,Tt.bias,Tt.bias]:(pt=[Tt.bias[0],Tt.bias[1],Tt.bias[2],0],Tt.bias[3]!==void 0&&(pt[3]=Tt.bias[3]));let wt=at*st,$t=0,Lt=wt,jt=wt*2,Ft=-1;vt==="RGBA"?($t=0,Lt=wt,jt=wt*2,Ft=wt*3):vt==="RGB"?($t=0,Lt=wt,jt=wt*2):vt==="RBG"&&($t=0,jt=wt,Lt=wt*2);for(let Gt=0;Gt<at;Gt++)for(let Ht=0;Ht<st;Ht++){let qt=(d.data[$t++]-pt[0])*Ct[0],Kt=(d.data[Lt++]-pt[1])*Ct[1],rr=(d.data[jt++]-pt[2])*Ct[2],ir=Ft===-1?255:(d.data[Ft++]-pt[3])*Ct[3];et.fillStyle="rgba("+qt+","+Kt+","+rr+","+ir+")",et.fillRect(Ht,Gt,1,1)}if("toDataURL"in b)return b.toDataURL();throw new Error("toDataURL is not supported")}else throw new Error("Can not access image data")},ua=(d,g)=>{let b=typeof document<"u"?document.createElement("canvas").getContext("2d"):new OffscreenCanvas(1,1).getContext("2d"),et;if(b!=null){let st,at,vt;(g==null?void 0:g.tensorLayout)!==void 0&&g.tensorLayout==="NHWC"?(st=d.dims[2],at=d.dims[1],vt=d.dims[3]):(st=d.dims[3],at=d.dims[2],vt=d.dims[1]);let Tt=g!==void 0&&g.format!==void 0?g.format:"RGB",Ct=g==null?void 0:g.norm,pt,wt;Ct===void 0||Ct.mean===void 0?pt=[255,255,255,255]:typeof Ct.mean=="number"?pt=[Ct.mean,Ct.mean,Ct.mean,Ct.mean]:(pt=[Ct.mean[0],Ct.mean[1],Ct.mean[2],255],Ct.mean[3]!==void 0&&(pt[3]=Ct.mean[3])),Ct===void 0||Ct.bias===void 0?wt=[0,0,0,0]:typeof Ct.bias=="number"?wt=[Ct.bias,Ct.bias,Ct.bias,Ct.bias]:(wt=[Ct.bias[0],Ct.bias[1],Ct.bias[2],0],Ct.bias[3]!==void 0&&(wt[3]=Ct.bias[3]));let $t=at*st;if(g!==void 0&&(g.format!==void 0&&vt===4&&g.format!=="RGBA"||vt===3&&g.format!=="RGB"&&g.format!=="BGR"))throw new Error("Tensor format doesn't match input tensor dims");let Lt=4,jt=0,Ft=1,Gt=2,Ht=3,qt=0,Kt=$t,rr=$t*2,ir=-1;Tt==="RGBA"?(qt=0,Kt=$t,rr=$t*2,ir=$t*3):Tt==="RGB"?(qt=0,Kt=$t,rr=$t*2):Tt==="RBG"&&(qt=0,rr=$t,Kt=$t*2),et=b.createImageData(st,at);for(let or=0;or<at*st;jt+=Lt,Ft+=Lt,Gt+=Lt,Ht+=Lt,or++)et.data[jt]=(d.data[qt++]-wt[0])*pt[0],et.data[Ft]=(d.data[Kt++]-wt[1])*pt[1],et.data[Gt]=(d.data[rr++]-wt[2])*pt[2],et.data[Ht]=ir===-1?255:(d.data[ir++]-wt[3])*pt[3]}else throw new Error("Can not access image data");return et}}),Ri,da,ca,pa,ma,fa=j(()=>{Rn(),Ri=(d,g)=>{if(d===void 0)throw new Error("Image buffer must be defined");if(g.height===void 0||g.width===void 0)throw new Error("Image height and width must be defined");if(g.tensorLayout==="NHWC")throw new Error("NHWC Tensor layout is not supported yet");let{height:b,width:et}=g,st=g.norm??{mean:255,bias:0},at,vt;typeof st.mean=="number"?at=[st.mean,st.mean,st.mean,st.mean]:at=[st.mean[0],st.mean[1],st.mean[2],st.mean[3]??255],typeof st.bias=="number"?vt=[st.bias,st.bias,st.bias,st.bias]:vt=[st.bias[0],st.bias[1],st.bias[2],st.bias[3]??0];let Tt=g.format!==void 0?g.format:"RGBA",Ct=g.tensorFormat!==void 0&&g.tensorFormat!==void 0?g.tensorFormat:"RGB",pt=b*et,wt=Ct==="RGBA"?new Float32Array(pt*4):new Float32Array(pt*3),$t=4,Lt=0,jt=1,Ft=2,Gt=3,Ht=0,qt=pt,Kt=pt*2,rr=-1;Tt==="RGB"&&($t=3,Lt=0,jt=1,Ft=2,Gt=-1),Ct==="RGBA"?rr=pt*3:Ct==="RBG"?(Ht=0,Kt=pt,qt=pt*2):Ct==="BGR"&&(Kt=0,qt=pt,Ht=pt*2);for(let ir=0;ir<pt;ir++,Lt+=$t,Ft+=$t,jt+=$t,Gt+=$t)wt[Ht++]=(d[Lt]+vt[0])/at[0],wt[qt++]=(d[jt]+vt[1])/at[1],wt[Kt++]=(d[Ft]+vt[2])/at[2],rr!==-1&&Gt!==-1&&(wt[rr++]=(d[Gt]+vt[3])/at[3]);return Ct==="RGBA"?new ot("float32",wt,[1,4,b,et]):new ot("float32",wt,[1,3,b,et])},da=async(d,g)=>{let b=typeof HTMLImageElement<"u"&&d instanceof HTMLImageElement,et=typeof ImageData<"u"&&d instanceof ImageData,st=typeof ImageBitmap<"u"&&d instanceof ImageBitmap,at=typeof d=="string",vt,Tt=g??{},Ct=()=>{if(typeof document<"u")return document.createElement("canvas");if(typeof OffscreenCanvas<"u")return new OffscreenCanvas(1,1);throw new Error("Canvas is not supported")},pt=wt=>wt instanceof HTMLCanvasElement||wt instanceof OffscreenCanvas?wt.getContext("2d"):null;if(b){let wt=Ct();wt.width=d.width,wt.height=d.height;let $t=pt(wt);if($t!=null){let Lt=d.height,jt=d.width;if(g!==void 0&&g.resizedHeight!==void 0&&g.resizedWidth!==void 0&&(Lt=g.resizedHeight,jt=g.resizedWidth),g!==void 0){if(Tt=g,g.tensorFormat!==void 0)throw new Error("Image input config format must be RGBA for HTMLImageElement");Tt.tensorFormat="RGBA",Tt.height=Lt,Tt.width=jt}else Tt.tensorFormat="RGBA",Tt.height=Lt,Tt.width=jt;$t.drawImage(d,0,0),vt=$t.getImageData(0,0,jt,Lt).data}else throw new Error("Can not access image data")}else if(et){let wt,$t;if(g!==void 0&&g.resizedWidth!==void 0&&g.resizedHeight!==void 0?(wt=g.resizedHeight,$t=g.resizedWidth):(wt=d.height,$t=d.width),g!==void 0&&(Tt=g),Tt.format="RGBA",Tt.height=wt,Tt.width=$t,g!==void 0){let Lt=Ct();Lt.width=$t,Lt.height=wt;let jt=pt(Lt);if(jt!=null)jt.putImageData(d,0,0),vt=jt.getImageData(0,0,$t,wt).data;else throw new Error("Can not access image data")}else vt=d.data}else if(st){if(g===void 0)throw new Error("Please provide image config with format for Imagebitmap");let wt=Ct();wt.width=d.width,wt.height=d.height;let $t=pt(wt);if($t!=null){let Lt=d.height,jt=d.width;return $t.drawImage(d,0,0,jt,Lt),vt=$t.getImageData(0,0,jt,Lt).data,Tt.height=Lt,Tt.width=jt,Ri(vt,Tt)}else throw new Error("Can not access image data")}else{if(at)return new Promise((wt,$t)=>{let Lt=Ct(),jt=pt(Lt);if(!d||!jt)return $t();let Ft=new Image;Ft.crossOrigin="Anonymous",Ft.src=d,Ft.onload=()=>{Lt.width=Ft.width,Lt.height=Ft.height,jt.drawImage(Ft,0,0,Lt.width,Lt.height);let Gt=jt.getImageData(0,0,Lt.width,Lt.height);Tt.height=Lt.height,Tt.width=Lt.width,wt(Ri(Gt.data,Tt))}});throw new Error("Input data provided is not supported - aborted tensor creation")}if(vt!==void 0)return Ri(vt,Tt);throw new Error("Input data provided is not supported - aborted tensor creation")},ca=(d,g)=>{let{width:b,height:et,download:st,dispose:at}=g,vt=[1,et,b,4];return new ot({location:"texture",type:"float32",texture:d,dims:vt,download:st,dispose:at})},pa=(d,g)=>{let{dataType:b,dims:et,download:st,dispose:at}=g;return new ot({location:"gpu-buffer",type:b??"float32",gpuBuffer:d,dims:et,download:st,dispose:at})},ma=(d,g,b)=>new ot({location:"cpu-pinned",type:d,data:g,dims:b??[g.length]})}),dr,Qr,ha,ga,ya=j(()=>{dr=new Map([["float32",Float32Array],["uint8",Uint8Array],["int8",Int8Array],["uint16",Uint16Array],["int16",Int16Array],["int32",Int32Array],["bool",Uint8Array],["float64",Float64Array],["uint32",Uint32Array]]),Qr=new Map([[Float32Array,"float32"],[Uint8Array,"uint8"],[Int8Array,"int8"],[Uint16Array,"uint16"],[Int16Array,"int16"],[Int32Array,"int32"],[Float64Array,"float64"],[Uint32Array,"uint32"]]),ha=!1,ga=()=>{if(!ha){ha=!0;let d=typeof BigInt64Array<"u"&&BigInt64Array.from,g=typeof BigUint64Array<"u"&&BigUint64Array.from,b=typeof Float16Array<"u"&&Float16Array.from;d&&(dr.set("int64",BigInt64Array),Qr.set(BigInt64Array,"int64")),g&&(dr.set("uint64",BigUint64Array),Qr.set(BigUint64Array,"uint64")),b?(dr.set("float16",Float16Array),Qr.set(Float16Array,"float16")):dr.set("float16",Uint16Array)}}}),ba,va,wa=j(()=>{Rn(),ba=d=>{let g=1;for(let b=0;b<d.length;b++){let et=d[b];if(typeof et!="number"||!Number.isSafeInteger(et))throw new TypeError(`dims[${b}] must be an integer, got: ${et}`);if(et<0)throw new RangeError(`dims[${b}] must be a non-negative integer, got: ${et}`);g*=et}return g},va=(d,g)=>{switch(d.location){case"cpu":return new ot(d.type,d.data,g);case"cpu-pinned":return new ot({location:"cpu-pinned",data:d.data,type:d.type,dims:g});case"texture":return new ot({location:"texture",texture:d.texture,type:d.type,dims:g});case"gpu-buffer":return new ot({location:"gpu-buffer",gpuBuffer:d.gpuBuffer,type:d.type,dims:g});default:throw new Error(`tensorReshape: tensor location ${d.location} is not supported`)}}}),ot,Rn=j(()=>{la(),fa(),ya(),wa(),ot=class{constructor(d,g,b){ga();let et,st;if(typeof d=="object"&&"location"in d)switch(this.dataLocation=d.location,et=d.type,st=d.dims,d.location){case"cpu-pinned":{let vt=dr.get(et);if(!vt)throw new TypeError(`unsupported type "${et}" to create tensor from pinned buffer`);if(!(d.data instanceof vt))throw new TypeError(`buffer should be of type ${vt.name}`);this.cpuData=d.data;break}case"texture":{if(et!=="float32")throw new TypeError(`unsupported type "${et}" to create tensor from texture`);this.gpuTextureData=d.texture,this.downloader=d.download,this.disposer=d.dispose;break}case"gpu-buffer":{if(et!=="float32"&&et!=="float16"&&et!=="int32"&&et!=="int64"&&et!=="uint32"&&et!=="uint8"&&et!=="bool")throw new TypeError(`unsupported type "${et}" to create tensor from gpu buffer`);this.gpuBufferData=d.gpuBuffer,this.downloader=d.download,this.disposer=d.dispose;break}default:throw new Error(`Tensor constructor: unsupported location '${this.dataLocation}'`)}else{let vt,Tt;if(typeof d=="string")if(et=d,Tt=b,d==="string"){if(!Array.isArray(g))throw new TypeError("A string tensor's data must be a string array.");vt=g}else{let Ct=dr.get(d);if(Ct===void 0)throw new TypeError(`Unsupported tensor type: ${d}.`);if(Array.isArray(g)){if(d==="float16"&&Ct===Uint16Array)throw new TypeError("Creating a float16 tensor from number array is not supported. Please use Uint16Array as data.");d==="uint64"||d==="int64"?vt=Ct.from(g,BigInt):vt=Ct.from(g)}else if(g instanceof Ct)vt=g;else throw new TypeError(`A ${et} tensor's data must be type of ${Ct}`)}else if(Tt=g,Array.isArray(d)){if(d.length===0)throw new TypeError("Tensor type cannot be inferred from an empty array.");let Ct=typeof d[0];if(Ct==="string")et="string",vt=d;else if(Ct==="boolean")et="bool",vt=Uint8Array.from(d);else throw new TypeError(`Invalid element type of data array: ${Ct}.`)}else{let Ct=Qr.get(d.constructor);if(Ct===void 0)throw new TypeError(`Unsupported type for tensor data: ${d.constructor}.`);et=Ct,vt=d}if(Tt===void 0)Tt=[vt.length];else if(!Array.isArray(Tt))throw new TypeError("A tensor's dims must be a number array");st=Tt,this.cpuData=vt,this.dataLocation="cpu"}let at=ba(st);if(this.cpuData&&at!==this.cpuData.length)throw new Error(`Tensor's size(${at}) does not match data length(${this.cpuData.length}).`);this.type=et,this.dims=st,this.size=at}static async fromImage(d,g){return da(d,g)}static fromTexture(d,g){return ca(d,g)}static fromGpuBuffer(d,g){return pa(d,g)}static fromPinnedBuffer(d,g,b){return ma(d,g,b)}toDataURL(d){return sa(this,d)}toImageData(d){return ua(this,d)}get data(){if(this.ensureValid(),!this.cpuData)throw new Error("The data is not on CPU. Use `getData()` to download GPU data to CPU, or use `texture` or `gpuBuffer` property to access the GPU data directly.");return this.cpuData}get location(){return this.dataLocation}get texture(){if(this.ensureValid(),!this.gpuTextureData)throw new Error("The data is not stored as a WebGL texture.");return this.gpuTextureData}get gpuBuffer(){if(this.ensureValid(),!this.gpuBufferData)throw new Error("The data is not stored as a WebGPU buffer.");return this.gpuBufferData}async getData(d){switch(this.ensureValid(),this.dataLocation){case"cpu":case"cpu-pinned":return this.data;case"texture":case"gpu-buffer":{if(!this.downloader)throw new Error("The current tensor is not created with a specified data downloader.");if(this.isDownloading)throw new Error("The current tensor is being downloaded.");try{this.isDownloading=!0;let g=await this.downloader();return this.downloader=void 0,this.dataLocation="cpu",this.cpuData=g,d&&this.disposer&&(this.disposer(),this.disposer=void 0),g}finally{this.isDownloading=!1}}default:throw new Error(`cannot get data from location: ${this.dataLocation}`)}}dispose(){if(this.isDownloading)throw new Error("The current tensor is being downloaded.");this.disposer&&(this.disposer(),this.disposer=void 0),this.cpuData=void 0,this.gpuTextureData=void 0,this.gpuBufferData=void 0,this.downloader=void 0,this.isDownloading=void 0,this.dataLocation="none"}ensureValid(){if(this.dataLocation==="none")throw new Error("The tensor is disposed.")}reshape(d){if(this.ensureValid(),this.downloader||this.disposer)throw new Error("Cannot reshape a tensor that owns GPU resource.");return va(this,d)}}}),tt,zn=j(()=>{Rn(),tt=ot}),Bn,$a,yt,ut,zi=j(()=>{Pi(),Bn=(d,g)=>{(typeof gt.trace>"u"?!gt.wasm.trace:!gt.trace)||console.timeStamp(`${d}::ORT::${g}`)},$a=(d,g)=>{var st;let b=((st=new Error().stack)==null?void 0:st.split(/\r\n|\r|\n/g))||[],et=!1;for(let at=0;at<b.length;at++){if(et&&!b[at].includes("TRACE_FUNC")){let vt=`FUNC_${d}::${b[at].trim().split(" ")[1]}`;g&&(vt+=`::${g}`),Bn("CPU",vt);return}b[at].includes("TRACE_FUNC")&&(et=!0)}},yt=d=>{(typeof gt.trace>"u"?!gt.wasm.trace:!gt.trace)||$a("BEGIN",d)},ut=d=>{(typeof gt.trace>"u"?!gt.wasm.trace:!gt.trace)||$a("END",d)}}),Dn,_a=j(()=>{Pn(),zn(),zi(),Dn=class GS{constructor(g){this.handler=g}async run(g,b,et){yt();let st={},at={};if(typeof g!="object"||g===null||g instanceof tt||Array.isArray(g))throw new TypeError("'feeds' must be an object that use input names as keys and OnnxValue as corresponding values.");let vt=!0;if(typeof b=="object"){if(b===null)throw new TypeError("Unexpected argument[1]: cannot be null.");if(b instanceof tt)throw new TypeError("'fetches' cannot be a Tensor");if(Array.isArray(b)){if(b.length===0)throw new TypeError("'fetches' cannot be an empty array.");vt=!1;for(let pt of b){if(typeof pt!="string")throw new TypeError("'fetches' must be a string array or an object.");if(this.outputNames.indexOf(pt)===-1)throw new RangeError(`'fetches' contains invalid output name: ${pt}.`);st[pt]=null}if(typeof et=="object"&&et!==null)at=et;else if(typeof et<"u")throw new TypeError("'options' must be an object.")}else{let pt=!1,wt=Object.getOwnPropertyNames(b);for(let $t of this.outputNames)if(wt.indexOf($t)!==-1){let Lt=b[$t];(Lt===null||Lt instanceof tt)&&(pt=!0,vt=!1,st[$t]=Lt)}if(pt){if(typeof et=="object"&&et!==null)at=et;else if(typeof et<"u")throw new TypeError("'options' must be an object.")}else at=b}}else if(typeof b<"u")throw new TypeError("Unexpected argument[1]: must be 'fetches' or 'options'.");for(let pt of this.inputNames)if(typeof g[pt]>"u")throw new Error(`input '${pt}' is missing in 'feeds'.`);if(vt)for(let pt of this.outputNames)st[pt]=null;let Tt=await this.handler.run(g,st,at),Ct={};for(let pt in Tt)if(Object.hasOwnProperty.call(Tt,pt)){let wt=Tt[pt];wt instanceof tt?Ct[pt]=wt:Ct[pt]=new tt(wt.type,wt.data,wt.dims)}return ut(),Ct}async release(){return this.handler.dispose()}static async create(g,b,et,st){yt();let at,vt={};if(typeof g=="string"){if(at=g,typeof b=="object"&&b!==null)vt=b;else if(typeof b<"u")throw new TypeError("'options' must be an object.")}else if(g instanceof Uint8Array){if(at=g,typeof b=="object"&&b!==null)vt=b;else if(typeof b<"u")throw new TypeError("'options' must be an object.")}else if(g instanceof ArrayBuffer||typeof SharedArrayBuffer<"u"&&g instanceof SharedArrayBuffer){let wt=g,$t=0,Lt=g.byteLength;if(typeof b=="object"&&b!==null)vt=b;else if(typeof b=="number"){if($t=b,!Number.isSafeInteger($t))throw new RangeError("'byteOffset' must be an integer.");if($t<0||$t>=wt.byteLength)throw new RangeError(`'byteOffset' is out of range [0, ${wt.byteLength}).`);if(Lt=g.byteLength-$t,typeof et=="number"){if(Lt=et,!Number.isSafeInteger(Lt))throw new RangeError("'byteLength' must be an integer.");if(Lt<=0||$t+Lt>wt.byteLength)throw new RangeError(`'byteLength' is out of range (0, ${wt.byteLength-$t}].`);if(typeof st=="object"&&st!==null)vt=st;else if(typeof st<"u")throw new TypeError("'options' must be an object.")}else if(typeof et<"u")throw new TypeError("'byteLength' must be a number.")}else if(typeof b<"u")throw new TypeError("'options' must be an object.");at=new Uint8Array(wt,$t,Lt)}else throw new TypeError("Unexpected argument[0]: must be 'path' or 'buffer'.");let[Tt,Ct]=await On(vt),pt=await Tt.createInferenceSessionHandler(at,Ct);return ut(),new GS(pt)}startProfiling(){this.handler.startProfiling()}endProfiling(){this.handler.endProfiling()}get inputNames(){return this.handler.inputNames}get outputNames(){return this.handler.outputNames}}}),uc,xa=j(()=>{_a(),uc=Dn}),Sa=j(()=>{}),Ca=j(()=>{}),Ia=j(()=>{}),Ta=j(()=>{}),lc,Mn,Aa=j(()=>{Pn(),zn(),lc="Training backend could not be resolved. Make sure you're using the correct configuration & WebAssembly files.",Mn=class qS{constructor(g,b,et){this.handler=g,this.hasOptimizerModel=b,this.hasEvalModel=et}get trainingInputNames(){return this.handler.inputNames}get trainingOutputNames(){return this.handler.outputNames}get evalInputNames(){if(this.hasEvalModel)return this.handler.evalInputNames;throw new Error("This training session has no evalModel loaded.")}get evalOutputNames(){if(this.hasEvalModel)return this.handler.evalOutputNames;throw new Error("This training session has no evalModel loaded.")}static async create(g,b){let et=g.evalModel||"",st=g.optimizerModel||"",at=b||{},[vt,Tt]=await On(at);if(vt.createTrainingSessionHandler){let Ct=await vt.createTrainingSessionHandler(g.checkpointState,g.trainModel,et,st,Tt);return new qS(Ct,!!g.optimizerModel,!!g.evalModel)}else throw new Error(lc)}typeNarrowingForRunStep(g,b,et,st,at){let vt={},Tt={};if(typeof et!="object"||et===null||et instanceof tt||Array.isArray(et))throw new TypeError("'feeds' must be an object that use input names as keys and OnnxValue as corresponding values.");let Ct=!0;if(typeof st=="object"){if(st===null)throw new TypeError("Unexpected argument[1]: cannot be null.");if(st instanceof tt)throw new TypeError("'fetches' cannot be a Tensor");if(Array.isArray(st)){if(st.length===0)throw new TypeError("'fetches' cannot be an empty array.");Ct=!1;for(let pt of st){if(typeof pt!="string")throw new TypeError("'fetches' must be a string array or an object.");if(b.indexOf(pt)===-1)throw new RangeError(`'fetches' contains invalid output name: ${pt}.`);vt[pt]=null}if(typeof at=="object"&&at!==null)Tt=at;else if(typeof at<"u")throw new TypeError("'options' must be an object.")}else{let pt=!1,wt=Object.getOwnPropertyNames(st);for(let $t of b)if(wt.indexOf($t)!==-1){let Lt=st[$t];(Lt===null||Lt instanceof tt)&&(pt=!0,Ct=!1,vt[$t]=Lt)}if(pt){if(typeof at=="object"&&at!==null)Tt=at;else if(typeof at<"u")throw new TypeError("'options' must be an object.")}else Tt=st}}else if(typeof st<"u")throw new TypeError("Unexpected argument[1]: must be 'fetches' or 'options'.");for(let pt of g)if(typeof et[pt]>"u")throw new Error(`input '${pt}' is missing in 'feeds'.`);if(Ct)for(let pt of b)vt[pt]=null;return[vt,Tt]}convertHandlerReturnTypeToMapOfTensors(g){let b={};for(let et in g)if(Object.hasOwnProperty.call(g,et)){let st=g[et];st instanceof tt?b[et]=st:b[et]=new tt(st.type,st.data,st.dims)}return b}async lazyResetGrad(){await this.handler.lazyResetGrad()}async runTrainStep(g,b,et){let[st,at]=this.typeNarrowingForRunStep(this.trainingInputNames,this.trainingOutputNames,g,b,et),vt=await this.handler.runTrainStep(g,st,at);return this.convertHandlerReturnTypeToMapOfTensors(vt)}async runOptimizerStep(g){if(this.hasOptimizerModel)await this.handler.runOptimizerStep(g||{});else throw new Error("This TrainingSession has no OptimizerModel loaded.")}async runEvalStep(g,b,et){if(this.hasEvalModel){let[st,at]=this.typeNarrowingForRunStep(this.evalInputNames,this.evalOutputNames,g,b,et),vt=await this.handler.runEvalStep(g,st,at);return this.convertHandlerReturnTypeToMapOfTensors(vt)}else throw new Error("This TrainingSession has no EvalModel loaded.")}async getParametersSize(g=!0){return this.handler.getParametersSize(g)}async loadParametersBuffer(g,b=!0){let et=await this.getParametersSize(b);if(g.length!==4*et)throw new Error("Size of the buffer passed into loadParametersBuffer must match the number of parameters in the model. Please use getParametersSize method to check.");return this.handler.loadParametersBuffer(g,b)}async getContiguousParameters(g=!0){return this.handler.getContiguousParameters(g)}async release(){return this.handler.dispose()}}}),dc,Ea=j(()=>{Aa(),dc=Mn}),Bi={};kr(Bi,{InferenceSession:()=>uc,TRACE:()=>Bn,TRACE_FUNC_BEGIN:()=>yt,TRACE_FUNC_END:()=>ut,Tensor:()=>tt,TrainingSession:()=>dc,env:()=>ke,registerBackend:()=>lr});var _t=j(()=>{ra(),aa(),xa(),zn(),Sa(),Ca(),zi(),Ia(),Ta(),Ea()}),Di={};kr(Di,{createReadStream:()=>Oa,readFile:()=>cc,readFileSync:()=>pc});var cc,pc,Oa,Mi=j(()=>{cc=void 0,pc=void 0,Oa=void 0}),Ui={};kr(Ui,{join:()=>mc});var mc,Wi=j(()=>{mc=void 0}),za=Er((d,g)=>{var b=(()=>{var st;var et=typeof document<"u"?(st=document.currentScript)==null?void 0:st.src:void 0;return typeof __filename<"u"&&(et||(et=__filename)),function(at={}){var vt=at,Tt,Ct,pt=new Promise((Ir,Xr)=>{Tt=Ir,Ct=Xr});vt.mountExternalData=(Ir,Xr)=>{(vt.eb||(vt.eb=new Map)).set(Ir,Xr)},vt.unmountExternalData=()=>{delete vt.eb};let wt=()=>{let Ir=(In,Qo,s0)=>(...x0)=>{let H0=c1,Z0=Qo==null?void 0:Qo();x0=In(...x0);let r1=Qo==null?void 0:Qo();return Z0!==r1&&(In=r1,s0(Z0),Qo=s0=null),c1!=H0?Rv():x0},Xr=In=>async(...Qo)=>{var s0;try{if(vt.cb)throw Error("Session already started");let x0=vt.cb={xb:Qo[0],errors:[]},H0=await In(...Qo);if(vt.cb!==x0)throw Error("Session mismatch");(s0=vt.kb)==null||s0.flush();let Z0=x0.errors;if(0<Z0.length){let r1=await Promise.all(Z0);if(r1=r1.filter(e1=>e1),0<r1.length)throw Error(r1.join(`
`))}return H0}finally{vt.cb=null}};vt._OrtCreateSession=Ir(vt._OrtCreateSession,()=>vt._OrtCreateSession,In=>vt._OrtCreateSession=In),vt._OrtRun=Xr(Ir(vt._OrtRun,()=>vt._OrtRun,In=>vt._OrtRun=In)),vt._OrtRunWithBinding=Xr(Ir(vt._OrtRunWithBinding,()=>vt._OrtRunWithBinding,In=>vt._OrtRunWithBinding=In)),vt._OrtBindInput=Ir(vt._OrtBindInput,()=>vt._OrtBindInput,In=>vt._OrtBindInput=In),wt=void 0};vt.jsepInit=(Ir,Xr)=>{if(wt==null||wt(),Ir==="webgpu"){[vt.kb,vt.pb,vt.tb,vt.lb,vt.sb,vt.Ra,vt.ub,vt.wb,vt.qb,vt.rb,vt.vb]=Xr;let In=vt.kb;vt.jsepRegisterBuffer=(Qo,s0,x0,H0)=>In.registerBuffer(Qo,s0,x0,H0),vt.jsepGetBuffer=Qo=>In.getBuffer(Qo),vt.jsepCreateDownloader=(Qo,s0,x0)=>In.createDownloader(Qo,s0,x0),vt.jsepOnReleaseSession=Qo=>{In.onReleaseSession(Qo)},vt.jsepOnRunStart=Qo=>In.onRunStart(Qo)}};var $t=Object.assign({},vt),Lt="./this.program",jt=(Ir,Xr)=>{throw Xr},Ft=typeof window=="object",Gt=typeof importScripts=="function",Ht=typeof process=="object"&&typeof process.versions=="object"&&typeof process.versions.node=="string",qt="",Kt,rr,ir;if(Ht){var or=(Mi(),sr(Di)),jr=(Wi(),sr(Ui));qt=Gt?jr.dirname(qt)+"/":__dirname+"/",Kt=(Ir,Xr)=>(Ir=y0(Ir)?new URL(Ir):jr.normalize(Ir),or.readFileSync(Ir,Xr?void 0:"utf8")),ir=Ir=>(Ir=Kt(Ir,!0),Ir.buffer||(Ir=new Uint8Array(Ir)),Ir),rr=(Ir,Xr,In,Qo=!0)=>{Ir=y0(Ir)?new URL(Ir):jr.normalize(Ir),or.readFile(Ir,Qo?void 0:"utf8",(s0,x0)=>{s0?In(s0):Xr(Qo?x0.buffer:x0)})},!vt.thisProgram&&1<process.argv.length&&(Lt=process.argv[1].replace(/\\/g,"/")),process.argv.slice(2),jt=(Ir,Xr)=>{throw process.exitCode=Ir,Xr}}else(Ft||Gt)&&(Gt?qt=self.location.href:typeof document<"u"&&document.currentScript&&(qt=document.currentScript.src),et&&(qt=et),qt.startsWith("blob:")?qt="":qt=qt.substr(0,qt.replace(/[?#].*/,"").lastIndexOf("/")+1),Kt=Ir=>{var Xr=new XMLHttpRequest;return Xr.open("GET",Ir,!1),Xr.send(null),Xr.responseText},Gt&&(ir=Ir=>{var Xr=new XMLHttpRequest;return Xr.open("GET",Ir,!1),Xr.responseType="arraybuffer",Xr.send(null),new Uint8Array(Xr.response)}),rr=(Ir,Xr,In)=>{var Qo=new XMLHttpRequest;Qo.open("GET",Ir,!0),Qo.responseType="arraybuffer",Qo.onload=()=>{Qo.status==200||Qo.status==0&&Qo.response?Xr(Qo.response):In()},Qo.onerror=In,Qo.send(null)});var qr=console.log.bind(console),Yr=console.error.bind(console);Object.assign(vt,$t),$t=null;var vn,ko=!1,Xo,zo,t0,Uo,No,_n,Kr,e0,Zr,Ro,Sn;function Tn(){var Ir=vn.buffer;vt.HEAP8=zo=new Int8Array(Ir),vt.HEAP16=Uo=new Int16Array(Ir),vt.HEAPU8=t0=new Uint8Array(Ir),vt.HEAPU16=No=new Uint16Array(Ir),vt.HEAP32=_n=new Int32Array(Ir),vt.HEAPU32=Kr=new Uint32Array(Ir),vt.HEAPF32=e0=new Float32Array(Ir),vt.HEAPF64=Sn=new Float64Array(Ir),vt.HEAP64=Zr=new BigInt64Array(Ir),vt.HEAPU64=Ro=new BigUint64Array(Ir)}var n0=[],Go=[],An=[],a0=0,u0=null;function d0(Ir){throw Ir="Aborted("+Ir+")",Yr(Ir),ko=!0,Xo=1,Ir=new WebAssembly.RuntimeError(Ir+". Build with -sASSERTIONS for more info."),Ct(Ir),Ir}var f0=Ir=>Ir.startsWith("data:application/octet-stream;base64,"),y0=Ir=>Ir.startsWith("file://"),b0;if(b0="ort-wasm-simd.wasm",!f0(b0)){var O0=b0;b0=vt.locateFile?vt.locateFile(O0,qt):qt+O0}function C0(Ir){if(ir)return ir(Ir);throw"both async and sync fetching of the wasm failed"}function v0(Ir){if(Ft||Gt){if(typeof fetch=="function"&&!y0(Ir))return fetch(Ir,{credentials:"same-origin"}).then(Xr=>{if(!Xr.ok)throw`failed to load wasm binary file at '${Ir}'`;return Xr.arrayBuffer()}).catch(()=>C0(Ir));if(rr)return new Promise((Xr,In)=>{rr(Ir,Qo=>Xr(new Uint8Array(Qo)),In)})}return Promise.resolve().then(()=>C0(Ir))}function k0(Ir,Xr,In){return v0(Ir).then(Qo=>WebAssembly.instantiate(Qo,Xr)).then(In,Qo=>{Yr(`failed to asynchronously prepare wasm: ${Qo}`),d0(Qo)})}function N0(Ir,Xr){var In=b0;return typeof WebAssembly.instantiateStreaming!="function"||f0(In)||y0(In)||Ht||typeof fetch!="function"?k0(In,Ir,Xr):fetch(In,{credentials:"same-origin"}).then(Qo=>WebAssembly.instantiateStreaming(Qo,Ir).then(Xr,function(s0){return Yr(`wasm streaming compile failed: ${s0}`),Yr("falling back to ArrayBuffer instantiation"),k0(In,Ir,Xr)}))}var w0={824920:(Ir,Xr,In,Qo)=>{if(typeof vt>"u"||!vt.eb)return 1;if(Ir=E0(Ir>>>0),Ir.startsWith("./")&&(Ir=Ir.substring(2)),Ir=vt.eb.get(Ir),!Ir)return 2;if(Xr>>>=0,In>>>=0,Xr+In>Ir.byteLength)return 3;try{return t0.set(Ir.subarray(Xr,Xr+In),Qo>>>0>>>0),0}catch{return 4}},825421:()=>{vt.qb()},825452:()=>{vt.rb()},825481:()=>{vt.vb()},825506:Ir=>vt.pb(Ir),825539:Ir=>vt.tb(Ir),825571:(Ir,Xr,In)=>{vt.lb(Ir,Xr,In,!0)},825610:(Ir,Xr,In)=>{vt.lb(Ir,Xr,In)},825643:Ir=>{vt.Ra("Abs",Ir,void 0)},825694:Ir=>{vt.Ra("Neg",Ir,void 0)},825745:Ir=>{vt.Ra("Floor",Ir,void 0)},825798:Ir=>{vt.Ra("Ceil",Ir,void 0)},825850:Ir=>{vt.Ra("Reciprocal",Ir,void 0)},825908:Ir=>{vt.Ra("Sqrt",Ir,void 0)},825960:Ir=>{vt.Ra("Exp",Ir,void 0)},826011:Ir=>{vt.Ra("Erf",Ir,void 0)},826062:Ir=>{vt.Ra("Sigmoid",Ir,void 0)},826117:(Ir,Xr,In)=>{vt.Ra("HardSigmoid",Ir,{alpha:Xr,beta:In})},826196:Ir=>{vt.Ra("Log",Ir,void 0)},826247:Ir=>{vt.Ra("Sin",Ir,void 0)},826298:Ir=>{vt.Ra("Cos",Ir,void 0)},826349:Ir=>{vt.Ra("Tan",Ir,void 0)},826400:Ir=>{vt.Ra("Asin",Ir,void 0)},826452:Ir=>{vt.Ra("Acos",Ir,void 0)},826504:Ir=>{vt.Ra("Atan",Ir,void 0)},826556:Ir=>{vt.Ra("Sinh",Ir,void 0)},826608:Ir=>{vt.Ra("Cosh",Ir,void 0)},826660:Ir=>{vt.Ra("Asinh",Ir,void 0)},826713:Ir=>{vt.Ra("Acosh",Ir,void 0)},826766:Ir=>{vt.Ra("Atanh",Ir,void 0)},826819:Ir=>{vt.Ra("Tanh",Ir,void 0)},826871:Ir=>{vt.Ra("Not",Ir,void 0)},826922:(Ir,Xr,In)=>{vt.Ra("Clip",Ir,{min:Xr,max:In})},826991:Ir=>{vt.Ra("Clip",Ir,void 0)},827043:(Ir,Xr)=>{vt.Ra("Elu",Ir,{alpha:Xr})},827101:Ir=>{vt.Ra("Relu",Ir,void 0)},827153:(Ir,Xr)=>{vt.Ra("LeakyRelu",Ir,{alpha:Xr})},827217:(Ir,Xr)=>{vt.Ra("ThresholdedRelu",Ir,{alpha:Xr})},827287:(Ir,Xr)=>{vt.Ra("Cast",Ir,{to:Xr})},827345:Ir=>{vt.Ra("Add",Ir,void 0)},827396:Ir=>{vt.Ra("Sub",Ir,void 0)},827447:Ir=>{vt.Ra("Mul",Ir,void 0)},827498:Ir=>{vt.Ra("Div",Ir,void 0)},827549:Ir=>{vt.Ra("Pow",Ir,void 0)},827600:Ir=>{vt.Ra("Equal",Ir,void 0)},827653:Ir=>{vt.Ra("Greater",Ir,void 0)},827708:Ir=>{vt.Ra("GreaterOrEqual",Ir,void 0)},827770:Ir=>{vt.Ra("Less",Ir,void 0)},827822:Ir=>{vt.Ra("LessOrEqual",Ir,void 0)},827881:(Ir,Xr,In,Qo,s0)=>{vt.Ra("ReduceMean",Ir,{keepDims:!!Xr,noopWithEmptyAxes:!!In,axes:Qo?Array.from(_n.subarray(Qo>>>0,s0>>>0)):[]})},828040:(Ir,Xr,In,Qo,s0)=>{vt.Ra("ReduceMax",Ir,{keepDims:!!Xr,noopWithEmptyAxes:!!In,axes:Qo?Array.from(_n.subarray(Qo>>>0,s0>>>0)):[]})},828198:(Ir,Xr,In,Qo,s0)=>{vt.Ra("ReduceMin",Ir,{keepDims:!!Xr,noopWithEmptyAxes:!!In,axes:Qo?Array.from(_n.subarray(Qo>>>0,s0>>>0)):[]})},828356:(Ir,Xr,In,Qo,s0)=>{vt.Ra("ReduceProd",Ir,{keepDims:!!Xr,noopWithEmptyAxes:!!In,axes:Qo?Array.from(_n.subarray(Qo>>>0,s0>>>0)):[]})},828515:(Ir,Xr,In,Qo,s0)=>{vt.Ra("ReduceSum",Ir,{keepDims:!!Xr,noopWithEmptyAxes:!!In,axes:Qo?Array.from(_n.subarray(Qo>>>0,s0>>>0)):[]})},828673:(Ir,Xr,In,Qo,s0)=>{vt.Ra("ReduceL1",Ir,{keepDims:!!Xr,noopWithEmptyAxes:!!In,axes:Qo?Array.from(_n.subarray(Qo>>>0,s0>>>0)):[]})},828830:(Ir,Xr,In,Qo,s0)=>{vt.Ra("ReduceL2",Ir,{keepDims:!!Xr,noopWithEmptyAxes:!!In,axes:Qo?Array.from(_n.subarray(Qo>>>0,s0>>>0)):[]})},828987:(Ir,Xr,In,Qo,s0)=>{vt.Ra("ReduceLogSum",Ir,{keepDims:!!Xr,noopWithEmptyAxes:!!In,axes:Qo?Array.from(_n.subarray(Qo>>>0,s0>>>0)):[]})},829148:(Ir,Xr,In,Qo,s0)=>{vt.Ra("ReduceSumSquare",Ir,{keepDims:!!Xr,noopWithEmptyAxes:!!In,axes:Qo?Array.from(_n.subarray(Qo>>>0,s0>>>0)):[]})},829312:(Ir,Xr,In,Qo,s0)=>{vt.Ra("ReduceLogSumExp",Ir,{keepDims:!!Xr,noopWithEmptyAxes:!!In,axes:Qo?Array.from(_n.subarray(Qo>>>0,s0>>>0)):[]})},829476:Ir=>{vt.Ra("Where",Ir,void 0)},829529:(Ir,Xr,In)=>{vt.Ra("Transpose",Ir,{perm:Xr?Array.from(_n.subarray(Xr>>>0,In>>>0)):[]})},829637:(Ir,Xr,In,Qo)=>{vt.Ra("DepthToSpace",Ir,{blocksize:Xr,mode:E0(In),format:Qo?"NHWC":"NCHW"})},829770:(Ir,Xr,In,Qo)=>{vt.Ra("DepthToSpace",Ir,{blocksize:Xr,mode:E0(In),format:Qo?"NHWC":"NCHW"})},829903:(Ir,Xr,In,Qo,s0,x0,H0,Z0,r1,e1,$1,B1,L0,M0,f1)=>{vt.Ra("ConvTranspose",Ir,{format:r1?"NHWC":"NCHW",autoPad:Xr,dilations:[In],group:Qo,kernelShape:[s0],pads:[x0,H0],strides:[Z0],wIsConst:()=>!!zo[e1>>>0],outputPadding:$1?Array.from(_n.subarray($1>>>0,B1>>>0)):[],outputShape:L0?Array.from(_n.subarray(L0>>>0,M0>>>0)):[],activation:E0(f1)})},830304:(Ir,Xr,In,Qo,s0,x0,H0,Z0,r1,e1,$1,B1,L0,M0)=>{vt.Ra("ConvTranspose",Ir,{format:Z0?"NHWC":"NCHW",autoPad:Xr,dilations:Array.from(_n.subarray(In>>>0,(In>>>0)+2>>>0)),group:Qo,kernelShape:Array.from(_n.subarray(s0>>>0,(s0>>>0)+2>>>0)),pads:Array.from(_n.subarray(x0>>>0,(x0>>>0)+4>>>0)),strides:Array.from(_n.subarray(H0>>>0,(H0>>>0)+2>>>0)),wIsConst:()=>!!zo[r1>>>0],outputPadding:e1?Array.from(_n.subarray(e1>>>0,$1>>>0)):[],outputShape:B1?Array.from(_n.subarray(B1>>>0,L0>>>0)):[],activation:E0(M0)})},830869:(Ir,Xr,In,Qo,s0,x0,H0,Z0,r1,e1,$1,B1,L0,M0,f1)=>{vt.Ra("ConvTranspose",Ir,{format:r1?"NHWC":"NCHW",autoPad:Xr,dilations:[In],group:Qo,kernelShape:[s0],pads:[x0,H0],strides:[Z0],wIsConst:()=>!!zo[e1>>>0],outputPadding:$1?Array.from(_n.subarray($1>>>0,B1>>>0)):[],outputShape:L0?Array.from(_n.subarray(L0>>>0,M0>>>0)):[],activation:E0(f1)})},831270:(Ir,Xr,In,Qo,s0,x0,H0,Z0,r1,e1,$1,B1,L0,M0)=>{vt.Ra("ConvTranspose",Ir,{format:Z0?"NHWC":"NCHW",autoPad:Xr,dilations:Array.from(_n.subarray(In>>>0,(In>>>0)+2>>>0)),group:Qo,kernelShape:Array.from(_n.subarray(s0>>>0,(s0>>>0)+2>>>0)),pads:Array.from(_n.subarray(x0>>>0,(x0>>>0)+4>>>0)),strides:Array.from(_n.subarray(H0>>>0,(H0>>>0)+2>>>0)),wIsConst:()=>!!zo[r1>>>0],outputPadding:e1?Array.from(_n.subarray(e1>>>0,$1>>>0)):[],outputShape:B1?Array.from(_n.subarray(B1>>>0,L0>>>0)):[],activation:E0(M0)})},831835:(Ir,Xr)=>{vt.Ra("GlobalAveragePool",Ir,{format:Xr?"NHWC":"NCHW"})},831926:(Ir,Xr,In,Qo,s0,x0,H0,Z0,r1,e1,$1,B1,L0,M0,f1,p1)=>{vt.Ra("AveragePool",Ir,{format:p1?"NHWC":"NCHW",auto_pad:Xr,ceil_mode:In,count_include_pad:Qo,storage_order:s0,dilations:[x0,H0],kernel_shape:[Z0,r1],pads:[e1,$1,B1,L0],strides:[M0,f1]})},832210:(Ir,Xr)=>{vt.Ra("GlobalAveragePool",Ir,{format:Xr?"NHWC":"NCHW"})},832301:(Ir,Xr,In,Qo,s0,x0,H0,Z0,r1,e1,$1,B1,L0,M0,f1,p1)=>{vt.Ra("AveragePool",Ir,{format:p1?"NHWC":"NCHW",auto_pad:Xr,ceil_mode:In,count_include_pad:Qo,storage_order:s0,dilations:[x0,H0],kernel_shape:[Z0,r1],pads:[e1,$1,B1,L0],strides:[M0,f1]})},832585:(Ir,Xr)=>{vt.Ra("GlobalMaxPool",Ir,{format:Xr?"NHWC":"NCHW"})},832672:(Ir,Xr,In,Qo,s0,x0,H0,Z0,r1,e1,$1,B1,L0,M0,f1,p1)=>{vt.Ra("MaxPool",Ir,{format:p1?"NHWC":"NCHW",auto_pad:Xr,ceil_mode:In,count_include_pad:Qo,storage_order:s0,dilations:[x0,H0],kernel_shape:[Z0,r1],pads:[e1,$1,B1,L0],strides:[M0,f1]})},832952:(Ir,Xr)=>{vt.Ra("GlobalMaxPool",Ir,{format:Xr?"NHWC":"NCHW"})},833039:(Ir,Xr,In,Qo,s0,x0,H0,Z0,r1,e1,$1,B1,L0,M0,f1,p1)=>{vt.Ra("MaxPool",Ir,{format:p1?"NHWC":"NCHW",auto_pad:Xr,ceil_mode:In,count_include_pad:Qo,storage_order:s0,dilations:[x0,H0],kernel_shape:[Z0,r1],pads:[e1,$1,B1,L0],strides:[M0,f1]})},833319:(Ir,Xr,In,Qo,s0)=>{vt.Ra("Gemm",Ir,{alpha:Xr,beta:In,transA:Qo,transB:s0})},833423:Ir=>{vt.Ra("MatMul",Ir,void 0)},833477:(Ir,Xr,In,Qo)=>{vt.Ra("ArgMax",Ir,{keepDims:!!Xr,selectLastIndex:!!In,axis:Qo})},833585:(Ir,Xr,In,Qo)=>{vt.Ra("ArgMin",Ir,{keepDims:!!Xr,selectLastIndex:!!In,axis:Qo})},833693:(Ir,Xr)=>{vt.Ra("Softmax",Ir,{axis:Xr})},833756:(Ir,Xr)=>{vt.Ra("Concat",Ir,{axis:Xr})},833816:(Ir,Xr,In,Qo,s0)=>{vt.Ra("Split",Ir,{axis:Xr,numOutputs:In,splitSizes:Qo?Array.from(_n.subarray(Qo>>>0,s0>>>0)):[]})},833956:Ir=>{vt.Ra("Expand",Ir,void 0)},834010:(Ir,Xr)=>{vt.Ra("Gather",Ir,{axis:Number(Xr)})},834081:(Ir,Xr)=>{vt.Ra("GatherElements",Ir,{axis:Number(Xr)})},834160:(Ir,Xr,In,Qo,s0,x0,H0,Z0,r1,e1,$1)=>{vt.Ra("Resize",Ir,{antialias:Xr,axes:In?Array.from(_n.subarray(In>>>0,Qo>>>0)):[],coordinateTransformMode:E0(s0),cubicCoeffA:x0,excludeOutside:H0,extrapolationValue:Z0,keepAspectRatioPolicy:E0(r1),mode:E0(e1),nearestMode:E0($1)})},834506:(Ir,Xr,In,Qo,s0,x0,H0)=>{vt.Ra("Slice",Ir,{starts:Xr?Array.from(_n.subarray(Xr>>>0,In>>>0)):[],ends:Qo?Array.from(_n.subarray(Qo>>>0,s0>>>0)):[],axes:x0?Array.from(_n.subarray(x0>>>0,H0>>>0)):[]})},834722:Ir=>{vt.Ra("Tile",Ir,void 0)},834774:(Ir,Xr,In,Qo)=>{vt.Ra("LayerNormalization",Ir,{axis:Xr,epsilon:In,simplified:!!Qo})},834885:(Ir,Xr,In)=>{vt.Ra("InstanceNormalization",Ir,{epsilon:Xr,format:In?"NHWC":"NCHW"})},834999:(Ir,Xr,In)=>{vt.Ra("InstanceNormalization",Ir,{epsilon:Xr,format:In?"NHWC":"NCHW"})},835113:Ir=>{vt.Ra("Range",Ir,void 0)},835166:(Ir,Xr)=>{vt.Ra("Einsum",Ir,{equation:E0(Xr)})},835247:(Ir,Xr,In,Qo,s0)=>{vt.Ra("Pad",Ir,{mode:Xr,value:In,pads:Qo?Array.from(_n.subarray(Qo>>>0,s0>>>0)):[]})},835374:(Ir,Xr,In,Qo,s0,x0)=>{vt.Ra("BatchNormalization",Ir,{epsilon:Xr,momentum:In,spatial:!!s0,trainingMode:!!Qo,format:x0?"NHWC":"NCHW"})},835543:(Ir,Xr,In,Qo,s0,x0)=>{vt.Ra("BatchNormalization",Ir,{epsilon:Xr,momentum:In,spatial:!!s0,trainingMode:!!Qo,format:x0?"NHWC":"NCHW"})},835712:(Ir,Xr,In)=>{vt.Ra("CumSum",Ir,{exclusive:Number(Xr),reverse:Number(In)})},835809:(Ir,Xr,In,Qo,s0,x0,H0,Z0,r1)=>{vt.Ra("Attention",Ir,{numHeads:Xr,isUnidirectional:In,maskFilterValue:Qo,scale:s0,doRotary:x0,qkvHiddenSizes:H0?Array.from(_n.subarray(Number(Z0)>>>0,Number(Z0)+H0>>>0)):[],pastPresentShareBuffer:!!r1})},836081:Ir=>{vt.Ra("BiasAdd",Ir,void 0)},836136:Ir=>{vt.Ra("BiasSplitGelu",Ir,void 0)},836197:Ir=>{vt.Ra("FastGelu",Ir,void 0)},836253:(Ir,Xr,In,Qo,s0,x0,H0,Z0,r1,e1,$1,B1,L0)=>{vt.Ra("Conv",Ir,{format:r1?"NHWC":"NCHW",auto_pad:Xr,dilations:[In],group:Qo,kernel_shape:[s0],pads:x0?Array.from(_n.subarray(x0>>>0,H0>>>0)):[],strides:[Z0],w_is_const:()=>!!zo[e1>>>0],activation:E0($1),activation_params:B1?Array.from(e0.subarray(B1>>>0,L0>>>0)):[]})},836623:(Ir,Xr,In,Qo,s0,x0,H0,Z0,r1,e1,$1,B1,L0,M0,f1,p1)=>{vt.Ra("Conv",Ir,{format:B1?"NHWC":"NCHW",auto_pad:Xr,dilations:[In,Qo],group:s0,kernel_shape:[x0,H0],pads:Z0?Array.from(_n.subarray(Z0>>>0,r1>>>0)):[],strides:[e1,$1],w_is_const:()=>!!zo[L0>>>0],activation:E0(M0),activation_params:f1?Array.from(e0.subarray(f1>>>0,p1>>>0)):[]})},837014:Ir=>{vt.Ra("Gelu",Ir,void 0)},837066:(Ir,Xr,In,Qo,s0,x0)=>{vt.Ra("MatMulNBits",Ir,{k:Xr,n:In,accuracyLevel:Qo,bits:s0,blockSize:x0})},837193:(Ir,Xr,In,Qo,s0,x0)=>{vt.Ra("MultiHeadAttention",Ir,{numHeads:Xr,isUnidirectional:In,maskFilterValue:Qo,scale:s0,doRotary:x0})},837352:(Ir,Xr,In,Qo,s0)=>{vt.Ra("RotaryEmbedding",Ir,{interleaved:!!Xr,numHeads:In,rotaryEmbeddingDim:Qo,scale:s0})},837491:(Ir,Xr,In)=>{vt.Ra("SkipLayerNormalization",Ir,{epsilon:Xr,simplified:!!In})},837593:(Ir,Xr,In)=>{vt.Ra("SkipLayerNormalization",Ir,{epsilon:Xr,simplified:!!In})},837695:(Ir,Xr,In,Qo)=>{vt.Ra("LayerNormalization",Ir,{axis:Xr,epsilon:In,simplified:!!Qo})},837806:Ir=>{vt.ub(Ir)},837840:(Ir,Xr)=>vt.wb(Ir,Xr,vt.cb.xb,vt.cb.errors)};function r0(Ir){this.name="ExitStatus",this.message=`Program terminated with exit(${Ir})`,this.status=Ir}class p0{constructor(Xr){this.hb=Xr-24}}var $0=0,A0=typeof TextDecoder<"u"?new TextDecoder("utf8"):void 0,g0=(Ir,Xr,In)=>{Xr>>>=0;var Qo=Xr+In;for(In=Xr;Ir[In]&&!(In>=Qo);)++In;if(16<In-Xr&&Ir.buffer&&A0)return A0.decode(Ir.subarray(Xr,In));for(Qo="";Xr<In;){var s0=Ir[Xr++];if(s0&128){var x0=Ir[Xr++]&63;if((s0&224)==192)Qo+=String.fromCharCode((s0&31)<<6|x0);else{var H0=Ir[Xr++]&63;s0=(s0&240)==224?(s0&15)<<12|x0<<6|H0:(s0&7)<<18|x0<<12|H0<<6|Ir[Xr++]&63,65536>s0?Qo+=String.fromCharCode(s0):(s0-=65536,Qo+=String.fromCharCode(55296|s0>>10,56320|s0&1023))}}else Qo+=String.fromCharCode(s0)}return Qo},E0=(Ir,Xr)=>(Ir>>>=0)?g0(t0,Ir,Xr):"",F0=Ir=>{for(var Xr=0,In=0;In<Ir.length;++In){var Qo=Ir.charCodeAt(In);127>=Qo?Xr++:2047>=Qo?Xr+=2:55296<=Qo&&57343>=Qo?(Xr+=4,++In):Xr+=3}return Xr},K0=(Ir,Xr,In,Qo)=>{if(In>>>=0,!(0<Qo))return 0;var s0=In;Qo=In+Qo-1;for(var x0=0;x0<Ir.length;++x0){var H0=Ir.charCodeAt(x0);if(55296<=H0&&57343>=H0){var Z0=Ir.charCodeAt(++x0);H0=65536+((H0&1023)<<10)|Z0&1023}if(127>=H0){if(In>=Qo)break;Xr[In++>>>0]=H0}else{if(2047>=H0){if(In+1>=Qo)break;Xr[In++>>>0]=192|H0>>6}else{if(65535>=H0){if(In+2>=Qo)break;Xr[In++>>>0]=224|H0>>12}else{if(In+3>=Qo)break;Xr[In++>>>0]=240|H0>>18,Xr[In++>>>0]=128|H0>>12&63}Xr[In++>>>0]=128|H0>>6&63}Xr[In++>>>0]=128|H0&63}}return Xr[In>>>0]=0,In-s0},l1,n1=Ir=>{for(var Xr="";t0[Ir>>>0];)Xr+=l1[t0[Ir++>>>0]];return Xr},x1={},u1={},P1;function i1(Ir,Xr,In={}){var Qo=Xr.name;if(!Ir)throw new P1(`type "${Qo}" must have a positive integer typeid pointer`);if(u1.hasOwnProperty(Ir)){if(In.nb)return;throw new P1(`Cannot register type '${Qo}' twice`)}u1[Ir]=Xr,x1.hasOwnProperty(Ir)&&(Xr=x1[Ir],delete x1[Ir],Xr.forEach(s0=>s0()))}function v1(Ir,Xr,In={}){if(!("argPackAdvance"in Xr))throw new TypeError("registerType registeredInstance requires argPackAdvance");return i1(Ir,Xr,In)}var _1=(Ir,Xr,In)=>{switch(Xr){case 1:return In?Qo=>zo[Qo>>>0]:Qo=>t0[Qo>>>0];case 2:return In?Qo=>Uo[Qo>>>1>>>0]:Qo=>No[Qo>>>1>>>0];case 4:return In?Qo=>_n[Qo>>>2>>>0]:Qo=>Kr[Qo>>>2>>>0];case 8:return In?Qo=>Zr[Qo>>>3]:Qo=>Ro[Qo>>>3];default:throw new TypeError(`invalid integer width (${Xr}): ${Ir}`)}},X1=[],t1=[];function cv(Ir){Ir>>>=0,9<Ir&&--t1[Ir+1]===0&&(t1[Ir]=void 0,X1.push(Ir))}var S1=Ir=>{if(!Ir)throw new P1("Cannot use deleted val. handle = "+Ir);return t1[Ir]},ev=Ir=>{switch(Ir){case void 0:return 2;case null:return 4;case!0:return 6;case!1:return 8;default:let Xr=X1.pop()||t1.length;return t1[Xr]=Ir,t1[Xr+1]=1,Xr}};function c0(Ir){return this.fromWireType(Kr[Ir>>>2>>>0])}var P0={name:"emscripten::val",fromWireType:Ir=>{var Xr=S1(Ir);return cv(Ir),Xr},toWireType:(Ir,Xr)=>ev(Xr),argPackAdvance:8,readValueFromPointer:c0,bb:null},R0=(Ir,Xr)=>{switch(Xr){case 4:return function(In){return this.fromWireType(e0[In>>>2>>>0])};case 8:return function(In){return this.fromWireType(Sn[In>>>3>>>0])};default:throw new TypeError(`invalid float width (${Xr}): ${Ir}`)}},B0=typeof TextDecoder<"u"?new TextDecoder("utf-16le"):void 0,W0=(Ir,Xr)=>{for(var In=Ir>>1,Qo=In+Xr/2;!(In>=Qo)&&No[In>>>0];)++In;if(In<<=1,32<In-Ir&&B0)return B0.decode(t0.subarray(Ir>>>0,In>>>0));for(In="",Qo=0;!(Qo>=Xr/2);++Qo){var s0=Uo[Ir+2*Qo>>>1>>>0];if(s0==0)break;In+=String.fromCharCode(s0)}return In},s1=(Ir,Xr,In)=>{if(In??(In=2147483647),2>In)return 0;In-=2;var Qo=Xr;In=In<2*Ir.length?In/2:Ir.length;for(var s0=0;s0<In;++s0)Uo[Xr>>>1>>>0]=Ir.charCodeAt(s0),Xr+=2;return Uo[Xr>>>1>>>0]=0,Xr-Qo},E1=Ir=>2*Ir.length,Q1=(Ir,Xr)=>{for(var In=0,Qo="";!(In>=Xr/4);){var s0=_n[Ir+4*In>>>2>>>0];if(s0==0)break;++In,65536<=s0?(s0-=65536,Qo+=String.fromCharCode(55296|s0>>10,56320|s0&1023)):Qo+=String.fromCharCode(s0)}return Qo},K1=(Ir,Xr,In)=>{if(Xr>>>=0,In??(In=2147483647),4>In)return 0;var Qo=Xr;In=Qo+In-4;for(var s0=0;s0<Ir.length;++s0){var x0=Ir.charCodeAt(s0);if(55296<=x0&&57343>=x0){var H0=Ir.charCodeAt(++s0);x0=65536+((x0&1023)<<10)|H0&1023}if(_n[Xr>>>2>>>0]=x0,Xr+=4,Xr+4>In)break}return _n[Xr>>>2>>>0]=0,Xr-Qo},W1=Ir=>{for(var Xr=0,In=0;In<Ir.length;++In){var Qo=Ir.charCodeAt(In);55296<=Qo&&57343>=Qo&&++In,Xr+=4}return Xr},nv=(Ir,Xr)=>{var In=u1[Ir];if(In===void 0)throw Ir=Py(Ir),In=n1(Ir),yv(Ir),new P1(`${Xr} has unknown type ${In}`);return In},Nv=(Ir,Xr,In)=>{var Qo=[];return Ir=Ir.toWireType(Qo,In),Qo.length&&(Kr[Xr>>>2>>>0]=ev(Qo)),Ir},pv=Ir=>{try{Ir()}catch(Xr){d0(Xr)}},j0=Ir=>{var Xr;if(!ko)try{Ir();try{Xo=Xo=Ir=Xo,(Xr=vt.onExit)==null||Xr.call(vt,Ir),ko=!0,jt(Ir,new r0(Ir))}catch(In){In instanceof r0||In=="unwind"||jt(1,In)}}catch(In){In instanceof r0||In=="unwind"||jt(1,In)}};function N1(){var Ir=w1,Xr={};for(let[In,Qo]of Object.entries(Ir))Xr[In]=typeof Qo=="function"?(...s0)=>{T1.push(In);try{return Qo(...s0)}finally{ko||(T1.pop(),c1&&T0===1&&T1.length===0&&(T0=0,pv(ky),typeof Fibers<"u"&&Fibers.Db()))}}:Qo;return Xr}var T0=0,c1=null,O1=0,T1=[],d1={},lv={},iv=0,dv=null,uv=[];function Rv(){return new Promise((Ir,Xr)=>{dv={resolve:Ir,reject:Xr}})}function wv(){var Ir=jv(65548),Xr=Ir+12;Kr[Ir>>>2>>>0]=Xr,Kr[Ir+4>>>2>>>0]=Xr+65536,Xr=T1[0];var In=d1[Xr];return In===void 0&&(In=iv++,d1[Xr]=In,lv[In]=Xr),_n[Ir+8>>>2>>>0]=In,Ir}function Uv(Ir){if(!ko){if(T0===0){var Xr=!1,In=!1;Ir((Qo=0)=>{if(!ko&&(O1=Qo,Xr=!0,In)){T0=2,pv(()=>kv(c1)),typeof Browser<"u"&&Browser.ib.mb&&Browser.ib.resume(),Qo=!1;try{var s0=(0,w1[lv[_n[c1+8>>>2>>>0]]])()}catch(Z0){s0=Z0,Qo=!0}var x0=!1;if(!c1){var H0=dv;H0&&(dv=null,(Qo?H0.reject:H0.resolve)(s0),x0=!0)}if(Qo&&!x0)throw s0}}),In=!0,Xr||(T0=1,c1=wv(),typeof Browser<"u"&&Browser.ib.mb&&Browser.ib.pause(),pv(()=>Tv(c1)))}else T0===2?(T0=0,pv(Dv),yv(c1),c1=null,uv.forEach(j0)):d0(`invalid state: ${T0}`);return O1}}function _v(Ir){return Uv(Xr=>{Ir().then(Xr)})}var iy=[],Sy={},Sv=Ir=>{var Xr=Sy[Ir];return Xr===void 0?n1(Ir):Xr},Av=()=>typeof globalThis=="object"?globalThis:Function("return this")(),Qv=Ir=>{var Xr=iy.length;return iy.push(Ir),Xr},Ey=(Ir,Xr)=>{for(var In=Array(Ir),Qo=0;Qo<Ir;++Qo)In[Qo]=nv(Kr[Xr+4*Qo>>>2>>>0],"parameter "+Qo);return In},Lv=(Ir,Xr)=>Object.defineProperty(Xr,"name",{value:Ir});function Ky(Ir){var Xr=Function;if(!(Xr instanceof Function))throw new TypeError(`new_ called with constructor type ${typeof Xr} which is not a function`);var In=Lv(Xr.name||"unknownFunctionName",function(){});return In.prototype=Xr.prototype,In=new In,Ir=Xr.apply(In,Ir),Ir instanceof Object?Ir:In}var hv=Ir=>Ir%4===0&&(Ir%100!==0||Ir%400===0),Ty=[0,31,60,91,121,152,182,213,244,274,305,335],py=[0,31,59,90,120,151,181,212,243,273,304,334],Pv=[],Cy=(Ir,Xr)=>{Pv.length=0;for(var In;In=t0[Ir++>>>0];){var Qo=In!=105;Qo&=In!=112,Xr+=Qo&&Xr%8?4:0,Pv.push(In==112?Kr[Xr>>>2>>>0]:In==106?Zr[Xr>>>3]:In==105?_n[Xr>>>2>>>0]:Sn[Xr>>>3>>>0]),Xr+=Qo?8:4}return Pv},mv={},Ev=()=>{if(!oy){var Ir={USER:"web_user",LOGNAME:"web_user",PATH:"/",PWD:"/",HOME:"/home/web_user",LANG:(typeof navigator=="object"&&navigator.languages&&navigator.languages[0]||"C").replace("-","_")+".UTF-8",_:Lt||"./this.program"},Xr;for(Xr in mv)mv[Xr]===void 0?delete Ir[Xr]:Ir[Xr]=mv[Xr];var In=[];for(Xr in Ir)In.push(`${Xr}=${Ir[Xr]}`);oy=In}return oy},oy,Zy=[null,[],[]],Qy=[31,29,31,30,31,30,31,31,30,31,30,31],Oy=[31,28,31,30,31,30,31,31,30,31,30,31];function d$(Ir){var Xr=Array(F0(Ir)+1);return K0(Ir,Xr,0,Xr.length),Xr}function Jy(Ir,Xr,In,Qo){function s0(M0,f1,p1){for(M0=typeof M0=="number"?M0.toString():M0||"";M0.length<f1;)M0=p1[0]+M0;return M0}function x0(M0,f1){return s0(M0,f1,"0")}function H0(M0,f1){function p1(Iy){return 0>Iy?-1:0<Iy?1:0}var z1;return(z1=p1(M0.getFullYear()-f1.getFullYear()))===0&&(z1=p1(M0.getMonth()-f1.getMonth()))===0&&(z1=p1(M0.getDate()-f1.getDate())),z1}function Z0(M0){switch(M0.getDay()){case 0:return new Date(M0.getFullYear()-1,11,29);case 1:return M0;case 2:return new Date(M0.getFullYear(),0,3);case 3:return new Date(M0.getFullYear(),0,2);case 4:return new Date(M0.getFullYear(),0,1);case 5:return new Date(M0.getFullYear()-1,11,31);case 6:return new Date(M0.getFullYear()-1,11,30)}}function r1(M0){var f1=M0.$a;for(M0=new Date(new Date(M0.ab+1900,0,1).getTime());0<f1;){var p1=M0.getMonth(),z1=(hv(M0.getFullYear())?Qy:Oy)[p1];if(f1>z1-M0.getDate())f1-=z1-M0.getDate()+1,M0.setDate(1),11>p1?M0.setMonth(p1+1):(M0.setMonth(0),M0.setFullYear(M0.getFullYear()+1));else{M0.setDate(M0.getDate()+f1);break}}return p1=new Date(M0.getFullYear()+1,0,4),f1=Z0(new Date(M0.getFullYear(),0,4)),p1=Z0(p1),0>=H0(f1,M0)?0>=H0(p1,M0)?M0.getFullYear()+1:M0.getFullYear():M0.getFullYear()-1}Ir>>>=0,Xr>>>=0,In>>>=0,Qo>>>=0;var e1=Kr[Qo+40>>>2>>>0];Qo={Ab:_n[Qo>>>2>>>0],zb:_n[Qo+4>>>2>>>0],fb:_n[Qo+8>>>2>>>0],jb:_n[Qo+12>>>2>>>0],gb:_n[Qo+16>>>2>>>0],ab:_n[Qo+20>>>2>>>0],Va:_n[Qo+24>>>2>>>0],$a:_n[Qo+28>>>2>>>0],Cb:_n[Qo+32>>>2>>>0],yb:_n[Qo+36>>>2>>>0],Bb:e1?E0(e1):""},In=E0(In),e1={"%c":"%a %b %d %H:%M:%S %Y","%D":"%m/%d/%y","%F":"%Y-%m-%d","%h":"%b","%r":"%I:%M:%S %p","%R":"%H:%M","%T":"%H:%M:%S","%x":"%m/%d/%y","%X":"%H:%M:%S","%Ec":"%c","%EC":"%C","%Ex":"%m/%d/%y","%EX":"%H:%M:%S","%Ey":"%y","%EY":"%Y","%Od":"%d","%Oe":"%e","%OH":"%H","%OI":"%I","%Om":"%m","%OM":"%M","%OS":"%S","%Ou":"%u","%OU":"%U","%OV":"%V","%Ow":"%w","%OW":"%W","%Oy":"%y"};for(var $1 in e1)In=In.replace(new RegExp($1,"g"),e1[$1]);var B1="Sunday Monday Tuesday Wednesday Thursday Friday Saturday".split(" "),L0="January February March April May June July August September October November December".split(" ");e1={"%a":M0=>B1[M0.Va].substring(0,3),"%A":M0=>B1[M0.Va],"%b":M0=>L0[M0.gb].substring(0,3),"%B":M0=>L0[M0.gb],"%C":M0=>x0((M0.ab+1900)/100|0,2),"%d":M0=>x0(M0.jb,2),"%e":M0=>s0(M0.jb,2," "),"%g":M0=>r1(M0).toString().substring(2),"%G":r1,"%H":M0=>x0(M0.fb,2),"%I":M0=>(M0=M0.fb,M0==0?M0=12:12<M0&&(M0-=12),x0(M0,2)),"%j":M0=>{for(var f1=0,p1=0;p1<=M0.gb-1;f1+=(hv(M0.ab+1900)?Qy:Oy)[p1++]);return x0(M0.jb+f1,3)},"%m":M0=>x0(M0.gb+1,2),"%M":M0=>x0(M0.zb,2),"%n":()=>`
`,"%p":M0=>0<=M0.fb&&12>M0.fb?"AM":"PM","%S":M0=>x0(M0.Ab,2),"%t":()=>"	","%u":M0=>M0.Va||7,"%U":M0=>x0(Math.floor((M0.$a+7-M0.Va)/7),2),"%V":M0=>{var f1=Math.floor((M0.$a+7-(M0.Va+6)%7)/7);if(2>=(M0.Va+371-M0.$a-2)%7&&f1++,f1)f1==53&&(p1=(M0.Va+371-M0.$a)%7,p1==4||p1==3&&hv(M0.ab)||(f1=1));else{f1=52;var p1=(M0.Va+7-M0.$a-1)%7;(p1==4||p1==5&&hv(M0.ab%400-1))&&f1++}return x0(f1,2)},"%w":M0=>M0.Va,"%W":M0=>x0(Math.floor((M0.$a+7-(M0.Va+6)%7)/7),2),"%y":M0=>(M0.ab+1900).toString().substring(2),"%Y":M0=>M0.ab+1900,"%z":M0=>{M0=M0.yb;var f1=0<=M0;return M0=Math.abs(M0)/60,(f1?"+":"-")+("0000"+(M0/60*100+M0%60)).slice(-4)},"%Z":M0=>M0.Bb,"%%":()=>"%"},In=In.replace(/%%/g,"\0\0");for($1 in e1)In.includes($1)&&(In=In.replace(new RegExp($1,"g"),e1[$1](Qo)));return In=In.replace(/\0\0/g,"%"),$1=d$(In),$1.length>Xr?0:(zo.set($1,Ir>>>0),$1.length-1)}for(var Ay=Array(256),b1=0;256>b1;++b1)Ay[b1]=String.fromCharCode(b1);l1=Ay,P1=vt.BindingError=class extends Error{constructor(Ir){super(Ir),this.name="BindingError"}},vt.InternalError=class extends Error{constructor(Ir){super(Ir),this.name="InternalError"}},t1.push(0,1,void 0,1,null,1,!0,1,!1,1),vt.count_emval_handles=()=>t1.length/2-5-X1.length;var Fy={ia:function(Ir,Xr,In){return _v(async()=>{await vt.sb(Ir,Xr,In)})},a:function(Ir,Xr,In){Ir>>>=0;var Qo=new p0(Ir);throw Kr[Qo.hb+16>>>2>>>0]=0,Kr[Qo.hb+4>>>2>>>0]=Xr>>>0,Kr[Qo.hb+8>>>2>>>0]=In>>>0,$0=Ir,$0},y:function(){return 0},ea:function(){},R:function(){},T:function(){},ga:function(){return 0},ca:function(){},Z:function(){},ba:function(){},G:function(){},S:function(){},P:function(){},da:function(){},Q:function(){},C:function(Ir,Xr,In){Xr=n1(Xr>>>0),v1(Ir>>>0,{name:Xr,fromWireType:Qo=>Qo,toWireType:function(Qo,s0){if(typeof s0!="bigint"&&typeof s0!="number")throw s0===null?s0="null":(Qo=typeof s0,s0=Qo==="object"||Qo==="array"||Qo==="function"?s0.toString():""+s0),new TypeError(`Cannot convert "${s0}" to ${this.name}`);return typeof s0=="number"&&(s0=BigInt(s0)),s0},argPackAdvance:8,readValueFromPointer:_1(Xr,In>>>0,Xr.indexOf("u")==-1),bb:null})},K:function(Ir,Xr,In,Qo){Xr=n1(Xr>>>0),v1(Ir>>>0,{name:Xr,fromWireType:function(s0){return!!s0},toWireType:function(s0,x0){return x0?In:Qo},argPackAdvance:8,readValueFromPointer:function(s0){return this.fromWireType(t0[s0>>>0])},bb:null})},J:function(Ir){return v1(Ir>>>0,P0)},B:function(Ir,Xr,In){Xr=n1(Xr>>>0),v1(Ir>>>0,{name:Xr,fromWireType:Qo=>Qo,toWireType:(Qo,s0)=>s0,argPackAdvance:8,readValueFromPointer:R0(Xr,In>>>0),bb:null})},s:function(Ir,Xr,In,Qo,s0){if(Ir>>>=0,In>>>=0,Xr=n1(Xr>>>0),s0===-1&&(s0=4294967295),s0=Z0=>Z0,Qo===0){var x0=32-8*In;s0=Z0=>Z0<<x0>>>x0}var H0=Xr.includes("unsigned")?function(Z0,r1){return r1>>>0}:function(Z0,r1){return r1};v1(Ir,{name:Xr,fromWireType:s0,toWireType:H0,argPackAdvance:8,readValueFromPointer:_1(Xr,In,Qo!==0),bb:null})},o:function(Ir,Xr,In){function Qo(x0){return new s0(zo.buffer,Kr[x0+4>>>2>>>0],Kr[x0>>>2>>>0])}var s0=[Int8Array,Uint8Array,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array,BigInt64Array,BigUint64Array][Xr];In=n1(In>>>0),v1(Ir>>>0,{name:In,fromWireType:Qo,argPackAdvance:8,readValueFromPointer:Qo},{nb:!0})},D:function(Ir,Xr){Xr=n1(Xr>>>0);var In=Xr==="std::string";v1(Ir>>>0,{name:Xr,fromWireType:function(Qo){var s0=Kr[Qo>>>2>>>0],x0=Qo+4;if(In)for(var H0=x0,Z0=0;Z0<=s0;++Z0){var r1=x0+Z0;if(Z0==s0||t0[r1>>>0]==0){if(H0=E0(H0,r1-H0),e1===void 0)var e1=H0;else e1+="\0",e1+=H0;H0=r1+1}}else{for(e1=Array(s0),Z0=0;Z0<s0;++Z0)e1[Z0]=String.fromCharCode(t0[x0+Z0>>>0]);e1=e1.join("")}return yv(Qo),e1},toWireType:function(Qo,s0){s0 instanceof ArrayBuffer&&(s0=new Uint8Array(s0));var x0=typeof s0=="string";if(!(x0||s0 instanceof Uint8Array||s0 instanceof Uint8ClampedArray||s0 instanceof Int8Array))throw new P1("Cannot pass non-string to std::string");var H0=In&&x0?F0(s0):s0.length,Z0=jv(4+H0+1),r1=Z0+4;if(Kr[Z0>>>2>>>0]=H0,In&&x0)K0(s0,t0,r1,H0+1);else if(x0)for(x0=0;x0<H0;++x0){var e1=s0.charCodeAt(x0);if(255<e1)throw yv(r1),new P1("String has UTF-16 code units that do not fit in 8 bits");t0[r1+x0>>>0]=e1}else for(x0=0;x0<H0;++x0)t0[r1+x0>>>0]=s0[x0];return Qo!==null&&Qo.push(yv,Z0),Z0},argPackAdvance:8,readValueFromPointer:c0,bb(Qo){yv(Qo)}})},x:function(Ir,Xr,In){if(Xr>>>=0,In>>>=0,In=n1(In),Xr===2)var Qo=W0,s0=s1,x0=E1,H0=Z0=>No[Z0>>>1>>>0];else Xr===4&&(Qo=Q1,s0=K1,x0=W1,H0=Z0=>Kr[Z0>>>2>>>0]);v1(Ir>>>0,{name:In,fromWireType:Z0=>{for(var r1=Kr[Z0>>>2>>>0],e1,$1=Z0+4,B1=0;B1<=r1;++B1){var L0=Z0+4+B1*Xr;(B1==r1||H0(L0)==0)&&($1=Qo($1,L0-$1),e1===void 0?e1=$1:(e1+="\0",e1+=$1),$1=L0+Xr)}return yv(Z0),e1},toWireType:(Z0,r1)=>{if(typeof r1!="string")throw new P1(`Cannot pass non-string to C++ string type ${In}`);var e1=x0(r1),$1=jv(4+e1+Xr);return Kr[$1>>>2>>>0]=e1/Xr,s0(r1,$1+4,e1+Xr),Z0!==null&&Z0.push(yv,$1),$1},argPackAdvance:8,readValueFromPointer:c0,bb(Z0){yv(Z0)}})},L:function(Ir,Xr){Xr=n1(Xr>>>0),v1(Ir>>>0,{ob:!0,name:Xr,argPackAdvance:0,fromWireType:()=>{},toWireType:()=>{}})},ha:()=>1,u:function(Ir,Xr,In){return Xr>>>=0,In>>>=0,Ir=S1(Ir>>>0),Xr=nv(Xr,"emval::as"),Nv(Xr,In,Ir)},w:function(Ir){return Ir>>>=0,_v(()=>(Ir=S1(Ir),Ir.then(ev)))},n:function(Ir,Xr,In,Qo){return In>>>=0,Qo>>>=0,Ir=iy[Ir>>>0],Xr=S1(Xr>>>0),Ir(null,Xr,In,Qo)},j:function(Ir,Xr,In,Qo,s0){return In>>>=0,Qo>>>=0,s0>>>=0,Ir=iy[Ir>>>0],Xr=S1(Xr>>>0),In=Sv(In),Ir(Xr,Xr[In],Qo,s0)},b:cv,A:function(Ir,Xr){return Xr>>>=0,Ir=S1(Ir>>>0),Xr=S1(Xr),Ir==Xr},m:function(Ir){return Ir>>>=0,Ir===0?ev(Av()):(Ir=Sv(Ir),ev(Av()[Ir]))},i:function(Ir,Xr,In){Xr=Ey(Ir,Xr>>>0);var Qo=Xr.shift();Ir--;var s0=`return function (obj, func, destructorsRef, args) {
`,x0=0,H0=[];In===0&&H0.push("obj");for(var Z0=["retType"],r1=[Qo],e1=0;e1<Ir;++e1)H0.push("arg"+e1),Z0.push("argType"+e1),r1.push(Xr[e1]),s0+=`  var arg${e1} = argType${e1}.readValueFromPointer(args${x0?"+"+x0:""});
`,x0+=Xr[e1].argPackAdvance;return s0+=`  var rv = ${In===1?"new func":"func.call"}(${H0.join(", ")});
`,Qo.ob||(Z0.push("emval_returnValue"),r1.push(Nv),s0+=`  return emval_returnValue(retType, destructorsRef, rv);
`),Z0.push(s0+`};
`),Ir=Ky(Z0)(...r1),In=`methodCaller<(${Xr.map($1=>$1.name).join(", ")}) => ${Qo.name}>`,Qv(Lv(In,Ir))},r:function(Ir,Xr){return Xr>>>=0,Ir=S1(Ir>>>0),Xr=S1(Xr),ev(Ir[Xr])},e:function(Ir){Ir>>>=0,9<Ir&&(t1[Ir+1]+=1)},t:function(){return ev([])},l:function(Ir){Ir=S1(Ir>>>0);for(var Xr=Array(Ir.length),In=0;In<Ir.length;In++)Xr[In]=Ir[In];return ev(Xr)},f:function(Ir){return ev(Sv(Ir>>>0))},k:function(){return ev({})},h:function(Ir){Ir>>>=0;for(var Xr=S1(Ir);Xr.length;){var In=Xr.pop();Xr.pop()(In)}cv(Ir)},g:function(Ir,Xr,In){Xr>>>=0,In>>>=0,Ir=S1(Ir>>>0),Xr=S1(Xr),In=S1(In),Ir[Xr]=In},c:function(Ir,Xr){return Xr>>>=0,Ir=nv(Ir>>>0,"_emval_take_value"),Ir=Ir.readValueFromPointer(Xr),ev(Ir)},W:function(Ir,Xr){Ir=-9007199254740992>Ir||9007199254740992<Ir?NaN:Number(Ir),Xr>>>=0,Ir=new Date(1e3*Ir),_n[Xr>>>2>>>0]=Ir.getUTCSeconds(),_n[Xr+4>>>2>>>0]=Ir.getUTCMinutes(),_n[Xr+8>>>2>>>0]=Ir.getUTCHours(),_n[Xr+12>>>2>>>0]=Ir.getUTCDate(),_n[Xr+16>>>2>>>0]=Ir.getUTCMonth(),_n[Xr+20>>>2>>>0]=Ir.getUTCFullYear()-1900,_n[Xr+24>>>2>>>0]=Ir.getUTCDay(),_n[Xr+28>>>2>>>0]=(Ir.getTime()-Date.UTC(Ir.getUTCFullYear(),0,1,0,0,0,0))/864e5|0},X:function(Ir,Xr){Ir=-9007199254740992>Ir||9007199254740992<Ir?NaN:Number(Ir),Xr>>>=0,Ir=new Date(1e3*Ir),_n[Xr>>>2>>>0]=Ir.getSeconds(),_n[Xr+4>>>2>>>0]=Ir.getMinutes(),_n[Xr+8>>>2>>>0]=Ir.getHours(),_n[Xr+12>>>2>>>0]=Ir.getDate(),_n[Xr+16>>>2>>>0]=Ir.getMonth(),_n[Xr+20>>>2>>>0]=Ir.getFullYear()-1900,_n[Xr+24>>>2>>>0]=Ir.getDay(),_n[Xr+28>>>2>>>0]=(hv(Ir.getFullYear())?Ty:py)[Ir.getMonth()]+Ir.getDate()-1|0,_n[Xr+36>>>2>>>0]=-(60*Ir.getTimezoneOffset());var In=new Date(Ir.getFullYear(),6,1).getTimezoneOffset(),Qo=new Date(Ir.getFullYear(),0,1).getTimezoneOffset();_n[Xr+32>>>2>>>0]=(In!=Qo&&Ir.getTimezoneOffset()==Math.min(Qo,In))|0},Y:function(Ir){Ir>>>=0;var Xr=new Date(_n[Ir+20>>>2>>>0]+1900,_n[Ir+16>>>2>>>0],_n[Ir+12>>>2>>>0],_n[Ir+8>>>2>>>0],_n[Ir+4>>>2>>>0],_n[Ir>>>2>>>0],0),In=_n[Ir+32>>>2>>>0],Qo=Xr.getTimezoneOffset(),s0=new Date(Xr.getFullYear(),6,1).getTimezoneOffset(),x0=new Date(Xr.getFullYear(),0,1).getTimezoneOffset(),H0=Math.min(x0,s0);return 0>In?_n[Ir+32>>>2>>>0]=+(s0!=x0&&H0==Qo):0<In!=(H0==Qo)&&(s0=Math.max(x0,s0),Xr.setTime(Xr.getTime()+6e4*((0<In?H0:s0)-Qo))),_n[Ir+24>>>2>>>0]=Xr.getDay(),_n[Ir+28>>>2>>>0]=(hv(Xr.getFullYear())?Ty:py)[Xr.getMonth()]+Xr.getDate()-1|0,_n[Ir>>>2>>>0]=Xr.getSeconds(),_n[Ir+4>>>2>>>0]=Xr.getMinutes(),_n[Ir+8>>>2>>>0]=Xr.getHours(),_n[Ir+12>>>2>>>0]=Xr.getDate(),_n[Ir+16>>>2>>>0]=Xr.getMonth(),_n[Ir+20>>>2>>>0]=Xr.getYear(),Ir=Xr.getTime(),BigInt(isNaN(Ir)?-1:Ir/1e3)},U:function(){return-52},V:function(){},N:function(Ir,Xr,In,Qo){In>>>=0,Qo>>>=0;var s0=new Date().getFullYear(),x0=new Date(s0,0,1),H0=new Date(s0,6,1);s0=x0.getTimezoneOffset();var Z0=H0.getTimezoneOffset();Kr[Ir>>>0>>>2>>>0]=60*Math.max(s0,Z0),_n[Xr>>>0>>>2>>>0]=+(s0!=Z0),Ir=r1=>r1.toLocaleTimeString(void 0,{hour12:!1,timeZoneName:"short"}).split(" ")[1],x0=Ir(x0),H0=Ir(H0),Z0<s0?(K0(x0,t0,In,17),K0(H0,t0,Qo,17)):(K0(x0,t0,Qo,17),K0(H0,t0,In,17))},v:()=>{d0("")},d:function(Ir,Xr,In){return Ir>>>=0,Xr=Cy(Xr>>>0,In>>>0),w0[Ir](...Xr)},I:function(Ir,Xr,In){return Ir>>>=0,Xr=Cy(Xr>>>0,In>>>0),w0[Ir](...Xr)},H:()=>Date.now(),O:function(){return 4294901760},q:()=>performance.now(),M:function(Ir){Ir>>>=0;var Xr=t0.length;if(4294901760<Ir)return!1;for(var In=1;4>=In;In*=2){var Qo=Xr*(1+.2/In);Qo=Math.min(Qo,Ir+100663296);var s0=Math;Qo=Math.max(Ir,Qo);e:{s0=(s0.min.call(s0,4294901760,Qo+(65536-Qo%65536)%65536)-vn.buffer.byteLength+65535)/65536;try{vn.grow(s0),Tn();var x0=1;break e}catch{}x0=void 0}if(x0)return!0}return!1},$:function(Ir,Xr){Ir>>>=0,Xr>>>=0;var In=0;return Ev().forEach((Qo,s0)=>{var x0=Xr+In;for(s0=Kr[Ir+4*s0>>>2>>>0]=x0,x0=0;x0<Qo.length;++x0)zo[s0++>>>0]=Qo.charCodeAt(x0);zo[s0>>>0]=0,In+=Qo.length+1}),0},aa:function(Ir,Xr){Ir>>>=0,Xr>>>=0;var In=Ev();Kr[Ir>>>2>>>0]=In.length;var Qo=0;return In.forEach(s0=>Qo+=s0.length+1),Kr[Xr>>>2>>>0]=Qo,0},z:()=>52,F:function(){return 52},_:function(){return 70},E:function(Ir,Xr,In,Qo){Xr>>>=0,In>>>=0,Qo>>>=0;for(var s0=0,x0=0;x0<In;x0++){var H0=Kr[Xr>>>2>>>0],Z0=Kr[Xr+4>>>2>>>0];Xr+=8;for(var r1=0;r1<Z0;r1++){var e1=t0[H0+r1>>>0],$1=Zy[Ir];e1===0||e1===10?((Ir===1?qr:Yr)(g0($1,0)),$1.length=0):$1.push(e1)}s0+=Z0}return Kr[Qo>>>2>>>0]=s0,0},fa:Jy,p:function(Ir,Xr,In,Qo){return Jy(Ir>>>0,Xr>>>0,In>>>0,Qo>>>0)}},w1=function(){function Ir(In){return w1=In.exports,w1=N1(),w1=gy(),vn=w1.ja,Tn(),Go.unshift(w1.ka),a0--,a0==0&&u0&&(In=u0,u0=null,In()),w1}var Xr={a:Fy};if(a0++,vt.instantiateWasm)try{return vt.instantiateWasm(Xr,Ir)}catch(In){Yr(`Module.instantiateWasm callback failed with error: ${In}`),Ct(In)}return N0(Xr,function(In){Ir(In.instance)}).catch(Ct),{}}(),Py=Ir=>(Py=w1.la)(Ir);vt._OrtInit=(Ir,Xr)=>(vt._OrtInit=w1.ma)(Ir,Xr),vt._OrtGetLastError=(Ir,Xr)=>(vt._OrtGetLastError=w1.na)(Ir,Xr),vt._OrtCreateSessionOptions=(Ir,Xr,In,Qo,s0,x0,H0,Z0,r1,e1)=>(vt._OrtCreateSessionOptions=w1.oa)(Ir,Xr,In,Qo,s0,x0,H0,Z0,r1,e1),vt._OrtAppendExecutionProvider=(Ir,Xr)=>(vt._OrtAppendExecutionProvider=w1.pa)(Ir,Xr),vt._OrtAddFreeDimensionOverride=(Ir,Xr,In)=>(vt._OrtAddFreeDimensionOverride=w1.qa)(Ir,Xr,In),vt._OrtAddSessionConfigEntry=(Ir,Xr,In)=>(vt._OrtAddSessionConfigEntry=w1.ra)(Ir,Xr,In),vt._OrtReleaseSessionOptions=Ir=>(vt._OrtReleaseSessionOptions=w1.sa)(Ir),vt._OrtCreateSession=(Ir,Xr,In)=>(vt._OrtCreateSession=w1.ta)(Ir,Xr,In),vt._OrtReleaseSession=Ir=>(vt._OrtReleaseSession=w1.ua)(Ir),vt._OrtGetInputOutputCount=(Ir,Xr,In)=>(vt._OrtGetInputOutputCount=w1.va)(Ir,Xr,In),vt._OrtGetInputName=(Ir,Xr)=>(vt._OrtGetInputName=w1.wa)(Ir,Xr),vt._OrtGetOutputName=(Ir,Xr)=>(vt._OrtGetOutputName=w1.xa)(Ir,Xr),vt._OrtFree=Ir=>(vt._OrtFree=w1.ya)(Ir),vt._OrtCreateTensor=(Ir,Xr,In,Qo,s0,x0)=>(vt._OrtCreateTensor=w1.za)(Ir,Xr,In,Qo,s0,x0),vt._OrtGetTensorData=(Ir,Xr,In,Qo,s0)=>(vt._OrtGetTensorData=w1.Aa)(Ir,Xr,In,Qo,s0),vt._OrtReleaseTensor=Ir=>(vt._OrtReleaseTensor=w1.Ba)(Ir),vt._OrtCreateRunOptions=(Ir,Xr,In,Qo)=>(vt._OrtCreateRunOptions=w1.Ca)(Ir,Xr,In,Qo),vt._OrtAddRunConfigEntry=(Ir,Xr,In)=>(vt._OrtAddRunConfigEntry=w1.Da)(Ir,Xr,In),vt._OrtReleaseRunOptions=Ir=>(vt._OrtReleaseRunOptions=w1.Ea)(Ir),vt._OrtCreateBinding=Ir=>(vt._OrtCreateBinding=w1.Fa)(Ir),vt._OrtBindInput=(Ir,Xr,In)=>(vt._OrtBindInput=w1.Ga)(Ir,Xr,In),vt._OrtBindOutput=(Ir,Xr,In,Qo)=>(vt._OrtBindOutput=w1.Ha)(Ir,Xr,In,Qo),vt._OrtClearBoundOutputs=Ir=>(vt._OrtClearBoundOutputs=w1.Ia)(Ir),vt._OrtReleaseBinding=Ir=>(vt._OrtReleaseBinding=w1.Ja)(Ir),vt._OrtRunWithBinding=(Ir,Xr,In,Qo,s0)=>(vt._OrtRunWithBinding=w1.Ka)(Ir,Xr,In,Qo,s0),vt._OrtRun=(Ir,Xr,In,Qo,s0,x0,H0,Z0)=>(vt._OrtRun=w1.La)(Ir,Xr,In,Qo,s0,x0,H0,Z0),vt._OrtEndProfiling=Ir=>(vt._OrtEndProfiling=w1.Ma)(Ir),vt._JsepOutput=(Ir,Xr,In)=>(vt._JsepOutput=w1.Na)(Ir,Xr,In),vt._JsepGetNodeName=Ir=>(vt._JsepGetNodeName=w1.Oa)(Ir);var jv=vt._malloc=Ir=>(jv=vt._malloc=w1.Pa)(Ir),yv=vt._free=Ir=>(yv=vt._free=w1.Qa)(Ir),hy=Ir=>(hy=w1.Sa)(Ir),ay=Ir=>(ay=w1.Ta)(Ir),my=()=>(my=w1.Ua)(),Tv=Ir=>(Tv=w1.Wa)(Ir),ky=()=>(ky=w1.Xa)(),kv=Ir=>(kv=w1.Ya)(Ir),Dv=()=>(Dv=w1.Za)();vt.___start_em_js=837952,vt.___stop_em_js=838113;function gy(){var Ir=w1;Ir=Object.assign({},Ir);var Xr=In=>Qo=>In(Qo)>>>0;return Ir.la=Xr(Ir.la),Ir.Pa=Xr(Ir.Pa),Ir.Ta=Xr(Ir.Ta),Ir.Ua=(In=>()=>In()>>>0)(Ir.Ua),Ir}vt.stackSave=()=>my(),vt.stackRestore=Ir=>hy(Ir),vt.stackAlloc=Ir=>ay(Ir),vt.UTF8ToString=E0,vt.stringToUTF8=(Ir,Xr,In)=>K0(Ir,t0,Xr,In),vt.lengthBytesUTF8=F0;var Vv;u0=function Ir(){Vv||Mo(),Vv||(u0=Ir)};function Mo(){if(!(0<a0)){if(vt.preRun)for(typeof vt.preRun=="function"&&(vt.preRun=[vt.preRun]);vt.preRun.length;){var Ir=vt.preRun.shift();n0.unshift(Ir)}for(;0<n0.length;)n0.shift()(vt);if(!(0<a0||Vv||(Vv=!0,vt.calledRun=!0,ko))){for(;0<Go.length;)Go.shift()(vt);for(Tt(vt);0<An.length;)An.shift()(vt)}}}return Mo(),pt}})();typeof d=="object"&&typeof g=="object"?g.exports=b:typeof define=="function"&&define.amd&&define([],()=>b)}),Ba=Er(()=>{}),Da=Er(()=>{}),Ma={};kr(Ma,{cpus:()=>fc});var fc,Ua=j(()=>{fc=void 0}),Va=Er((d,g)=>{var b=(()=>{var st;var et=typeof document<"u"?(st=document.currentScript)==null?void 0:st.src:void 0;return typeof __filename<"u"&&(et||(et=__filename)),function(at={}){function vt(){return Sn.buffer!=An.buffer&&k0(),An}function Tt(){return Sn.buffer!=An.buffer&&k0(),a0}function Ct(){return Sn.buffer!=An.buffer&&k0(),u0}function pt(){return Sn.buffer!=An.buffer&&k0(),d0}function wt(){return Sn.buffer!=An.buffer&&k0(),f0}function $t(){return Sn.buffer!=An.buffer&&k0(),y0}function Lt(){return Sn.buffer!=An.buffer&&k0(),b0}function jt(){return Sn.buffer!=An.buffer&&k0(),v0}var Ft=at,Gt,Ht,qt=new Promise((Hr,xn)=>{Gt=Hr,Ht=xn});Ft.mountExternalData=(Hr,xn)=>{(Ft.Db||(Ft.Db=new Map)).set(Hr,xn)},Ft.unmountExternalData=()=>{delete Ft.Db};let Kt=()=>{let Hr=(Bo,i0,h0)=>(...S0)=>{let V0=Dv,J0=i0==null?void 0:i0();S0=Bo(...S0);let h1=i0==null?void 0:i0();return J0!==h1&&(Bo=h1,h0(J0),i0=h0=null),Dv!=V0?s0():S0},xn=Bo=>async(...i0)=>{var h0;try{if(Ft.Cb)throw Error("Session already started");let S0=Ft.Cb={ec:i0[0],errors:[]},V0=await Bo(...i0);if(Ft.Cb!==S0)throw Error("Session mismatch");(h0=Ft.Kb)==null||h0.flush();let J0=S0.errors;if(0<J0.length){let h1=await Promise.all(J0);if(h1=h1.filter(o1=>o1),0<h1.length)throw Error(h1.join(`
`))}return V0}finally{Ft.Cb=null}};Ft._OrtCreateSession=Hr(Ft._OrtCreateSession,()=>Ft._OrtCreateSession,Bo=>Ft._OrtCreateSession=Bo),Ft._OrtRun=xn(Hr(Ft._OrtRun,()=>Ft._OrtRun,Bo=>Ft._OrtRun=Bo)),Ft._OrtRunWithBinding=xn(Hr(Ft._OrtRunWithBinding,()=>Ft._OrtRunWithBinding,Bo=>Ft._OrtRunWithBinding=Bo)),Ft._OrtBindInput=Hr(Ft._OrtBindInput,()=>Ft._OrtBindInput,Bo=>Ft._OrtBindInput=Bo),Kt=void 0};Ft.jsepInit=(Hr,xn)=>{if(Kt==null||Kt(),Hr==="webgpu"){[Ft.Kb,Ft.Wb,Ft.$b,Ft.Lb,Ft.Zb,Ft.ob,Ft.ac,Ft.cc,Ft.Xb,Ft.Yb,Ft.bc]=xn;let Bo=Ft.Kb;Ft.jsepRegisterBuffer=(i0,h0,S0,V0)=>Bo.registerBuffer(i0,h0,S0,V0),Ft.jsepGetBuffer=i0=>Bo.getBuffer(i0),Ft.jsepCreateDownloader=(i0,h0,S0)=>Bo.createDownloader(i0,h0,S0),Ft.jsepOnReleaseSession=i0=>{Bo.onReleaseSession(i0)},Ft.jsepOnRunStart=i0=>Bo.onRunStart(i0)}};var rr=Object.assign({},Ft),ir="./this.program",or=(Hr,xn)=>{throw xn},jr=typeof window=="object",qr=typeof importScripts=="function",Yr=typeof process=="object"&&typeof process.versions=="object"&&typeof process.versions.node=="string",vn=Ft.ENVIRONMENT_IS_PTHREAD||!1,ko="";function Xo(Hr){return Ft.locateFile?Ft.locateFile(Hr,ko):ko+Hr}var zo,t0,Uo;if(Yr){var No=(Mi(),sr(Di)),_n=(Wi(),sr(Ui));ko=qr?_n.dirname(ko)+"/":__dirname+"/",zo=(Hr,xn)=>(Hr=K0(Hr)?new URL(Hr):_n.normalize(Hr),No.readFileSync(Hr,xn?void 0:"utf8")),Uo=Hr=>(Hr=zo(Hr,!0),Hr.buffer||(Hr=new Uint8Array(Hr)),Hr),t0=(Hr,xn,Bo,i0=!0)=>{Hr=K0(Hr)?new URL(Hr):_n.normalize(Hr),No.readFile(Hr,i0?void 0:"utf8",(h0,S0)=>{h0?Bo(h0):xn(i0?S0.buffer:S0)})},!Ft.thisProgram&&1<process.argv.length&&(ir=process.argv[1].replace(/\\/g,"/")),process.argv.slice(2),or=(Hr,xn)=>{throw process.exitCode=Hr,xn},global.Worker=Ba().Worker}else(jr||qr)&&(qr?ko=self.location.href:typeof document<"u"&&document.currentScript&&(ko=document.currentScript.src),typeof et<"u"&&et&&(ko=et),ko.startsWith("blob:")?ko="":ko=ko.substr(0,ko.replace(/[?#].*/,"").lastIndexOf("/")+1),Yr||(zo=Hr=>{var xn=new XMLHttpRequest;return xn.open("GET",Hr,!1),xn.send(null),xn.responseText},qr&&(Uo=Hr=>{var xn=new XMLHttpRequest;return xn.open("GET",Hr,!1),xn.responseType="arraybuffer",xn.send(null),new Uint8Array(xn.response)}),t0=(Hr,xn,Bo)=>{var i0=new XMLHttpRequest;i0.open("GET",Hr,!0),i0.responseType="arraybuffer",i0.onload=()=>{i0.status==200||i0.status==0&&i0.response?xn(i0.response):Bo()},i0.onerror=Bo,i0.send(null)}));Yr&&typeof performance>"u"&&(global.performance=Da().performance);var Kr=console.log.bind(console),e0=console.error.bind(console);Yr&&(Kr=(...Hr)=>No.writeSync(1,Hr.join(" ")+`
`),e0=(...Hr)=>No.writeSync(2,Hr.join(" ")+`
`));var Zr=Kr,Ro=e0;Object.assign(Ft,rr),rr=null;var Sn,Tn,n0=!1,Go,An,a0,u0,d0,f0,y0,b0,O0,C0,v0;function k0(){var Hr=Sn.buffer;Ft.HEAP8=An=new Int8Array(Hr),Ft.HEAP16=u0=new Int16Array(Hr),Ft.HEAPU8=a0=new Uint8Array(Hr),Ft.HEAPU16=d0=new Uint16Array(Hr),Ft.HEAP32=f0=new Int32Array(Hr),Ft.HEAPU32=y0=new Uint32Array(Hr),Ft.HEAPF32=b0=new Float32Array(Hr),Ft.HEAPF64=v0=new Float64Array(Hr),Ft.HEAP64=O0=new BigInt64Array(Hr),Ft.HEAPU64=C0=new BigUint64Array(Hr)}var N0=16777216;if(vn)Sn=Ft.wasmMemory;else if(Ft.wasmMemory)Sn=Ft.wasmMemory;else if(Sn=new WebAssembly.Memory({initial:N0/65536,maximum:65536,shared:!0}),!(Sn.buffer instanceof SharedArrayBuffer))throw Ro("requested a shared WebAssembly.Memory but the returned buffer is not a SharedArrayBuffer, indicating that while the browser has SharedArrayBuffer it does not have WebAssembly threads support - you may need to set a flag"),Yr&&Ro("(on node you may need: --experimental-wasm-threads --experimental-wasm-bulk-memory and/or recent version)"),Error("bad memory");k0(),N0=Sn.buffer.byteLength;var w0=[],r0=[],p0=[],$0=0,A0=null;function g0(){if($0--,$0==0&&A0){var Hr=A0;A0=null,Hr()}}function E0(Hr){throw Hr="Aborted("+Hr+")",Ro(Hr),n0=!0,Go=1,Hr=new WebAssembly.RuntimeError(Hr+". Build with -sASSERTIONS for more info."),Ht(Hr),Hr}var F0=Hr=>Hr.startsWith("data:application/octet-stream;base64,"),K0=Hr=>Hr.startsWith("file://"),l1;l1="ort-wasm-simd-threaded.wasm",F0(l1)||(l1=Xo(l1));function n1(Hr){if(Uo)return Uo(Hr);throw"both async and sync fetching of the wasm failed"}function x1(Hr){if(jr||qr){if(typeof fetch=="function"&&!K0(Hr))return fetch(Hr,{credentials:"same-origin"}).then(xn=>{if(!xn.ok)throw`failed to load wasm binary file at '${Hr}'`;return xn.arrayBuffer()}).catch(()=>n1(Hr));if(t0)return new Promise((xn,Bo)=>{t0(Hr,i0=>xn(new Uint8Array(i0)),Bo)})}return Promise.resolve().then(()=>n1(Hr))}function u1(Hr,xn,Bo){return x1(Hr).then(i0=>WebAssembly.instantiate(i0,xn)).then(Bo,i0=>{Ro(`failed to asynchronously prepare wasm: ${i0}`),E0(i0)})}function P1(Hr,xn){var Bo=l1;return typeof WebAssembly.instantiateStreaming!="function"||F0(Bo)||K0(Bo)||Yr||typeof fetch!="function"?u1(Bo,Hr,xn):fetch(Bo,{credentials:"same-origin"}).then(i0=>WebAssembly.instantiateStreaming(i0,Hr).then(xn,function(h0){return Ro(`wasm streaming compile failed: ${h0}`),Ro("falling back to ArrayBuffer instantiation"),u1(Bo,Hr,xn)}))}var i1={826468:(Hr,xn,Bo,i0)=>{if(typeof Ft>"u"||!Ft.Db)return 1;if(Hr=j0(Hr>>>0),Hr.startsWith("./")&&(Hr=Hr.substring(2)),Hr=Ft.Db.get(Hr),!Hr)return 2;if(xn>>>=0,Bo>>>=0,i0>>>=0,xn+Bo>Hr.byteLength)return 3;try{return Tt().set(Hr.subarray(xn,xn+Bo),i0>>>0),0}catch{return 4}},826969:()=>{Ft.Xb()},827e3:()=>{Ft.Yb()},827029:()=>{Ft.bc()},827054:Hr=>Ft.Wb(Hr),827087:Hr=>Ft.$b(Hr),827119:(Hr,xn,Bo)=>{Ft.Lb(Hr,xn,Bo,!0)},827158:(Hr,xn,Bo)=>{Ft.Lb(Hr,xn,Bo)},827191:Hr=>{Ft.ob("Abs",Hr,void 0)},827242:Hr=>{Ft.ob("Neg",Hr,void 0)},827293:Hr=>{Ft.ob("Floor",Hr,void 0)},827346:Hr=>{Ft.ob("Ceil",Hr,void 0)},827398:Hr=>{Ft.ob("Reciprocal",Hr,void 0)},827456:Hr=>{Ft.ob("Sqrt",Hr,void 0)},827508:Hr=>{Ft.ob("Exp",Hr,void 0)},827559:Hr=>{Ft.ob("Erf",Hr,void 0)},827610:Hr=>{Ft.ob("Sigmoid",Hr,void 0)},827665:(Hr,xn,Bo)=>{Ft.ob("HardSigmoid",Hr,{alpha:xn,beta:Bo})},827744:Hr=>{Ft.ob("Log",Hr,void 0)},827795:Hr=>{Ft.ob("Sin",Hr,void 0)},827846:Hr=>{Ft.ob("Cos",Hr,void 0)},827897:Hr=>{Ft.ob("Tan",Hr,void 0)},827948:Hr=>{Ft.ob("Asin",Hr,void 0)},828e3:Hr=>{Ft.ob("Acos",Hr,void 0)},828052:Hr=>{Ft.ob("Atan",Hr,void 0)},828104:Hr=>{Ft.ob("Sinh",Hr,void 0)},828156:Hr=>{Ft.ob("Cosh",Hr,void 0)},828208:Hr=>{Ft.ob("Asinh",Hr,void 0)},828261:Hr=>{Ft.ob("Acosh",Hr,void 0)},828314:Hr=>{Ft.ob("Atanh",Hr,void 0)},828367:Hr=>{Ft.ob("Tanh",Hr,void 0)},828419:Hr=>{Ft.ob("Not",Hr,void 0)},828470:(Hr,xn,Bo)=>{Ft.ob("Clip",Hr,{min:xn,max:Bo})},828539:Hr=>{Ft.ob("Clip",Hr,void 0)},828591:(Hr,xn)=>{Ft.ob("Elu",Hr,{alpha:xn})},828649:Hr=>{Ft.ob("Relu",Hr,void 0)},828701:(Hr,xn)=>{Ft.ob("LeakyRelu",Hr,{alpha:xn})},828765:(Hr,xn)=>{Ft.ob("ThresholdedRelu",Hr,{alpha:xn})},828835:(Hr,xn)=>{Ft.ob("Cast",Hr,{to:xn})},828893:Hr=>{Ft.ob("Add",Hr,void 0)},828944:Hr=>{Ft.ob("Sub",Hr,void 0)},828995:Hr=>{Ft.ob("Mul",Hr,void 0)},829046:Hr=>{Ft.ob("Div",Hr,void 0)},829097:Hr=>{Ft.ob("Pow",Hr,void 0)},829148:Hr=>{Ft.ob("Equal",Hr,void 0)},829201:Hr=>{Ft.ob("Greater",Hr,void 0)},829256:Hr=>{Ft.ob("GreaterOrEqual",Hr,void 0)},829318:Hr=>{Ft.ob("Less",Hr,void 0)},829370:Hr=>{Ft.ob("LessOrEqual",Hr,void 0)},829429:(Hr,xn,Bo,i0,h0)=>{Ft.ob("ReduceMean",Hr,{keepDims:!!xn,noopWithEmptyAxes:!!Bo,axes:i0?Array.from(wt().subarray(i0>>>0,h0>>>0)):[]})},829588:(Hr,xn,Bo,i0,h0)=>{Ft.ob("ReduceMax",Hr,{keepDims:!!xn,noopWithEmptyAxes:!!Bo,axes:i0?Array.from(wt().subarray(i0>>>0,h0>>>0)):[]})},829746:(Hr,xn,Bo,i0,h0)=>{Ft.ob("ReduceMin",Hr,{keepDims:!!xn,noopWithEmptyAxes:!!Bo,axes:i0?Array.from(wt().subarray(i0>>>0,h0>>>0)):[]})},829904:(Hr,xn,Bo,i0,h0)=>{Ft.ob("ReduceProd",Hr,{keepDims:!!xn,noopWithEmptyAxes:!!Bo,axes:i0?Array.from(wt().subarray(i0>>>0,h0>>>0)):[]})},830063:(Hr,xn,Bo,i0,h0)=>{Ft.ob("ReduceSum",Hr,{keepDims:!!xn,noopWithEmptyAxes:!!Bo,axes:i0?Array.from(wt().subarray(i0>>>0,h0>>>0)):[]})},830221:(Hr,xn,Bo,i0,h0)=>{Ft.ob("ReduceL1",Hr,{keepDims:!!xn,noopWithEmptyAxes:!!Bo,axes:i0?Array.from(wt().subarray(i0>>>0,h0>>>0)):[]})},830378:(Hr,xn,Bo,i0,h0)=>{Ft.ob("ReduceL2",Hr,{keepDims:!!xn,noopWithEmptyAxes:!!Bo,axes:i0?Array.from(wt().subarray(i0>>>0,h0>>>0)):[]})},830535:(Hr,xn,Bo,i0,h0)=>{Ft.ob("ReduceLogSum",Hr,{keepDims:!!xn,noopWithEmptyAxes:!!Bo,axes:i0?Array.from(wt().subarray(i0>>>0,h0>>>0)):[]})},830696:(Hr,xn,Bo,i0,h0)=>{Ft.ob("ReduceSumSquare",Hr,{keepDims:!!xn,noopWithEmptyAxes:!!Bo,axes:i0?Array.from(wt().subarray(i0>>>0,h0>>>0)):[]})},830860:(Hr,xn,Bo,i0,h0)=>{Ft.ob("ReduceLogSumExp",Hr,{keepDims:!!xn,noopWithEmptyAxes:!!Bo,axes:i0?Array.from(wt().subarray(i0>>>0,h0>>>0)):[]})},831024:Hr=>{Ft.ob("Where",Hr,void 0)},831077:(Hr,xn,Bo)=>{Ft.ob("Transpose",Hr,{perm:xn?Array.from(wt().subarray(xn>>>0,Bo>>>0)):[]})},831185:(Hr,xn,Bo,i0)=>{Ft.ob("DepthToSpace",Hr,{blocksize:xn,mode:j0(Bo),format:i0?"NHWC":"NCHW"})},831318:(Hr,xn,Bo,i0)=>{Ft.ob("DepthToSpace",Hr,{blocksize:xn,mode:j0(Bo),format:i0?"NHWC":"NCHW"})},831451:(Hr,xn,Bo,i0,h0,S0,V0,J0,h1,o1,C1,Z1,q1,U0,R1)=>{Ft.ob("ConvTranspose",Hr,{format:h1?"NHWC":"NCHW",autoPad:xn,dilations:[Bo],group:i0,kernelShape:[h0],pads:[S0,V0],strides:[J0],wIsConst:()=>!!vt()[o1>>>0],outputPadding:C1?Array.from(wt().subarray(C1>>>0,Z1>>>0)):[],outputShape:q1?Array.from(wt().subarray(q1>>>0,U0>>>0)):[],activation:j0(R1)})},831852:(Hr,xn,Bo,i0,h0,S0,V0,J0,h1,o1,C1,Z1,q1,U0)=>{Ft.ob("ConvTranspose",Hr,{format:J0?"NHWC":"NCHW",autoPad:xn,dilations:Array.from(wt().subarray(Bo>>>0,(Bo>>>0)+2>>>0)),group:i0,kernelShape:Array.from(wt().subarray(h0>>>0,(h0>>>0)+2>>>0)),pads:Array.from(wt().subarray(S0>>>0,(S0>>>0)+4>>>0)),strides:Array.from(wt().subarray(V0>>>0,(V0>>>0)+2>>>0)),wIsConst:()=>!!vt()[h1>>>0],outputPadding:o1?Array.from(wt().subarray(o1>>>0,C1>>>0)):[],outputShape:Z1?Array.from(wt().subarray(Z1>>>0,q1>>>0)):[],activation:j0(U0)})},832417:(Hr,xn,Bo,i0,h0,S0,V0,J0,h1,o1,C1,Z1,q1,U0,R1)=>{Ft.ob("ConvTranspose",Hr,{format:h1?"NHWC":"NCHW",autoPad:xn,dilations:[Bo],group:i0,kernelShape:[h0],pads:[S0,V0],strides:[J0],wIsConst:()=>!!vt()[o1>>>0],outputPadding:C1?Array.from(wt().subarray(C1>>>0,Z1>>>0)):[],outputShape:q1?Array.from(wt().subarray(q1>>>0,U0>>>0)):[],activation:j0(R1)})},832818:(Hr,xn,Bo,i0,h0,S0,V0,J0,h1,o1,C1,Z1,q1,U0)=>{Ft.ob("ConvTranspose",Hr,{format:J0?"NHWC":"NCHW",autoPad:xn,dilations:Array.from(wt().subarray(Bo>>>0,(Bo>>>0)+2>>>0)),group:i0,kernelShape:Array.from(wt().subarray(h0>>>0,(h0>>>0)+2>>>0)),pads:Array.from(wt().subarray(S0>>>0,(S0>>>0)+4>>>0)),strides:Array.from(wt().subarray(V0>>>0,(V0>>>0)+2>>>0)),wIsConst:()=>!!vt()[h1>>>0],outputPadding:o1?Array.from(wt().subarray(o1>>>0,C1>>>0)):[],outputShape:Z1?Array.from(wt().subarray(Z1>>>0,q1>>>0)):[],activation:j0(U0)})},833383:(Hr,xn)=>{Ft.ob("GlobalAveragePool",Hr,{format:xn?"NHWC":"NCHW"})},833474:(Hr,xn,Bo,i0,h0,S0,V0,J0,h1,o1,C1,Z1,q1,U0,R1,H1)=>{Ft.ob("AveragePool",Hr,{format:H1?"NHWC":"NCHW",auto_pad:xn,ceil_mode:Bo,count_include_pad:i0,storage_order:h0,dilations:[S0,V0],kernel_shape:[J0,h1],pads:[o1,C1,Z1,q1],strides:[U0,R1]})},833758:(Hr,xn)=>{Ft.ob("GlobalAveragePool",Hr,{format:xn?"NHWC":"NCHW"})},833849:(Hr,xn,Bo,i0,h0,S0,V0,J0,h1,o1,C1,Z1,q1,U0,R1,H1)=>{Ft.ob("AveragePool",Hr,{format:H1?"NHWC":"NCHW",auto_pad:xn,ceil_mode:Bo,count_include_pad:i0,storage_order:h0,dilations:[S0,V0],kernel_shape:[J0,h1],pads:[o1,C1,Z1,q1],strides:[U0,R1]})},834133:(Hr,xn)=>{Ft.ob("GlobalMaxPool",Hr,{format:xn?"NHWC":"NCHW"})},834220:(Hr,xn,Bo,i0,h0,S0,V0,J0,h1,o1,C1,Z1,q1,U0,R1,H1)=>{Ft.ob("MaxPool",Hr,{format:H1?"NHWC":"NCHW",auto_pad:xn,ceil_mode:Bo,count_include_pad:i0,storage_order:h0,dilations:[S0,V0],kernel_shape:[J0,h1],pads:[o1,C1,Z1,q1],strides:[U0,R1]})},834500:(Hr,xn)=>{Ft.ob("GlobalMaxPool",Hr,{format:xn?"NHWC":"NCHW"})},834587:(Hr,xn,Bo,i0,h0,S0,V0,J0,h1,o1,C1,Z1,q1,U0,R1,H1)=>{Ft.ob("MaxPool",Hr,{format:H1?"NHWC":"NCHW",auto_pad:xn,ceil_mode:Bo,count_include_pad:i0,storage_order:h0,dilations:[S0,V0],kernel_shape:[J0,h1],pads:[o1,C1,Z1,q1],strides:[U0,R1]})},834867:(Hr,xn,Bo,i0,h0)=>{Ft.ob("Gemm",Hr,{alpha:xn,beta:Bo,transA:i0,transB:h0})},834971:Hr=>{Ft.ob("MatMul",Hr,void 0)},835025:(Hr,xn,Bo,i0)=>{Ft.ob("ArgMax",Hr,{keepDims:!!xn,selectLastIndex:!!Bo,axis:i0})},835133:(Hr,xn,Bo,i0)=>{Ft.ob("ArgMin",Hr,{keepDims:!!xn,selectLastIndex:!!Bo,axis:i0})},835241:(Hr,xn)=>{Ft.ob("Softmax",Hr,{axis:xn})},835304:(Hr,xn)=>{Ft.ob("Concat",Hr,{axis:xn})},835364:(Hr,xn,Bo,i0,h0)=>{Ft.ob("Split",Hr,{axis:xn,numOutputs:Bo,splitSizes:i0?Array.from(wt().subarray(i0>>>0,h0>>>0)):[]})},835504:Hr=>{Ft.ob("Expand",Hr,void 0)},835558:(Hr,xn)=>{Ft.ob("Gather",Hr,{axis:Number(xn)})},835629:(Hr,xn)=>{Ft.ob("GatherElements",Hr,{axis:Number(xn)})},835708:(Hr,xn,Bo,i0,h0,S0,V0,J0,h1,o1,C1)=>{Ft.ob("Resize",Hr,{antialias:xn,axes:Bo?Array.from(wt().subarray(Bo>>>0,i0>>>0)):[],coordinateTransformMode:j0(h0),cubicCoeffA:S0,excludeOutside:V0,extrapolationValue:J0,keepAspectRatioPolicy:j0(h1),mode:j0(o1),nearestMode:j0(C1)})},836054:(Hr,xn,Bo,i0,h0,S0,V0)=>{Ft.ob("Slice",Hr,{starts:xn?Array.from(wt().subarray(xn>>>0,Bo>>>0)):[],ends:i0?Array.from(wt().subarray(i0>>>0,h0>>>0)):[],axes:S0?Array.from(wt().subarray(S0>>>0,V0>>>0)):[]})},836270:Hr=>{Ft.ob("Tile",Hr,void 0)},836322:(Hr,xn,Bo,i0)=>{Ft.ob("LayerNormalization",Hr,{axis:xn,epsilon:Bo,simplified:!!i0})},836433:(Hr,xn,Bo)=>{Ft.ob("InstanceNormalization",Hr,{epsilon:xn,format:Bo?"NHWC":"NCHW"})},836547:(Hr,xn,Bo)=>{Ft.ob("InstanceNormalization",Hr,{epsilon:xn,format:Bo?"NHWC":"NCHW"})},836661:Hr=>{Ft.ob("Range",Hr,void 0)},836714:(Hr,xn)=>{Ft.ob("Einsum",Hr,{equation:j0(xn)})},836795:(Hr,xn,Bo,i0,h0)=>{Ft.ob("Pad",Hr,{mode:xn,value:Bo,pads:i0?Array.from(wt().subarray(i0>>>0,h0>>>0)):[]})},836922:(Hr,xn,Bo,i0,h0,S0)=>{Ft.ob("BatchNormalization",Hr,{epsilon:xn,momentum:Bo,spatial:!!h0,trainingMode:!!i0,format:S0?"NHWC":"NCHW"})},837091:(Hr,xn,Bo,i0,h0,S0)=>{Ft.ob("BatchNormalization",Hr,{epsilon:xn,momentum:Bo,spatial:!!h0,trainingMode:!!i0,format:S0?"NHWC":"NCHW"})},837260:(Hr,xn,Bo)=>{Ft.ob("CumSum",Hr,{exclusive:Number(xn),reverse:Number(Bo)})},837357:(Hr,xn,Bo,i0,h0,S0,V0,J0,h1)=>{Ft.ob("Attention",Hr,{numHeads:xn,isUnidirectional:Bo,maskFilterValue:i0,scale:h0,doRotary:S0,qkvHiddenSizes:V0?Array.from(wt().subarray(Number(J0)>>>0,Number(J0)+V0>>>0)):[],pastPresentShareBuffer:!!h1})},837629:Hr=>{Ft.ob("BiasAdd",Hr,void 0)},837684:Hr=>{Ft.ob("BiasSplitGelu",Hr,void 0)},837745:Hr=>{Ft.ob("FastGelu",Hr,void 0)},837801:(Hr,xn,Bo,i0,h0,S0,V0,J0,h1,o1,C1,Z1,q1)=>{Ft.ob("Conv",Hr,{format:h1?"NHWC":"NCHW",auto_pad:xn,dilations:[Bo],group:i0,kernel_shape:[h0],pads:S0?Array.from(wt().subarray(S0>>>0,V0>>>0)):[],strides:[J0],w_is_const:()=>!!vt()[o1>>>0],activation:j0(C1),activation_params:Z1?Array.from(Lt().subarray(Z1>>>0,q1>>>0)):[]})},838171:(Hr,xn,Bo,i0,h0,S0,V0,J0,h1,o1,C1,Z1,q1,U0,R1,H1)=>{Ft.ob("Conv",Hr,{format:Z1?"NHWC":"NCHW",auto_pad:xn,dilations:[Bo,i0],group:h0,kernel_shape:[S0,V0],pads:J0?Array.from(wt().subarray(J0>>>0,h1>>>0)):[],strides:[o1,C1],w_is_const:()=>!!vt()[q1>>>0],activation:j0(U0),activation_params:R1?Array.from(Lt().subarray(R1>>>0,H1>>>0)):[]})},838562:Hr=>{Ft.ob("Gelu",Hr,void 0)},838614:(Hr,xn,Bo,i0,h0,S0)=>{Ft.ob("MatMulNBits",Hr,{k:xn,n:Bo,accuracyLevel:i0,bits:h0,blockSize:S0})},838741:(Hr,xn,Bo,i0,h0,S0)=>{Ft.ob("MultiHeadAttention",Hr,{numHeads:xn,isUnidirectional:Bo,maskFilterValue:i0,scale:h0,doRotary:S0})},838900:(Hr,xn,Bo,i0,h0)=>{Ft.ob("RotaryEmbedding",Hr,{interleaved:!!xn,numHeads:Bo,rotaryEmbeddingDim:i0,scale:h0})},839039:(Hr,xn,Bo)=>{Ft.ob("SkipLayerNormalization",Hr,{epsilon:xn,simplified:!!Bo})},839141:(Hr,xn,Bo)=>{Ft.ob("SkipLayerNormalization",Hr,{epsilon:xn,simplified:!!Bo})},839243:(Hr,xn,Bo,i0)=>{Ft.ob("LayerNormalization",Hr,{axis:xn,epsilon:Bo,simplified:!!i0})},839354:Hr=>{Ft.ac(Hr)},839388:(Hr,xn)=>Ft.cc(Hr,xn,Ft.Cb.ec,Ft.Cb.errors)};function v1(Hr){this.name="ExitStatus",this.message=`Program terminated with exit(${Hr})`,this.status=Hr}var _1=Hr=>{Hr.terminate(),Hr.onmessage=()=>{}},X1=Hr=>{W0.xb.length==0&&(R0(),W0.Mb(W0.xb[0]));var xn=W0.xb.pop();if(!xn)return 6;W0.yb.push(xn),W0.ub[Hr.wb]=xn,xn.wb=Hr.wb;var Bo={cmd:"run",start_routine:Hr.fc,arg:Hr.Rb,pthread_ptr:Hr.wb};return Yr&&xn.unref(),xn.postMessage(Bo,Hr.mc),0},t1=0,cv=Hr=>{var xn=Ex();return Hr=Hr(),e$(xn),Hr},S1=(Hr,xn,...Bo)=>cv(()=>{for(var i0=2*Bo.length,h0=Uy(8*i0),S0=h0>>>3,V0=0;V0<Bo.length;V0++){var J0=Bo[V0];typeof J0=="bigint"?(O0[S0+2*V0]=1n,O0[S0+2*V0+1]=J0):(O0[S0+2*V0]=0n,jt()[S0+2*V0+1>>>0]=J0)}return W$(Hr,0,i0,h0,xn)});function ev(Hr){var xn;if(vn)return S1(0,1,Hr);Go=Hr,0<t1||(W0.hc(),(xn=Ft.onExit)==null||xn.call(Ft,Hr),n0=!0),or(Hr,new v1(Hr))}var c0=Hr=>{if(Go=Hr,vn)throw E1(Hr),"unwind";ev(Hr)};function P0(){for(var Hr=Ft.numThreads;Hr--;)R0();w0.unshift(()=>{$0++,B0(()=>g0())})}function R0(){var Hr=Xo("ort-wasm-simd-threaded.worker.js");Hr=new Worker(Hr),W0.xb.push(Hr)}function B0(Hr){vn?Hr():Promise.all(W0.xb.map(W0.Mb)).then(Hr)}var W0={xb:[],yb:[],Qb:[],ub:{},Gb(){vn?(W0.receiveObjectTransfer=W0.dc,W0.threadInitTLS=W0.Pb,W0.setExitStatus=W0.Ob):P0()},Ob:Hr=>Go=Hr,pc:["$terminateWorker"],hc:()=>{for(var Hr of W0.yb)_1(Hr);for(Hr of W0.xb)_1(Hr);W0.xb=[],W0.yb=[],W0.ub=[]},Nb:Hr=>{var xn=Hr.wb;delete W0.ub[xn],W0.xb.push(Hr),W0.yb.splice(W0.yb.indexOf(Hr),1),Hr.wb=0,wx(xn)},dc(){},Pb(){W0.Qb.forEach(Hr=>Hr())},Mb:Hr=>new Promise(xn=>{Hr.onmessage=S0=>{S0=S0.data;var V0=S0.cmd;if(S0.targetThread&&S0.targetThread!=ov()){var J0=W0.ub[S0.targetThread];J0?J0.postMessage(S0,S0.transferList):Ro(`Internal error! Worker sent a message "${V0}" to target pthread ${S0.targetThread}, but that thread no longer exists!`)}else V0==="checkMailbox"?yv():V0==="spawnThread"?X1(S0):V0==="cleanupThread"?W0.Nb(W0.ub[S0.thread]):V0==="killThread"?(S0=S0.thread,V0=W0.ub[S0],delete W0.ub[S0],_1(V0),wx(S0),W0.yb.splice(W0.yb.indexOf(V0),1),V0.wb=0):V0==="cancelThread"?W0.ub[S0.thread].postMessage({cmd:"cancel"}):V0==="loaded"?(Hr.loaded=!0,Yr&&!Hr.wb&&Hr.unref(),xn(Hr)):V0==="alert"?alert(`Thread ${S0.threadId}: ${S0.text}`):S0.target==="setimmediate"?Hr.postMessage(S0):V0==="callHandler"?Ft[S0.handler](...S0.args):V0&&Ro(`worker sent an unknown command ${V0}`)},Hr.onerror=S0=>{throw Ro(`worker sent an error! ${S0.filename}:${S0.lineno}: ${S0.message}`),S0},Yr&&(Hr.on("message",S0=>Hr.onmessage({data:S0})),Hr.on("error",S0=>Hr.onerror(S0)));var Bo=[],i0=["onExit"],h0;for(h0 of i0)Ft.hasOwnProperty(h0)&&Bo.push(h0);Hr.postMessage({cmd:"load",handlers:Bo,urlOrBlob:Ft.mainScriptUrlOrBlob||et,wasmMemory:Sn,wasmModule:Tn})})};Ft.PThread=W0;var s1=Hr=>{for(;0<Hr.length;)Hr.shift()(Ft)};Ft.establishStackSpace=()=>{var Hr=ov(),xn=$t()[Hr+52>>>2>>>0];Hr=$t()[Hr+56>>>2>>>0],Sx(xn,xn-Hr),e$(xn)};function E1(Hr){if(vn)return S1(1,0,Hr);c0(Hr)}Ft.invokeEntryPoint=(Hr,xn)=>{t1=0,Hr=Tx(Hr,xn),0<t1?W0.Ob(Hr):_x(Hr)};class Q1{constructor(xn){this.Ib=xn-24}Gb(xn,Bo){$t()[this.Ib+16>>>2>>>0]=0,$t()[this.Ib+4>>>2>>>0]=xn,$t()[this.Ib+8>>>2>>>0]=Bo}}var K1=0;function W1(Hr,xn,Bo,i0){return vn?S1(2,1,Hr,xn,Bo,i0):nv(Hr,xn,Bo,i0)}function nv(Hr,xn,Bo,i0){if(Hr>>>=0,xn>>>=0,Bo>>>=0,i0>>>=0,typeof SharedArrayBuffer>"u")return Ro("Current environment does not support SharedArrayBuffer, pthreads are not available!"),6;var h0=[];return vn&&h0.length===0?W1(Hr,xn,Bo,i0):(Hr={fc:Bo,wb:Hr,Rb:i0,mc:h0},vn?(Hr.oc="spawnThread",postMessage(Hr,h0),0):X1(Hr))}var Nv=typeof TextDecoder<"u"?new TextDecoder("utf8"):void 0,pv=(Hr,xn,Bo)=>{xn>>>=0;var i0=xn+Bo;for(Bo=xn;Hr[Bo]&&!(Bo>=i0);)++Bo;if(16<Bo-xn&&Hr.buffer&&Nv)return Nv.decode(Hr.buffer instanceof SharedArrayBuffer?Hr.slice(xn,Bo):Hr.subarray(xn,Bo));for(i0="";xn<Bo;){var h0=Hr[xn++];if(h0&128){var S0=Hr[xn++]&63;if((h0&224)==192)i0+=String.fromCharCode((h0&31)<<6|S0);else{var V0=Hr[xn++]&63;h0=(h0&240)==224?(h0&15)<<12|S0<<6|V0:(h0&7)<<18|S0<<12|V0<<6|Hr[xn++]&63,65536>h0?i0+=String.fromCharCode(h0):(h0-=65536,i0+=String.fromCharCode(55296|h0>>10,56320|h0&1023))}}else i0+=String.fromCharCode(h0)}return i0},j0=(Hr,xn)=>(Hr>>>=0)?pv(Tt(),Hr,xn):"";function N1(Hr,xn,Bo){return vn?S1(3,1,Hr,xn,Bo):0}function T0(Hr,xn){if(vn)return S1(4,1,Hr,xn)}var c1=Hr=>{for(var xn=0,Bo=0;Bo<Hr.length;++Bo){var i0=Hr.charCodeAt(Bo);127>=i0?xn++:2047>=i0?xn+=2:55296<=i0&&57343>=i0?(xn+=4,++Bo):xn+=3}return xn},O1=(Hr,xn,Bo,i0)=>{if(Bo>>>=0,!(0<i0))return 0;var h0=Bo;i0=Bo+i0-1;for(var S0=0;S0<Hr.length;++S0){var V0=Hr.charCodeAt(S0);if(55296<=V0&&57343>=V0){var J0=Hr.charCodeAt(++S0);V0=65536+((V0&1023)<<10)|J0&1023}if(127>=V0){if(Bo>=i0)break;xn[Bo++>>>0]=V0}else{if(2047>=V0){if(Bo+1>=i0)break;xn[Bo++>>>0]=192|V0>>6}else{if(65535>=V0){if(Bo+2>=i0)break;xn[Bo++>>>0]=224|V0>>12}else{if(Bo+3>=i0)break;xn[Bo++>>>0]=240|V0>>18,xn[Bo++>>>0]=128|V0>>12&63}xn[Bo++>>>0]=128|V0>>6&63}xn[Bo++>>>0]=128|V0&63}}return xn[Bo>>>0]=0,Bo-h0},T1=(Hr,xn,Bo)=>O1(Hr,Tt(),xn,Bo);function d1(Hr,xn){if(vn)return S1(5,1,Hr,xn)}function lv(Hr,xn,Bo){if(vn)return S1(6,1,Hr,xn,Bo)}function iv(Hr,xn,Bo){return vn?S1(7,1,Hr,xn,Bo):0}function dv(Hr,xn){if(vn)return S1(8,1,Hr,xn)}function uv(Hr,xn,Bo){if(vn)return S1(9,1,Hr,xn,Bo)}function Rv(Hr,xn,Bo,i0){if(vn)return S1(10,1,Hr,xn,Bo,i0)}function wv(Hr,xn,Bo,i0){if(vn)return S1(11,1,Hr,xn,Bo,i0)}function Uv(Hr,xn,Bo,i0){if(vn)return S1(12,1,Hr,xn,Bo,i0)}function _v(Hr){if(vn)return S1(13,1,Hr)}function iy(Hr,xn){if(vn)return S1(14,1,Hr,xn)}function Sy(Hr,xn,Bo){if(vn)return S1(15,1,Hr,xn,Bo)}var Sv,Av=Hr=>{for(var xn="";Tt()[Hr>>>0];)xn+=Sv[Tt()[Hr++>>>0]];return xn},Qv={},Ey={},Lv;function Ky(Hr,xn,Bo={}){var i0=xn.name;if(!Hr)throw new Lv(`type "${i0}" must have a positive integer typeid pointer`);if(Ey.hasOwnProperty(Hr)){if(Bo.Ub)return;throw new Lv(`Cannot register type '${i0}' twice`)}Ey[Hr]=xn,Qv.hasOwnProperty(Hr)&&(xn=Qv[Hr],delete Qv[Hr],xn.forEach(h0=>h0()))}function hv(Hr,xn,Bo={}){if(!("argPackAdvance"in xn))throw new TypeError("registerType registeredInstance requires argPackAdvance");return Ky(Hr,xn,Bo)}var Ty=(Hr,xn,Bo)=>{switch(xn){case 1:return Bo?i0=>vt()[i0>>>0]:i0=>Tt()[i0>>>0];case 2:return Bo?i0=>Ct()[i0>>>1>>>0]:i0=>pt()[i0>>>1>>>0];case 4:return Bo?i0=>wt()[i0>>>2>>>0]:i0=>$t()[i0>>>2>>>0];case 8:return Bo?i0=>O0[i0>>>3]:i0=>C0[i0>>>3];default:throw new TypeError(`invalid integer width (${xn}): ${Hr}`)}},py=[],Pv=[];function Cy(Hr){Hr>>>=0,9<Hr&&--Pv[Hr+1]===0&&(Pv[Hr]=void 0,py.push(Hr))}var mv=Hr=>{if(!Hr)throw new Lv("Cannot use deleted val. handle = "+Hr);return Pv[Hr]},Ev=Hr=>{switch(Hr){case void 0:return 2;case null:return 4;case!0:return 6;case!1:return 8;default:let xn=py.pop()||Pv.length;return Pv[xn]=Hr,Pv[xn+1]=1,xn}};function oy(Hr){return this.fromWireType($t()[Hr>>>2>>>0])}var Zy={name:"emscripten::val",fromWireType:Hr=>{var xn=mv(Hr);return Cy(Hr),xn},toWireType:(Hr,xn)=>Ev(xn),argPackAdvance:8,readValueFromPointer:oy,Bb:null},Qy=(Hr,xn)=>{switch(xn){case 4:return function(Bo){return this.fromWireType(Lt()[Bo>>>2>>>0])};case 8:return function(Bo){return this.fromWireType(jt()[Bo>>>3>>>0])};default:throw new TypeError(`invalid float width (${xn}): ${Hr}`)}},Oy=typeof TextDecoder<"u"?new TextDecoder("utf-16le"):void 0,d$=(Hr,xn)=>{for(var Bo=Hr>>1,i0=Bo+xn/2;!(Bo>=i0)&&pt()[Bo>>>0];)++Bo;if(Bo<<=1,32<Bo-Hr&&Oy)return Oy.decode(Tt().slice(Hr,Bo));for(Bo="",i0=0;!(i0>=xn/2);++i0){var h0=Ct()[Hr+2*i0>>>1>>>0];if(h0==0)break;Bo+=String.fromCharCode(h0)}return Bo},Jy=(Hr,xn,Bo)=>{if(Bo??(Bo=2147483647),2>Bo)return 0;Bo-=2;var i0=xn;Bo=Bo<2*Hr.length?Bo/2:Hr.length;for(var h0=0;h0<Bo;++h0){var S0=Hr.charCodeAt(h0);Ct()[xn>>>1>>>0]=S0,xn+=2}return Ct()[xn>>>1>>>0]=0,xn-i0},Ay=Hr=>2*Hr.length,b1=(Hr,xn)=>{for(var Bo=0,i0="";!(Bo>=xn/4);){var h0=wt()[Hr+4*Bo>>>2>>>0];if(h0==0)break;++Bo,65536<=h0?(h0-=65536,i0+=String.fromCharCode(55296|h0>>10,56320|h0&1023)):i0+=String.fromCharCode(h0)}return i0},Fy=(Hr,xn,Bo)=>{if(xn>>>=0,Bo??(Bo=2147483647),4>Bo)return 0;var i0=xn;Bo=i0+Bo-4;for(var h0=0;h0<Hr.length;++h0){var S0=Hr.charCodeAt(h0);if(55296<=S0&&57343>=S0){var V0=Hr.charCodeAt(++h0);S0=65536+((S0&1023)<<10)|V0&1023}if(wt()[xn>>>2>>>0]=S0,xn+=4,xn+4>Bo)break}return wt()[xn>>>2>>>0]=0,xn-i0},w1=Hr=>{for(var xn=0,Bo=0;Bo<Hr.length;++Bo){var i0=Hr.charCodeAt(Bo);55296<=i0&&57343>=i0&&++Bo,xn+=4}return xn},Py=Hr=>{if(!n0)try{if(Hr(),!(0<t1))try{vn?_x(Go):c0(Go)}catch(xn){xn instanceof v1||xn=="unwind"||or(1,xn)}}catch(xn){xn instanceof v1||xn=="unwind"||or(1,xn)}};function jv(Hr){Hr>>>=0,typeof Atomics.nc=="function"&&(Atomics.nc(wt(),Hr>>>2,Hr).value.then(yv),Hr+=128,Atomics.store(wt(),Hr>>>2,1))}Ft.__emscripten_thread_mailbox_await=jv;var yv=()=>{var Hr=ov();Hr&&(jv(Hr),Py(o2))};Ft.checkMailbox=yv;var hy=[],ay=(Hr,xn)=>{var Bo=Ey[Hr];if(Bo===void 0)throw Hr=V$(Hr),Bo=Av(Hr),Jv(Hr),new Lv(`${xn} has unknown type ${Bo}`);return Bo},my=(Hr,xn,Bo)=>{var i0=[];return Hr=Hr.toWireType(i0,Bo),i0.length&&($t()[xn>>>2>>>0]=Ev(i0)),Hr},Tv=Hr=>{try{Hr()}catch(xn){E0(xn)}};function ky(){var Hr=g1,xn={};for(let[Bo,i0]of Object.entries(Hr))xn[Bo]=typeof i0=="function"?(...h0)=>{Vv.push(Bo);try{return i0(...h0)}finally{n0||(Vv.pop(),Dv&&kv===1&&Vv.length===0&&(kv=0,t1+=1,Tv(H$),typeof Fibers<"u"&&Fibers.rc()))}}:i0;return xn}var kv=0,Dv=null,gy=0,Vv=[],Mo={},Ir={},Xr=0,In=null,Qo=[];function s0(){return new Promise((Hr,xn)=>{In={resolve:Hr,reject:xn}})}function x0(){var Hr=sy(65548),xn=Hr+12;$t()[Hr>>>2>>>0]=xn,$t()[Hr+4>>>2>>>0]=xn+65536,xn=Vv[0];var Bo=Mo[xn];return Bo===void 0&&(Bo=Xr++,Mo[xn]=Bo,Ir[Bo]=xn),xn=Bo,wt()[Hr+8>>>2>>>0]=xn,Hr}function H0(){var Hr=wt()[Dv+8>>>2>>>0];return Hr=g1[Ir[Hr]],--t1,Hr()}function Z0(Hr){if(!n0){if(kv===0){var xn=!1,Bo=!1;Hr((i0=0)=>{if(!n0&&(gy=i0,xn=!0,Bo)){kv=2,Tv(()=>G$(Dv)),typeof Browser<"u"&&Browser.Hb.Tb&&Browser.Hb.resume(),i0=!1;try{var h0=H0()}catch(J0){h0=J0,i0=!0}var S0=!1;if(!Dv){var V0=In;V0&&(In=null,(i0?V0.reject:V0.resolve)(h0),S0=!0)}if(i0&&!S0)throw h0}}),Bo=!0,xn||(kv=1,Dv=x0(),typeof Browser<"u"&&Browser.Hb.Tb&&Browser.Hb.pause(),Tv(()=>Cx(Dv)))}else kv===2?(kv=0,Tv(Ox),Jv(Dv),Dv=null,Qo.forEach(Py)):E0(`invalid state: ${kv}`);return gy}}function r1(Hr){return Z0(xn=>{Hr().then(xn)})}var e1=[],$1={},B1=Hr=>{var xn=$1[Hr];return xn===void 0?Av(Hr):xn},L0=()=>typeof globalThis=="object"?globalThis:Function("return this")(),M0=Hr=>{var xn=e1.length;return e1.push(Hr),xn},f1=(Hr,xn)=>{for(var Bo=Array(Hr),i0=0;i0<Hr;++i0)Bo[i0]=ay($t()[xn+4*i0>>>2>>>0],"parameter "+i0);return Bo},p1=(Hr,xn)=>Object.defineProperty(xn,"name",{value:Hr});function z1(Hr){var xn=Function;if(!(xn instanceof Function))throw new TypeError(`new_ called with constructor type ${typeof xn} which is not a function`);var Bo=p1(xn.name||"unknownFunctionName",function(){});return Bo.prototype=xn.prototype,Bo=new Bo,Hr=xn.apply(Bo,Hr),Hr instanceof Object?Hr:Bo}var Iy=Hr=>Hr%4===0&&(Hr%100!==0||Hr%400===0),Kx=[0,31,60,91,121,152,182,213,244,274,305,335],Zx=[0,31,59,90,120,151,181,212,243,273,304,334];function Qx(Hr,xn,Bo,i0,h0,S0,V0){return vn?S1(16,1,Hr,xn,Bo,i0,h0,S0,V0):-52}function Jx(Hr,xn,Bo,i0,h0,S0){if(vn)return S1(17,1,Hr,xn,Bo,i0,h0,S0)}var hx=[],mx=(Hr,xn)=>{hx.length=0;for(var Bo;Bo=Tt()[Hr++>>>0];){var i0=Bo!=105;i0&=Bo!=112,xn+=i0&&xn%8?4:0,hx.push(Bo==112?$t()[xn>>>2>>>0]:Bo==106?O0[xn>>>3]:Bo==105?wt()[xn>>>2>>>0]:jt()[xn>>>3>>>0]),xn+=i0?8:4}return hx},gx={},bv=()=>{if(!O$){var Hr={USER:"web_user",LOGNAME:"web_user",PATH:"/",PWD:"/",HOME:"/home/web_user",LANG:(typeof navigator=="object"&&navigator.languages&&navigator.languages[0]||"C").replace("-","_")+".UTF-8",_:ir||"./this.program"},xn;for(xn in gx)gx[xn]===void 0?delete Hr[xn]:Hr[xn]=gx[xn];var Bo=[];for(xn in Hr)Bo.push(`${xn}=${Hr[xn]}`);O$=Bo}return O$},O$;function By(Hr,xn){if(vn)return S1(18,1,Hr,xn);Hr>>>=0,xn>>>=0;var Bo=0;return bv().forEach((i0,h0)=>{var S0=xn+Bo;for(h0=$t()[Hr+4*h0>>>2>>>0]=S0,S0=0;S0<i0.length;++S0)vt()[h0++>>>0]=i0.charCodeAt(S0);vt()[h0>>>0]=0,Bo+=i0.length+1}),0}function vx(Hr,xn){if(vn)return S1(19,1,Hr,xn);Hr>>>=0,xn>>>=0;var Bo=bv();$t()[Hr>>>2>>>0]=Bo.length;var i0=0;return Bo.forEach(h0=>i0+=h0.length+1),$t()[xn>>>2>>>0]=i0,0}function z$(Hr){return vn?S1(20,1,Hr):52}function Wv(Hr,xn,Bo,i0){return vn?S1(21,1,Hr,xn,Bo,i0):52}function yx(Hr,xn,Bo,i0){return vn?S1(22,1,Hr,xn,Bo,i0):70}var e2=[null,[],[]];function bx(Hr,xn,Bo,i0){if(vn)return S1(23,1,Hr,xn,Bo,i0);xn>>>=0,Bo>>>=0,i0>>>=0;for(var h0=0,S0=0;S0<Bo;S0++){var V0=$t()[xn>>>2>>>0],J0=$t()[xn+4>>>2>>>0];xn+=8;for(var h1=0;h1<J0;h1++){var o1=Tt()[V0+h1>>>0],C1=e2[Hr];o1===0||o1===10?((Hr===1?Zr:Ro)(pv(C1,0)),C1.length=0):C1.push(o1)}h0+=J0}return $t()[i0>>>2>>>0]=h0,0}var $x=[31,29,31,30,31,30,31,31,30,31,30,31],xx=[31,28,31,30,31,30,31,31,30,31,30,31];function t2(Hr){var xn=Array(c1(Hr)+1);return O1(Hr,xn,0,xn.length),xn}var Hv=(Hr,xn)=>{vt().set(Hr,xn>>>0)};function r2(Hr,xn,Bo,i0){function h0(U0,R1,H1){for(U0=typeof U0=="number"?U0.toString():U0||"";U0.length<R1;)U0=H1[0]+U0;return U0}function S0(U0,R1){return h0(U0,R1,"0")}function V0(U0,R1){function H1(Ry){return 0>Ry?-1:0<Ry?1:0}var Vy;return(Vy=H1(U0.getFullYear()-R1.getFullYear()))===0&&(Vy=H1(U0.getMonth()-R1.getMonth()))===0&&(Vy=H1(U0.getDate()-R1.getDate())),Vy}function J0(U0){switch(U0.getDay()){case 0:return new Date(U0.getFullYear()-1,11,29);case 1:return U0;case 2:return new Date(U0.getFullYear(),0,3);case 3:return new Date(U0.getFullYear(),0,2);case 4:return new Date(U0.getFullYear(),0,1);case 5:return new Date(U0.getFullYear()-1,11,31);case 6:return new Date(U0.getFullYear()-1,11,30)}}function h1(U0){var R1=U0.zb;for(U0=new Date(new Date(U0.Ab+1900,0,1).getTime());0<R1;){var H1=U0.getMonth(),Vy=(Iy(U0.getFullYear())?$x:xx)[H1];if(R1>Vy-U0.getDate())R1-=Vy-U0.getDate()+1,U0.setDate(1),11>H1?U0.setMonth(H1+1):(U0.setMonth(0),U0.setFullYear(U0.getFullYear()+1));else{U0.setDate(U0.getDate()+R1);break}}return H1=new Date(U0.getFullYear()+1,0,4),R1=J0(new Date(U0.getFullYear(),0,4)),H1=J0(H1),0>=V0(R1,U0)?0>=V0(H1,U0)?U0.getFullYear()+1:U0.getFullYear():U0.getFullYear()-1}Hr>>>=0,xn>>>=0,Bo>>>=0,i0>>>=0;var o1=$t()[i0+40>>>2>>>0];i0={kc:wt()[i0>>>2>>>0],jc:wt()[i0+4>>>2>>>0],Eb:wt()[i0+8>>>2>>>0],Jb:wt()[i0+12>>>2>>>0],Fb:wt()[i0+16>>>2>>>0],Ab:wt()[i0+20>>>2>>>0],vb:wt()[i0+24>>>2>>>0],zb:wt()[i0+28>>>2>>>0],qc:wt()[i0+32>>>2>>>0],ic:wt()[i0+36>>>2>>>0],lc:o1?j0(o1):""},Bo=j0(Bo),o1={"%c":"%a %b %d %H:%M:%S %Y","%D":"%m/%d/%y","%F":"%Y-%m-%d","%h":"%b","%r":"%I:%M:%S %p","%R":"%H:%M","%T":"%H:%M:%S","%x":"%m/%d/%y","%X":"%H:%M:%S","%Ec":"%c","%EC":"%C","%Ex":"%m/%d/%y","%EX":"%H:%M:%S","%Ey":"%y","%EY":"%Y","%Od":"%d","%Oe":"%e","%OH":"%H","%OI":"%I","%Om":"%m","%OM":"%M","%OS":"%S","%Ou":"%u","%OU":"%U","%OV":"%V","%Ow":"%w","%OW":"%W","%Oy":"%y"};for(var C1 in o1)Bo=Bo.replace(new RegExp(C1,"g"),o1[C1]);var Z1="Sunday Monday Tuesday Wednesday Thursday Friday Saturday".split(" "),q1="January February March April May June July August September October November December".split(" ");o1={"%a":U0=>Z1[U0.vb].substring(0,3),"%A":U0=>Z1[U0.vb],"%b":U0=>q1[U0.Fb].substring(0,3),"%B":U0=>q1[U0.Fb],"%C":U0=>S0((U0.Ab+1900)/100|0,2),"%d":U0=>S0(U0.Jb,2),"%e":U0=>h0(U0.Jb,2," "),"%g":U0=>h1(U0).toString().substring(2),"%G":h1,"%H":U0=>S0(U0.Eb,2),"%I":U0=>(U0=U0.Eb,U0==0?U0=12:12<U0&&(U0-=12),S0(U0,2)),"%j":U0=>{for(var R1=0,H1=0;H1<=U0.Fb-1;R1+=(Iy(U0.Ab+1900)?$x:xx)[H1++]);return S0(U0.Jb+R1,3)},"%m":U0=>S0(U0.Fb+1,2),"%M":U0=>S0(U0.jc,2),"%n":()=>`
`,"%p":U0=>0<=U0.Eb&&12>U0.Eb?"AM":"PM","%S":U0=>S0(U0.kc,2),"%t":()=>"	","%u":U0=>U0.vb||7,"%U":U0=>S0(Math.floor((U0.zb+7-U0.vb)/7),2),"%V":U0=>{var R1=Math.floor((U0.zb+7-(U0.vb+6)%7)/7);if(2>=(U0.vb+371-U0.zb-2)%7&&R1++,R1)R1==53&&(H1=(U0.vb+371-U0.zb)%7,H1==4||H1==3&&Iy(U0.Ab)||(R1=1));else{R1=52;var H1=(U0.vb+7-U0.zb-1)%7;(H1==4||H1==5&&Iy(U0.Ab%400-1))&&R1++}return S0(R1,2)},"%w":U0=>U0.vb,"%W":U0=>S0(Math.floor((U0.zb+7-(U0.vb+6)%7)/7),2),"%y":U0=>(U0.Ab+1900).toString().substring(2),"%Y":U0=>U0.Ab+1900,"%z":U0=>{U0=U0.ic;var R1=0<=U0;return U0=Math.abs(U0)/60,(R1?"+":"-")+("0000"+(U0/60*100+U0%60)).slice(-4)},"%Z":U0=>U0.lc,"%%":()=>"%"},Bo=Bo.replace(/%%/g,"\0\0");for(C1 in o1)Bo.includes(C1)&&(Bo=Bo.replace(new RegExp(C1,"g"),o1[C1](i0)));return Bo=Bo.replace(/\0\0/g,"%"),C1=t2(Bo),C1.length>xn?0:(Hv(C1,Hr),C1.length-1)}W0.Gb();for(var Gv=Array(256),U$=0;256>U$;++U$)Gv[U$]=String.fromCharCode(U$);Sv=Gv,Lv=Ft.BindingError=class extends Error{constructor(Hr){super(Hr),this.name="BindingError"}},Ft.InternalError=class extends Error{constructor(Hr){super(Hr),this.name="InternalError"}},Pv.push(0,1,void 0,1,null,1,!0,1,!1,1),Ft.count_emval_handles=()=>Pv.length/2-5-py.length;var n2=[ev,E1,W1,N1,T0,d1,lv,iv,dv,uv,Rv,wv,Uv,_v,iy,Sy,Qx,Jx,By,vx,z$,Wv,yx,bx],zy={ua:function(Hr,xn,Bo){return r1(async()=>{await Ft.Zb(Hr,xn,Bo)})},b:function(Hr,xn,Bo){throw Hr>>>=0,new Q1(Hr).Gb(xn>>>0,Bo>>>0),K1=Hr,K1},ia:function(Hr){i2(Hr>>>0,!qr,1,!jr,131072,!1),W0.Pb()},G:function(Hr){Hr>>>=0,vn?postMessage({cmd:"cleanupThread",thread:Hr}):W0.Nb(W0.ub[Hr])},_:nv,A:N1,pa:T0,W:d1,Y:lv,qa:iv,na:dv,fa:uv,ma:Rv,K:wv,X:Uv,U:_v,oa:iy,V:Sy,E:function(Hr,xn,Bo){Hr>>>=0,Bo>>>=0,xn=Av(xn>>>0),hv(Hr,{name:xn,fromWireType:i0=>i0,toWireType:function(i0,h0){if(typeof h0!="bigint"&&typeof h0!="number")throw h0===null?h0="null":(i0=typeof h0,h0=i0==="object"||i0==="array"||i0==="function"?h0.toString():""+h0),new TypeError(`Cannot convert "${h0}" to ${this.name}`);return typeof h0=="number"&&(h0=BigInt(h0)),h0},argPackAdvance:8,readValueFromPointer:Ty(xn,Bo,xn.indexOf("u")==-1),Bb:null})},O:function(Hr,xn,Bo,i0){Hr>>>=0,xn=Av(xn>>>0),hv(Hr,{name:xn,fromWireType:function(h0){return!!h0},toWireType:function(h0,S0){return S0?Bo:i0},argPackAdvance:8,readValueFromPointer:function(h0){return this.fromWireType(Tt()[h0>>>0])},Bb:null})},N:function(Hr){return hv(Hr>>>0,Zy)},D:function(Hr,xn,Bo){Hr>>>=0,Bo>>>=0,xn=Av(xn>>>0),hv(Hr,{name:xn,fromWireType:i0=>i0,toWireType:(i0,h0)=>h0,argPackAdvance:8,readValueFromPointer:Qy(xn,Bo),Bb:null})},t:function(Hr,xn,Bo,i0,h0){if(Hr>>>=0,Bo>>>=0,xn=Av(xn>>>0),h0===-1&&(h0=4294967295),h0=J0=>J0,i0===0){var S0=32-8*Bo;h0=J0=>J0<<S0>>>S0}var V0=xn.includes("unsigned")?function(J0,h1){return h1>>>0}:function(J0,h1){return h1};hv(Hr,{name:xn,fromWireType:h0,toWireType:V0,argPackAdvance:8,readValueFromPointer:Ty(xn,Bo,i0!==0),Bb:null})},p:function(Hr,xn,Bo){function i0(S0){var V0=$t()[S0>>>2>>>0];return S0=$t()[S0+4>>>2>>>0],new h0(vt().buffer,S0,V0)}Hr>>>=0;var h0=[Int8Array,Uint8Array,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array,BigInt64Array,BigUint64Array][xn];Bo=Av(Bo>>>0),hv(Hr,{name:Bo,fromWireType:i0,argPackAdvance:8,readValueFromPointer:i0},{Ub:!0})},F:function(Hr,xn){Hr>>>=0,xn=Av(xn>>>0);var Bo=xn==="std::string";hv(Hr,{name:xn,fromWireType:function(i0){var h0=$t()[i0>>>2>>>0],S0=i0+4;if(Bo)for(var V0=S0,J0=0;J0<=h0;++J0){var h1=S0+J0;if(J0==h0||Tt()[h1>>>0]==0){if(V0=j0(V0,h1-V0),o1===void 0)var o1=V0;else o1+="\0",o1+=V0;V0=h1+1}}else{for(o1=Array(h0),J0=0;J0<h0;++J0)o1[J0]=String.fromCharCode(Tt()[S0+J0>>>0]);o1=o1.join("")}return Jv(i0),o1},toWireType:function(i0,h0){h0 instanceof ArrayBuffer&&(h0=new Uint8Array(h0));var S0=typeof h0=="string";if(!(S0||h0 instanceof Uint8Array||h0 instanceof Uint8ClampedArray||h0 instanceof Int8Array))throw new Lv("Cannot pass non-string to std::string");var V0=Bo&&S0?c1(h0):h0.length,J0=sy(4+V0+1),h1=J0+4;if($t()[J0>>>2>>>0]=V0,Bo&&S0)T1(h0,h1,V0+1);else if(S0)for(S0=0;S0<V0;++S0){var o1=h0.charCodeAt(S0);if(255<o1)throw Jv(h1),new Lv("String has UTF-16 code units that do not fit in 8 bits");Tt()[h1+S0>>>0]=o1}else for(S0=0;S0<V0;++S0)Tt()[h1+S0>>>0]=h0[S0];return i0!==null&&i0.push(Jv,J0),J0},argPackAdvance:8,readValueFromPointer:oy,Bb(i0){Jv(i0)}})},z:function(Hr,xn,Bo){if(Hr>>>=0,xn>>>=0,Bo>>>=0,Bo=Av(Bo),xn===2)var i0=d$,h0=Jy,S0=Ay,V0=J0=>pt()[J0>>>1>>>0];else xn===4&&(i0=b1,h0=Fy,S0=w1,V0=J0=>$t()[J0>>>2>>>0]);hv(Hr,{name:Bo,fromWireType:J0=>{for(var h1=$t()[J0>>>2>>>0],o1,C1=J0+4,Z1=0;Z1<=h1;++Z1){var q1=J0+4+Z1*xn;(Z1==h1||V0(q1)==0)&&(C1=i0(C1,q1-C1),o1===void 0?o1=C1:(o1+="\0",o1+=C1),C1=q1+xn)}return Jv(J0),o1},toWireType:(J0,h1)=>{if(typeof h1!="string")throw new Lv(`Cannot pass non-string to C++ string type ${Bo}`);var o1=S0(h1),C1=sy(4+o1+xn);return $t()[C1>>>2>>>0]=o1/xn,h0(h1,C1+4,o1+xn),J0!==null&&J0.push(Jv,C1),C1},argPackAdvance:8,readValueFromPointer:oy,Bb(J0){Jv(J0)}})},P:function(Hr,xn){Hr>>>=0,xn=Av(xn>>>0),hv(Hr,{Vb:!0,name:xn,argPackAdvance:0,fromWireType:()=>{},toWireType:()=>{}})},ta:()=>1,S:function(Hr,xn){Hr>>>=0,Hr==xn>>>0?setTimeout(yv):vn?postMessage({targetThread:Hr,cmd:"checkMailbox"}):(Hr=W0.ub[Hr])&&Hr.postMessage({cmd:"checkMailbox"})},$:function(Hr,xn,Bo,i0,h0){xn>>>=0,Bo>>>=0,i0/=2,hy.length=i0,h0=h0>>>0>>>3;for(var S0=0;S0<i0;S0++)hy[S0]=O0[h0+2*S0]?O0[h0+2*S0+1]:jt()[h0+2*S0+1>>>0];return Hr=xn?i1[xn]:n2[Hr],W0.Sb=Bo,Bo=Hr(...hy),W0.Sb=0,Bo},ha:jv,sa:function(Hr){Yr&&W0.ub[Hr>>>0].ref()},w:function(Hr,xn,Bo){return xn>>>=0,Bo>>>=0,Hr=mv(Hr>>>0),xn=ay(xn,"emval::as"),my(xn,Bo,Hr)},y:function(Hr){return Hr>>>=0,r1(()=>(Hr=mv(Hr),Hr.then(Ev)))},o:function(Hr,xn,Bo,i0){return Bo>>>=0,i0>>>=0,Hr=e1[Hr>>>0],xn=mv(xn>>>0),Hr(null,xn,Bo,i0)},k:function(Hr,xn,Bo,i0,h0){return Bo>>>=0,i0>>>=0,h0>>>=0,Hr=e1[Hr>>>0],xn=mv(xn>>>0),Bo=B1(Bo),Hr(xn,xn[Bo],i0,h0)},c:Cy,C:function(Hr,xn){return xn>>>=0,Hr=mv(Hr>>>0),xn=mv(xn),Hr==xn},n:function(Hr){return Hr>>>=0,Hr===0?Ev(L0()):(Hr=B1(Hr),Ev(L0()[Hr]))},j:function(Hr,xn,Bo){xn=f1(Hr,xn>>>0);var i0=xn.shift();Hr--;var h0=`return function (obj, func, destructorsRef, args) {
`,S0=0,V0=[];Bo===0&&V0.push("obj");for(var J0=["retType"],h1=[i0],o1=0;o1<Hr;++o1)V0.push("arg"+o1),J0.push("argType"+o1),h1.push(xn[o1]),h0+=`  var arg${o1} = argType${o1}.readValueFromPointer(args${S0?"+"+S0:""});
`,S0+=xn[o1].argPackAdvance;return h0+=`  var rv = ${Bo===1?"new func":"func.call"}(${V0.join(", ")});
`,i0.Vb||(J0.push("emval_returnValue"),h1.push(my),h0+=`  return emval_returnValue(retType, destructorsRef, rv);
`),J0.push(h0+`};
`),Hr=z1(J0)(...h1),Bo=`methodCaller<(${xn.map(C1=>C1.name).join(", ")}) => ${i0.name}>`,M0(p1(Bo,Hr))},s:function(Hr,xn){return xn>>>=0,Hr=mv(Hr>>>0),xn=mv(xn),Ev(Hr[xn])},d:function(Hr){Hr>>>=0,9<Hr&&(Pv[Hr+1]+=1)},v:function(){return Ev([])},m:function(Hr){Hr=mv(Hr>>>0);for(var xn=Array(Hr.length),Bo=0;Bo<Hr.length;Bo++)xn[Bo]=Hr[Bo];return Ev(xn)},g:function(Hr){return Ev(B1(Hr>>>0))},l:function(){return Ev({})},i:function(Hr){Hr>>>=0;for(var xn=mv(Hr);xn.length;){var Bo=xn.pop();xn.pop()(Bo)}Cy(Hr)},h:function(Hr,xn,Bo){xn>>>=0,Bo>>>=0,Hr=mv(Hr>>>0),xn=mv(xn),Bo=mv(Bo),Hr[xn]=Bo},e:function(Hr,xn){return xn>>>=0,Hr=ay(Hr>>>0,"_emval_take_value"),Hr=Hr.readValueFromPointer(xn),Ev(Hr)},ca:function(Hr,xn){Hr=-9007199254740992>Hr||9007199254740992<Hr?NaN:Number(Hr),xn>>>=0,Hr=new Date(1e3*Hr),wt()[xn>>>2>>>0]=Hr.getUTCSeconds(),wt()[xn+4>>>2>>>0]=Hr.getUTCMinutes(),wt()[xn+8>>>2>>>0]=Hr.getUTCHours(),wt()[xn+12>>>2>>>0]=Hr.getUTCDate(),wt()[xn+16>>>2>>>0]=Hr.getUTCMonth(),wt()[xn+20>>>2>>>0]=Hr.getUTCFullYear()-1900,wt()[xn+24>>>2>>>0]=Hr.getUTCDay(),Hr=(Hr.getTime()-Date.UTC(Hr.getUTCFullYear(),0,1,0,0,0,0))/864e5|0,wt()[xn+28>>>2>>>0]=Hr},da:function(Hr,xn){Hr=-9007199254740992>Hr||9007199254740992<Hr?NaN:Number(Hr),xn>>>=0,Hr=new Date(1e3*Hr),wt()[xn>>>2>>>0]=Hr.getSeconds(),wt()[xn+4>>>2>>>0]=Hr.getMinutes(),wt()[xn+8>>>2>>>0]=Hr.getHours(),wt()[xn+12>>>2>>>0]=Hr.getDate(),wt()[xn+16>>>2>>>0]=Hr.getMonth(),wt()[xn+20>>>2>>>0]=Hr.getFullYear()-1900,wt()[xn+24>>>2>>>0]=Hr.getDay();var Bo=(Iy(Hr.getFullYear())?Kx:Zx)[Hr.getMonth()]+Hr.getDate()-1|0;wt()[xn+28>>>2>>>0]=Bo,wt()[xn+36>>>2>>>0]=-(60*Hr.getTimezoneOffset()),Bo=new Date(Hr.getFullYear(),6,1).getTimezoneOffset();var i0=new Date(Hr.getFullYear(),0,1).getTimezoneOffset();Hr=(Bo!=i0&&Hr.getTimezoneOffset()==Math.min(i0,Bo))|0,wt()[xn+32>>>2>>>0]=Hr},ea:function(Hr){Hr>>>=0;var xn=new Date(wt()[Hr+20>>>2>>>0]+1900,wt()[Hr+16>>>2>>>0],wt()[Hr+12>>>2>>>0],wt()[Hr+8>>>2>>>0],wt()[Hr+4>>>2>>>0],wt()[Hr>>>2>>>0],0),Bo=wt()[Hr+32>>>2>>>0],i0=xn.getTimezoneOffset(),h0=new Date(xn.getFullYear(),6,1).getTimezoneOffset(),S0=new Date(xn.getFullYear(),0,1).getTimezoneOffset(),V0=Math.min(S0,h0);return 0>Bo?wt()[Hr+32>>>2>>>0]=+(h0!=S0&&V0==i0):0<Bo!=(V0==i0)&&(h0=Math.max(S0,h0),xn.setTime(xn.getTime()+6e4*((0<Bo?V0:h0)-i0))),wt()[Hr+24>>>2>>>0]=xn.getDay(),Bo=(Iy(xn.getFullYear())?Kx:Zx)[xn.getMonth()]+xn.getDate()-1|0,wt()[Hr+28>>>2>>>0]=Bo,wt()[Hr>>>2>>>0]=xn.getSeconds(),wt()[Hr+4>>>2>>>0]=xn.getMinutes(),wt()[Hr+8>>>2>>>0]=xn.getHours(),wt()[Hr+12>>>2>>>0]=xn.getDate(),wt()[Hr+16>>>2>>>0]=xn.getMonth(),wt()[Hr+20>>>2>>>0]=xn.getYear(),Hr=xn.getTime(),BigInt(isNaN(Hr)?-1:Hr/1e3)},aa:Qx,ba:Jx,R:function(Hr,xn,Bo,i0){Hr>>>=0,xn>>>=0,Bo>>>=0,i0>>>=0;var h0=new Date().getFullYear(),S0=new Date(h0,0,1),V0=new Date(h0,6,1);h0=S0.getTimezoneOffset();var J0=V0.getTimezoneOffset(),h1=Math.max(h0,J0);$t()[Hr>>>2>>>0]=60*h1,wt()[xn>>>2>>>0]=+(h0!=J0),Hr=o1=>o1.toLocaleTimeString(void 0,{hour12:!1,timeZoneName:"short"}).split(" ")[1],S0=Hr(S0),V0=Hr(V0),J0<h0?(T1(S0,Bo,17),T1(V0,i0,17)):(T1(S0,i0,17),T1(V0,Bo,17))},q:()=>{E0("")},f:function(Hr,xn,Bo){return Hr>>>=0,xn=mx(xn>>>0,Bo>>>0),i1[Hr](...xn)},M:function(Hr,xn,Bo){return Hr>>>=0,xn=mx(xn>>>0,Bo>>>0),i1[Hr](...xn)},H:()=>{},L:()=>Date.now(),ra:()=>{throw t1+=1,"unwind"},T:function(){return 4294901760},u:()=>performance.timeOrigin+performance.now(),x:()=>Yr?(Ua(),sr(Ma)).cpus().length:navigator.hardwareConcurrency,Q:function(Hr){Hr>>>=0;var xn=Tt().length;if(Hr<=xn||4294901760<Hr)return!1;for(var Bo=1;4>=Bo;Bo*=2){var i0=xn*(1+.2/Bo);i0=Math.min(i0,Hr+100663296);var h0=Math;i0=Math.max(Hr,i0);e:{h0=(h0.min.call(h0,4294901760,i0+(65536-i0%65536)%65536)-Sn.buffer.byteLength+65535)/65536;try{Sn.grow(h0),k0();var S0=1;break e}catch{}S0=void 0}if(S0)return!0}return!1},ja:By,la:vx,Z:c0,B:z$,J:Wv,ga:yx,I:bx,a:Sn||Ft.wasmMemory,ka:r2,r:function(Hr,xn,Bo,i0){return r2(Hr>>>0,xn>>>0,Bo>>>0,i0>>>0)}},g1=function(){function Hr(Bo,i0){return g1=Bo.exports,g1=ky(),g1=G2(),W0.Qb.push(g1.cb),r0.unshift(g1.va),Tn=i0,g0(),g1}var xn={a:zy};if($0++,Ft.instantiateWasm)try{return Ft.instantiateWasm(xn,Hr)}catch(Bo){Ro(`Module.instantiateWasm callback failed with error: ${Bo}`),Ht(Bo)}return P1(xn,function(Bo){Hr(Bo.instance,Bo.module)}).catch(Ht),{}}(),V$=Hr=>(V$=g1.wa)(Hr);Ft.__embind_initialize_bindings=()=>(Ft.__embind_initialize_bindings=g1.xa)(),Ft._OrtInit=(Hr,xn)=>(Ft._OrtInit=g1.ya)(Hr,xn),Ft._OrtGetLastError=(Hr,xn)=>(Ft._OrtGetLastError=g1.za)(Hr,xn),Ft._OrtCreateSessionOptions=(Hr,xn,Bo,i0,h0,S0,V0,J0,h1,o1)=>(Ft._OrtCreateSessionOptions=g1.Aa)(Hr,xn,Bo,i0,h0,S0,V0,J0,h1,o1),Ft._OrtAppendExecutionProvider=(Hr,xn)=>(Ft._OrtAppendExecutionProvider=g1.Ba)(Hr,xn),Ft._OrtAddFreeDimensionOverride=(Hr,xn,Bo)=>(Ft._OrtAddFreeDimensionOverride=g1.Ca)(Hr,xn,Bo),Ft._OrtAddSessionConfigEntry=(Hr,xn,Bo)=>(Ft._OrtAddSessionConfigEntry=g1.Da)(Hr,xn,Bo),Ft._OrtReleaseSessionOptions=Hr=>(Ft._OrtReleaseSessionOptions=g1.Ea)(Hr),Ft._OrtCreateSession=(Hr,xn,Bo)=>(Ft._OrtCreateSession=g1.Fa)(Hr,xn,Bo),Ft._OrtReleaseSession=Hr=>(Ft._OrtReleaseSession=g1.Ga)(Hr),Ft._OrtGetInputOutputCount=(Hr,xn,Bo)=>(Ft._OrtGetInputOutputCount=g1.Ha)(Hr,xn,Bo),Ft._OrtGetInputName=(Hr,xn)=>(Ft._OrtGetInputName=g1.Ia)(Hr,xn),Ft._OrtGetOutputName=(Hr,xn)=>(Ft._OrtGetOutputName=g1.Ja)(Hr,xn),Ft._OrtFree=Hr=>(Ft._OrtFree=g1.Ka)(Hr),Ft._OrtCreateTensor=(Hr,xn,Bo,i0,h0,S0)=>(Ft._OrtCreateTensor=g1.La)(Hr,xn,Bo,i0,h0,S0),Ft._OrtGetTensorData=(Hr,xn,Bo,i0,h0)=>(Ft._OrtGetTensorData=g1.Ma)(Hr,xn,Bo,i0,h0),Ft._OrtReleaseTensor=Hr=>(Ft._OrtReleaseTensor=g1.Na)(Hr),Ft._OrtCreateRunOptions=(Hr,xn,Bo,i0)=>(Ft._OrtCreateRunOptions=g1.Oa)(Hr,xn,Bo,i0),Ft._OrtAddRunConfigEntry=(Hr,xn,Bo)=>(Ft._OrtAddRunConfigEntry=g1.Pa)(Hr,xn,Bo),Ft._OrtReleaseRunOptions=Hr=>(Ft._OrtReleaseRunOptions=g1.Qa)(Hr),Ft._OrtCreateBinding=Hr=>(Ft._OrtCreateBinding=g1.Ra)(Hr),Ft._OrtBindInput=(Hr,xn,Bo)=>(Ft._OrtBindInput=g1.Sa)(Hr,xn,Bo),Ft._OrtBindOutput=(Hr,xn,Bo,i0)=>(Ft._OrtBindOutput=g1.Ta)(Hr,xn,Bo,i0),Ft._OrtClearBoundOutputs=Hr=>(Ft._OrtClearBoundOutputs=g1.Ua)(Hr),Ft._OrtReleaseBinding=Hr=>(Ft._OrtReleaseBinding=g1.Va)(Hr),Ft._OrtRunWithBinding=(Hr,xn,Bo,i0,h0)=>(Ft._OrtRunWithBinding=g1.Wa)(Hr,xn,Bo,i0,h0),Ft._OrtRun=(Hr,xn,Bo,i0,h0,S0,V0,J0)=>(Ft._OrtRun=g1.Xa)(Hr,xn,Bo,i0,h0,S0,V0,J0),Ft._OrtEndProfiling=Hr=>(Ft._OrtEndProfiling=g1.Ya)(Hr),Ft._JsepOutput=(Hr,xn,Bo)=>(Ft._JsepOutput=g1.Za)(Hr,xn,Bo),Ft._JsepGetNodeName=Hr=>(Ft._JsepGetNodeName=g1._a)(Hr);var ov=Ft._pthread_self=()=>(ov=Ft._pthread_self=g1.$a)(),sy=Ft._malloc=Hr=>(sy=Ft._malloc=g1.ab)(Hr),Jv=Ft._free=Hr=>(Jv=Ft._free=g1.bb)(Hr);Ft.__emscripten_tls_init=()=>(Ft.__emscripten_tls_init=g1.cb)();var i2=Ft.__emscripten_thread_init=(Hr,xn,Bo,i0,h0,S0)=>(i2=Ft.__emscripten_thread_init=g1.eb)(Hr,xn,Bo,i0,h0,S0);Ft.__emscripten_thread_crashed=()=>(Ft.__emscripten_thread_crashed=g1.fb)();var W$=(Hr,xn,Bo,i0,h0)=>(W$=g1.gb)(Hr,xn,Bo,i0,h0),wx=Hr=>(wx=g1.hb)(Hr),_x=Ft.__emscripten_thread_exit=Hr=>(_x=Ft.__emscripten_thread_exit=g1.ib)(Hr),o2=()=>(o2=g1.jb)(),Sx=(Hr,xn)=>(Sx=g1.kb)(Hr,xn),e$=Hr=>(e$=g1.lb)(Hr),Uy=Hr=>(Uy=g1.mb)(Hr),Ex=()=>(Ex=g1.nb)(),Tx=Ft.dynCall_ii=(Hr,xn)=>(Tx=Ft.dynCall_ii=g1.pb)(Hr,xn),Cx=Hr=>(Cx=g1.qb)(Hr),H$=()=>(H$=g1.rb)(),G$=Hr=>(G$=g1.sb)(Hr),Ox=()=>(Ox=g1.tb)();Ft.___start_em_js=839500,Ft.___stop_em_js=839661;function G2(){var Hr=g1;Hr=Object.assign({},Hr);var xn=i0=>h0=>i0(h0)>>>0,Bo=i0=>()=>i0()>>>0;return Hr.wa=xn(Hr.wa),Hr.$a=Bo(Hr.$a),Hr.ab=xn(Hr.ab),Hr.emscripten_main_runtime_thread_id=Bo(Hr.emscripten_main_runtime_thread_id),Hr.mb=xn(Hr.mb),Hr.nb=Bo(Hr.nb),Hr}Ft.wasmMemory=Sn,Ft.stackSave=()=>Ex(),Ft.stackRestore=Hr=>e$(Hr),Ft.stackAlloc=Hr=>Uy(Hr),Ft.keepRuntimeAlive=()=>0<t1,Ft.UTF8ToString=j0,Ft.stringToUTF8=T1,Ft.lengthBytesUTF8=c1,Ft.ExitStatus=v1,Ft.PThread=W0;var f$;A0=function Hr(){f$||q$(),f$||(A0=Hr)};function q$(){if(!(0<$0))if(vn)Gt(Ft),vn||s1(r0),startWorker(Ft);else{if(Ft.preRun)for(typeof Ft.preRun=="function"&&(Ft.preRun=[Ft.preRun]);Ft.preRun.length;)w0.unshift(Ft.preRun.shift());s1(w0),0<$0||f$||(f$=!0,Ft.calledRun=!0,n0||(vn||s1(r0),Gt(Ft),vn||s1(p0)))}}return q$(),qt}})();typeof d=="object"&&typeof g=="object"?g.exports=b:typeof define=="function"&&define.amd&&define([],()=>b)}),Ha=Er((d,g)=>{g.exports='"use strict";var Module={},ENVIRONMENT_IS_NODE=typeof process=="object"&&typeof process.versions=="object"&&typeof process.versions.node=="string";if(ENVIRONMENT_IS_NODE){var nodeWorkerThreads=require("worker_threads"),parentPort=nodeWorkerThreads.parentPort;parentPort.on("message",e=>onmessage({data:e}));var fs=require("fs"),vm=require("vm");Object.assign(global,{self:global,require,Module,location:{href:__filename},Worker:nodeWorkerThreads.Worker,importScripts:e=>vm.runInThisContext(fs.readFileSync(e,"utf8"),{filename:e}),postMessage:e=>parentPort.postMessage(e),performance:global.performance||{now:Date.now}})}var initializedJS=!1;function threadPrintErr(...e){var a=e.join(" ");if(ENVIRONMENT_IS_NODE){fs.writeSync(2,a+`\n`);return}console.error(a)}function threadAlert(...e){var a=e.join(" ");postMessage({cmd:"alert",text:a,threadId:Module._pthread_self()})}var err=threadPrintErr;self.alert=threadAlert,Module.instantiateWasm=(e,a)=>{var r=Module.wasmModule;Module.wasmModule=null;var t=new WebAssembly.Instance(r,e);return a(t)},self.onunhandledrejection=e=>{throw e.reason||e};function handleMessage(e){try{if(e.data.cmd==="load"){let r=[];self.onmessage=t=>r.push(t),self.startWorker=t=>{Module=t,postMessage({cmd:"loaded"});for(let s of r)handleMessage(s);self.onmessage=handleMessage},Module.wasmModule=e.data.wasmModule;for(const t of e.data.handlers)Module[t]=(...s)=>{postMessage({cmd:"callHandler",handler:t,args:s})};if(Module.wasmMemory=e.data.wasmMemory,Module.buffer=Module.wasmMemory.buffer,Module.ENVIRONMENT_IS_PTHREAD=!0,typeof e.data.urlOrBlob=="string")importScripts(e.data.urlOrBlob);else{var a=URL.createObjectURL(e.data.urlOrBlob);importScripts(a),URL.revokeObjectURL(a)}ortWasmThreaded(Module)}else if(e.data.cmd==="run"){Module.__emscripten_thread_init(e.data.pthread_ptr,0,0,1),Module.__emscripten_thread_mailbox_await(e.data.pthread_ptr),Module.establishStackSpace(),Module.PThread.receiveObjectTransfer(e.data),Module.PThread.threadInitTLS(),initializedJS||(initializedJS=!0);try{Module.invokeEntryPoint(e.data.start_routine,e.data.arg)}catch(r){if(r!="unwind")throw r}}else e.data.cmd==="cancel"?Module._pthread_self()&&Module.__emscripten_thread_exit(-1):e.data.target==="setimmediate"||(e.data.cmd==="checkMailbox"?initializedJS&&Module.checkMailbox():e.data.cmd&&(err(`worker.js received unknown command ${e.data.cmd}`),err(e.data)))}catch(r){throw Module.__emscripten_thread_crashed?.(),r}}self.onmessage=handleMessage;\n'}),La,gc,Hi,Gi,Un,Ga,yc,bc,vc,Fa,Fe,Or=j(()=>{La=za(),gc=Va(),Gi=!1,Un=!1,Ga=!1,yc=d=>{if(d===1)return!1;if(typeof SharedArrayBuffer>"u")return typeof self<"u"&&!self.crossOriginIsolated&&console.warn("env.wasm.numThreads is set to "+d+", but this will not work unless you enable crossOriginIsolated mode. See https://web.dev/cross-origin-isolation-guide/ for more info."),!1;typeof process<"u"&&process.versions&&process.versions.node&&console.warn("env.wasm.numThreads is set to "+d+", however, currently onnxruntime-web does not support multi-threads in Node.js. Please consider using onnxruntime-node for performance critical scenarios.");try{return typeof MessageChannel<"u"&&new MessageChannel().port1.postMessage(new SharedArrayBuffer(1)),WebAssembly.validate(new Uint8Array([0,97,115,109,1,0,0,0,1,4,1,96,0,0,3,2,1,0,5,4,1,3,1,1,10,11,1,9,0,65,0,254,16,2,0,26,11]))}catch{return!1}},bc=()=>{try{return WebAssembly.validate(new Uint8Array([0,97,115,109,1,0,0,0,1,4,1,96,0,0,3,2,1,0,10,30,1,28,0,65,0,253,15,253,12,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,253,186,1,26,11]))}catch{return!1}},vc=(d,g)=>d?g?"ort-wasm-simd-threaded.wasm":"ort-wasm-simd.wasm":g?"ort-wasm-threaded.wasm":"ort-wasm.wasm",Fa=async d=>{if(Gi)return Promise.resolve();if(Un)throw new Error("multiple calls to 'initializeWebAssembly()' detected.");if(Ga)throw new Error("previous call to 'initializeWebAssembly()' failed.");Un=!0;let g=d.initTimeout,b=d.numThreads,et=d.simd,st=yc(b),at=et&&bc(),vt=d.wasmPaths,Tt=typeof vt=="string"?vt:void 0,Ct=vc(at,st),pt=typeof vt=="object"?vt[Ct]:void 0,wt=!1,$t=[];if(g>0&&$t.push(new Promise(Lt=>{setTimeout(()=>{wt=!0,Lt()},g)})),$t.push(new Promise((Lt,jt)=>{let Ft=st?gc:La,Gt={locateFile:(Ht,qt)=>{if(st&&Ht.endsWith(".worker.js")&&typeof Blob<"u")return URL.createObjectURL(new Blob([Ha()],{type:"text/javascript"}));if(Ht.endsWith(".wasm")){if(pt)return pt;let Kt=Tt??qt;return Ct==="ort-wasm-simd.wasm"?Kt+"ort-wasm-simd.jsep.wasm":Ct==="ort-wasm-simd-threaded.wasm"?Kt+"ort-wasm-simd-threaded.jsep.wasm":Kt+Ct}return qt+Ht}};if(st)if(Gt.numThreads=b,typeof Blob>"u")Gt.mainScriptUrlOrBlob=(void 0)(__dirname,"ort-wasm-threaded.js");else{let Ht=`var ortWasmThreaded=${Ft.toString()};`;Gt.mainScriptUrlOrBlob=new Blob([Ht],{type:"text/javascript"})}Ft(Gt).then(Ht=>{Un=!1,Gi=!0,Hi=Ht,Lt()},Ht=>{Un=!1,Ga=!0,jt(Ht)})})),await Promise.race($t),wt)throw new Error(`WebAssembly backend initializing failed due to timeout: ${g}ms`)},Fe=()=>{if(Gi&&Hi)return Hi;throw new Error("WebAssembly is not initialized yet.")}}),qe,Jr,We,Wn=j(()=>{Or(),qe=(d,g)=>{let b=Fe(),et=b.lengthBytesUTF8(d)+1,st=b._malloc(et);return b.stringToUTF8(d,st,et),g.push(st),st},Jr=(d,g,b,et)=>{if(typeof d=="object"&&d!==null){if(b.has(d))throw new Error("Circular reference in options");b.add(d)}Object.entries(d).forEach(([st,at])=>{let vt=g?g+st:st;if(typeof at=="object")Jr(at,vt+".",b,et);else if(typeof at=="string"||typeof at=="number")et(vt,at.toString());else if(typeof at=="boolean")et(vt,at?"1":"0");else throw new Error(`Can't handle extra config type: ${typeof at}`)})},We=d=>{let g=Fe(),b=g.stackSave();try{let et=g.stackAlloc(8);g._OrtGetLastError(et,et+4);let st=g.HEAP32[et/4],at=g.HEAPU32[et/4+1],vt=at?g.UTF8ToString(at):"";throw new Error(`${d} ERROR_CODE: ${st}, ERROR_MESSAGE: ${vt}`)}finally{g.stackRestore(b)}}}),qa,ja=j(()=>{Or(),Wn(),qa=d=>{let g=Fe(),b=0,et=[],st=d||{};try{if((d==null?void 0:d.logSeverityLevel)===void 0)st.logSeverityLevel=2;else if(typeof d.logSeverityLevel!="number"||!Number.isInteger(d.logSeverityLevel)||d.logSeverityLevel<0||d.logSeverityLevel>4)throw new Error(`log serverity level is not valid: ${d.logSeverityLevel}`);if((d==null?void 0:d.logVerbosityLevel)===void 0)st.logVerbosityLevel=0;else if(typeof d.logVerbosityLevel!="number"||!Number.isInteger(d.logVerbosityLevel))throw new Error(`log verbosity level is not valid: ${d.logVerbosityLevel}`);(d==null?void 0:d.terminate)===void 0&&(st.terminate=!1);let at=0;return(d==null?void 0:d.tag)!==void 0&&(at=qe(d.tag,et)),b=g._OrtCreateRunOptions(st.logSeverityLevel,st.logVerbosityLevel,!!st.terminate,at),b===0&&We("Can't create run options."),(d==null?void 0:d.extra)!==void 0&&Jr(d.extra,"",new WeakSet,(vt,Tt)=>{let Ct=qe(vt,et),pt=qe(Tt,et);g._OrtAddRunConfigEntry(b,Ct,pt)!==0&&We(`Can't set a run config entry: ${vt} - ${Tt}.`)}),[b,et]}catch(at){throw b!==0&&g._OrtReleaseRunOptions(b),et.forEach(vt=>g._free(vt)),at}}}),wc,$c,_c,xc,Ka,Ya=j(()=>{Or(),Wn(),wc=d=>{switch(d){case"disabled":return 0;case"basic":return 1;case"extended":return 2;case"all":return 99;default:throw new Error(`unsupported graph optimization level: ${d}`)}},$c=d=>{switch(d){case"sequential":return 0;case"parallel":return 1;default:throw new Error(`unsupported execution mode: ${d}`)}},_c=d=>{d.extra||(d.extra={}),d.extra.session||(d.extra.session={});let g=d.extra.session;g.use_ort_model_bytes_directly||(g.use_ort_model_bytes_directly="1"),d.executionProviders&&d.executionProviders.some(b=>(typeof b=="string"?b:b.name)==="webgpu")&&(d.enableMemPattern=!1)},xc=(d,g,b)=>{for(let et of g){let st=typeof et=="string"?et:et.name;switch(st){case"webnn":if(st="WEBNN",typeof et!="string"){let vt=et;if(vt!=null&&vt.deviceType){let Tt=qe("deviceType",b),Ct=qe(vt.deviceType,b);Fe()._OrtAddSessionConfigEntry(d,Tt,Ct)!==0&&We(`Can't set a session config entry: 'deviceType' - ${vt.deviceType}.`)}if(vt!=null&&vt.numThreads){let Tt=vt.numThreads;(typeof Tt!="number"||!Number.isInteger(Tt)||Tt<0)&&(Tt=0);let Ct=qe("numThreads",b),pt=qe(Tt.toString(),b);Fe()._OrtAddSessionConfigEntry(d,Ct,pt)!==0&&We(`Can't set a session config entry: 'numThreads' - ${vt.numThreads}.`)}if(vt!=null&&vt.powerPreference){let Tt=qe("powerPreference",b),Ct=qe(vt.powerPreference,b);Fe()._OrtAddSessionConfigEntry(d,Tt,Ct)!==0&&We(`Can't set a session config entry: 'powerPreference' - ${vt.powerPreference}.`)}}break;case"webgpu":if(st="JS",typeof et!="string"){let vt=et;if(vt!=null&&vt.preferredLayout){if(vt.preferredLayout!=="NCHW"&&vt.preferredLayout!=="NHWC")throw new Error(`preferredLayout must be either 'NCHW' or 'NHWC': ${vt.preferredLayout}`);let Tt=qe("preferredLayout",b),Ct=qe(vt.preferredLayout,b);Fe()._OrtAddSessionConfigEntry(d,Tt,Ct)!==0&&We(`Can't set a session config entry: 'preferredLayout' - ${vt.preferredLayout}.`)}}break;case"wasm":case"cpu":continue;default:throw new Error(`not supported execution provider: ${st}`)}let at=qe(st,b);Fe()._OrtAppendExecutionProvider(d,at)!==0&&We(`Can't append execution provider: ${st}.`)}},Ka=d=>{let g=Fe(),b=0,et=[],st=d||{};_c(st);try{let at=wc(st.graphOptimizationLevel??"all"),vt=$c(st.executionMode??"sequential"),Tt=typeof st.logId=="string"?qe(st.logId,et):0,Ct=st.logSeverityLevel??2;if(!Number.isInteger(Ct)||Ct<0||Ct>4)throw new Error(`log serverity level is not valid: ${Ct}`);let pt=st.logVerbosityLevel??0;if(!Number.isInteger(pt)||pt<0||pt>4)throw new Error(`log verbosity level is not valid: ${pt}`);let wt=typeof st.optimizedModelFilePath=="string"?qe(st.optimizedModelFilePath,et):0;if(b=g._OrtCreateSessionOptions(at,!!st.enableCpuMemArena,!!st.enableMemPattern,vt,!!st.enableProfiling,0,Tt,Ct,pt,wt),b===0&&We("Can't create session options."),st.executionProviders&&xc(b,st.executionProviders,et),st.enableGraphCapture!==void 0){if(typeof st.enableGraphCapture!="boolean")throw new Error(`enableGraphCapture must be a boolean value: ${st.enableGraphCapture}`);let $t=qe("enableGraphCapture",et),Lt=qe(st.enableGraphCapture.toString(),et);g._OrtAddSessionConfigEntry(b,$t,Lt)!==0&&We(`Can't set a session config entry: 'enableGraphCapture' - ${st.enableGraphCapture}.`)}if(st.freeDimensionOverrides)for(let[$t,Lt]of Object.entries(st.freeDimensionOverrides)){if(typeof $t!="string")throw new Error(`free dimension override name must be a string: ${$t}`);if(typeof Lt!="number"||!Number.isInteger(Lt)||Lt<0)throw new Error(`free dimension override value must be a non-negative integer: ${Lt}`);let jt=qe($t,et);g._OrtAddFreeDimensionOverride(b,jt,Lt)!==0&&We(`Can't set a free dimension override: ${$t} - ${Lt}.`)}return st.extra!==void 0&&Jr(st.extra,"",new WeakSet,($t,Lt)=>{let jt=qe($t,et),Ft=qe(Lt,et);g._OrtAddSessionConfigEntry(b,jt,Ft)!==0&&We(`Can't set a session config entry: ${$t} - ${Lt}.`)}),[b,et]}catch(at){throw b!==0&&g._OrtReleaseSessionOptions(b),et.forEach(vt=>g._free(vt)),at}}}),Li,Yt,cr,Nn,en,Vn,Fi,ye=j(()=>{Li=d=>{switch(d){case"int8":return 3;case"uint8":return 2;case"bool":return 9;case"int16":return 5;case"uint16":return 4;case"int32":return 6;case"uint32":return 12;case"float16":return 10;case"float32":return 1;case"float64":return 11;case"string":return 8;case"int64":return 7;case"uint64":return 13;default:throw new Error(`unsupported data type: ${d}`)}},Yt=d=>{switch(d){case 3:return"int8";case 2:return"uint8";case 9:return"bool";case 5:return"int16";case 4:return"uint16";case 6:return"int32";case 12:return"uint32";case 10:return"float16";case 1:return"float32";case 11:return"float64";case 8:return"string";case 7:return"int64";case 13:return"uint64";default:throw new Error(`unsupported data type: ${d}`)}},cr=d=>[void 0,4,1,1,2,2,4,8,void 0,1,2,8,4,8,void 0,void 0,void 0][d],Nn=d=>{switch(d){case"float16":return typeof Float16Array<"u"&&Float16Array.from?Float16Array:Uint16Array;case"float32":return Float32Array;case"uint8":return Uint8Array;case"int8":return Int8Array;case"uint16":return Uint16Array;case"int16":return Int16Array;case"int32":return Int32Array;case"bool":return Uint8Array;case"float64":return Float64Array;case"uint32":return Uint32Array;case"int64":return BigInt64Array;case"uint64":return BigUint64Array;default:throw new Error(`unsupported type: ${d}`)}},en=d=>{switch(d){case"verbose":return 0;case"info":return 1;case"warning":return 2;case"error":return 3;case"fatal":return 4;default:throw new Error(`unsupported logging level: ${d}`)}},Vn=d=>d==="float32"||d==="float16"||d==="int32"||d==="int64"||d==="uint32"||d==="uint8"||d==="bool",Fi=d=>{switch(d){case"none":return 0;case"cpu":return 1;case"cpu-pinned":return 2;case"texture":return 3;case"gpu-buffer":return 4;default:throw new Error(`unsupported data location: ${d}`)}}}),tn,qi=j(()=>{tn=async d=>{if(typeof d=="string")if(typeof process<"u"&&process.versions&&process.versions.node)try{return new Uint8Array(await(void 0)(d))}catch(g){if(g.code==="ERR_FS_FILE_TOO_LARGE"){let b=(void 0)(d),et=[];for await(let st of b)et.push(st);return new Uint8Array(Buffer.concat(et))}throw g}else{let g=await fetch(d);if(!g.ok)throw new Error(`failed to load external data file: ${d}`);let b=g.headers.get("Content-Length"),et=b?parseInt(b,10):0;if(et<1073741824)return new Uint8Array(await g.arrayBuffer());{if(!g.body)throw new Error(`failed to load external data file: ${d}, no response body.`);let st=g.body.getReader(),at;try{at=new ArrayBuffer(et)}catch(Tt){if(Tt instanceof RangeError){let Ct=Math.ceil(et/65536);at=new WebAssembly.Memory({initial:Ct,maximum:Ct}).buffer}else throw Tt}let vt=0;for(;;){let{done:Tt,value:Ct}=await st.read();if(Tt)break;let pt=Ct.byteLength;new Uint8Array(at,vt,pt).set(Ct),vt+=pt}return new Uint8Array(at,0,et)}}else return d instanceof Blob?new Uint8Array(await d.arrayBuffer()):d instanceof Uint8Array?d:new Uint8Array(d)}}),Sc,Cc,Xa,Za,Qa,Ic,Ne,Xt=j(()=>{ye(),Sc=["V","I","W","E","F"],Cc=(d,g)=>{console.log(`[${Sc[d]},${new Date().toISOString()}]${g}`)},Qa=(d,g)=>{Xa=d,Za=g},Ic=(d,g)=>{let b=en(d),et=en(Xa);b>=et&&Cc(b,typeof g=="function"?g():g)},Ne=(...d)=>{Za&&Ic(...d)}}),Ja,es=j(()=>{ye(),Ja=(d,g)=>new(Nn(g))(d)}),Hn=j(()=>{}),ts,ji,Ki,Tc,Ac,rs,Xi,Yi,is,os=j(()=>{Xt(),Hn(),ts=new Map([[64,250],[128,200],[256,200],[512,200],[2048,230],[4096,200],[8192,50],[16384,50],[32768,50],[65536,50],[131072,50],[262144,50],[524288,50],[1048576,50],[2097152,30],[4194304,20],[8388608,10],[12582912,10],[16777216,10],[26214400,15],[33554432,22],[44236800,2],[58982400,6],[67108864,6],[134217728,6],[167772160,6]]),ji=[],Ki=d=>Math.ceil(d/16)*16,Tc=d=>{for(let g=0;g<ji.length;g++){let b=ji[g];if(d<=b)return b}return Math.ceil(d/16)*16},Ac=1,rs=()=>Ac++,Xi=async(d,g,b,et)=>{let st=Ki(b),at=d.device.createBuffer({size:st,usage:GPUBufferUsage.COPY_DST|GPUBufferUsage.MAP_READ});try{let vt=d.getCommandEncoder();d.endComputePass(),vt.copyBufferToBuffer(g,0,at,0,st),d.flush(),await at.mapAsync(GPUMapMode.READ);let Tt=at.getMappedRange();if(et){let Ct=et();return Ct.set(new Uint8Array(Tt,0,b)),Ct}else return new Uint8Array(Tt.slice(0,b))}finally{at.destroy()}},Yi=class{constructor(d){this.backend=d,this.storageCache=new Map,this.freeBuffers=new Map,this.freeUniformBuffers=new Map,this.buffersForUploadingPending=[],this.buffersPending=[],this.externalBuffers=new Map,this.capturedPendingBuffers=new Map;for(let[g]of ts)ji.push(g),this.freeBuffers.set(g,[]),this.freeUniformBuffers.set(g,[])}upload(d,g){let b=g.buffer,et=g.byteOffset,st=g.byteLength,at=Ki(st),vt=this.storageCache.get(d);if(!vt)throw new Error("gpu data for uploading does not exist");if(vt.originalSize!==st)throw new Error(`inconsistent data size. gpu data size=${vt.originalSize}, data size=${st}`);let Tt=this.backend.device.createBuffer({mappedAtCreation:!0,size:at,usage:GPUBufferUsage.MAP_WRITE|GPUBufferUsage.COPY_SRC}),Ct=Tt.getMappedRange();new Uint8Array(Ct).set(new Uint8Array(b,et,st)),Tt.unmap();let pt=this.backend.getCommandEncoder();this.backend.endComputePass(),pt.copyBufferToBuffer(Tt,0,vt.gpuData.buffer,0,at),Ne("verbose",()=>`[WebGPU] GpuDataManager.upload(id=${d})`),this.buffersForUploadingPending.push(Tt)}memcpy(d,g){let b=this.storageCache.get(d);if(!b)throw new Error("source gpu data for memcpy does not exist");let et=this.storageCache.get(g);if(!et)throw new Error("destination gpu data for memcpy does not exist");if(b.originalSize!==et.originalSize)throw new Error("inconsistent source and destination gpu data size");let st=Ki(b.originalSize),at=this.backend.getCommandEncoder();this.backend.endComputePass(),at.copyBufferToBuffer(b.gpuData.buffer,0,et.gpuData.buffer,0,st)}registerExternalBuffer(d,g,b){let et;if(b){if(et=this.externalBuffers.get(b),et===void 0)throw new Error("previous buffer is not registered");if(d===b)return Ne("verbose",()=>`[WebGPU] GpuDataManager.registerExternalBuffer(size=${g}) => id=${et}, buffer is the same, skip.`),et;if(this.backend.capturedCommandList.has(this.backend.currentSessionId))throw new Error(`Registering a different external buffer under graph capture mode is not supported yet.
             Please use the previous external buffer!`);this.externalBuffers.delete(b)}else et=rs();return this.storageCache.set(et,{gpuData:{id:et,type:0,buffer:d},originalSize:g}),this.externalBuffers.set(d,et),Ne("verbose",()=>`[WebGPU] GpuDataManager.registerExternalBuffer(size=${g}) => id=${et}, registered.`),et}unregisterExternalBuffer(d){let g=this.externalBuffers.get(d);g!==void 0&&(this.storageCache.delete(g),this.externalBuffers.delete(d),Ne("verbose",()=>`[WebGPU] GpuDataManager.unregisterExternalBuffer() => id=${g}`))}create(d,g=GPUBufferUsage.STORAGE|GPUBufferUsage.COPY_SRC|GPUBufferUsage.COPY_DST){let b=Tc(d),et,st=(g&GPUBufferUsage.STORAGE)===GPUBufferUsage.STORAGE,at=(g&GPUBufferUsage.UNIFORM)===GPUBufferUsage.UNIFORM;if(st||at){let Tt=(st?this.freeBuffers:this.freeUniformBuffers).get(b);Tt?Tt.length>0?et=Tt.pop():et=this.backend.device.createBuffer({size:b,usage:g}):et=this.backend.device.createBuffer({size:b,usage:g})}else et=this.backend.device.createBuffer({size:b,usage:g});let vt={id:rs(),type:0,buffer:et};return this.storageCache.set(vt.id,{gpuData:vt,originalSize:d}),Ne("verbose",()=>`[WebGPU] GpuDataManager.create(size=${d}) => id=${vt.id}`),vt}get(d){var g;return(g=this.storageCache.get(d))==null?void 0:g.gpuData}release(d){let g=this.storageCache.get(d);if(!g)throw new Error("releasing data does not exist");return Ne("verbose",()=>`[WebGPU] GpuDataManager.release(id=${d}), gpuDataId=${g.gpuData.id}`),this.storageCache.delete(d),this.buffersPending.push(g.gpuData.buffer),g.originalSize}async download(d,g){let b=this.storageCache.get(d);if(!b)throw new Error("data does not exist");await Xi(this.backend,b.gpuData.buffer,b.originalSize,g)}refreshPendingBuffers(){for(let d of this.buffersForUploadingPending)d.destroy();if(this.buffersForUploadingPending=[],this.buffersPending.length!==0)if(this.backend.sessionStatus==="default"){for(let d of this.buffersPending){let g=ts.get(d.size);if((d.usage&GPUBufferUsage.STORAGE)===GPUBufferUsage.STORAGE){let b=this.freeBuffers.get(d.size)||[];g===void 0||b.length>=g?d.destroy():b.push(d)}else if((d.usage&GPUBufferUsage.UNIFORM)===GPUBufferUsage.UNIFORM){let b=this.freeUniformBuffers.get(d.size)||[];g===void 0||b.length>=g?d.destroy():b.push(d)}else d.destroy()}this.buffersPending=[]}else{let d=this.capturedPendingBuffers.get(this.backend.currentSessionId);d||(d=[],this.capturedPendingBuffers.set(this.backend.currentSessionId,d));for(let g of this.buffersPending)d.push(g);this.buffersPending=[]}}dispose(){this.freeBuffers.forEach(d=>{d.forEach(g=>{g.destroy()})}),this.freeUniformBuffers.forEach(d=>{d.forEach(g=>{g.destroy()})}),this.storageCache.forEach(d=>{d.gpuData.buffer.destroy()}),this.capturedPendingBuffers.forEach(d=>{d.forEach(g=>{g.destroy()})}),this.storageCache=new Map,this.freeBuffers=new Map,this.freeUniformBuffers=new Map,this.capturedPendingBuffers=new Map}onReleaseSession(d){let g=this.capturedPendingBuffers.get(d);g&&(g.forEach(b=>{b.destroy()}),this.capturedPendingBuffers.delete(d))}},is=(...d)=>new Yi(...d)}),Zi,we,Ze=j(()=>{Zi=class{constructor(d){Object.assign(this,d)}get cacheKey(){return this.key||(this.key=Object.getOwnPropertyNames(this).sort().map(d=>`${this[d]}`).join(";")),this.key}},we=d=>new Zi(d)}),Qi,zt,M$1,pr,Gn,Ln,Fn,xe=j(()=>{Qi=class{static calcMatMulShape(d,g){return d[1]!==g[0]?void 0:[d[0],g[1]]}},zt=class{static calcShape(d,g,b=!1){let et=d.length,st=g.length;if(et===0)return g;if(st===0)return d;let at=Math.max(d.length,g.length),vt=new Array(at);if(b){if(et<2||st<2)return;let Tt=Qi.calcMatMulShape([d[et-2],d[et-1]],[g[st-2],g[st-1]]);if(Tt===void 0)return;[vt[at-2],vt[at-1]]=Tt}for(let Tt=b?3:1;Tt<=at;Tt++){let Ct=et-Tt<0?1:d[et-Tt],pt=st-Tt<0?1:g[st-Tt];if(Ct!==pt&&Ct>1&&pt>1)return;let wt=Math.max(Ct,pt);if(Ct&&pt)vt[at-Tt]=Math.max(Ct,pt);else{if(wt>1)return;vt[at-Tt]=0}}return vt}static isValidBroadcast(d,g){let b=d.length,et=g.length;if(b>et)return!1;for(let st=1;st<=b;st++)if(d[b-st]!==1&&d[b-st]!==g[et-st])return!1;return!0}},M$1=class H2{static size(g){return H2.getSizeFromDimensionRange(g,0,g.length)}static convertShape(g,b=4){let et=g.length;if(et===0)return[];let st=new Array(et),at=et-1;for(;at>=0;){if(g[at]%b===0){st[at]=g[at]/b;break}if(b%g[at]!==0)throw new Error("cannot convert shape");st[at]=1,b/=g[at],at--}for(at--;at>=0;at--)st[at]=g[at];return st}static sizeFromDimension(g,b){if(b<0||b>g.length)throw new Error(`invalid dimension of ${b} for sizeFromDimension as Tensor has ${g.length} dimensions.`);return H2.getSizeFromDimensionRange(g,b,g.length)}static sizeToDimension(g,b){if(b<0||b>g.length)throw new Error(`invalid dimension of ${b} for sizeToDimension as Tensor has ${g.length} dimensions.`);return H2.getSizeFromDimensionRange(g,0,b)}static getSizeFromDimensionRange(g,b,et){let st=1;for(let at=b;at<et;at++){if(g[at]<0)throw new Error("cannot get valid size from specified dimension range. Most likely the range contains negative values in them.");st*=g[at]}return st}static computeStrides(g){let b=g.length;if(b===0)return[];if(b===1)return[1];let et=new Array(b);et[b-1]=1,et[b-2]=g[b-1];for(let st=b-3;st>=0;--st)et[st]=et[st+1]*g[st+1];return et}static normalizeAxis(g,b){if(g<-b&&g>=b)throw new Error("unsupported axis for this operation.");return g<0?g+b:g}static normalizeAxes(g,b){return g.map(et=>this.normalizeAxis(et,b??g.length))}static sortBasedOnPerm(g,b){return b?b.map(et=>g[et]):g.slice().reverse()}static padShape(g,b){let et=g.length;return g.map((st,at)=>st+b[at]+b[at+et])}static areEqual(g,b){return g.length!==b.length?!1:g.every((et,st)=>et===b[st])}},pr=class qx{static adjustPoolAttributes(g,b,et,st,at,vt){if(!g&&et.length!==b.length-2)throw new Error("length of specified kernel shapes should be 2 less than length of input dimensions");if(g)for(let Tt=0;Tt<b.length-2;Tt++)Tt>=et.length?et.push(b[Tt+2]):et[Tt]=b[Tt+2];for(let Tt=0;Tt<et.length;Tt++)if(Tt<st.length){if(st[Tt]<0)throw new Error("strides should be greater than or equal to 1")}else st.push(1);for(let Tt=0;Tt<et.length;Tt++)if(Tt<at.length){if(at[Tt]<0)throw new Error("dilations should be greater than or equal to 1")}else at.push(1);for(let Tt=0;Tt<et.length*2;Tt++)if(Tt<vt.length){if(vt[Tt]<0)throw new Error("pad should be greater than or equal to 1")}else vt.push(0);for(let Tt=0;Tt<et.length;Tt++){if(et[Tt]<=0)throw new Error("kernel shapes need to be greater than 0");if(vt[Tt]>=et[Tt]||vt[Tt+et.length]>=et[Tt])throw new Error("pads should be smaller than kernel")}}static adjustPadsBasedOnAutoPad(g,b,et,st,at,vt,Tt){if(Tt){if(at.length!==2*(g.length-2))throw new Error("length of pads should be twice the length of data dimensions");if(b.length!==g.length-2)throw new Error("length of strides should be the length of data dimensions");if(st.length!==g.length-2)throw new Error("length of kernel shapes should be the length of data dimensions");for(let Ct=0;Ct<g.length-2;Ct++)qx.adjustPadAndReturnShape(g[Ct+(vt?1:2)],b[Ct],et[Ct],st[Ct],at,Ct,Ct+g.length-2,Tt)}}static computePoolOutputShape(g,b,et,st,at,vt,Tt){if(b.length<=0)throw new Error("input shape must be of size greater than 0");let Ct=[b[0],b[1]];return qx.computeShapeHelper(g,b,Ct,et,st,at,vt,Tt),Ct}static computeConvOutputShape(g,b,et,st,at,vt,Tt){if(g.length<=0||b.length<=0)throw new Error("invalid input tensor dims or invalid filter tensor dims");let Ct=[g[0],b[0]];return qx.computeShapeHelper(!1,g,Ct,et,st,at,vt,Tt),Ct}static computeShapeHelper(g,b,et,st,at,vt,Tt,Ct){if(g)for(let pt=0;pt<b.length-2;pt++)et.push(1);else for(let pt=0;pt<b.length-2;pt++)et.push(qx.adjustPadAndReturnShape(b[pt+2],st[pt],at[pt],vt[pt],Tt,pt,pt+b.length-2,Ct))}static adjustPadAndReturnShape(g,b,et,st,at,vt,Tt,Ct){let pt=et*(st-1)+1;if(Ct&&Ct!=="NOTSET")switch(Ct){case"VALID":return at[vt]=0,at[Tt]=0,Math.floor((g-pt)/b+1);case"SAME_LOWER":case"SAME_UPPER":if(et!==1)throw new Error("Dilation not supported for SAME_UPPER or SAME_LOWER");{let wt=((g+b-1)/b-1)*b+st-g;return at[vt]=Math.floor(Ct==="SAME_LOWER"?(wt+1)/2:wt/2),at[Tt]=wt-at[vt],Math.floor((g+wt-st)/b+1)}default:throw new Error("Unsupported AutoPad type")}else return Math.floor((g+at[vt]+at[Tt]-pt)/b+1)}},Gn=class{static getShapeOfGemmResult(d,g,b,et,st){if(d.length!==2||b.length!==2)throw new Error("shape need to be of size 2");let at,vt,Tt;g?(at=d[1],vt=d[0]):(at=d[0],vt=d[1]);let Ct=-1;if(et?(Tt=b[0],Ct=1):(Tt=b[1],Ct=0),b[Ct]!==vt)throw new Error("dimension mismatch");if(at<=0||Tt<=0||vt<=0)throw new Error("invalid shape specified");if(st&&!zt.isValidBroadcast(st,[at,Tt]))throw new Error("gemm: invalid bias shape for broadcast");return[at,Tt,vt]}},Ln=-34028234663852886e22,Fn=34028234663852886e22}),mr,eo,De,rt,X,Ue,At,fr,Et,fe,to,U$1,K,qn,Ji,as,Pr,_e=j(()=>{ye(),xe(),mr=64,eo=(d,g)=>{if(g===3)throw new Error("vec3 has same alignment as vec4, use vec4 instead");switch(d){case 10:return g>1?`vec${g}<f16>`:"f16";case 1:return g>1?`vec${g}<f32>`:"f32";case 6:return g>1?`vec${g}<i32>`:"i32";case 12:return g>1?`vec${g}<u32>`:"u32";case 7:if(g>1)throw new Error("currently not supported vecX of uint64 yet");return["vec2<u32>","i32"];case 13:if(g>1)throw new Error("currently not supported vecX of uint64 yet");return["vec2<u32>","u32"];case 9:if(g!==4)throw new Error("bool must be vec4");return["u32","vec4<bool>"];default:throw new Error(`Unknown data type: ${d}`)}},De=(d,g=1)=>{let b=eo(d,g);return typeof b=="string"?b:b[0]},rt=(d,g=1)=>{let b=eo(d,g);return typeof b=="string"?b:b[1]},X=(...d)=>{let g=[];return d.forEach(b=>{b.length!==0&&g.push({type:12,data:b},{type:12,data:M$1.computeStrides(b)})}),g},Ue=d=>d%4===0?4:d%2===0?2:1,At=(d="f32",g,b="0")=>!g||g===1?`${d}(${b})`:`vec${g}<${d}>(${b})`,fr=(d,g,b)=>d==="f32"?b:g===1?`f32(${b})`:`vec${g}<f32>(${b})`,Et=(d,g)=>g===4?`(${d}.x + ${d}.y + ${d}.z + ${d}.w)`:g===2?`(${d}.x + ${d}.y)`:g===3?`(${d}.x + ${d}.y + ${d}.z)`:d,fe=(d,g,b,et)=>d.startsWith("uniforms.")&&b>4?typeof g=="string"?et==="f16"?`${d}[(${g}) / 8][(${g}) % 8 / 4][(${g}) % 8 % 4]`:`${d}[(${g}) / 4][(${g}) % 4]`:et==="f16"?`${d}[${Math.floor(g/8)}][${Math.floor(g%8/4)}][${g%8%4}]`:`${d}[${Math.floor(g/4)}][${g%4}]`:b>1?`${d}[${g}]`:d,to=(d,g,b,et,st)=>{let at=typeof b=="number",vt=at?b:b.length,Tt=[...new Array(vt).keys()],Ct=vt<2?"u32":vt<=4?`vec${vt}<u32>`:`array<u32, ${vt}>`,pt=eo(g,st),wt=typeof pt=="string"?pt:pt[1],$t=typeof pt=="string"?pt:pt[0],Lt={indices:Ct,value:wt,storage:$t,tensor:g},jt=Sn=>typeof Sn=="string"?Sn:`${Sn}u`,Ft={offsetToIndices:!1,indicesToOffset:!1,broadcastedIndicesToOffset:!1,set:!1,setByIndices:!1,get:!1,getByIndices:!1},Gt=at?"uniforms.":"",Ht=`${Gt}${d}_shape`,qt=`${Gt}${d}_strides`,Kt="";for(let Sn=0;Sn<vt-1;Sn++)Kt+=`
    let dim${Sn} = current / ${fe(qt,Sn,vt)};
    let rest${Sn} = current % ${fe(qt,Sn,vt)};
    indices[${Sn}] = dim${Sn};
    current = rest${Sn};
    `;Kt+=`indices[${vt-1}] = current;`;let rr=vt<2?"":`
  fn o2i_${d}(offset: u32) -> ${Lt.indices} {
    var indices: ${Lt.indices};
    var current = offset;
    ${Kt}
    return indices;
  }`,ir=Sn=>(Ft.offsetToIndices=!0,vt<2?Sn:`o2i_${d}(${Sn})`),or=[];if(vt>=2)for(let Sn=vt-1;Sn>=0;Sn--)or.push(`${fe(qt,Sn,vt)} * (indices[${Sn}])`);let jr=vt<2?"":`
  fn i2o_${d}(indices: ${Lt.indices}) -> u32 {
    return ${or.join("+")};
  }`,qr=Sn=>(Ft.indicesToOffset=!0,vt<2?Sn:`i2o_${d}(${Sn})`),Yr=(...Sn)=>vt===0?"0u":`${Lt.indices}(${Sn.map(jt).join(",")})`,vn=(Sn,Tn)=>vt<2?`${Sn}`:`${fe(Sn,Tn,vt)}`,ko=(Sn,Tn,n0)=>vt<2?`${Sn}=${n0};`:`${fe(Sn,Tn,vt)}=${n0};`,Xo={},zo=(Sn,Tn)=>{Ft.broadcastedIndicesToOffset=!0;let n0=`${Tn.name}broadcastedIndicesTo${d}Offset`;if(n0 in Xo)return`${n0}(${Sn})`;let Go=[];for(let An=vt-1;An>=0;An--){let a0=Tn.indicesGet("outputIndices",An+Tn.rank-vt);Go.push(`${vn(qt,An)} * (${a0} % ${vn(Ht,An)})`)}return Xo[n0]=`fn ${n0}(outputIndices: ${Tn.type.indices}) -> u32 {
             return ${Go.length>0?Go.join("+"):"0u"};
           }`,`${n0}(${Sn})`},t0=(Sn,Tn)=>(()=>{if(Lt.storage===Lt.value)return`${d}[${Sn}]=${Tn};`;if(Lt.storage==="vec2<u32>"&&Lt.value==="i32")return`${d}[${Sn}]=vec2<u32>(u32(${Tn}), select(0u, 0xFFFFFFFFu, ${Tn} < 0));`;if(Lt.storage==="vec2<u32>"&&Lt.value==="u32")return`${d}[${Sn}]=vec2<u32>(u32(${Tn}), 0u);`;if(Lt.storage==="u32"&&Lt.value==="vec4<bool>")return`${d}[${Sn}]=dot(vec4<u32>(0x1, 0x100, 0x10000, 0x1000000), vec4<u32>(${Tn}));`;throw new Error(`not supported combination of storage type ${Lt.storage} and value type ${Lt.value} yet`)})(),Uo=Sn=>(()=>{if(Lt.storage===Lt.value)return`${d}[${Sn}]`;if(Lt.storage==="vec2<u32>"&&Lt.value==="i32")return`i32(${d}[${Sn}].x)`;if(Lt.storage==="vec2<u32>"&&Lt.value==="u32")return`u32(${d}[${Sn}].x)`;if(Lt.storage==="u32"&&Lt.value==="vec4<bool>")return`vec4<bool>(bool(${d}[${Sn}] & 0xFFu), bool(${d}[${Sn}] & 0xFF00u), bool(${d}[${Sn}] & 0xFF0000u), bool(${d}[${Sn}] & 0xFF000000u))`;throw new Error(`not supported combination of storage type ${Lt.storage} and value type ${Lt.value} yet`)})(),No=vt<2?"":`
  fn get_${d}ByIndices(indices: ${Lt.indices}) -> ${wt} {
    return ${Uo(`i2o_${d}(indices)`)};
  }`,_n=vt<2?"":(()=>{let Sn=Tt.map(n0=>`d${n0}: u32`).join(", "),Tn=Tt.map(n0=>`d${n0}`).join(", ");return`
  fn get_${d}(${Sn}) -> ${wt} {
    return get_${d}ByIndices(${Yr(Tn)});
  }`})(),Kr=(...Sn)=>{if(Sn.length!==vt)throw new Error(`indices length must be ${vt}`);let Tn=Sn.map(jt).join(",");return vt===0?Uo("0u"):vt===1?Uo(Tn[0]):(Ft.get=!0,Ft.getByIndices=!0,Ft.indicesToOffset=!0,`get_${d}(${Tn})`)},e0=Sn=>vt<2?Uo(Sn):(Ft.getByIndices=!0,Ft.indicesToOffset=!0,`get_${d}ByIndices(${Sn})`),Zr=vt<2?"":`
  fn set_${d}ByIndices(indices: ${Lt.indices}, value: ${wt}) {
    ${t0(`i2o_${d}(indices)`,"value")}
  }`,Ro=vt<2?"":(()=>{let Sn=Tt.map(n0=>`d${n0}: u32`).join(", "),Tn=Tt.map(n0=>`d${n0}`).join(", ");return`
  fn set_${d}(${Sn}, value: ${wt}) {
    set_${d}ByIndices(${Yr(Tn)}, value);
  }`})();return{impl:()=>{let Sn=[],Tn=!1;return Ft.offsetToIndices&&(Sn.push(rr),Tn=!0),Ft.indicesToOffset&&(Sn.push(jr),Tn=!0),Ft.broadcastedIndicesToOffset&&(Object.values(Xo).forEach(n0=>Sn.push(n0)),Tn=!0),Ft.set&&(Sn.push(Ro),Tn=!0),Ft.setByIndices&&(Sn.push(Zr),Tn=!0),Ft.get&&(Sn.push(_n),Tn=!0),Ft.getByIndices&&(Sn.push(No),Tn=!0),!at&&Tn&&Sn.unshift(`const ${Ht} = ${Lt.indices}(${b.join(",")});`,`const ${qt} = ${Lt.indices}(${M$1.computeStrides(b).join(",")});`),Sn.join(`
`)},type:Lt,offsetToIndices:ir,indicesToOffset:qr,broadcastedIndicesToOffset:zo,indices:Yr,indicesGet:vn,indicesSet:ko,set:(...Sn)=>{if(Sn.length!==vt+1)throw new Error(`indices length must be ${vt}`);let Tn=Sn[vt];if(typeof Tn!="string")throw new Error("value must be string");let n0=Sn.slice(0,vt).map(jt).join(",");return vt===0?t0("0u",Tn):vt===1?t0(n0[0],Tn):(Ft.set=!0,Ft.setByIndices=!0,Ft.indicesToOffset=!0,`set_${d}(${n0}, ${Tn})`)},setByOffset:t0,setByIndices:(Sn,Tn)=>vt<2?t0(Sn,Tn):(Ft.setByIndices=!0,Ft.indicesToOffset=!0,`set_${d}ByIndices(${Sn}, ${Tn});`),get:Kr,getByOffset:Uo,getByIndices:e0,usage:et,name:d,strides:qt,shape:Ht,rank:vt}},U$1=(d,g,b,et=1)=>to(d,g,b,"input",et),K=(d,g,b,et=1)=>to(d,g,b,"output",et),qn=(d,g,b,et=1)=>to(d,g,b,"internal",et),Ji=class{constructor(d,g){this.normalizedDispatchGroup=d,this.limits=g,this.internalVariables=[],this.variables=[],this.uniforms=[],this.variableIndex=0}guardAgainstOutOfBoundsWorkgroupSizes(d){return`if (global_idx >= ${typeof d=="number"?`${d}u`:d}) { return; }`}mainStart(d=mr){let g=typeof d=="number"?d:d[0],b=typeof d=="number"?1:d[1],et=typeof d=="number"?1:d[2];if(g>this.limits.maxComputeWorkgroupSizeX||b>this.limits.maxComputeWorkgroupSizeY||et>this.limits.maxComputeWorkgroupSizeZ)throw new Error(`workgroup size [${g}, ${b}, ${et}] exceeds the maximum workgroup size [${this.limits.maxComputeWorkgroupSizeX}, ${this.limits.maxComputeWorkgroupSizeY}, ${this.limits.maxComputeWorkgroupSizeZ}].`);if(g*b*et>this.limits.maxComputeInvocationsPerWorkgroup)throw new Error(`workgroup size [${g}, ${b}, ${et}] exceeds the maximum workgroup invocations ${this.limits.maxComputeInvocationsPerWorkgroup}.`);let st=this.normalizedDispatchGroup[1]===1&&this.normalizedDispatchGroup[2]===1,at=st?`@builtin(global_invocation_id) global_id : vec3<u32>,
    @builtin(workgroup_id) workgroup_id : vec3<u32>,
    @builtin(local_invocation_id) local_id : vec3<u32>`:`@builtin(global_invocation_id) global_id : vec3<u32>,
                                             @builtin(local_invocation_id) local_id : vec3<u32>,
    @builtin(local_invocation_index) local_idx : u32,
    @builtin(workgroup_id) workgroup_id : vec3<u32>,
    @builtin(num_workgroups) num_workgroups : vec3<u32>`,vt=st?"let global_idx = global_id.x; let local_idx = local_id.x;":`let global_idx = (workgroup_id.z * num_workgroups[0] * num_workgroups[1] +
          workgroup_id.y * num_workgroups[0] + workgroup_id.x) * ${g*b*et}u + local_idx;`;return`@compute @workgroup_size(${g}, ${b}, ${et})
  fn main(${at}) {
    ${vt}
  `}appendVariableUniforms(d){d.rank!==0&&(d.shape.startsWith("uniforms.")&&this.uniforms.push({name:d.shape.replace("uniforms.",""),type:"u32",length:d.rank}),d.strides.startsWith("uniforms.")&&this.uniforms.push({name:d.strides.replace("uniforms.",""),type:"u32",length:d.rank}))}declareVariable(d,g){if(d.usage==="internal")throw new Error("cannot use internal variable with declareVariable(). use registerInternalVariables() instead.");this.variables.push(d),this.appendVariableUniforms(d);let b=d.usage==="input"?"read":"read_write",et=d.type.storage;return`@group(0) @binding(${g}) var<storage, ${b}> ${d.name}: array<${et}>;`}declareVariables(...d){return d.map(g=>this.declareVariable(g,this.variableIndex++)).join(`
`)}registerInternalVariable(d){if(d.usage!=="internal")throw new Error("cannot use input or output variable with registerInternalVariable(). use declareVariables() instead.");this.internalVariables.push(d),this.appendVariableUniforms(d)}registerInternalVariables(...d){return d.forEach(g=>this.registerInternalVariable(g)),this}registerUniform(d,g,b=1){return this.uniforms.push({name:d,type:g,length:b}),this}registerUniforms(d){return this.uniforms=this.uniforms.concat(d),this}uniformDeclaration(){if(this.uniforms.length===0)return"";let d=[];for(let{name:g,type:b,length:et}of this.uniforms)if(et&&et>4)b==="f16"?d.push(`@align(16) ${g}:array<mat2x4<${b}>, ${Math.ceil(et/8)}>`):d.push(`${g}:array<vec4<${b}>, ${Math.ceil(et/4)}>`);else{let st=et==null||et===1?b:`vec${et}<${b}>`;d.push(`${g}:${st}`)}return`
      struct Uniforms { ${d.join(", ")} };
      @group(0) @binding(${this.variableIndex}) var<uniform> uniforms: Uniforms;`}get additionalImplementations(){return this.uniformDeclaration()+this.variables.map(d=>d.impl()).join(`
`)+this.internalVariables.map(d=>d.impl()).join(`
`)}get variablesInfo(){if(this.uniforms.length===0)return;let d=g=>[12,10,1,6][["u32","f16","f32","i32"].indexOf(g)];return this.uniforms.map(g=>[d(g.type),g.length??1])}},as=(d,g)=>new Ji(d,g),Pr=(d,g)=>{let b=d.length,et=[];for(let st=0;st<b;st++){let at=b-1-st,vt=d[at]||1;(g[g.length-1-st]||1)>1&&vt===1&&et.unshift(at)}return et}}),Ec,ss,kc,Oc,xt,us,ls,Rr=j(()=>{ye(),xe(),Ze(),_e(),Ec=d=>{if(!d||d.length!==1)throw new Error("Transpose requires 1 input.")},ss=(d,g)=>g&&g.length!==d?[...new Array(d).keys()].reverse():g,kc=(d,g)=>M$1.sortBasedOnPerm(d,ss(d.length,g)),Oc=(d,g,b,et)=>{let st=[];st.push(`fn perm(i: ${et.type.indices}) -> ${b.type.indices} {
    var a: ${b.type.indices};`);for(let at=0;at<g;++at)st.push(b.indicesSet("a",d[at],`i[${at}]`));return st.push("return a;}"),st.join(`
`)},xt=(d,g)=>{let b=d.dataType,et=d.dims.length,st=ss(et,g),at=kc(d.dims,st),vt=K("output",b,at.length),Tt=U$1("a",b,et),Ct=pt=>`
  ${pt.registerUniform("output_size","u32").declareVariables(Tt,vt)}

  ${Oc(st,et,Tt,vt)}

  ${pt.mainStart()}
    ${pt.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.output_size")}

    let indices = ${vt.offsetToIndices("global_idx")};
    let aIndices = perm(indices);

    ${vt.setByOffset("global_idx",Tt.getByIndices("aIndices"))}
  }`;return{name:"Transpose",shaderCache:{hint:`${g}`,inputDependencies:["rank"]},getRunData:pt=>{let wt=M$1.size(at);return{outputs:[{dims:at,dataType:pt[0].dataType}],dispatchGroup:{x:Math.ceil(wt/64)},programUniforms:[{type:12,data:wt},...X(pt[0].dims,at)]}},getShaderSource:Ct}},us=(d,g)=>{Ec(d.inputs),d.compute(xt(d.inputs[0],g.perm))},ls=d=>we({perm:d.perm})}),Pc,Rc,zc,Bc,Dc,Mc,Uc,Wc,Nc,Vc,Bt,ds,cs,ps,ms,fs,hs,gs,ys,bs,vs,ws=j(()=>{ye(),xe(),_e(),jn(),Rr(),Pc={max:"select(bestValue, candidate, candidate > bestValue)",min:"select(bestValue, candidate, candidate < bestValue)",mean:"bestValue + candidate",sum:"bestValue + candidate",prod:"bestValue * candidate",sumSquare:"bestValue + candidate * candidate",logSumExp:"bestValue + exp(candidate)",l1:"bestValue + abs(candidate)",l2:"bestValue + candidate * candidate",logSum:"bestValue + candidate"},Rc={max:"select(bestValue, candidate, candidate > bestValue)",min:"select(bestValue, candidate, candidate < bestValue)",mean:"bestValue + candidate",sum:"bestValue + candidate",prod:"bestValue * candidate",sumSquare:"bestValue + candidate",logSumExp:"bestValue + candidate",l1:"bestValue + candidate",l2:"bestValue + candidate",logSum:"bestValue + candidate"},zc={max:"_A[offset]",min:"_A[offset]",mean:"0",sum:"0",prod:"1",sumSquare:"0",logSumExp:"0",l1:"0",l2:"0",logSum:"0"},Bc={max:"bestValue",min:"bestValue",sum:"bestValue",prod:"bestValue",sumSquare:"bestValue",logSumExp:"log(bestValue)",l1:"bestValue",l2:"sqrt(bestValue)",logSum:"log(bestValue)"},Dc=(d,g)=>{let b=[];for(let et=g-d;et<g;++et)b.push(et);return b},Mc=(d,g)=>{let b=[],et=d.length;for(let at=0;at<et;at++)g.indexOf(at)===-1&&b.push(d[at]);let st=g.map(at=>d[at]);return[b,st]},Uc=(d,g)=>{let b=d.length+g.length,et=[],st=0;for(let at=0;at<b;at++)g.indexOf(at)===-1?et.push(d[st++]):et.push(1);return et},Wc=(d,g)=>{for(let b=0;b<d.length;++b)if(d[d.length-b-1]!==g-1-b)return!1;return!0},Nc=(d,g)=>{let b=[];if(!Wc(d,g)){for(let et=0;et<g;++et)d.indexOf(et)===-1&&b.push(et);d.forEach(et=>b.push(et))}return b},Vc=(d,g,b,et,st,at,vt)=>{let Tt=b[0].dims,Ct=M$1.size(at),pt=M$1.size(vt),wt=U$1("_A",b[0].dataType,Tt),$t=K("output",st,at),Lt=32,jt=`
          var<workgroup> aBestValues : array<f32, ${Lt}>;
       `;return{name:d,shaderCache:g,getShaderSource:Ft=>`
        ${Ft.registerUniform("reduceSize","u32").declareVariables(wt,$t)}
        ${jt}
        fn DIV_CEIL(a : u32, b : u32) -> u32 {
          return ((a - 1u) / b + 1u);
         }
         ${Ft.mainStart(Lt)}

          let outputIndex = global_idx / ${Lt};
          let offset = outputIndex * uniforms.reduceSize;

          var bestValue = f32(${zc[et]});
          let Length = uniforms.reduceSize;
          for (var k = local_idx; k < Length; k = k + ${Lt}) {
           let candidate = f32(${wt.getByOffset("offset + k")});
           bestValue = ${Pc[et]};
          }
          aBestValues[local_idx] = bestValue;
          workgroupBarrier();

         var reduceSize = min(Length, ${Lt}u);
         for (var currentSize = reduceSize / 2u; reduceSize > 1u;
             currentSize = reduceSize / 2u) {
           let interval = DIV_CEIL(reduceSize, 2u);
           if (local_idx < currentSize) {
            let candidate = aBestValues[local_idx + interval];
            bestValue = ${Rc[et]};
            aBestValues[local_idx] = bestValue;
           }
           reduceSize = interval;
           workgroupBarrier();
         }

         if (local_idx == 0u) {
          ${$t.setByOffset("outputIndex",`${et==="mean"?`${$t.type.storage}(bestValue / f32(uniforms.reduceSize))`:`${$t.type.storage}(${Bc[et]})`}`)};
         }
        }`,getRunData:()=>({outputs:[{dims:at,dataType:st}],dispatchGroup:{x:Ct},programUniforms:[{type:12,data:pt}]})}},Bt=(d,g,b,et)=>{let st=d.inputs.length===1?b:ro(d.inputs,b),at=st.axes;at.length===0&&!st.noopWithEmptyAxes&&(at=d.inputs[0].dims.map((jt,Ft)=>Ft));let vt=M$1.normalizeAxes(at,d.inputs[0].dims.length),Tt=vt,Ct=d.inputs[0],pt=Nc(Tt,d.inputs[0].dims.length);pt.length>0&&(Ct=d.compute(xt(d.inputs[0],pt),{inputs:[0],outputs:[-1]})[0],Tt=Dc(Tt.length,Ct.dims.length));let[wt,$t]=Mc(Ct.dims,Tt),Lt=wt;st.keepDims&&(Lt=Uc(wt,vt)),d.compute(Vc(g,{hint:st.cacheKey,inputDependencies:["type"]},[Ct],et,d.inputs[0].dataType,Lt,$t),{inputs:[Ct]})},ds=(d,g)=>{Bt(d,"ReduceMeanShared",g,"mean")},cs=(d,g)=>{Bt(d,"ReduceL1Shared",g,"l1")},ps=(d,g)=>{Bt(d,"ReduceL2Shared",g,"l2")},ms=(d,g)=>{Bt(d,"ReduceLogSumExpShared",g,"logSumExp")},fs=(d,g)=>{Bt(d,"ReduceMaxShared",g,"max")},hs=(d,g)=>{Bt(d,"ReduceMinShared",g,"min")},gs=(d,g)=>{Bt(d,"ReduceProdShared",g,"prod")},ys=(d,g)=>{Bt(d,"ReduceSumShared",g,"sum")},bs=(d,g)=>{Bt(d,"ReduceSumSquareShared",g,"sumSquare")},vs=(d,g)=>{Bt(d,"ReduceLogSumShared",g,"logSum")}}),Dt,Hc,Kn,ro,Mt,Gc,Lc,Fc,qc,jc,Kc,Yc,Xc,Zc,Qc,Ut,$s,_s,xs,Ss,Cs,Is,Ts,As,Es,ks,jn=j(()=>{ye(),xe(),Ze(),_e(),ws(),Dt=d=>{if(!d||d.length===0||d.length>2)throw new Error("Reduce op requires 1 or 2 inputs.");if(d.length===2&&d[1].dims.length!==1)throw new Error("Invalid axes input dims.")},Hc=d=>["","",`var value = ${d.getByIndices("input_indices")};`,""],Kn=(d,g,b,et,st,at,vt=!1,Tt=!1)=>{let Ct=[],pt=b[0].dims,wt=pt.length,$t=M$1.normalizeAxes(st,wt),Lt=!Tt&&$t.length===0;pt.forEach((Gt,Ht)=>{Lt||$t.indexOf(Ht)>=0?vt&&Ct.push(1):Ct.push(Gt)});let jt=Ct.length,Ft=M$1.size(Ct);return{name:d,shaderCache:g,getShaderSource:Gt=>{let Ht=[],qt=U$1("_A",b[0].dataType,wt),Kt=K("output",at,jt),rr=et(qt,Kt,$t),ir=rr[2];for(let or=0,jr=0;or<wt;or++)Lt||$t.indexOf(or)>=0?(vt&&jr++,ir=`for(var j${or}: u32 = 0; j${or} < ${pt[or]}; j${or}++) {
                  ${rr[2].includes("last_index")?`let last_index = j${or};`:""}
                  ${qt.indicesSet("input_indices",or,`j${or}`)}
                  ${ir}
                }`):(Ht.push(`${qt.indicesSet("input_indices",or,Kt.indicesGet("output_indices",jr))};`),jr++);return`

        ${Gt.registerUniform("output_size","u32").declareVariables(qt,Kt)}

        ${Gt.mainStart()}
          ${Gt.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.output_size")}
          var input_indices: ${qt.type.indices};
          let output_indices = ${Kt.offsetToIndices("global_idx")};

          ${Ht.join(`
`)}
          ${rr[0]}       // init ops for reduce max/min
          ${rr[1]}
          ${ir}
          ${rr[3]}
          ${rr.length===4?Kt.setByOffset("global_idx","value"):rr.slice(4).join(`
`)}
        }`},getRunData:()=>({outputs:[{dims:Ct,dataType:at}],dispatchGroup:{x:Math.ceil(Ft/64)},programUniforms:[{type:12,data:Ft},...X(pt,Ct)]})}},ro=(d,g)=>{let b=[];return d[1].dims[0]>0&&d[1].getBigInt64Array().forEach(et=>b.push(Number(et))),we({axes:b,keepDims:g.keepDims,noopWithEmptyAxes:g.noopWithEmptyAxes})},Mt=(d,g,b,et)=>{let st=d.inputs,at=st.length===1?b:ro(st,b);d.compute(Kn(g,{hint:at.cacheKey,inputDependencies:["rank"]},[st[0]],at.noopWithEmptyAxes&&at.axes.length===0?Hc:et,at.axes,st[0].dataType,at.keepDims,at.noopWithEmptyAxes),{inputs:[0]})},Gc=(d,g)=>{Dt(d.inputs),Mt(d,"ReduceLogSum",g,(b,et)=>[`var value = ${et.type.storage}(0);`,"",`value += ${b.getByIndices("input_indices")};`,"value = log(value);"])},Lc=(d,g)=>{Dt(d.inputs),Mt(d,"ReduceL1",g,(b,et)=>[`var value = ${et.type.storage}(0);`,"",`value += abs(${b.getByIndices("input_indices")});`,""])},Fc=(d,g)=>{Dt(d.inputs),Mt(d,"ReduceL2",g,(b,et)=>[`var t = ${et.type.value}(0); var value = ${et.type.value}(0);`,"",`t = ${b.getByIndices("input_indices")}; value += (t * t);`,"value = sqrt(value);"])},qc=(d,g)=>{Dt(d.inputs),Mt(d,"ReduceLogSumExp",g,(b,et)=>[`var value = ${et.type.storage}(0);`,"",`value += exp(${b.getByIndices("input_indices")});`,"value = log(value);"])},jc=(d,g)=>{Dt(d.inputs),Mt(d,"ReduceMax",g,(b,et,st)=>{let at=[];for(let vt=0;vt<b.rank;vt++)(st.indexOf(vt)>=0||st.length===0)&&at.push(b.indicesSet("input_indices",vt,0));return[`${at.join(`
`)}`,`var value = ${b.getByIndices("input_indices")};`,`value = max(value, ${b.getByIndices("input_indices")});`,""]})},Kc=(d,g)=>{Dt(d.inputs),Mt(d,"ReduceMean",g,(b,et,st)=>{let at=1;for(let vt=0;vt<b.rank;vt++)(st.indexOf(vt)>=0||st.length===0)&&(at*=d.inputs[0].dims[vt]);return["var sum = f32(0);","",`sum += f32(${b.getByIndices("input_indices")});`,`let value = ${et.type.value}(sum / ${at});`]})},Yc=(d,g)=>{Dt(d.inputs),Mt(d,"ReduceMin",g,(b,et,st)=>{let at=[];for(let vt=0;vt<b.rank;vt++)(st.indexOf(vt)>=0||st.length===0)&&at.push(`input_indices[${vt}] = 0;`);return[`${at.join(`
`)}`,`var value = ${b.getByIndices("input_indices")};`,`value = min(value, ${b.getByIndices("input_indices")});`,""]})},Xc=(d,g)=>{Dt(d.inputs),Mt(d,"ReduceProd",g,(b,et)=>[`var value = ${et.type.storage}(1);`,"",`value *= ${b.getByIndices("input_indices")};`,""])},Zc=(d,g)=>{Dt(d.inputs),Mt(d,"ReduceSum",g,(b,et)=>[`var value = ${et.type.storage}(0);`,"",`value += ${b.getByIndices("input_indices")};`,""])},Qc=(d,g)=>{Dt(d.inputs),Mt(d,"ReduceSumSquare",g,(b,et)=>[`var t = ${et.type.value}(0); var value = ${et.type.value}(0);`,"",`t = ${b.getByIndices("input_indices")}; value += t * t;`,""])},Ut=(d,g,b)=>{if(g.length===0)return b;let et=1,st=1;for(let at=0;at<g.length;at++)g.indexOf(at)===-1?et*=d[at]:st*=d[at];return st<32&&et>1024},$s=(d,g)=>{Ut(d.inputs[0].dims,g.axes,g.noopWithEmptyAxes)?Kc(d,g):ds(d,g)},_s=(d,g)=>{Ut(d.inputs[0].dims,g.axes,g.noopWithEmptyAxes)?Lc(d,g):cs(d,g)},xs=(d,g)=>{Ut(d.inputs[0].dims,g.axes,g.noopWithEmptyAxes)?Fc(d,g):ps(d,g)},Ss=(d,g)=>{Ut(d.inputs[0].dims,g.axes,g.noopWithEmptyAxes)?qc(d,g):ms(d,g)},Cs=(d,g)=>{Ut(d.inputs[0].dims,g.axes,g.noopWithEmptyAxes)?jc(d,g):fs(d,g)},Is=(d,g)=>{Ut(d.inputs[0].dims,g.axes,g.noopWithEmptyAxes)?Yc(d,g):hs(d,g)},Ts=(d,g)=>{Ut(d.inputs[0].dims,g.axes,g.noopWithEmptyAxes)?Xc(d,g):gs(d,g)},As=(d,g)=>{Ut(d.inputs[0].dims,g.axes,g.noopWithEmptyAxes)?Zc(d,g):ys(d,g)},Es=(d,g)=>{Ut(d.inputs[0].dims,g.axes,g.noopWithEmptyAxes)?Qc(d,g):bs(d,g)},ks=(d,g)=>{Ut(d.inputs[0].dims,g.axes,g.noopWithEmptyAxes)?Gc(d,g):vs(d,g)}}),Os,Ps,Rs,no,zs=j(()=>{ye(),Ze(),jn(),Os=d=>{if(!d||d.length===0||d.length>2)throw new Error("ArgMinMaxOp op requires 1 or 2 inputs.");if(d[0].dataType!==1)throw new Error("Invalid input type.")},Ps=(d,g)=>{Os(d.inputs);let b=(et,st,at)=>{let vt=[];for(let Tt=0;Tt<et.rank;Tt++)(at.indexOf(Tt)>=0||at.length===0)&&vt.push(`input_indices[${Tt}] = 0;`);return[`${vt.join(`
`)}`,`var value = ${et.getByIndices("input_indices")};
var best_index : i32 = 0;`,`if (${et.getByIndices("input_indices")} ${g.selectLastIndex>0?"<=":"<"} value) {
         value = ${et.getByIndices("input_indices")};
         best_index = i32(last_index);
       }`,"",st.setByOffset("global_idx","best_index")]};d.compute(Kn("ArgMin",{hint:g.cacheKey,inputDependencies:["rank"]},[d.inputs[0]],b,[g.axis],7,g.keepDims),{inputs:[0]})},Rs=(d,g)=>{Os(d.inputs);let b=(et,st,at)=>{let vt=[];for(let Tt=0;Tt<et.rank;Tt++)(at.indexOf(Tt)>=0||at.length===0)&&vt.push(`input_indices[${Tt}] = 0;`);return[`${vt.join(`
`)}`,`var value = ${et.getByIndices("input_indices")};
var best_index : i32 = 0;`,`if (${et.getByIndices("input_indices")} ${g.selectLastIndex>0?">=":">"} value) {
         value = ${et.getByIndices("input_indices")};
         best_index = i32(last_index);
       }`,"",st.setByOffset("global_idx","best_index")]};d.compute(Kn("argMax",{hint:g.cacheKey,inputDependencies:["rank"]},[d.inputs[0]],b,[g.axis],7,g.keepDims),{inputs:[0]})},no=d=>we(d)}),Jc,ep,tp,Yn,Bs,Ds,io=j(()=>{ye(),xe(),Ze(),_e(),Jc=(d,g)=>{if(!d||d.length<1)throw new Error("too few inputs");let b=0,et=d[b],st=et.dataType,at=et.dims.length;d.forEach((vt,Tt)=>{if(Tt!==b){if(vt.dataType!==st)throw new Error("input tensors should be one type");if(vt.dims.length!==at)throw new Error("input tensors should have the same shape");vt.dims.forEach((Ct,pt)=>{if(pt!==g&&Ct!==et.dims[pt])throw new Error("non concat dimensions must match")})}})},ep=(d,g)=>`
  fn calculateInputIndex(index: u32) -> u32 {
    let sizeInConcatAxis = array<u32, ${d}u>(${g});
    for (var i: u32 = 0u; i < ${d}; i += 1u ) {
      if (index < sizeInConcatAxis[i]) {
        return i;
      }
    }
    return ${d}u;
  }`,tp=(d,g)=>{let b=d.length,et=[];for(let st=0;st<b;++st){let at=g.setByOffset("global_idx",d[st].getByIndices("indices"));b===1?et.push(at):st===0?et.push(`if (inputIndex == ${st}u) { ${at} }`):st===b-1?et.push(`else { ${at} }`):et.push(`else if (inputIndex == ${st}) { ${at} }`)}return et.join(`
`)},Yn=(d,g,b,et)=>{let st=M$1.size(b),at=new Array(d.length),vt=new Array(d.length),Tt=0,Ct=[],pt=[],wt=[{type:12,data:st}];for(let Gt=0;Gt<d.length;++Gt)Tt+=d[Gt].dims[g],at[Gt]=Tt,pt.push(d[Gt].dims.length),vt[Gt]=U$1(`input${Gt}`,et,pt[Gt]),Ct.push("rank"),wt.push({type:12,data:at[Gt]});for(let Gt=0;Gt<d.length;++Gt)wt.push(...X(d[Gt].dims));wt.push(...X(b));let $t=K("output",et,b.length),Lt=$t.indicesGet("indices",g),jt=Array.from(Array(at.length).keys()).map(Gt=>`uniforms.sizeInConcatAxis${Gt}`).join(","),Ft=Gt=>`

  ${(()=>{Gt.registerUniform("outputSize","u32");for(let Ht=0;Ht<d.length;Ht++)Gt.registerUniform(`sizeInConcatAxis${Ht}`,"u32");return Gt.declareVariables(...vt,$t)})()}

  ${ep(at.length,jt)}

  ${Gt.mainStart()}
    ${Gt.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.outputSize")}

    var indices = ${$t.offsetToIndices("global_idx")};

    let inputIndex = calculateInputIndex(${Lt});
    if (inputIndex != 0u) {
      let sizeInConcatAxis = array<u32, ${at.length}u>(${jt});
      ${Lt} -= sizeInConcatAxis[inputIndex - 1u];
    }

    ${tp(vt,$t)}
  }`;return{name:"Concat",shaderCache:{hint:`${g}`,inputDependencies:Ct},getRunData:()=>({outputs:[{dims:b,dataType:et}],dispatchGroup:{x:Math.ceil(st/64)},programUniforms:wt}),getShaderSource:Ft}},Bs=(d,g)=>{let b=d.inputs,et=b[0].dims,st=M$1.normalizeAxis(g.axis,et.length);Jc(b,st);let at=et.slice();at[st]=b.reduce((Tt,Ct)=>Tt+(Ct.dims.length>st?Ct.dims[st]:0),0);let vt=b.filter(Tt=>M$1.size(Tt.dims)>0);d.compute(Yn(vt,st,at,b[0].dataType),{inputs:vt})},Ds=d=>we({axis:d.axis})}),rp,np,ip,op,Xn,ap,Ms,oo=j(()=>{ye(),Hn(),_e(),io(),rp=(d,g)=>{let b=d[0],et=d[1],st=d[2],at=d[3],vt=d[4],Tt=d[5];if(vt&&Tt)throw new Error("Attention cannot have both past and relative_position_bias");if(b.dims.length!==3)throw new Error('Input "input" must have 3 dimensions');let Ct=b.dims[0],pt=b.dims[1],wt=b.dims[2];if(st.dims.length!==1)throw new Error('Input "bias" is expected to have 1 dimensions');if(et.dims.length!==2)throw new Error('Input "weights" is expected to have 2 dimensions');if(et.dims[0]!==wt)throw new Error("Input 1 dimension 0 should have same length as dimension 2 of input 0");if(st.dims[0]!==et.dims[1])throw new Error('Input "bias" dimension 0 should have same length as dimension 1 of input "weights"');let $t=st.dims[0]/3,Lt=$t,jt=Lt;if(g.qkvHiddenSizes.length>0){if(g.qkvHiddenSizes.length!==3)throw new Error("qkv_hidden_sizes attribute should have 3 elements");for(let rr of g.qkvHiddenSizes)if(rr%g.numHeads!==0)throw new Error("qkv_hidden_sizes should be divisible by num_heads");$t=g.qkvHiddenSizes[0],Lt=g.qkvHiddenSizes[1],jt=g.qkvHiddenSizes[2]}let Ft=pt;if($t!==Lt)throw new Error("qkv_hidden_sizes first element should be same as the second");if(st.dims[0]!==$t+Lt+jt)throw new Error('Input "bias" dimension 0 should have same length as sum of Q/K/V hidden sizes');let Gt=0;if(vt){if(Lt!==jt)throw new Error('Input "past" expect k_hidden_size == v_hidden_size');if(vt.dims.length!==5)throw new Error('Input "past" must have 5 dimensions');if(vt.dims[0]!==2)throw new Error('Input "past" first dimension must be 2');if(vt.dims[1]!==Ct)throw new Error('Input "past" second dimension must be batch_size');if(vt.dims[2]!==g.numHeads)throw new Error('Input "past" third dimension must be num_heads');if(vt.dims[4]!==Lt/g.numHeads)throw new Error('Input "past" fifth dimension must be k_hidden_size / num_heads');g.pastPresentShareBuffer||(Gt=vt.dims[3])}let Ht=Ft+Gt,qt=-1,Kt=0;if(at)throw new Error("Mask not supported");if(vt)throw new Error("past is not supported");return{batchSize:Ct,sequenceLength:pt,pastSequenceLength:Gt,kvSequenceLength:Ft,totalSequenceLength:Ht,maxSequenceLength:qt,inputHiddenSize:wt,hiddenSize:$t,vHiddenSize:jt,headSize:Math.floor($t/g.numHeads),vHeadSize:Math.floor(jt/g.numHeads),numHeads:g.numHeads,isUnidirectional:!1,pastPresentShareBuffer:!1,maskFilterValue:g.maskFilterValue,maskType:Kt,scale:g.scale,broadcastResPosBias:!1,passPastInKv:!1,qkvFormat:1}},np=(d,g,b,et)=>{let st=Ue(et),at=64,vt=et/st;vt<at?at=1:vt/8<64&&(at=Math.ceil(vt/8));let Tt=Math.ceil(et/st/at),Ct=[{type:g.dataType,data:1/et},{type:12,data:vt},{type:12,data:Tt}],pt=De(g.dataType,st),wt=rt(1,st),$t=Lt=>{let jt=K("x",g.dataType,g.dims,st),Ft=[{name:"d_inv",type:rt(g.dataType)},{name:"d_comp",type:"u32"},{name:"elements_per_thread",type:"u32"}];return`
  var<workgroup> thread_max: array<f32, ${at}>;
  var<workgroup> thread_sum: array<f32, ${at}>;
  ${Lt.registerUniforms(Ft).declareVariables(jt)}
  ${Lt.mainStart([at,1,1])}
    let local_offset = local_idx * uniforms.elements_per_thread;
    let offset = workgroup_id.x * uniforms.d_comp + local_offset;

    var thread_max_vector = ${wt}(-3.402823e+38f);
    for (var i: u32 = 0; i < uniforms.elements_per_thread && i + local_offset < uniforms.d_comp; i++) {
      thread_max_vector = max(${wt}(x[offset + i]), thread_max_vector);
    }
    thread_max[local_idx] = ${(()=>{switch(st){case 1:return"thread_max_vector";case 2:return"max(thread_max_vector.x, thread_max_vector.y)";case 4:return"max(max(thread_max_vector.x, thread_max_vector.y), max(thread_max_vector.z, thread_max_vector.w))";default:throw new Error(`Unsupported components: ${st}`)}})()};
    workgroupBarrier();

    var max_value =  f32(-3.402823e+38f);
    for (var i = 0u; i < ${at}; i++) {
      max_value = max(thread_max[i], max_value);
    }

    var sum_vector = ${wt}(0);
    for (var i: u32 = 0; i < uniforms.elements_per_thread && i + local_offset < uniforms.d_comp; i++) {
      sum_vector += exp(${wt}(x[offset + i]) - max_value);
    }
    thread_sum[local_idx] = ${(()=>{switch(st){case 1:return"sum_vector";case 2:return"sum_vector.x + sum_vector.y";case 4:return"sum_vector.x + sum_vector.y + sum_vector.z + sum_vector.w";default:throw new Error(`Unsupported components: ${st}`)}})()};
    workgroupBarrier();

    var sum: f32 = 0;
    for (var i = 0u; i < ${at}; i++) {
      sum += thread_sum[i];
    }

    if (sum == 0) {
      for (var i: u32 = 0; i < uniforms.elements_per_thread && i + local_offset < uniforms.d_comp; i++) {
        x[offset + i] = ${jt.type.value}(uniforms.d_inv);
      }
    } else {
      for (var i: u32 = 0; i < uniforms.elements_per_thread && i + local_offset < uniforms.d_comp; i++) {
        var f32input = ${wt}(x[offset + i]);
        x[offset + i] = ${jt.type.value}(exp(f32input - max_value) / sum);
      }
    }
  }`};return{name:"AttentionProbsSoftmax",shaderCache:{hint:`${at};${pt};${st}`},getShaderSource:$t,getRunData:()=>({outputs:[],dispatchGroup:{x:b},programUniforms:Ct})}},ip=(d,g,b,et,st,at,vt)=>{let Tt=vt+st.kvSequenceLength,Ct=[st.batchSize,st.numHeads,st.sequenceLength,Tt],pt=at.scale===0?1/Math.sqrt(st.headSize):at.scale,wt=Ue(st.headSize),$t=st.headSize/wt,Lt=12,jt={x:Math.ceil(Tt/Lt),y:Math.ceil(st.sequenceLength/Lt),z:st.batchSize*st.numHeads},Ft=[{type:12,data:st.sequenceLength},{type:12,data:$t},{type:12,data:Tt},{type:12,data:st.numHeads},{type:1,data:pt}],Gt=et?["type","type","type"]:["type","type"],Ht=qt=>{let Kt=U$1("q",g.dataType,g.dims,wt),rr=U$1("key",b.dataType,b.dims,wt),ir=[Kt,rr];et&&ir.push(U$1("relative_position_bias",et.dataType,et.dims));let or=K("output",g.dataType,Ct),jr=rt(1,wt),qr=[{name:"M",type:"u32"},{name:"K",type:"u32"},{name:"N",type:"u32"},{name:"num_heads",type:"u32"},{name:"alpha",type:"f32"}];return`
  const TILE_SIZE = ${Lt}u;

  var<workgroup> tileQ: array<${Kt.type.storage}, ${Lt*Lt}>;
  var<workgroup> tileK: array<${Kt.type.storage}, ${Lt*Lt}>;
  ${qt.registerUniforms(qr).declareVariables(...ir,or)}
  ${qt.mainStart([Lt,Lt,1])}
    // x holds the N and y holds the M
    let headIdx = workgroup_id.z;
    let m = workgroup_id.y * TILE_SIZE;
    let n = workgroup_id.x * TILE_SIZE;
    let qOffset = uniforms.M * uniforms.K * headIdx + m * uniforms.K;
    let kOffset = uniforms.N * uniforms.K * headIdx + n * uniforms.K;

    var value = ${jr}(0);
    for (var w: u32 = 0u; w < uniforms.K; w += TILE_SIZE) {
      if (global_id.y < uniforms.M && w + local_id.x < uniforms.K) {
        tileQ[TILE_SIZE * local_id.y + local_id.x] = q[qOffset + local_id.y * uniforms.K + w + local_id.x];
      }
      if (n + local_id.y < uniforms.N && w + local_id.x < uniforms.K) {
        tileK[TILE_SIZE * local_id.y + local_id.x] = key[kOffset + local_id.y * uniforms.K + w + local_id.x];
      }
      workgroupBarrier();

      for (var k: u32 = 0u; k < TILE_SIZE && w+k < uniforms.K; k++) {
        value += ${jr}(tileQ[TILE_SIZE * local_id.y + k] * tileK[TILE_SIZE * local_id.x + k]);
      }

      workgroupBarrier();
    }

    let headOffset = headIdx * uniforms.M * uniforms.N;
    if (global_id.y < uniforms.M && global_id.x < uniforms.N) {
      let outputIdx = headOffset + global_id.y * uniforms.N + global_id.x;
      var sum: f32 = ${(()=>{switch(wt){case 1:return"value";case 2:return"value.x + value.y";case 4:return"value.x + value.y + value.z + value.w";default:throw new Error(`Unsupported components: ${wt}`)}})()};
        output[outputIdx] = ${or.type.value} (sum * uniforms.alpha) + ${et?"relative_position_bias[outputIdx]":"0.0"};
    }
  }`};return{name:"AttentionProbs",shaderCache:{hint:`${wt}`,inputDependencies:Gt},getRunData:()=>({outputs:[{dims:Ct,dataType:g.dataType,gpuDataType:0}],dispatchGroup:jt,programUniforms:Ft}),getShaderSource:Ht}},op=(d,g,b,et,st)=>{let at=st+et.kvSequenceLength,vt=[et.batchSize,et.sequenceLength,et.vHiddenSize],Tt=12,Ct={x:Math.ceil(et.vHeadSize/Tt),y:Math.ceil(et.sequenceLength/Tt),z:et.batchSize*et.numHeads},pt=[{type:12,data:et.sequenceLength},{type:12,data:at},{type:12,data:et.vHeadSize},{type:12,data:et.numHeads},{type:12,data:et.vHiddenSize}];return{name:"AttentionScore",shaderCache:{inputDependencies:["type","type"]},getRunData:()=>({outputs:[{dims:vt,dataType:g.dataType,gpuDataType:0}],dispatchGroup:Ct,programUniforms:pt}),getShaderSource:wt=>{let $t=U$1("probs",g.dataType,g.dims),Lt=U$1("v",b.dataType,b.dims),jt=K("output",g.dataType,vt),Ft=[{name:"M",type:"u32"},{name:"K",type:"u32"},{name:"N",type:"u32"},{name:"num_heads",type:"u32"},{name:"v_hidden_size",type:"u32"}];return`
  const TILE_SIZE = ${Tt}u;
  var<workgroup> tileQ: array<${$t.type.value}, ${Tt*Tt}>;
  var<workgroup> tileK: array<${$t.type.value}, ${Tt*Tt}>;
  ${wt.registerUniforms(Ft).declareVariables($t,Lt,jt)}
  ${wt.mainStart([Tt,Tt,1])}
   let headIdx = workgroup_id.z;
   let m = global_id.y;
   let n = global_id.x;

   let offsetA = headIdx * (uniforms.M * uniforms.K) + m * uniforms.K;
   let offsetB = headIdx * (uniforms.N * uniforms.K) + n;

   var value = ${$t.type.storage}(0);
   for (var w: u32 = 0u; w < uniforms.K; w += TILE_SIZE) {
     if (m < uniforms.M && w + local_id.x < uniforms.K) {
       tileQ[TILE_SIZE * local_id.y + local_id.x] = probs[offsetA + w + local_id.x];
     }
     if (n < uniforms.N && w + local_id.y < uniforms.K) {
       tileK[TILE_SIZE * local_id.y + local_id.x] = v[offsetB + (w + local_id.y) * uniforms.N];
     }
     workgroupBarrier();
     for (var k: u32 = 0u; k < TILE_SIZE && w+k < uniforms.K; k++) {
       value += tileQ[TILE_SIZE * local_id.y + k] * tileK[TILE_SIZE * k + local_id.x];
     }
     workgroupBarrier();
   }

   // we need to transpose output from BNSH_v to BSND_v
   let batchIdx = workgroup_id.z / uniforms.num_heads;
   let currentBatchHeadNumber = workgroup_id.z % uniforms.num_heads;
   if (m < uniforms.M && n < uniforms.N) {
     let outputIdx = batchIdx * uniforms.M * uniforms.v_hidden_size + m * uniforms.v_hidden_size
       + currentBatchHeadNumber * uniforms.N + n;
     output[outputIdx] = value;
   }
  }`}}},Xn=(d,g,b,et,st,at,vt,Tt,Ct,pt,wt)=>{let $t=d.outputCount>1,Lt=d.outputCount>2,jt=$t&&Lt?pt.pastSequenceLength:0,Ft=jt+pt.kvSequenceLength,Gt=[pt.batchSize,pt.numHeads,Ft,pt.headSize],Ht=vt?[vt,b]:[b],qt=$t?d.compute(Yn(Ht,2,Gt,b.dataType),{inputs:Ht,outputs:[1]})[0]:b,Kt=[pt.batchSize,pt.numHeads,Ft,pt.headSize],rr=Tt?[Tt,et]:[et],ir=Lt?d.compute(Yn(rr,2,Kt,et.dataType),{inputs:rr,outputs:[2]})[0]:et,or=[g,qt];Ct&&or.push(Ct);let jr=d.compute(ip(d,g,qt,Ct,pt,wt,jt),{inputs:or,outputs:[-1]})[0];d.compute(np(d,jr,pt.batchSize*pt.numHeads*pt.sequenceLength,Ft),{inputs:[jr],outputs:[]});let qr=[jr,ir];d.compute(op(d,jr,ir,pt,jt),{inputs:qr,outputs:[0]})},ap=(d,g)=>{let b=[g.batchSize,g.numHeads,g.sequenceLength,g.headSize],et=g.sequenceLength,st=g.inputHiddenSize,at=g.headSize,vt=12,Tt={x:Math.ceil(g.headSize/vt),y:Math.ceil(g.sequenceLength/vt),z:g.batchSize*g.numHeads},Ct=[d.inputs[0],d.inputs[1],d.inputs[2]],pt=[{type:12,data:et},{type:12,data:st},{type:12,data:at},{type:12,data:g.numHeads},{type:12,data:g.headSize},{type:12,data:g.hiddenSize},{type:12,data:g.hiddenSize+g.hiddenSize+g.vHiddenSize}],wt=$t=>{let Lt=K("output_q",Ct[0].dataType,b),jt=K("output_k",Ct[0].dataType,b),Ft=K("output_v",Ct[0].dataType,b),Gt=U$1("input",Ct[0].dataType,Ct[0].dims),Ht=U$1("weight",Ct[1].dataType,Ct[1].dims),qt=U$1("bias",Ct[2].dataType,Ct[2].dims),Kt=Gt.type.storage,rr=[{name:"M",type:"u32"},{name:"K",type:"u32"},{name:"N",type:"u32"},{name:"num_heads",type:"u32"},{name:"head_size",type:"u32"},{name:"hidden_size",type:"u32"},{name:"ldb",type:"u32"}];return`
  const TILE_SIZE = ${vt}u;
  var<workgroup> tileInput: array<${Kt}, ${vt*vt}>;
  var<workgroup> tileWeightQ: array<${Kt}, ${vt*vt}>;
  var<workgroup> tileWeightK: array<${Kt}, ${vt*vt}>;
  var<workgroup> tileWeightV: array<${Kt}, ${vt*vt}>;
  ${$t.registerUniforms(rr).declareVariables(Gt,Ht,qt,Lt,jt,Ft)}
  ${$t.mainStart([vt,vt,1])}
    let batchIndex = workgroup_id.z / uniforms.num_heads;
    let headNumber = workgroup_id.z % uniforms.num_heads;
    let m = global_id.y;
    let n = global_id.x;

    let inputOffset = batchIndex * (uniforms.M * uniforms.K) + m * uniforms.K;
    let biasOffsetQ = headNumber * uniforms.head_size;
    let biasOffsetK = uniforms.hidden_size + biasOffsetQ;
    let biasOffsetV = uniforms.hidden_size + biasOffsetK;

    var valueQ = ${Kt}(0);
    var valueK = ${Kt}(0);
    var valueV = ${Kt}(0);
    for (var w: u32 = 0u; w < uniforms.K; w += TILE_SIZE) {
      if (m < uniforms.M && w + local_id.x < uniforms.K) {
        tileInput[TILE_SIZE * local_id.y + local_id.x] = input[inputOffset + w + local_id.x];
      }
      if (n < uniforms.N && w + local_id.y < uniforms.K) {
        let offset = n + (w + local_id.y) * uniforms.ldb;
        tileWeightQ[TILE_SIZE * local_id.y + local_id.x] = weight[biasOffsetQ + offset];
        tileWeightK[TILE_SIZE * local_id.y + local_id.x] = weight[biasOffsetK + offset];
        tileWeightV[TILE_SIZE * local_id.y + local_id.x] = weight[biasOffsetV + offset];
      }
      workgroupBarrier();
      for (var k: u32 = 0u; k<TILE_SIZE && w+k < uniforms.K; k++) {
        let inputTileOffset = TILE_SIZE * local_id.y + k;
        let weightTileOffset = TILE_SIZE * k + local_id.x;
        valueQ += tileInput[inputTileOffset] * tileWeightQ[weightTileOffset];
        valueK += tileInput[inputTileOffset] * tileWeightK[weightTileOffset];
        valueV += tileInput[inputTileOffset] * tileWeightV[weightTileOffset];
      }

      workgroupBarrier();
    }

    let headOffset = (m * uniforms.N + n) % uniforms.head_size;
    valueQ += bias[headOffset + biasOffsetQ];
    valueK += bias[headOffset + biasOffsetK];
    valueV += bias[headOffset + biasOffsetV];

    let offset = workgroup_id.z * uniforms.M * uniforms.N;
    if (m < uniforms.M && n < uniforms.N) {
      let outputIdx = offset + m * uniforms.N + n;
      output_q[outputIdx] = valueQ;
      output_k[outputIdx] = valueK;
      output_v[outputIdx] = valueV;
    }
  }`};return d.compute({name:"AttentionPrepare",shaderCache:{inputDependencies:["type","type","type"]},getRunData:()=>({outputs:[{dims:b,dataType:d.inputs[0].dataType,gpuDataType:0},{dims:b,dataType:d.inputs[0].dataType,gpuDataType:0},{dims:b,dataType:d.inputs[0].dataType,gpuDataType:0}],dispatchGroup:Tt,programUniforms:pt}),getShaderSource:wt},{inputs:Ct,outputs:[-1,-1,-1]})},Ms=(d,g)=>{let b=rp(d.inputs,g),[et,st,at]=ap(d,b);return Xn(d,et,st,at,d.inputs[4],void 0,void 0,void 0,d.inputs[5],b,g)}}),sp,up,lp,Us,Ws=j(()=>{_t(),ye(),xe(),Ze(),_e(),sp=(d,g)=>{if(!d||d.length!==5)throw new Error("BatchNormalization requires 5 inputs");let b=(et,st,at)=>{let vt=st.length;if(vt!==et.length)throw new Error(`${at}: num dimensions != ${vt}`);st.forEach((Tt,Ct)=>{if(Tt!==et[Ct])throw new Error(`${at}: dim[${Ct}] do not match`)})};if(d[0].dims.length>1){let et=g.format==="NHWC"?g.spatial?d[0].dims.slice(-1):d[0].dims.slice(-1).concat(d[0].dims.slice(1,d[0].dims.length-1)):d[0].dims.slice(1,g.spatial?2:void 0);b(d[1].dims,et,"Invalid input scale"),b(d[2].dims,et,"Invalid input B"),b(d[3].dims,et,"Invalid input mean"),b(d[4].dims,et,"Invalid input var")}else b(d[1].dims,[1],"Invalid input scale"),b(d[2].dims,[1],"Invalid input B"),b(d[3].dims,[1],"Invalid input mean"),b(d[4].dims,[1],"Invalid input var")},up=(d,g)=>{let{epsilon:b,spatial:et,format:st}=g,at=d[0].dims,vt=et?Ue(at[at.length-1]):1,Tt=st==="NHWC"&&at.length>1?vt:1,Ct=M$1.size(at)/vt,pt=et,wt=pt?at.length:at,$t=U$1("x",d[0].dataType,d[0].dims,vt),Lt=U$1("scale",d[1].dataType,d[1].dims,Tt),jt=U$1("bias",d[2].dataType,d[2].dims,Tt),Ft=U$1("inputMean",d[3].dataType,d[3].dims,Tt),Gt=U$1("inputVar",d[4].dataType,d[4].dims,Tt),Ht=K("y",d[0].dataType,wt,vt),qt=()=>{let rr="";if(et)rr=`let cOffset = ${at.length===1?"0u":st==="NHWC"?`outputIndices[${at.length-1}] / ${vt}`:"outputIndices[1]"};`;else if(st==="NCHW")rr=`
            ${Ht.indicesSet("outputIndices","0","0")}
            let cOffset = ${Ht.indicesToOffset("outputIndices")};`;else{rr=`var cIndices = ${Lt.type.indices}(0);
                       cIndices[0] = outputIndices[${at.length-1}];`;for(let ir=1;ir<Lt.rank;ir++)rr+=`cIndices[${ir}] = outputIndices[${ir}];`;rr+=`let cOffset = ${Lt.indicesToOffset("cIndices")};`}return rr},Kt=rr=>`
  const epsilon = ${b};
  ${rr.registerUniform("outputSize","u32").declareVariables($t,Lt,jt,Ft,Gt,Ht)}
  ${rr.mainStart()}
  ${rr.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.outputSize")}
    var outputIndices = ${Ht.offsetToIndices(`global_idx * ${vt}`)};
    ${qt()}
    let scale = ${Lt.getByOffset("cOffset")};
    let bias = ${jt.getByOffset("cOffset")};
    let inputMean = ${Ft.getByOffset("cOffset")};
    let inputVar = ${Gt.getByOffset("cOffset")};
    let x = ${$t.getByOffset("global_idx")};
    let value = (x - inputMean) * inverseSqrt(inputVar + epsilon) * scale + bias;
    ${Ht.setByOffset("global_idx","value")}
  }`;return{name:"BatchNormalization",shaderCache:{hint:`${g.epsilon}_${g.format}_${et}_${vt}`,inputDependencies:pt?["rank","type","type","type","type"]:void 0},getShaderSource:Kt,getRunData:()=>({outputs:[{dims:d[0].dims,dataType:d[0].dataType}],dispatchGroup:{x:Math.ceil(Ct/64)},programUniforms:pt?[{type:12,data:Ct},...X(at)]:[{type:12,data:Ct}]})}},lp=d=>we(d),Us=(d,g)=>{let{inputs:b,outputCount:et}=d,st=lp({...g,outputCount:et});if(ke.webgpu.validateInputContent&&sp(b,st),g.trainingMode)throw new Error("BatchNormalization trainingMode is not supported yet.");d.compute(up(b,st))}}),dp,cp,Ns,Vs=j(()=>{xe(),_e(),dp=d=>{if(d[0].dims.length!==3)throw new Error("input should have 3 dimensions");if(![320,640,1280].includes(d[0].dims[2]))throw new Error("number of channels should be 320, 640 or 1280");if(d[1].dims.length!==1)throw new Error("bias is expected to have 1 dimensions");if(d[0].dims[2]!==d[1].dims[0])throw new Error("last dimension of input and bias are not the same")},cp=d=>{let g=d[0].dims,b=d[0].dims[2],et=M$1.size(g)/4,st=d[0].dataType,at=U$1("input",st,g,4),vt=U$1("bias",st,[b],4),Tt=U$1("residual",st,g,4),Ct=K("output",st,g,4);return{name:"BiasAdd",getRunData:()=>({outputs:[{dims:g,dataType:d[0].dataType}],dispatchGroup:{x:Math.ceil(et/64)}}),getShaderSource:pt=>`
  const channels = ${b}u / 4;
  ${pt.declareVariables(at,vt,Tt,Ct)}

  ${pt.mainStart()}
    ${pt.guardAgainstOutOfBoundsWorkgroupSizes(et)}
    let value = ${at.getByOffset("global_idx")}
      + ${vt.getByOffset("global_idx % channels")} + ${Tt.getByOffset("global_idx")};
    ${Ct.setByOffset("global_idx","value")}
  }`}},Ns=d=>{dp(d.inputs),d.compute(cp(d.inputs))}}),pp,Pe,Hs,Gs,Ls,Fs,qs,js,Ks,Ys,Xs,mp,Zs,Qs,Js,eu,Zn,tu,Qn,ru,nu,iu,ou,au,su,uu,lu,du,cu,pu,mu,fu,hu,gu,yu,bu,vu,ao,so,wu,$u,_u,Jn=j(()=>{ye(),xe(),Ze(),_e(),pp=(d,g,b,et,st,at)=>{let vt=Math.ceil(g/4),Tt="";typeof st=="string"?Tt=`${st}(a)`:Tt=st("a");let Ct=U$1("inputData",b,[vt],4),pt=K("outputData",et,[vt],4);return`
      ${d.registerUniform("vec_size","u32").declareVariables(Ct,pt)}

  ${at??""}

  ${d.mainStart()}
    ${d.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.vec_size")}

    let a = ${Ct.getByOffset("global_idx")};
    ${pt.setByOffset("global_idx",Tt)}
  }`},Pe=(d,g,b,et,st,at=d.dataType)=>({name:g,shaderCache:{hint:st,inputDependencies:["type"]},getShaderSource:vt=>pp(vt,M$1.size(d.dims),d.dataType,at,b,et),getRunData:vt=>({outputs:[{dims:d.dims,dataType:at}],dispatchGroup:{x:Math.ceil(M$1.size(vt[0].dims)/64/4)},programUniforms:[{type:12,data:Math.ceil(M$1.size(d.dims)/4)}]})}),Hs=d=>{d.compute(Pe(d.inputs[0],"Abs","abs"))},Gs=d=>{d.compute(Pe(d.inputs[0],"Acos","acos"))},Ls=d=>{d.compute(Pe(d.inputs[0],"Acosh","acosh"))},Fs=d=>{d.compute(Pe(d.inputs[0],"Asin","asin"))},qs=d=>{d.compute(Pe(d.inputs[0],"Asinh","asinh"))},js=d=>{d.compute(Pe(d.inputs[0],"Atan","atan"))},Ks=d=>{d.compute(Pe(d.inputs[0],"Atanh","atanh"))},Ys=d=>we(d),Xs=(d,g)=>{let b;switch(g.to){case 10:b="vec4<f16>";break;case 1:b="vec4<f32>";break;case 12:b="vec4<u32>";break;case 6:b="vec4<i32>";break;case 9:b="vec4<bool>";break;default:throw new RangeError(`not supported type (specified in attribute 'to' from 'Cast' operator): ${g.to}`)}d.compute(Pe(d.inputs[0],"Cast",b,void 0,g.cacheKey,g.to))},mp=d=>{let g=d.length>=2&&d[1].data!==0?d[1].getFloat32Array()[0]:Ln,b=d.length>=3&&d[2].data!==0?d[2].getFloat32Array()[0]:Fn;return we({min:g,max:b})},Zs=(d,g)=>{let b=d.inputs.length===1?g:mp(d.inputs),et=rt(d.inputs[0].dataType);d.compute(Pe(d.inputs[0],"Clip",st=>`clamp(${st}, clip_min_, clip_max_)`,`
    const clip_min_: vec4<${et}> = vec4(${et}(${b.min}));
    const clip_max_: vec4<${et}> = vec4(${et}(${b.max}));
`,b.cacheKey),{inputs:[0]})},Qs=d=>{d.compute(Pe(d.inputs[0],"Ceil","ceil"))},Js=d=>{d.compute(Pe(d.inputs[0],"Cos","cos"))},eu=d=>{d.compute(Pe(d.inputs[0],"Cosh","cosh"))},Zn=d=>we(d),tu=(d,g)=>{let b=rt(d.inputs[0].dataType);d.compute(Pe(d.inputs[0],"Elu",et=>`elu_vf32(${et})`,`
  const elu_alpha_ = ${b}(${g.alpha});

  fn elu_f32(a: ${b}) -> ${b} {
  return select((exp(a) - 1.0) * elu_alpha_, a, a >= 0.0);
  }

  fn elu_vf32(v: vec4<${b}>) -> vec4<${b}> {
  return vec4(elu_f32(v.x), elu_f32(v.y), elu_f32(v.z), elu_f32(v.w));
  }`,g.cacheKey))},Qn=(d="f32")=>`
const r0: ${d} = 0.3275911;
const r1: ${d} = 0.254829592;
const r2: ${d} = -0.284496736;
const r3: ${d} = 1.421413741;
const r4: ${d} = -1.453152027;
const r5: ${d} = 1.061405429;

fn erf_vf32(v: vec4<${d}>) -> vec4<${d}> {
  let absv = abs(v);
  let x = 1.0 / (1.0 + r0 * absv);
  return sign(v) * (1.0 - ((((r5 * x + r4) * x + r3) * x + r2) * x + r1) * x * exp(-absv * absv));
}`,ru=d=>{let g=rt(d.inputs[0].dataType);d.compute(Pe(d.inputs[0],"Erf",b=>`erf_vf32(${b})`,Qn(g)))},nu=d=>{d.compute(Pe(d.inputs[0],"Exp","exp"))},iu=d=>{d.compute(Pe(d.inputs[0],"Floor","floor"))},ou=d=>{let g=rt(d.inputs[0].dataType);d.compute(Pe(d.inputs[0],"Gelu",b=>`0.5 * ${b} * (1.0 + erf_vf32(${b} * 0.7071067811865475))`,Qn(g)))},au=(d,g)=>{let b=rt(d.inputs[0].dataType);d.compute(Pe(d.inputs[0],"LeakyRelu",et=>`select(leaky_relu_alpha_ * ${et}, ${et}, ${et} >= vec4<${b}>(0.0))`,`const leaky_relu_alpha_ = ${b}(${g.alpha});`,g.cacheKey))},su=d=>{d.compute(Pe(d.inputs[0],"Not",g=>`!${g}`))},uu=d=>{d.compute(Pe(d.inputs[0],"Neg",g=>`-${g}`))},lu=d=>{d.compute(Pe(d.inputs[0],"Reciprocal",g=>`1.0/${g}`))},du=d=>{let g=rt(d.inputs[0].dataType);d.compute(Pe(d.inputs[0],"Relu",b=>`select(vec4<${g}>(0.0), ${b}, ${b} > vec4<${g}>(0.0))`))},cu=d=>{d.compute(Pe(d.inputs[0],"Sigmoid",g=>`(1.0 / (1.0 + exp(-${g})))`))},pu=d=>we(d),mu=(d,g)=>{let b=rt(d.inputs[0].dataType);d.compute(Pe(d.inputs[0],"HardSigmoid",et=>`max(vec4<${b}>(0.0), min(vec4<${b}>(1.0), ${g.alpha} * ${et} + vec4<${b}>(${g.beta})))`,void 0,g.cacheKey))},fu=d=>{d.compute(Pe(d.inputs[0],"Sin","sin"))},hu=d=>{d.compute(Pe(d.inputs[0],"Sinh","sinh"))},gu=d=>{d.compute(Pe(d.inputs[0],"Sqrt","sqrt"))},yu=d=>{d.compute(Pe(d.inputs[0],"Tan","tan"))},bu=d=>`sign(${d}) * (1 - exp(-2 * abs(${d}))) / (1 + exp(-2 * abs(${d})))`,vu=d=>{d.compute(Pe(d.inputs[0],"Tanh",bu))},ao=(d="f32")=>`
const fast_gelu_a: ${d} = 0.5;
const fast_gelu_b: ${d} = 0.7978845608028654;
const fast_gelu_c: ${d} = 0.035677408136300125;

fn tanh_v(v: vec4<${d}>) -> vec4<${d}> {
  return ${bu("v")};
}
`,so=d=>`(fast_gelu_a + fast_gelu_a * tanh_v(${d} * (fast_gelu_c * ${d} * ${d} + fast_gelu_b))) * ${d}`,wu=d=>{let g=rt(d.inputs[0].dataType);d.compute(Pe(d.inputs[0],"FastGelu",so,ao(g),void 0,d.inputs[0].dataType))},$u=(d,g)=>{let b=rt(d.inputs[0].dataType);return d.compute(Pe(d.inputs[0],"ThresholdedRelu",et=>`select(vec4<${b}>(0.0), ${et}, ${et} > thresholded_relu_alpha_)`,`const thresholded_relu_alpha_ = vec4<${b}>(${g.alpha});`,g.cacheKey)),0},_u=d=>{d.compute(Pe(d.inputs[0],"Log","log"))}}),fp,hp,Su,Cu=j(()=>{xe(),_e(),Jn(),fp=d=>{if(d[0].dims.length!==3)throw new Error("input should have 3 dimensions");if(![2560,5120,10240].includes(d[0].dims[2]))throw new Error("hidden state should be 2560, 5120 or 10240");if(d[1].dims.length!==1)throw new Error("bias is expected to have 1 dimensions");if(d[0].dims[2]!==d[1].dims[0])throw new Error("last dimension of input and bias are not the same")},hp=d=>{let g=d[0].dims.slice();g[2]=g[2]/2;let b=U$1("input",d[0].dataType,d[0].dims,4),et=U$1("bias",d[0].dataType,[d[0].dims[2]],4),st=K("output",d[0].dataType,g,4),at=M$1.size(g)/4,vt=De(d[0].dataType);return{name:"BiasSplitGelu",getRunData:()=>({outputs:[{dims:g,dataType:d[0].dataType}],dispatchGroup:{x:Math.ceil(at/64)}}),getShaderSource:Tt=>`
  const M_SQRT2 = sqrt(2.0);
  const halfChannels = ${d[0].dims[2]/4/2}u;

  ${Tt.declareVariables(b,et,st)}

  ${Qn(vt)}

  ${Tt.mainStart()}
    ${Tt.guardAgainstOutOfBoundsWorkgroupSizes(at)}
    let biasIdx = global_idx % halfChannels;
    let batchIndex = global_idx / halfChannels;
    let inputOffset = biasIdx + batchIndex * halfChannels * 2;
    let valueLeft = input[inputOffset] + bias[biasIdx];
    let valueRight = input[inputOffset + halfChannels] + bias[biasIdx + halfChannels];
    let geluRight = valueRight * 0.5 * (erf_vf32(valueRight / M_SQRT2) + 1);

    ${st.setByOffset("global_idx","valueLeft * geluRight")}
  }`}},Su=d=>{fp(d.inputs),d.compute(hp(d.inputs))}}),gp,yp,Wt,Iu,Tu,Au,Eu,ku,Ou,Pu,Ru,zu,Bu,Du=j(()=>{ye(),xe(),_e(),gp=(d,g,b,et,st,at,vt,Tt,Ct,pt,wt,$t)=>{let Lt,jt;typeof Tt=="string"?Lt=jt=(Kt,rr)=>`${Tt}((${Kt}),(${rr}))`:typeof Tt=="function"?Lt=jt=Tt:(Lt=Tt.scalar,jt=Tt.vector);let Ft=K("outputData",wt,et.length,4),Gt=U$1("aData",Ct,g.length,4),Ht=U$1("bData",pt,b.length,4),qt;if(st)if(at){let Kt=M$1.size(g)===1,rr=M$1.size(b)===1,ir=g.length>0&&g[g.length-1]%4===0,or=b.length>0&&b[b.length-1]%4===0;Kt||rr?qt=Ft.setByOffset("global_idx",jt(Kt?`${Gt.type.value}(${Gt.getByOffset("0")}.x)`:Gt.getByOffset("global_idx"),rr?`${Ht.type.value}(${Ht.getByOffset("0")}.x)`:Ht.getByOffset("global_idx"))):qt=`
            let outputIndices = ${Ft.offsetToIndices("global_idx * 4u")};
            let offsetA = ${Gt.broadcastedIndicesToOffset("outputIndices",Ft)};
            let offsetB = ${Ht.broadcastedIndicesToOffset("outputIndices",Ft)};
            ${Ft.setByOffset("global_idx",jt(vt||ir?Gt.getByOffset("offsetA / 4u"):`${Gt.type.value}(${Gt.getByOffset("offsetA / 4u")}[offsetA % 4u])`,vt||or?Ht.getByOffset("offsetB / 4u"):`${Ht.type.value}(${Ht.getByOffset("offsetB / 4u")}[offsetB % 4u])`))}
          `}else qt=Ft.setByOffset("global_idx",jt(Gt.getByOffset("global_idx"),Ht.getByOffset("global_idx")));else{if(!at)throw new Error("no necessary to use scalar implementation for element-wise binary op implementation.");let Kt=(rr,ir,or="")=>{let jr=`aData[indexA${ir}][componentA${ir}]`,qr=`bData[indexB${ir}][componentB${ir}]`;return`
            let outputIndices${ir} = ${Ft.offsetToIndices(`global_idx * 4u + ${ir}u`)};
            let offsetA${ir} = ${Gt.broadcastedIndicesToOffset(`outputIndices${ir}`,Ft)};
            let offsetB${ir} = ${Ht.broadcastedIndicesToOffset(`outputIndices${ir}`,Ft)};
            let indexA${ir} = offsetA${ir} / 4u;
            let indexB${ir} = offsetB${ir} / 4u;
            let componentA${ir} = offsetA${ir} % 4u;
            let componentB${ir} = offsetB${ir} % 4u;
            ${rr}[${ir}] = ${or}(${Lt(jr,qr)});
          `};wt===9?qt=`
            var data = vec4<u32>(0);
            ${Kt("data",0,"u32")}
            ${Kt("data",1,"u32")}
            ${Kt("data",2,"u32")}
            ${Kt("data",3,"u32")}
            outputData[global_idx] = dot(vec4<u32>(0x1, 0x100, 0x10000, 0x1000000), vec4<u32>(data));`:qt=`
            ${Kt("outputData[global_idx]",0)}
            ${Kt("outputData[global_idx]",1)}
            ${Kt("outputData[global_idx]",2)}
            ${Kt("outputData[global_idx]",3)}
          `}return`
        ${d.registerUniform("vec_size","u32").declareVariables(Gt,Ht,Ft)}

        ${$t??""}

        ${d.mainStart()}
        ${d.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.vec_size")}
        ${qt}
      }`},yp=(d,g,b,et,st,at,vt=b.dataType)=>{let Tt=!M$1.areEqual(b.dims,et.dims),Ct=b.dims,pt=M$1.size(b.dims),wt=!1,$t=!1,Lt=[Tt];if(Tt){let jt=zt.calcShape(b.dims,et.dims,!1);if(!jt)throw new Error("Can't perform binary op on the given tensors");Ct=jt,pt=M$1.size(Ct);let Ft=M$1.size(b.dims)===1,Gt=M$1.size(et.dims)===1,Ht=b.dims.length>0&&b.dims[b.dims.length-1]%4===0,qt=et.dims.length>0&&et.dims[et.dims.length-1]%4===0;Lt.push(Ft),Lt.push(Gt),Lt.push(Ht),Lt.push(qt);let Kt=1;for(let rr=1;rr<Ct.length;rr++){let ir=b.dims[b.dims.length-rr]??1,or=et.dims[et.dims.length-rr]??1;if(ir===or)Kt*=ir;else break}Kt%4===0?($t=!0,wt=!0):(Ft||Gt||Ht||qt)&&(wt=!0)}else wt=!0;return Lt.push(wt),{name:d,shaderCache:{hint:g+Lt.map(jt=>jt.toString()).join("_"),inputDependencies:["rank","rank"]},getShaderSource:jt=>gp(jt,b.dims,et.dims,Ct,wt,Tt,$t,st,b.dataType,et.dataType,vt,at),getRunData:()=>({outputs:[{dims:Ct,dataType:vt}],dispatchGroup:{x:Math.ceil(pt/64/4)},programUniforms:[{type:12,data:Math.ceil(M$1.size(Ct)/4)},...X(b.dims,et.dims,Ct)]})}},Wt=(d,g,b,et,st,at)=>{d.compute(yp(g,st??"",d.inputs[0],d.inputs[1],b,et,at))},Iu=d=>{Wt(d,"Add",(g,b)=>`${g}+${b}`)},Tu=d=>{Wt(d,"Div",(g,b)=>`${g}/${b}`)},Au=d=>{Wt(d,"Equal",{scalar:(g,b)=>`u32(${g}==${b})`,vector:(g,b)=>`vec4<u32>(${g}==${b})`},void 0,void 0,9)},Eu=d=>{Wt(d,"Mul",(g,b)=>`${g}*${b}`)},ku=d=>{let g=U$1("input",d.inputs[0].dataType,d.inputs[0].dims).type.value;Wt(d,"Pow",{scalar:(b,et)=>`pow_custom(${b},${et})`,vector:(b,et)=>`pow_vector_custom(${b},${et})`},`
    fn pow_custom(a : ${g}, b : ${g}) -> ${g} {
      if (b == ${g}(0.0)) {
        return ${g}(1.0);
      } else if (a < ${g}(0.0) && f32(b) != floor(f32(b))) {
        return ${g}(pow(f32(a), f32(b))); // NaN
      }
      return select(sign(a), ${g}(1.0), round(f32(abs(b) % ${g}(2.0))) != 1.0) * ${g}(${g==="i32"?"round":""}(pow(f32(abs(a)), f32(b))));
    }
    fn pow_vector_custom(a : vec4<${g}>, b : vec4<${g}>) -> vec4<${g}> {
      // TODO: implement vectorized pow
      return vec4<${g}>(pow_custom(a.x, b.x), pow_custom(a.y, b.y), pow_custom(a.z, b.z), pow_custom(a.w, b.w));
    }
      `)},Ou=d=>{Wt(d,"Sub",(g,b)=>`${g}-${b}`)},Pu=d=>{Wt(d,"Greater",{scalar:(g,b)=>`u32(${g}>${b})`,vector:(g,b)=>`vec4<u32>(${g}>${b})`},void 0,void 0,9)},Ru=d=>{Wt(d,"Less",{scalar:(g,b)=>`u32(${g}<${b})`,vector:(g,b)=>`vec4<u32>(${g}<${b})`},void 0,void 0,9)},zu=d=>{Wt(d,"GreaterOrEqual",{scalar:(g,b)=>`u32(${g}>=${b})`,vector:(g,b)=>`vec4<u32>(${g}>=${b})`},void 0,void 0,9)},Bu=d=>{Wt(d,"LessOrEqual",{scalar:(g,b)=>`u32(${g}<=${b})`,vector:(g,b)=>`vec4<u32>(${g}<=${b})`},void 0,void 0,9)}}),kt,Ot,Pt,ei,Zt=j(()=>{ye(),xe(),kt=(d,g,b="f32")=>{switch(d.activation){case"Relu":return`value = max(value, ${g}(0.0));`;case"Sigmoid":return`value = (${g}(1.0) / (${g}(1.0) + exp(-value)));`;case"Clip":return`value = clamp(value, ${g}(${b}(uniforms.clip_min)), ${g}(${b}(uniforms.clip_max)));`;case"HardSigmoid":return`value = max(${g}(0.0), min(${g}(1.0), ${b}(uniforms.alpha) * value + ${b}(uniforms.beta)));`;case"LeakyRelu":return`value = select(${b}(uniforms.alpha) * value, value, value >= ${g}(0.0));`;case"":return"";default:throw new Error(`Unsupported activation ${d.activation}`)}},Ot=(d,g)=>{d.activation==="Clip"?g.push({type:1,data:d.clipMax},{type:1,data:d.clipMin}):d.activation==="HardSigmoid"?g.push({type:1,data:d.alpha},{type:1,data:d.beta}):d.activation==="LeakyRelu"&&g.push({type:1,data:d.alpha})},Pt=(d,g)=>{d.activation==="Clip"?g.push({name:"clip_max",type:"f32"},{name:"clip_min",type:"f32"}):d.activation==="HardSigmoid"?g.push({name:"alpha",type:"f32"},{name:"beta",type:"f32"}):d.activation==="LeakyRelu"&&g.push({name:"alpha",type:"f32"})},ei=d=>{let g=(d==null?void 0:d.activation)||"";if(g==="HardSigmoid"){let[b,et]=(d==null?void 0:d.activation_params)||[.2,.5];return{activation:g,alpha:b,beta:et}}else if(g==="Clip"){let[b,et]=(d==null?void 0:d.activation_params)||[Ln,Fn];return{activation:g,clipMax:et,clipMin:b}}else if(g==="LeakyRelu"){let[b]=(d==null?void 0:d.activation_params)||[.01];return{activation:g,alpha:b}}return{activation:g}}}),nt,ti,ri=j(()=>{nt=(d,g)=>{switch(d){case 1:return g;case 2:return`vec2<${g}>`;case 3:return`vec3<${g}>`;case 4:return`vec4<${g}>`;default:throw new Error(`${d}-component is not supported.`)}},ti=d=>`
      ${d?"value = value + getBiasByOutputCoords(coords);":""}
      `}),ni,uo=j(()=>{ni=d=>`
fn getIndexFromCoords4D(coords : vec4<i32>, shape : vec4<i32>) -> i32 {
  return dot(coords, vec4<i32>(
      shape.y * shape.z * shape.w, shape.z * shape.w, shape.w, 1));
}
fn getOutputIndexFromCoords(coords : vec4<i32>) -> i32 {
  return dot(coords, vec4<i32>(
    i32(${d}.x), i32(${d}.y), i32(${d}.z), 1));
}
`}),vp,wp,rn,Mu,$p,nn,_p,ii,on=j(()=>{ye(),xe(),_e(),Zt(),ri(),vp=(d,g)=>d?`
        mm_Asub[inputRow][inputCol] = mm_readA(batch,
          kStart + inputRow,
          globalRowStart / innerElementSize + inputCol${g?", batchIndices":""});
        `:`
        mm_Asub[inputRow][inputCol] = mm_readA(batch,
          globalRow + innerRow,
          kStart / innerElementSize + inputCol${g?", batchIndices":""});
        `,wp=(d,g)=>d?`
        let ACached0 = mm_Asub[k * innerElementSize][localRow];
        let ACached1 = mm_Asub[k * innerElementSize + 1][localRow];
        let ACached2 = mm_Asub[k * innerElementSize + 2][localRow];
        ${g===3?"":"let ACached3 = mm_Asub[k * innerElementSize + 3][localRow];"}
        for (var i = 0; i < rowPerThread; i = i + 1) {
          acc[i] = BCached0 * ACached0[i] + acc[i];
          acc[i] = BCached1 * ACached1[i] + acc[i];
          acc[i] = BCached2 * ACached2[i] + acc[i];
          ${g===3?"":"acc[i] = BCached3 * ACached3[i] + acc[i];"}
        }`:`
        for (var i = 0; i < rowPerThread; i = i + 1) {
          let ACached = mm_Asub[tileRow + i][k];
          acc[i] = BCached0 * ACached.x + acc[i];
          acc[i] = BCached1 * ACached.y + acc[i];
          acc[i] = BCached2 * ACached.z + acc[i];
          ${g===3?"":"acc[i] = BCached3 * ACached.w + acc[i];"}
        }`,rn=(d,g,b="f32",et,st=!1,at=32,vt=!1,Tt=32)=>{let Ct=g[1]*d[1],pt=g[0]*d[0],wt=st?Ct:at,$t=st?at:Ct,Lt=wt/g[0],jt=at/g[1];if(!((st&&Lt===4&&d[1]===4||!st&&(Lt===3||Lt===4))&&wt%g[0]===0&&at%g[1]===0&&d[0]===4))throw new Error(`If transposeA ${st} is true, innerElementSize ${Lt} and workPerThread[1] ${d[1]} must be 4.
      Otherwise, innerElementSize ${Lt} must be 3 or 4.
  tileAWidth ${wt} must be divisible by workgroupSize[0]${g[0]}. tileInner ${at} must be divisible by workgroupSize[1] ${g[1]}. colPerThread ${d[0]} must be 4.`);return`
var<workgroup> mm_Asub: array<array<vec${Lt}<${b}>, ${wt/Lt}>, ${$t}>;
var<workgroup> mm_Bsub: array<array<vec4<${b}>, ${pt/d[0]}>, ${at}>;

const rowPerThread = ${d[1]};
const colPerThread = ${d[0]};
const innerElementSize = ${Lt};
const tileInner = ${at};

@compute @workgroup_size(${g[0]}, ${g[1]}, ${g[2]})
fn main(@builtin(local_invocation_id) localId : vec3<u32>,
        @builtin(global_invocation_id) globalId : vec3<u32>,
        @builtin(workgroup_id) workgroupId : vec3<u32>) {
  let localRow = i32(localId.y);
  let tileRow = localRow * rowPerThread;
  let tileCol = i32(localId.x);

  let globalRow =i32(globalId.y) * rowPerThread;
  let globalCol = i32(globalId.x);
  let batch = ${vt?"0":"i32(globalId.z)"};
  ${et?`let batchIndices = ${et.offsetToIndices("u32(batch)")};`:""}
  let globalRowStart = i32(workgroupId.y) * ${Ct};

  let num_tiles = ${vt?`${Math.ceil(Tt/at)}`:"(uniforms.dim_inner - 1) / tileInner + 1"};
  var kStart = ${vt?`i32(globalId.z) * ${Tt}`:"0"};

  var acc: array<vec4<${b}>, rowPerThread>;

  // Loop over shared dimension.
  let tileRowB = localRow * ${jt};
  for (var t = 0; t < num_tiles; t = t + 1) {
      // Load one tile of A into local memory.
      for (var innerRow = 0; innerRow < rowPerThread; innerRow = innerRow + 1) {
          let inputRow = tileRow + innerRow;
          let inputCol = tileCol;
          ${vp(st,et)}
      }

      // Load one tile of B into local memory.
      for (var innerRow = 0; innerRow < ${jt}; innerRow = innerRow + 1) {
          let inputRow = tileRowB + innerRow;
          let inputCol = tileCol;
          mm_Bsub[inputRow][inputCol] = mm_readB(batch, kStart + inputRow, globalCol${et?", batchIndices":""});
      }
      kStart = kStart + tileInner;
      workgroupBarrier();

      // Compute acc values for a single thread.
      for (var k = 0; k < tileInner / innerElementSize; k = k + 1) {
          let BCached0 = mm_Bsub[k * innerElementSize][tileCol];
          let BCached1 = mm_Bsub[k * innerElementSize + 1][tileCol];
          let BCached2 = mm_Bsub[k * innerElementSize + 2][tileCol];
          ${Lt===3?"":"let BCached3 = mm_Bsub[k * innerElementSize + 3][tileCol];"}

          ${wp(st,Lt)}
      }

      workgroupBarrier();
  }

  for (var innerRow = 0; innerRow < rowPerThread; innerRow = innerRow + 1) {
      mm_write(batch, globalRow + innerRow, globalCol, acc[innerRow]);
  }
}`},Mu=(d,g)=>d?`
            mm_Asub[inputRow][inputCol] = mm_readA(batch,
              kStart + inputRow,
              globalRowStart + inputCol${g?", batchIndices":""});
            `:`
            mm_Asub[inputRow][inputCol] = mm_readA(batch,
              globalRowStart + inputRow,
              kStart + inputCol${g?", batchIndices":""});
            `,$p=d=>d?"let ACached = mm_Asub[k][tileRow + innerRow];":"let ACached = mm_Asub[tileRow + innerRow][k];",nn=(d,g,b="f32",et,st=!1,at=32,vt=!1,Tt=32,Ct=!1)=>{let pt=d[1]*g[1],wt=d[0]*g[0],$t=st?pt:at,Lt=st?at:pt;if(!(Lt%g[1]===0&&$t%g[0]===0&&at%g[1]===0))throw new Error(`tileAHight ${Lt} must be divisible by workgroupSize[1]${g[1]}, tileAWidth ${$t} must be divisible by workgroupSize[0]${g[0]}, tileInner ${at} must be divisible by workgroupSize[1]${g[1]}`);let jt=Lt/g[1],Ft=$t/g[0],Gt=at/g[1],Ht=Ct?`
    let localRow = i32(localId.y);
    let localCol = i32(localId.x);
    let globalRowStart = i32(workgroupId.y) * ${pt};
    let globalColStart = i32(workgroupId.x) * ${wt};

    // Loop over shared dimension.
    for (var t = 0; t < num_tiles; t = t + 1) {
      // Load one tile of A into local memory.
      for (var inputRow = localRow; inputRow < ${Lt}; inputRow = inputRow + ${g[1]}) {
        for (var inputCol = localCol; inputCol < ${$t}; inputCol = inputCol + ${g[0]}) {
          ${Mu(st,et)}
        }
      }
      // Load one tile of B into local memory.
      for (var inputRow = localRow; inputRow < ${at}; inputRow = inputRow + ${g[1]}) {
            for (var inputCol = localCol; inputCol < ${wt}; inputCol = inputCol + ${g[0]}) {
          mm_Bsub[inputRow][inputCol] = mm_readB(batch,
            kStart + inputRow,
            globalColStart + inputCol${et?", batchIndices":""});
        }
      }
      kStart = kStart + tileInner;
      workgroupBarrier();

      // Compute acc values for a single thread.
      var BCached : array<${b}, colPerThread>;
      for (var k = 0; k < tileInner; k = k + 1) {
        for (var inner = 0; inner < colPerThread; inner = inner + 1) {
          BCached[inner] = mm_Bsub[k][localCol + inner * ${g[0]}];
        }
        for (var innerRow = 0; innerRow < rowPerThread; innerRow = innerRow + 1) {
          let ACached = ${st?`mm_Asub[k][localRow + innerRow * ${g[1]}];`:`mm_Asub[localRow + innerRow * ${g[1]}][k];`}
          for (var innerCol = 0; innerCol < colPerThread; innerCol = innerCol + 1) {
            acc[innerRow][innerCol] = acc[innerRow][innerCol] +
                ACached * BCached[innerCol];
          }
        }
      }
      workgroupBarrier();
    }
    for (var innerRow = 0; innerRow < rowPerThread; innerRow = innerRow + 1) {
      let gRow = globalRowStart + localRow + innerRow * ${g[1]};
      for (var innerCol = 0; innerCol < colPerThread; innerCol = innerCol + 1) {
        let gCol = globalColStart + localCol + innerCol * ${g[0]};
        mm_write(batch, gRow, gCol, acc[innerRow][innerCol]);
      }
    }
    `:`
let tileRow = i32(localId.y) * rowPerThread;
let tileCol = i32(localId.x) * colPerThread;

let globalRow = i32(globalId.y) * rowPerThread;
let globalCol = i32(globalId.x) * colPerThread;
let globalRowStart = i32(workgroupId.y) * ${pt};

let tileRowA = i32(localId.y) * ${jt};
let tileColA = i32(localId.x) * ${Ft};
let tileRowB = i32(localId.y) * ${Gt};
// Loop over shared dimension.
for (var t = 0; t < num_tiles; t = t + 1) {
  // Load one tile of A into local memory.
  for (var innerRow = 0; innerRow < ${jt}; innerRow = innerRow + 1) {
    for (var innerCol = 0; innerCol < ${Ft}; innerCol = innerCol + 1) {
      let inputRow = tileRowA + innerRow;
      let inputCol = tileColA + innerCol;
      ${Mu(st,et)}
    }
  }

  // Load one tile of B into local memory.
  for (var innerRow = 0; innerRow < ${Gt}; innerRow = innerRow + 1) {
    for (var innerCol = 0; innerCol < colPerThread; innerCol = innerCol + 1) {
      let inputRow = tileRowB + innerRow;
      let inputCol = tileCol + innerCol;
      mm_Bsub[inputRow][inputCol] = mm_readB(batch,
        kStart + inputRow,
        globalCol + innerCol${et?", batchIndices":""});
    }
  }
  kStart = kStart + tileInner;
  workgroupBarrier();

  // Compute acc values for a single thread.
  var BCached : array<${b}, colPerThread>;
  for (var k = 0; k < tileInner; k = k + 1) {
    for (var inner = 0; inner < colPerThread; inner = inner + 1) {
      BCached[inner] = mm_Bsub[k][tileCol + inner];
    }

    for (var innerRow = 0; innerRow < rowPerThread; innerRow = innerRow + 1) {
      ${$p(st)}
      for (var innerCol = 0; innerCol < colPerThread; innerCol = innerCol + 1) {
        acc[innerRow][innerCol] = acc[innerRow][innerCol] + ACached * BCached[innerCol];
      }
    }
  }

  workgroupBarrier();
}

for (var innerRow = 0; innerRow < rowPerThread; innerRow = innerRow + 1) {
  for (var innerCol = 0; innerCol < colPerThread; innerCol = innerCol + 1) {
    mm_write(batch, globalRow + innerRow, globalCol + innerCol,
        acc[innerRow][innerCol]);
  }
}
`;return`
  var<workgroup> mm_Asub : array<array<${b}, ${$t}>, ${Lt}>;
  var<workgroup> mm_Bsub : array<array<${b}, ${wt}>, ${at}>;
  const rowPerThread = ${d[1]};
  const colPerThread = ${d[0]};
  const tileInner = ${at};

@compute @workgroup_size(${g[0]}, ${g[1]}, ${g[2]})
fn main(@builtin(local_invocation_id) localId : vec3<u32>,
        @builtin(global_invocation_id) globalId : vec3<u32>,
        @builtin(workgroup_id) workgroupId : vec3<u32>) {
    let batch = ${vt?"0":"i32(globalId.z)"};
    ${et?`let batchIndices = ${et.offsetToIndices("u32(batch)")};`:""}
    let num_tiles = ${vt?`${Math.ceil(Tt/at)}`:"(uniforms.dim_inner - 1) / tileInner + 1"};
    var kStart = ${vt?`i32(globalId.z) * ${Tt}`:"0"};

    var acc : array<array<${b}, colPerThread>, rowPerThread>;

    // Without this initialization strange values show up in acc.
    for (var innerRow = 0; innerRow < rowPerThread; innerRow = innerRow + 1) {
      for (var innerCol = 0; innerCol < colPerThread; innerCol = innerCol + 1) {
        acc[innerRow][innerCol] = 0.0;
      }
    }
    ${Ht}
  }
`},_p=(d,g,b,et,st,at=!1)=>{let[vt,Tt,Ct]=st,[pt,wt,$t,Lt]=et,jt=Pr(vt,Ct),Ft=Pr(Tt,Ct),Gt=De(et[0].type.tensor),Ht=()=>{let Kt=wt.rank,rr=pt.rank,ir=`var aIndices: ${wt.type.indices};`;for(let or=Kt-2-1,jr=rr-1;or>=0;or--,jr--)ir+=`
aIndices[${or}] = ${rr>1?`batchIndices[${jr}]`:"batchIndices"};`;return jt.forEach(or=>{ir+=`
aIndices[${or}] = 0;`}),ir+=`
aIndices[${Kt-2}] = u32(row);
                   aIndices[${Kt-1}] = u32(colIn);`,ir},qt=()=>{let Kt=$t.rank,rr=pt.rank,ir=`var bIndices: ${$t.type.indices};`;for(let or=Kt-2-1,jr=rr-1;or>=0;or--,jr--)ir+=`
bIndices[${or}] = ${rr>1?`batchIndices[${jr}]`:"batchIndices"};`;return Ft.forEach(or=>{ir+=`
bIndices[${or}] = 0;`}),ir+=`
bIndices[${Kt-2}] = u32(row);
                   bIndices[${Kt-1}] = u32(colIn);`,ir};return`
    fn mm_readA(batch: i32, row: i32, colIn: i32, batchIndices: ${pt.type.indices}) -> ${nt(d,Gt)} {
      var value = ${nt(d,Gt)}(0.0);
      let col = colIn * ${d};
      if(row < uniforms.dim_a_outer && col < uniforms.dim_inner)
      {
        ${Ht()}
        value = ${wt.getByIndices("aIndices")};
      }
      return value;
    }

    fn mm_readB(batch: i32, row: i32, colIn: i32, batchIndices: ${pt.type.indices}) -> ${nt(d,Gt)} {
      var value = ${nt(d,Gt)}(0.0);
      let col = colIn * ${d};
      if(row < uniforms.dim_inner && col < uniforms.dim_b_outer)
      {
        ${qt()}
        value = ${$t.getByIndices("bIndices")};
      }
      return value;
    }

    fn mm_write(batch: i32, row: i32, colIn: i32, valueIn: ${nt(d,Gt)}) {
      let col = colIn * ${d};
      if (row < uniforms.dim_a_outer && col < uniforms.dim_b_outer) {
        var value = valueIn;
        let coords = vec3<i32>(batch, row, colIn);
        ${g?`value = value + ${at?"bias[colIn]":`${nt(d,Gt)}(bias[row])`};`:""}
        ${b}
        ${Lt.setByIndices("vec3<u32>(coords)","value")}
      }
    }
    `},ii=(d,g,b,et,st=!1)=>{let at=d[0].dims,vt=d[1].dims,Tt=at.slice(0,-2),Ct=vt.slice(0,-2),pt=et?et.slice(0,-2):b.slice(0,-2),wt=M$1.size(pt),$t=at[at.length-2],Lt=at[at.length-1],jt=vt[vt.length-1],Ft=Lt%4===0&&jt%4===0,Gt=$t<=8?[4,1,1]:[4,4,1],Ht=[8,8,1],qt=[Math.ceil(jt/Ht[0]/Gt[0]),Math.ceil($t/Ht[1]/Gt[1]),Math.ceil(wt/Ht[2]/Gt[2])],Kt=Ft?4:1,rr=[...Tt,$t,Lt/Kt],ir=rr.length,or=[...Ct,Lt,jt/Kt],jr=or.length,qr=[wt,$t,jt/Kt],Yr=[{type:6,data:$t},{type:6,data:jt},{type:6,data:Lt}];Ot(g,Yr),Yr.push(...X(pt,rr,or));let vn=["rank","rank"],ko=d.length>2;ko&&(Yr.push(...X(d[2].dims)),vn.push("rank")),Yr.push(...X(qr));let Xo=zo=>{let t0=pt.length,Uo=qn("batchDims",d[0].dataType,t0,1),No=De(d[0].dataType),_n=U$1("a",d[0].dataType,ir,Kt),Kr=U$1("b",d[1].dataType,jr,Kt),e0=K("result",d[0].dataType,qr.length,Kt),Zr=[_n,Kr];if(ko){let Go=st?Kt:1;Zr.push(U$1("bias",d[2].dataType,d[2].dims.length,Go))}let Ro=[{name:"dim_a_outer",type:"i32"},{name:"dim_b_outer",type:"i32"},{name:"dim_inner",type:"i32"}];Pt(g,Ro);let Sn=De(e0.type.tensor),Tn=kt(g,e0.type.value,Sn),n0=_p(Kt,ko,Tn,[Uo,_n,Kr,e0],[Tt,Ct,pt],st);return`
  ${zo.registerUniforms(Ro).registerInternalVariables(Uo).declareVariables(...Zr,e0)}
  ${n0}
  ${Ft?rn(Gt,Ht,No,Uo):nn(Gt,Ht,No,Uo)}
                   `};return{name:"MatMul",shaderCache:{hint:`${Gt};${g.activation};${Ft};${st}`,inputDependencies:vn},getRunData:()=>({outputs:[{dims:b,dataType:d[0].dataType}],dispatchGroup:{x:qt[0],y:qt[1],z:qt[2]},programUniforms:Yr}),getShaderSource:Xo}}}),xp,Uu,Wu=j(()=>{ye(),Xt(),_e(),Zt(),ri(),uo(),on(),xp=(d,g,b,et,st=!1,at,vt=4,Tt=4,Ct=4,pt="f32")=>{let wt=vn=>{switch(vn){case 1:return"resData = x[xIndex];";case 3:return`resData = vec3<${pt}>(x[xIndex], x[xIndex + 1], x[xIndex + 2]);`;case 4:return"resData = x[xIndex / 4];";default:throw new Error(`innerElementSize ${vn} is not supported.`)}},$t=vn=>{switch(vn){case 1:return"return w[row * i32(uniforms.w_shape[3]) + colIn];";case 4:return"return w[row * i32(uniforms.w_shape[3]) / 4 + colIn];";default:throw new Error(`innerElementSize ${vn} is not supported.`)}},Lt=d?`
    let coord = vec4<i32>(batch, xRow, xCol, xCh);
    `:`
    let coord = vec4<i32>(batch, xCh, xRow, xCol);
    `,jt=d?`
    let coords = vec4<i32>(
      batch,
      row / outWidth,
      row % outWidth,
      col);
    `:`
    let coords = vec4<i32>(
      batch,
      row,
      col / outWidth,
      col % outWidth);
    `,Ft=d?"i32(uniforms.x_shape[1])":"i32(uniforms.x_shape[2])",Gt=d?"i32(uniforms.x_shape[2])":"i32(uniforms.x_shape[3])",Ht=d?"row":"col",qt=d?"col":"row",Kt=`
    let inChannels = i32(uniforms.w_shape[2]);
    let outWidth = ${d?"i32(uniforms.result_shape[2])":"i32(uniforms.result_shape[3])"};
    let outRow = ${Ht} / outWidth;
    let outCol = ${Ht} % outWidth;

    let WRow = ${qt} / (i32(uniforms.w_shape[1]) * inChannels);
    let WCol = ${qt} / inChannels % i32(uniforms.w_shape[1]);
    let xRow = outRow * uniforms.stride[0] + uniforms.dilation[0] * WRow - uniforms.pad[0];
    let xCol = outCol * uniforms.stride[1] + uniforms.dilation[1] * WCol - uniforms.pad[1];
    let xCh = ${qt} % inChannels;
    var resData = ${nt(vt,pt)}(0.0);
    // The bounds checking is always needed since we use it to pad zero for
    // the 'same' padding type.
    if (xRow >= 0 && xRow < ${Ft} && xCol >= 0 && xCol < ${Gt}) {
      ${Lt}
      let xIndex = getIndexFromCoords4D(coord, vec4<i32>(uniforms.x_shape));
      ${wt(vt)}
    }
    return resData;`,rr=d?g&&et?`
    let col = colIn * ${vt};
    ${Kt}`:`
    let col = colIn * ${vt};
    if (row < uniforms.dim_a_outer && col < uniforms.dim_inner) {
      ${Kt}
    }
    return ${nt(vt,pt)}(0.0);`:et&&b?`
    let col = colIn * ${vt};
    ${Kt}`:`
    let col = colIn * ${vt};
    if (row < uniforms.dim_inner && col < uniforms.dim_b_outer) {
      ${Kt}
    }
    return ${nt(vt,pt)}(0.0);`,ir=`${$t(Tt)}`,or=nt(Ct,pt),jr=nt(d?vt:Tt,pt),qr=nt(d?Tt:vt,pt),Yr=kt(at,or,pt);return`
    fn mm_readA(batch: i32, row : i32, colIn : i32) -> ${jr} {
      ${d?rr:ir}
    }

    fn mm_readB(batch: i32, row : i32, colIn : i32) -> ${qr} {
      ${d?ir:rr}
    }

    fn mm_write(batch: i32, row : i32, colIn : i32, valueIn : ${or}) {
      let col = colIn * ${Ct};
      if (row < uniforms.dim_a_outer && col < uniforms.dim_b_outer)
      {
      var value = valueIn;
      let outWidth = ${d?"i32(uniforms.result_shape[2])":"i32(uniforms.result_shape[3])"};
      ${jt}
      ${ti(st)}
      ${Yr}
      setOutputAtCoords(coords[0], coords[1], coords[2], coords[3], value);
      }
    }`},Uu=(d,g,b,et,st,at,vt,Tt)=>{let Ct=g.format==="NHWC",pt=Ct?d[0].dims[3]:d[0].dims[1],wt=b[0],$t=Ct?b[2]:b[3],Lt=Ct?b[1]:b[2],jt=Ct?b[3]:b[1],Ft=Ct&&(pt%4===0||pt%3===0)&&jt%4===0,Gt=Ct?jt:$t*Lt,Ht=Ct?$t*Lt:jt,qt=[8,8,1],Kt=et<=8?[4,1,1]:[4,4,1],rr=[Math.ceil(Gt/qt[0]/Kt[0]),Math.ceil(Ht/qt[1]/Kt[1]),Math.ceil(wt/qt[2]/Kt[2])];Ne("verbose",()=>`[conv2d_mm_webgpu] dispatch = ${rr}`);let ir=Ft?Ct&&pt%4!==0?3:4:1,or=qt[1]*Kt[1],jr=qt[0]*Kt[0],qr=Math.max(qt[0]*ir,qt[1]),Yr=et%or===0,vn=st%jr===0,ko=at%qr===0,Xo=Ft?[ir,4,4]:[1,1,1],zo=[{type:6,data:et},{type:6,data:st},{type:6,data:at},{type:6,data:[g.pads[0],g.pads[1]]},{type:6,data:g.strides},{type:6,data:g.dilations}];Ot(g,zo),zo.push(...X(d[0].dims,d[1].dims));let t0=["rank","rank"];vt&&(zo.push(...X(d[2].dims)),t0.push("rank")),zo.push(...X(b));let Uo=No=>{let _n=[{name:"dim_a_outer",type:"i32"},{name:"dim_b_outer",type:"i32"},{name:"dim_inner",type:"i32"},{name:"pad",type:"i32",length:2},{name:"stride",type:"i32",length:2},{name:"dilation",type:"i32",length:2}];Pt(g,_n);let Kr=Ft?4:1,e0=De(d[0].dataType),Zr=`
      fn setOutputAtIndex(flatIndex : i32, value : ${Ft?`vec4<${e0}>`:e0}) {
        result[flatIndex] = ${Ft?`vec4<${e0}>`:e0}(value);
      }
      fn setOutputAtCoords(d0 : i32, d1 : i32, d2 : i32, d3 : i32, value : ${Ft?`vec4<${e0}>`:e0}) {
        let flatIndex = getOutputIndexFromCoords(vec4<i32>(d0, d1, d2, d3));
        setOutputAtIndex(flatIndex ${Ft?"/ 4":""}, value);
      }`,Ro=U$1("x",d[0].dataType,d[0].dims.length,ir===3?1:ir),Sn=U$1("w",d[1].dataType,d[1].dims.length,Kr),Tn=[Ro,Sn],n0=K("result",d[0].dataType,b.length,Kr);if(vt){let Go=U$1("bias",d[2].dataType,d[2].dims.length,Kr);Tn.push(Go),Zr+=`
        fn getBiasByOutputCoords(coords : vec4<i32>) -> ${Ft?`vec4<${e0}>`:e0} {
          return bias[coords.${Ct?"w":"y"}${Ft?"/ 4":""}];
        }`}return`
        ${ni("uniforms.result_strides")}
        //struct Uniforms { xShape : vec4<i32>, wShape : vec4<i32>, outShape : vec4<i32>,
        //  outShapeStrides: vec3<i32>, filterDims : vec2<i32>, pad : vec2<i32>, stride : vec2<i32>,
        //  dilation : vec2<i32>, dimAOuter : i32, dimBOuter : i32, dimInner : i32 };
        ${No.registerUniforms(_n).declareVariables(...Tn,n0)}
        ${Zr}
        ${xp(Ct,Yr,vn,ko,vt,g,Xo[0],Xo[1],Xo[2],e0)}
        ${Ft?rn(Kt,qt,e0,void 0,!Ct,qr):nn(Kt,qt,e0,void 0,!Ct,qr,!1,void 0,Tt)}`};return{name:"Conv2DMatMul",shaderCache:{hint:`${g.cacheKey};${ir};${Ft};${Yr};${vn};${ko};${or};${jr};${qr}`,inputDependencies:t0},getRunData:()=>({outputs:[{dims:b,dataType:d[0].dataType}],dispatchGroup:{x:rr[0],y:rr[1],z:rr[2]},programUniforms:zo}),getShaderSource:Uo}}}),lo,Nu,Vu=j(()=>{ye(),xe(),_e(),co(),Zt(),lo=(d,g,b)=>{let et=d.length>2,st=et?"value += b[output_channel];":"",at=d[0].dims,vt=d[1].dims,Tt=vt[0]/g.group,Ct=g.format==="NHWC",pt=oi(at,vt,g.dilations,g.pads,g.strides,Ct),wt=M$1.size(pt),$t=[{type:12,data:wt},{type:12,data:g.dilations},{type:12,data:[g.strides[0],g.strides[1]]},{type:12,data:[g.pads[0],g.pads[1]]},{type:12,data:Tt}];Ot(g,$t),$t.push(...X(at,vt));let Lt=["rank","rank"];et&&($t.push(...X(d[2].dims)),Lt.push("rank")),$t.push(...X(pt));let jt=Ft=>{let Gt=K("output",d[0].dataType,pt.length),Ht=De(Gt.type.tensor),qt=kt(g,Gt.type.value,Ht),Kt=U$1("x",d[0].dataType,at.length),rr=U$1("w",d[1].dataType,vt.length),ir=[Kt,rr];et&&ir.push(U$1("b",d[2].dataType,d[2].dims.length));let or=[{name:"output_size",type:"u32"},{name:"dilations",type:"u32",length:g.dilations.length},{name:"strides",type:"u32",length:2},{name:"pads",type:"u32",length:2},{name:"output_channels_per_group",type:"u32"}];return Pt(g,or),`
  ${Ft.registerUniforms(or).declareVariables(...ir,Gt)}

  ${Ft.mainStart()}
    ${Ft.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.output_size")}

    let outputIndices = ${Gt.offsetToIndices("global_idx")};
    let batch: u32 = outputIndices[0];
    let output_channel: u32 = outputIndices[${Ct?3:1}];
    let xRCCorner: vec2<u32> = vec2<u32>(outputIndices[${Ct?1:2}], outputIndices[${Ct?2:3}]) * uniforms.strides - uniforms.pads;
    let group_id: u32 = output_channel / uniforms.output_channels_per_group;

    var value: ${Gt.type.value} = ${Gt.type.value}(0);
    for (var wInChannel: u32 = 0u; wInChannel < uniforms.w_shape[1]; wInChannel++) {
      let input_channel = group_id * uniforms.w_shape[1] + wInChannel;
      for (var wHeight: u32 = 0u; wHeight < uniforms.w_shape[2]; wHeight++) {
        let xHeight = xRCCorner.x + wHeight * uniforms.dilations[0];

        if (xHeight < 0u || xHeight >= uniforms.x_shape[${Ct?1:2}]) {
          continue;
        }

        for (var wWidth: u32 = 0u; wWidth < uniforms.w_shape[3]; wWidth++) {
          let xWidth = xRCCorner.y + wWidth * uniforms.dilations[1];
          if (xWidth < 0u || xWidth >= uniforms.x_shape[${Ct?2:3}]) {
            continue;
          }

          let xVal = ${Ct?Kt.get("batch","xHeight","xWidth","input_channel"):Kt.get("batch","input_channel","xHeight","xWidth")};
          let wVal = ${rr.get("output_channel","wInChannel","wHeight","wWidth")};
          value += xVal*wVal;
        }
      }
    }
    ${st}
    ${qt}
    ${Gt.setByOffset("global_idx","value")}
  }`};return{name:"GroupedConv",shaderCache:{hint:g.cacheKey,inputDependencies:Lt},getRunData:()=>({outputs:[{dims:b?b(pt):pt,dataType:d[0].dataType}],dispatchGroup:{x:Math.ceil(wt/64)},programUniforms:$t}),getShaderSource:jt}},Nu=(d,g,b)=>{let et=d.length>2,st=Ue(b[3]),at=Ue(b[2]),vt=M$1.size(b)/st/at,Tt=[d[0].dims[0],d[0].dims[1],d[0].dims[2],d[0].dims[3]/st],Ct=[d[1].dims[0],d[1].dims[1],d[1].dims[2],d[1].dims[3]/st],pt=[b[0],b[1],b[2],b[3]/st],wt=[{type:12,data:vt},{type:6,data:[g.strides[0],g.strides[1]]},{type:6,data:[g.pads[0],g.pads[1]]}];Ot(g,wt),wt.push(...X(Tt,Ct,pt));let $t=(at-1)*g.strides[1]+Ct[1],Lt=jt=>{let Ft=K("output",d[0].dataType,pt.length,st),Gt=De(Ft.type.tensor),Ht=kt(g,Ft.type.value,Gt),qt=U$1("x",d[0].dataType,Tt.length,st),Kt=U$1("w",d[1].dataType,Ct.length,st),rr=[qt,Kt];et&&rr.push(U$1("b",d[2].dataType,d[2].dims,st));let ir=et?"value += b[output_channel];":"",or=[{name:"output_size",type:"u32"},{name:"strides",type:"i32",length:2},{name:"pads",type:"i32",length:2}];return Pt(g,or),`
  ${jt.registerUniforms(or).declareVariables(...rr,Ft)}
  ${jt.mainStart()}
    ${jt.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.output_size")}
    let width0 = uniforms.output_shape[3];
    let output_channel = global_idx % width0;
    var index1 = global_idx / width0;
    let width1 = uniforms.output_shape[2] / ${at}u;
    let col = (index1 % width1) * ${at}u;
    index1 = index1 / width1;
    let row = index1 % uniforms.output_shape[1];
    let batch = index1 / uniforms.output_shape[1];

    let x_corner = vec2<i32>(i32(row), i32(col)) * uniforms.strides - uniforms.pads;

    var x_vals: array<${qt.type.value}, ${$t}>;
    var values: array<${Ft.type.value}, ${at}>;
    let input_channel = output_channel;
    // Use constant instead of uniform can give better performance for w's height/width.
    for (var w_height: u32 = 0u; w_height < ${Ct[0]}; w_height++) {
      let x_height = x_corner.x + i32(w_height);
      if (x_height >= 0 && u32(x_height) < uniforms.x_shape[1]) {
        for (var i = 0; i < ${$t}; i++) {
          let x_width = x_corner.y + i;
          if (x_width >= 0 && u32(x_width) < uniforms.x_shape[2]) {
            x_vals[i] = ${qt.get("batch","u32(x_height)","u32(x_width)","input_channel")};
          } else {
            x_vals[i] = ${qt.type.value}(0);
          }
        }
        for (var w_width: u32 = 0u; w_width < ${Ct[1]}; w_width++) {
          let w_val = ${Kt.get("w_height","w_width","0","output_channel")};
          for (var i = 0u; i < ${at}u; i++) {
            values[i] = fma(x_vals[i * u32(uniforms.strides[1]) + w_width], w_val, values[i]);
          }
        }
      }
    }

    for (var i = 0u; i < ${at}u; i++) {
      var value = values[i];
      ${ir}
      ${Ht}
      ${Ft.set("batch","row","col + i","output_channel","value")};
    }
  }`};return{name:"GroupedConv-Vectorize",shaderCache:{hint:`${g.cacheKey};${st};${at};${$t};${Ct[0]};${Ct[1]}`,inputDependencies:et?["rank","rank","type"]:["rank","rank"]},getRunData:()=>({outputs:[{dims:b,dataType:d[0].dataType}],dispatchGroup:{x:Math.ceil(vt/64)},programUniforms:wt}),getShaderSource:Lt}}}),po,Sp,Hu,mo=j(()=>{ye(),xe(),on(),_e(),Zt(),po=(d,g,b,et,st=!1)=>{let at=d[0].dims,vt=d[1].dims,Tt=at[at.length-2],Ct=vt[vt.length-1],pt=at[at.length-1],wt=Ue(Ct),$t=Ue(pt),Lt=Ue(Tt),jt=M$1.size(b)/wt/Lt,Ft=d.length>2,Gt=et?et.slice(0,-2):b.slice(0,-2),Ht=[M$1.size(Gt),Tt,Ct],qt=[{type:12,data:jt},{type:12,data:Tt},{type:12,data:Ct},{type:12,data:pt}];Ot(g,qt),qt.push(...X(Gt,at,vt)),Ft&&qt.push(...X(d[2].dims)),qt.push(...X(Ht));let Kt=rr=>{let ir=qn("batch_dims",d[0].dataType,Gt.length),or=U$1("a",d[0].dataType,at.length,$t),jr=U$1("b",d[1].dataType,vt.length,wt),qr=K("output",d[0].dataType,Ht.length,wt),Yr=De(qr.type.tensor),vn=kt(g,qr.type.value,Yr),ko=[or,jr],Xo="";if(Ft){let Zr=st?wt:1;ko.push(U$1("bias",d[2].dataType,d[2].dims.length,Zr)),Xo=`${st?`value += bias[col / ${Zr}];`:`value += ${qr.type.value}(bias[row + i]);`}`}let zo=at.slice(0,-2),t0=vt.slice(0,-2),Uo=Pr(zo,Gt),No=Pr(t0,Gt),_n=[{name:"output_size",type:"u32"},{name:"M",type:"u32"},{name:"N",type:"u32"},{name:"K",type:"u32"}];Pt(g,_n);let Kr=(Zr,Ro)=>{let Sn=Zr.rank,Tn=Zr.name;if(Sn===2)return`var ${Tn}_indices = ${Zr.type.indices}(0u, 0u);`;let n0=ir.rank,Go=`var ${Tn}_indices: ${Zr.type.indices};`;for(let An=Sn-2-1,a0=n0-1;An>=0;An--,a0--)Go+=`
${Tn}_indices[${An}] = ${n0>1?`batch_indices[${a0}]`:"batch_indices"};`;return Ro.forEach(An=>{Go+=`
${Tn}_indices[${An}] = 0;`}),Go+=`${Tn}_indices[${Sn-2}] = 0u;
                     ${Tn}_indices[${Sn-1}] = 0u;`,Go},e0=()=>{let Zr=`var a_data: ${or.type.value};`;for(let Ro=0;Ro<$t;Ro++)Zr+=`
              let b_data${Ro} = b[(b_offset + (k + ${Ro}) * uniforms.N + col) / ${wt}];`;for(let Ro=0;Ro<Lt;Ro++){Zr+=`a_data = a[(a_offset + (row + ${Ro}) * uniforms.K + k) / ${$t}];`;for(let Sn=0;Sn<$t;Sn++)Zr+=`
            values[${Ro}] = fma(${jr.type.value}(a_data${$t===1?"":`[${Sn}]`}), b_data${Sn}, values[${Ro}]);
`}return Zr};return`
  ${rr.registerUniforms(_n).registerInternalVariables(ir).declareVariables(...ko,qr)}
  ${rr.mainStart()}
    ${rr.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.output_size")}
    let col = (global_idx % (uniforms.N / ${wt})) * ${wt};
    var index1 = global_idx / (uniforms.N / ${wt});
    let stride1 = uniforms.M / ${Lt};
    let row = (index1 % stride1) * ${Lt};
    let batch = index1 / stride1;

    ${b.length===2?"":`let batch_indices = ${ir.offsetToIndices("batch")};`}
    ${Kr(or,Uo)}
    let a_offset = ${or.indicesToOffset("a_indices")};
    ${Kr(jr,No)}
    let b_offset = ${jr.indicesToOffset("b_indices")};
    var values: array<${qr.type.value}, ${Lt}>;
    for (var k: u32 = 0u; k < uniforms.K; k = k + ${$t}) {
      ${e0()}
    }
    for (var i = 0u; i < ${Lt}u; i++) {
      var value = values[i];
      ${Xo}
      ${vn}
      let cur_indices = ${qr.type.indices}(batch, row + i, col);
      let offset = ${qr.indicesToOffset("cur_indices")};
      ${qr.setByOffset(`offset / ${wt}`,"value")};
    }
  }
  `};return{name:"MatMulNaive",shaderCache:{hint:`${g.activation};${wt};${$t};${Lt};${st}`,inputDependencies:Ft?["rank","rank","rank"]:["rank","rank"]},getRunData:()=>({outputs:[{dims:b,dataType:d[0].dataType}],dispatchGroup:{x:Math.ceil(jt/64)},programUniforms:qt}),getShaderSource:Kt}},Sp=d=>{if(!d||d.length!==2)throw new Error("MatMul requires 2 inputs.");if(d[0].dims[d[0].dims.length-1]!==d[1].dims[d[1].dims.length-2])throw new Error("shared dimension does not match.")},Hu=d=>{Sp(d.inputs);let g=zt.calcShape(d.inputs[0].dims,d.inputs[1].dims,!0);if(!g)throw new Error("Can't use matmul on the given tensors");let b=g[g.length-1],et=d.inputs[0].dims[d.inputs[0].dims.length-1];b<8&&et<8?d.compute(po(d.inputs,{activation:""},g)):d.compute(ii(d.inputs,{activation:""},g))}}),oi,fo,Cp,Gu,ho,Ip,Tp,go,co=j(()=>{xe(),Wu(),on(),Vu(),Zt(),mo(),Rr(),oi=(d,g,b,et,st,at)=>{let vt=d[0],Tt=d.slice(at?1:2,at?3:4),Ct=Tt.length,pt=g[0],wt=g.slice(2).map((Lt,jt)=>Lt+(Lt-1)*(b[jt]-1)),$t=Tt.map((Lt,jt)=>Lt+et[jt]+et[jt+Ct]).map((Lt,jt)=>Math.floor((Lt-wt[jt]+st[jt])/st[jt]));return $t.splice(0,0,vt),$t.splice(at?3:1,0,pt),$t},fo=[2,3,1,0],Cp=(d,g)=>{if(!d||d.length!==2&&d.length!==3)throw new Error("Conv requires 2 or 3 inputs");if(d[0].dims.length!==4&&d[0].dims.length!==3)throw new Error("currently only support conv 1D and 2D");if(d[0].dims.length!==d[1].dims.length)throw new Error("filter does not have same dimension as input");let b=d[0].dims[g.format==="NHWC"?d[0].dims.length-1:1],et=d[1].dims[1]*g.group;if(b!==et)throw new Error("FILTER_IN_CHANNEL should be equal to DATA_CHANNEL");if(d.length===3&&(d[2].dims.length!==1||d[1].dims[0]!==d[2].dims[0]))throw new Error("invalid bias");let st=d[0].dims.length-2;if(g.dilations.length!==st)throw new Error(`dilations should be ${st}D`);if(g.strides.length!==st)throw new Error(`strides should be ${st}D`);if(g.pads.length!==st*2)throw new Error(`pads should be ${st*2}D`);if(g.kernelShape.length!==0&&g.kernelShape.length!==d[1].dims.length-2)throw new Error("invalid kernel shape")},Gu=(d,g)=>{let b=d.kernelShape.slice();for(let at=2;at<g[1].dims.length;++at)b[at-2]===0&&(b[at-2]=g[1].dims[at]);let et=d.pads.slice();pr.adjustPadsBasedOnAutoPad(g[0].dims,d.strides,d.dilations,b,et,d.format==="NHWC",d.autoPad);let st=Object.assign({},d);return Object.assign(st,{kernelShape:b,pads:et}),st},ho=d=>{let g=ei(d),b=d.format,et=["NOTSET","VALID","SAME_UPPER","SAME_LOWER"][d.auto_pad],st=d.dilations,at=d.group,vt=d.kernel_shape,Tt=d.pads,Ct=d.strides,pt=d.w_is_const();return{autoPad:et,format:b,dilations:st,group:at,kernelShape:vt,pads:Tt,strides:Ct,wIsConst:pt,...g,cacheKey:`${d.format};${g.activation};`}},Ip=(d,g,b)=>{let et=Gu(b,g),st=b.format==="NHWC";if(b.group!==1){if(!d.adapterInfo.isArchitecture("ampere")&&st&&g[1].dims[0]===b.group&&g[1].dims[1]===1&&b.dilations[0]===1&&b.dilations[1]===1){let jr=oi(g[0].dims,g[1].dims,b.dilations,et.pads,b.strides,st),qr=d.kernelCustomData.wT??d.compute(xt(g[1],fo),{inputs:[1],outputs:[b.wIsConst?-2:-1]})[0];b.wIsConst&&!d.kernelCustomData.wT&&(d.kernelCustomData.wT=qr);let Yr=[g[0],qr];g.length===3&&Yr.push(g[2]),d.compute(Nu(Yr,et,jr),{inputs:Yr})}else d.compute(lo(g,et));return}let at=g.length===3,vt=g[0].dims[st?1:2],Tt=g[0].dims[st?2:3],Ct=g[0].dims[st?3:1],pt=g[1].dims[2],wt=g[1].dims[3],$t=oi(g[0].dims,g[1].dims,b.dilations,et.pads,b.strides,st),Lt=$t[st?1:2],jt=$t[st?2:3],Ft=$t[st?3:1],Gt=st&&pt===vt&&wt===Tt&&b.pads[0]===0&&b.pads[1]===0;if(Gt||pt===1&&wt===1&&b.dilations[0]===1&&b.dilations[1]===1&&b.strides[0]===1&&b.strides[1]===1&&b.pads[0]===0&&b.pads[1]===0){let jr=$t[0],qr,Yr,vn,ko=[];if(st){let t0=d.kernelCustomData.wT??d.compute(xt(g[1],fo),{inputs:[1],outputs:[b.wIsConst?-2:-1]})[0];if(b.wIsConst&&!d.kernelCustomData.wT&&(d.kernelCustomData.wT=t0),Gt){let Uo=vt*Tt*Ct;qr=g[0].reshape([1,jr,Uo]),Yr=t0.reshape([1,Uo,Ft]),vn=[1,jr,Ft]}else qr=g[0].reshape([jr,vt*Tt,Ct]),Yr=t0.reshape([1,Ct,Ft]),vn=[jr,Lt*jt,Ft];ko.push(qr),ko.push(Yr)}else qr=g[0].reshape([jr,Ct,vt*Tt]),Yr=g[1].reshape([1,Ft,Ct]),vn=[jr,Ft,Lt*jt],ko.push(Yr),ko.push(qr);at&&ko.push(g[2]);let Xo=vn[2],zo=ko[0].dims[ko[0].dims.length-1];Xo<8&&zo<8?d.compute(po(ko,et,$t,vn,st),{inputs:ko}):d.compute(ii(ko,et,$t,vn,st),{inputs:ko});return}let Ht=!0,qt=d.kernelCustomData.wT??d.compute(xt(g[1],fo),{inputs:[1],outputs:[b.wIsConst?-2:-1]})[0];b.wIsConst&&!d.kernelCustomData.wT&&(d.kernelCustomData.wT=qt);let Kt=[g[0],qt];at&&Kt.push(g[2]);let rr=st?Lt*jt:Ft,ir=st?Ft:Lt*jt,or=pt*wt*Ct;d.compute(Uu(Kt,et,$t,rr,ir,or,at,Ht),{inputs:Kt})},Tp=(d,g)=>{let b=g.format==="NHWC",et=[d.inputs[0].reshape(b?[d.inputs[0].dims[0],1,d.inputs[0].dims[1],d.inputs[0].dims[2]]:[d.inputs[0].dims[0],d.inputs[0].dims[1],1,d.inputs[0].dims[2]]),d.inputs[1].reshape([d.inputs[1].dims[0],d.inputs[1].dims[1],1,d.inputs[1].dims[2]])];d.inputs.length===3&&et.push(d.inputs[2]);let st=[0,g.pads[0],0,g.pads[1]],at=[1].concat(g.strides),vt=[1].concat(g.dilations),Tt=[1].concat(g.kernelShape),Ct=Gu({...g,pads:st,strides:at,dilations:vt,kernelShape:Tt},et);d.compute(lo(et,Ct,pt=>b?[pt[0],pt[2],pt[3]]:[]))},go=(d,g)=>{Cp(d.inputs,g),d.inputs[0].dims.length===3?Tp(d,g):Ip(d,d.inputs,g)}}),Ap,Lu,Fu=j(()=>{ye(),Xt(),_e(),Zt(),ri(),uo(),on(),Ap=(d,g=!1,b,et,st=4)=>{let at=Ht=>{switch(Ht){case 1:return"return w[getIndexFromCoords4D(coord, vec4<i32>(uniforms.w_shape))];";case 4:return`
            let coord1 = vec4<i32>(coordX, coordY, col + 1, rowInner);
            let coord2 = vec4<i32>(coordX, coordY, col + 2, rowInner);
            let coord3 = vec4<i32>(coordX, coordY, col + 3, rowInner);
            let v0 = w[getIndexFromCoords4D(coord, vec4<i32>(uniforms.w_shape))];
            let v1 = w[getIndexFromCoords4D(coord1, vec4<i32>(uniforms.w_shape))];
            let v2 = w[getIndexFromCoords4D(coord2, vec4<i32>(uniforms.w_shape))];
            let v3 = w[getIndexFromCoords4D(coord3, vec4<i32>(uniforms.w_shape))];
            return ${et}(v0, v1, v2, v3);
            `;default:throw new Error(`innerElementSize ${Ht} is not supported.`)}},vt=d?`
      let coord = vec4<i32>(batch, iXR, iXC, xCh);
      `:`
      let coord = vec4<i32>(batch, xCh, iXR, iXC);
      `,Tt=d?`
    let coords = vec4<i32>(
      batch,
      row / outWidth,
      row % outWidth,
      col);
    `:`
    let coords = vec4<i32>(
      batch,
      row,
      col / outWidth,
      col % outWidth);
    `,Ct=d?"i32(uniforms.x_shape[1])":"i32(uniforms.x_shape[2])",pt=d?"i32(uniforms.x_shape[2])":"i32(uniforms.x_shape[3])",wt=d?"row":"col",$t=d?"col":"row",Lt=`
      let inChannels = ${d?"i32(uniforms.x_shape[3])":"i32(uniforms.x_shape[1])"};
      let outWidth = ${d?"i32(uniforms.result_shape[2])":"i32(uniforms.result_shape[3])"};
      let outRow = ${wt} / outWidth;
      let outCol = ${wt} % outWidth;

      let WRow = ${$t} / (uniforms.filter_dims[1] * inChannels);
      let WCol = ${$t} / inChannels % uniforms.filter_dims[1];
      let xR = f32(outRow - uniforms.pads[0] + uniforms.dilations[0] * WRow) / f32(uniforms.strides[0]);
      let xC = f32(outCol - uniforms.pads[1] + uniforms.dilations[1] * WCol) / f32(uniforms.strides[1]);
      if (xR < 0.0 || xR >= f32(${Ct}) || fract(xR) > 0.0) {
        return ${et}(0.0);
      }
      if (xC < 0.0 || xC >= f32(${pt}) || fract(xC) > 0.0) {
        return ${et}(0.0);
      }
      let iXR = i32(xR);
      let iXC = i32(xC);
      let xCh = ${$t} % inChannels;
      ${vt}
      return x[getIndexFromCoords4D(coord, vec4<i32>(uniforms.x_shape))/${st}];`,jt=d?`
      let col = colIn * ${st};
      if (row < uniforms.dim_a_outer && col < uniforms.dim_inner) {
        ${Lt}
      }
      return ${et}(0.0);`:`
      let col = colIn * ${st};
      if (row < uniforms.dim_inner && col < uniforms.dim_b_outer) {
        ${Lt}
      }
      return ${et}(0.0);`,Ft=`
      let col = colIn * ${st};
      let inChannels = ${d?"i32(uniforms.x_shape[3])":"i32(uniforms.x_shape[1])"};
      let coordX = uniforms.filter_dims[0] - 1 - row / (uniforms.filter_dims[1] * inChannels);
      let coordY = uniforms.filter_dims[1] - 1 - (row / inChannels) % uniforms.filter_dims[1];
      if (${d?"row < uniforms.dim_inner && col < uniforms.dim_b_outer":"row < uniforms.dim_inner && col < uniforms.dim_a_outer"}  && coordX >= 0 && coordY >= 0) {
        let rowInner = row % inChannels;
        let coord = vec4<i32>(coordX, coordY, col, rowInner);
        ${at(st)}
      }
      return ${et}(0.0);
      `,Gt=kt(b,et);return`
  fn mm_readA(batch: i32, row : i32, colIn : i32) -> ${et} {
    ${d?jt:Ft}
  }

  fn mm_readB(batch: i32, row : i32, colIn : i32) -> ${et} {
    ${d?Ft:jt}
  }

  fn mm_write(batch: i32, row : i32, colIn : i32, valueInput : ${et}) {
    let col = colIn * ${st};
    if (row < uniforms.dim_a_outer && col < uniforms.dim_b_outer) {
      var value = valueInput;
      let outWidth = ${d?"i32(uniforms.result_shape[2])":"i32(uniforms.result_shape[3])"};
      ${Tt}
      ${ti(g)}
      ${Gt}
      result[getIndexFromCoords4D(coords, vec4<i32>(uniforms.result_shape))/${st}] = value;
    }
  }`},Lu=(d,g,b,et,st,at,vt,Tt)=>{let Ct=g.format==="NHWC",pt=Ct?d[0].dims[3]:d[0].dims[1],wt=b[0],$t=Ct?b[2]:b[3],Lt=Ct?b[1]:b[2],jt=Ct?b[3]:b[1],Ft=Ct&&pt%4===0&&pt%3&&jt%4===0,Gt=Ct?jt:$t*Lt,Ht=Ct?$t*Lt:jt,qt=[8,8,1],Kt=et<=8?[4,1,1]:[4,4,1],rr=[Math.ceil(Gt/qt[0]/Kt[0]),Math.ceil(Ht/qt[1]/Kt[1]),Math.ceil(wt/qt[2]/Kt[2])];Ne("verbose",()=>`[conv_backprop_mm_webgpu] dispatch = ${rr}`);let ir=Ft?4:1,or=Math.max(qt[0]*ir,qt[1]),jr=Ft?4:1,qr=[g.kernelShape[Ct?1:2],g.kernelShape[Ct?2:3]],Yr=[qr[0]+(g.dilations[0]<=1?0:(qr[0]-1)*(g.dilations[0]-1)),qr[1]+(g.dilations[1]<=1?0:(qr[1]-1)*(g.dilations[1]-1))],vn=[Yr[0]-1-Math.floor((g.pads[0]+g.pads[2])/2),Yr[1]-1-Math.floor((g.pads[1]+g.pads[3])/2)],ko=[{type:6,data:et},{type:6,data:st},{type:6,data:at},{type:6,data:g.strides},{type:6,data:g.dilations},{type:6,data:qr},{type:6,data:vn}];Ot(g,ko),ko.push(...X(d[0].dims,d[1].dims));let Xo=["rank","rank"];vt&&(ko.push(...X(d[2].dims)),Xo.push("rank")),ko.push(...X(b));let zo=t0=>{let Uo=U$1("x",d[0].dataType,d[0].dims.length,jr),No=U$1("w",d[1].dataType,d[1].dims.length,1),_n=K("result",d[0].dataType,b.length,jr),Kr=[Uo,No],e0="";if(vt){let Sn=U$1("bias",d[2].dataType,d[2].dims.length,jr);Kr.push(Sn),e0+=`
          fn getBiasByOutputCoords(coords : vec4<i32>) -> ${Sn.type.value} {
            return bias[coords.${Ct?"w":"y"}${Ft?"/ 4":""}];
          }`}let Zr=[{name:"dim_a_outer",type:"i32"},{name:"dim_b_outer",type:"i32"},{name:"dim_inner",type:"i32"},{name:"strides",type:"i32",length:2},{name:"dilations",type:"i32",length:2},{name:"filter_dims",type:"i32",length:qr.length},{name:"pads",type:"i32",length:vn.length}];Pt(g,Zr);let Ro=De(d[0].dataType,1);if(Ro!=="f16"&&Ro!=="f32")throw new Error(`elemType ${Ro} is not supported.`);return`
        ${ni("uniforms.result_strides")}
        ${t0.registerUniforms(Zr).declareVariables(...Kr,_n)};
        ${e0}
        ${Ap(Ct,vt,g,Uo.type.value,ir)}
        ${Ft?rn(Kt,qt,Ro,void 0,!Ct,or):nn(Kt,qt,Ro,void 0,!Ct,or,!1,void 0,Tt)}`};return{name:"Conv2DTransposeMatMul",shaderCache:{hint:`${g.cacheKey};${Kt};${qt};${Ft}`,inputDependencies:Xo},getRunData:()=>({outputs:[{dims:b,dataType:d[0].dataType}],dispatchGroup:{x:rr[0],y:rr[1],z:rr[2]},programUniforms:ko}),getShaderSource:zo}}}),Ep,yo,qu=j(()=>{ye(),Xt(),xe(),_e(),Ep=(d,g,b,et,st,at=!1,vt,Tt,Ct=!1)=>{let pt=Ct?1:2,wt=Ct?2:3,$t=Ct?3:1,Lt=at?2:1,jt=`
  fn setOutputAtIndex(flatIndex : u32, value : ${at?`vec4<${vt}>`:vt}) {
    result[flatIndex] = ${at?`vec4<${vt}>`:vt}(value);
  }`;et&&(jt+=`
    fn getBiasByOutputCoords(coords : vec4<u32>) -> ${at?`vec4<${vt}>`:vt} {
      return bias[coords.${Ct?"w":"y"}${at?"/ 4":""}];
    }`);let Ft=at?4:1,Gt=U$1("W",g[1].dataType,g[1].dims.length,Ft),Ht=U$1("Dy",g[0].dataType,g[0].dims.length,Ft),qt=[Ht,Gt];et&&qt.push(U$1("bias",g[2].dataType,[b[$t]].length,Ft));let Kt=K("result",g[0].dataType,b.length,Ft),rr=`{
        let batch: u32 = ${st?"global_id.z":"workgroup_id.z"} / uniforms.result_shape[1];
        let r = ${st?"global_id.z":"workgroup_id.z"} % uniforms.result_shape[1];
        let c = ${st?"global_id.y":"workgroup_id.y"} * ${Lt};
        let d1: u32 = ${st?"global_id.x":"workgroup_id.x"} * 4;

        let dyCorner = vec2<i32>(i32(r), i32(c)) - vec2<i32>(uniforms.pads);

        // Convolve dy(?, ?, d2) with w(:, :, d1, d2) to compute dx(xR, xC, d1).
        // ? = to be determined. : = across all values in that axis.
        var dotProd: array<vec4<${vt}>, ${Lt}>;
        for (var i = 0; i < ${Lt}; i++) {
          dotProd[i] = vec4<${vt}>(0.0);
        }
        for (var wR: u32 = 0; wR < uniforms.filter_dims[0]; wR = wR + 1) {
          var dyR = (${vt}(dyCorner.x) + ${vt}(wR)) / ${vt}(uniforms.strides.x);
          let wRPerm = uniforms.filter_dims[0] - 1 - wR;
          if (dyR < 0.0 || dyR >= ${vt}(uniforms.Dy_shape[1]) ||
              fract(dyR) > 0.0 || wRPerm < 0) {
            continue;
          }
          let idyR: u32 = u32(dyR);

          for (var wC: u32 = 0; wC < uniforms.filter_dims[1]; wC = wC + 1) {
            let dyC = (${vt}(dyCorner.y) + ${vt}(wC)) / ${vt}(uniforms.strides.y);
            let dyC2 = (${vt}(dyCorner.y) + 1.0 + ${vt}(wC)) / ${vt}(uniforms.strides.y);
            let wCPerm = uniforms.filter_dims[1] - 1 - wC;
            if (wCPerm < 0) {
              continue;
            }
            var bDyCVal = true;
            var bDyCVal2 = true;
            if (dyC < 0.0 || dyC >= ${vt}(uniforms.Dy_shape[2]) ||
                fract(dyC) > 0.0) {
              bDyCVal = false;
            }
            if (dyC2 < 0.0 || dyC2 >= ${vt}(uniforms.Dy_shape[2]) ||
                fract(dyC2) > 0.0) {
              bDyCVal2 = false;
            }

            let idyC: u32 = u32(dyC);
            let idyC2: u32 = u32(dyC2);
            if (bDyCVal && bDyCVal2) {
              let d2Length = uniforms.Dy_shape[3];
              for (var d2 :u32 = 0; d2 < d2Length; d2 = d2 + 4) {
                let wValue0 = ${Gt.get("u32(wRPerm)","u32(wCPerm)","d1","d2")};
                let wValue1 = ${Gt.get("u32(wRPerm)","u32(wCPerm)","d1 + 1","d2")};
                let wValue2 = ${Gt.get("u32(wRPerm)","u32(wCPerm)","d1 + 2","d2")};
                let wValue3 = ${Gt.get("u32(wRPerm)","u32(wCPerm)","d1 + 3","d2")};

                var xValue = ${Ht.get("batch","idyR","idyC","d2")};
                let tmpval = vec4<${vt}>(dot(xValue, wValue0),
                                      dot(xValue, wValue1),
                                      dot(xValue, wValue2),
                                      dot(xValue, wValue3));
                dotProd[0] = dotProd[0] + tmpval;

                xValue =  ${Ht.get("batch","idyR","idyC2","d2")};

                dotProd[1] = dotProd[1] + vec4<${vt}>(dot(xValue, wValue0),
                                                    dot(xValue, wValue1),
                                                    dot(xValue, wValue2),
                                                    dot(xValue, wValue3));
              }
            } else if (bDyCVal) {
              let d2Length = uniforms.Dy_shape[${$t}];
              for (var d2: u32 = 0; d2 < d2Length; d2 = d2 + 4) {
                let wValue0 = ${Gt.get("u32(wRPerm)","u32(wCPerm)","d1","d2")};
                let wValue1 = ${Gt.get("u32(wRPerm)","u32(wCPerm)","d1 + 1","d2")};
                let wValue2 = ${Gt.get("u32(wRPerm)","u32(wCPerm)","d1 + 2","d2")};
                let wValue3 = ${Gt.get("u32(wRPerm)","u32(wCPerm)","d1 + 3","d2")};

                var xValue = ${Ht.get("batch","idyR","idyC","d2")};
                let tmpval = vec4<${vt}>(dot(xValue, wValue0),
                                      dot(xValue, wValue1),
                                      dot(xValue, wValue2),
                                      dot(xValue, wValue3));
                dotProd[0] = dotProd[0] + tmpval;
              }
            } else if (bDyCVal2) {
              let d2Length = uniforms.Dy_shape[3];
              for (var d2: u32 = 0; d2 < d2Length; d2 = d2 + 4) {
                let wValue0 = ${Gt.get("u32(wRPerm)","u32(wCPerm)","d1","d2")};
                let wValue1 = ${Gt.get("u32(wRPerm)","u32(wCPerm)","d1 + 1","d2")};
                let wValue2 = ${Gt.get("u32(wRPerm)","u32(wCPerm)","d1 + 2","d2")};
                let wValue3 = ${Gt.get("u32(wRPerm)","u32(wCPerm)","d1 + 3","d2")};

                var xValue = ${Ht.get("batch","idyR","idyC2","d2")};
                let tmpval = vec4<${vt}>(dot(xValue, wValue0),
                                      dot(xValue, wValue1),
                                      dot(xValue, wValue2),
                                      dot(xValue, wValue3));
                dotProd[1] = dotProd[1] + tmpval;
              }
            }
          }
        }

        for (var i: u32 = 0; i < ${Lt}; i = i + 1) {
          let value = dotProd[i] + ${et?"bias[c+i]":`vec4<${vt}>(0.0)`};
          ${Kt.set("batch","r","c + i","d1","value")};
        }
      }`,ir=`
          let outputIndices = ${Kt.offsetToIndices("global_idx")};
          let batch = ${Kt.indicesGet("outputIndices",0)};
          let d1 = ${Kt.indicesGet("outputIndices",$t)};
          let r = ${Kt.indicesGet("outputIndices",pt)};
          let c = ${Kt.indicesGet("outputIndices",wt)};
          let dyCorner = vec2<i32>(i32(r), i32(c)) - uniforms.pads;
          let dyRCorner = dyCorner.x;
          let dyCCorner = dyCorner.y;
          let groupId = d1 / uniforms.output_channels_per_group;
          let wOutChannel = d1 - groupId * uniforms.output_channels_per_group;
          // Convolve dy(?, ?, d2) with w(:, :, d1, d2) to compute dx(xR, xC, d1).
          // ? = to be determined. : = across all values in that axis.
          var dotProd = ${vt}(0.0);
          for (var wR: u32 = 0; wR < uniforms.effective_filter_dims.x; wR = wR + 1) {
            if (wR % uniforms.dilations.x != 0) {
              continue;
            }
            let dyR = (${vt}(dyRCorner) + ${vt}(wR)) / ${vt}(uniforms.strides[0]);
            let wRPerm = uniforms.filter_dims.x - 1 - wR / uniforms.dilations.x;
            if (dyR < 0.0 || dyR >= ${vt}(uniforms.Dy_shape[${pt}]) || fract(dyR) > 0.0 ||
                wRPerm < 0) {
              continue;
            }
            let idyR: u32 = u32(dyR);

            for (var wC: u32 = 0; wC < uniforms.effective_filter_dims.y; wC = wC + 1) {
              if (wC % uniforms.dilations.y != 0) {
                continue;
              }
              let dyC = (${vt}(dyCCorner) + ${vt}(wC)) / ${vt}(uniforms.strides.y);
              let wCPerm = uniforms.filter_dims.y - 1 - wC / uniforms.dilations.y;
              if (dyC < 0.0 || dyC >= ${vt}(uniforms.Dy_shape[${wt}]) ||
                  fract(dyC) > 0.0 || wCPerm < 0) {
                continue;
              }
              let idyC: u32 = u32(dyC);
              var inputChannel = groupId * uniforms.input_channels_per_group;
              for (var d2: u32 = 0; d2 < uniforms.input_channels_per_group; d2 = d2 + 1) {
                let xValue = ${Ct?Ht.get("batch","idyR","idyC","inputChannel"):Ht.get("batch","inputChannel","idyR","idyC")};
                let wValue = ${Gt.get("inputChannel","wOutChannel","u32(wRPerm)","u32(wCPerm)")};
                dotProd = dotProd + xValue * wValue;
                inputChannel = inputChannel + 1;
              }
            }
          }
          let value = dotProd + ${et?"bias[d1]":`${vt}(0.0)`};
          ${Kt.setByOffset("global_idx","value")};
        `;return`
  ${d.registerUniforms(Tt).declareVariables(...qt,Kt)}
  ${jt}

    ${d.mainStart()}
    ${d.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.output_size")};
  ${at?rr:ir}}`},yo=(d,g,b)=>{let et=d.length>2,st=g.outputShape,at=M$1.size(st),vt=[Math.ceil(at/64),1,1];Ne("verbose",()=>`[conv2d_backprop_webgpu] dispatch = ${vt}`);let Tt=g.format==="NHWC",Ct=["rank","rank"],pt=[g.strides[0],g.strides[1]],wt=[g.kernelShape[Tt?1:2],g.kernelShape[Tt?2:3]],$t=[g.dilations[0],g.dilations[1]],Lt=[wt[0]+(g.dilations[0]<=1?0:(g.kernelShape[Tt?1:2]-1)*(g.dilations[0]-1)),wt[1]+(g.dilations[1]<=1?0:(g.kernelShape[Tt?2:3]-1)*(g.dilations[1]-1))],jt=[Lt[0]-1-Math.floor((g.pads[0]+g.pads[2])/2),Lt[1]-1-Math.floor(g.pads[1]+g.pads[3])/2],Ft=!1,Gt=g.group,Ht=d[1].dims,qt=Ht[0]/Gt,Kt=Ht[1],rr=[{type:12,data:at},{type:12,data:pt},{type:12,data:wt},{type:12,data:$t},{type:12,data:Lt},{type:6,data:jt},{type:12,data:qt},{type:12,data:Kt},...X(d[0].dims,d[1].dims)];et&&(rr.push(...X(d[2].dims)),Ct.push("rank")),rr.push(...X(st));let ir=vt[1]===1&&vt[2]===1,or=jr=>{let qr=[{name:"output_size",type:"u32"},{name:"strides",type:"u32",length:pt.length},{name:"filter_dims",type:"u32",length:wt.length},{name:"dilations",type:"u32",length:wt.length},{name:"effective_filter_dims",type:"u32",length:Lt.length},{name:"pads",type:"i32",length:jt.length},{name:"input_channels_per_group",type:"u32"},{name:"output_channels_per_group",type:"u32"}],Yr=De(d[0].dataType);return`${Ep(jr,d,st,et,ir,Ft,Yr,qr,Tt)}`};return{name:"ConvTranspose2D",shaderCache:{hint:`${g.cacheKey};`,inputDependencies:Ct},getRunData:()=>({dispatchGroup:{x:vt[0],y:vt[1],z:vt[2]},outputs:[{dims:b?b(st):st,dataType:d[0].dataType}],programUniforms:rr}),getShaderSource:or}}}),kp,Op,Pp,ju,Ku,Rp,zp,Bp,Dp,Yu,Xu=j(()=>{Fu(),qu(),Zt(),Rr(),kp=(d,g,b,et,st,at)=>(d-1)*g+b+(et-1)*st+1-at,Op=(d,g,b,et,st)=>{let at=Math.floor(d/2);g==="SAME_UPPER"?(b[et]=at,b[st]=d-at):g==="SAME_LOWER"&&(b[et]=d-at,b[st]=at)},Pp=(d,g,b,et,st,at,vt,Tt,Ct,pt)=>{let wt=d.length-2,$t=pt.length===0;if(Ct.length===0)for(let Ft=0;Ft<wt;++Ft)Ct.push(0);let Lt=d[0],jt=g[Tt?3:1]*st;for(let Ft=0,Gt=d.length-wt-(Tt?1:0);Ft<wt;++Ft,++Gt){let Ht=d[Gt],qt=$t?Ht*vt[Ft]:pt[Ft],Kt=kp(Ht,vt[Ft],at[Ft],g[Gt],b[Ft],qt);Op(Kt,et,at,Ft,Ft+wt),$t&&pt.push(vt[Ft]*(Ht-1)+Ct[Ft]+(g[Gt]-1)*b[Ft]+1-at[Ft]-at[Ft+wt])}pt.splice(0,0,Lt),pt.splice(Tt?3:1,0,jt)},ju=(d,g)=>{let b=d.kernelShape.slice();if(d.kernelShape.length===0||d.kernelShape.reduce(($t,Lt)=>$t*Lt,1)===0){b.length=0;for(let $t=2;$t<g[1].dims.length;++$t)b.push(g[1].dims[$t])}let et=d.format==="NHWC";b.splice(0,0,g[1].dims[0]),b.splice(et?3:1,0,g[1].dims[1]);let st=d.pads.slice(),at=d.outputShape.slice(),vt=d.outputPadding.slice(),Tt=g[0].dims,Ct=d.dilations.slice();if(Ct.reduce(($t,Lt)=>$t+Lt,0)===0){let $t=g[0].dims.length-2;Ct=new Array($t).fill(1)}let pt=d.strides.slice();if(pt.reduce(($t,Lt)=>$t+Lt,0)===0){let $t=g[0].dims.length-2;pt=new Array($t).fill(1)}Pp(Tt,b,Ct,d.autoPad,d.group,st,pt,et,vt,at);let wt=Object.assign({},d);return Object.assign(wt,{kernelShape:b,pads:st,outputPadding:vt,outputShape:at,dilations:Ct,strides:pt}),wt},Ku=d=>{let g=ei(d),b=d.format,et=["NOTSET","VALID","SAME_UPPER","SAME_LOWER"][typeof d.autoPad>"u"?0:d.autoPad],st=d.dilations,at=d.group,vt=d.kernelShape,Tt=d.pads,Ct=d.strides,pt=d.wIsConst(),wt=d.outputPadding,$t=d.outputShape;return{autoPad:et,format:b,dilations:st,group:at,kernelShape:vt,outputPadding:wt,outputShape:$t,pads:Tt,strides:Ct,wIsConst:pt,...g,cacheKey:`${d.format};${g.activation};`}},Rp=(d,g)=>{if(!d||d.length!==2&&d.length!==3)throw new Error("Conv requires 2 or 3 inputs");if(d[0].dims.length!==4&&d[0].dims.length!==3)throw new Error("currently only support 2-dimensional conv");if(d[0].dims.length!==d[1].dims.length)throw new Error("filter does not have same dimension as input");let b=d[0].dims[g.format==="NHWC"?d[0].dims.length-1:1],et=d[1].dims[0];if(b!==et)throw new Error("FILTER_IN_CHANNEL should be equal to DATA_CHANNEL");let st=d[1].dims[1]*g.group;if(d.length===3&&(d[2].dims.length!==1||d[2].dims[0]!==st))throw new Error("invalid bias");let at=d[0].dims.length-2;if(g.dilations.reduce((vt,Tt)=>vt+Tt,0)>0&&g.dilations.length!==at)throw new Error(`dilations should be ${at}D`);if(g.strides.reduce((vt,Tt)=>vt+Tt,0)>0&&g.strides.length!==at)throw new Error(`strides should be ${at}D`);if(g.pads.reduce((vt,Tt)=>vt+Tt,0)>0&&g.pads.length!==at*2)throw new Error(`pads should be ${at*2}D`);if(g.outputPadding.length!==at&&g.outputPadding.length!==0)throw new Error(`output_padding should be ${at}D`);if(g.kernelShape.reduce((vt,Tt)=>vt+Tt,0)>0&&g.kernelShape.length!==0&&g.kernelShape.length!==d[1].dims.length-2)throw new Error("invalid kernel shape");if(g.outputShape.length!==0&&g.outputShape.length!==d[0].dims.length-2)throw new Error("invalid output shape")},zp=[2,3,1,0],Bp=(d,g,b)=>{let et=ju(b,g),st=b.format==="NHWC",at=et.outputShape,vt=at[st?3:1],Tt=g[0].dims[st?3:1];if(et.group!==1||vt===1&&Tt===1){d.compute(yo(g,et));return}let Ct=at[st?1:2],pt=at[st?2:3],wt=g[1].dims[2],$t=g[1].dims[3],Lt=st?Ct*pt:vt,jt=st?vt:Ct*pt,Ft=wt*$t*Tt,Gt=!0,Ht=d.kernelCustomData.wT??d.compute(xt(g[1],zp),{inputs:[1],outputs:[b.wIsConst?-2:-1]})[0];b.wIsConst&&!d.kernelCustomData.wT&&(d.kernelCustomData.wT=Ht);let qt=[g[0],Ht],Kt=g.length===3;Kt&&(!st&&g[2].dims.length===1?qt.push(g[2].reshape([g[2].dims[0],1,1])):qt.push(g[2])),d.compute(Lu(qt,et,at,Lt,jt,Ft,Kt,Gt),{inputs:qt})},Dp=(d,g)=>{let b=g.format==="NHWC",et=[d.inputs[0].reshape(b?[d.inputs[0].dims[0],1,d.inputs[0].dims[1],d.inputs[0].dims[2]]:[d.inputs[0].dims[0],d.inputs[0].dims[1],1,d.inputs[0].dims[2]]),d.inputs[1].reshape([d.inputs[1].dims[0],d.inputs[1].dims[1],1,d.inputs[1].dims[2]])];d.inputs.length===3&&et.push(d.inputs[2]);let st=g.kernelShape;(st.length===0||st[0]===0)&&(st=[d.inputs[1].dims[2]]);let at=g.dilations;(at.length===0||at[0]===0)&&(at=[1]);let vt=g.strides;(vt.length===0||vt[0]===0)&&(vt=[1]);let Tt=g.pads;Tt.length===0&&(Tt=[0,0]),Tt=[0,Tt[0],0,Tt[1]],vt=[1].concat(vt),at=[1].concat(at),st=[1].concat(st);let Ct=ju({...g,pads:Tt,strides:vt,dilations:at,kernelShape:st},et);d.compute(yo(et,Ct,pt=>b?[pt[0],pt[2],pt[3]]:[pt[0],pt[1],pt[3]]))},Yu=(d,g)=>{Rp(d.inputs,g),d.inputs[0].dims.length===3?Dp(d,g):Bp(d,d.inputs,g)}}),Mp,Zu,Qu,Ju=j(()=>{ye(),xe(),Ze(),_e(),Mp=(d,g,b,et)=>{let st=M$1.size(g),at=g.length,vt=U$1("input",d,at),Tt=K("output",d,at),Ct=b.dataType===6?b.getInt32Array()[0]:Number(b.getBigInt64Array()[0]),pt=M$1.normalizeAxis(Ct,at),wt=$t=>{let Lt=` i32(${vt.indicesGet("inputIndices","uniforms.axis")}) `,jt=fe("uniforms.input_shape","uniforms.axis",at),Ft=et.reverse?Lt+(et.exclusive?" + 1":""):"0",Gt=et.reverse?jt:Lt+(et.exclusive?"":" + 1");return`
                ${$t.registerUniform("outputSize","u32").registerUniform("axis","u32").declareVariables(vt,Tt)}
                ${$t.mainStart()}
                  ${$t.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.outputSize")}
                  var inputIndices = ${Tt.offsetToIndices("global_idx")};
                  var sum = ${Tt.type.value}(0);
                  let first : i32 = ${Ft};
                  let last : i32 = ${Gt};
                  for (var i : i32 = first; i < last; i++) {
                    ${vt.indicesSet("inputIndices","uniforms.axis","u32(i)")};
                    sum = sum + ${vt.getByIndices("inputIndices")};
                  }
                  ${Tt.setByOffset("global_idx","sum")};
                }`};return{name:"CumSum",shaderCache:{hint:et.cacheKey,inputDependencies:["rank"]},getRunData:()=>({outputs:[{dims:g,dataType:d}],dispatchGroup:{x:Math.ceil(st/64)},programUniforms:[{type:12,data:st},{type:12,data:pt},...X(g,g)]}),getShaderSource:wt}},Zu=(d,g)=>{let b=d.inputs[0].dims,et=d.inputs[0].dataType,st=d.inputs[1];d.compute(Mp(et,b,st,g),{inputs:[0]})},Qu=d=>{let g=d.exclusive===1,b=d.reverse===1;return we({exclusive:g,reverse:b})}}),Up,Wp,Np,el,tl,rl=j(()=>{ye(),xe(),Ze(),_e(),Up=d=>{if(!d||d.length!==1)throw new Error("DepthToSpace requires 1 input.");if(d[0].dims.length!==4)throw new Error("DepthToSpace requires 4D input.")},Wp=(d,g,b,et)=>{let st=[];st.push(`fn perm(i: ${et.type.indices}) -> ${b.type.indices} {
    var a: ${b.type.indices};`);for(let at=0;at<g;++at)st.push(b.indicesSet("a",d[at],`i[${at}]`));return st.push("return a;}"),st.join(`
`)},Np=(d,g)=>{let b,et,st,at,vt,Tt,Ct=g.format==="NHWC",pt=g.blocksize,wt=g.mode==="DCR";Ct?([b,et,st,at]=d.dims,vt=wt?[b,et,st,pt,pt,at/pt**2]:[b,et,st,at/pt**2,pt,pt],Tt=wt?[0,1,3,2,4,5]:[0,1,4,2,5,3]):([b,et,st,at]=[d.dims[0],d.dims[2],d.dims[3],d.dims[1]],vt=wt?[b,pt,pt,at/pt**2,et,st]:[b,at/pt**2,pt,pt,et,st],Tt=wt?[0,3,4,1,5,2]:[0,1,4,2,5,3]);let $t=d.reshape(vt),Lt=$t.dims.length,jt=d.dataType,Ft=U$1("a",jt,Lt),Gt=K("output",jt,Lt),Ht=qt=>`
  ${qt.registerUniform("output_size","u32").declareVariables(Ft,Gt)}

  ${Wp(Tt,Lt,Ft,Gt)}

  ${qt.mainStart()}
    ${qt.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.output_size")}

    let indices = ${Gt.offsetToIndices("global_idx")};
    let aIndices = perm(indices);

    ${Gt.setByOffset("global_idx",Ft.getByIndices("aIndices"))}
  }`;return{name:"DepthToSpace",shaderCache:{hint:`${d.dims};${g.blocksize};${g.mode}`,inputDependencies:["rank"]},getRunData:qt=>{let Kt=Ct?[b,et*pt,st*pt,at/pt**2]:[b,at/pt**2,et*pt,st*pt],rr=M$1.size(Kt),ir=$t.dims,or=M$1.sortBasedOnPerm(ir,Tt);return{outputs:[{dims:Kt,dataType:qt[0].dataType}],dispatchGroup:{x:Math.ceil(rr/64)},programUniforms:[{type:12,data:rr},...X(ir,or)]}},getShaderSource:Ht}},el=(d,g)=>{Up(d.inputs),d.compute(Np(d.inputs[0],g))},tl=d=>we({blocksize:d.blocksize,mode:d.mode,format:d.format})}),bo,ai,nl,Vp,Hp,vo,wo,il,Gp,ol,al,sl=j(()=>{ye(),xe(),Ze(),_e(),bo="[a-zA-Z]|\\.\\.\\.",ai="("+bo+")+",nl="^"+ai+"$",Vp="("+ai+",)*"+ai,Hp="^"+Vp+"$",vo=class{constructor(d=-1){this.symbolToIndices=new Map,this.inputIndex=d}addSymbol(d,g){let b=this.symbolToIndices.get(d);b===void 0?b=[g]:b.push(g),this.symbolToIndices.set(d,b)}},wo=class{constructor(d,g){var st;this.equation=g,this.hasEllipsis=!1,this.symbolToInfo=new Map,this.lhs=new Array,this.outputDims=[];let[b,et]=g.includes("->")?g.split("->",2):[g,""];if(!b.match(RegExp(Hp)))throw new Error("Invalid LHS term");if(b.split(",").forEach((at,vt)=>{let Tt=d[vt].dims.slice();if(!at.match(RegExp(nl)))throw new Error("Invalid LHS term");let Ct=this.processTerm(at,!0,Tt,vt);this.lhs.push(Ct)}),et==="")et+=[...this.symbolToInfo.entries()].filter(([at,vt])=>vt.count===1||at==="...").map(([at])=>at).join("");else if(!et.match(RegExp(ai)))throw new Error("Invalid RHS");(st=et.match(RegExp(bo,"g")))==null||st.forEach(at=>{if(at==="...")this.outputDims=this.outputDims.concat(this.ellipsisDims);else{let vt=this.symbolToInfo.get(at);if(vt===void 0)throw new Error("Invalid RHS symbol");this.outputDims.push(vt.dimValue)}}),this.rhs=this.processTerm(et,!1,this.outputDims)}addSymbol(d,g,b){let et=this.symbolToInfo.get(d);if(et!==void 0){if(et.dimValue!==g&&et.count!==1)throw new Error("Dimension mismatch");et.count++,et.inputIndices.push(b)}else et={count:1,dimValue:g,inputIndices:[b]};this.symbolToInfo.set(d,et)}processTerm(d,g,b,et=-1){let st=b.length,at=!1,vt=[],Tt=0;if(!d.match(RegExp(nl))&&!g&&d!=="")throw new Error("Invalid LHS term");let Ct=d.match(RegExp(bo,"g")),pt=new vo(et);return Ct==null||Ct.forEach((wt,$t)=>{if(wt==="..."){if(at)throw new Error("Only one ellipsis is allowed per input term");at=!0;let Lt=st-Ct.length+1;if(Lt<0)throw new Error("Ellipsis out of bounds");if(vt=b.slice(Tt,Tt+Lt),this.hasEllipsis){if(this.ellipsisDims.length!==vt.length||this.ellipsisDims.toString()!==vt.toString())throw new Error("Ellipsis dimensions mismatch")}else if(g)this.hasEllipsis=!0,this.ellipsisDims=vt;else throw new Error("Ellipsis must be specified in the LHS");for(let jt=0;jt<vt.length;jt++){let Ft=String.fromCharCode(48+jt);pt.addSymbol(Ft,$t+jt),this.addSymbol(Ft,b[Tt++],et)}}else pt.addSymbol(wt,$t+(this.hasEllipsis?this.ellipsisDims.length-1:0)),this.addSymbol(wt,b[Tt++],et)}),pt}},il=d=>d+"_max",Gp=(d,g,b,et)=>{let st=d.map(pt=>pt.length).map((pt,wt)=>U$1(`input${wt}`,g,pt)),at=M$1.size(et),vt=K("output",g,et.length),Tt=[...b.symbolToInfo.keys()].filter(pt=>!b.rhs.symbolToIndices.has(pt)),Ct=pt=>{let wt=[],$t="var prod = 1.0;",Lt="var sum = 0.0;",jt="sum += prod;",Ft=[],Gt=[],Ht=[],qt=[],Kt=b.symbolToInfo.size===b.rhs.symbolToIndices.size;b.symbolToInfo.forEach((ir,or)=>{var jr;if(b.rhs.symbolToIndices.has(or)){let qr=(jr=b.rhs.symbolToIndices.get(or))==null?void 0:jr[0];qr!==void 0&&b.lhs.forEach((Yr,vn)=>{if(ir.inputIndices.includes(vn)){let ko=Yr.symbolToIndices.get(or);if(ko===void 0)throw new Error("Invalid symbol error");ko.forEach(Xo=>{wt.push(`${st[vn].indicesSet(`input${vn}Indices`,Xo,vt.indicesGet("outputIndices",qr))}`)})}})}else b.lhs.forEach((qr,Yr)=>{if(ir.inputIndices.includes(Yr)){let vn=qr.symbolToIndices.get(or);if(vn===void 0)throw new Error("Invalid symbol error");vn.forEach(ko=>{Ft.push(`${st[Yr].indicesSet(`input${Yr}Indices`,ko,`${or}`)}`)}),qt.push(`prod *= ${st[Yr].getByIndices(`input${Yr}Indices`)};`)}}),Gt.push(`for(var ${or}: u32 = 0; ${or} < uniforms.${il(or)}; ${or}++) {`),Ht.push("}")});let rr=Kt?[...wt,`let sum = ${st.map((ir,or)=>ir.getByIndices(`input${or}Indices`)).join(" * ")};`]:[...wt,Lt,...Gt,...Ft,$t,...qt,jt,...Ht];return`
            ${pt.registerUniforms(Tt.map(ir=>({name:`${il(ir)}`,type:"u32"}))).registerUniform("outputSize","u32").declareVariables(...st,vt)}

            ${pt.mainStart()}
            ${pt.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.outputSize")}
            var outputIndices = ${vt.offsetToIndices("global_idx")};
            ${st.map((ir,or)=>`var input${or}Indices: ${st[or].type.indices};`).join(`
`)}
            ${rr.join(`
`)};
            ${vt.setByOffset("global_idx","sum")};
          }`};return{name:"Einsum",shaderCache:{hint:b.equation,inputDependencies:d.map(()=>"rank")},getRunData:()=>{let pt=Tt.filter($t=>b.symbolToInfo.has($t)).map($t=>{var Lt;return{type:12,data:((Lt=b.symbolToInfo.get($t))==null?void 0:Lt.dimValue)||0}});pt.push({type:12,data:at});let wt=d.map(($t,Lt)=>[...X($t)]).reduce(($t,Lt)=>$t.concat(Lt),pt);return wt.push(...X(et)),{outputs:[{dims:et,dataType:g}],dispatchGroup:{x:Math.ceil(at/64)},programUniforms:wt}},getShaderSource:Ct}},ol=(d,g)=>{let b=new wo(d.inputs,g.equation),et=b.outputDims,st=d.inputs.map((at,vt)=>at.dims);d.compute(Gp(st,d.inputs[0].dataType,b,et))},al=d=>{let g=d.equation.replace(/\s+/g,"");return we({equation:g})}}),Lp,ul,Fp,qp,ll,dl=j(()=>{ye(),xe(),_e(),Lp=d=>{if(!d||d.length!==2)throw new Error("Expand requires 2 input.");let g=d[0].dims,b=Array.from(d[1].getBigInt64Array(),Number),et=b.length<g.length?0:b.length-g.length,st=g.length<b.length?0:g.length-b.length;for(;et<b.length&&st<g.length;++et,++st)if(b[et]!==g[st]&&b[et]!==1&&g[st]!==1)throw new Error("Expand requires shape to be broadcastable to input")},ul=(d,g)=>{let b=d.length-g.length,et=[];for(let st=0;st<b;++st)et.push(d[st]);for(let st=0;st<g.length;++st)et.push(g[st]===1?d[st+b]:g[st]);return et},Fp=(d,g)=>d.length>g.length?ul(d,g):ul(g,d),qp=d=>{let g=d[0].dims,b=Array.from(d[1].getBigInt64Array(),Number),et=Fp(g,b),st=d[0].dataType,at=st===9?4:1,vt=Math.ceil(M$1.size(et)/at),Tt=pt=>{let wt=U$1("input",st,g.length,at),$t=K("output",st,et.length,at),Lt;if(st===9){let jt=(Ft,Gt,Ht="")=>`
          let outputIndices${Gt} = ${$t.offsetToIndices(`outputOffset + ${Gt}u`)};
          let offset${Gt} = ${wt.broadcastedIndicesToOffset(`outputIndices${Gt}`,$t)};
          let index${Gt} = offset${Gt} / 4u;
          let component${Gt} = offset${Gt} % 4u;
          ${Ft}[${Gt}] = ${Ht}(${wt.getByOffset(`index${Gt}`)}[component${Gt}]);
        `;Lt=`
        let outputOffset = global_idx * ${at};
        var data = vec4<u32>(0);
        ${jt("data",0,"u32")}
        ${jt("data",1,"u32")}
        ${jt("data",2,"u32")}
        ${jt("data",3,"u32")}
        ${$t.setByOffset("global_idx","data")}
      }`}else Lt=`
        let outputIndices = ${$t.offsetToIndices("global_idx")};
        let inputOffset = ${wt.broadcastedIndicesToOffset("outputIndices",$t)};
        ${$t.setByOffset("global_idx",wt.getByOffset("inputOffset"))}
      }`;return`
    ${pt.registerUniform("vec_size","u32").declareVariables(wt,$t)}
    ${pt.mainStart()}
    ${pt.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.vec_size")}
    ${Lt}`},Ct=[{type:12,data:vt},...X(g,et)];return{name:"Expand",shaderCache:{hint:`${et.length}`,inputDependencies:["rank"]},getShaderSource:Tt,getRunData:()=>({outputs:[{dims:et,dataType:d[0].dataType}],dispatchGroup:{x:Math.ceil(vt/64)},programUniforms:Ct})}},ll=d=>{Lp(d.inputs),d.compute(qp(d.inputs),{inputs:[0]})}}),jp,cl,pl=j(()=>{ye(),xe(),_e(),Jn(),jp=d=>{let g=d[0].dataType,b=M$1.size(d[0].dims),et=M$1.size(d[1].dims),st=et%4===0,at=vt=>{let Tt=U$1("x",g,[1],4),Ct=U$1("bias",g,[1],4),pt=K("y",g,[1],4),wt=[{name:"output_vec_size",type:"u32"},{name:"bias_size",type:"u32"}],$t=jt=>`
      let bias${jt}_offset: u32 = (global_idx * 4 + ${jt}) % uniforms.bias_size;
      let bias${jt} = ${Ct.getByOffset(`bias${jt}_offset / 4`)}[bias${jt}_offset % 4];`,Lt=st?`
      let bias = ${Ct.getByOffset("global_idx % (uniforms.bias_size / 4)")};`:`${$t(0)}${$t(1)}${$t(2)}${$t(3)}
      let bias = ${Tt.type.value}(bias0, bias1, bias2, bias3);`;return`${vt.registerUniforms(wt).declareVariables(Tt,Ct,pt)}

    ${ao(rt(g))}

    ${vt.mainStart(mr)}
      ${vt.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.output_vec_size")}

      let x = ${Tt.getByOffset("global_idx")};
      ${Lt}
      let x_in = x + bias;
      ${pt.setByOffset("global_idx",so("x_in"))}
    }`};return{name:"FastGeluWithBias",shaderCache:{hint:`${st}`,inputDependencies:["type","type"]},getShaderSource:at,getRunData:vt=>({outputs:[{dims:vt[0].dims,dataType:vt[0].dataType}],programUniforms:[{type:12,data:Math.ceil(b/4)},{type:12,data:et}],dispatchGroup:{x:Math.ceil(b/mr/4)}})}},cl=d=>{d.inputs.length<2||M$1.size(d.inputs[1].dims)===0?wu(d):d.compute(jp(d.inputs))}}),Kp,Yp,ml,fl,hl=j(()=>{ye(),xe(),Ze(),_e(),Kp=d=>{if(!d||d.length!==2)throw new Error("Gather requires 2 inputs.")},Yp=(d,g)=>{let b=d[0].dims,et=d[1].dims,st=b.length,at=M$1.normalizeAxis(g.axis,st),vt=b.slice(0);vt.splice(at,1,...et);let Tt=b[at],Ct=d[0].dataType===9?4:1,pt=Math.ceil(M$1.size(vt)/Ct),wt=[{type:12,data:pt},{type:6,data:Tt},{type:12,data:at},...X(d[0].dims,d[1].dims,vt)],$t=Lt=>{let jt=U$1("data",d[0].dataType,d[0].dims.length,Ct),Ft=U$1("inputIndices",d[1].dataType,d[1].dims.length),Gt=K("output",d[0].dataType,vt.length,Ct),Ht=Kt=>{let rr=et.length,ir=`var indicesIndices${Kt}  = ${Ft.type.indices}(0);`;for(let or=0;or<rr;or++)ir+=`${rr>1?`indicesIndices${Kt}[${or}]`:`indicesIndices${Kt}`} = ${vt.length>1?`outputIndices${Kt}[uniforms.axis + ${or}]`:`outputIndices${Kt}`};`;ir+=`
          var idx${Kt} = ${Ft.getByIndices(`indicesIndices${Kt}`)};
          if (idx${Kt} < 0) {
            idx${Kt} = idx${Kt} + uniforms.axisDimLimit;
          }
          var dataIndices${Kt} : ${jt.type.indices};
        `;for(let or=0,jr=0;or<st;or++)or===at?(ir+=`${st>1?`dataIndices${Kt}[${or}]`:`dataIndices${Kt}`} = u32(idx${Kt});`,jr+=rr):(ir+=`${st>1?`dataIndices${Kt}[${or}]`:`dataIndices${Kt}`} = ${vt.length>1?`outputIndices${Kt}[${jr}]`:`outputIndices${Kt}`};`,jr++);return ir},qt;if(d[0].dataType===9){let Kt=(rr,ir,or="")=>`
          let outputIndices${ir} = ${Gt.offsetToIndices(`outputOffset + ${ir}u`)};
          ${Ht(ir)};
          let offset${ir} = ${jt.indicesToOffset(`dataIndices${ir}`)};
          let index${ir} = offset${ir} / 4u;
          let component${ir} = offset${ir} % 4u;
          ${rr}[${ir}] = ${or}(${jt.getByOffset(`index${ir}`)}[component${ir}]);
        `;qt=`
        let outputOffset = global_idx * ${Ct};
        var value = vec4<u32>(0);
        ${Kt("value",0,"u32")}
        ${Kt("value",1,"u32")}
        ${Kt("value",2,"u32")}
        ${Kt("value",3,"u32")}
        ${Gt.setByOffset("global_idx","value")}
      `}else qt=`
      let outputIndices = ${Gt.offsetToIndices("global_idx")};
      ${Ht("")};
      let value = ${jt.getByIndices("dataIndices")};
      ${Gt.setByOffset("global_idx","value")};
      `;return`
      ${Lt.registerUniform("outputSize","u32").registerUniform("axisDimLimit","i32").registerUniform("axis","u32").declareVariables(jt,Ft,Gt)}
      ${Lt.mainStart()}
        ${Lt.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.outputSize")}
        ${qt}
      }`};return{name:"Gather",shaderCache:{hint:g.cacheKey,inputDependencies:["rank","rank"]},getRunData:()=>({outputs:[{dims:vt,dataType:d[0].dataType}],dispatchGroup:{x:Math.ceil(pt/64)},programUniforms:wt}),getShaderSource:$t}},ml=d=>we({axis:d.axis}),fl=(d,g)=>{let b=d.inputs;Kp(b),d.compute(Yp(d.inputs,g))}}),Xp,Zp,gl,yl,bl=j(()=>{ye(),xe(),Ze(),_e(),Xp=d=>{if(!d||d.length!==2)throw new Error("GatherElements requires 2 inputs.");if(d[0].dims.length<1)throw new Error("GatherElements requires that the data input be rank >= 1.");if(d[0].dims.length!==d[1].dims.length)throw new Error(`GatherElements requires that the data input and
                     indices input tensors be of same rank.`)},Zp=(d,g)=>{let b=d[0].dims,et=d[0].dataType,st=b.length,at=d[1].dims,vt=d[1].dataType,Tt=M$1.normalizeAxis(g.axis,st),Ct=b[Tt],pt=at.slice(0),wt=M$1.size(pt),$t=U$1("input",et,st),Lt=U$1("indicesInput",vt,at.length),jt=K("output",et,pt.length),Ft=[{type:12,data:wt},{type:6,data:Ct},{type:12,data:Tt}];return Ft.push(...X(b,at,pt)),{name:"GatherElements",shaderCache:{inputDependencies:["rank","rank"]},getRunData:()=>({outputs:[{dims:pt,dataType:d[0].dataType}],dispatchGroup:{x:Math.ceil(wt/64)},programUniforms:Ft}),getShaderSource:Gt=>`
      ${Gt.registerUniform("outputSize","u32").registerUniform("axisDimLimit","i32").registerUniform("axis","u32").declareVariables($t,Lt,jt)}
      ${Gt.mainStart()}
      ${Gt.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.outputSize")}

      let outputIndices = ${jt.offsetToIndices("global_idx")};

      var idx = ${Lt.getByOffset("global_idx")};
      if (idx < 0) {
        idx = idx + uniforms.axisDimLimit;
      }
      var inputIndices = ${$t.type.indices}(outputIndices);
      ${$t.indicesSet("inputIndices","uniforms.axis","u32(idx)")};
      let value = ${$t.getByIndices("inputIndices")};

      ${jt.setByOffset("global_idx","value")};
  }`}},gl=d=>we({axis:d.axis}),yl=(d,g)=>{let b=d.inputs;Xp(b),d.compute(Zp(d.inputs,g))}}),Qp,Jp,vl,wl,$l=j(()=>{ye(),xe(),_e(),Qp=d=>{if(!d)throw new Error("Input is missing");if(d.length<2||d.length>3)throw new Error("Invaid input number.");if(d.length===3&&d[2].dims.length>2)throw new Error("Invalid input shape of C");if(d[0].dataType!==d[1].dataType||d.length===3&&d[0].dataType!==d[2].dataType)throw new Error("Input types are mismatched")},Jp=(d,g)=>{let b=d[0].dims.slice(),et=d[1].dims.slice(),[st,at,vt]=Gn.getShapeOfGemmResult(b,g.transA,et,g.transB,d.length===3?d[2].dims:void 0),Tt=[st,at];if(!Tt)throw new Error("Can't use gemm on the given tensors");let Ct=M$1.size(Tt),pt=[{type:12,data:Ct},{type:12,data:st},{type:12,data:at},{type:12,data:vt},{type:1,data:g.alpha},{type:1,data:g.beta}],wt=["type","type"];d.length===3&&(pt.push(...X(d[2].dims)),wt.push("rank")),pt.push(...X(Tt));let $t=Lt=>{let jt="";g.transA&&g.transB?jt="value += a[k * uniforms.M + m] * b[n * uniforms.K + k];":g.transA&&!g.transB?jt="value += a[k * uniforms.M + m] * b[k * uniforms.N + n];":!g.transA&&g.transB?jt="value += a[m * uniforms.K + k] * b[n * uniforms.K + k];":!g.transA&&!g.transB&&(jt="value += a[m * uniforms.K + k] * b[k * uniforms.N + n];");let Ft=g.alpha===1?"":"value *= uniforms.alpha;",Gt=U$1("a",d[0].dataType,d[0].dims),Ht=U$1("b",d[1].dataType,d[1].dims),qt=Gt.type.value,Kt=null,rr=[Gt,Ht];d.length===3&&(Kt=U$1("c",d[2].dataType,d[2].dims.length),rr.push(Kt));let ir=K("output",d[0].dataType,Tt.length);rr.push(ir);let or=[{name:"output_size",type:"u32"},{name:"M",type:"u32"},{name:"N",type:"u32"},{name:"K",type:"u32"},{name:"alpha",type:"f32"},{name:"beta",type:"f32"}];return`
  ${Lt.registerUniforms(or).declareVariables(...rr)}

  ${Lt.mainStart()}
    ${Lt.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.output_size")}

    let m = global_idx / uniforms.N;
    let n = global_idx % uniforms.N;

    var value = ${qt}(0);
    for (var k: u32 = 0u; k < uniforms.K; k++) {
      ${jt}
    }

    ${Ft}
    ${Kt!=null?`let cOffset = ${Kt.broadcastedIndicesToOffset("vec2(m, n)",ir)}; value += ${qt}(uniforms.beta) * ${Kt.getByOffset("cOffset")};`:""}
    output[global_idx] = value;
  }`};return{name:"Gemm",shaderCache:{hint:`${g.cacheKey}`,inputDependencies:wt},getRunData:()=>({outputs:[{dims:Tt,dataType:d[0].dataType}],dispatchGroup:{x:Math.ceil(Ct/64)},programUniforms:pt}),getShaderSource:$t}},vl=d=>{let g=d.transA,b=d.transB,et=d.alpha,st=d.beta;return{transA:g,transB:b,alpha:et,beta:st,cacheKey:`${d.transA};${d.transB};${d.alpha===1}`}},wl=(d,g)=>{Qp(d.inputs),d.compute(Jp(d.inputs,g))}}),em,tm,rm,_l,xl=j(()=>{ye(),xe(),_e(),em=(d,g)=>{let b=d[0].dims,et=b,st=2,at=M$1.sizeToDimension(b,st),vt=M$1.sizeFromDimension(b,st),Tt=Ue(vt),Ct=vt/Tt,pt=[b[0],b[1],Ct],wt=["rank","type","type"],$t=[{type:12,data:vt},{type:12,data:Ct}];$t.push(...X(pt,pt));let Lt=jt=>{let Ft=U$1("x",d[0].dataType,pt.length,Tt),Gt=U$1("scale",d[1].dataType,d[1].dims),Ht=U$1("bias",d[2].dataType,d[2].dims),qt=K("output",d[0].dataType,pt.length,Tt),Kt=[Ft,Gt,Ht,qt],rr=Ft.type.value,ir=Tt===1?"f32":`vec${Tt}<f32>`,or=64,jr=[{name:"normSize",type:"u32"},{name:"normPackedSize",type:"u32"}];return`
  var<workgroup> meanShared : f32;
  var<workgroup> squaredNormShared : f32;
  var<workgroup> workgroupShared : array<${ir}, ${or}>;
  const workgroupSize = ${or}u;
  ${jt.registerUniforms(jr).declareVariables(...Kt)}
  ${jt.mainStart(or)}
    let norm = global_idx / workgroupSize;
    let batch = norm / uniforms.x_shape[1];
    let channel = norm % uniforms.x_shape[1];
    let localIndex = local_id.x;

    // initialize workgroup memory
    var initial = ${ir}(0);
    for (var h = localIndex; h < uniforms.normPackedSize; h += workgroupSize) {
      initial = initial + ${ir}(${Ft.get("batch","channel","h")});
    }
    workgroupShared[localIndex] = initial;
    workgroupBarrier();

    // Calculate the mean of current channel data.
    for (var currSize = workgroupSize >> 1;  currSize > 0; currSize = currSize >> 1) {
      if (localIndex < currSize) {
        workgroupShared[localIndex] = workgroupShared[localIndex] + workgroupShared[localIndex + currSize];
      }
      workgroupBarrier();
    }
    if (localIndex == 0) {
      meanShared = ${Et("workgroupShared[0]",Tt)} / f32(uniforms.normSize);
    }
    workgroupBarrier();

    // reinitialize workgroup memory.
    initial = ${ir}(0);
    for (var h = localIndex; h < uniforms.normPackedSize; h += workgroupSize) {
      let deviation =  ${ir}(${Ft.get("batch","channel","h")}) - ${ir}(meanShared);
      initial = initial + deviation * deviation;
    }
    workgroupShared[localIndex] = initial;
    workgroupBarrier();

    // Calculate the sum of square of deviation of current channel data.
    for (var currSize = workgroupSize >> 1;  currSize > 0; currSize = currSize >> 1) {
      if (localIndex < currSize) {
        workgroupShared[localIndex] = workgroupShared[localIndex] + workgroupShared[localIndex + currSize];
      }
      workgroupBarrier();
    }
    if (localIndex == 0) {
      squaredNormShared = ${Et("workgroupShared[0]",Tt)};
    }
    workgroupBarrier();

    let invStdDev = inverseSqrt(squaredNormShared / f32(uniforms.normSize) + f32(${g.epsilon}));
    let channelScale = invStdDev * f32(${Gt.getByOffset("channel")});
    let channelShift = f32(${Ht.getByOffset("channel")}) - meanShared * channelScale;
    for (var h = localIndex; h < uniforms.normPackedSize; h += workgroupSize) {
      let value = ${Ft.get("batch","channel","h")} * ${rr}(${ir}(channelScale)) + ${rr}(${ir}(channelShift));
      ${qt.set("batch","channel","h","value")};
    }
  }`};return{name:"InstanceNormalization",shaderCache:{hint:`${g.epsilon};${Tt}`,inputDependencies:wt},getRunData:()=>({outputs:[{dims:et,dataType:d[0].dataType}],dispatchGroup:{x:at},programUniforms:$t}),getShaderSource:Lt}},tm=(d,g,b,et,st,at,vt,Tt)=>{let Ct=Ue(vt),pt=64,wt=Ct===1?"vec2f":`mat2x${Ct}f`,$t=Ct===1?"f32":`vec${Ct}f`,Lt=(jr,qr)=>`${wt}(${jr}, ${qr})`,jt=st*vt/Ct,Ft=Math.ceil(at/pt),Gt=["type"],Ht=[{type:12,data:Ft},{type:12,data:at},{type:12,data:Math.floor(vt/Ct)},{type:12,data:Math.floor(at*vt/Ct)}],qt=jr=>{let qr=U$1("input",g.dataType,g.dims,Ct);return`
  ${jr.declareVariables(qr)}
  @group(0) @binding(1) var<storage, read_write> output : array<${wt}>;
  struct Uniforms {wg_size:u32, H:u32, C:u32, image_size:u32};
  @group(0) @binding(2) var<uniform> uniforms: Uniforms;

  ${jr.mainStart(pt)}
    let currentImageNumber = global_idx / ${pt} / uniforms.C;
    let currentChannelNumber = (global_idx / ${pt}) % uniforms.C;
    let wgOffset = local_id.x * uniforms.wg_size;
    if (wgOffset >= uniforms.H) {
        return;
    }
    let wgMax = min(wgOffset + uniforms.wg_size, uniforms.H);

    let offset = currentImageNumber * uniforms.image_size + currentChannelNumber;
    var sum = ${At("f32",Ct)};
    var squaredSum = ${At("f32",Ct)};
    for (var i: u32 = wgOffset; i < wgMax; i++) {
        let value = ${$t}(input[offset + i * uniforms.C]);
        sum += value;
        squaredSum += value * value;
    }
    output[global_idx] = ${Lt("sum","squaredSum")};
  }`},Kt=d.compute({name:"InstanceNormComputeMean",shaderCache:{hint:`${Ct}`,inputDependencies:Gt},getRunData:()=>({outputs:[{dims:[st,vt,pt,2],dataType:1}],dispatchGroup:{x:st*vt/Ct},programUniforms:Ht}),getShaderSource:qt},{inputs:[g],outputs:[-1]})[0],rr=[{type:12,data:jt},{type:12,data:at},{type:12,data:Math.floor(vt/Ct)},{type:12,data:Math.floor(pt*vt/Ct)}],ir=["type","type","type"],or=jr=>{let qr=U$1("scale",b.dataType,b.dims,Ct),Yr=U$1("bias",et.dataType,et.dims,Ct);return`
  @group(0) @binding(0) var<storage, read> input : array<${wt}>;
  @group(0) @binding(1) var<storage, read> scale : array<${qr.type.storage}>;
  @group(0) @binding(2) var<storage, read> bias : array<${Yr.type.storage}>;
  @group(0) @binding(3) var<storage, read_write> output : array<${wt}>;
  struct Uniforms {units_of_work : u32, H: u32, C : u32, image_size : u32};
  @group(0) @binding(4) var<uniform> uniforms: Uniforms;

  ${jr.mainStart()}
    ${jr.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.units_of_work")}
    let currentImageNumber = global_idx / uniforms.C;
    let currentChannelNumber = global_idx % uniforms.C;

    let offset = currentImageNumber * uniforms.image_size;
    var sum = ${At("f32",Ct)};
    var squaredSum = ${At("f32",Ct)};
    for (var i: u32 = 0; i < min(${pt}, uniforms.H); i++) {
        let value = input[offset + i + currentChannelNumber * ${pt}];
        sum += value[0];
        squaredSum += value[1];
    }
    sum = sum / f32(uniforms.H);
    squaredSum = squaredSum / f32(uniforms.H);
    let invStdDev = inverseSqrt(squaredSum - sum * sum + f32(${Tt}));
    let channelScale = invStdDev * ${$t}(scale[currentChannelNumber]);
    let channelShift = ${$t}(bias[currentChannelNumber]) - sum * channelScale;

    output[global_idx] = ${Lt("channelScale","channelShift")};
  }`};return d.compute({name:"InstanceNormComputeChannelScaleShift",shaderCache:{hint:`${Ct};${Tt}`,inputDependencies:ir},getRunData:()=>({outputs:[{dims:[st,vt,2],dataType:1}],dispatchGroup:{x:Math.ceil(jt/64)},programUniforms:rr}),getShaderSource:or},{inputs:[Kt,b,et],outputs:[-1]})[0]},rm=(d,g,b)=>{let et=g[0].dims,st=et,at=et[0],vt=et[et.length-1],Tt=M$1.sizeFromDimension(et,1)/vt,Ct=Ue(vt),pt=M$1.size(st)/Ct,wt=[{type:12,data:Tt},{type:12,data:Math.floor(vt/Ct)}],$t=["type","type"],Lt=tm(d,g[0],g[1],g[2],at,Tt,vt,b.epsilon),jt=Ft=>{let Gt=De(g[0].dataType),Ht=Ct===1?"vec2f":`mat2x${Ct}f`,qt=Ct===1?Gt:`vec${Ct}<${Gt}>`,Kt=U$1("input",g[0].dataType,g[0].dims,Ct),rr=K("output",g[0].dataType,st,Ct);return`
  @group(0) @binding(0) var<storage, read> input : array<${Kt.type.storage}>;
  @group(0) @binding(1) var<storage, read> scaleInput : array<${Ht}>;
  @group(0) @binding(2) var<storage, read_write> output : array<${rr.type.storage}>;
  struct Uniforms {H: u32, C : u32};
  @group(0) @binding(3) var<uniform> uniforms: Uniforms;

  ${Ft.mainStart()}
    let currentImageNumber = global_idx / (uniforms.C * uniforms.H);
    let currentChannelNumber = global_idx % uniforms.C;

    let scaleOffset = currentImageNumber * uniforms.C + currentChannelNumber;
    let scale = scaleInput[scaleOffset];
    output[global_idx] = fma(input[global_idx], ${qt}(scale[0]), ${qt}(scale[1]));
  }`};d.compute({name:"InstanceNormalizationNHWC",shaderCache:{hint:`${Ct}`,inputDependencies:$t},getRunData:()=>({outputs:[{dims:st,dataType:g[0].dataType}],dispatchGroup:{x:Math.ceil(pt/64)},programUniforms:wt}),getShaderSource:jt},{inputs:[g[0],Lt]})},_l=(d,g)=>{g.format==="NHWC"?rm(d,d.inputs,g):d.compute(em(d.inputs,g))}}),nm,im,Sl,Cl=j(()=>{ye(),xe(),_e(),nm=d=>{if(!d||d.length<2)throw new Error("layerNorm requires at least 2 inputs.")},im=(d,g,b)=>{let et=g.simplified,st=d[0].dims,at=d[1],vt=!et&&d[2],Tt=st,Ct=M$1.normalizeAxis(g.axis,st.length),pt=M$1.sizeToDimension(st,Ct),wt=M$1.sizeFromDimension(st,Ct),$t=M$1.size(at.dims),Lt=vt?M$1.size(vt.dims):0;if($t!==wt||vt&&Lt!==wt)throw new Error(`Size of X.shape()[axis:] == ${wt}.
       Size of scale and bias (if provided) must match this.
       Got scale size of ${$t} and bias size of ${Lt}`);let jt=[];for(let or=0;or<st.length;++or)or<Ct?jt.push(st[or]):jt.push(1);let Ft=Ue(wt),Gt=["type","type"],Ht=[{type:12,data:pt},{type:1,data:wt},{type:12,data:Math.floor(wt/Ft)},{type:1,data:g.epsilon}];vt&&Gt.push("type");let qt=b>1,Kt=b>2,rr=or=>{let jr=De(d[0].dataType),qr=[U$1("x",d[0].dataType,d[0].dims,Ft),U$1("scale",at.dataType,at.dims,Ft)];vt&&qr.push(U$1("bias",vt.dataType,vt.dims,Ft)),qr.push(K("output",d[0].dataType,Tt,Ft)),qt&&qr.push(K("mean_data_output",1,jt)),Kt&&qr.push(K("inv_std_output",1,jt));let Yr=[{name:"norm_count",type:"u32"},{name:"norm_size",type:"f32"},{name:"norm_size_vectorized",type:"u32"},{name:"epsilon",type:"f32"}];return`
  ${or.registerUniforms(Yr).declareVariables(...qr)}
  ${or.mainStart()}
    ${or.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.norm_count")}
    let offset = global_idx * uniforms.norm_size_vectorized;
    var mean_vector = ${At("f32",Ft)};
    var mean_square_vector = ${At("f32",Ft)};

    for (var h: u32 = 0u; h < uniforms.norm_size_vectorized; h++) {
      let value = ${fr(jr,Ft,"x[h + offset]")};
      mean_vector += value;
      mean_square_vector += value * value;
    }
    let mean = ${Et("mean_vector",Ft)} / uniforms.norm_size;
    let inv_std_dev = inverseSqrt(${Et("mean_square_vector",Ft)} / uniforms.norm_size ${et?"":"- mean * mean"} + uniforms.epsilon);

    for (var j: u32 = 0; j < uniforms.norm_size_vectorized; j++) {
      let f32input = ${fr(jr,Ft,"x[j + offset]")};
      let f32scale = ${fr(jr,Ft,"scale[j]")};
      output[j + offset] = ${qr[0].type.value}((f32input ${et?"":"- mean"}) * inv_std_dev * f32scale
        ${vt?`+ ${fr(jr,Ft,"bias[j]")}`:""}
      );
    }

    ${qt?"mean_data_output[global_idx] = mean":""};
    ${Kt?"inv_std_output[global_idx] = inv_std_dev":""};
  }`},ir=[{dims:Tt,dataType:d[0].dataType}];return qt&&ir.push({dims:jt,dataType:1}),Kt&&ir.push({dims:jt,dataType:1}),{name:"LayerNormalization",shaderCache:{hint:`${Ft};${b};${et}`,inputDependencies:Gt},getRunData:()=>({outputs:ir,dispatchGroup:{x:Math.ceil(pt/64)},programUniforms:Ht}),getShaderSource:rr}},Sl=(d,g)=>{nm(d.inputs),d.compute(im(d.inputs,g,d.outputCount))}}),om,am,Il,Tl,Al=j(()=>{ye(),xe(),Ze(),_e(),om=(d,g)=>{if(d.length<3||d.length>4)throw new Error("MatMulNBits requires 3 or 4 inputs");let b=d[0],et=b.dims.length;if(b.dims[et-1]!==g.k)throw new Error("The last dim of input shape does not match the k value");let st=Math.floor((g.k+g.blockSize-1)/g.blockSize),at=g.blockSize/8*g.bits,vt=d[1];if(!M$1.areEqual(vt.dims,[g.n,st,at]))throw new Error("The second inputs must be 3D tensor with shape N X nBlocksPerCol X blobSize");let Tt=d[2].dims;if(M$1.size(Tt)!==g.n*st)throw new Error("scales input size error.");if(d.length===4){let Ct=d[3].dims,pt=g.bits>4?g.n*st:g.n*Math.floor((st+1)/2);if(M$1.size(Ct)!==pt)throw new Error("zeroPoints input size error.")}},am=(d,g,b,et)=>{let st=d[0].dims,at=st.length,vt=Math.floor((g.k+g.blockSize-1)/g.blockSize),Tt=st[at-2],Ct=g.k,pt=g.n,wt=st.slice(0,at-2),$t=M$1.size(wt),Lt=g.blockSize/8*g.bits/4,jt=d[0].dataType,Ft=Ue(Tt),Gt=Ue(g.k),Ht=Ue(Lt),qt=cr(jt),Kt=Tt*vt*qt,rr=Math.floor(et/Kt),ir=vt<=b[0]&&rr>0,or=!ir||rr>=4?Ue(pt):rr>=2&&Ue(pt)>=2?2:1,jr=wt.concat([Tt,pt]),qr=M$1.size(jr)/or/Ft,Yr=ir?[]:[{type:12,data:qr},{type:12,data:g.blockSize}],vn=[$t,Tt,Ct/Gt],ko=M$1.convertShape(d[1].dims).slice();ko.splice(-1,1,Lt/Ht),Yr.push(...X(vn)),Yr.push(...X(ko)),Yr.push(...X(d[2].dims)),d.length===4&&Yr.push(...X(M$1.convertShape(d[3].dims)));let Xo=[$t,Tt,pt/or];Yr.push(...X(Xo));let zo=t0=>{let Uo=vn.length,No=U$1("a",d[0].dataType,Uo,Gt),_n=U$1("b",12,ko.length,Ht),Kr=U$1("scales",d[2].dataType,d[2].dims.length),e0=[No,_n,Kr],Zr=d.length===4?U$1("zero_points",12,d[3].dims.length):void 0;Zr&&e0.push(Zr);let Ro=Xo.length,Sn=K("output",d[0].dataType,Ro,or),Tn=[{name:"output_size",type:"u32"},{name:"block_size",type:"u32"}],n0=De(d[0].dataType),Go=(()=>{switch(Gt){case 1:return`array<${n0}, 8>`;case 2:return`mat4x2<${n0}>`;case 4:return`mat2x4<${n0}>`;default:throw new Error(`${Gt}-component is not supported.`)}})(),An=`
        for (var word: u32 = 0; word < ${Lt}; word += ${Ht}) {
          ${_n.indicesSet("b_indices","2","word")};
          let b_data = ${_n.getByIndices("b_indices")};
          for (var i: u32 = 0; i < ${Ht}; i++) {
            let b_value: u32 = ${Ht===1?"b_data":"b_data[word + i]"};
            let b_mask: u32 = 0x0F0F0F0Fu;
            let b_value_lower: vec4<u32> = unpack4xU8(b_value & b_mask);
            let b_value_upper: vec4<u32> = unpack4xU8((b_value >> 4) & b_mask);
            let b_quantized_values = ${Go}(${Array.from({length:4},(u0,d0)=>`${n0}(b_value_lower[${d0}]), ${n0}(b_value_upper[${d0}])`).join(", ")});
            let b_dequantized_values = ${Gt===1?`${Go}(${Array.from({length:8},(u0,d0)=>`(b_quantized_values[${d0}] - zero_point) * scale`).join(", ")});`:`(b_quantized_values - ${Go}(${Array(8).fill("zero_point").join(",")})) * scale;`};
            // Number of B elements per 32-bit word is 32/bits = 32/4 = 8
            for (var m: u32 = 0; m < ${ir?Tt:Ft}u; m++) {
              ${No.indicesSet("a_indices",Uo-2,ir?"m":`row * ${Ft} + m`)};
              ${No.indicesSet("a_indices",Uo-1,"word_offset")};
              var input_offset = ${No.indicesToOffset("a_indices")};
              var a_data: ${Go};
              for (var j: u32 = 0; j < ${8/Gt}; j++) {
                a_data[j] = ${No.getByOffset("input_offset")};
                input_offset++;
              }
              ${ir?"workgroup_shared[workgroup_shared_offset + m]":"output_values[m]"}${or>1?"[c]":""} += ${Array.from({length:8/Gt},(u0,d0)=>`${Gt===1?`a_data[${d0}] * b_dequantized_values[${d0}]`:`dot(a_data[${d0}], b_dequantized_values[${d0}])`}`).join(" + ")};
            }
            word_offset += ${8/Gt};
          }
        }`,a0=Zr?`
          zero_point_offset += 4;
          if (zero_point_offset == 32) {
            zero_point_offset = 0;
            zero_point_index++;
            zero_point_word = ${Zr.getByOffset("zero_point_index")};
          }`:"";return ir?`
        var<workgroup> workgroup_shared: array<${Sn.type.value}, ${Tt*vt}>;
        ${t0.declareVariables(...e0,Sn)}
        ${t0.mainStart([vt,1,1])}
          var a_indices: ${No.type.indices};
          var block = local_id.x;
          var col = workgroup_id.y;
          var batch = workgroup_id.z;
          ${No.indicesSet("a_indices","0","batch")};
          // Two zero points are packed into one byte when uniforms.bits is 4.
          for (var c: u32 = 0; c < ${or}; c++) {
            let col_times_components_plus_c = col * ${or} + c;
              ${Zr?`
            var zero_point_bytes_per_col: u32 = (${vt} + 1) / 2;
            var zero_point_byte_count: u32 = col_times_components_plus_c * zero_point_bytes_per_col + (block >> 0x1u);
            var zero_point_word_index: u32 = zero_point_byte_count >> 0x2u;
            var zero_point_byte_offset: u32 = zero_point_byte_count & 0x3u;
            var zero_point_nibble_offset: u32 = block & 0x1u;
            var zero_point_bits_offset: u32 = (zero_point_byte_offset << 3) + (zero_point_nibble_offset << 2);
            var zero_point_word: u32 = ${Zr.getByOffset("zero_point_word_index")} >> zero_point_bits_offset;`:""}
            var b_indices: ${_n.type.indices};
            ${_n.indicesSet("b_indices","0","col_times_components_plus_c")};
            // The scale and zero points are computed per block.
            var scales_index = col_times_components_plus_c * ${vt} + block;
            let scale = ${Kr.getByOffset("scales_index")};
            // The default zero point is 8 for unsigned 4-bit quantization.
            let zero_point = ${n0}(${Zr?"(zero_point_word) & 0xFu":8});
            ${_n.indicesSet("b_indices","1","block")};
            var word_offset: u32 = block * ${g.blockSize/Gt};
            var workgroup_shared_offset: u32 = block * ${Tt};
            ${An}
          }
          workgroupBarrier();
          if (local_id.x == 0u) {
            var output_indices: ${Sn.type.indices};
            ${Sn.indicesSet("output_indices","0","batch")};
            ${Sn.indicesSet("output_indices",Ro-1,"col")};
            ${Sn.indicesSet("output_indices",Ro-2,"0")};
            var output_offset = ${Sn.indicesToOffset("output_indices")};
            for (var m: u32 = 0u; m < ${Tt}u; m++) {
              var output_value: ${Sn.type.value} = ${Sn.type.value}(0);
              var workgroup_shared_offset: u32 = m;
              for (var b: u32 = 0u; b < ${vt}u; b++) {
                output_value += workgroup_shared[workgroup_shared_offset];
                workgroup_shared_offset += ${Tt};
              }
              ${Sn.setByOffset("output_offset","output_value")};
              output_offset += ${pt/or};
            }
          }
        }`:`
        ${t0.registerUniforms(Tn).declareVariables(...e0,Sn)}
        ${t0.mainStart()}
          ${t0.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.output_size")}
          var output_values: array<${Sn.type.value}, ${Ft}>;
          var output_indices = ${Sn.offsetToIndices("global_idx")};
          var col = ${Sn.indicesGet("output_indices",Ro-1)};
          var row = ${Sn.indicesGet("output_indices",Ro-2)};
          var a_indices: ${No.type.indices} = output_indices;
          // Two zero points are packed into one byte because uniforms.bits <= 4.
          // zero_point_offset is either 0 or 4. It is bit offset within one byte.
          // TODO support zero_point_offset for bits > 4
          ${Zr?`
          var zero_point_abs_offset = col * ${or} * ((${vt} + 1) / 2);
          var zero_point_index: u32 = zero_point_abs_offset / 4;
          var zero_point_word: u32 = ${Zr.getByOffset("zero_point_index")};
          var zero_point_offset: u32 = (zero_point_abs_offset % 4) * 8;`:""}
          var scale_index = col * ${vt*or};
          var b_indices: ${_n.type.indices};
          for (var c: u32 = 0; c < ${or}; c++) {
            ${_n.indicesSet("b_indices","0",`col * ${or} + c`)};
            var block_offset: u32 = 0;
            for (var block: u32 = 0; block < ${vt}; block++) {
              // The scale and zero points are computed per block.
              let scale = ${Kr.getByOffset("scale_index")};
              // The default zero point is 8 for unsigned 4-bit quantization.
              let zero_point = ${n0}(${Zr?"extractBits(zero_point_word, zero_point_offset, 4)":8});
              ${_n.indicesSet("b_indices","1","block")};
              var word_offset: u32 = block_offset;
              ${An}
              scale_index++;
              ${a0}
              block_offset += uniforms.block_size / ${Gt};
            }
            // Drop the trailing 4 bits if the zero_poit_offset is not a byte boundary to align with the next byte.
            ${Zr?`if (zero_point_offset % 8 > 0) {
                ${a0}
              }`:""}
            }
            for (var k: u32 = 0u; k < ${Ft}u; k++) {
              ${Sn.indicesSet("output_indices",Ro-2,`${Ft} * row + k`)};
              ${Sn.setByIndices("output_indices","output_values[k]")}
            }
        }`};return{name:ir?"BlockwiseMatMulNBits":"MatMulNBits",shaderCache:{hint:`${g.cacheKey};${Tt};${jt};${d.length}`,inputDependencies:Array(d.length).fill("rank")},getRunData:()=>({outputs:[{dims:jr,dataType:jt}],name:ir?"BlockwiseMatMulNBits":"MatMulNBits",dispatchGroup:ir?{x:1,y:Math.ceil(pt/or),z:$t}:{x:Math.ceil(qr/64)},programUniforms:Yr}),getShaderSource:zo}},Il=(d,g)=>{om(d.inputs,g);let b=d.getMaxComputeWorkgroupSizes(),et=d.getMaxComputeWorkgroupStoragesize();d.compute(am(d.inputs,g,b,et))},Tl=d=>we(d)}),lt,sm,kl,El,um,$o,Ol,Pl=j(()=>{ye(),xe(),Ze(),Hn(),oo(),_e(),Rr(),lt=(d,g)=>d.length>g&&d[g].dims.length>0&&M$1.size(d[g].dims)>0?d[g]:void 0,sm=(d,g)=>{let b=d[0],et=lt(d,1),st=lt(d,2),at=lt(d,3),vt=lt(d,4),Tt=lt(d,5),Ct=lt(d,6),pt=lt(d,7);if(b.dims.length!==3&&b.dims.length!==5)throw new Error("Input query is expected to have 3 or 5 dimensions");let wt=!1,$t=b.dims[0],Lt=b.dims[1],jt=b.dims.length===3?wt?b.dims[2]/3:b.dims[2]:g.numHeads*b.dims[4],Ft=Lt,Gt=0,Ht=0,qt=Math.floor(jt/g.numHeads);if(Ct&&pt){if(Ct.dims.length!==4)throw new Error('Input "past_key" is expected to have 4 dimensions');if(Ct.dims[0]!==$t||Ct.dims[1]!==g.numHeads||Ct.dims[3]!==qt)throw new Error('Input "past_key" shape (batch_size, num_heads, past_sequence_length, head_size)');if(pt.dims[0]!==$t||pt.dims[1]!==g.numHeads||pt.dims[3]!==qt)throw new Error('Input "past_value" shape (batch_size, num_heads, past_sequence_length, head_size)');if(Ct.dims[2]!==pt.dims[2])throw new Error('Input "past_key" and "past_value" shall have same dim 2 (past_sequence_length)');if(pt.dims.length!==4)throw new Error('Input "past_value" is expected to have 4 dimensions');Gt=Ct.dims[2],Ht=Ct.dims[2]}else if(Ct||pt)throw new Error('Input "past_key" and "past_value" shall be both present or both absent');let Kt;if(et){if(b.dims.length!==3)throw new Error('Input "query" is expected to have 3 dimensions when key is given');if(et.dims.length<3||et.dims.length>5)throw new Error('Input "key" is expected to have 3, 4, or 5 dimensions');if(b.dims[0]!==et.dims[0])throw new Error('Input "query" and "key" shall have same dim 0 (batch size)');if(et.dims.length===3){if(et.dims[2]!==b.dims[2])throw new Error('Input "query" and "key" shall have same dim 2 (hidden_size)');Kt=2,Ft=et.dims[1]}else if(et.dims.length===5){if(et.dims[2]!==g.numHeads||et.dims[3]!==2||et.dims[4]!==qt)throw new Error('Expect "key" shape (batch_size, kv_sequence_length, num_heads, 2, head_size) for packed kv');if(st)throw new Error('Expect "value" be none when "key" has packed kv format.');Kt=5,Ft=et.dims[1]}else{if(et.dims[1]!==g.numHeads||et.dims[3]!==qt)throw new Error('Expect "key" shape (batch_size, num_heads, kv_sequence_length, head_size) for past_key');Kt=0,Ft=et.dims[2]}}else{if(b.dims.length!==3&&b.dims.length!==5)throw new Error('Input "query" is expected to have 3 or 5 dimensions when key is empty');if(b.dims.length===5&&(b.dims[2]!==g.numHeads||b.dims[3]!==3))throw new Error('Expect "query" shape (batch_size, kv_sequence_length, num_heads, 3, head_size) for packed kv');Kt=3}if(at){if(at.dims.length!==1)throw new Error('Input "bias" is expected to have 1 dimension');if(st&&b.dims.length===5&&b.dims[3]===2)throw new Error("bias is not allowed for packed kv.")}let rr=0;if(vt){rr=8;let Yr=vt.dims;throw Yr.length===1?Yr[0]===$t?rr=1:Yr[0]===3*$t+2&&(rr=3):Yr.length===2&&Yr[0]===$t&&Yr[1]===Ft&&(rr=5),rr===8?new Error('Input "key_padding_mask" shape shall be (batch_size) or (batch_size, kv_sequence_length)'):new Error("Mask not supported")}let ir=!1,or=jt;if(st){if(st.dims.length!==3&&st.dims.length!==4)throw new Error('Input "value" is expected to have 3 or 4 dimensions');if(b.dims[0]!==st.dims[0])throw new Error('Input "query" and "value" shall have same dim 0 (batch_size)');if(st.dims.length===3){if(Ft!==st.dims[1])throw new Error('Input "key" and "value" shall have the same dim 1 (kv_sequence_length)');or=st.dims[2]}else{if(Ft!==st.dims[2])throw new Error('Input "past_key" and "past_value" shall have the same dim 2 (kv_sequence_length)');or=st.dims[1]*st.dims[3],ir=!0}}let jr=Gt+Ft,qr=!1;if(vt)throw new Error("Key padding mask is not supported");if(Tt){if(Tt.dims.length!==4)throw new Error('Input "relative_position_bias" is expected to have 4 dimensions');if(Tt.dims[0]!==$t&&Tt.dims[0]!==1||Tt.dims[1]!==g.numHeads||Tt.dims[2]!==Lt||Tt.dims[3]!==jr)throw new Error('Input "relative_position_bias" shape (batch_size, 1, sequence_length, kv_sequence_length)')}return{batchSize:$t,sequenceLength:Lt,pastSequenceLength:Gt,kvSequenceLength:Ft,totalSequenceLength:jr,maxSequenceLength:Ht,inputHiddenSize:0,hiddenSize:jt,vHiddenSize:or,headSize:qt,vHeadSize:Math.floor(or/g.numHeads),numHeads:g.numHeads,isUnidirectional:!1,pastPresentShareBuffer:!1,maskFilterValue:g.maskFilterValue,maskType:rr,scale:g.scale,broadcastResPosBias:qr,passPastInKv:ir,qkvFormat:Kt}},kl=d=>we({...d}),El=we({perm:[0,2,1,3]}),um=(d,g,b,et,st,at,vt)=>{let Tt=[et,st,at],Ct=M$1.size(Tt),pt=[{type:12,data:Ct},{type:12,data:vt},{type:12,data:at}],wt=$t=>{let Lt=K("qkv_with_bias",g.dataType,Tt),jt=U$1("qkv",g.dataType,Tt),Ft=U$1("bias",b.dataType,Tt),Gt=[{name:"output_size",type:"u32"},{name:"bias_offset",type:"u32"},{name:"hidden_size",type:"u32"}];return`
  ${$t.registerUniforms(Gt).declareVariables(jt,Ft,Lt)}
  ${$t.mainStart()}
    ${$t.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.output_size")}
    let bias_offset_idx = (global_idx % uniforms.hidden_size) + uniforms.bias_offset;

    qkv_with_bias[global_idx] = qkv[global_idx] + bias[bias_offset_idx];
  }`};return d.compute({name:"MultiHeadAttentionAddBias",shaderCache:{inputDependencies:["type","type"]},getRunData:()=>({outputs:[{dims:Tt,dataType:g.dataType,gpuDataType:0}],dispatchGroup:{x:Math.ceil(Ct/64)},programUniforms:pt}),getShaderSource:wt},{inputs:[g,b],outputs:[-1]})[0]},$o=(d,g,b,et,st,at,vt,Tt)=>{let Ct=at;if(vt){if(et===1)throw new Error("AddBiasReshape is not implemented. Please export your model with packed QKV or KV");return Ct=um(d,at,vt,g,et,b*st,Tt),Ct=Ct.reshape([g,et,b,st]),d.compute(xt(Ct,El.perm),{inputs:[Ct],outputs:[-1]})[0]}else return at.dims.length===3&&(Ct=at.reshape([g,et,b,st])),d.compute(xt(Ct,El.perm),{inputs:[Ct],outputs:[-1]})[0]},Ol=(d,g)=>{let b=sm(d.inputs,g),et=d.inputs[0],st=lt(d.inputs,1),at=lt(d.inputs,2),vt=lt(d.inputs,3),Tt=lt(d.inputs,4),Ct=lt(d.inputs,5),pt=lt(d.inputs,6),wt=lt(d.inputs,7);if(et.dims.length===5)throw new Error("Packed QKV is not implemented");if((st==null?void 0:st.dims.length)===5)throw new Error("Packed KV is not implemented");let $t=st&&at&&st.dims.length===4&&at.dims.length===4,Lt=$o(d,b.batchSize,b.numHeads,b.sequenceLength,b.headSize,et,vt,0);if($t)return Xn(d,Lt,st,at,Tt,void 0,pt,wt,Ct,b,g);if(!st||!at)throw new Error("key and value must be provided");let jt=$o(d,b.batchSize,b.numHeads,b.kvSequenceLength,b.headSize,st,vt,b.hiddenSize),Ft=$o(d,b.batchSize,b.numHeads,b.kvSequenceLength,b.vHeadSize,at,vt,2*b.hiddenSize);Xn(d,Lt,jt,Ft,Tt,void 0,pt,wt,Ct,b,g)}}),lm,dm,cm,pm,mm,fm,hm,gm,Rl,zl=j(()=>{ye(),xe(),_e(),lm=d=>{if(!d||d.length<1)throw new Error("Too few inputs");if(d[0].dataType!==1&&d[0].dataType!==10)throw new Error("Input type must be float or float16.");if(d.length>=2){let g=d[0].dims.length*2===d[1].dims[0];if(d.length===4&&(g=d[3].dims[0]*2===d[1].dims[0]),!g)throw new Error("The pads should be a 1D tensor of shape [2 * input_rank] or [2 * num_axes].")}},dm=(d,g,b)=>{let et="";for(let st=g-1;st>=0;--st)et+=`
            k = i32(${d.indicesGet("indices",st)}) - ${fe("uniforms.pads",st,b)};
            if (k < 0) {
              break;
            }
            if (k >= i32(${fe("uniforms.x_shape",st,g)})) {
              break;
            }
            offset += k * i32(${fe("uniforms.x_strides",st,g)});
        `;return`
          value = ${d.type.value}(uniforms.constant_value);
          for (var i = 0; i < 1; i++) {
            var offset = 0;
            var k = 0;
            ${et}
            value = x[offset];
          }
      `},cm=(d,g,b)=>{let et="";for(let st=g-1;st>=0;--st)et+=`
                k = i32(${d.indicesGet("indices",st)}) - ${fe("uniforms.pads",st,b)};
                if (k < 0) {
                  k = -k;
                }
                {
                  let _2n_1 = 2 * (i32(${fe("uniforms.x_shape",st,g)}) - 1);
                  k = k % _2n_1;
                  if(k >= i32(${fe("uniforms.x_shape",st,g)})) {
                    k = _2n_1 - k;
                  }
                }
                offset += k * i32(${fe("uniforms.x_strides",st,g)});
            `;return`
              var offset = 0;
              var k = 0;
              ${et}
              value = x[offset];
          `},pm=(d,g,b)=>{let et="";for(let st=g-1;st>=0;--st)et+=`
                k = i32(${d.indicesGet("indices",st)}) - ${fe("uniforms.pads",st,b)};
                if (k < 0) {
                  k = 0;
                }
                if (k >= i32(${fe("uniforms.x_shape",st,g)})) {
                  k = i32(${fe("uniforms.x_shape",st,g)}) - 1;
                }
                offset += k * i32(${fe("uniforms.x_strides",st,g)});
            `;return`
              var offset = 0;
              var k = 0;
              ${et}
              value = x[offset];
          `},mm=(d,g,b)=>{let et="";for(let st=g-1;st>=0;--st)et+=`
                k = i32(${d.indicesGet("indices",st)}) - ${fe("uniforms.pads",st,b)};
                if (k < 0)  {
                  k += i32(${fe("uniforms.x_shape",st,g)}]);
                }
                if (k >= i32(${fe("uniforms.x_shape",st,g)})) {
                  k -= i32(${fe("uniforms.x_shape",st,g)});
                }
                offset += k * i32(${fe("uniforms.x_strides",st,g)});
            `;return`
              var offset = 0;
              var k = 0;
              ${et}
              value = x[offset];
          `},fm=(d,g,b)=>{switch(b.mode){case 0:return dm(d,g,b.pads.length);case 1:return cm(d,g,b.pads.length);case 2:return pm(d,g,b.pads.length);case 3:return mm(d,g,b.pads.length);default:throw new Error("Invalid mode")}},hm=(d,g)=>{let b=M$1.padShape(d[0].dims.slice(),g.pads),et=d[0].dims,st=M$1.size(b),at=[{type:12,data:st},{type:6,data:g.pads}];g.mode===0&&at.push({type:d[0].dataType,data:g.value}),at.push(...X(d[0].dims,b));let vt=["rank"],Tt=Ct=>{let pt=K("output",d[0].dataType,b.length),wt=U$1("x",d[0].dataType,et.length),$t=wt.type.value,Lt=fm(pt,et.length,g),jt=[{name:"output_size",type:"u32"},{name:"pads",type:"i32",length:g.pads.length}];return g.mode===0&&jt.push({name:"constant_value",type:$t}),`
            ${Ct.registerUniforms(jt).declareVariables(wt,pt)}
            ${Ct.mainStart()}
            ${Ct.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.output_size")}

            let indices = ${pt.offsetToIndices("global_idx")};

            var value = ${$t}(0);
            ${Lt}
            output[global_idx] = value;
        }`};return{name:"Pad",shaderCache:{hint:`${g.mode}`,inputDependencies:vt},getRunData:()=>({outputs:[{dims:b,dataType:d[0].dataType}],dispatchGroup:{x:Math.ceil(M$1.size(b)/64)},programUniforms:at}),getShaderSource:Tt}},gm=(d,g)=>{if(d.length>1){let b=d[1].getBigInt64Array(),et=d.length>=3&&d[2].data?d[2].getFloat32Array()[0]:0,st=d[0].dims.length,at=new Int32Array(2*st).fill(0);if(d.length>=4){let Tt=d[3].getBigInt64Array();for(let Ct=0;Ct<Tt.length;Ct++)at[Number(Tt[Ct])]=Number(b[Ct]),at[Number(Tt[Ct])+st]=Number(b[Ct+Tt.length])}else b.forEach((Tt,Ct)=>at[Number(Ct)]=Number(Tt));let vt=[];return at.forEach(Tt=>vt.push(Tt)),{mode:g.mode,value:et,pads:vt}}else return g},Rl=(d,g)=>{lm(d.inputs);let b=gm(d.inputs,g);d.compute(hm(d.inputs,b),{inputs:[0]})}}),si,Bl,Dl,Ml,Ul,ym,bm,Wl,Nl,Vl,Hl,Gl,Ll,Fl,ql,jl,Kl,Yl,Xl,Zl=j(()=>{_t(),ye(),xe(),_e(),si=d=>{if(ke.webgpu.validateInputContent&&(!d||d.length!==1))throw new Error("Pool ops requires 1 input.")},Bl=(d,g,b)=>{let et=g.format==="NHWC",st=d.dims.slice();et&&st.splice(1,0,st.pop());let at=Object.hasOwnProperty.call(g,"dilations"),vt=g.kernelShape.slice(),Tt=g.strides.slice(),Ct=at?g.dilations.slice():[],pt=g.pads.slice();pr.adjustPoolAttributes(b,st,vt,Tt,Ct,pt);let wt=pr.computePoolOutputShape(b,st,Tt,Ct,vt,pt,g.autoPad),$t=Object.assign({},g);at?Object.assign($t,{kernelShape:vt,strides:Tt,pads:pt,dilations:Ct,cacheKey:g.cacheKey}):Object.assign($t,{kernelShape:vt,strides:Tt,pads:pt,cacheKey:g.cacheKey});let Lt=wt.slice();return Lt.push(Lt.splice(1,1)[0]),[$t,et?Lt:wt]},Dl=(d,g)=>{let b=g.format==="NHWC",et=M$1.size(d),st=M$1.size(g.kernelShape),at=[{type:12,data:et},{type:12,data:st}],vt=[{name:"outputSize",type:"u32"},{name:"kernelSize",type:"u32"}];if(g.kernelShape.length<=2){let Tt=g.kernelShape[g.kernelShape.length-1],Ct=g.strides[g.strides.length-1],pt=g.pads[g.pads.length/2-1],wt=g.pads[g.pads.length-1],$t=!!(pt+wt);at.push({type:12,data:Tt},{type:12,data:Ct},{type:12,data:pt},{type:12,data:wt}),vt.push({name:"kw",type:"u32"},{name:"sw",type:"u32"},{name:"pwStart",type:"u32"},{name:"pwEnd",type:"u32"});let Lt=!1;if(g.kernelShape.length===2){let jt=g.kernelShape[g.kernelShape.length-2],Ft=g.strides[g.strides.length-2],Gt=g.pads[g.pads.length/2-2],Ht=g.pads[g.pads.length-2];Lt=!!(Gt+Ht),at.push({type:12,data:jt},{type:12,data:Ft},{type:12,data:Gt},{type:12,data:Ht}),vt.push({name:"kh",type:"u32"},{name:"sh",type:"u32"},{name:"phStart",type:"u32"},{name:"phEnd",type:"u32"})}return[at,vt,!0,$t,Lt]}else{if(b)throw new Error("Pooling with kernelShape.length > 2 is not supported for NHWC format.");let Tt=M$1.computeStrides(g.kernelShape);at.push({type:12,data:Tt},{type:12,data:g.pads},{type:12,data:g.strides}),vt.push({name:"kernelStrides",type:"u32",length:Tt.length},{name:"pads",type:"u32",length:g.pads.length},{name:"strides",type:"u32",length:g.strides.length});let Ct=g.pads.reduce((pt,wt)=>pt+wt);return[at,vt,!!Ct,!1,!1]}},Ml=(d,g,b,et,st,at,vt,Tt,Ct,pt,wt,$t)=>{let Lt=st.format==="NHWC",jt=g.type.value,Ft=K("output",g.type.tensor,et);if(st.kernelShape.length<=2){let Gt="",Ht="",qt="",Kt=b-(Lt?2:1);if(wt?Gt=`
                for (var i: u32 = 0u; i < uniforms.kw; i++) {
                  xIndices[${Kt}] = indices[${Kt}] * uniforms.sw - uniforms.pwStart + i;
                  if (xIndices[${Kt}] < 0 || xIndices[${Kt}]
                      >= uniforms.x_shape[${Kt}]) {
                    pad++;
                    continue;
                  }
                  let x_val = x[${g.indicesToOffset("xIndices")}];
                  ${at}
                }`:Gt=`
                for (var i: u32 = 0u; i < uniforms.kw; i++) {
                  xIndices[${Kt}] = indices[${Kt}] * uniforms.sw - uniforms.pwStart + i;
                  let x_val = x[${g.indicesToOffset("xIndices")}];
                  ${at}
                }`,st.kernelShape.length===2){let rr=b-(Lt?3:2);$t?Ht=`
                for (var j: u32 = 0u; j < uniforms.kh; j++) {
                  xIndices[${rr}] = indices[${rr}] * uniforms.sh - uniforms.phStart + j;
                  if (xIndices[${rr}] < 0 || xIndices[${rr}] >= uniforms.x_shape[${rr}]) {
                    pad += i32(uniforms.kw);
                    continue;
                  }
              `:Ht=`
                for (var j: u32 = 0u; j < uniforms.kh; j++) {
                  xIndices[${rr}] = indices[${rr}] * uniforms.sh - uniforms.phStart + j;
                `,qt=`
              }
            `}return`
            ${d.registerUniforms(Ct).declareVariables(g,Ft)}

            ${d.mainStart()}
              ${d.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.outputSize")}

              let indices = ${Ft.offsetToIndices("global_idx")};
              var xIndices = ${Ft.offsetToIndices("global_idx")};

              var value = ${jt}(${Tt});
              var pad = 0;
              ${Ht}
              ${Gt}
              ${qt}
              ${vt}

              output[global_idx] = value;
            }`}else{if(Lt)throw new Error("Pooling with kernelShape.length > 2 is not supported for NHWC format.");let Gt=st.kernelShape.length,Ht=st.pads.length,qt="";return pt?qt=`
                if (xIndices[j] >= uniforms.x_shape[j]) {
                  pad++;
                  isPad = true;
                  break;
                }
              }
              if (!isPad) {
                let x_val = x[${g.indicesToOffset("xIndices")}];
                ${at}
              }`:qt=`
              }
              let x_val = x[${g.indicesToOffset("xIndices")}];
              ${at}
            `,`
            ${d.registerUniforms(Ct).declareVariables(g,Ft)}

            ${d.mainStart()}
              ${d.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.outputSize")}
              let indices = ${Ft.offsetToIndices("global_idx")};
              var xIndices = ${Ft.offsetToIndices("global_idx")};

              var offsets: array<u32, ${Gt}>;

              var value = ${jt}(${Tt});
              var pad = 0;
              var isPad = false;

              for (var i: u32 = 0u; i < uniforms.kernelSize; i++) {
                var offset = i;
                for (var j = 0u; j < ${Gt-1}u; j++) {
                  offsets[j] = offset / ${fe("uniforms.kernelStrides","j",Gt)};
                  offset -= offsets[j] * ${fe("uniforms.kernelStrides","j",Gt)};
                }
                offsets[${Gt-1}] = offset;

                isPad = false;
                for (var j = ${b-Gt}u; j < ${b}u; j++) {
                  xIndices[j] = indices[j] * ${fe("uniforms.strides",`j - ${b-Gt}u`,Gt)}
                    + offsets[j - ${b-Gt}u] - ${fe("uniforms.pads","j - 2u",Ht)};
                  ${qt}
              }
              ${vt}

              output[global_idx] = value;
            }`}},Ul=d=>`${d.format};${d.ceilMode};${d.autoPad};${d.kernelShape.length}`,ym=d=>`${Ul(d)};${d.countIncludePad}`,bm=d=>`${Ul(d)};${d.storageOrder};${d.dilations}`,Wl=d=>({format:d.format,autoPad:["NOTSET","VALID","SAME_UPPER","SAME_LOWER"][d.auto_pad],ceilMode:d.ceil_mode,kernelShape:d.kernel_shape,strides:d.strides,pads:d.pads}),Nl=(d,g,b,et)=>{let[st,at]=Bl(g,et,b),vt=U$1("x",g.dataType,g.dims.length),Tt=vt.type.value,Ct="value += x_val;",pt="";st.countIncludePad?pt+=`value /= ${Tt}(uniforms.kernelSize);`:pt+=`value /= ${Tt}(i32(uniforms.kernelSize) - pad);`;let[wt,$t,Lt,jt,Ft]=Dl(at,st);wt.push(...X(g.dims,at));let Gt=["rank"];return{name:d,shaderCache:{hint:`${et.cacheKey};${Lt};${jt};${Ft}`,inputDependencies:Gt},getRunData:()=>({outputs:[{dims:at,dataType:g.dataType}],dispatchGroup:{x:Math.ceil(M$1.size(at)/64)},programUniforms:wt}),getShaderSource:Ht=>Ml(Ht,vt,g.dims.length,at.length,st,Ct,pt,0,$t,Lt,jt,Ft)}},Vl=d=>{let g=d.count_include_pad!==0,b=Wl(d);if(b.ceilMode!==0)throw new Error("using ceil() in shape computation is not yet supported for AveragePool");let et={countIncludePad:g,...b,cacheKey:""};return{...et,cacheKey:ym(et)}},Hl=(d,g)=>{si(d.inputs),d.compute(Nl("AveragePool",d.inputs[0],!1,g))},Gl={autoPad:"",ceilMode:0,countIncludePad:!1,kernelShape:[],strides:[],pads:[],storageOrder:0,dilations:[]},Ll=d=>{let g=d.format;return{format:g,...Gl,cacheKey:g}},Fl=(d,g)=>{si(d.inputs),d.compute(Nl("GlobalAveragePool",d.inputs[0],!0,g))},ql=(d,g,b,et)=>{let[st,at]=Bl(g,et,b),vt=`
      value = max(x_val, value);
    `,Tt="",Ct=U$1("x",g.dataType,g.dims.length),pt=["rank"],[wt,$t,Lt,jt,Ft]=Dl(at,st);return wt.push(...X(g.dims,at)),{name:d,shaderCache:{hint:`${et.cacheKey};${Lt};${jt};${Ft}`,inputDependencies:pt},getRunData:()=>({outputs:[{dims:at,dataType:g.dataType}],dispatchGroup:{x:Math.ceil(M$1.size(at)/64)},programUniforms:wt}),getShaderSource:Gt=>Ml(Gt,Ct,g.dims.length,at.length,st,vt,Tt,g.dataType===10?-65504:-1e5,$t,Lt,jt,Ft)}},jl=(d,g)=>{si(d.inputs),d.compute(ql("MaxPool",d.inputs[0],!1,g))},Kl=d=>{let g=d.storage_order,b=d.dilations,et=Wl(d);if(g!==0)throw new Error("column major storage order is not yet supported for MaxPool");if(et.ceilMode!==0)throw new Error("using ceil() in shape computation is not yet supported for MaxPool");let st={storageOrder:g,dilations:b,...et,cacheKey:""};return{...st,cacheKey:bm(st)}},Yl=d=>{let g=d.format;return{format:g,...Gl,cacheKey:g}},Xl=(d,g)=>{si(d.inputs),d.compute(ql("GlobalMaxPool",d.inputs[0],!0,g))}}),wm,$m,Ql,Jl=j(()=>{_t(),ye(),_e(),wm=(d,g,b)=>{let et=d===g,st=d<g&&b<0,at=d>g&&b>0;if(et||st||at)throw new Error("Range these inputs' contents are invalid.")},$m=(d,g,b,et)=>{let st=Math.abs(Math.ceil((g-d)/b)),at=[st],vt=st,Tt=[{type:12,data:vt},{type:et,data:d},{type:et,data:b},...X(at)],Ct=pt=>{let wt=K("output",et,at.length),$t=wt.type.value,Lt=[{name:"outputSize",type:"u32"},{name:"start",type:$t},{name:"delta",type:$t}];return`
        ${pt.registerUniforms(Lt).declareVariables(wt)}
        ${pt.mainStart()}
        ${pt.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.outputSize")}
        output[global_idx] = uniforms.start + ${$t}(global_idx) * uniforms.delta;
      }`};return{name:"Range",shaderCache:{hint:`${et}`},getShaderSource:Ct,getRunData:()=>({outputs:[{dims:at,dataType:et}],dispatchGroup:{x:Math.ceil(vt/64)},programUniforms:Tt})}},Ql=d=>{let g=0,b=0,et=0;d.inputs[0].dataType===6?(g=d.inputs[0].getInt32Array()[0],b=d.inputs[1].getInt32Array()[0],et=d.inputs[2].getInt32Array()[0]):d.inputs[0].dataType===1&&(g=d.inputs[0].getFloat32Array()[0],b=d.inputs[1].getFloat32Array()[0],et=d.inputs[2].getFloat32Array()[0]),ke.webgpu.validateInputContent&&wm(g,b,et),d.compute($m(g,b,et,d.inputs[0].dataType),{inputs:[]})}}),_m,xm,Sm,Cm,Im,Tm,Am,Em,km,Om,Pm,ed,Rm,zm,Bm,Dm,Mm,td,rd,nd=j(()=>{ye(),xe(),Ze(),_e(),_m=(d,g)=>{if(d.every(b=>b>0||(()=>{throw new Error("Resize requires scales input values to be positive")})),d.length>0){if(g.mode==="linear"){if(!(d.length===2||d.length===3||d.length===4&&d[0]===1&&d[1]===1||d.length===4&&d[0]===1&&d[3]===1||d.length===5&&d[0]===1&&d[1]===1))throw new Error(`For linear mode, Resize requires scales to be 2D, 3D, 4D with either two outermost or one innermost and
            one outermost scale values equal to 1, or 5D with two outermost scale values equal to 1`)}else if(g.mode==="cubic"&&!(d.length===2||d.length===4&&d[0]===1&&d[1]===1||d.length===4&&d[0]===1&&d[3]===1))throw new Error("Resize requires scales input size to be 2 or 4 for cubic mode")}},xm=(d,g,b)=>{g.every(st=>st>=0&&st<b||(()=>{throw new Error("Resize requires axes input values to be positive and less than rank")}));let et=new Array(b).fill(1);return g.forEach((st,at)=>et[st]=d[at]),et},Sm=(d,g,b,et,st,at)=>{let[vt,Tt,Ct]=b>10?[1,2,3]:[-1,d.length>1?1:-1,-1],pt=d[0].dims.length;if(vt>0&&d.length>vt&&d[vt].dims.length>0)d[vt].getFloat32Array().forEach(wt=>at.push(wt));else if(g.coordinateTransformMode==="tf_crop_and_resize")throw new Error("Resize requires RoI input to be specified when coordinateTransformMode is tfCropAndResize");if(Tt>0&&d.length>Tt&&d[Tt].dims.length>0){if(d[Tt].getFloat32Array().forEach(wt=>et.push(wt)),et.length!==0&&et.length!==pt&&b>=18&&et.length!==g.axes.length)throw new Error("Resize requires scales input size to be same as input rank or axes size for opset 18 and up");_m(et,g),g.axes.length>0&&xm(et,g.axes,pt).forEach((wt,$t)=>et[$t]=wt)}if(Ct>0&&d.length>Ct&&(d[Ct].getBigInt64Array().forEach(wt=>st.push(Number(wt))),st.length!==pt||b>=18&&st.length===g.axes.length))throw new Error("Resize requires sizes input size to be same as input rank or axes size for opset 18 and up");if(g.axes.length>0){if(et.length!==g.axes.length)throw new Error('Resize requires "scales" input size to be of axes rank when axes attributes is specified');if(st.length!==g.axes.length)throw new Error('Resize requires "sizes" input size to be of rank axes rank when axes attributes is specified')}if(typeof et<"u"&&typeof st<"u"&&et.length>0&&st.length>pt)throw new Error("Resize requires only of scales or sizes to be specified")},Cm=(d,g)=>`fn getOriginalCoordinateFromResizedCoordinate(xResized: u32, xScale: f32, lengthResized: u32,
     lengthOriginal: u32, roiStart: f32, roiEnd: f32) -> ${g} { `+(()=>{switch(d){case"asymmetric":return`return ${g}(xResized) / ${g}(xScale);`;case"pytorch_half_pixel":return`if (lengthResized > 1) {
                    return (${g}(xResized) + 0.5) / ${g}(xScale) - 0.5;
                  } else {
                    return 0.0;
                  }`;case"tf_half_pixel_for_nn":return`return (${g}(xResized) + 0.5) / ${g}(xScale);`;case"align_corners":return`if (lengthResized == 1) {
                    return 0.0;
                  } else {
                    // The whole part and the fractional part are calculated separately due to inaccuracy of floating
                    // point division. As an example, f32(21) / f32(7) may evaluate to 2.99... instead of 3, causing an
                    // offset-by-one error later in floor().
                    let whole = ${g}(xResized * (lengthOriginal - 1) / (lengthResized - 1));
                    let fract =
                        ${g}(xResized * (lengthOriginal - 1) % (lengthResized - 1)) / ${g}(lengthResized - 1);
                    return whole + fract;
                  }`;case"tf_crop_and_resize":return`if (lengthResized > 1) {
                    return ${g}(roiStart) * ${g}(lengthOriginal - 1) +
                        (${g}(xResized) * ${g}(roiEnd - roiStart) * ${g}(lengthOriginal - 1)) /
                        ${g}(lengthResized - 1);
                  } else {
                    return 0.5 * ${g}(roiStart + roiEnd) * ${g}(lengthOriginal - 1);
                  }`;case"half_pixel_symmetric":return`const outputWidth = ${g}xScale * ${g}(lengthResized);
                  const adjustment = ${g}(lengthResized) / outputWidth;
                  const center = ${g}(lengthOriginal) / 2;
                  const offset = center * (1 - adjustment);
                  return offset + ((${g}(xResized) + 0.5) / ${g}(xScale)) - 0.5;`;case"half_pixel":return`return ((${g}(xResized) + 0.5) / ${g}(xScale)) - 0.5;`;default:throw new Error(`Coordinate transform mode ${d} is not supported`)}})()+"}",Im=(d,g,b)=>`fn getNearestPixelFromOriginal(xOriginal: ${b}, isDownSample: bool) -> ${b} {`+(()=>{switch(d){case"round_prefer_ceil":return"if (fract(xOriginal) == 0.5) {             return ceil(xOriginal);           } else {             return round(xOriginal);           }";case"floor":return"return floor(xOriginal);";case"ceil":return"return ceil(xOriginal);";case"round_prefer_floor":return"if (fract(xOriginal) == 0.5) {                     return floor(xOriginal);                   } else {                     return round(xOriginal);                   }";case"simple":default:if(g<11)return"if (isDownSample)                     {                       return ceil(xOriginal);                     } else {                       return xOriginal;                     }";throw new Error(`Nearest mode ${d} is not supported`)}})()+"}",Tm=(d,g,b)=>{let et=new Array(b).fill(0).concat(new Array(b).fill(1)),st=d.length===0?et:d.slice();return g.length>0?(g.forEach((at,vt)=>{et[at]=st[vt],et[vt+b]=st[g.length+vt]}),et):st},Am=(d,g,b,et)=>{let st=[];if(b.length>0)if(et.length>0){if(d.forEach(at=>st.push(at)),Math.max(...et)>d.length)throw new Error("axes is out of bound");et.forEach((at,vt)=>st[at]=b[vt])}else b.forEach(at=>st.push(at));else{if(g.length===0)throw new Error("Resize requires either scales or sizes.");st=d.map((at,vt)=>Math.round(at*g[vt]))}return st},Em=(d,g,b)=>{let et=(()=>{switch(b.keepAspectRatioPolicy){case"not_larger":return b.axes.length>0?Math.min(...b.axes.map(at=>g[at]),Number.MAX_VALUE):Math.min(...g,Number.MAX_VALUE);case"not_smaller":return b.axes.length>0?Math.max(...b.axes.map(at=>g[at]),Number.MIN_VALUE):Math.max(...g,Number.MIN_VALUE);default:throw new Error(`Keep aspect ratio policy ${b.keepAspectRatioPolicy} is not supported`)}})();g.fill(1,0,g.length);let st=d.slice();return b.axes.length>0?(b.axes.forEach(at=>g[at]=et),b.axes.forEach(at=>st[at]=Math.round(d[at]*g[at]))):(g.fill(et,0,g.length),st.forEach((at,vt)=>st[vt]=Math.round(at*g[vt]))),st},km=(d,g,b,et,st)=>`
    fn calculateOriginalIndicesFromOutputIndices(output_indices: ${d.type.indices}) -> array<${d.type.value}, ${b.length}> {
      var original_indices: array<${d.type.value}, ${b.length}>;
      for (var i:u32 = 0; i < ${b.length}; i++) {
        var output_index = ${d.indicesGet("output_indices","i")};
        var scale = ${fe("uniforms.scales","i",et)};
        var roi_low = ${fe("uniforms.roi","i",st)};
        var roi_hi = ${fe("uniforms.roi",`i + ${g.length}`,st)};
        if (scale == 1.0) {
          original_indices[i] = ${d.type.value}(output_index);
        } else {
          var input_shape_i = ${fe("uniforms.input_shape","i",g.length)};
          var output_shape_i = ${fe("uniforms.output_shape","i",b.length)};
          original_indices[i] = getOriginalCoordinateFromResizedCoordinate(output_index, scale, output_shape_i,
                                                                           input_shape_i, roi_low, roi_hi);
        }
      }
      return original_indices;
    }`,Om=(d,g,b,et,st,at,vt)=>`
    fn calculateInputIndicesFromOutputIndices(output_indices: ${g.type.indices}) -> ${d.type.indices} {
      var input_indices: ${d.type.indices};
      for (var i:u32 = 0; i < ${et.length}; i++) {
        var output_index = ${g.indicesGet("output_indices","i")};
        var input_index: u32;
        var scale = ${fe("uniforms.scales","i",st)};
        if (scale == 1.0) {
          input_index = output_index;
        } else {
          var roi_low = ${fe("uniforms.roi","i",at)};
          var roi_hi = ${fe("uniforms.roi",`i + ${b.length}`,at)};
          var input_shape_i = ${fe("uniforms.input_shape","i",b.length)};
          var output_shape_i = ${fe("uniforms.output_shape","i",et.length)};
          var original_idx = getOriginalCoordinateFromResizedCoordinate(output_index, scale, output_shape_i,
                                                                        input_shape_i, roi_low, roi_hi);
          if (!${vt} || (original_idx >= 0 && original_idx < ${g.type.value}(input_shape_i))) {
            if (original_idx < 0) {
              input_index = 0;
            } else if (original_idx > ${g.type.value}(input_shape_i - 1)) {
              input_index = input_shape_i - 1;
            } else {
              input_index = u32(getNearestPixelFromOriginal(original_idx, scale < 1));
            }
          } else {
            input_index = u32(original_idx);
          }
        }
        ${d.indicesSet("input_indices","i"," input_index")}
      }
      return input_indices;
    }`,Pm=(d,g)=>`
    fn checkInputIndices(input_indices: ${d.type.indices}) -> bool {
      for (var i:u32 = 0; i < ${g.length}; i++) {
        var input_index = ${d.indicesGet("input_indices","i")};
        if (input_index < 0 || input_index >= ${fe("uniforms.input_shape","i",g.length)}) {
          return false;
        }
      }
      return true;
    }`,ed=(d,g,b,et)=>d.rank>et?`
    ${d.indicesSet("input_indices",g,"channel")};
    ${d.indicesSet("input_indices",b,"batch")};
`:"",Rm=(d,g,b,et,st)=>{let[at,vt,Tt,Ct]=b.length===2?[-1,0,1,-1]:[0,2,3,1],pt=d.type.value;return`
    fn getInputValue(batch: u32, channel: u32, row: u32, col: u32) -> ${pt} {
      var input_indices: ${d.type.indices};
      ${d.indicesSet("input_indices",vt,`max(0, min(row, ${b[vt]} - 1))`)};
      ${d.indicesSet("input_indices",Tt,`max(0, min(col, ${b[Tt]} - 1))`)};
      ${ed(d,Ct,at,2)}
      return ${d.getByIndices("input_indices")};
    }

    fn bilinearInterpolation(output_indices: ${g.type.indices}) -> ${pt} {
      var originalIndices = calculateOriginalIndicesFromOutputIndices(output_indices);
      var row:${pt} = originalIndices[${vt}];
      var col:${pt} = originalIndices[${Tt}];
      ${et?`if (row < 0 || row > (${b[vt]} - 1) || col < 0 || col > (${b[Tt]} - 1)) {
        return ${st};
      }`:""};
      row = max(0, min(row, ${b[vt]} - 1));
      col = max(0, min(col, ${b[Tt]} - 1));
      var row1: u32 = u32(row);
      var col1: u32 = u32(col);
      var row2: u32 = u32(row + 1);
      var col2: u32 = u32(col + 1);
      var channel: u32 = ${b.length>2?`u32(originalIndices[${Ct}])`:"0"};
      var batch: u32 =  ${b.length>2?`u32(originalIndices[${at}])`:"0"};
      var x11: ${pt} = getInputValue(batch, channel, row1, col1);
      var x12: ${pt} = getInputValue(batch, channel, row1, col2);
      var x21: ${pt} = getInputValue(batch, channel, row2, col1);
      var x22: ${pt} = getInputValue(batch, channel, row2, col2);
      var dx1: ${pt} = abs(row - ${pt}(row1));
      var dx2: ${pt} = abs(${pt}(row2) - row);
      var dy1: ${pt} = abs(col - ${pt}(col1));
      var dy2: ${pt} = abs(${pt}(col2) - col);
      if (row1 == row2) {
        dx1 = 0.5;
        dx2 = 0.5;
      }
      if (col1 == col2) {
        dy1 = 0.5;
        dy2 = 0.5;
      }
      return (x11 * dx2 * dy2 + x12 * dx2 * dy1 + x21 * dx1 * dy2 + x22 * dx1 * dy1);
    }`},zm=(d,g,b,et,st,at,vt,Tt,Ct,pt)=>{let wt=b.length===2,[$t,Lt]=wt?[0,1]:[2,3],jt=d.type.value,Ft=Gt=>{let Ht=Gt===$t?"row":"col";return`
      fn ${Ht}CubicInterpolation(input_indices: ${d.type.indices}, output_indices: ${g.type.indices}) -> ${jt} {
        var output_index = ${g.indicesGet("output_indices",Gt)};
        var originalIdx: ${jt} = getOriginalCoordinateFromResizedCoordinate(output_index, ${st[Gt]},
        ${et[Gt]}, ${b[Gt]}, ${at[Gt]}, ${at[Gt]} + ${b.length});
        var fractOriginalIdx: ${jt} = originalIdx - floor(originalIdx);
        var coefs = getCubicInterpolationCoefs(fractOriginalIdx);

        if (${Tt} && (originalIdx < 0 || originalIdx > (${b[Gt]} - 1))) {
          return ${Ct};
        }
        var data: array<${jt}, 4> = array<${jt}, 4>(0.0, 0.0, 0.0, 0.0);
        for (var i: i32 = -1; i < 3; i++) {
          var ${Ht}: ${jt} = originalIdx + ${jt}(i);
          if (${Ht} < 0 || ${Ht} >= ${b[Gt]}) {
            ${pt?`coefs[i + 1] = 0.0;
                        continue;`:Tt?`return ${Ct};`:`${Ht} = max(0, min(${Ht}, ${b[Gt]} - 1));`};
          }
        var input_indices_copy: ${d.type.indices} = input_indices;
          ${d.indicesSet("input_indices_copy",Gt,`u32(${Ht})`)};
          data[i + 1] = ${Gt===$t?d.getByIndices("input_indices_copy"):"rowCubicInterpolation(input_indices_copy, output_indices)"};
        }
        return cubicInterpolation1D(data, coefs);
      }`};return`
    ${Ft($t)};
    ${Ft(Lt)};
  fn getCubicInterpolationCoefs(s: ${jt}) -> array<${jt}, 4> {
    var absS = abs(s);
    var coeffs: array<${jt}, 4> = array<${jt}, 4>(0.0, 0.0, 0.0, 0.0);
    var oneMinusAbsS: ${jt} = 1.0 - absS;
    var twoMinusAbsS: ${jt} = 2.0 - absS;
    var onePlusAbsS: ${jt} = 1.0 + absS;
    coeffs[0] = ((${vt} * onePlusAbsS - 5 * ${vt}) * onePlusAbsS + 8 * ${vt}) * onePlusAbsS - 4 * ${vt};
    coeffs[1] = ((${vt} + 2) * absS - (${vt} + 3)) * absS * absS + 1;
    coeffs[2] = ((${vt} + 2) * oneMinusAbsS - (${vt} + 3)) * oneMinusAbsS * oneMinusAbsS + 1;
    coeffs[3] = ((${vt} * twoMinusAbsS - 5 * ${vt}) * twoMinusAbsS + 8 * ${vt}) * twoMinusAbsS - 4 * ${vt};
    return coeffs;
  }

  fn cubicInterpolation1D(x: array<${jt}, 4>, coefs: array<${jt}, 4>) -> ${jt} {
    var coefsSum: ${jt} = coefs[0] + coefs[1] + coefs[2] + coefs[3];
    return (x[0] * coefs[0] + x[1] * coefs[1]+ x[2] * coefs[2]+ x[3] * coefs[3]) / coefsSum;
  }

  fn bicubicInterpolation(output_indices: ${g.type.indices}) -> ${jt} {
    var input_indices: ${d.type.indices} = output_indices;
    return colCubicInterpolation(input_indices, output_indices);
  }
    `},Bm=(d,g,b,et,st)=>{let[at,vt,Tt,Ct,pt]=b.length===3?[-1,0,1,2,-1]:[0,2,3,4,1],wt=d.type.value;return`
    fn getInputValue(batch: u32, channel: u32, depth:u32, height: u32, width: u32) -> ${wt} {
      var input_indices: ${d.type.indices};
      ${d.indicesSet("input_indices",vt,`max(0, min(depth, ${b[vt]} - 1))`)};
      ${d.indicesSet("input_indices",Tt,`max(0, min(height, ${b[Tt]} - 1))`)};
      ${d.indicesSet("input_indices",Ct,`max(0, min(width, ${b[Ct]} - 1))`)};
      ${ed(d,pt,at,3)}
      return ${d.getByIndices("input_indices")};
    }

    fn trilinearInterpolation(output_indices: ${g.type.indices}) -> ${wt} {
      var originalIndices = calculateOriginalIndicesFromOutputIndices(output_indices);
      var depth:${wt} = originalIndices[${vt}];
      var height:${wt} = originalIndices[${Tt}];
      var width:${wt} = originalIndices[${Ct}];
      ${et?`if (depth < 0 || depth > (${b[vt]} - 1) || height < 0 || height > (${b[Tt]} - 1) || width < 0 || (width > ${b[Ct]} - 1)) {
      return ${st};
        }`:""};

    depth = max(0, min(depth, ${b[vt]} - 1));
      height = max(0, min(height, ${b[Tt]} - 1));
      width = max(0, min(width, ${b[Ct]} - 1));
      var depth1: u32 = u32(depth);
      var height1: u32 = u32(height);
      var width1: u32 = u32(width);
      var depth2: u32 = u32(depth + 1);
      var height2: u32 = u32(height + 1);
      var width2: u32 = u32(width + 1);
      var channel: u32 = ${b.length>3?`u32(originalIndices[${pt}])`:"0"};
      var batch: u32 =  ${b.length>3?`u32(originalIndices[${at}])`:"0"};

      var x111: ${wt} = getInputValue(batch, channel, depth1, height1, width1);
      var x112: ${wt} = getInputValue(batch, channel, depth1, height1, width2);
      var x121: ${wt} = getInputValue(batch, channel, depth1, height2, width1);
      var x122: ${wt} = getInputValue(batch, channel, depth1, height2, width2);
      var x211: ${wt} = getInputValue(batch, channel, depth2, height1, width1);
      var x212: ${wt} = getInputValue(batch, channel, depth2, height1, width2);
      var x221: ${wt} = getInputValue(batch, channel, depth2, height2, width1);
      var x222: ${wt} = getInputValue(batch, channel, depth2, height2, width2);
      var dx1: ${wt} = abs(depth - ${wt}(depth1));
      var dx2: ${wt} = abs(${wt}(depth2) - depth);
      var dy1: ${wt} = abs(height - ${wt}(height1));
      var dy2: ${wt} = abs(${wt}(height2) - height);
      var dz1: ${wt} = abs(width - ${wt}(width1));
      var dz2: ${wt} = abs(${wt}(width2) - width);
      if (depth1 == depth2) {
        dx1 = 0.5;
        dx2 = 0.5;
      }
      if (height1 == height2) {
        dy1 = 0.5;
        dy2 = 0.5;
      }
      if (width1 == width2) {
        dz1 = 0.5;
        dz2 = 0.5;
      }
      return (x111 * dx2 * dy2 * dz2 + x112 * dx2 * dy2 * dz1 + x121 * dx2 * dy1 *dz2 + x122 * dx2 * dy1 * dz1 +
              x211 * dx1 * dy2 * dz2 + x212 * dx1 * dy2 * dz1 + x221 * dx1 * dy1 *dz2 + x222 * dx1 * dy1 * dz1);
    }`},Dm=(d,g,b,et,st,at)=>{let vt=d.dims,Tt=Tm(at,g.axes,vt.length),Ct=Am(vt,et,st,g.axes),pt=et.slice();et.length===0&&(pt=vt.map((Kt,rr)=>Kt===0?1:Ct[rr]/Kt),g.keepAspectRatioPolicy!=="stretch"&&(Ct=Em(vt,pt,g)));let wt=K("output",d.dataType,Ct.length),$t=U$1("input",d.dataType,vt.length),Lt=M$1.size(Ct),jt=vt.length===Ct.length&&vt.every((Kt,rr)=>Kt===Ct[rr]),Ft=g.coordinateTransformMode==="tf_crop_and_resize",Gt=g.extrapolationValue,Ht=$t.type.value,qt=Kt=>`
      ${jt?"":`
      ${Cm(g.coordinateTransformMode,Ht)};
      ${(()=>{switch(g.mode){case"nearest":return`
              ${Pm($t,vt)};
              ${Im(g.nearestMode,b,Ht)};
              ${Om($t,wt,vt,Ct,pt.length,Tt.length,Ft)};
              `;case"linear":return`
              ${km(wt,vt,Ct,pt.length,Tt.length)};
              ${(()=>{if(vt.length===2||vt.length===4)return`${Rm($t,wt,vt,Ft,Gt)}`;if(vt.length===3||vt.length===5)return`${Bm($t,wt,vt,Ft,Gt)}`;throw Error("Linear mode only supports input dims 2, 3, 4 and 5 are supported in linear mode.")})()};
            `;case"cubic":return`
            ${(()=>{if(vt.length===2||vt.length===4)return`${zm($t,wt,vt,Ct,pt,Tt,g.cubicCoeffA,Ft,g.extrapolationValue,g.excludeOutside)}`;throw Error("Cubic mode only supports input dims 2 and 4 are supported in linear mode.")})()};
            `;default:throw Error("Invalid resize mode")}})()};
      `}
      ${Kt.registerUniform("output_size","u32").registerUniform("scales","f32",pt.length).registerUniform("roi","f32",Tt.length).declareVariables($t,wt)}
      ${Kt.mainStart()}
        ${Kt.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.output_size")}
        ${jt?"output[global_idx] = input[global_idx];":`
        let output_indices = ${wt.offsetToIndices("global_idx")};
        var input_indices: ${$t.type.indices};
        ${(()=>{switch(g.mode){case"nearest":return`input_indices = calculateInputIndicesFromOutputIndices(output_indices);
                if (checkInputIndices(input_indices)) {
                  output[global_idx] = ${$t.getByIndices("input_indices")};
                } else {
                  output[global_idx] = ${g.extrapolationValue};
                }`;case"linear":return`output[global_idx] = ${vt.length===2||vt.length===4?"bilinearInterpolation":"trilinearInterpolation"}(output_indices);`;case"cubic":return"output[global_idx] = bicubicInterpolation(output_indices);";default:throw Error(`Unsupported resize mode: ${g.mode}`)}})()};
`}
      }`;return{name:"Resize",shaderCache:{hint:`${g.cacheKey}|${b}|${pt.length>0?pt:""}|${st.length>0?st:""}|${Tt.length>0?Tt:""}|${jt}|${vt}`,inputDependencies:["rank"]},getShaderSource:qt,getRunData:()=>({outputs:[{dims:Ct,dataType:d.dataType}],dispatchGroup:{x:Math.ceil(Lt/64)},programUniforms:[{type:12,data:Lt},{type:1,data:pt},{type:1,data:Tt},...X(vt,Ct)]})}},Mm=d=>{let g=d.customDataBuffer;return new Uint32Array(g,g.byteOffset,1)[0]},td=(d,g)=>{let b=[],et=[],st=[],at=Mm(d);if(g.antialias!==0)throw Error("Only default value (0) for Antialias attribute is supported");Sm(d.inputs,g,at,b,et,st),d.compute(Dm(d.inputs[0],g,at,b,et,st),{inputs:[0]})},rd=d=>{let g=d.antialias,b=d.axes,et=d.coordinateTransformMode,st=d.cubicCoeffA,at=d.excludeOutside!==0,vt=d.extrapolationValue,Tt=d.keepAspectRatioPolicy,Ct=d.mode,pt=d.nearestMode===""?"simple":d.nearestMode;return we({antialias:g,axes:b,coordinateTransformMode:et,cubicCoeffA:st,excludeOutside:at,extrapolationValue:vt,keepAspectRatioPolicy:Tt,mode:Ct,nearestMode:pt})}}),Um,Wm,id,od=j(()=>{ye(),xe(),Ze(),_e(),Um=(d,g)=>{let[b,et,st,at]=d,{numHeads:vt,rotaryEmbeddingDim:Tt}=g;if(b.dims.length!==3&&b.dims.length!==4)throw new Error(`Input 'x' is expected to have 3 or 4 dimensions, got ${b.dims.length}`);if(!M$1.areEqual(et.dims,[])&&!M$1.areEqual(et.dims,[1])&&et.dims.length!==2)throw new Error(`Input 'position_ids' is expected to have 0, 1, or 2 dimensions, got ${et.dims.length}`);if(st.dims.length!==2)throw new Error(`Input 'cos_cache' is expected to have 2 dimensions, got ${st.dims.length}`);if(at.dims.length!==2)throw new Error(`Input 'sin_cache' is expected to have 2 dimensions, got ${at.dims.length}`);if(!M$1.areEqual(st.dims,at.dims))throw new Error("Inputs 'cos_cache' and 'sin_cache' are expected to have the same shape");if(Tt>0&&vt===0)throw new Error("num_heads must be provided if rotary_embedding_dim is specified");let Ct=b.dims[0],pt=b.dims[b.dims.length-2],wt=st.dims[0],$t=M$1.sizeFromDimension(b.dims,1)/pt,Lt=Tt===0?st.dims[1]*2:$t/vt;if(Tt>Lt)throw new Error("rotary_embedding_dim must be less than or equal to head_size");if(et.dims.length===2){if(Ct!==et.dims[0])throw new Error(`Input 'position_ids' dimension 0 should be of size batch_size, got ${et.dims[0]}`);if(pt!==et.dims[1])throw new Error(`Input 'position_ids' dimension 1 should be of size sequence_length, got ${et.dims[1]}`)}if(Lt/2!==st.dims[1]&&Tt/2!==st.dims[1])throw new Error(`Input 'cos_cache' dimension 1 should be same as head_size / 2 or rotary_embedding_dim / 2, got ${st.dims[1]}`);if(pt>wt)throw new Error("Updating cos_cache and sin_cache in RotaryEmbedding is not currently supported")},Wm=(d,g)=>{let{interleaved:b,numHeads:et,rotaryEmbeddingDim:st,scale:at}=g,vt=d[0].dims[0],Tt=M$1.sizeFromDimension(d[0].dims,1),Ct=d[0].dims[d[0].dims.length-2],pt=Tt/Ct,wt=d[2].dims[1],$t=st===0?wt*2:pt/et,Lt=new Array(vt,Ct,pt/$t,$t-wt),jt=M$1.computeStrides(Lt),Ft=[{type:1,data:at},{type:12,data:Lt},{type:12,data:jt},...d[0].dims.length===3?new Array({type:12,data:[Tt,pt,$t,1]}):[],...d[0].dims.length===4?new Array({type:12,data:[Tt,$t,Ct*$t,1]}):[],...X(d[0].dims,d[1].dims,d[2].dims,d[3].dims,d[0].dims)],Gt=Ht=>{let qt=U$1("input",d[0].dataType,d[0].dims.length),Kt=U$1("position_ids",d[1].dataType,d[1].dims.length),rr=U$1("cos_cache",d[2].dataType,d[2].dims.length),ir=U$1("sin_cache",d[3].dataType,d[3].dims.length),or=K("output",d[0].dataType,d[0].dims.length);return Ht.registerUniforms([{name:"scale",type:"f32"},{name:"global_shape",type:"u32",length:Lt.length},{name:"global_strides",type:"u32",length:jt.length},{name:"input_output_strides",type:"u32",length:jt.length}]),`
        ${Ht.declareVariables(qt,Kt,rr,ir,or)}

        ${Ht.mainStart(mr)}
          let half_rotary_emb_dim = uniforms.${rr.name}_shape[1];
          let bsnh = global_idx / uniforms.global_strides % uniforms.global_shape;
          let size = uniforms.global_shape[0] * uniforms.global_strides[0];
          ${Ht.guardAgainstOutOfBoundsWorkgroupSizes("size")}

          if (bsnh[3] < half_rotary_emb_dim) {
            let position_ids_idx =
                ${Kt.broadcastedIndicesToOffset("bsnh.xy",K("",Kt.type.tensor,2))};
            let position_id =
                u32(${Kt.getByOffset("position_ids_idx")}) + select(0, bsnh[1], position_ids_idx == 0);
            let i = dot(bsnh, uniforms.input_output_strides) + select(0, bsnh[3], ${b});
            let j = i + select(half_rotary_emb_dim, 1, ${b});
            let re = ${qt.getByOffset("i")} * ${rr.get("position_id","bsnh[3]")} -
                ${qt.getByOffset("j")} * ${ir.get("position_id","bsnh[3]")};
            ${or.setByOffset("i","re")}
            let im = ${qt.getByOffset("i")} * ${ir.get("position_id","bsnh[3]")} +
                ${qt.getByOffset("j")} * ${rr.get("position_id","bsnh[3]")};
            ${or.setByOffset("j","im")}
          } else {
            let k = dot(bsnh, uniforms.input_output_strides) + half_rotary_emb_dim;
            ${or.setByOffset("k",qt.getByOffset("k"))}
          }
        }`};return{name:"RotaryEmbedding",shaderCache:{hint:we({interleaved:b}).cacheKey,inputDependencies:["rank","rank","rank","rank"]},getShaderSource:Gt,getRunData:()=>({outputs:[{dims:d[0].dims,dataType:d[0].dataType}],dispatchGroup:{x:Math.ceil(M$1.size(Lt)/mr)},programUniforms:Ft})}},id=(d,g)=>{Um(d.inputs,g),d.compute(Wm(d.inputs,g))}}),Nm,Vm,ad,sd=j(()=>{ye(),xe(),_e(),Nm=d=>{if(!d||d.length<3)throw new Error("layerNorm requires at least 3 inputs.");let g=d[0],b=d[1],et=d[2];if(g.dataType!==b.dataType||g.dataType!==et.dataType)throw new Error("All inputs must have the same data type");if(g.dims.length!==3&&g.dims.length!==2)throw new Error("Input must be 2D or 3D");if(b.dims.length!==3&&b.dims.length!==2)throw new Error("Skip must be 2D or 3D");let st=g.dims[g.dims.length-1],at=g.dims[g.dims.length-2];if(b.dims[b.dims.length-1]!==st)throw new Error("Skip must have the same hidden size as input");if(b.dims[b.dims.length-2]!==at)throw new Error("Skip must have the same sequence length as input");if(et.dims.length!==1)throw new Error("Gamma must be 1D");if(et.dims[et.dims.length-1]!==st)throw new Error("Gamma must have the same hidden size as input");if(d.length>3){let vt=d[3];if(vt.dims.length!==1)throw new Error("Beta must be 1D");if(vt.dims[vt.dims.length-1]!==st)throw new Error("Beta must have the same hidden size as input")}if(d.length>4){let vt=d[4];if(vt.dims.length!==1)throw new Error("Bias must be 1D");if(vt.dims[vt.dims.length-1]!==st)throw new Error("Bias must have the same hidden size as input")}},Vm=(d,g,b,et)=>{let st=g.simplified,at=d[0].dims,vt=M$1.size(at),Tt=at,Ct=vt,pt=at.slice(-1)[0],wt=et?at.slice(0,-1).concat(1):[],$t=!st&&d.length>3,Lt=d.length>4,jt=et&&b>1,Ft=et&&b>2,Gt=b>3,Ht=Ue(pt),qt=[{type:12,data:Ct},{type:12,data:Ht},{type:12,data:pt},{type:1,data:g.epsilon}],Kt=ir=>{let or=[{name:"output_size",type:"u32"},{name:"components",type:"u32"},{name:"hidden_size",type:"u32"},{name:"epsilon",type:"f32"}],jr=[U$1("x",d[0].dataType,d[0].dims,Ht),U$1("skip",d[1].dataType,d[1].dims,Ht),U$1("gamma",d[2].dataType,d[2].dims,Ht)];$t&&jr.push(U$1("beta",d[3].dataType,d[3].dims,Ht)),Lt&&jr.push(U$1("bias",d[4].dataType,d[4].dims,Ht)),jr.push(K("output",d[0].dataType,Tt,Ht)),jt&&jr.push(K("mean_output",1,wt)),Ft&&jr.push(K("inv_std_output",1,wt)),Gt&&jr.push(K("input_skip_bias_sum",d[0].dataType,Tt,Ht));let qr=De(d[0].dataType);return`

      ${ir.registerUniforms(or).declareVariables(...jr)}

      ${ir.mainStart()}
        ${ir.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.output_size / uniforms.hidden_size")}
        let hidden_size_vectorized: u32 = uniforms.hidden_size / uniforms.components;
        let offset = global_idx * hidden_size_vectorized;
        var sum = ${At("f32",Ht)};
        var squareSum = ${At("f32",Ht)};
        for (var i: u32 = 0; i < hidden_size_vectorized; i++) {
          let skip_value = skip[offset + i];
          let bias_value = ${Lt?"bias[i]":qr+"(0.0)"};
          let input_value = x[offset + i];
          let value = input_value + skip_value + bias_value;
          ${Gt?"input_skip_bias_sum[offset + i] = value;":""}
          output[offset + i] = value;
          let f32_value = ${fr(qr,Ht,"value")};
          sum += f32_value;
          squareSum += f32_value * f32_value;
        }
        let mean = ${Et("sum",Ht)} / f32(uniforms.hidden_size);
        let inv_std_dev = inverseSqrt(${Et("squareSum",Ht)} / f32(uniforms.hidden_size) ${st?"":"- mean * mean"} + uniforms.epsilon);
        ${jt?"mean_output[global_idx] = mean;":""}
        ${Ft?"inv_std_output[global_idx] = inv_std_dev;":""}
        for (var i: u32 = 0; i < hidden_size_vectorized; i++) {
          output[offset + i] = (output[offset + i] ${st?"":`- ${qr}(mean)`}) * ${qr}(inv_std_dev) * gamma[i] ${$t?"+ beta[i]":""};
        }
      }`},rr=[{dims:Tt,dataType:d[0].dataType}];return b>1&&rr.push({dims:wt,dataType:1}),b>2&&rr.push({dims:wt,dataType:1}),b>3&&rr.push({dims:at,dataType:d[0].dataType}),{name:"SkipLayerNormalization",shaderCache:{hint:`${Ht};${jt};${Ft};${Gt}`,inputDependencies:d.map((ir,or)=>"type")},getShaderSource:Kt,getRunData:()=>({outputs:rr,dispatchGroup:{x:Math.ceil(Ct/pt/64)},programUniforms:qt})}},ad=(d,g)=>{Nm(d.inputs);let b=[0];d.outputCount>1&&b.push(-3),d.outputCount>2&&b.push(-3),d.outputCount>3&&b.push(3),d.compute(Vm(d.inputs,g,d.outputCount,!1),{outputs:b})}}),Hm,ui,Gm,ud,Lm,Fm,ld,dd,cd=j(()=>{ye(),xe(),Ze(),_e(),Hm=(d,g)=>{if(!d||d.length<1)throw new Error("too few inputs");if(g.axes.length!==0){if(g.axes.length!==g.starts.length||g.axes.length!==g.ends.length)throw new Error("axes, starts and ends must have the same length")}else if(g.starts.length!==g.ends.length)throw new Error("starts and ends must have the same length");d.slice(1).forEach((b,et)=>{if(d[et+1].dataType!==6&&d[et+1].dataType!==7)throw new Error(`Input ${et} must be an array of int32 or int64`)})},ui=(d,g)=>{let b=[];if(d.length>g)if(d[g].dataType===7)d[g].getBigInt64Array().forEach(et=>b.push(Number(et)));else if(d[g].dataType===6)d[g].getInt32Array().forEach(et=>b.push(Number(et)));else throw new Error(`Input ${g} must be an array of int32 or int64`);return b},Gm=(d,g)=>{if(d.length>1){let b=ui(d,1),et=ui(d,2),st=ui(d,3);return st.length===0&&(st=[...Array(d[0].dims.length).keys()]),we({starts:b,ends:et,axes:st})}else return g},ud=(d,g,b,et,st)=>{let at=d;return d<0&&(at+=b[et[g]]),st[g]<0?Math.max(0,Math.min(at,b[et[g]]-1)):Math.max(0,Math.min(at,b[et[g]]))},Lm=(d,g,b)=>`fn calculateInputIndices(output_indices: ${g.type.indices}) -> ${d.type.indices} {
          var input_indices: ${d.type.indices};
          var carry = 0u;
          for (var i = ${b.length}; i >= 0; i--) {
            let input_shape_i = ${fe("uniforms.input_shape","i",b.length)};
            let steps_i = ${fe("uniforms.steps","i",b.length)};
            let signs_i = ${fe("uniforms.signs","i",b.length)};
            let starts_i = ${fe("uniforms.starts","i",b.length)};
            var output_index = ${g.indicesGet("output_indices","i")};
            var input_index = output_index * steps_i + starts_i + carry;
            carry = input_index / input_shape_i;
            input_index = input_index % input_shape_i;
            if (signs_i < 0) {
              input_index = input_shape_i - input_index - 1u + starts_i;
            }
            ${d.indicesSet("input_indices","i","input_index")};
          }
          return input_indices;
      }`,Fm=(d,g)=>{let b=d[0].dims,et=M$1.size(b),st=g.axes.length>0?M$1.normalizeAxes(g.axes,b.length):[...Array(b.length).keys()],at=ui(d,4);at.forEach(qt=>qt!==0||(()=>{throw new Error("step cannot be 0")})),at.length===0&&(at=Array(st.length).fill(1));let vt=g.starts.map((qt,Kt)=>ud(qt,Kt,b,st,at)),Tt=g.ends.map((qt,Kt)=>ud(qt,Kt,b,st,at));if(st.length!==vt.length||st.length!==Tt.length)throw new Error("start, ends and axes should have the same number of elements");if(st.length!==b.length)for(let qt=0;qt<b.length;++qt)st.includes(qt)||(vt.splice(qt,0,0),Tt.splice(qt,0,b[qt]),at.splice(qt,0,1));let Ct=at.map(qt=>Math.sign(qt));at.forEach((qt,Kt,rr)=>{if(qt<0){let ir=(Tt[Kt]-vt[Kt])/qt,or=vt[Kt],jr=or+ir*at[Kt];vt[Kt]=jr,Tt[Kt]=or,rr[Kt]=-qt}});let pt=b.slice(0);st.forEach((qt,Kt)=>{pt[qt]=Math.ceil((Tt[qt]-vt[qt])/at[qt])});let wt={dims:pt,dataType:d[0].dataType},$t=K("output",d[0].dataType,pt.length),Lt=U$1("input",d[0].dataType,d[0].dims.length),jt=M$1.size(pt),Ft=[{name:"outputSize",type:"u32"},{name:"starts",type:"u32",length:vt.length},{name:"signs",type:"i32",length:Ct.length},{name:"steps",type:"u32",length:at.length}],Gt=[{type:12,data:jt},{type:12,data:vt},{type:6,data:Ct},{type:12,data:at},...X(d[0].dims,pt)],Ht=qt=>`
      ${qt.registerUniforms(Ft).declareVariables(Lt,$t)}
        ${Lm(Lt,$t,b)}
        ${qt.mainStart()}
          ${qt.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.outputSize")}
          let output_indices = ${$t.offsetToIndices("global_idx")};
          let input_indices = calculateInputIndices(output_indices);
          ${$t.setByOffset("global_idx",Lt.getByIndices("input_indices"))}
      }`;return{name:"Slice",shaderCache:{hint:`${Ct.length}_${vt.length}_${at.length}`,inputDependencies:["rank"]},getShaderSource:Ht,getRunData:()=>({outputs:[wt],dispatchGroup:{x:Math.ceil(et/64)},programUniforms:Gt})}},ld=(d,g)=>{Hm(d.inputs,g);let b=Gm(d.inputs,g);d.compute(Fm(d.inputs,b),{inputs:[0]})},dd=d=>{let g=d.starts,b=d.ends,et=d.axes;return we({starts:g,ends:b,axes:et})}}),qm,jm,pd,md,fd=j(()=>{ye(),xe(),Ze(),_e(),qm=d=>{if(!d||d.length!==1)throw new Error("Softmax op requires 1 input.")},jm=(d,g)=>{let b=d.dims,et=M$1.size(b),st=64,at=g.axis;if(at<0&&(at=b.length+at),at<b.length-1)throw new Error("softmax only supports last axis for now.");let vt=b[at],Tt=et/vt,Ct=Ue(vt),pt=vt/Ct,wt=(Ht,qt)=>qt===4?`max(max(${Ht}.x, ${Ht}.y), max(${Ht}.z, ${Ht}.w))`:qt===2?`max(${Ht}.x, ${Ht}.y)`:qt===3?`max(max(${Ht}.x, ${Ht}.y), ${Ht}.z)`:Ht,$t=U$1("x",d.dataType,d.dims,Ct),Lt=K("result",d.dataType,d.dims,Ct),jt=$t.type.value,Ft=De(d.dataType)==="f32"?`var threadMax = ${jt}(-3.402823e+38f);`:`var threadMax = ${jt}(-65504.0h);`,Gt=Ht=>`
      var<workgroup> rowMaxShared : ${jt};
      var<workgroup> rowSumShared : ${jt};
      var<workgroup> threadShared : array<${jt}, ${st}>;

      fn getValue(row: i32, col: i32, row_stride: i32) -> ${jt} {
        let index = row * row_stride + col;
        return x[index];
      }

      fn setValue(row: i32, col: i32, row_stride: i32, value: ${jt}) {
        let index = row * row_stride + col;
        result[index] = value;
      }
      ${Ht.registerUniform("packedCols","i32").declareVariables($t,Lt)}
      ${Ht.mainStart()}
        let gindex = i32(global_idx);
        let lindex = i32(local_idx);
        const wg = ${st};
        let row = gindex / wg;
        let cols = uniforms.packedCols;
        let row_stride : i32 = uniforms.packedCols;

        // find the rows max
        ${Ft}
        for (var col = lindex; col < cols; col += wg) {
          let value = getValue(row, col, row_stride);
          threadMax = max(threadMax, value);
        }
        if (lindex < cols) {
          threadShared[lindex] = threadMax;
        }
        workgroupBarrier();

        var reduceSize = min(cols, wg);
        for (var currSize = reduceSize >> 1;  currSize > 0; currSize = reduceSize >> 1) {
          reduceSize = currSize + (reduceSize & 1);
          if (lindex < currSize) {
            threadShared[lindex] = max(threadShared[lindex], threadShared[lindex + reduceSize]);
          }
          workgroupBarrier();
        }
        if (lindex == 0) {
          rowMaxShared = ${jt}(${wt("threadShared[0]",Ct)});
        }
        workgroupBarrier();

        // find the rows sum
        var threadSum = ${jt}(0.0);
        for (var col = lindex; col < cols; col += wg) {
          let subExp = exp(getValue(row, col, row_stride) - rowMaxShared);
          threadSum += subExp;
        }
        threadShared[lindex] = threadSum;
        workgroupBarrier();

        for (var currSize = wg >> 1;  currSize > 0; currSize = currSize >> 1) {
          if (lindex < currSize) {
            threadShared[lindex] = threadShared[lindex] + threadShared[lindex + currSize];
          }
          workgroupBarrier();
        }
        if (lindex == 0) {
          rowSumShared = ${jt}(${Et("threadShared[0]",Ct)});
        }
        workgroupBarrier();

        // calculate final value for each element in the row
        for (var col = lindex; col < cols; col += wg) {
          let value = exp(getValue(row, col, row_stride) - rowMaxShared) / rowSumShared;
          setValue(row, col, row_stride, value);
        }
      }`;return{name:"Softmax",shaderCache:{hint:`${Ct}`,inputDependencies:["type"]},getRunData:()=>({outputs:[{dims:b,dataType:d.dataType}],dispatchGroup:{x:Tt},programUniforms:[{type:6,data:pt}]}),getShaderSource:Gt}},pd=(d,g)=>{qm(d.inputs),d.compute(jm(d.inputs[0],g))},md=d=>we({axis:d.axis})}),Km,Ym,Xm,Zm,Qm,hd,gd,yd=j(()=>{ye(),xe(),Ze(),_e(),Km=d=>{if(!d||d.length<1)throw new Error("too few inputs")},Ym=(d,g)=>{let b=[],et=g.numOutputs;return d[1].dims[0]>0&&(d[1].getBigInt64Array().forEach(st=>b.push(Number(st))),et=b.length),we({numOutputs:et,axis:g.axis,splitSizes:b})},Xm=d=>`
fn calculateOutputIndex(index: u32) -> u32 {
    for (var i: u32 = 0u; i < ${d}u; i += 1u ) {
    if (index < ${fe("uniforms.size_in_split_axis","i",d)}) {
        return i;
    }
    }
    return ${d}u;
}`,Zm=d=>{let g=d.length,b=[];for(let et=0;et<g;++et){let st=d[et].setByIndices("indices","input[global_idx]");g===1?b.push(st):et===0?b.push(`if (output_number == ${et}u) { ${st} }`):et===g-1?b.push(`else { ${st} }`):b.push(`else if (output_number == ${et}) { ${st} }`)}return`
      fn writeBufferData(output_number: u32, indices: ${d[0].type.indices}, global_idx: u32) {
        ${b.join(`
`)}
      }`},Qm=(d,g)=>{let b=d[0].dims,et=M$1.size(b),st=d[0].dataType,at=M$1.normalizeAxis(g.axis,b.length),vt=new Array(g.numOutputs),Tt=U$1("input",st,b.length),Ct=new Array(g.numOutputs),pt=[],wt=[],$t=0,Lt=[{type:12,data:et}];for(let Ft=0;Ft<g.numOutputs;Ft++){$t+=g.splitSizes[Ft],Ct[Ft]=$t;let Gt=b.slice();Gt[g.axis]=g.splitSizes[Ft],wt.push(Gt),vt[Ft]=K(`output${Ft}`,st,Gt.length),pt.push({dims:wt[Ft],dataType:d[0].dataType})}Lt.push({type:12,data:Ct},...X(b,...wt));let jt=Ft=>`
  ${Ft.registerUniform("input_size","u32").registerUniform("size_in_split_axis","u32",Ct.length).declareVariables(Tt,...vt)}
  ${Xm(Ct.length)}
  ${Zm(vt)}

  ${Ft.mainStart()}
    ${Ft.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.input_size")}

    var indices = ${Tt.offsetToIndices("global_idx")};
    var index = ${Tt.indicesGet("indices",at)};
    let output_number = calculateOutputIndex(index);
    if (output_number != 0) {
      index -= ${fe("uniforms.size_in_split_axis","output_number - 1u",Ct.length)};
      ${Tt.indicesSet("indices",at,"index")};
    }
    writeBufferData(output_number, indices, global_idx);
  }`;return{name:"Split",shaderCache:{hint:g.cacheKey,inputDependencies:["rank"]},getShaderSource:jt,getRunData:()=>({outputs:pt,dispatchGroup:{x:Math.ceil(et/64)},programUniforms:Lt})}},hd=(d,g)=>{Km(d.inputs);let b=d.inputs.length===1?g:Ym(d.inputs,g);d.compute(Qm(d.inputs,b),{inputs:[0]})},gd=d=>{let g=d.axis,b=d.splitSizes,et=d.numOutputs<0?b.length:d.numOutputs;if(et!==b.length)throw new Error("numOutputs and splitSizes lengh must be equal");return we({axis:g,numOutputs:et,splitSizes:b})}}),bd,Jm,ef,tf,vd,wd=j(()=>{ye(),xe(),_e(),bd=d=>Array.from(d.getBigInt64Array(),Number),Jm=d=>{if(!d||d.length!==2)throw new Error("Tile requires 2 inputs.");if(d[0].dataType!==1&&d[0].dataType!==6&&d[0].dataType!==12)throw new Error("Tile only support float, int32, and uint32 data types");if(d[1].dataType!==7)throw new Error("Tile `repeats` input should be of int64 data type");if(d[1].dims.length!==1)throw new Error("Tile `repeats` input should be 1-D");if(bd(d[1]).length!==d[0].dims.length)throw new Error("Tile `repeats` input should have same number of elements as rank of input data tensor")},ef=(d,g)=>{let b=[];for(let et=0;et<d.length;++et)b.push(d[et]*g[et]);return b},tf=d=>{let g=d[0].dims,b=bd(d[1]),et=ef(g,b),st=M$1.size(et),at=d[0].dataType,vt=U$1("input",at,g.length),Tt=K("output",at,et.length),Ct=pt=>`
      const inputShape = ${vt.indices(...g)};
      ${pt.registerUniform("output_size","u32").declareVariables(vt,Tt)}
      ${pt.mainStart()}
      ${pt.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.output_size")}
      let output_indices = ${Tt.offsetToIndices("global_idx")};
      var input_indices: ${vt.type.indices};
      for (var i = 0; i < ${g.length}; i++) {
        let input_dim_i = ${vt.indicesGet("uniforms.input_shape","i")};
        let input_dim_value = ${Tt.indicesGet("output_indices","i")}  % input_dim_i;

        ${vt.indicesSet("input_indices","i","input_dim_value")}
      }
      ${Tt.setByOffset("global_idx",vt.getByIndices("input_indices"))}
    }`;return{name:"Tile",shaderCache:{hint:`${b}`,inputDependencies:["rank"]},getRunData:()=>({outputs:[{dims:et,dataType:d[0].dataType}],dispatchGroup:{x:Math.ceil(st/64)},programUniforms:[{type:12,data:st},...X(d[0].dims,et)]}),getShaderSource:Ct}},vd=d=>{Jm(d.inputs),d.compute(tf(d.inputs),{inputs:[0]})}}),rf,nf,$d,_d=j(()=>{ye(),xe(),_e(),rf=(d,g,b,et,st)=>{let at=K("output_data",st,b.length,4),vt=U$1("a_data",g[1].dataType,g[1].dims.length,4),Tt=U$1("b_data",g[2].dataType,g[2].dims.length,4),Ct=U$1("c_data",g[0].dataType,g[0].dims.length,4),pt,wt=($t,Lt,jt)=>`select(${Lt}, ${$t}, ${jt})`;if(!et)pt=at.setByOffset("global_idx",wt(vt.getByOffset("global_idx"),Tt.getByOffset("global_idx"),Ct.getByOffset("global_idx")));else{let $t=(Lt,jt,Ft="")=>{let Gt=`a_data[index_a${jt}][component_a${jt}]`,Ht=`b_data[index_b${jt}][component_b${jt}]`,qt=`bool(c_data[index_c${jt}] & (0xffu << (component_c${jt} * 8)))`;return`
            let output_indices${jt} = ${at.offsetToIndices(`global_idx * 4u + ${jt}u`)};
            let offset_a${jt} = ${vt.broadcastedIndicesToOffset(`output_indices${jt}`,at)};
            let offset_b${jt} = ${Tt.broadcastedIndicesToOffset(`output_indices${jt}`,at)};
            let offset_c${jt} = ${Ct.broadcastedIndicesToOffset(`output_indices${jt}`,at)};
            let index_a${jt} = offset_a${jt} / 4u;
            let index_b${jt} = offset_b${jt} / 4u;
            let index_c${jt} = offset_c${jt} / 4u;
            let component_a${jt} = offset_a${jt} % 4u;
            let component_b${jt} = offset_b${jt} % 4u;
            let component_c${jt} = offset_c${jt} % 4u;
            ${Lt}[${jt}] = ${Ft}(${wt(Gt,Ht,qt)});
          `};st===9?pt=`
            var data = vec4<u32>(0);
            ${$t("data",0,"u32")}
            ${$t("data",1,"u32")}
            ${$t("data",2,"u32")}
            ${$t("data",3,"u32")}
            output_data[global_idx] = dot(vec4<u32>(0x1, 0x100, 0x10000, 0x1000000), vec4<u32>(data));`:pt=`
            ${$t("output_data[global_idx]",0)}
            ${$t("output_data[global_idx]",1)}
            ${$t("output_data[global_idx]",2)}
            ${$t("output_data[global_idx]",3)}
          `}return`
        ${d.registerUniform("vec_size","u32").declareVariables(Ct,vt,Tt,at)}
        ${d.mainStart()}
        ${d.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.vec_size")}
        ${pt}
      }`},nf=d=>{let g=d[1].dims,b=d[2].dims,et=d[0].dims,st=d[1].dataType,at=!(M$1.areEqual(g,b)&&M$1.areEqual(b,et)),vt=g,Tt=M$1.size(g);if(at){let pt=zt.calcShape(zt.calcShape(g,b,!1),et,!1);if(!pt)throw new Error("Can't perform where op on the given tensors");vt=pt,Tt=M$1.size(vt)}let Ct=Math.ceil(Tt/4);return{name:"Where",shaderCache:{inputDependencies:["rank","rank","rank"]},getShaderSource:pt=>rf(pt,d,vt,at,st),getRunData:()=>({outputs:[{dims:vt,dataType:st}],dispatchGroup:{x:Math.ceil(Tt/64/4)},programUniforms:[{type:12,data:Ct},...X(et,g,b,vt)]})}},$d=d=>{d.compute(nf(d.inputs))}}),xd,Sd=j(()=>{zs(),oo(),Ws(),Vs(),Cu(),Du(),io(),co(),Xu(),Ju(),rl(),sl(),dl(),pl(),hl(),bl(),$l(),xl(),Cl(),mo(),Al(),Pl(),zl(),Zl(),Jl(),jn(),nd(),od(),sd(),cd(),fd(),yd(),wd(),Rr(),Jn(),_d(),xd=new Map([["Abs",[Hs]],["Acos",[Gs]],["Acosh",[Ls]],["Add",[Iu]],["ArgMax",[Rs,no]],["ArgMin",[Ps,no]],["Asin",[Fs]],["Asinh",[qs]],["Atan",[js]],["Atanh",[Ks]],["Attention",[Ms]],["AveragePool",[Hl,Vl]],["BatchNormalization",[Us]],["BiasAdd",[Ns]],["BiasSplitGelu",[Su]],["Cast",[Xs,Ys]],["Ceil",[Qs]],["Clip",[Zs]],["Concat",[Bs,Ds]],["Conv",[go,ho]],["ConvTranspose",[Yu,Ku]],["Cos",[Js]],["Cosh",[eu]],["CumSum",[Zu,Qu]],["DepthToSpace",[el,tl]],["Div",[Tu]],["Einsum",[ol,al]],["Elu",[tu,Zn]],["Equal",[Au]],["Erf",[ru]],["Exp",[nu]],["Expand",[ll]],["FastGelu",[cl]],["Floor",[iu]],["FusedConv",[go,ho]],["Gather",[fl,ml]],["GatherElements",[yl,gl]],["Gelu",[ou]],["Gemm",[wl,vl]],["GlobalAveragePool",[Fl,Ll]],["GlobalMaxPool",[Xl,Yl]],["Greater",[Pu]],["GreaterOrEqual",[zu]],["HardSigmoid",[mu,pu]],["InstanceNormalization",[_l]],["LayerNormalization",[Sl]],["LeakyRelu",[au,Zn]],["Less",[Ru]],["LessOrEqual",[Bu]],["Log",[_u]],["MatMul",[Hu]],["MatMulNBits",[Il,Tl]],["MaxPool",[jl,Kl]],["Mul",[Eu]],["MultiHeadAttention",[Ol,kl]],["Neg",[uu]],["Not",[su]],["Pad",[Rl]],["Pow",[ku]],["Range",[Ql]],["Reciprocal",[lu]],["ReduceMin",[Is]],["ReduceMean",[$s]],["ReduceMax",[Cs]],["ReduceSum",[As]],["ReduceProd",[Ts]],["ReduceL1",[_s]],["ReduceL2",[xs]],["ReduceLogSum",[ks]],["ReduceLogSumExp",[Ss]],["ReduceSumSquare",[Es]],["Relu",[du]],["Resize",[td,rd]],["RotaryEmbedding",[id]],["Sigmoid",[cu]],["Sin",[fu]],["Sinh",[hu]],["Slice",[ld,dd]],["SkipLayerNormalization",[ad]],["Split",[hd,gd]],["Sqrt",[gu]],["Softmax",[pd,md]],["Sub",[Ou]],["Tan",[yu]],["Tanh",[vu]],["ThresholdedRelu",[$u,Zn]],["Tile",[vd]],["Transpose",[us,ls]],["Where",[$d]]])}),li,Cd=j(()=>{_t(),Xt(),_e(),li=class{constructor(d){this.backend=d,this.repo=new Map,this.attributesBound=!1}getArtifact(d){return this.repo.get(d)}setArtifact(d,g){this.repo.set(d,g)}run(d,g,b,et,st){yt(d.programInfo.name);let at=this.backend.device,vt=this.backend.getComputePassEncoder();this.backend.writeTimestamp(this.backend.pendingDispatchNumber*2);let Tt=[];for(let pt of g)Tt.push({binding:Tt.length,resource:{buffer:pt.buffer}});for(let pt of b)Tt.push({binding:Tt.length,resource:{buffer:pt.buffer}});st&&Tt.push({binding:Tt.length,resource:st});let Ct=at.createBindGroup({layout:d.computePipeline.getBindGroupLayout(0),entries:Tt,label:d.programInfo.name});if(this.backend.sessionStatus==="capturing"){let pt={kernelId:this.backend.currentKernelId,computePipeline:d.computePipeline,bindGroup:Ct,dispatchGroup:et};this.backend.capturedCommandList.get(this.backend.currentSessionId).push(pt)}vt.setPipeline(d.computePipeline),vt.setBindGroup(0,Ct),vt.dispatchWorkgroups(...et),this.backend.writeTimestamp(this.backend.pendingDispatchNumber*2+1),this.backend.pendingDispatchNumber++,(this.backend.pendingDispatchNumber>=this.backend.maxDispatchNumber||this.backend.queryType==="at-passes")&&this.backend.endComputePass(),this.backend.pendingDispatchNumber>=this.backend.maxDispatchNumber&&this.backend.flush(),ut(d.programInfo.name)}dispose(){}build(d,g){yt(d.name);let b=this.backend.device,et=[];b.features.has("shader-f16")&&et.push("enable f16;");let st=as(g,this.backend.device.limits),at=d.getShaderSource(st),vt=`${et.join(`
`)}
${st.additionalImplementations}
${at}`,Tt=b.createShaderModule({code:vt,label:d.name});Ne("verbose",()=>`[WebGPU] ${d.name} shader code: ${vt}`);let Ct=b.createComputePipeline({compute:{module:Tt,entryPoint:"main"},layout:"auto",label:d.name});return ut(d.name),{programInfo:d,computePipeline:Ct,uniformVariablesInfo:st.variablesInfo}}normalizeDispatchGroupSize(d){let g=typeof d=="number"?d:d.x,b=typeof d=="number"?1:d.y||1,et=typeof d=="number"?1:d.z||1,st=this.backend.device.limits.maxComputeWorkgroupsPerDimension;if(g<=st&&b<=st&&et<=st)return[g,b,et];let at=g*b*et,vt=Math.ceil(Math.sqrt(at));if(vt>st){if(vt=Math.ceil(Math.cbrt(at)),vt>st)throw new Error("Total dispatch size exceeds WebGPU maximum.");return[vt,vt,vt]}else return[vt,vt,1]}}}),of,af,_o,di,Id=j(()=>{_t(),ye(),Xt(),es(),os(),Sd(),Cd(),of=(d,g)=>{if(g.length!==d.length)throw new Error(`inputDependencies length ${g.length} is not equal to inputTensors length ${d.length}.`);let b=[];for(let et=0;et<d.length;++et){let st=d[et].dataType;switch(g[et]){case"none":{b.push("");break}case"type":{b.push(`${st}`);break}case"rank":{let at=d[et].dims.length;b.push(`${st};${at}`);break}case"dims":{let at=d[et].dims.join(",");b.push(`${st};${at}`);break}default:throw new Error(`unsupported input dependency: ${g[et]}`)}}return b.join("|")},af=(d,g,b)=>{var st,at;let et=d.name;return(st=d.shaderCache)!=null&&st.hint&&(et+="["+d.shaderCache.hint+"]"),et+=":"+b+`:${of(g,((at=d.shaderCache)==null?void 0:at.inputDependencies)??new Array(g.length).fill("dims"))}`,et},_o=class{constructor(d){d&&(this.architecture=d.architecture,this.vendor=d.vendor)}isArchitecture(d){return this.architecture===d}isVendor(d){return this.vendor===d}},di=class{constructor(){this.currentSessionId=null,this.currentKernelId=null,this.commandEncoder=null,this.computePassEncoder=null,this.maxDispatchNumber=16,this.pendingDispatchNumber=0,this.pendingKernels=[],this.pendingQueries=new Map,this.sessionStatus="default",this.capturedCommandList=new Map,this.capturedPendingKernels=new Map,this.sessionExternalDataMapping=new Map}get currentKernelCustomData(){if(this.currentKernelId===null)throw new Error("currentKernelCustomData(): currentKernelId is null. (should not happen)");let d=this.kernelCustomData.get(this.currentKernelId);return d||(d={},this.kernelCustomData.set(this.currentKernelId,d)),d}async initialize(d,g){this.env=d;let b=[],et={requiredLimits:{maxComputeWorkgroupStorageSize:g.limits.maxComputeWorkgroupStorageSize,maxComputeWorkgroupsPerDimension:g.limits.maxComputeWorkgroupsPerDimension,maxStorageBufferBindingSize:g.limits.maxStorageBufferBindingSize,maxBufferSize:g.limits.maxBufferSize,maxComputeInvocationsPerWorkgroup:g.limits.maxComputeInvocationsPerWorkgroup,maxComputeWorkgroupSizeX:g.limits.maxComputeWorkgroupSizeX,maxComputeWorkgroupSizeY:g.limits.maxComputeWorkgroupSizeY,maxComputeWorkgroupSizeZ:g.limits.maxComputeWorkgroupSizeZ},requiredFeatures:b};g.features.has("chromium-experimental-timestamp-query-inside-passes")?b.push("chromium-experimental-timestamp-query-inside-passes"):g.features.has("timestamp-query")&&b.push("timestamp-query"),g.features.has("shader-f16")&&b.push("shader-f16"),this.device=await g.requestDevice(et),this.adapterInfo=new _o(await g.requestAdapterInfo()),this.gpuDataManager=is(this),this.programManager=new li(this),this.kernels=new Map,this.kernelPersistentData=new Map,this.kernelCustomData=new Map,Qa(d.logLevel,!!d.debug),this.device.onuncapturederror=st=>{st.error instanceof GPUValidationError&&console.error(`An uncaught WebGPU validation error was raised: ${st.error.message}`)},Object.defineProperty(this.env.webgpu,"device",{value:this.device,writable:!1,enumerable:!0,configurable:!1}),Object.defineProperty(this.env.webgpu,"adapter",{value:g,writable:!1,enumerable:!0,configurable:!1}),this.setQueryType()}dispose(){typeof this.querySet<"u"&&this.querySet.destroy(),this.gpuDataManager.dispose()}getCommandEncoder(){return this.commandEncoder||(this.commandEncoder=this.device.createCommandEncoder()),this.commandEncoder}getComputePassEncoder(){if(!this.computePassEncoder){let d=this.getCommandEncoder(),g={};this.queryType==="at-passes"&&(g.timestampWrites={querySet:this.querySet,beginningOfPassWriteIndex:this.pendingDispatchNumber*2,endOfPassWriteIndex:this.pendingDispatchNumber*2+1}),this.computePassEncoder=d.beginComputePass(g)}return this.computePassEncoder}endComputePass(){this.computePassEncoder&&(this.computePassEncoder.end(),this.computePassEncoder=null)}flush(){if(!this.commandEncoder)return;yt(),this.endComputePass();let d;this.queryType!=="none"&&(this.commandEncoder.resolveQuerySet(this.querySet,0,this.pendingDispatchNumber*2,this.queryResolveBuffer,0),d=this.device.createBuffer({size:this.pendingDispatchNumber*2*8,usage:GPUBufferUsage.MAP_READ|GPUBufferUsage.COPY_DST}),this.pendingQueries.set(d,this.pendingKernels),this.pendingKernels=[],this.commandEncoder.copyBufferToBuffer(this.queryResolveBuffer,0,d,0,this.pendingDispatchNumber*2*8)),this.device.queue.submit([this.commandEncoder.finish()]),this.gpuDataManager.refreshPendingBuffers(),this.commandEncoder=null,this.pendingDispatchNumber=0,this.queryType!=="none"&&d.mapAsync(GPUMapMode.READ).then(()=>{var et;let g=new BigUint64Array(d.getMappedRange()),b=this.pendingQueries.get(d);for(let st=0;st<g.length/2;st++){let at=b[st],vt=at.kernelId,Tt=this.kernels.get(vt),Ct=Tt.kernelType,pt=Tt.kernelName,wt=at.programName,$t=at.inputTensorViews,Lt=at.outputTensorViews,jt=g[st*2],Ft=g[st*2+1];typeof this.queryTimeBase>"u"&&(this.queryTimeBase=jt);let Gt=Number(jt-this.queryTimeBase),Ht=Number(Ft-this.queryTimeBase);if(!Number.isSafeInteger(Gt)||!Number.isSafeInteger(Ht))throw new RangeError("incorrect timestamp range");if((et=this.env.webgpu.profiling)!=null&&et.ondata)this.env.webgpu.profiling.ondata({version:1,inputsMetadata:$t.map(qt=>({dims:qt.dims,dataType:Yt(qt.dataType)})),outputsMetadata:Lt.map(qt=>({dims:qt.dims,dataType:Yt(qt.dataType)})),kernelId:vt,kernelType:Ct,kernelName:pt,programName:wt,startTime:Gt,endTime:Ht});else{let qt="";$t.forEach((rr,ir)=>{qt+=`input[${ir}]: [${rr.dims}] | ${Yt(rr.dataType)}, `});let Kt="";Lt.forEach((rr,ir)=>{Kt+=`output[${ir}]: [${rr.dims}] | ${Yt(rr.dataType)}, `}),console.log(`[profiling] kernel "${vt}|${Ct}|${pt}|${wt}" ${qt}${Kt}execution time: ${Ht-Gt} ns`)}Bn("GPU",`${wt}::${jt}::${Ft}`)}d.unmap(),this.pendingQueries.delete(d)}),ut()}run(d,g,b,et,st,at){yt(d.name);let vt=[];for(let Kt=0;Kt<g.length;++Kt){let rr=g[Kt].data;if(rr===0)continue;let ir=this.gpuDataManager.get(rr);if(!ir)throw new Error(`no GPU data for input: ${rr}`);vt.push(ir)}let{outputs:Tt,dispatchGroup:Ct,programUniforms:pt}=d.getRunData(g),wt=b.length===0?Tt.map((Kt,rr)=>rr):b;if(wt.length!==Tt.length)throw new Error(`Output size ${wt.length} must be equal to ${Tt.length}.`);let $t=[],Lt=[];for(let Kt=0;Kt<Tt.length;++Kt){if(!Number.isInteger(wt[Kt])||wt[Kt]<-3||wt[Kt]>=at)throw new Error(`Invalid output index: ${wt[Kt]}`);if(wt[Kt]===-3)continue;let rr=wt[Kt]===-1,ir=wt[Kt]===-2,or=rr||ir?st(Tt[Kt].dataType,Tt[Kt].dims):et(wt[Kt],Tt[Kt].dataType,Tt[Kt].dims);if($t.push(or),or.data===0)continue;let jr=this.gpuDataManager.get(or.data);if(!jr)throw new Error(`no GPU data for output: ${or.data}`);if(rr&&this.temporaryData.push(jr),ir){let qr=this.kernelPersistentData.get(this.currentKernelId);qr||(qr=[],this.kernelPersistentData.set(this.currentKernelId,qr)),qr.push(jr)}Lt.push(jr)}if(vt.length!==g.length||Lt.length!==$t.length){if(Lt.length===0)return ut(d.name),$t;throw new Error(`Program ${d.name} has zero-sized tensor(s) in inputs or outputs. This is not supported now.`)}let jt;if(pt){let Kt=0,rr=[];pt.forEach(qr=>{let Yr=typeof qr.data=="number"?[qr.data]:qr.data;if(Yr.length===0)return;let vn=qr.type===10?2:4,ko,Xo;qr.type===10?(Xo=Yr.length>4?16:Yr.length>2?8:Yr.length*vn,ko=Yr.length>4?16:vn*Yr.length):(Xo=Yr.length<=2?Yr.length*vn:16,ko=16),Kt=Math.ceil(Kt/Xo)*Xo,rr.push(Kt);let zo=qr.type===10?8:4;Kt+=Yr.length>4?Math.ceil(Yr.length/zo)*ko:Yr.length*vn});let ir=16;Kt=Math.ceil(Kt/ir)*ir;let or=new ArrayBuffer(Kt);pt.forEach((qr,Yr)=>{let vn=rr[Yr],ko=typeof qr.data=="number"?[qr.data]:qr.data;if(qr.type===6)new Int32Array(or,vn,ko.length).set(ko);else if(qr.type===12)new Uint32Array(or,vn,ko.length).set(ko);else if(qr.type===10)new Uint16Array(or,vn,ko.length).set(ko);else if(qr.type===1)new Float32Array(or,vn,ko.length).set(ko);else throw new Error(`Unsupported uniform type: ${Yt(qr.type)}`)});let jr=this.gpuDataManager.create(Kt,GPUBufferUsage.COPY_DST|GPUBufferUsage.UNIFORM);this.device.queue.writeBuffer(jr.buffer,0,or,0,Kt),this.gpuDataManager.release(jr.id),jt={offset:0,size:Kt,buffer:jr.buffer}}let Ft=this.programManager.normalizeDispatchGroupSize(Ct),Gt=Ft[1]===1&&Ft[2]===1,Ht=af(d,g,Gt),qt=this.programManager.getArtifact(Ht);if(qt||(qt=this.programManager.build(d,Ft),this.programManager.setArtifact(Ht,qt),Ne("info",()=>`[artifact] key: ${Ht}, programName: ${d.name}`)),pt&&qt.uniformVariablesInfo){if(pt.length!==qt.uniformVariablesInfo.length)throw new Error(`Uniform variables count mismatch: expect ${qt.uniformVariablesInfo.length}, got ${pt.length} in program "${qt.programInfo.name}".`);for(let Kt=0;Kt<pt.length;Kt++){let rr=pt[Kt],ir=rr.type,or=typeof rr.data=="number"?1:rr.data.length,[jr,qr]=qt.uniformVariablesInfo[Kt];if(ir!==jr||or!==qr)throw new Error(`Uniform variable ${Kt} mismatch: expect type ${jr} with size ${qr}, got type ${ir} with size ${or} in program "${qt.programInfo.name}".`)}}if(Ne("info",()=>`[ProgramManager] run "${d.name}" (key=${Ht}) with ${Ft[0]}x${Ft[1]}x${Ft[2]}`),this.queryType!=="none"||this.sessionStatus==="capturing"){let Kt={kernelId:this.currentKernelId,programName:qt.programInfo.name,inputTensorViews:g,outputTensorViews:$t};this.pendingKernels.push(Kt),this.sessionStatus==="capturing"&&this.capturedPendingKernels.get(this.currentSessionId).push(Kt)}return this.programManager.run(qt,vt,Lt,Ft,jt),ut(d.name),$t}upload(d,g){this.gpuDataManager.upload(d,g)}memcpy(d,g){this.gpuDataManager.memcpy(d,g)}async download(d,g){await this.gpuDataManager.download(d,g)}alloc(d){return this.gpuDataManager.create(d).id}free(d){return this.gpuDataManager.release(d)}createKernel(d,g,b,et){let st=xd.get(d);if(!st)throw new Error(`kernel not implemented: ${d}`);let at={kernelType:d,kernelName:et,kernelEntry:st[0],attributes:[st[1],b]};this.kernels.set(g,at)}releaseKernel(d){let g=this.kernelPersistentData.get(d);if(g){for(let b of g)this.gpuDataManager.release(b.id);this.kernelPersistentData.delete(d)}this.kernelCustomData.delete(d),this.kernels.delete(d)}computeKernel(d,g,b){let et=this.kernels.get(d);if(!et)throw new Error(`kernel not created: ${d}`);let st=et.kernelType,at=et.kernelName,vt=et.kernelEntry,Tt=et.attributes;if(this.currentKernelId!==null)throw new Error(`kernel "[${st}] ${at}" is not allowed to be called recursively`);this.currentKernelId=d,Tt[0]&&(Tt[1]=Tt[0](Tt[1]),Tt[0]=void 0),Ne("info",()=>`[WebGPU] Start to run kernel "[${st}] ${at}"...`);let Ct=this.env.debug;this.temporaryData=[];try{return Ct&&this.device.pushErrorScope("validation"),vt(g,Tt[1]),0}catch(pt){return b.push(Promise.resolve(`[WebGPU] Kernel "[${st}] ${at}" failed. ${pt}`)),1}finally{Ct&&b.push(this.device.popErrorScope().then(pt=>pt?`GPU validation error for kernel "[${st}] ${at}": ${pt.message}`:null));for(let pt of this.temporaryData)this.gpuDataManager.release(pt.id);this.temporaryData=[],this.currentKernelId=null}}registerBuffer(d,g,b,et){let st=this.sessionExternalDataMapping.get(d);st||(st=new Map,this.sessionExternalDataMapping.set(d,st));let at=st.get(g),vt=this.gpuDataManager.registerExternalBuffer(b,et,at==null?void 0:at[1]);return st.set(g,[vt,b]),vt}unregisterBuffers(d){let g=this.sessionExternalDataMapping.get(d);g&&(g.forEach(b=>this.gpuDataManager.unregisterExternalBuffer(b[1])),this.sessionExternalDataMapping.delete(d))}getBuffer(d){let g=this.gpuDataManager.get(d);if(!g)throw new Error(`no GPU data for buffer: ${d}`);return g.buffer}createDownloader(d,g,b){return async()=>{let et=await Xi(this,d,g);return Ja(et.buffer,b)}}writeTimestamp(d){this.queryType==="inside-passes"&&this.computePassEncoder.writeTimestamp(this.querySet,d)}setQueryType(){var d;this.queryType="none",(((d=this.env.webgpu.profiling)==null?void 0:d.mode)==="default"||(typeof this.env.trace>"u"?this.env.wasm.trace:this.env.trace))&&(this.device.features.has("chromium-experimental-timestamp-query-inside-passes")?this.queryType="inside-passes":this.device.features.has("timestamp-query")&&(this.queryType="at-passes"),this.queryType!=="none"&&typeof this.querySet>"u"&&(this.querySet=this.device.createQuerySet({type:"timestamp",count:this.maxDispatchNumber*2}),this.queryResolveBuffer=this.device.createBuffer({size:this.maxDispatchNumber*2*8,usage:GPUBufferUsage.COPY_SRC|GPUBufferUsage.QUERY_RESOLVE})))}captureBegin(){Ne("info","captureBegin"),this.capturedCommandList.get(this.currentSessionId)||this.capturedCommandList.set(this.currentSessionId,[]),this.capturedPendingKernels.get(this.currentSessionId)||this.capturedPendingKernels.set(this.currentSessionId,[]),this.flush(),this.sessionStatus="capturing"}captureEnd(){Ne("info","captureEnd"),this.flush(),this.sessionStatus="default"}replay(){Ne("info","replay"),this.sessionStatus="replaying";let d=this.capturedCommandList.get(this.currentSessionId),g=this.capturedPendingKernels.get(this.currentSessionId),b=d.length;this.pendingKernels=[];for(let et=0;et<b;et++){let st=this.getComputePassEncoder(),at=d[et];this.writeTimestamp(this.pendingDispatchNumber*2),st.setPipeline(at.computePipeline),st.setBindGroup(0,at.bindGroup),st.dispatchWorkgroups(...at.dispatchGroup),this.writeTimestamp(this.pendingDispatchNumber*2+1),this.pendingDispatchNumber++,this.queryType!=="none"&&this.pendingKernels.push(g[et]),(this.pendingDispatchNumber>=this.maxDispatchNumber||this.queryType==="at-passes")&&this.endComputePass(),this.pendingDispatchNumber>=this.maxDispatchNumber&&this.flush()}this.flush(),this.sessionStatus="default"}onReleaseSession(d){this.unregisterBuffers(d),this.capturedCommandList.has(d)&&this.capturedCommandList.delete(d),this.capturedPendingKernels.has(d)&&this.capturedPendingKernels.delete(d),this.gpuDataManager.onReleaseSession(d)}onRunStart(d){this.currentSessionId=d,this.setQueryType()}}}),Td={};kr(Td,{init:()=>sf});var an,xo,sf,Ad=j(()=>{ye(),Id(),Xt(),xe(),an=class YS{constructor(g,b,et,st){this.module=g,this.dataType=b,this.data=et,this.dims=st}getFloat32Array(){if(this.dataType!==1)throw new Error("Invalid data type");let g=M$1.size(this.dims);return g===0?new Float32Array:new Float32Array(this.module.HEAP8.buffer,this.data,g)}getBigInt64Array(){if(this.dataType!==7)throw new Error("Invalid data type");let g=M$1.size(this.dims);return g===0?new BigInt64Array:new BigInt64Array(this.module.HEAP8.buffer,this.data,g)}getInt32Array(){if(this.dataType!==6)throw new Error("Invalid data type");let g=M$1.size(this.dims);return g===0?new Int32Array:new Int32Array(this.module.HEAP8.buffer,this.data,g)}reshape(g){if(M$1.size(g)!==M$1.size(this.dims))throw new Error("Invalid new shape");return new YS(this.module,this.dataType,this.data,g)}},xo=class{constructor(d,g,b){this.module=d,this.backend=g,this.customDataOffset=0,this.customDataSize=0,this.adapterInfo=g.adapterInfo;let et=d.HEAPU32,st=b>>>2;this.opKernelContext=et[st++];let at=et[st++];this.outputCount=et[st++],this.customDataOffset=et[st++],this.customDataSize=et[st++];let vt=[];for(let Tt=0;Tt<at;Tt++){let Ct=et[st++],pt=et[st++],wt=et[st++],$t=[];for(let Lt=0;Lt<wt;Lt++)$t.push(et[st++]);vt.push(new an(d,Ct,pt,$t))}this.inputs=vt}get kernelCustomData(){return this.backend.currentKernelCustomData}get customDataBuffer(){return this.module.HEAPU8.subarray(this.customDataOffset,this.customDataOffset+this.customDataSize)}getMaxComputeWorkgroupSizes(){return[this.backend.device.limits.maxComputeWorkgroupSizeX,this.backend.device.limits.maxComputeWorkgroupSizeY,this.backend.device.limits.maxComputeWorkgroupSizeZ]}getMaxComputeWorkgroupStoragesize(){return this.backend.device.limits.maxComputeWorkgroupStorageSize}compute(d,g){var vt;let b=((vt=g==null?void 0:g.inputs)==null?void 0:vt.map(Tt=>typeof Tt=="number"?this.inputs[Tt]:Tt))??this.inputs,et=(g==null?void 0:g.outputs)??[],st=(Tt,Ct,pt)=>new an(this.module,Ct,this.output(Tt,pt),pt),at=(Tt,Ct)=>{let pt=cr(Tt);if(!pt)throw new Error(`Unsupported data type: ${Tt}`);let wt=pt*M$1.size(Ct),$t=wt>0?this.backend.gpuDataManager.create(wt).id:0;return new an(this.module,Tt,$t,Ct)};return this.backend.run(d,b,et,st,at,this.outputCount)}output(d,g){let b=this.module.stackSave();try{let et=this.module.stackAlloc((1+g.length)*4),st=et>>2;this.module.HEAPU32[st++]=g.length;for(let at=0;at<g.length;at++)this.module.HEAPU32[st++]=g[at];return this.module._JsepOutput(this.opKernelContext,d,et)}catch(et){throw new Error(`Failed to generate kernel's output[${d}] with dims [${g}]. If you are running with pre-allocated output, please make sure the output type/dims are correct. Error: ${et}`)}finally{this.module.stackRestore(b)}}},sf=async(d,g,b,et)=>{let st=g.jsepInit;if(!st)throw new Error("Failed to initialize JSEP. The WebAssembly module is not built with JSEP support.");if(d==="webgpu"){let at=new di;await at.initialize(b,et),st("webgpu",[at,vt=>at.alloc(vt),vt=>at.free(vt),(vt,Tt,Ct,pt=!1)=>{if(pt)Ne("verbose",()=>`[WebGPU] jsepCopyGpuToGpu: src=${vt}, dst=${Tt}, size=${Ct}`),at.memcpy(vt,Tt);else{Ne("verbose",()=>`[WebGPU] jsepCopyCpuToGpu: dataOffset=${vt}, gpuDataId=${Tt}, size=${Ct}`);let wt=g.HEAPU8.subarray(vt>>>0,(vt>>>0)+Ct);at.upload(Tt,wt)}},async(vt,Tt,Ct)=>{Ne("verbose",()=>`[WebGPU] jsepCopyGpuToCpu: gpuDataId=${vt}, dataOffset=${Tt}, size=${Ct}`),await at.download(vt,()=>g.HEAPU8.subarray(Tt>>>0,(Tt>>>0)+Ct))},(vt,Tt,Ct)=>at.createKernel(vt,Tt,Ct,g.UTF8ToString(g._JsepGetNodeName(Tt))),vt=>at.releaseKernel(vt),(vt,Tt,Ct,pt)=>{Ne("verbose",()=>`[WebGPU] jsepRun: sessionHandle=${Ct}, kernel=${vt}, contextDataOffset=${Tt}`);let wt=new xo(g,at,Tt);return at.computeKernel(vt,wt,pt)},()=>at.captureBegin(),()=>at.captureEnd(),()=>at.replay()])}else st("webnn")}}),uf,kd,Od,hr,lf,So,Pd,Rd,Ed,zd,Bd,Dd,Md=j(()=>{ja(),Ya(),ye(),Or(),Wn(),qi(),uf=(d,g)=>{Fe()._OrtInit(d,g)!==0&&We("Can't initialize onnxruntime.")},kd=async d=>{uf(d.wasm.numThreads,en(d.logLevel))},Od=async(d,g)=>{{let b=(Ad(),sr(Td)).init;if(g==="webgpu"){if(typeof navigator>"u"||!navigator.gpu)throw new Error("WebGPU is not supported in current environment");let et=d.webgpu.adapter;if(et){if(typeof et.limits!="object"||typeof et.features!="object"||typeof et.requestDevice!="function")throw new Error("Invalid GPU adapter set in `env.webgpu.adapter`. It must be a GPUAdapter object.")}else{let st=d.webgpu.powerPreference;if(st!==void 0&&st!=="low-power"&&st!=="high-performance")throw new Error(`Invalid powerPreference setting: "${st}"`);let at=d.webgpu.forceFallbackAdapter;if(at!==void 0&&typeof at!="boolean")throw new Error(`Invalid forceFallbackAdapter setting: "${at}"`);if(et=await navigator.gpu.requestAdapter({powerPreference:st,forceFallbackAdapter:at}),!et)throw new Error('Failed to get GPU adapter. You may need to enable flag "--enable-unsafe-webgpu" if you are using Chrome.')}if(!d.wasm.simd)throw new Error("Not supported for WebGPU=ON and SIMD=OFF. Please set `env.wasm.simd` to true when using `webgpu` EP");await b("webgpu",Fe(),d,et)}if(g==="webnn"){if(typeof navigator>"u"||!navigator.ml)throw new Error("WebNN is not supported in current environment");await b("webnn",Fe(),d)}}},hr=new Map,lf=d=>{let g=Fe(),b=g.stackSave();try{let et=g.stackAlloc(8);return g._OrtGetInputOutputCount(d,et,et+4)!==0&&We("Can't get session input/output count."),[g.HEAP32[et/4],g.HEAP32[et/4+1]]}finally{g.stackRestore(b)}},So=d=>{let g=Fe(),b=g._malloc(d.byteLength);if(b===0)throw new Error(`Can't create a session. failed to allocate a buffer of size ${d.byteLength}.`);return g.HEAPU8.set(d,b),[b,d.byteLength]},Pd=async(d,g)=>{var $t,Lt;let b,et,st=Fe();Array.isArray(d)?[b,et]=d:d.buffer===st.HEAPU8.buffer?[b,et]=[d.byteOffset,d.byteLength]:[b,et]=So(d);let at=0,vt=0,Tt=0,Ct=[],pt=[],wt=[];try{if([vt,Ct]=Ka(g),(g==null?void 0:g.externalData)&&st.mountExternalData){let ir=[];for(let or of g.externalData){let jr=typeof or=="string"?or:or.path;ir.push(tn(typeof or=="string"?or:or.data).then(qr=>{st.mountExternalData(jr,qr)}))}await Promise.all(ir)}at=await st._OrtCreateSession(b,et,vt),at===0&&We("Can't create a session.");let[jt,Ft]=lf(at),Gt=!!(g!=null&&g.enableGraphCapture),Ht=[],qt=[],Kt=[];for(let ir=0;ir<jt;ir++){let or=st._OrtGetInputName(at,ir);or===0&&We("Can't get an input name."),pt.push(or),Ht.push(st.UTF8ToString(or))}for(let ir=0;ir<Ft;ir++){let or=st._OrtGetOutputName(at,ir);or===0&&We("Can't get an output name."),wt.push(or);let jr=st.UTF8ToString(or);qt.push(jr);{if(Gt&&(g==null?void 0:g.preferredOutputLocation)===void 0){Kt.push("gpu-buffer");continue}let qr=typeof(g==null?void 0:g.preferredOutputLocation)=="string"?g.preferredOutputLocation:(($t=g==null?void 0:g.preferredOutputLocation)==null?void 0:$t[jr])??"cpu";if(qr!=="cpu"&&qr!=="cpu-pinned"&&qr!=="gpu-buffer")throw new Error(`Not supported preferred output location: ${qr}.`);if(Gt&&qr!=="gpu-buffer")throw new Error(`Not supported preferred output location: ${qr}. Only 'gpu-buffer' location is supported when enableGraphCapture is true.`);Kt.push(qr)}}let rr=null;return Kt.some(ir=>ir==="gpu-buffer")&&(Tt=st._OrtCreateBinding(at),Tt===0&&We("Can't create IO binding."),rr={handle:Tt,outputPreferredLocations:Kt,outputPreferredLocationsEncoded:Kt.map(ir=>Fi(ir))}),hr.set(at,[at,pt,wt,rr,Gt,!1]),[at,Ht,qt]}catch(jt){throw pt.forEach(Ft=>st._OrtFree(Ft)),wt.forEach(Ft=>st._OrtFree(Ft)),Tt!==0&&st._OrtReleaseBinding(Tt),at!==0&&st._OrtReleaseSession(at),jt}finally{st._free(b),vt!==0&&st._OrtReleaseSessionOptions(vt),Ct.forEach(jt=>st._free(jt)),(Lt=st.unmountExternalData)==null||Lt.call(st)}},Rd=d=>{var Ct;let g=Fe(),b=hr.get(d);if(!b)throw new Error(`cannot release session. invalid session id: ${d}`);let[et,st,at,vt,Tt]=b;vt&&(Tt&&g._OrtClearBoundOutputs(vt.handle),g._OrtReleaseBinding(vt.handle)),(Ct=g.jsepOnReleaseSession)==null||Ct.call(g,d),st.forEach(pt=>g._OrtFree(pt)),at.forEach(pt=>g._OrtFree(pt)),g._OrtReleaseSession(et),hr.delete(d)},Ed=(d,g,b,et,st,at=!1)=>{if(!d){g.push(0);return}let vt=Fe(),Tt=d[0],Ct=d[1],pt=d[3],wt,$t;if(Tt==="string"&&pt==="gpu-buffer")throw new Error("String tensor is not supported on GPU.");if(at&&pt!=="gpu-buffer")throw new Error(`External buffer must be provided for input/output index ${st} when enableGraphCapture is true.`);if(pt==="gpu-buffer"){let Ft=d[2].gpuBuffer,Gt=cr(Li(Tt));$t=Ct.reduce((qt,Kt)=>qt*Kt,1)*Gt;let Ht=vt.jsepRegisterBuffer;if(!Ht)throw new Error('Tensor location "gpu-buffer" is not supported without using WebGPU.');wt=Ht(et,st,Ft,$t)}else{let Ft=d[2];if(Array.isArray(Ft)){$t=4*Ft.length,wt=vt._malloc($t),b.push(wt);let Gt=wt/4;for(let Ht=0;Ht<Ft.length;Ht++){if(typeof Ft[Ht]!="string")throw new TypeError(`tensor data at index ${Ht} is not a string`);vt.HEAPU32[Gt++]=qe(Ft[Ht],b)}}else $t=Ft.byteLength,wt=vt._malloc($t),b.push(wt),vt.HEAPU8.set(new Uint8Array(Ft.buffer,Ft.byteOffset,$t),wt)}let Lt=vt.stackSave(),jt=vt.stackAlloc(4*Ct.length);try{let Ft=jt/4;Ct.forEach(Ht=>vt.HEAP32[Ft++]=Ht);let Gt=vt._OrtCreateTensor(Li(Tt),wt,$t,jt,Ct.length,Fi(pt));Gt===0&&We(`Can't create tensor for input/output. session=${et}, index=${st}.`),g.push(Gt)}finally{vt.stackRestore(Lt)}},zd=async(d,g,b,et,st,at)=>{var ko,Xo;let vt=Fe(),Tt=hr.get(d);if(!Tt)throw new Error(`cannot run inference. invalid session id: ${d}`);let Ct=Tt[0],pt=Tt[1],wt=Tt[2],$t=Tt[3],Lt=Tt[4],jt=Tt[5],Ft=g.length,Gt=et.length,Ht=0,qt=[],Kt=[],rr=[],ir=[],or=vt.stackSave(),jr=vt.stackAlloc(Ft*4),qr=vt.stackAlloc(Ft*4),Yr=vt.stackAlloc(Gt*4),vn=vt.stackAlloc(Gt*4);try{[Ht,qt]=qa(at);for(let e0=0;e0<Ft;e0++)Ed(b[e0],Kt,ir,d,g[e0],Lt);for(let e0=0;e0<Gt;e0++)Ed(st[e0],rr,ir,d,Ft+et[e0],Lt);let zo=jr/4,t0=qr/4,Uo=Yr/4,No=vn/4;for(let e0=0;e0<Ft;e0++)vt.HEAPU32[zo++]=Kt[e0],vt.HEAPU32[t0++]=pt[g[e0]];for(let e0=0;e0<Gt;e0++)vt.HEAPU32[Uo++]=rr[e0],vt.HEAPU32[No++]=wt[et[e0]];if($t&&!jt){let{handle:e0,outputPreferredLocations:Zr,outputPreferredLocationsEncoded:Ro}=$t;if(pt.length!==Ft)throw new Error(`input count from feeds (${Ft}) is expected to be always equal to model's input count (${pt.length}).`);for(let Sn=0;Sn<Ft;Sn++){let Tn=g[Sn];await vt._OrtBindInput(e0,pt[Tn],Kt[Sn])!==0&&We(`Can't bind input[${Sn}] for session=${d}.`)}for(let Sn=0;Sn<Gt;Sn++){let Tn=et[Sn];(ko=st[Sn])!=null&&ko[3]?vt._OrtBindOutput(e0,wt[Tn],rr[Sn],0)!==0&&We(`Can't bind pre-allocated output[${Sn}] for session=${d}.`):vt._OrtBindOutput(e0,wt[Tn],0,Ro[Tn])!==0&&We(`Can't bind output[${Sn}] to ${Zr[Sn]} for session=${d}.`)}hr.set(d,[Ct,pt,wt,$t,Lt,!0])}(Xo=vt.jsepOnRunStart)==null||Xo.call(vt,Ct);let _n;$t?_n=await vt._OrtRunWithBinding(Ct,$t.handle,Gt,Yr,Ht):_n=await vt._OrtRun(Ct,qr,jr,Ft,vn,Gt,Yr,Ht),_n!==0&&We("failed to call OrtRun().");let Kr=[];for(let e0=0;e0<Gt;e0++){let Zr=vt.HEAPU32[Yr/4+e0];if(Zr===rr[e0]){Kr.push(st[e0]);continue}let Ro=vt.stackSave(),Sn=vt.stackAlloc(4*4),Tn=!1,n0,Go=0;try{vt._OrtGetTensorData(Zr,Sn,Sn+4,Sn+8,Sn+12)!==0&&We(`Can't access output tensor data on index ${e0}.`);let An=Sn/4,a0=vt.HEAPU32[An++];Go=vt.HEAPU32[An++];let u0=vt.HEAPU32[An++],d0=vt.HEAPU32[An++],f0=[];for(let O0=0;O0<d0;O0++)f0.push(vt.HEAPU32[u0/4+O0]);vt._OrtFree(u0);let y0=f0.reduce((O0,C0)=>O0*C0,1);n0=Yt(a0);let b0=$t==null?void 0:$t.outputPreferredLocations[et[e0]];if(n0==="string"){if(b0==="gpu-buffer")throw new Error("String tensor is not supported on GPU.");let O0=[],C0=Go/4;for(let v0=0;v0<y0;v0++){let k0=vt.HEAPU32[C0++],N0=v0===y0-1?void 0:vt.HEAPU32[C0]-k0;O0.push(vt.UTF8ToString(k0,N0))}Kr.push([n0,f0,O0,"cpu"])}else if(b0==="gpu-buffer"&&y0>0){let O0=vt.jsepGetBuffer;if(!O0)throw new Error('preferredLocation "gpu-buffer" is not supported without using WebGPU.');let C0=O0(Go),v0=cr(a0);if(v0===void 0||!Vn(n0))throw new Error(`Unsupported data type: ${n0}`);Tn=!0,Kr.push([n0,f0,{gpuBuffer:C0,download:vt.jsepCreateDownloader(C0,y0*v0,n0),dispose:()=>{vt._OrtReleaseTensor(Zr)}},"gpu-buffer"])}else{let O0=Nn(n0),C0=new O0(y0);new Uint8Array(C0.buffer,C0.byteOffset,C0.byteLength).set(vt.HEAPU8.subarray(Go,Go+C0.byteLength)),Kr.push([n0,f0,C0,"cpu"])}}finally{vt.stackRestore(Ro),n0==="string"&&Go&&vt._free(Go),Tn||vt._OrtReleaseTensor(Zr)}}return $t&&!Lt&&(vt._OrtClearBoundOutputs($t.handle),hr.set(d,[Ct,pt,wt,$t,Lt,!1])),Kr}finally{vt.stackRestore(or),Kt.forEach(zo=>vt._OrtReleaseTensor(zo)),rr.forEach(zo=>vt._OrtReleaseTensor(zo)),ir.forEach(zo=>vt._free(zo)),Ht!==0&&vt._OrtReleaseRunOptions(Ht),qt.forEach(zo=>vt._free(zo))}},Bd=d=>{let g=Fe(),b=hr.get(d);if(!b)throw new Error("invalid session id");let et=b[0],st=g._OrtEndProfiling(et);st===0&&We("Can't get an profile file name."),g._OrtFree(st)},Dd=d=>{let g=[];for(let b of d){let et=b[2];!Array.isArray(et)&&"buffer"in et&&g.push(et.buffer)}return g}}),Ud=Er((d,g)=>{g.exports='/*!\n * ONNX Runtime Web v1.18.0\n * Copyright (c) Microsoft Corporation. All rights reserved.\n * Licensed under the MIT License.\n */\n"use strict";(()=>{var ao=Object.defineProperty;var nl=Object.getOwnPropertyDescriptor;var ol=Object.getOwnPropertyNames;var il=Object.prototype.hasOwnProperty;var Y=(e,t)=>()=>(e&&(t=e(e=0)),t);var Wr=(e,t)=>()=>(t||e((t={exports:{}}).exports,t),t.exports),gn=(e,t)=>{for(var r in t)ao(e,r,{get:t[r],enumerable:!0})},al=(e,t,r,o)=>{if(t&&typeof t=="object"||typeof t=="function")for(let i of ol(t))!il.call(e,i)&&i!==r&&ao(e,i,{get:()=>t[i],enumerable:!(o=nl(t,i))||o.enumerable});return e};var wr=e=>al(ao({},"__esModule",{value:!0}),e);var so={};gn(so,{createReadStream:()=>Ai,readFile:()=>sl,readFileSync:()=>ul});var sl,ul,Ai,uo=Y(()=>{sl=void 0,ul=void 0,Ai=void 0});var lo={};gn(lo,{join:()=>dl});var dl,co=Y(()=>{dl=void 0});var Ei=Wr((Ti,po)=>{"use strict";var Ii=(()=>{var e=typeof document<"u"?document.currentScript?.src:void 0;return typeof __filename<"u"&&(e||=__filename),function(t={}){var r=t,o,i,u=new Promise((s,m)=>{o=s,i=m});r.mountExternalData=(s,m)=>{(r.eb||(r.eb=new Map)).set(s,m)},r.unmountExternalData=()=>{delete r.eb};let a=()=>{let s=(g,$,T)=>(...B)=>{let H=dt,q=$?.();B=g(...B);let te=$?.();return q!==te&&(g=te,T(q),$=T=null),dt!=H?tn():B},m=g=>async(...$)=>{try{if(r.cb)throw Error("Session already started");let T=r.cb={xb:$[0],errors:[]},B=await g(...$);if(r.cb!==T)throw Error("Session mismatch");r.kb?.flush();let H=T.errors;if(0<H.length){let q=await Promise.all(H);if(q=q.filter(te=>te),0<q.length)throw Error(q.join(`\n`))}return B}finally{r.cb=null}};r._OrtCreateSession=s(r._OrtCreateSession,()=>r._OrtCreateSession,g=>r._OrtCreateSession=g),r._OrtRun=m(s(r._OrtRun,()=>r._OrtRun,g=>r._OrtRun=g)),r._OrtRunWithBinding=m(s(r._OrtRunWithBinding,()=>r._OrtRunWithBinding,g=>r._OrtRunWithBinding=g)),r._OrtBindInput=s(r._OrtBindInput,()=>r._OrtBindInput,g=>r._OrtBindInput=g),a=void 0};r.jsepInit=(s,m)=>{if(a?.(),s==="webgpu"){[r.kb,r.pb,r.tb,r.lb,r.sb,r.Ra,r.ub,r.wb,r.qb,r.rb,r.vb]=m;let g=r.kb;r.jsepRegisterBuffer=($,T,B,H)=>g.registerBuffer($,T,B,H),r.jsepGetBuffer=$=>g.getBuffer($),r.jsepCreateDownloader=($,T,B)=>g.createDownloader($,T,B),r.jsepOnReleaseSession=$=>{g.onReleaseSession($)},r.jsepOnRunStart=$=>g.onRunStart($)}};var c=Object.assign({},r),p="./this.program",h=(s,m)=>{throw m},d=typeof window=="object",y=typeof importScripts=="function",w=typeof process=="object"&&typeof process.versions=="object"&&typeof process.versions.node=="string",_="",v,S,A;if(w){var I=(uo(),wr(so)),x=(co(),wr(lo));_=y?x.dirname(_)+"/":__dirname+"/",v=(s,m)=>(s=Ke(s)?new URL(s):x.normalize(s),I.readFileSync(s,m?void 0:"utf8")),A=s=>(s=v(s,!0),s.buffer||(s=new Uint8Array(s)),s),S=(s,m,g,$=!0)=>{s=Ke(s)?new URL(s):x.normalize(s),I.readFile(s,$?void 0:"utf8",(T,B)=>{T?g(T):m($?B.buffer:B)})},!r.thisProgram&&1<process.argv.length&&(p=process.argv[1].replace(/\\\\/g,"/")),process.argv.slice(2),h=(s,m)=>{throw process.exitCode=s,m}}else(d||y)&&(y?_=self.location.href:typeof document<"u"&&document.currentScript&&(_=document.currentScript.src),e&&(_=e),_.startsWith("blob:")?_="":_=_.substr(0,_.replace(/[?#].*/,"").lastIndexOf("/")+1),v=s=>{var m=new XMLHttpRequest;return m.open("GET",s,!1),m.send(null),m.responseText},y&&(A=s=>{var m=new XMLHttpRequest;return m.open("GET",s,!1),m.responseType="arraybuffer",m.send(null),new Uint8Array(m.response)}),S=(s,m,g)=>{var $=new XMLHttpRequest;$.open("GET",s,!0),$.responseType="arraybuffer",$.onload=()=>{$.status==200||$.status==0&&$.response?m($.response):g()},$.onerror=g,$.send(null)});var E=console.log.bind(console),P=console.error.bind(console);Object.assign(r,c),c=null;var O,R=!1,L,N,K,Q,he,W,se,Ce,We,ee,ae;function Ae(){var s=O.buffer;r.HEAP8=N=new Int8Array(s),r.HEAP16=Q=new Int16Array(s),r.HEAPU8=K=new Uint8Array(s),r.HEAPU16=he=new Uint16Array(s),r.HEAP32=W=new Int32Array(s),r.HEAPU32=se=new Uint32Array(s),r.HEAPF32=Ce=new Float32Array(s),r.HEAPF64=ae=new Float64Array(s),r.HEAP64=We=new BigInt64Array(s),r.HEAPU64=ee=new BigUint64Array(s)}var me=[],ie=[],ue=[],le=0,qe=null,G=null;function ne(s){throw s="Aborted("+s+")",P(s),R=!0,L=1,s=new WebAssembly.RuntimeError(s+". Build with -sASSERTIONS for more info."),i(s),s}var xe=s=>s.startsWith("data:application/octet-stream;base64,"),Ke=s=>s.startsWith("file://"),Be;if(Be="ort-wasm-simd.wasm",!xe(Be)){var Ge=Be;Be=r.locateFile?r.locateFile(Ge,_):_+Ge}function Ut(s){if(A)return A(s);throw"both async and sync fetching of the wasm failed"}function Ne(s){if(d||y){if(typeof fetch=="function"&&!Ke(s))return fetch(s,{credentials:"same-origin"}).then(m=>{if(!m.ok)throw`failed to load wasm binary file at \'${s}\'`;return m.arrayBuffer()}).catch(()=>Ut(s));if(S)return new Promise((m,g)=>{S(s,$=>m(new Uint8Array($)),g)})}return Promise.resolve().then(()=>Ut(s))}function Ye(s,m,g){return Ne(s).then($=>WebAssembly.instantiate($,m)).then(g,$=>{P(`failed to asynchronously prepare wasm: ${$}`),ne($)})}function mt(s,m){var g=Be;return typeof WebAssembly.instantiateStreaming!="function"||xe(g)||Ke(g)||w||typeof fetch!="function"?Ye(g,s,m):fetch(g,{credentials:"same-origin"}).then($=>WebAssembly.instantiateStreaming($,s).then(m,function(T){return P(`wasm streaming compile failed: ${T}`),P("falling back to ArrayBuffer instantiation"),Ye(g,s,m)}))}var Rt={824920:(s,m,g,$)=>{if(typeof r>"u"||!r.eb)return 1;if(s=je(s>>>0),s.startsWith("./")&&(s=s.substring(2)),s=r.eb.get(s),!s)return 2;if(m>>>=0,g>>>=0,m+g>s.byteLength)return 3;try{return K.set(s.subarray(m,m+g),$>>>0>>>0),0}catch{return 4}},825421:()=>{r.qb()},825452:()=>{r.rb()},825481:()=>{r.vb()},825506:s=>r.pb(s),825539:s=>r.tb(s),825571:(s,m,g)=>{r.lb(s,m,g,!0)},825610:(s,m,g)=>{r.lb(s,m,g)},825643:s=>{r.Ra("Abs",s,void 0)},825694:s=>{r.Ra("Neg",s,void 0)},825745:s=>{r.Ra("Floor",s,void 0)},825798:s=>{r.Ra("Ceil",s,void 0)},825850:s=>{r.Ra("Reciprocal",s,void 0)},825908:s=>{r.Ra("Sqrt",s,void 0)},825960:s=>{r.Ra("Exp",s,void 0)},826011:s=>{r.Ra("Erf",s,void 0)},826062:s=>{r.Ra("Sigmoid",s,void 0)},826117:(s,m,g)=>{r.Ra("HardSigmoid",s,{alpha:m,beta:g})},826196:s=>{r.Ra("Log",s,void 0)},826247:s=>{r.Ra("Sin",s,void 0)},826298:s=>{r.Ra("Cos",s,void 0)},826349:s=>{r.Ra("Tan",s,void 0)},826400:s=>{r.Ra("Asin",s,void 0)},826452:s=>{r.Ra("Acos",s,void 0)},826504:s=>{r.Ra("Atan",s,void 0)},826556:s=>{r.Ra("Sinh",s,void 0)},826608:s=>{r.Ra("Cosh",s,void 0)},826660:s=>{r.Ra("Asinh",s,void 0)},826713:s=>{r.Ra("Acosh",s,void 0)},826766:s=>{r.Ra("Atanh",s,void 0)},826819:s=>{r.Ra("Tanh",s,void 0)},826871:s=>{r.Ra("Not",s,void 0)},826922:(s,m,g)=>{r.Ra("Clip",s,{min:m,max:g})},826991:s=>{r.Ra("Clip",s,void 0)},827043:(s,m)=>{r.Ra("Elu",s,{alpha:m})},827101:s=>{r.Ra("Relu",s,void 0)},827153:(s,m)=>{r.Ra("LeakyRelu",s,{alpha:m})},827217:(s,m)=>{r.Ra("ThresholdedRelu",s,{alpha:m})},827287:(s,m)=>{r.Ra("Cast",s,{to:m})},827345:s=>{r.Ra("Add",s,void 0)},827396:s=>{r.Ra("Sub",s,void 0)},827447:s=>{r.Ra("Mul",s,void 0)},827498:s=>{r.Ra("Div",s,void 0)},827549:s=>{r.Ra("Pow",s,void 0)},827600:s=>{r.Ra("Equal",s,void 0)},827653:s=>{r.Ra("Greater",s,void 0)},827708:s=>{r.Ra("GreaterOrEqual",s,void 0)},827770:s=>{r.Ra("Less",s,void 0)},827822:s=>{r.Ra("LessOrEqual",s,void 0)},827881:(s,m,g,$,T)=>{r.Ra("ReduceMean",s,{keepDims:!!m,noopWithEmptyAxes:!!g,axes:$?Array.from(W.subarray($>>>0,T>>>0)):[]})},828040:(s,m,g,$,T)=>{r.Ra("ReduceMax",s,{keepDims:!!m,noopWithEmptyAxes:!!g,axes:$?Array.from(W.subarray($>>>0,T>>>0)):[]})},828198:(s,m,g,$,T)=>{r.Ra("ReduceMin",s,{keepDims:!!m,noopWithEmptyAxes:!!g,axes:$?Array.from(W.subarray($>>>0,T>>>0)):[]})},828356:(s,m,g,$,T)=>{r.Ra("ReduceProd",s,{keepDims:!!m,noopWithEmptyAxes:!!g,axes:$?Array.from(W.subarray($>>>0,T>>>0)):[]})},828515:(s,m,g,$,T)=>{r.Ra("ReduceSum",s,{keepDims:!!m,noopWithEmptyAxes:!!g,axes:$?Array.from(W.subarray($>>>0,T>>>0)):[]})},828673:(s,m,g,$,T)=>{r.Ra("ReduceL1",s,{keepDims:!!m,noopWithEmptyAxes:!!g,axes:$?Array.from(W.subarray($>>>0,T>>>0)):[]})},828830:(s,m,g,$,T)=>{r.Ra("ReduceL2",s,{keepDims:!!m,noopWithEmptyAxes:!!g,axes:$?Array.from(W.subarray($>>>0,T>>>0)):[]})},828987:(s,m,g,$,T)=>{r.Ra("ReduceLogSum",s,{keepDims:!!m,noopWithEmptyAxes:!!g,axes:$?Array.from(W.subarray($>>>0,T>>>0)):[]})},829148:(s,m,g,$,T)=>{r.Ra("ReduceSumSquare",s,{keepDims:!!m,noopWithEmptyAxes:!!g,axes:$?Array.from(W.subarray($>>>0,T>>>0)):[]})},829312:(s,m,g,$,T)=>{r.Ra("ReduceLogSumExp",s,{keepDims:!!m,noopWithEmptyAxes:!!g,axes:$?Array.from(W.subarray($>>>0,T>>>0)):[]})},829476:s=>{r.Ra("Where",s,void 0)},829529:(s,m,g)=>{r.Ra("Transpose",s,{perm:m?Array.from(W.subarray(m>>>0,g>>>0)):[]})},829637:(s,m,g,$)=>{r.Ra("DepthToSpace",s,{blocksize:m,mode:je(g),format:$?"NHWC":"NCHW"})},829770:(s,m,g,$)=>{r.Ra("DepthToSpace",s,{blocksize:m,mode:je(g),format:$?"NHWC":"NCHW"})},829903:(s,m,g,$,T,B,H,q,te,X,de,Ee,Oe,D,be)=>{r.Ra("ConvTranspose",s,{format:te?"NHWC":"NCHW",autoPad:m,dilations:[g],group:$,kernelShape:[T],pads:[B,H],strides:[q],wIsConst:()=>!!N[X>>>0],outputPadding:de?Array.from(W.subarray(de>>>0,Ee>>>0)):[],outputShape:Oe?Array.from(W.subarray(Oe>>>0,D>>>0)):[],activation:je(be)})},830304:(s,m,g,$,T,B,H,q,te,X,de,Ee,Oe,D)=>{r.Ra("ConvTranspose",s,{format:q?"NHWC":"NCHW",autoPad:m,dilations:Array.from(W.subarray(g>>>0,(g>>>0)+2>>>0)),group:$,kernelShape:Array.from(W.subarray(T>>>0,(T>>>0)+2>>>0)),pads:Array.from(W.subarray(B>>>0,(B>>>0)+4>>>0)),strides:Array.from(W.subarray(H>>>0,(H>>>0)+2>>>0)),wIsConst:()=>!!N[te>>>0],outputPadding:X?Array.from(W.subarray(X>>>0,de>>>0)):[],outputShape:Ee?Array.from(W.subarray(Ee>>>0,Oe>>>0)):[],activation:je(D)})},830869:(s,m,g,$,T,B,H,q,te,X,de,Ee,Oe,D,be)=>{r.Ra("ConvTranspose",s,{format:te?"NHWC":"NCHW",autoPad:m,dilations:[g],group:$,kernelShape:[T],pads:[B,H],strides:[q],wIsConst:()=>!!N[X>>>0],outputPadding:de?Array.from(W.subarray(de>>>0,Ee>>>0)):[],outputShape:Oe?Array.from(W.subarray(Oe>>>0,D>>>0)):[],activation:je(be)})},831270:(s,m,g,$,T,B,H,q,te,X,de,Ee,Oe,D)=>{r.Ra("ConvTranspose",s,{format:q?"NHWC":"NCHW",autoPad:m,dilations:Array.from(W.subarray(g>>>0,(g>>>0)+2>>>0)),group:$,kernelShape:Array.from(W.subarray(T>>>0,(T>>>0)+2>>>0)),pads:Array.from(W.subarray(B>>>0,(B>>>0)+4>>>0)),strides:Array.from(W.subarray(H>>>0,(H>>>0)+2>>>0)),wIsConst:()=>!!N[te>>>0],outputPadding:X?Array.from(W.subarray(X>>>0,de>>>0)):[],outputShape:Ee?Array.from(W.subarray(Ee>>>0,Oe>>>0)):[],activation:je(D)})},831835:(s,m)=>{r.Ra("GlobalAveragePool",s,{format:m?"NHWC":"NCHW"})},831926:(s,m,g,$,T,B,H,q,te,X,de,Ee,Oe,D,be,Ie)=>{r.Ra("AveragePool",s,{format:Ie?"NHWC":"NCHW",auto_pad:m,ceil_mode:g,count_include_pad:$,storage_order:T,dilations:[B,H],kernel_shape:[q,te],pads:[X,de,Ee,Oe],strides:[D,be]})},832210:(s,m)=>{r.Ra("GlobalAveragePool",s,{format:m?"NHWC":"NCHW"})},832301:(s,m,g,$,T,B,H,q,te,X,de,Ee,Oe,D,be,Ie)=>{r.Ra("AveragePool",s,{format:Ie?"NHWC":"NCHW",auto_pad:m,ceil_mode:g,count_include_pad:$,storage_order:T,dilations:[B,H],kernel_shape:[q,te],pads:[X,de,Ee,Oe],strides:[D,be]})},832585:(s,m)=>{r.Ra("GlobalMaxPool",s,{format:m?"NHWC":"NCHW"})},832672:(s,m,g,$,T,B,H,q,te,X,de,Ee,Oe,D,be,Ie)=>{r.Ra("MaxPool",s,{format:Ie?"NHWC":"NCHW",auto_pad:m,ceil_mode:g,count_include_pad:$,storage_order:T,dilations:[B,H],kernel_shape:[q,te],pads:[X,de,Ee,Oe],strides:[D,be]})},832952:(s,m)=>{r.Ra("GlobalMaxPool",s,{format:m?"NHWC":"NCHW"})},833039:(s,m,g,$,T,B,H,q,te,X,de,Ee,Oe,D,be,Ie)=>{r.Ra("MaxPool",s,{format:Ie?"NHWC":"NCHW",auto_pad:m,ceil_mode:g,count_include_pad:$,storage_order:T,dilations:[B,H],kernel_shape:[q,te],pads:[X,de,Ee,Oe],strides:[D,be]})},833319:(s,m,g,$,T)=>{r.Ra("Gemm",s,{alpha:m,beta:g,transA:$,transB:T})},833423:s=>{r.Ra("MatMul",s,void 0)},833477:(s,m,g,$)=>{r.Ra("ArgMax",s,{keepDims:!!m,selectLastIndex:!!g,axis:$})},833585:(s,m,g,$)=>{r.Ra("ArgMin",s,{keepDims:!!m,selectLastIndex:!!g,axis:$})},833693:(s,m)=>{r.Ra("Softmax",s,{axis:m})},833756:(s,m)=>{r.Ra("Concat",s,{axis:m})},833816:(s,m,g,$,T)=>{r.Ra("Split",s,{axis:m,numOutputs:g,splitSizes:$?Array.from(W.subarray($>>>0,T>>>0)):[]})},833956:s=>{r.Ra("Expand",s,void 0)},834010:(s,m)=>{r.Ra("Gather",s,{axis:Number(m)})},834081:(s,m)=>{r.Ra("GatherElements",s,{axis:Number(m)})},834160:(s,m,g,$,T,B,H,q,te,X,de)=>{r.Ra("Resize",s,{antialias:m,axes:g?Array.from(W.subarray(g>>>0,$>>>0)):[],coordinateTransformMode:je(T),cubicCoeffA:B,excludeOutside:H,extrapolationValue:q,keepAspectRatioPolicy:je(te),mode:je(X),nearestMode:je(de)})},834506:(s,m,g,$,T,B,H)=>{r.Ra("Slice",s,{starts:m?Array.from(W.subarray(m>>>0,g>>>0)):[],ends:$?Array.from(W.subarray($>>>0,T>>>0)):[],axes:B?Array.from(W.subarray(B>>>0,H>>>0)):[]})},834722:s=>{r.Ra("Tile",s,void 0)},834774:(s,m,g,$)=>{r.Ra("LayerNormalization",s,{axis:m,epsilon:g,simplified:!!$})},834885:(s,m,g)=>{r.Ra("InstanceNormalization",s,{epsilon:m,format:g?"NHWC":"NCHW"})},834999:(s,m,g)=>{r.Ra("InstanceNormalization",s,{epsilon:m,format:g?"NHWC":"NCHW"})},835113:s=>{r.Ra("Range",s,void 0)},835166:(s,m)=>{r.Ra("Einsum",s,{equation:je(m)})},835247:(s,m,g,$,T)=>{r.Ra("Pad",s,{mode:m,value:g,pads:$?Array.from(W.subarray($>>>0,T>>>0)):[]})},835374:(s,m,g,$,T,B)=>{r.Ra("BatchNormalization",s,{epsilon:m,momentum:g,spatial:!!T,trainingMode:!!$,format:B?"NHWC":"NCHW"})},835543:(s,m,g,$,T,B)=>{r.Ra("BatchNormalization",s,{epsilon:m,momentum:g,spatial:!!T,trainingMode:!!$,format:B?"NHWC":"NCHW"})},835712:(s,m,g)=>{r.Ra("CumSum",s,{exclusive:Number(m),reverse:Number(g)})},835809:(s,m,g,$,T,B,H,q,te)=>{r.Ra("Attention",s,{numHeads:m,isUnidirectional:g,maskFilterValue:$,scale:T,doRotary:B,qkvHiddenSizes:H?Array.from(W.subarray(Number(q)>>>0,Number(q)+H>>>0)):[],pastPresentShareBuffer:!!te})},836081:s=>{r.Ra("BiasAdd",s,void 0)},836136:s=>{r.Ra("BiasSplitGelu",s,void 0)},836197:s=>{r.Ra("FastGelu",s,void 0)},836253:(s,m,g,$,T,B,H,q,te,X,de,Ee,Oe)=>{r.Ra("Conv",s,{format:te?"NHWC":"NCHW",auto_pad:m,dilations:[g],group:$,kernel_shape:[T],pads:B?Array.from(W.subarray(B>>>0,H>>>0)):[],strides:[q],w_is_const:()=>!!N[X>>>0],activation:je(de),activation_params:Ee?Array.from(Ce.subarray(Ee>>>0,Oe>>>0)):[]})},836623:(s,m,g,$,T,B,H,q,te,X,de,Ee,Oe,D,be,Ie)=>{r.Ra("Conv",s,{format:Ee?"NHWC":"NCHW",auto_pad:m,dilations:[g,$],group:T,kernel_shape:[B,H],pads:q?Array.from(W.subarray(q>>>0,te>>>0)):[],strides:[X,de],w_is_const:()=>!!N[Oe>>>0],activation:je(D),activation_params:be?Array.from(Ce.subarray(be>>>0,Ie>>>0)):[]})},837014:s=>{r.Ra("Gelu",s,void 0)},837066:(s,m,g,$,T,B)=>{r.Ra("MatMulNBits",s,{k:m,n:g,accuracyLevel:$,bits:T,blockSize:B})},837193:(s,m,g,$,T,B)=>{r.Ra("MultiHeadAttention",s,{numHeads:m,isUnidirectional:g,maskFilterValue:$,scale:T,doRotary:B})},837352:(s,m,g,$,T)=>{r.Ra("RotaryEmbedding",s,{interleaved:!!m,numHeads:g,rotaryEmbeddingDim:$,scale:T})},837491:(s,m,g)=>{r.Ra("SkipLayerNormalization",s,{epsilon:m,simplified:!!g})},837593:(s,m,g)=>{r.Ra("SkipLayerNormalization",s,{epsilon:m,simplified:!!g})},837695:(s,m,g,$)=>{r.Ra("LayerNormalization",s,{axis:m,epsilon:g,simplified:!!$})},837806:s=>{r.ub(s)},837840:(s,m)=>r.wb(s,m,r.cb.xb,r.cb.errors)};function qt(s){this.name="ExitStatus",this.message=`Program terminated with exit(${s})`,this.status=s}class Vt{constructor(m){this.hb=m-24}}var sr=0,jt=0,xr=typeof TextDecoder<"u"?new TextDecoder("utf8"):void 0,Kt=(s,m,g)=>{m>>>=0;var $=m+g;for(g=m;s[g]&&!(g>=$);)++g;if(16<g-m&&s.buffer&&xr)return xr.decode(s.subarray(m,g));for($="";m<g;){var T=s[m++];if(T&128){var B=s[m++]&63;if((T&224)==192)$+=String.fromCharCode((T&31)<<6|B);else{var H=s[m++]&63;T=(T&240)==224?(T&15)<<12|B<<6|H:(T&7)<<18|B<<12|H<<6|s[m++]&63,65536>T?$+=String.fromCharCode(T):(T-=65536,$+=String.fromCharCode(55296|T>>10,56320|T&1023))}}else $+=String.fromCharCode(T)}return $},je=(s,m)=>(s>>>=0)?Kt(K,s,m):"",Wt=s=>{for(var m=0,g=0;g<s.length;++g){var $=s.charCodeAt(g);127>=$?m++:2047>=$?m+=2:55296<=$&&57343>=$?(m+=4,++g):m+=3}return m},at=(s,m,g,$)=>{if(g>>>=0,!(0<$))return 0;var T=g;$=g+$-1;for(var B=0;B<s.length;++B){var H=s.charCodeAt(B);if(55296<=H&&57343>=H){var q=s.charCodeAt(++B);H=65536+((H&1023)<<10)|q&1023}if(127>=H){if(g>=$)break;m[g++>>>0]=H}else{if(2047>=H){if(g+1>=$)break;m[g++>>>0]=192|H>>6}else{if(65535>=H){if(g+2>=$)break;m[g++>>>0]=224|H>>12}else{if(g+3>=$)break;m[g++>>>0]=240|H>>18,m[g++>>>0]=128|H>>12&63}m[g++>>>0]=128|H>>6&63}m[g++>>>0]=128|H&63}}return m[g>>>0]=0,g-T},Cr,ft=s=>{for(var m="";K[s>>>0];)m+=Cr[K[s++>>>0]];return m},ur={},Ar={},Ir={},st;function Tr(s,m,g={}){var $=m.name;if(!s)throw new st(`type "${$}" must have a positive integer typeid pointer`);if(Ar.hasOwnProperty(s)){if(g.nb)return;throw new st(`Cannot register type \'${$}\' twice`)}Ar[s]=m,delete Ir[s],ur.hasOwnProperty(s)&&(m=ur[s],delete ur[s],m.forEach(T=>T()))}function ht(s,m,g={}){if(!("argPackAdvance"in m))throw new TypeError("registerType registeredInstance requires argPackAdvance");return Tr(s,m,g)}var bt=(s,m,g)=>{switch(m){case 1:return g?$=>N[$>>>0]:$=>K[$>>>0];case 2:return g?$=>Q[$>>>1>>>0]:$=>he[$>>>1>>>0];case 4:return g?$=>W[$>>>2>>>0]:$=>se[$>>>2>>>0];case 8:return g?$=>We[$>>>3]:$=>ee[$>>>3];default:throw new TypeError(`invalid integer width (${m}): ${s}`)}},Er=[],Te=[];function dr(s){s>>>=0,9<s&&--Te[s+1]===0&&(Te[s]=void 0,Er.push(s))}var Xe=s=>{if(!s)throw new st("Cannot use deleted val. handle = "+s);return Te[s]},ut=s=>{switch(s){case void 0:return 2;case null:return 4;case!0:return 6;case!1:return 8;default:let m=Er.pop()||Te.length;return Te[m]=s,Te[m+1]=1,m}};function lr(s){return this.fromWireType(se[s>>>2>>>0])}var Fn={name:"emscripten::val",fromWireType:s=>{var m=Xe(s);return dr(s),m},toWireType:(s,m)=>ut(m),argPackAdvance:8,readValueFromPointer:lr,bb:null},ge=(s,m)=>{switch(m){case 4:return function(g){return this.fromWireType(Ce[g>>>2>>>0])};case 8:return function(g){return this.fromWireType(ae[g>>>3>>>0])};default:throw new TypeError(`invalid float width (${m}): ${s}`)}},Yt=typeof TextDecoder<"u"?new TextDecoder("utf-16le"):void 0,jr=(s,m)=>{for(var g=s>>1,$=g+m/2;!(g>=$)&&he[g>>>0];)++g;if(g<<=1,32<g-s&&Yt)return Yt.decode(K.subarray(s>>>0,g>>>0));for(g="",$=0;!($>=m/2);++$){var T=Q[s+2*$>>>1>>>0];if(T==0)break;g+=String.fromCharCode(T)}return g},qn=(s,m,g)=>{if(g??=2147483647,2>g)return 0;g-=2;var $=m;g=g<2*s.length?g/2:s.length;for(var T=0;T<g;++T)Q[m>>>1>>>0]=s.charCodeAt(T),m+=2;return Q[m>>>1>>>0]=0,m-$},Kr=s=>2*s.length,jn=(s,m)=>{for(var g=0,$="";!(g>=m/4);){var T=W[s+4*g>>>2>>>0];if(T==0)break;++g,65536<=T?(T-=65536,$+=String.fromCharCode(55296|T>>10,56320|T&1023)):$+=String.fromCharCode(T)}return $},Yr=(s,m,g)=>{if(m>>>=0,g??=2147483647,4>g)return 0;var $=m;g=$+g-4;for(var T=0;T<s.length;++T){var B=s.charCodeAt(T);if(55296<=B&&57343>=B){var H=s.charCodeAt(++T);B=65536+((B&1023)<<10)|H&1023}if(W[m>>>2>>>0]=B,m+=4,m+4>g)break}return W[m>>>2>>>0]=0,m-$},Zr=s=>{for(var m=0,g=0;g<s.length;++g){var $=s.charCodeAt(g);55296<=$&&57343>=$&&++g,m+=4}return m},cr=(s,m)=>{var g=Ar[s];if(g===void 0)throw s=Mr(s),g=ft(s),rt(s),new st(`${m} has unknown type ${g}`);return g},Pr=(s,m,g)=>{var $=[];return s=s.toWireType($,g),$.length&&(se[m>>>2>>>0]=ut($)),s},He=s=>{try{s()}catch(m){ne(m)}},Xr=s=>{if(!R)try{s();try{L=L=s=L,r.onExit?.(s),R=!0,h(s,new qt(s))}catch(m){m instanceof qt||m=="unwind"||h(1,m)}}catch(m){m instanceof qt||m=="unwind"||h(1,m)}};function Qr(){var s=pe,m={};for(let[g,$]of Object.entries(s))m[g]=typeof $=="function"?(...T)=>{Zt.push(g);try{return $(...T)}finally{R||(Zt.pop(),dt&&gt===1&&Zt.length===0&&(gt=0,He(dn),typeof Fibers<"u"&&Fibers.Db()))}}:$;return m}var gt=0,dt=null,Bt=0,Zt=[],kr={},Or={},Jr=0,pr=null,en=[];function tn(){return new Promise((s,m)=>{pr={resolve:s,reject:m}})}function rn(){var s=Nt(65548),m=s+12;se[s>>>2>>>0]=m,se[s+4>>>2>>>0]=m+65536,m=Zt[0];var g=kr[m];return g===void 0&&(g=Jr++,kr[m]=g,Or[g]=m),W[s+8>>>2>>>0]=g,s}function nn(s){if(!R){if(gt===0){var m=!1,g=!1;s(($=0)=>{if(!R&&(Bt=$,m=!0,g)){gt=2,He(()=>vt(dt)),typeof Browser<"u"&&Browser.ib.mb&&Browser.ib.resume(),$=!1;try{var T=(0,pe[Or[W[dt+8>>>2>>>0]]])()}catch(q){T=q,$=!0}var B=!1;if(!dt){var H=pr;H&&(pr=null,($?H.reject:H.resolve)(T),B=!0)}if($&&!B)throw T}}),g=!0,m||(gt=1,dt=rn(),typeof Browser<"u"&&Browser.ib.mb&&Browser.ib.pause(),He(()=>Jt(dt)))}else gt===2?(gt=0,He(ct),rt(dt),dt=null,en.forEach(Xr)):ne(`invalid state: ${gt}`);return Bt}}function Rr(s){return nn(m=>{s().then(m)})}var Xt=[],on={},nt=s=>{var m=on[s];return m===void 0?ft(s):m},mr=()=>typeof globalThis=="object"?globalThis:Function("return this")(),Br=s=>{var m=Xt.length;return Xt.push(s),m},Kn=(s,m)=>{for(var g=Array(s),$=0;$<s;++$)g[$]=cr(se[m+4*$>>>2>>>0],"parameter "+$);return g},wt=(s,m)=>Object.defineProperty(m,"name",{value:s});function Yn(s){var m=Function;if(!(m instanceof Function))throw new TypeError(`new_ called with constructor type ${typeof m} which is not a function`);var g=wt(m.name||"unknownFunctionName",function(){});return g.prototype=m.prototype,g=new g,s=m.apply(g,s),s instanceof Object?s:g}var Je=s=>s%4===0&&(s%100!==0||s%400===0),Dr=[0,31,60,91,121,152,182,213,244,274,305,335],fr=[0,31,59,90,120,151,181,212,243,273,304,334],lt=[],hr=(s,m)=>{lt.length=0;for(var g;g=K[s++>>>0];){var $=g!=105;$&=g!=112,m+=$&&m%8?4:0,lt.push(g==112?se[m>>>2>>>0]:g==106?We[m>>>3]:g==105?W[m>>>2>>>0]:ae[m>>>3>>>0]),m+=$?8:4}return lt},Qe={},ot=()=>{if(!Qt){var s={USER:"web_user",LOGNAME:"web_user",PATH:"/",PWD:"/",HOME:"/home/web_user",LANG:(typeof navigator=="object"&&navigator.languages&&navigator.languages[0]||"C").replace("-","_")+".UTF-8",_:p||"./this.program"},m;for(m in Qe)Qe[m]===void 0?delete s[m]:s[m]=Qe[m];var g=[];for(m in s)g.push(`${m}=${s[m]}`);Qt=g}return Qt},Qt,Zn=[null,[],[]],an=[31,29,31,30,31,30,31,31,30,31,30,31],zr=[31,28,31,30,31,30,31,31,30,31,30,31];function Xn(s){var m=Array(Wt(s)+1);return at(s,m,0,m.length),m}function sn(s,m,g,$){function T(D,be,Ie){for(D=typeof D=="number"?D.toString():D||"";D.length<be;)D=Ie[0]+D;return D}function B(D,be){return T(D,be,"0")}function H(D,be){function Ie(Mt){return 0>Mt?-1:0<Mt?1:0}var zt;return(zt=Ie(D.getFullYear()-be.getFullYear()))===0&&(zt=Ie(D.getMonth()-be.getMonth()))===0&&(zt=Ie(D.getDate()-be.getDate())),zt}function q(D){switch(D.getDay()){case 0:return new Date(D.getFullYear()-1,11,29);case 1:return D;case 2:return new Date(D.getFullYear(),0,3);case 3:return new Date(D.getFullYear(),0,2);case 4:return new Date(D.getFullYear(),0,1);case 5:return new Date(D.getFullYear()-1,11,31);case 6:return new Date(D.getFullYear()-1,11,30)}}function te(D){var be=D.$a;for(D=new Date(new Date(D.ab+1900,0,1).getTime());0<be;){var Ie=D.getMonth(),zt=(Je(D.getFullYear())?an:zr)[Ie];if(be>zt-D.getDate())be-=zt-D.getDate()+1,D.setDate(1),11>Ie?D.setMonth(Ie+1):(D.setMonth(0),D.setFullYear(D.getFullYear()+1));else{D.setDate(D.getDate()+be);break}}return Ie=new Date(D.getFullYear()+1,0,4),be=q(new Date(D.getFullYear(),0,4)),Ie=q(Ie),0>=H(be,D)?0>=H(Ie,D)?D.getFullYear()+1:D.getFullYear():D.getFullYear()-1}s>>>=0,m>>>=0,g>>>=0,$>>>=0;var X=se[$+40>>>2>>>0];$={Ab:W[$>>>2>>>0],zb:W[$+4>>>2>>>0],fb:W[$+8>>>2>>>0],jb:W[$+12>>>2>>>0],gb:W[$+16>>>2>>>0],ab:W[$+20>>>2>>>0],Va:W[$+24>>>2>>>0],$a:W[$+28>>>2>>>0],Cb:W[$+32>>>2>>>0],yb:W[$+36>>>2>>>0],Bb:X?je(X):""},g=je(g),X={"%c":"%a %b %d %H:%M:%S %Y","%D":"%m/%d/%y","%F":"%Y-%m-%d","%h":"%b","%r":"%I:%M:%S %p","%R":"%H:%M","%T":"%H:%M:%S","%x":"%m/%d/%y","%X":"%H:%M:%S","%Ec":"%c","%EC":"%C","%Ex":"%m/%d/%y","%EX":"%H:%M:%S","%Ey":"%y","%EY":"%Y","%Od":"%d","%Oe":"%e","%OH":"%H","%OI":"%I","%Om":"%m","%OM":"%M","%OS":"%S","%Ou":"%u","%OU":"%U","%OV":"%V","%Ow":"%w","%OW":"%W","%Oy":"%y"};for(var de in X)g=g.replace(new RegExp(de,"g"),X[de]);var Ee="Sunday Monday Tuesday Wednesday Thursday Friday Saturday".split(" "),Oe="January February March April May June July August September October November December".split(" ");X={"%a":D=>Ee[D.Va].substring(0,3),"%A":D=>Ee[D.Va],"%b":D=>Oe[D.gb].substring(0,3),"%B":D=>Oe[D.gb],"%C":D=>B((D.ab+1900)/100|0,2),"%d":D=>B(D.jb,2),"%e":D=>T(D.jb,2," "),"%g":D=>te(D).toString().substring(2),"%G":te,"%H":D=>B(D.fb,2),"%I":D=>(D=D.fb,D==0?D=12:12<D&&(D-=12),B(D,2)),"%j":D=>{for(var be=0,Ie=0;Ie<=D.gb-1;be+=(Je(D.ab+1900)?an:zr)[Ie++]);return B(D.jb+be,3)},"%m":D=>B(D.gb+1,2),"%M":D=>B(D.zb,2),"%n":()=>`\n`,"%p":D=>0<=D.fb&&12>D.fb?"AM":"PM","%S":D=>B(D.Ab,2),"%t":()=>"	","%u":D=>D.Va||7,"%U":D=>B(Math.floor((D.$a+7-D.Va)/7),2),"%V":D=>{var be=Math.floor((D.$a+7-(D.Va+6)%7)/7);if(2>=(D.Va+371-D.$a-2)%7&&be++,be)be==53&&(Ie=(D.Va+371-D.$a)%7,Ie==4||Ie==3&&Je(D.ab)||(be=1));else{be=52;var Ie=(D.Va+7-D.$a-1)%7;(Ie==4||Ie==5&&Je(D.ab%400-1))&&be++}return B(be,2)},"%w":D=>D.Va,"%W":D=>B(Math.floor((D.$a+7-(D.Va+6)%7)/7),2),"%y":D=>(D.ab+1900).toString().substring(2),"%Y":D=>D.ab+1900,"%z":D=>{D=D.yb;var be=0<=D;return D=Math.abs(D)/60,(be?"+":"-")+("0000"+(D/60*100+D%60)).slice(-4)},"%Z":D=>D.Bb,"%%":()=>"%"},g=g.replace(/%%/g,"\\0\\0");for(de in X)g.includes(de)&&(g=g.replace(new RegExp(de,"g"),X[de]($)));return g=g.replace(/\\0\\0/g,"%"),de=Xn(g),de.length>m?0:(N.set(de,s>>>0),de.length-1)}for(var un=Array(256),gr=0;256>gr;++gr)un[gr]=String.fromCharCode(gr);Cr=un,st=r.BindingError=class extends Error{constructor(s){super(s),this.name="BindingError"}},r.InternalError=class extends Error{constructor(s){super(s),this.name="InternalError"}},Te.push(0,1,void 0,1,null,1,!0,1,!1,1),r.count_emval_handles=()=>Te.length/2-5-Er.length;var Qn={ia:function(s,m,g){return Rr(async()=>{await r.sb(s,m,g)})},a:function(s,m,g){s>>>=0;var $=new Vt(s);throw se[$.hb+16>>>2>>>0]=0,se[$.hb+4>>>2>>>0]=m>>>0,se[$.hb+8>>>2>>>0]=g>>>0,sr=s,jt++,sr},y:function(){return 0},ea:function(){},R:function(){},T:function(){},ga:function(){return 0},ca:function(){},Z:function(){},ba:function(){},G:function(){},S:function(){},P:function(){},da:function(){},Q:function(){},C:function(s,m,g){m=ft(m>>>0),ht(s>>>0,{name:m,fromWireType:$=>$,toWireType:function($,T){if(typeof T!="bigint"&&typeof T!="number")throw T===null?T="null":($=typeof T,T=$==="object"||$==="array"||$==="function"?T.toString():""+T),new TypeError(`Cannot convert "${T}" to ${this.name}`);return typeof T=="number"&&(T=BigInt(T)),T},argPackAdvance:8,readValueFromPointer:bt(m,g>>>0,m.indexOf("u")==-1),bb:null})},K:function(s,m,g,$){m=ft(m>>>0),ht(s>>>0,{name:m,fromWireType:function(T){return!!T},toWireType:function(T,B){return B?g:$},argPackAdvance:8,readValueFromPointer:function(T){return this.fromWireType(K[T>>>0])},bb:null})},J:function(s){return ht(s>>>0,Fn)},B:function(s,m,g){m=ft(m>>>0),ht(s>>>0,{name:m,fromWireType:$=>$,toWireType:($,T)=>T,argPackAdvance:8,readValueFromPointer:ge(m,g>>>0),bb:null})},s:function(s,m,g,$,T){if(s>>>=0,g>>>=0,m=ft(m>>>0),T===-1&&(T=4294967295),T=q=>q,$===0){var B=32-8*g;T=q=>q<<B>>>B}var H=m.includes("unsigned")?function(q,te){return te>>>0}:function(q,te){return te};ht(s,{name:m,fromWireType:T,toWireType:H,argPackAdvance:8,readValueFromPointer:bt(m,g,$!==0),bb:null})},o:function(s,m,g){function $(B){return new T(N.buffer,se[B+4>>>2>>>0],se[B>>>2>>>0])}var T=[Int8Array,Uint8Array,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array,BigInt64Array,BigUint64Array][m];g=ft(g>>>0),ht(s>>>0,{name:g,fromWireType:$,argPackAdvance:8,readValueFromPointer:$},{nb:!0})},D:function(s,m){m=ft(m>>>0);var g=m==="std::string";ht(s>>>0,{name:m,fromWireType:function($){var T=se[$>>>2>>>0],B=$+4;if(g)for(var H=B,q=0;q<=T;++q){var te=B+q;if(q==T||K[te>>>0]==0){if(H=je(H,te-H),X===void 0)var X=H;else X+=String.fromCharCode(0),X+=H;H=te+1}}else{for(X=Array(T),q=0;q<T;++q)X[q]=String.fromCharCode(K[B+q>>>0]);X=X.join("")}return rt($),X},toWireType:function($,T){T instanceof ArrayBuffer&&(T=new Uint8Array(T));var B=typeof T=="string";if(!(B||T instanceof Uint8Array||T instanceof Uint8ClampedArray||T instanceof Int8Array))throw new st("Cannot pass non-string to std::string");var H=g&&B?Wt(T):T.length,q=Nt(4+H+1),te=q+4;if(se[q>>>2>>>0]=H,g&&B)at(T,K,te,H+1);else if(B)for(B=0;B<H;++B){var X=T.charCodeAt(B);if(255<X)throw rt(te),new st("String has UTF-16 code units that do not fit in 8 bits");K[te+B>>>0]=X}else for(B=0;B<H;++B)K[te+B>>>0]=T[B];return $!==null&&$.push(rt,q),q},argPackAdvance:8,readValueFromPointer:lr,bb($){rt($)}})},x:function(s,m,g){if(m>>>=0,g>>>=0,g=ft(g),m===2)var $=jr,T=qn,B=Kr,H=q=>he[q>>>1>>>0];else m===4&&($=jn,T=Yr,B=Zr,H=q=>se[q>>>2>>>0]);ht(s>>>0,{name:g,fromWireType:q=>{for(var te=se[q>>>2>>>0],X,de=q+4,Ee=0;Ee<=te;++Ee){var Oe=q+4+Ee*m;(Ee==te||H(Oe)==0)&&(de=$(de,Oe-de),X===void 0?X=de:(X+=String.fromCharCode(0),X+=de),de=Oe+m)}return rt(q),X},toWireType:(q,te)=>{if(typeof te!="string")throw new st(`Cannot pass non-string to C++ string type ${g}`);var X=B(te),de=Nt(4+X+m);return se[de>>>2>>>0]=X/m,T(te,de+4,X+m),q!==null&&q.push(rt,de),de},argPackAdvance:8,readValueFromPointer:lr,bb(q){rt(q)}})},L:function(s,m){m=ft(m>>>0),ht(s>>>0,{ob:!0,name:m,argPackAdvance:0,fromWireType:()=>{},toWireType:()=>{}})},ha:()=>1,u:function(s,m,g){return m>>>=0,g>>>=0,s=Xe(s>>>0),m=cr(m,"emval::as"),Pr(m,g,s)},w:function(s){return s>>>=0,Rr(()=>(s=Xe(s),s.then(ut)))},n:function(s,m,g,$){return g>>>=0,$>>>=0,s=Xt[s>>>0],m=Xe(m>>>0),s(null,m,g,$)},j:function(s,m,g,$,T){return g>>>=0,$>>>=0,T>>>=0,s=Xt[s>>>0],m=Xe(m>>>0),g=nt(g),s(m,m[g],$,T)},b:dr,A:function(s,m){return m>>>=0,s=Xe(s>>>0),m=Xe(m),s==m},m:function(s){return s>>>=0,s===0?ut(mr()):(s=nt(s),ut(mr()[s]))},i:function(s,m,g){m=Kn(s,m>>>0);var $=m.shift();s--;var T=`return function (obj, func, destructorsRef, args) {\n`,B=0,H=[];g===0&&H.push("obj");for(var q=["retType"],te=[$],X=0;X<s;++X)H.push("arg"+X),q.push("argType"+X),te.push(m[X]),T+=`  var arg${X} = argType${X}.readValueFromPointer(args${B?"+"+B:""});\n`,B+=m[X].argPackAdvance;return T+=`  var rv = ${g===1?"new func":"func.call"}(${H.join(", ")});\n`,$.ob||(q.push("emval_returnValue"),te.push(Pr),T+=`  return emval_returnValue(retType, destructorsRef, rv);\n`),q.push(T+`};\n`),s=Yn(q)(...te),g=`methodCaller<(${m.map(de=>de.name).join(", ")}) => ${$.name}>`,Br(wt(g,s))},r:function(s,m){return m>>>=0,s=Xe(s>>>0),m=Xe(m),ut(s[m])},e:function(s){s>>>=0,9<s&&(Te[s+1]+=1)},t:function(){return ut([])},l:function(s){s=Xe(s>>>0);for(var m=Array(s.length),g=0;g<s.length;g++)m[g]=s[g];return ut(m)},f:function(s){return ut(nt(s>>>0))},k:function(){return ut({})},h:function(s){s>>>=0;for(var m=Xe(s);m.length;){var g=m.pop();m.pop()(g)}dr(s)},g:function(s,m,g){m>>>=0,g>>>=0,s=Xe(s>>>0),m=Xe(m),g=Xe(g),s[m]=g},c:function(s,m){return m>>>=0,s=cr(s>>>0,"_emval_take_value"),s=s.readValueFromPointer(m),ut(s)},W:function(s,m){s=-9007199254740992>s||9007199254740992<s?NaN:Number(s),m>>>=0,s=new Date(1e3*s),W[m>>>2>>>0]=s.getUTCSeconds(),W[m+4>>>2>>>0]=s.getUTCMinutes(),W[m+8>>>2>>>0]=s.getUTCHours(),W[m+12>>>2>>>0]=s.getUTCDate(),W[m+16>>>2>>>0]=s.getUTCMonth(),W[m+20>>>2>>>0]=s.getUTCFullYear()-1900,W[m+24>>>2>>>0]=s.getUTCDay(),W[m+28>>>2>>>0]=(s.getTime()-Date.UTC(s.getUTCFullYear(),0,1,0,0,0,0))/864e5|0},X:function(s,m){s=-9007199254740992>s||9007199254740992<s?NaN:Number(s),m>>>=0,s=new Date(1e3*s),W[m>>>2>>>0]=s.getSeconds(),W[m+4>>>2>>>0]=s.getMinutes(),W[m+8>>>2>>>0]=s.getHours(),W[m+12>>>2>>>0]=s.getDate(),W[m+16>>>2>>>0]=s.getMonth(),W[m+20>>>2>>>0]=s.getFullYear()-1900,W[m+24>>>2>>>0]=s.getDay(),W[m+28>>>2>>>0]=(Je(s.getFullYear())?Dr:fr)[s.getMonth()]+s.getDate()-1|0,W[m+36>>>2>>>0]=-(60*s.getTimezoneOffset());var g=new Date(s.getFullYear(),6,1).getTimezoneOffset(),$=new Date(s.getFullYear(),0,1).getTimezoneOffset();W[m+32>>>2>>>0]=(g!=$&&s.getTimezoneOffset()==Math.min($,g))|0},Y:function(s){s>>>=0;var m=new Date(W[s+20>>>2>>>0]+1900,W[s+16>>>2>>>0],W[s+12>>>2>>>0],W[s+8>>>2>>>0],W[s+4>>>2>>>0],W[s>>>2>>>0],0),g=W[s+32>>>2>>>0],$=m.getTimezoneOffset(),T=new Date(m.getFullYear(),6,1).getTimezoneOffset(),B=new Date(m.getFullYear(),0,1).getTimezoneOffset(),H=Math.min(B,T);return 0>g?W[s+32>>>2>>>0]=+(T!=B&&H==$):0<g!=(H==$)&&(T=Math.max(B,T),m.setTime(m.getTime()+6e4*((0<g?H:T)-$))),W[s+24>>>2>>>0]=m.getDay(),W[s+28>>>2>>>0]=(Je(m.getFullYear())?Dr:fr)[m.getMonth()]+m.getDate()-1|0,W[s>>>2>>>0]=m.getSeconds(),W[s+4>>>2>>>0]=m.getMinutes(),W[s+8>>>2>>>0]=m.getHours(),W[s+12>>>2>>>0]=m.getDate(),W[s+16>>>2>>>0]=m.getMonth(),W[s+20>>>2>>>0]=m.getYear(),s=m.getTime(),BigInt(isNaN(s)?-1:s/1e3)},U:function(){return-52},V:function(){},N:function(s,m,g,$){g>>>=0,$>>>=0;var T=new Date().getFullYear(),B=new Date(T,0,1),H=new Date(T,6,1);T=B.getTimezoneOffset();var q=H.getTimezoneOffset();se[s>>>0>>>2>>>0]=60*Math.max(T,q),W[m>>>0>>>2>>>0]=+(T!=q),s=te=>te.toLocaleTimeString(void 0,{hour12:!1,timeZoneName:"short"}).split(" ")[1],B=s(B),H=s(H),q<T?(at(B,K,g,17),at(H,K,$,17)):(at(B,K,$,17),at(H,K,g,17))},v:()=>{ne("")},d:function(s,m,g){return s>>>=0,m=hr(m>>>0,g>>>0),Rt[s](...m)},I:function(s,m,g){return s>>>=0,m=hr(m>>>0,g>>>0),Rt[s](...m)},H:()=>Date.now(),O:function(){return 4294901760},q:()=>performance.now(),M:function(s){s>>>=0;var m=K.length;if(4294901760<s)return!1;for(var g=1;4>=g;g*=2){var $=m*(1+.2/g);$=Math.min($,s+100663296);var T=Math;$=Math.max(s,$);e:{T=(T.min.call(T,4294901760,$+(65536-$%65536)%65536)-O.buffer.byteLength+65535)/65536;try{O.grow(T),Ae();var B=1;break e}catch{}B=void 0}if(B)return!0}return!1},$:function(s,m){s>>>=0,m>>>=0;var g=0;return ot().forEach(($,T)=>{var B=m+g;for(T=se[s+4*T>>>2>>>0]=B,B=0;B<$.length;++B)N[T++>>>0]=$.charCodeAt(B);N[T>>>0]=0,g+=$.length+1}),0},aa:function(s,m){s>>>=0,m>>>=0;var g=ot();se[s>>>2>>>0]=g.length;var $=0;return g.forEach(T=>$+=T.length+1),se[m>>>2>>>0]=$,0},z:()=>52,F:function(){return 52},_:function(){return 70},E:function(s,m,g,$){m>>>=0,g>>>=0,$>>>=0;for(var T=0,B=0;B<g;B++){var H=se[m>>>2>>>0],q=se[m+4>>>2>>>0];m+=8;for(var te=0;te<q;te++){var X=K[H+te>>>0],de=Zn[s];X===0||X===10?((s===1?E:P)(Kt(de,0)),de.length=0):de.push(X)}T+=q}return se[$>>>2>>>0]=T,0},fa:sn,p:function(s,m,g,$){return sn(s>>>0,m>>>0,g>>>0,$>>>0)}},pe=function(){function s(g){return pe=g.exports,pe=Qr(),pe=ln(),O=pe.ja,Ae(),ie.unshift(pe.ka),le--,le==0&&(qe!==null&&(clearInterval(qe),qe=null),G&&(g=G,G=null,g())),pe}var m={a:Qn};if(le++,r.instantiateWasm)try{return r.instantiateWasm(m,s)}catch(g){P(`Module.instantiateWasm callback failed with error: ${g}`),i(g)}return mt(m,function(g){s(g.instance)}).catch(i),{}}(),Mr=s=>(Mr=pe.la)(s);r._OrtInit=(s,m)=>(r._OrtInit=pe.ma)(s,m),r._OrtGetLastError=(s,m)=>(r._OrtGetLastError=pe.na)(s,m),r._OrtCreateSessionOptions=(s,m,g,$,T,B,H,q,te,X)=>(r._OrtCreateSessionOptions=pe.oa)(s,m,g,$,T,B,H,q,te,X),r._OrtAppendExecutionProvider=(s,m)=>(r._OrtAppendExecutionProvider=pe.pa)(s,m),r._OrtAddFreeDimensionOverride=(s,m,g)=>(r._OrtAddFreeDimensionOverride=pe.qa)(s,m,g),r._OrtAddSessionConfigEntry=(s,m,g)=>(r._OrtAddSessionConfigEntry=pe.ra)(s,m,g),r._OrtReleaseSessionOptions=s=>(r._OrtReleaseSessionOptions=pe.sa)(s),r._OrtCreateSession=(s,m,g)=>(r._OrtCreateSession=pe.ta)(s,m,g),r._OrtReleaseSession=s=>(r._OrtReleaseSession=pe.ua)(s),r._OrtGetInputOutputCount=(s,m,g)=>(r._OrtGetInputOutputCount=pe.va)(s,m,g),r._OrtGetInputName=(s,m)=>(r._OrtGetInputName=pe.wa)(s,m),r._OrtGetOutputName=(s,m)=>(r._OrtGetOutputName=pe.xa)(s,m),r._OrtFree=s=>(r._OrtFree=pe.ya)(s),r._OrtCreateTensor=(s,m,g,$,T,B)=>(r._OrtCreateTensor=pe.za)(s,m,g,$,T,B),r._OrtGetTensorData=(s,m,g,$,T)=>(r._OrtGetTensorData=pe.Aa)(s,m,g,$,T),r._OrtReleaseTensor=s=>(r._OrtReleaseTensor=pe.Ba)(s),r._OrtCreateRunOptions=(s,m,g,$)=>(r._OrtCreateRunOptions=pe.Ca)(s,m,g,$),r._OrtAddRunConfigEntry=(s,m,g)=>(r._OrtAddRunConfigEntry=pe.Da)(s,m,g),r._OrtReleaseRunOptions=s=>(r._OrtReleaseRunOptions=pe.Ea)(s),r._OrtCreateBinding=s=>(r._OrtCreateBinding=pe.Fa)(s),r._OrtBindInput=(s,m,g)=>(r._OrtBindInput=pe.Ga)(s,m,g),r._OrtBindOutput=(s,m,g,$)=>(r._OrtBindOutput=pe.Ha)(s,m,g,$),r._OrtClearBoundOutputs=s=>(r._OrtClearBoundOutputs=pe.Ia)(s),r._OrtReleaseBinding=s=>(r._OrtReleaseBinding=pe.Ja)(s),r._OrtRunWithBinding=(s,m,g,$,T)=>(r._OrtRunWithBinding=pe.Ka)(s,m,g,$,T),r._OrtRun=(s,m,g,$,T,B,H,q)=>(r._OrtRun=pe.La)(s,m,g,$,T,B,H,q),r._OrtEndProfiling=s=>(r._OrtEndProfiling=pe.Ma)(s),r._JsepOutput=(s,m,g)=>(r._JsepOutput=pe.Na)(s,m,g),r._JsepGetNodeName=s=>(r._JsepGetNodeName=pe.Oa)(s);var Nt=r._malloc=s=>(Nt=r._malloc=pe.Pa)(s),rt=r._free=s=>(rt=r._free=pe.Qa)(s),yr=s=>(yr=pe.Sa)(s),br=s=>(br=pe.Ta)(s),Ur=()=>(Ur=pe.Ua)(),Jt=s=>(Jt=pe.Wa)(s),dn=()=>(dn=pe.Xa)(),vt=s=>(vt=pe.Ya)(s),ct=()=>(ct=pe.Za)();r.___start_em_js=837952,r.___stop_em_js=838113;function ln(){var s=pe;s=Object.assign({},s);var m=g=>$=>g($)>>>0;return s.la=m(s.la),s.Pa=m(s.Pa),s.Ta=m(s.Ta),s.Ua=(g=>()=>g()>>>0)(s.Ua),s}r.stackSave=()=>Ur(),r.stackRestore=s=>yr(s),r.stackAlloc=s=>br(s),r.UTF8ToString=je,r.stringToUTF8=(s,m,g)=>at(s,K,m,g),r.lengthBytesUTF8=Wt;var Dt;G=function s(){Dt||Vr(),Dt||(G=s)};function Vr(){if(!(0<le)){if(r.preRun)for(typeof r.preRun=="function"&&(r.preRun=[r.preRun]);r.preRun.length;){var s=r.preRun.shift();me.unshift(s)}for(;0<me.length;)me.shift()(r);if(!(0<le||Dt||(Dt=!0,r.calledRun=!0,R))){for(;0<ie.length;)ie.shift()(r);for(o(r);0<ue.length;)ue.shift()(r)}}}return Vr(),u}})();typeof Ti=="object"&&typeof po=="object"?po.exports=Ii:typeof define=="function"&&define.amd&&define([],()=>Ii)});var Pi=Wr(()=>{});var ki=Wr(()=>{});var Oi={};gn(Oi,{cpus:()=>ll});var ll,Ri=Y(()=>{ll=void 0});var zi=Wr((Di,mo)=>{"use strict";var Bi=(()=>{var e=typeof document<"u"?document.currentScript?.src:void 0;return typeof __filename<"u"&&(e||=__filename),function(t={}){function r(){return ae.buffer!=ue.buffer&&Ne(),ue}function o(){return ae.buffer!=ue.buffer&&Ne(),le}function i(){return ae.buffer!=ue.buffer&&Ne(),qe}function u(){return ae.buffer!=ue.buffer&&Ne(),G}function a(){return ae.buffer!=ue.buffer&&Ne(),ne}function c(){return ae.buffer!=ue.buffer&&Ne(),xe}function p(){return ae.buffer!=ue.buffer&&Ne(),Ke}function h(){return ae.buffer!=ue.buffer&&Ne(),Ut}var d=t,y,w,_=new Promise((n,l)=>{y=n,w=l});d.mountExternalData=(n,l)=>{(d.Db||(d.Db=new Map)).set(n,l)},d.unmountExternalData=()=>{delete d.Db};let v=()=>{let n=(f,b,C)=>(...k)=>{let V=ct,F=b?.();k=f(...k);let re=b?.();return F!==re&&(f=re,C(F),b=C=null),ct!=V?T():k},l=f=>async(...b)=>{try{if(d.Cb)throw Error("Session already started");let C=d.Cb={ec:b[0],errors:[]},k=await f(...b);if(d.Cb!==C)throw Error("Session mismatch");d.Kb?.flush();let V=C.errors;if(0<V.length){let F=await Promise.all(V);if(F=F.filter(re=>re),0<F.length)throw Error(F.join(`\n`))}return k}finally{d.Cb=null}};d._OrtCreateSession=n(d._OrtCreateSession,()=>d._OrtCreateSession,f=>d._OrtCreateSession=f),d._OrtRun=l(n(d._OrtRun,()=>d._OrtRun,f=>d._OrtRun=f)),d._OrtRunWithBinding=l(n(d._OrtRunWithBinding,()=>d._OrtRunWithBinding,f=>d._OrtRunWithBinding=f)),d._OrtBindInput=n(d._OrtBindInput,()=>d._OrtBindInput,f=>d._OrtBindInput=f),v=void 0};d.jsepInit=(n,l)=>{if(v?.(),n==="webgpu"){[d.Kb,d.Wb,d.$b,d.Lb,d.Zb,d.ob,d.ac,d.cc,d.Xb,d.Yb,d.bc]=l;let f=d.Kb;d.jsepRegisterBuffer=(b,C,k,V)=>f.registerBuffer(b,C,k,V),d.jsepGetBuffer=b=>f.getBuffer(b),d.jsepCreateDownloader=(b,C,k)=>f.createDownloader(b,C,k),d.jsepOnReleaseSession=b=>{f.onReleaseSession(b)},d.jsepOnRunStart=b=>f.onRunStart(b)}};var S=Object.assign({},d),A="./this.program",I=(n,l)=>{throw l},x=typeof window=="object",E=typeof importScripts=="function",P=typeof process=="object"&&typeof process.versions=="object"&&typeof process.versions.node=="string",O=d.ENVIRONMENT_IS_PTHREAD||!1,R="";function L(n){return d.locateFile?d.locateFile(n,R):R+n}var N,K,Q;if(P){var he=(uo(),wr(so)),W=(co(),wr(lo));R=E?W.dirname(R)+"/":__dirname+"/",N=(n,l)=>(n=Wt(n)?new URL(n):W.normalize(n),he.readFileSync(n,l?void 0:"utf8")),Q=n=>(n=N(n,!0),n.buffer||(n=new Uint8Array(n)),n),K=(n,l,f,b=!0)=>{n=Wt(n)?new URL(n):W.normalize(n),he.readFile(n,b?void 0:"utf8",(C,k)=>{C?f(C):l(b?k.buffer:k)})},!d.thisProgram&&1<process.argv.length&&(A=process.argv[1].replace(/\\\\/g,"/")),process.argv.slice(2),I=(n,l)=>{throw process.exitCode=n,l},global.Worker=Pi().Worker}else(x||E)&&(E?R=self.location.href:typeof document<"u"&&document.currentScript&&(R=document.currentScript.src),typeof e<"u"&&e&&(R=e),R.startsWith("blob:")?R="":R=R.substr(0,R.replace(/[?#].*/,"").lastIndexOf("/")+1),P||(N=n=>{var l=new XMLHttpRequest;return l.open("GET",n,!1),l.send(null),l.responseText},E&&(Q=n=>{var l=new XMLHttpRequest;return l.open("GET",n,!1),l.responseType="arraybuffer",l.send(null),new Uint8Array(l.response)}),K=(n,l,f)=>{var b=new XMLHttpRequest;b.open("GET",n,!0),b.responseType="arraybuffer",b.onload=()=>{b.status==200||b.status==0&&b.response?l(b.response):f()},b.onerror=f,b.send(null)}));P&&typeof performance>"u"&&(global.performance=ki().performance);var se=console.log.bind(console),Ce=console.error.bind(console);P&&(se=(...n)=>he.writeSync(1,n.join(" ")+`\n`),Ce=(...n)=>he.writeSync(2,n.join(" ")+`\n`));var We=se,ee=Ce;Object.assign(d,S),S=null;var ae,Ae,me=!1,ie,ue,le,qe,G,ne,xe,Ke,Be,Ge,Ut;function Ne(){var n=ae.buffer;d.HEAP8=ue=new Int8Array(n),d.HEAP16=qe=new Int16Array(n),d.HEAPU8=le=new Uint8Array(n),d.HEAPU16=G=new Uint16Array(n),d.HEAP32=ne=new Int32Array(n),d.HEAPU32=xe=new Uint32Array(n),d.HEAPF32=Ke=new Float32Array(n),d.HEAPF64=Ut=new Float64Array(n),d.HEAP64=Be=new BigInt64Array(n),d.HEAPU64=Ge=new BigUint64Array(n)}var Ye=16777216;if(O)ae=d.wasmMemory;else if(d.wasmMemory)ae=d.wasmMemory;else if(ae=new WebAssembly.Memory({initial:Ye/65536,maximum:65536,shared:!0}),!(ae.buffer instanceof SharedArrayBuffer))throw ee("requested a shared WebAssembly.Memory but the returned buffer is not a SharedArrayBuffer, indicating that while the browser has SharedArrayBuffer it does not have WebAssembly threads support - you may need to set a flag"),P&&ee("(on node you may need: --experimental-wasm-threads --experimental-wasm-bulk-memory and/or recent version)"),Error("bad memory");Ne(),Ye=ae.buffer.byteLength;var mt=[],Rt=[],qt=[],Vt=0,sr=null,jt=null;function xr(){if(Vt--,Vt==0&&(sr!==null&&(clearInterval(sr),sr=null),jt)){var n=jt;jt=null,n()}}function Kt(n){throw n="Aborted("+n+")",ee(n),me=!0,ie=1,n=new WebAssembly.RuntimeError(n+". Build with -sASSERTIONS for more info."),w(n),n}var je=n=>n.startsWith("data:application/octet-stream;base64,"),Wt=n=>n.startsWith("file://"),at;at="ort-wasm-simd-threaded.wasm",je(at)||(at=L(at));function Cr(n){if(Q)return Q(n);throw"both async and sync fetching of the wasm failed"}function ft(n){if(x||E){if(typeof fetch=="function"&&!Wt(n))return fetch(n,{credentials:"same-origin"}).then(l=>{if(!l.ok)throw`failed to load wasm binary file at \'${n}\'`;return l.arrayBuffer()}).catch(()=>Cr(n));if(K)return new Promise((l,f)=>{K(n,b=>l(new Uint8Array(b)),f)})}return Promise.resolve().then(()=>Cr(n))}function ur(n,l,f){return ft(n).then(b=>WebAssembly.instantiate(b,l)).then(f,b=>{ee(`failed to asynchronously prepare wasm: ${b}`),Kt(b)})}function Ar(n,l){var f=at;return typeof WebAssembly.instantiateStreaming!="function"||je(f)||Wt(f)||P||typeof fetch!="function"?ur(f,n,l):fetch(f,{credentials:"same-origin"}).then(b=>WebAssembly.instantiateStreaming(b,n).then(l,function(C){return ee(`wasm streaming compile failed: ${C}`),ee("falling back to ArrayBuffer instantiation"),ur(f,n,l)}))}var Ir={826468:(n,l,f,b)=>{if(typeof d>"u"||!d.Db)return 1;if(n=He(n>>>0),n.startsWith("./")&&(n=n.substring(2)),n=d.Db.get(n),!n)return 2;if(l>>>=0,f>>>=0,b>>>=0,l+f>n.byteLength)return 3;try{return o().set(n.subarray(l,l+f),b>>>0),0}catch{return 4}},826969:()=>{d.Xb()},827e3:()=>{d.Yb()},827029:()=>{d.bc()},827054:n=>d.Wb(n),827087:n=>d.$b(n),827119:(n,l,f)=>{d.Lb(n,l,f,!0)},827158:(n,l,f)=>{d.Lb(n,l,f)},827191:n=>{d.ob("Abs",n,void 0)},827242:n=>{d.ob("Neg",n,void 0)},827293:n=>{d.ob("Floor",n,void 0)},827346:n=>{d.ob("Ceil",n,void 0)},827398:n=>{d.ob("Reciprocal",n,void 0)},827456:n=>{d.ob("Sqrt",n,void 0)},827508:n=>{d.ob("Exp",n,void 0)},827559:n=>{d.ob("Erf",n,void 0)},827610:n=>{d.ob("Sigmoid",n,void 0)},827665:(n,l,f)=>{d.ob("HardSigmoid",n,{alpha:l,beta:f})},827744:n=>{d.ob("Log",n,void 0)},827795:n=>{d.ob("Sin",n,void 0)},827846:n=>{d.ob("Cos",n,void 0)},827897:n=>{d.ob("Tan",n,void 0)},827948:n=>{d.ob("Asin",n,void 0)},828e3:n=>{d.ob("Acos",n,void 0)},828052:n=>{d.ob("Atan",n,void 0)},828104:n=>{d.ob("Sinh",n,void 0)},828156:n=>{d.ob("Cosh",n,void 0)},828208:n=>{d.ob("Asinh",n,void 0)},828261:n=>{d.ob("Acosh",n,void 0)},828314:n=>{d.ob("Atanh",n,void 0)},828367:n=>{d.ob("Tanh",n,void 0)},828419:n=>{d.ob("Not",n,void 0)},828470:(n,l,f)=>{d.ob("Clip",n,{min:l,max:f})},828539:n=>{d.ob("Clip",n,void 0)},828591:(n,l)=>{d.ob("Elu",n,{alpha:l})},828649:n=>{d.ob("Relu",n,void 0)},828701:(n,l)=>{d.ob("LeakyRelu",n,{alpha:l})},828765:(n,l)=>{d.ob("ThresholdedRelu",n,{alpha:l})},828835:(n,l)=>{d.ob("Cast",n,{to:l})},828893:n=>{d.ob("Add",n,void 0)},828944:n=>{d.ob("Sub",n,void 0)},828995:n=>{d.ob("Mul",n,void 0)},829046:n=>{d.ob("Div",n,void 0)},829097:n=>{d.ob("Pow",n,void 0)},829148:n=>{d.ob("Equal",n,void 0)},829201:n=>{d.ob("Greater",n,void 0)},829256:n=>{d.ob("GreaterOrEqual",n,void 0)},829318:n=>{d.ob("Less",n,void 0)},829370:n=>{d.ob("LessOrEqual",n,void 0)},829429:(n,l,f,b,C)=>{d.ob("ReduceMean",n,{keepDims:!!l,noopWithEmptyAxes:!!f,axes:b?Array.from(a().subarray(b>>>0,C>>>0)):[]})},829588:(n,l,f,b,C)=>{d.ob("ReduceMax",n,{keepDims:!!l,noopWithEmptyAxes:!!f,axes:b?Array.from(a().subarray(b>>>0,C>>>0)):[]})},829746:(n,l,f,b,C)=>{d.ob("ReduceMin",n,{keepDims:!!l,noopWithEmptyAxes:!!f,axes:b?Array.from(a().subarray(b>>>0,C>>>0)):[]})},829904:(n,l,f,b,C)=>{d.ob("ReduceProd",n,{keepDims:!!l,noopWithEmptyAxes:!!f,axes:b?Array.from(a().subarray(b>>>0,C>>>0)):[]})},830063:(n,l,f,b,C)=>{d.ob("ReduceSum",n,{keepDims:!!l,noopWithEmptyAxes:!!f,axes:b?Array.from(a().subarray(b>>>0,C>>>0)):[]})},830221:(n,l,f,b,C)=>{d.ob("ReduceL1",n,{keepDims:!!l,noopWithEmptyAxes:!!f,axes:b?Array.from(a().subarray(b>>>0,C>>>0)):[]})},830378:(n,l,f,b,C)=>{d.ob("ReduceL2",n,{keepDims:!!l,noopWithEmptyAxes:!!f,axes:b?Array.from(a().subarray(b>>>0,C>>>0)):[]})},830535:(n,l,f,b,C)=>{d.ob("ReduceLogSum",n,{keepDims:!!l,noopWithEmptyAxes:!!f,axes:b?Array.from(a().subarray(b>>>0,C>>>0)):[]})},830696:(n,l,f,b,C)=>{d.ob("ReduceSumSquare",n,{keepDims:!!l,noopWithEmptyAxes:!!f,axes:b?Array.from(a().subarray(b>>>0,C>>>0)):[]})},830860:(n,l,f,b,C)=>{d.ob("ReduceLogSumExp",n,{keepDims:!!l,noopWithEmptyAxes:!!f,axes:b?Array.from(a().subarray(b>>>0,C>>>0)):[]})},831024:n=>{d.ob("Where",n,void 0)},831077:(n,l,f)=>{d.ob("Transpose",n,{perm:l?Array.from(a().subarray(l>>>0,f>>>0)):[]})},831185:(n,l,f,b)=>{d.ob("DepthToSpace",n,{blocksize:l,mode:He(f),format:b?"NHWC":"NCHW"})},831318:(n,l,f,b)=>{d.ob("DepthToSpace",n,{blocksize:l,mode:He(f),format:b?"NHWC":"NCHW"})},831451:(n,l,f,b,C,k,V,F,re,J,ce,Re,ze,z,we)=>{d.ob("ConvTranspose",n,{format:re?"NHWC":"NCHW",autoPad:l,dilations:[f],group:b,kernelShape:[C],pads:[k,V],strides:[F],wIsConst:()=>!!r()[J>>>0],outputPadding:ce?Array.from(a().subarray(ce>>>0,Re>>>0)):[],outputShape:ze?Array.from(a().subarray(ze>>>0,z>>>0)):[],activation:He(we)})},831852:(n,l,f,b,C,k,V,F,re,J,ce,Re,ze,z)=>{d.ob("ConvTranspose",n,{format:F?"NHWC":"NCHW",autoPad:l,dilations:Array.from(a().subarray(f>>>0,(f>>>0)+2>>>0)),group:b,kernelShape:Array.from(a().subarray(C>>>0,(C>>>0)+2>>>0)),pads:Array.from(a().subarray(k>>>0,(k>>>0)+4>>>0)),strides:Array.from(a().subarray(V>>>0,(V>>>0)+2>>>0)),wIsConst:()=>!!r()[re>>>0],outputPadding:J?Array.from(a().subarray(J>>>0,ce>>>0)):[],outputShape:Re?Array.from(a().subarray(Re>>>0,ze>>>0)):[],activation:He(z)})},832417:(n,l,f,b,C,k,V,F,re,J,ce,Re,ze,z,we)=>{d.ob("ConvTranspose",n,{format:re?"NHWC":"NCHW",autoPad:l,dilations:[f],group:b,kernelShape:[C],pads:[k,V],strides:[F],wIsConst:()=>!!r()[J>>>0],outputPadding:ce?Array.from(a().subarray(ce>>>0,Re>>>0)):[],outputShape:ze?Array.from(a().subarray(ze>>>0,z>>>0)):[],activation:He(we)})},832818:(n,l,f,b,C,k,V,F,re,J,ce,Re,ze,z)=>{d.ob("ConvTranspose",n,{format:F?"NHWC":"NCHW",autoPad:l,dilations:Array.from(a().subarray(f>>>0,(f>>>0)+2>>>0)),group:b,kernelShape:Array.from(a().subarray(C>>>0,(C>>>0)+2>>>0)),pads:Array.from(a().subarray(k>>>0,(k>>>0)+4>>>0)),strides:Array.from(a().subarray(V>>>0,(V>>>0)+2>>>0)),wIsConst:()=>!!r()[re>>>0],outputPadding:J?Array.from(a().subarray(J>>>0,ce>>>0)):[],outputShape:Re?Array.from(a().subarray(Re>>>0,ze>>>0)):[],activation:He(z)})},833383:(n,l)=>{d.ob("GlobalAveragePool",n,{format:l?"NHWC":"NCHW"})},833474:(n,l,f,b,C,k,V,F,re,J,ce,Re,ze,z,we,Pe)=>{d.ob("AveragePool",n,{format:Pe?"NHWC":"NCHW",auto_pad:l,ceil_mode:f,count_include_pad:b,storage_order:C,dilations:[k,V],kernel_shape:[F,re],pads:[J,ce,Re,ze],strides:[z,we]})},833758:(n,l)=>{d.ob("GlobalAveragePool",n,{format:l?"NHWC":"NCHW"})},833849:(n,l,f,b,C,k,V,F,re,J,ce,Re,ze,z,we,Pe)=>{d.ob("AveragePool",n,{format:Pe?"NHWC":"NCHW",auto_pad:l,ceil_mode:f,count_include_pad:b,storage_order:C,dilations:[k,V],kernel_shape:[F,re],pads:[J,ce,Re,ze],strides:[z,we]})},834133:(n,l)=>{d.ob("GlobalMaxPool",n,{format:l?"NHWC":"NCHW"})},834220:(n,l,f,b,C,k,V,F,re,J,ce,Re,ze,z,we,Pe)=>{d.ob("MaxPool",n,{format:Pe?"NHWC":"NCHW",auto_pad:l,ceil_mode:f,count_include_pad:b,storage_order:C,dilations:[k,V],kernel_shape:[F,re],pads:[J,ce,Re,ze],strides:[z,we]})},834500:(n,l)=>{d.ob("GlobalMaxPool",n,{format:l?"NHWC":"NCHW"})},834587:(n,l,f,b,C,k,V,F,re,J,ce,Re,ze,z,we,Pe)=>{d.ob("MaxPool",n,{format:Pe?"NHWC":"NCHW",auto_pad:l,ceil_mode:f,count_include_pad:b,storage_order:C,dilations:[k,V],kernel_shape:[F,re],pads:[J,ce,Re,ze],strides:[z,we]})},834867:(n,l,f,b,C)=>{d.ob("Gemm",n,{alpha:l,beta:f,transA:b,transB:C})},834971:n=>{d.ob("MatMul",n,void 0)},835025:(n,l,f,b)=>{d.ob("ArgMax",n,{keepDims:!!l,selectLastIndex:!!f,axis:b})},835133:(n,l,f,b)=>{d.ob("ArgMin",n,{keepDims:!!l,selectLastIndex:!!f,axis:b})},835241:(n,l)=>{d.ob("Softmax",n,{axis:l})},835304:(n,l)=>{d.ob("Concat",n,{axis:l})},835364:(n,l,f,b,C)=>{d.ob("Split",n,{axis:l,numOutputs:f,splitSizes:b?Array.from(a().subarray(b>>>0,C>>>0)):[]})},835504:n=>{d.ob("Expand",n,void 0)},835558:(n,l)=>{d.ob("Gather",n,{axis:Number(l)})},835629:(n,l)=>{d.ob("GatherElements",n,{axis:Number(l)})},835708:(n,l,f,b,C,k,V,F,re,J,ce)=>{d.ob("Resize",n,{antialias:l,axes:f?Array.from(a().subarray(f>>>0,b>>>0)):[],coordinateTransformMode:He(C),cubicCoeffA:k,excludeOutside:V,extrapolationValue:F,keepAspectRatioPolicy:He(re),mode:He(J),nearestMode:He(ce)})},836054:(n,l,f,b,C,k,V)=>{d.ob("Slice",n,{starts:l?Array.from(a().subarray(l>>>0,f>>>0)):[],ends:b?Array.from(a().subarray(b>>>0,C>>>0)):[],axes:k?Array.from(a().subarray(k>>>0,V>>>0)):[]})},836270:n=>{d.ob("Tile",n,void 0)},836322:(n,l,f,b)=>{d.ob("LayerNormalization",n,{axis:l,epsilon:f,simplified:!!b})},836433:(n,l,f)=>{d.ob("InstanceNormalization",n,{epsilon:l,format:f?"NHWC":"NCHW"})},836547:(n,l,f)=>{d.ob("InstanceNormalization",n,{epsilon:l,format:f?"NHWC":"NCHW"})},836661:n=>{d.ob("Range",n,void 0)},836714:(n,l)=>{d.ob("Einsum",n,{equation:He(l)})},836795:(n,l,f,b,C)=>{d.ob("Pad",n,{mode:l,value:f,pads:b?Array.from(a().subarray(b>>>0,C>>>0)):[]})},836922:(n,l,f,b,C,k)=>{d.ob("BatchNormalization",n,{epsilon:l,momentum:f,spatial:!!C,trainingMode:!!b,format:k?"NHWC":"NCHW"})},837091:(n,l,f,b,C,k)=>{d.ob("BatchNormalization",n,{epsilon:l,momentum:f,spatial:!!C,trainingMode:!!b,format:k?"NHWC":"NCHW"})},837260:(n,l,f)=>{d.ob("CumSum",n,{exclusive:Number(l),reverse:Number(f)})},837357:(n,l,f,b,C,k,V,F,re)=>{d.ob("Attention",n,{numHeads:l,isUnidirectional:f,maskFilterValue:b,scale:C,doRotary:k,qkvHiddenSizes:V?Array.from(a().subarray(Number(F)>>>0,Number(F)+V>>>0)):[],pastPresentShareBuffer:!!re})},837629:n=>{d.ob("BiasAdd",n,void 0)},837684:n=>{d.ob("BiasSplitGelu",n,void 0)},837745:n=>{d.ob("FastGelu",n,void 0)},837801:(n,l,f,b,C,k,V,F,re,J,ce,Re,ze)=>{d.ob("Conv",n,{format:re?"NHWC":"NCHW",auto_pad:l,dilations:[f],group:b,kernel_shape:[C],pads:k?Array.from(a().subarray(k>>>0,V>>>0)):[],strides:[F],w_is_const:()=>!!r()[J>>>0],activation:He(ce),activation_params:Re?Array.from(p().subarray(Re>>>0,ze>>>0)):[]})},838171:(n,l,f,b,C,k,V,F,re,J,ce,Re,ze,z,we,Pe)=>{d.ob("Conv",n,{format:Re?"NHWC":"NCHW",auto_pad:l,dilations:[f,b],group:C,kernel_shape:[k,V],pads:F?Array.from(a().subarray(F>>>0,re>>>0)):[],strides:[J,ce],w_is_const:()=>!!r()[ze>>>0],activation:He(z),activation_params:we?Array.from(p().subarray(we>>>0,Pe>>>0)):[]})},838562:n=>{d.ob("Gelu",n,void 0)},838614:(n,l,f,b,C,k)=>{d.ob("MatMulNBits",n,{k:l,n:f,accuracyLevel:b,bits:C,blockSize:k})},838741:(n,l,f,b,C,k)=>{d.ob("MultiHeadAttention",n,{numHeads:l,isUnidirectional:f,maskFilterValue:b,scale:C,doRotary:k})},838900:(n,l,f,b,C)=>{d.ob("RotaryEmbedding",n,{interleaved:!!l,numHeads:f,rotaryEmbeddingDim:b,scale:C})},839039:(n,l,f)=>{d.ob("SkipLayerNormalization",n,{epsilon:l,simplified:!!f})},839141:(n,l,f)=>{d.ob("SkipLayerNormalization",n,{epsilon:l,simplified:!!f})},839243:(n,l,f,b)=>{d.ob("LayerNormalization",n,{axis:l,epsilon:f,simplified:!!b})},839354:n=>{d.ac(n)},839388:(n,l)=>d.cc(n,l,d.Cb.ec,d.Cb.errors)};function st(n){this.name="ExitStatus",this.message=`Program terminated with exit(${n})`,this.status=n}var Tr=n=>{n.terminate(),n.onmessage=()=>{}},ht=n=>{ge.xb.length==0&&(lr(),ge.Mb(ge.xb[0]));var l=ge.xb.pop();if(!l)return 6;ge.yb.push(l),ge.ub[n.wb]=l,l.wb=n.wb;var f={cmd:"run",start_routine:n.fc,arg:n.Rb,pthread_ptr:n.wb};return P&&l.unref(),l.postMessage(f,n.mc),0},bt=0,Er=n=>{var l=io();return n=n(),fn(l),n},Te=(n,l,...f)=>Er(()=>{for(var b=2*f.length,C=oo(8*b),k=C>>>3,V=0;V<f.length;V++){var F=f[V];typeof F=="bigint"?(Be[k+2*V]=1n,Be[k+2*V+1]=F):(Be[k+2*V]=0n,h()[k+2*V+1>>>0]=F)}return gi(n,0,b,C,l)});function dr(n){if(O)return Te(0,1,n);ie=n,0<bt||(ge.hc(),d.onExit?.(n),me=!0),I(n,new st(n))}var Xe=n=>{if(ie=n,O)throw jr(n),"unwind";dr(n)};function ut(){for(var n=d.numThreads;n--;)lr();mt.unshift(()=>{Vt++,Fn(()=>xr())})}function lr(){var n=L("ort-wasm-simd-threaded.worker.js");n=new Worker(n),ge.xb.push(n)}function Fn(n){O?n():Promise.all(ge.xb.map(ge.Mb)).then(n)}var ge={xb:[],yb:[],Qb:[],ub:{},Gb(){O?(ge.receiveObjectTransfer=ge.dc,ge.threadInitTLS=ge.Pb,ge.setExitStatus=ge.Ob):ut()},Ob:n=>ie=n,pc:["$terminateWorker"],hc:()=>{for(var n of ge.yb)Tr(n);for(n of ge.xb)Tr(n);ge.xb=[],ge.yb=[],ge.ub=[]},Nb:n=>{var l=n.wb;delete ge.ub[l],ge.xb.push(n),ge.yb.splice(ge.yb.indexOf(n),1),n.wb=0,ro(l)},dc(){},Pb(){ge.Qb.forEach(n=>n())},Mb:n=>new Promise(l=>{n.onmessage=k=>{k=k.data;var V=k.cmd;if(k.targetThread&&k.targetThread!=pn()){var F=ge.ub[k.targetThread];F?F.postMessage(k,k.transferList):ee(`Internal error! Worker sent a message "${V}" to target pthread ${k.targetThread}, but that thread no longer exists!`)}else V==="checkMailbox"?rt():V==="spawnThread"?ht(k):V==="cleanupThread"?ge.Nb(ge.ub[k.thread]):V==="killThread"?(k=k.thread,V=ge.ub[k],delete ge.ub[k],Tr(V),ro(k),ge.yb.splice(ge.yb.indexOf(V),1),V.wb=0):V==="cancelThread"?ge.ub[k.thread].postMessage({cmd:"cancel"}):V==="loaded"?(n.loaded=!0,P&&!n.wb&&n.unref(),l(n)):V==="alert"?alert(`Thread ${k.threadId}: ${k.text}`):k.target==="setimmediate"?n.postMessage(k):V==="callHandler"?d[k.handler](...k.args):V&&ee(`worker sent an unknown command ${V}`)},n.onerror=k=>{throw ee(`worker sent an error! ${k.filename}:${k.lineno}: ${k.message}`),k},P&&(n.on("message",k=>n.onmessage({data:k})),n.on("error",k=>n.onerror(k)));var f=[],b=["onExit"],C;for(C of b)d.hasOwnProperty(C)&&f.push(C);n.postMessage({cmd:"load",handlers:f,urlOrBlob:d.mainScriptUrlOrBlob||e,wasmMemory:ae,wasmModule:Ae})})};d.PThread=ge;var Yt=n=>{for(;0<n.length;)n.shift()(d)};d.establishStackSpace=()=>{var n=pn(),l=c()[n+52>>>2>>>0];n=c()[n+56>>>2>>>0],bi(l,l-n),fn(l)};function jr(n){if(O)return Te(1,0,n);Xe(n)}d.invokeEntryPoint=(n,l)=>{bt=0,n=wi(n,l),0<bt?ge.Ob(n):no(n)};class qn{constructor(l){this.Ib=l-24}Gb(l,f){c()[this.Ib+16>>>2>>>0]=0,c()[this.Ib+4>>>2>>>0]=l,c()[this.Ib+8>>>2>>>0]=f}}var Kr=0,jn=0;function Yr(n,l,f,b){return O?Te(2,1,n,l,f,b):Zr(n,l,f,b)}function Zr(n,l,f,b){if(n>>>=0,l>>>=0,f>>>=0,b>>>=0,typeof SharedArrayBuffer>"u")return ee("Current environment does not support SharedArrayBuffer, pthreads are not available!"),6;var C=[];return O&&C.length===0?Yr(n,l,f,b):(n={fc:f,wb:n,Rb:b,mc:C},O?(n.oc="spawnThread",postMessage(n,C),0):ht(n))}var cr=typeof TextDecoder<"u"?new TextDecoder("utf8"):void 0,Pr=(n,l,f)=>{l>>>=0;var b=l+f;for(f=l;n[f]&&!(f>=b);)++f;if(16<f-l&&n.buffer&&cr)return cr.decode(n.buffer instanceof SharedArrayBuffer?n.slice(l,f):n.subarray(l,f));for(b="";l<f;){var C=n[l++];if(C&128){var k=n[l++]&63;if((C&224)==192)b+=String.fromCharCode((C&31)<<6|k);else{var V=n[l++]&63;C=(C&240)==224?(C&15)<<12|k<<6|V:(C&7)<<18|k<<12|V<<6|n[l++]&63,65536>C?b+=String.fromCharCode(C):(C-=65536,b+=String.fromCharCode(55296|C>>10,56320|C&1023))}}else b+=String.fromCharCode(C)}return b},He=(n,l)=>(n>>>=0)?Pr(o(),n,l):"";function Xr(n,l,f){return O?Te(3,1,n,l,f):0}function Qr(n,l){if(O)return Te(4,1,n,l)}var gt=n=>{for(var l=0,f=0;f<n.length;++f){var b=n.charCodeAt(f);127>=b?l++:2047>=b?l+=2:55296<=b&&57343>=b?(l+=4,++f):l+=3}return l},dt=(n,l,f,b)=>{if(f>>>=0,!(0<b))return 0;var C=f;b=f+b-1;for(var k=0;k<n.length;++k){var V=n.charCodeAt(k);if(55296<=V&&57343>=V){var F=n.charCodeAt(++k);V=65536+((V&1023)<<10)|F&1023}if(127>=V){if(f>=b)break;l[f++>>>0]=V}else{if(2047>=V){if(f+1>=b)break;l[f++>>>0]=192|V>>6}else{if(65535>=V){if(f+2>=b)break;l[f++>>>0]=224|V>>12}else{if(f+3>=b)break;l[f++>>>0]=240|V>>18,l[f++>>>0]=128|V>>12&63}l[f++>>>0]=128|V>>6&63}l[f++>>>0]=128|V&63}}return l[f>>>0]=0,f-C},Bt=(n,l,f)=>dt(n,o(),l,f);function Zt(n,l){if(O)return Te(5,1,n,l)}function kr(n,l,f){if(O)return Te(6,1,n,l,f)}function Or(n,l,f){return O?Te(7,1,n,l,f):0}function Jr(n,l){if(O)return Te(8,1,n,l)}function pr(n,l,f){if(O)return Te(9,1,n,l,f)}function en(n,l,f,b){if(O)return Te(10,1,n,l,f,b)}function tn(n,l,f,b){if(O)return Te(11,1,n,l,f,b)}function rn(n,l,f,b){if(O)return Te(12,1,n,l,f,b)}function nn(n){if(O)return Te(13,1,n)}function Rr(n,l){if(O)return Te(14,1,n,l)}function Xt(n,l,f){if(O)return Te(15,1,n,l,f)}var on,nt=n=>{for(var l="";o()[n>>>0];)l+=on[o()[n++>>>0]];return l},mr={},Br={},Kn={},wt;function Yn(n,l,f={}){var b=l.name;if(!n)throw new wt(`type "${b}" must have a positive integer typeid pointer`);if(Br.hasOwnProperty(n)){if(f.Ub)return;throw new wt(`Cannot register type \'${b}\' twice`)}Br[n]=l,delete Kn[n],mr.hasOwnProperty(n)&&(l=mr[n],delete mr[n],l.forEach(C=>C()))}function Je(n,l,f={}){if(!("argPackAdvance"in l))throw new TypeError("registerType registeredInstance requires argPackAdvance");return Yn(n,l,f)}var Dr=(n,l,f)=>{switch(l){case 1:return f?b=>r()[b>>>0]:b=>o()[b>>>0];case 2:return f?b=>i()[b>>>1>>>0]:b=>u()[b>>>1>>>0];case 4:return f?b=>a()[b>>>2>>>0]:b=>c()[b>>>2>>>0];case 8:return f?b=>Be[b>>>3]:b=>Ge[b>>>3];default:throw new TypeError(`invalid integer width (${l}): ${n}`)}},fr=[],lt=[];function hr(n){n>>>=0,9<n&&--lt[n+1]===0&&(lt[n]=void 0,fr.push(n))}var Qe=n=>{if(!n)throw new wt("Cannot use deleted val. handle = "+n);return lt[n]},ot=n=>{switch(n){case void 0:return 2;case null:return 4;case!0:return 6;case!1:return 8;default:let l=fr.pop()||lt.length;return lt[l]=n,lt[l+1]=1,l}};function Qt(n){return this.fromWireType(c()[n>>>2>>>0])}var Zn={name:"emscripten::val",fromWireType:n=>{var l=Qe(n);return hr(n),l},toWireType:(n,l)=>ot(l),argPackAdvance:8,readValueFromPointer:Qt,Bb:null},an=(n,l)=>{switch(l){case 4:return function(f){return this.fromWireType(p()[f>>>2>>>0])};case 8:return function(f){return this.fromWireType(h()[f>>>3>>>0])};default:throw new TypeError(`invalid float width (${l}): ${n}`)}},zr=typeof TextDecoder<"u"?new TextDecoder("utf-16le"):void 0,Xn=(n,l)=>{for(var f=n>>1,b=f+l/2;!(f>=b)&&u()[f>>>0];)++f;if(f<<=1,32<f-n&&zr)return zr.decode(o().slice(n,f));for(f="",b=0;!(b>=l/2);++b){var C=i()[n+2*b>>>1>>>0];if(C==0)break;f+=String.fromCharCode(C)}return f},sn=(n,l,f)=>{if(f??=2147483647,2>f)return 0;f-=2;var b=l;f=f<2*n.length?f/2:n.length;for(var C=0;C<f;++C){var k=n.charCodeAt(C);i()[l>>>1>>>0]=k,l+=2}return i()[l>>>1>>>0]=0,l-b},un=n=>2*n.length,gr=(n,l)=>{for(var f=0,b="";!(f>=l/4);){var C=a()[n+4*f>>>2>>>0];if(C==0)break;++f,65536<=C?(C-=65536,b+=String.fromCharCode(55296|C>>10,56320|C&1023)):b+=String.fromCharCode(C)}return b},Qn=(n,l,f)=>{if(l>>>=0,f??=2147483647,4>f)return 0;var b=l;f=b+f-4;for(var C=0;C<n.length;++C){var k=n.charCodeAt(C);if(55296<=k&&57343>=k){var V=n.charCodeAt(++C);k=65536+((k&1023)<<10)|V&1023}if(a()[l>>>2>>>0]=k,l+=4,l+4>f)break}return a()[l>>>2>>>0]=0,l-b},pe=n=>{for(var l=0,f=0;f<n.length;++f){var b=n.charCodeAt(f);55296<=b&&57343>=b&&++f,l+=4}return l},Mr=n=>{if(!me)try{if(n(),!(0<bt))try{O?no(ie):Xe(ie)}catch(l){l instanceof st||l=="unwind"||I(1,l)}}catch(l){l instanceof st||l=="unwind"||I(1,l)}};function Nt(n){n>>>=0,typeof Atomics.nc=="function"&&(Atomics.nc(a(),n>>>2,n).value.then(rt),n+=128,Atomics.store(a(),n>>>2,1))}d.__emscripten_thread_mailbox_await=Nt;var rt=()=>{var n=pn();n&&(Nt(n),Mr(yi))};d.checkMailbox=rt;var yr=[],br=(n,l)=>{var f=Br[n];if(f===void 0)throw n=fi(n),f=nt(n),At(n),new wt(`${l} has unknown type ${f}`);return f},Ur=(n,l,f)=>{var b=[];return n=n.toWireType(b,f),b.length&&(c()[l>>>2>>>0]=ot(b)),n},Jt=n=>{try{n()}catch(l){Kt(l)}};function dn(){var n=oe,l={};for(let[f,b]of Object.entries(n))l[f]=typeof b=="function"?(...C)=>{Dt.push(f);try{return b(...C)}finally{me||(Dt.pop(),ct&&vt===1&&Dt.length===0&&(vt=0,bt+=1,Jt($i),typeof Fibers<"u"&&Fibers.rc()))}}:b;return l}var vt=0,ct=null,ln=0,Dt=[],Vr={},s={},m=0,g=null,$=[];function T(){return new Promise((n,l)=>{g={resolve:n,reject:l}})}function B(){var n=mn(65548),l=n+12;c()[n>>>2>>>0]=l,c()[n+4>>>2>>>0]=l+65536,l=Dt[0];var f=Vr[l];return f===void 0&&(f=m++,Vr[l]=f,s[f]=l),l=f,a()[n+8>>>2>>>0]=l,n}function H(){var n=a()[ct+8>>>2>>>0];return n=oe[s[n]],--bt,n()}function q(n){if(!me){if(vt===0){var l=!1,f=!1;n((b=0)=>{if(!me&&(ln=b,l=!0,f)){vt=2,Jt(()=>_i(ct)),typeof Browser<"u"&&Browser.Hb.Tb&&Browser.Hb.resume(),b=!1;try{var C=H()}catch(F){C=F,b=!0}var k=!1;if(!ct){var V=g;V&&(g=null,(b?V.reject:V.resolve)(C),k=!0)}if(b&&!k)throw C}}),f=!0,l||(vt=1,ct=B(),typeof Browser<"u"&&Browser.Hb.Tb&&Browser.Hb.pause(),Jt(()=>vi(ct)))}else vt===2?(vt=0,Jt(Si),At(ct),ct=null,$.forEach(Mr)):Kt(`invalid state: ${vt}`);return ln}}function te(n){return q(l=>{n().then(l)})}var X=[],de={},Ee=n=>{var l=de[n];return l===void 0?nt(n):l},Oe=()=>typeof globalThis=="object"?globalThis:Function("return this")(),D=n=>{var l=X.length;return X.push(n),l},be=(n,l)=>{for(var f=Array(n),b=0;b<n;++b)f[b]=br(c()[l+4*b>>>2>>>0],"parameter "+b);return f},Ie=(n,l)=>Object.defineProperty(l,"name",{value:n});function zt(n){var l=Function;if(!(l instanceof Function))throw new TypeError(`new_ called with constructor type ${typeof l} which is not a function`);var f=Ie(l.name||"unknownFunctionName",function(){});return f.prototype=l.prototype,f=new f,n=l.apply(f,n),n instanceof Object?n:f}var Mt=n=>n%4===0&&(n%100!==0||n%400===0),Qo=[0,31,60,91,121,152,182,213,244,274,305,335],Jo=[0,31,59,90,120,151,181,212,243,273,304,334];function ei(n,l,f,b,C,k,V){return O?Te(16,1,n,l,f,b,C,k,V):-52}function ti(n,l,f,b,C,k){if(O)return Te(17,1,n,l,f,b,C,k)}var Jn=[],ri=(n,l)=>{Jn.length=0;for(var f;f=o()[n++>>>0];){var b=f!=105;b&=f!=112,l+=b&&l%8?4:0,Jn.push(f==112?c()[l>>>2>>>0]:f==106?Be[l>>>3]:f==105?a()[l>>>2>>>0]:h()[l>>>3>>>0]),l+=b?8:4}return Jn},eo={},ni=()=>{if(!to){var n={USER:"web_user",LOGNAME:"web_user",PATH:"/",PWD:"/",HOME:"/home/web_user",LANG:(typeof navigator=="object"&&navigator.languages&&navigator.languages[0]||"C").replace("-","_")+".UTF-8",_:A||"./this.program"},l;for(l in eo)eo[l]===void 0?delete n[l]:n[l]=eo[l];var f=[];for(l in n)f.push(`${l}=${n[l]}`);to=f}return to},to;function oi(n,l){if(O)return Te(18,1,n,l);n>>>=0,l>>>=0;var f=0;return ni().forEach((b,C)=>{var k=l+f;for(C=c()[n+4*C>>>2>>>0]=k,k=0;k<b.length;++k)r()[C++>>>0]=b.charCodeAt(k);r()[C>>>0]=0,f+=b.length+1}),0}function ii(n,l){if(O)return Te(19,1,n,l);n>>>=0,l>>>=0;var f=ni();c()[n>>>2>>>0]=f.length;var b=0;return f.forEach(C=>b+=C.length+1),c()[l>>>2>>>0]=b,0}function ai(n){return O?Te(20,1,n):52}function si(n,l,f,b){return O?Te(21,1,n,l,f,b):52}function ui(n,l,f,b){return O?Te(22,1,n,l,f,b):70}var Xd=[null,[],[]];function di(n,l,f,b){if(O)return Te(23,1,n,l,f,b);l>>>=0,f>>>=0,b>>>=0;for(var C=0,k=0;k<f;k++){var V=c()[l>>>2>>>0],F=c()[l+4>>>2>>>0];l+=8;for(var re=0;re<F;re++){var J=o()[V+re>>>0],ce=Xd[n];J===0||J===10?((n===1?We:ee)(Pr(ce,0)),ce.length=0):ce.push(J)}C+=F}return c()[b>>>2>>>0]=C,0}var li=[31,29,31,30,31,30,31,31,30,31,30,31],ci=[31,28,31,30,31,30,31,31,30,31,30,31];function Qd(n){var l=Array(gt(n)+1);return dt(n,l,0,l.length),l}var Jd=(n,l)=>{r().set(n,l>>>0)};function pi(n,l,f,b){function C(z,we,Pe){for(z=typeof z=="number"?z.toString():z||"";z.length<we;)z=Pe[0]+z;return z}function k(z,we){return C(z,we,"0")}function V(z,we){function Pe(Ci){return 0>Ci?-1:0<Ci?1:0}var er;return(er=Pe(z.getFullYear()-we.getFullYear()))===0&&(er=Pe(z.getMonth()-we.getMonth()))===0&&(er=Pe(z.getDate()-we.getDate())),er}function F(z){switch(z.getDay()){case 0:return new Date(z.getFullYear()-1,11,29);case 1:return z;case 2:return new Date(z.getFullYear(),0,3);case 3:return new Date(z.getFullYear(),0,2);case 4:return new Date(z.getFullYear(),0,1);case 5:return new Date(z.getFullYear()-1,11,31);case 6:return new Date(z.getFullYear()-1,11,30)}}function re(z){var we=z.zb;for(z=new Date(new Date(z.Ab+1900,0,1).getTime());0<we;){var Pe=z.getMonth(),er=(Mt(z.getFullYear())?li:ci)[Pe];if(we>er-z.getDate())we-=er-z.getDate()+1,z.setDate(1),11>Pe?z.setMonth(Pe+1):(z.setMonth(0),z.setFullYear(z.getFullYear()+1));else{z.setDate(z.getDate()+we);break}}return Pe=new Date(z.getFullYear()+1,0,4),we=F(new Date(z.getFullYear(),0,4)),Pe=F(Pe),0>=V(we,z)?0>=V(Pe,z)?z.getFullYear()+1:z.getFullYear():z.getFullYear()-1}n>>>=0,l>>>=0,f>>>=0,b>>>=0;var J=c()[b+40>>>2>>>0];b={kc:a()[b>>>2>>>0],jc:a()[b+4>>>2>>>0],Eb:a()[b+8>>>2>>>0],Jb:a()[b+12>>>2>>>0],Fb:a()[b+16>>>2>>>0],Ab:a()[b+20>>>2>>>0],vb:a()[b+24>>>2>>>0],zb:a()[b+28>>>2>>>0],qc:a()[b+32>>>2>>>0],ic:a()[b+36>>>2>>>0],lc:J?He(J):""},f=He(f),J={"%c":"%a %b %d %H:%M:%S %Y","%D":"%m/%d/%y","%F":"%Y-%m-%d","%h":"%b","%r":"%I:%M:%S %p","%R":"%H:%M","%T":"%H:%M:%S","%x":"%m/%d/%y","%X":"%H:%M:%S","%Ec":"%c","%EC":"%C","%Ex":"%m/%d/%y","%EX":"%H:%M:%S","%Ey":"%y","%EY":"%Y","%Od":"%d","%Oe":"%e","%OH":"%H","%OI":"%I","%Om":"%m","%OM":"%M","%OS":"%S","%Ou":"%u","%OU":"%U","%OV":"%V","%Ow":"%w","%OW":"%W","%Oy":"%y"};for(var ce in J)f=f.replace(new RegExp(ce,"g"),J[ce]);var Re="Sunday Monday Tuesday Wednesday Thursday Friday Saturday".split(" "),ze="January February March April May June July August September October November December".split(" ");J={"%a":z=>Re[z.vb].substring(0,3),"%A":z=>Re[z.vb],"%b":z=>ze[z.Fb].substring(0,3),"%B":z=>ze[z.Fb],"%C":z=>k((z.Ab+1900)/100|0,2),"%d":z=>k(z.Jb,2),"%e":z=>C(z.Jb,2," "),"%g":z=>re(z).toString().substring(2),"%G":re,"%H":z=>k(z.Eb,2),"%I":z=>(z=z.Eb,z==0?z=12:12<z&&(z-=12),k(z,2)),"%j":z=>{for(var we=0,Pe=0;Pe<=z.Fb-1;we+=(Mt(z.Ab+1900)?li:ci)[Pe++]);return k(z.Jb+we,3)},"%m":z=>k(z.Fb+1,2),"%M":z=>k(z.jc,2),"%n":()=>`\n`,"%p":z=>0<=z.Eb&&12>z.Eb?"AM":"PM","%S":z=>k(z.kc,2),"%t":()=>"	","%u":z=>z.vb||7,"%U":z=>k(Math.floor((z.zb+7-z.vb)/7),2),"%V":z=>{var we=Math.floor((z.zb+7-(z.vb+6)%7)/7);if(2>=(z.vb+371-z.zb-2)%7&&we++,we)we==53&&(Pe=(z.vb+371-z.zb)%7,Pe==4||Pe==3&&Mt(z.Ab)||(we=1));else{we=52;var Pe=(z.vb+7-z.zb-1)%7;(Pe==4||Pe==5&&Mt(z.Ab%400-1))&&we++}return k(we,2)},"%w":z=>z.vb,"%W":z=>k(Math.floor((z.zb+7-(z.vb+6)%7)/7),2),"%y":z=>(z.Ab+1900).toString().substring(2),"%Y":z=>z.Ab+1900,"%z":z=>{z=z.ic;var we=0<=z;return z=Math.abs(z)/60,(we?"+":"-")+("0000"+(z/60*100+z%60)).slice(-4)},"%Z":z=>z.lc,"%%":()=>"%"},f=f.replace(/%%/g,"\\0\\0");for(ce in J)f.includes(ce)&&(f=f.replace(new RegExp(ce,"g"),J[ce](b)));return f=f.replace(/\\0\\0/g,"%"),ce=Qd(f),ce.length>l?0:(Jd(ce,n),ce.length-1)}ge.Gb();for(var mi=Array(256),cn=0;256>cn;++cn)mi[cn]=String.fromCharCode(cn);on=mi,wt=d.BindingError=class extends Error{constructor(n){super(n),this.name="BindingError"}},d.InternalError=class extends Error{constructor(n){super(n),this.name="InternalError"}},lt.push(0,1,void 0,1,null,1,!0,1,!1,1),d.count_emval_handles=()=>lt.length/2-5-fr.length;var el=[dr,jr,Yr,Xr,Qr,Zt,kr,Or,Jr,pr,en,tn,rn,nn,Rr,Xt,ei,ti,oi,ii,ai,si,ui,di],tl={ua:function(n,l,f){return te(async()=>{await d.Zb(n,l,f)})},b:function(n,l,f){throw n>>>=0,new qn(n).Gb(l>>>0,f>>>0),Kr=n,jn++,Kr},ia:function(n){hi(n>>>0,!E,1,!x,131072,!1),ge.Pb()},G:function(n){n>>>=0,O?postMessage({cmd:"cleanupThread",thread:n}):ge.Nb(ge.ub[n])},_:Zr,A:Xr,pa:Qr,W:Zt,Y:kr,qa:Or,na:Jr,fa:pr,ma:en,K:tn,X:rn,U:nn,oa:Rr,V:Xt,E:function(n,l,f){n>>>=0,f>>>=0,l=nt(l>>>0),Je(n,{name:l,fromWireType:b=>b,toWireType:function(b,C){if(typeof C!="bigint"&&typeof C!="number")throw C===null?C="null":(b=typeof C,C=b==="object"||b==="array"||b==="function"?C.toString():""+C),new TypeError(`Cannot convert "${C}" to ${this.name}`);return typeof C=="number"&&(C=BigInt(C)),C},argPackAdvance:8,readValueFromPointer:Dr(l,f,l.indexOf("u")==-1),Bb:null})},O:function(n,l,f,b){n>>>=0,l=nt(l>>>0),Je(n,{name:l,fromWireType:function(C){return!!C},toWireType:function(C,k){return k?f:b},argPackAdvance:8,readValueFromPointer:function(C){return this.fromWireType(o()[C>>>0])},Bb:null})},N:function(n){return Je(n>>>0,Zn)},D:function(n,l,f){n>>>=0,f>>>=0,l=nt(l>>>0),Je(n,{name:l,fromWireType:b=>b,toWireType:(b,C)=>C,argPackAdvance:8,readValueFromPointer:an(l,f),Bb:null})},t:function(n,l,f,b,C){if(n>>>=0,f>>>=0,l=nt(l>>>0),C===-1&&(C=4294967295),C=F=>F,b===0){var k=32-8*f;C=F=>F<<k>>>k}var V=l.includes("unsigned")?function(F,re){return re>>>0}:function(F,re){return re};Je(n,{name:l,fromWireType:C,toWireType:V,argPackAdvance:8,readValueFromPointer:Dr(l,f,b!==0),Bb:null})},p:function(n,l,f){function b(k){var V=c()[k>>>2>>>0];return k=c()[k+4>>>2>>>0],new C(r().buffer,k,V)}n>>>=0;var C=[Int8Array,Uint8Array,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array,BigInt64Array,BigUint64Array][l];f=nt(f>>>0),Je(n,{name:f,fromWireType:b,argPackAdvance:8,readValueFromPointer:b},{Ub:!0})},F:function(n,l){n>>>=0,l=nt(l>>>0);var f=l==="std::string";Je(n,{name:l,fromWireType:function(b){var C=c()[b>>>2>>>0],k=b+4;if(f)for(var V=k,F=0;F<=C;++F){var re=k+F;if(F==C||o()[re>>>0]==0){if(V=He(V,re-V),J===void 0)var J=V;else J+=String.fromCharCode(0),J+=V;V=re+1}}else{for(J=Array(C),F=0;F<C;++F)J[F]=String.fromCharCode(o()[k+F>>>0]);J=J.join("")}return At(b),J},toWireType:function(b,C){C instanceof ArrayBuffer&&(C=new Uint8Array(C));var k=typeof C=="string";if(!(k||C instanceof Uint8Array||C instanceof Uint8ClampedArray||C instanceof Int8Array))throw new wt("Cannot pass non-string to std::string");var V=f&&k?gt(C):C.length,F=mn(4+V+1),re=F+4;if(c()[F>>>2>>>0]=V,f&&k)Bt(C,re,V+1);else if(k)for(k=0;k<V;++k){var J=C.charCodeAt(k);if(255<J)throw At(re),new wt("String has UTF-16 code units that do not fit in 8 bits");o()[re+k>>>0]=J}else for(k=0;k<V;++k)o()[re+k>>>0]=C[k];return b!==null&&b.push(At,F),F},argPackAdvance:8,readValueFromPointer:Qt,Bb(b){At(b)}})},z:function(n,l,f){if(n>>>=0,l>>>=0,f>>>=0,f=nt(f),l===2)var b=Xn,C=sn,k=un,V=F=>u()[F>>>1>>>0];else l===4&&(b=gr,C=Qn,k=pe,V=F=>c()[F>>>2>>>0]);Je(n,{name:f,fromWireType:F=>{for(var re=c()[F>>>2>>>0],J,ce=F+4,Re=0;Re<=re;++Re){var ze=F+4+Re*l;(Re==re||V(ze)==0)&&(ce=b(ce,ze-ce),J===void 0?J=ce:(J+=String.fromCharCode(0),J+=ce),ce=ze+l)}return At(F),J},toWireType:(F,re)=>{if(typeof re!="string")throw new wt(`Cannot pass non-string to C++ string type ${f}`);var J=k(re),ce=mn(4+J+l);return c()[ce>>>2>>>0]=J/l,C(re,ce+4,J+l),F!==null&&F.push(At,ce),ce},argPackAdvance:8,readValueFromPointer:Qt,Bb(F){At(F)}})},P:function(n,l){n>>>=0,l=nt(l>>>0),Je(n,{Vb:!0,name:l,argPackAdvance:0,fromWireType:()=>{},toWireType:()=>{}})},ta:()=>1,S:function(n,l){n>>>=0,n==l>>>0?setTimeout(rt):O?postMessage({targetThread:n,cmd:"checkMailbox"}):(n=ge.ub[n])&&n.postMessage({cmd:"checkMailbox"})},$:function(n,l,f,b,C){l>>>=0,f>>>=0,b/=2,yr.length=b,C=C>>>0>>>3;for(var k=0;k<b;k++)yr[k]=Be[C+2*k]?Be[C+2*k+1]:h()[C+2*k+1>>>0];return n=l?Ir[l]:el[n],ge.Sb=f,f=n(...yr),ge.Sb=0,f},ha:Nt,sa:function(n){P&&ge.ub[n>>>0].ref()},w:function(n,l,f){return l>>>=0,f>>>=0,n=Qe(n>>>0),l=br(l,"emval::as"),Ur(l,f,n)},y:function(n){return n>>>=0,te(()=>(n=Qe(n),n.then(ot)))},o:function(n,l,f,b){return f>>>=0,b>>>=0,n=X[n>>>0],l=Qe(l>>>0),n(null,l,f,b)},k:function(n,l,f,b,C){return f>>>=0,b>>>=0,C>>>=0,n=X[n>>>0],l=Qe(l>>>0),f=Ee(f),n(l,l[f],b,C)},c:hr,C:function(n,l){return l>>>=0,n=Qe(n>>>0),l=Qe(l),n==l},n:function(n){return n>>>=0,n===0?ot(Oe()):(n=Ee(n),ot(Oe()[n]))},j:function(n,l,f){l=be(n,l>>>0);var b=l.shift();n--;var C=`return function (obj, func, destructorsRef, args) {\n`,k=0,V=[];f===0&&V.push("obj");for(var F=["retType"],re=[b],J=0;J<n;++J)V.push("arg"+J),F.push("argType"+J),re.push(l[J]),C+=`  var arg${J} = argType${J}.readValueFromPointer(args${k?"+"+k:""});\n`,k+=l[J].argPackAdvance;return C+=`  var rv = ${f===1?"new func":"func.call"}(${V.join(", ")});\n`,b.Vb||(F.push("emval_returnValue"),re.push(Ur),C+=`  return emval_returnValue(retType, destructorsRef, rv);\n`),F.push(C+`};\n`),n=zt(F)(...re),f=`methodCaller<(${l.map(ce=>ce.name).join(", ")}) => ${b.name}>`,D(Ie(f,n))},s:function(n,l){return l>>>=0,n=Qe(n>>>0),l=Qe(l),ot(n[l])},d:function(n){n>>>=0,9<n&&(lt[n+1]+=1)},v:function(){return ot([])},m:function(n){n=Qe(n>>>0);for(var l=Array(n.length),f=0;f<n.length;f++)l[f]=n[f];return ot(l)},g:function(n){return ot(Ee(n>>>0))},l:function(){return ot({})},i:function(n){n>>>=0;for(var l=Qe(n);l.length;){var f=l.pop();l.pop()(f)}hr(n)},h:function(n,l,f){l>>>=0,f>>>=0,n=Qe(n>>>0),l=Qe(l),f=Qe(f),n[l]=f},e:function(n,l){return l>>>=0,n=br(n>>>0,"_emval_take_value"),n=n.readValueFromPointer(l),ot(n)},ca:function(n,l){n=-9007199254740992>n||9007199254740992<n?NaN:Number(n),l>>>=0,n=new Date(1e3*n),a()[l>>>2>>>0]=n.getUTCSeconds(),a()[l+4>>>2>>>0]=n.getUTCMinutes(),a()[l+8>>>2>>>0]=n.getUTCHours(),a()[l+12>>>2>>>0]=n.getUTCDate(),a()[l+16>>>2>>>0]=n.getUTCMonth(),a()[l+20>>>2>>>0]=n.getUTCFullYear()-1900,a()[l+24>>>2>>>0]=n.getUTCDay(),n=(n.getTime()-Date.UTC(n.getUTCFullYear(),0,1,0,0,0,0))/864e5|0,a()[l+28>>>2>>>0]=n},da:function(n,l){n=-9007199254740992>n||9007199254740992<n?NaN:Number(n),l>>>=0,n=new Date(1e3*n),a()[l>>>2>>>0]=n.getSeconds(),a()[l+4>>>2>>>0]=n.getMinutes(),a()[l+8>>>2>>>0]=n.getHours(),a()[l+12>>>2>>>0]=n.getDate(),a()[l+16>>>2>>>0]=n.getMonth(),a()[l+20>>>2>>>0]=n.getFullYear()-1900,a()[l+24>>>2>>>0]=n.getDay();var f=(Mt(n.getFullYear())?Qo:Jo)[n.getMonth()]+n.getDate()-1|0;a()[l+28>>>2>>>0]=f,a()[l+36>>>2>>>0]=-(60*n.getTimezoneOffset()),f=new Date(n.getFullYear(),6,1).getTimezoneOffset();var b=new Date(n.getFullYear(),0,1).getTimezoneOffset();n=(f!=b&&n.getTimezoneOffset()==Math.min(b,f))|0,a()[l+32>>>2>>>0]=n},ea:function(n){n>>>=0;var l=new Date(a()[n+20>>>2>>>0]+1900,a()[n+16>>>2>>>0],a()[n+12>>>2>>>0],a()[n+8>>>2>>>0],a()[n+4>>>2>>>0],a()[n>>>2>>>0],0),f=a()[n+32>>>2>>>0],b=l.getTimezoneOffset(),C=new Date(l.getFullYear(),6,1).getTimezoneOffset(),k=new Date(l.getFullYear(),0,1).getTimezoneOffset(),V=Math.min(k,C);return 0>f?a()[n+32>>>2>>>0]=+(C!=k&&V==b):0<f!=(V==b)&&(C=Math.max(k,C),l.setTime(l.getTime()+6e4*((0<f?V:C)-b))),a()[n+24>>>2>>>0]=l.getDay(),f=(Mt(l.getFullYear())?Qo:Jo)[l.getMonth()]+l.getDate()-1|0,a()[n+28>>>2>>>0]=f,a()[n>>>2>>>0]=l.getSeconds(),a()[n+4>>>2>>>0]=l.getMinutes(),a()[n+8>>>2>>>0]=l.getHours(),a()[n+12>>>2>>>0]=l.getDate(),a()[n+16>>>2>>>0]=l.getMonth(),a()[n+20>>>2>>>0]=l.getYear(),n=l.getTime(),BigInt(isNaN(n)?-1:n/1e3)},aa:ei,ba:ti,R:function(n,l,f,b){n>>>=0,l>>>=0,f>>>=0,b>>>=0;var C=new Date().getFullYear(),k=new Date(C,0,1),V=new Date(C,6,1);C=k.getTimezoneOffset();var F=V.getTimezoneOffset(),re=Math.max(C,F);c()[n>>>2>>>0]=60*re,a()[l>>>2>>>0]=+(C!=F),n=J=>J.toLocaleTimeString(void 0,{hour12:!1,timeZoneName:"short"}).split(" ")[1],k=n(k),V=n(V),F<C?(Bt(k,f,17),Bt(V,b,17)):(Bt(k,b,17),Bt(V,f,17))},q:()=>{Kt("")},f:function(n,l,f){return n>>>=0,l=ri(l>>>0,f>>>0),Ir[n](...l)},M:function(n,l,f){return n>>>=0,l=ri(l>>>0,f>>>0),Ir[n](...l)},H:()=>{},L:()=>Date.now(),ra:()=>{throw bt+=1,"unwind"},T:function(){return 4294901760},u:()=>performance.timeOrigin+performance.now(),x:()=>P?(Ri(),wr(Oi)).cpus().length:navigator.hardwareConcurrency,Q:function(n){n>>>=0;var l=o().length;if(n<=l||4294901760<n)return!1;for(var f=1;4>=f;f*=2){var b=l*(1+.2/f);b=Math.min(b,n+100663296);var C=Math;b=Math.max(n,b);e:{C=(C.min.call(C,4294901760,b+(65536-b%65536)%65536)-ae.buffer.byteLength+65535)/65536;try{ae.grow(C),Ne();var k=1;break e}catch{}k=void 0}if(k)return!0}return!1},ja:oi,la:ii,Z:Xe,B:ai,J:si,ga:ui,I:di,a:ae||d.wasmMemory,ka:pi,r:function(n,l,f,b){return pi(n>>>0,l>>>0,f>>>0,b>>>0)}},oe=function(){function n(f,b){return oe=f.exports,oe=dn(),oe=rl(),ge.Qb.push(oe.cb),Rt.unshift(oe.va),Ae=b,xr(),oe}var l={a:tl};if(Vt++,d.instantiateWasm)try{return d.instantiateWasm(l,n)}catch(f){ee(`Module.instantiateWasm callback failed with error: ${f}`),w(f)}return Ar(l,function(f){n(f.instance,f.module)}).catch(w),{}}(),fi=n=>(fi=oe.wa)(n);d.__embind_initialize_bindings=()=>(d.__embind_initialize_bindings=oe.xa)(),d._OrtInit=(n,l)=>(d._OrtInit=oe.ya)(n,l),d._OrtGetLastError=(n,l)=>(d._OrtGetLastError=oe.za)(n,l),d._OrtCreateSessionOptions=(n,l,f,b,C,k,V,F,re,J)=>(d._OrtCreateSessionOptions=oe.Aa)(n,l,f,b,C,k,V,F,re,J),d._OrtAppendExecutionProvider=(n,l)=>(d._OrtAppendExecutionProvider=oe.Ba)(n,l),d._OrtAddFreeDimensionOverride=(n,l,f)=>(d._OrtAddFreeDimensionOverride=oe.Ca)(n,l,f),d._OrtAddSessionConfigEntry=(n,l,f)=>(d._OrtAddSessionConfigEntry=oe.Da)(n,l,f),d._OrtReleaseSessionOptions=n=>(d._OrtReleaseSessionOptions=oe.Ea)(n),d._OrtCreateSession=(n,l,f)=>(d._OrtCreateSession=oe.Fa)(n,l,f),d._OrtReleaseSession=n=>(d._OrtReleaseSession=oe.Ga)(n),d._OrtGetInputOutputCount=(n,l,f)=>(d._OrtGetInputOutputCount=oe.Ha)(n,l,f),d._OrtGetInputName=(n,l)=>(d._OrtGetInputName=oe.Ia)(n,l),d._OrtGetOutputName=(n,l)=>(d._OrtGetOutputName=oe.Ja)(n,l),d._OrtFree=n=>(d._OrtFree=oe.Ka)(n),d._OrtCreateTensor=(n,l,f,b,C,k)=>(d._OrtCreateTensor=oe.La)(n,l,f,b,C,k),d._OrtGetTensorData=(n,l,f,b,C)=>(d._OrtGetTensorData=oe.Ma)(n,l,f,b,C),d._OrtReleaseTensor=n=>(d._OrtReleaseTensor=oe.Na)(n),d._OrtCreateRunOptions=(n,l,f,b)=>(d._OrtCreateRunOptions=oe.Oa)(n,l,f,b),d._OrtAddRunConfigEntry=(n,l,f)=>(d._OrtAddRunConfigEntry=oe.Pa)(n,l,f),d._OrtReleaseRunOptions=n=>(d._OrtReleaseRunOptions=oe.Qa)(n),d._OrtCreateBinding=n=>(d._OrtCreateBinding=oe.Ra)(n),d._OrtBindInput=(n,l,f)=>(d._OrtBindInput=oe.Sa)(n,l,f),d._OrtBindOutput=(n,l,f,b)=>(d._OrtBindOutput=oe.Ta)(n,l,f,b),d._OrtClearBoundOutputs=n=>(d._OrtClearBoundOutputs=oe.Ua)(n),d._OrtReleaseBinding=n=>(d._OrtReleaseBinding=oe.Va)(n),d._OrtRunWithBinding=(n,l,f,b,C)=>(d._OrtRunWithBinding=oe.Wa)(n,l,f,b,C),d._OrtRun=(n,l,f,b,C,k,V,F)=>(d._OrtRun=oe.Xa)(n,l,f,b,C,k,V,F),d._OrtEndProfiling=n=>(d._OrtEndProfiling=oe.Ya)(n),d._JsepOutput=(n,l,f)=>(d._JsepOutput=oe.Za)(n,l,f),d._JsepGetNodeName=n=>(d._JsepGetNodeName=oe._a)(n);var pn=d._pthread_self=()=>(pn=d._pthread_self=oe.$a)(),mn=d._malloc=n=>(mn=d._malloc=oe.ab)(n),At=d._free=n=>(At=d._free=oe.bb)(n);d.__emscripten_tls_init=()=>(d.__emscripten_tls_init=oe.cb)();var hi=d.__emscripten_thread_init=(n,l,f,b,C,k)=>(hi=d.__emscripten_thread_init=oe.eb)(n,l,f,b,C,k);d.__emscripten_thread_crashed=()=>(d.__emscripten_thread_crashed=oe.fb)();var gi=(n,l,f,b,C)=>(gi=oe.gb)(n,l,f,b,C),ro=n=>(ro=oe.hb)(n),no=d.__emscripten_thread_exit=n=>(no=d.__emscripten_thread_exit=oe.ib)(n),yi=()=>(yi=oe.jb)(),bi=(n,l)=>(bi=oe.kb)(n,l),fn=n=>(fn=oe.lb)(n),oo=n=>(oo=oe.mb)(n),io=()=>(io=oe.nb)(),wi=d.dynCall_ii=(n,l)=>(wi=d.dynCall_ii=oe.pb)(n,l),vi=n=>(vi=oe.qb)(n),$i=()=>($i=oe.rb)(),_i=n=>(_i=oe.sb)(n),Si=()=>(Si=oe.tb)();d.___start_em_js=839500,d.___stop_em_js=839661;function rl(){var n=oe;n=Object.assign({},n);var l=b=>C=>b(C)>>>0,f=b=>()=>b()>>>0;return n.wa=l(n.wa),n.$a=f(n.$a),n.ab=l(n.ab),n.emscripten_main_runtime_thread_id=f(n.emscripten_main_runtime_thread_id),n.mb=l(n.mb),n.nb=f(n.nb),n}d.wasmMemory=ae,d.stackSave=()=>io(),d.stackRestore=n=>fn(n),d.stackAlloc=n=>oo(n),d.keepRuntimeAlive=()=>0<bt,d.UTF8ToString=He,d.stringToUTF8=Bt,d.lengthBytesUTF8=gt,d.ExitStatus=st,d.PThread=ge;var hn;jt=function n(){hn||xi(),hn||(jt=n)};function xi(){if(!(0<Vt))if(O)y(d),O||Yt(Rt),startWorker(d);else{if(d.preRun)for(typeof d.preRun=="function"&&(d.preRun=[d.preRun]);d.preRun.length;)mt.unshift(d.preRun.shift());Yt(mt),0<Vt||hn||(hn=!0,d.calledRun=!0,me||(O||Yt(Rt),y(d),O||Yt(qt)))}}return xi(),_}})();typeof Di=="object"&&typeof mo=="object"?mo.exports=Bi:typeof define=="function"&&define.amd&&define([],()=>Bi)});var Mi=Wr((gm,cl)=>{cl.exports=\'"use strict";var Module={},ENVIRONMENT_IS_NODE=typeof process=="object"&&typeof process.versions=="object"&&typeof process.versions.node=="string";if(ENVIRONMENT_IS_NODE){var nodeWorkerThreads=require("worker_threads"),parentPort=nodeWorkerThreads.parentPort;parentPort.on("message",e=>onmessage({data:e}));var fs=require("fs"),vm=require("vm");Object.assign(global,{self:global,require,Module,location:{href:__filename},Worker:nodeWorkerThreads.Worker,importScripts:e=>vm.runInThisContext(fs.readFileSync(e,"utf8"),{filename:e}),postMessage:e=>parentPort.postMessage(e),performance:global.performance||{now:Date.now}})}var initializedJS=!1;function threadPrintErr(...e){var a=e.join(" ");if(ENVIRONMENT_IS_NODE){fs.writeSync(2,a+`\\n`);return}console.error(a)}function threadAlert(...e){var a=e.join(" ");postMessage({cmd:"alert",text:a,threadId:Module._pthread_self()})}var err=threadPrintErr;self.alert=threadAlert,Module.instantiateWasm=(e,a)=>{var r=Module.wasmModule;Module.wasmModule=null;var t=new WebAssembly.Instance(r,e);return a(t)},self.onunhandledrejection=e=>{throw e.reason||e};function handleMessage(e){try{if(e.data.cmd==="load"){let r=[];self.onmessage=t=>r.push(t),self.startWorker=t=>{Module=t,postMessage({cmd:"loaded"});for(let s of r)handleMessage(s);self.onmessage=handleMessage},Module.wasmModule=e.data.wasmModule;for(const t of e.data.handlers)Module[t]=(...s)=>{postMessage({cmd:"callHandler",handler:t,args:s})};if(Module.wasmMemory=e.data.wasmMemory,Module.buffer=Module.wasmMemory.buffer,Module.ENVIRONMENT_IS_PTHREAD=!0,typeof e.data.urlOrBlob=="string")importScripts(e.data.urlOrBlob);else{var a=URL.createObjectURL(e.data.urlOrBlob);importScripts(a),URL.revokeObjectURL(a)}ortWasmThreaded(Module)}else if(e.data.cmd==="run"){Module.__emscripten_thread_init(e.data.pthread_ptr,0,0,1),Module.__emscripten_thread_mailbox_await(e.data.pthread_ptr),Module.establishStackSpace(),Module.PThread.receiveObjectTransfer(e.data),Module.PThread.threadInitTLS(),initializedJS||(initializedJS=!0);try{Module.invokeEntryPoint(e.data.start_routine,e.data.arg)}catch(r){if(r!="unwind")throw r}}else e.data.cmd==="cancel"?Module._pthread_self()&&Module.__emscripten_thread_exit(-1):e.data.target==="setimmediate"||(e.data.cmd==="checkMailbox"?initializedJS&&Module.checkMailbox():e.data.cmd&&(err(`worker.js received unknown command ${e.data.cmd}`),err(e.data)))}catch(r){throw Module.__emscripten_thread_crashed?.(),r}}self.onmessage=handleMessage;\\n\'});var go,Gt,tr,bn,Gr,Hi,yo,ye=Y(()=>{"use strict";go=e=>{switch(e){case"int8":return 3;case"uint8":return 2;case"bool":return 9;case"int16":return 5;case"uint16":return 4;case"int32":return 6;case"uint32":return 12;case"float16":return 10;case"float32":return 1;case"float64":return 11;case"string":return 8;case"int64":return 7;case"uint64":return 13;default:throw new Error(`unsupported data type: ${e}`)}},Gt=e=>{switch(e){case 3:return"int8";case 2:return"uint8";case 9:return"bool";case 5:return"int16";case 4:return"uint16";case 6:return"int32";case 12:return"uint32";case 10:return"float16";case 1:return"float32";case 11:return"float64";case 8:return"string";case 7:return"int64";case 13:return"uint64";default:throw new Error(`unsupported data type: ${e}`)}},tr=e=>[void 0,4,1,1,2,2,4,8,void 0,1,2,8,4,8,void 0,void 0,void 0][e],bn=e=>{switch(e){case"float16":return typeof Float16Array<"u"&&Float16Array.from?Float16Array:Uint16Array;case"float32":return Float32Array;case"uint8":return Uint8Array;case"int8":return Int8Array;case"uint16":return Uint16Array;case"int16":return Int16Array;case"int32":return Int32Array;case"bool":return Uint8Array;case"float64":return Float64Array;case"uint32":return Uint32Array;case"int64":return BigInt64Array;case"uint64":return BigUint64Array;default:throw new Error(`unsupported type: ${e}`)}},Gr=e=>{switch(e){case"verbose":return 0;case"info":return 1;case"warning":return 2;case"error":return 3;case"fatal":return 4;default:throw new Error(`unsupported logging level: ${e}`)}},Hi=e=>e==="float32"||e==="float16"||e==="int32"||e==="int64"||e==="uint32"||e==="uint8"||e==="bool",yo=e=>{switch(e){case"none":return 0;case"cpu":return 1;case"cpu-pinned":return 2;case"texture":return 3;case"gpu-buffer":return 4;default:throw new Error(`unsupported data location: ${e}`)}}});var wn=Y(()=>{"use strict"});var Fi=Y(()=>{"use strict";wn()});var qi,ji=Y(()=>{"use strict";qi="1.18.0"});var Ki,pt,bo=Y(()=>{"use strict";ji();Ki="warning",pt={wasm:{},webgl:{},webgpu:{},versions:{common:qi},set logLevel(e){if(e!==void 0){if(typeof e!="string"||["verbose","info","warning","error","fatal"].indexOf(e)===-1)throw new Error(`Unsupported logging level: ${e}`);Ki=e}},get logLevel(){return Ki}};Object.defineProperty(pt,"logLevel",{enumerable:!0})});var vr,Yi=Y(()=>{"use strict";bo();vr=pt});var Zi=Y(()=>{"use strict"});var Xi=Y(()=>{"use strict";vn()});var Ji=Y(()=>{"use strict"});var ea=Y(()=>{"use strict";vn()});var vn=Y(()=>{"use strict";Zi();Xi();Ji();ea()});var $n=Y(()=>{"use strict";vn()});var wo,ta,rr,Ht,vo=Y(()=>{"use strict";bo();wo=(e,t)=>{(typeof pt.trace>"u"?!pt.wasm.trace:!pt.trace)||console.timeStamp(`${e}::ORT::${t}`)},ta=(e,t)=>{let r=new Error().stack?.split(/\\r\\n|\\r|\\n/g)||[],o=!1;for(let i=0;i<r.length;i++){if(o&&!r[i].includes("TRACE_FUNC")){let u=`FUNC_${e}::${r[i].trim().split(" ")[1]}`;t&&(u+=`::${t}`),wo("CPU",u);return}r[i].includes("TRACE_FUNC")&&(o=!0)}},rr=e=>{(typeof pt.trace>"u"?!pt.wasm.trace:!pt.trace)||ta("BEGIN",e)},Ht=e=>{(typeof pt.trace>"u"?!pt.wasm.trace:!pt.trace)||ta("END",e)}});var ra=Y(()=>{"use strict";wn();$n();vo()});var na=Y(()=>{"use strict";ra()});var oa=Y(()=>{"use strict"});var ia=Y(()=>{"use strict"});var aa=Y(()=>{"use strict"});var sa=Y(()=>{"use strict"});var ua=Y(()=>{"use strict";wn();$n()});var da=Y(()=>{"use strict";ua()});var $r=Y(()=>{"use strict";Fi();Yi();na();$n();oa();ia();vo();aa();sa();da()});var _l,Sl,la,ca,pa,xl,Ve,Lt=Y(()=>{"use strict";ye();_l=["V","I","W","E","F"],Sl=(e,t)=>{console.log(`[${_l[e]},${new Date().toISOString()}]${t}`)},pa=(e,t)=>{la=e,ca=t},xl=(e,t)=>{let r=Gr(e),o=Gr(la);r>=o&&Sl(r,typeof t=="function"?t():t)},Ve=(...e)=>{ca&&xl(...e)}});var ma,fa=Y(()=>{"use strict";ye();ma=(e,t)=>new(bn(t))(e)});var _n=Y(()=>{"use strict"});var ha,$o,_o,Cl,Al,ga,xo,So,ba,wa=Y(()=>{"use strict";Lt();_n();ha=new Map([[64,250],[128,200],[256,200],[512,200],[2048,230],[4096,200],[8192,50],[16384,50],[32768,50],[65536,50],[131072,50],[262144,50],[524288,50],[1048576,50],[2097152,30],[4194304,20],[8388608,10],[12582912,10],[16777216,10],[26214400,15],[33554432,22],[44236800,2],[58982400,6],[67108864,6],[134217728,6],[167772160,6]]),$o=[],_o=e=>Math.ceil(e/16)*16,Cl=e=>{for(let t=0;t<$o.length;t++){let r=$o[t];if(e<=r)return r}return Math.ceil(e/16)*16},Al=1,ga=()=>Al++,xo=async(e,t,r,o)=>{let i=_o(r),u=e.device.createBuffer({size:i,usage:GPUBufferUsage.COPY_DST|GPUBufferUsage.MAP_READ});try{let a=e.getCommandEncoder();e.endComputePass(),a.copyBufferToBuffer(t,0,u,0,i),e.flush(),await u.mapAsync(GPUMapMode.READ);let c=u.getMappedRange();if(o){let p=o();return p.set(new Uint8Array(c,0,r)),p}else return new Uint8Array(c.slice(0,r))}finally{u.destroy()}},So=class{constructor(t){this.backend=t;this.storageCache=new Map,this.freeBuffers=new Map,this.freeUniformBuffers=new Map,this.buffersForUploadingPending=[],this.buffersPending=[],this.externalBuffers=new Map,this.capturedPendingBuffers=new Map;for(let[r]of ha)$o.push(r),this.freeBuffers.set(r,[]),this.freeUniformBuffers.set(r,[])}upload(t,r){let o=r.buffer,i=r.byteOffset,u=r.byteLength,a=_o(u),c=this.storageCache.get(t);if(!c)throw new Error("gpu data for uploading does not exist");if(c.originalSize!==u)throw new Error(`inconsistent data size. gpu data size=${c.originalSize}, data size=${u}`);let p=this.backend.device.createBuffer({mappedAtCreation:!0,size:a,usage:GPUBufferUsage.MAP_WRITE|GPUBufferUsage.COPY_SRC}),h=p.getMappedRange();new Uint8Array(h).set(new Uint8Array(o,i,u)),p.unmap();let d=this.backend.getCommandEncoder();this.backend.endComputePass(),d.copyBufferToBuffer(p,0,c.gpuData.buffer,0,a),Ve("verbose",()=>`[WebGPU] GpuDataManager.upload(id=${t})`),this.buffersForUploadingPending.push(p)}memcpy(t,r){let o=this.storageCache.get(t);if(!o)throw new Error("source gpu data for memcpy does not exist");let i=this.storageCache.get(r);if(!i)throw new Error("destination gpu data for memcpy does not exist");if(o.originalSize!==i.originalSize)throw new Error("inconsistent source and destination gpu data size");let u=_o(o.originalSize),a=this.backend.getCommandEncoder();this.backend.endComputePass(),a.copyBufferToBuffer(o.gpuData.buffer,0,i.gpuData.buffer,0,u)}registerExternalBuffer(t,r,o){let i;if(o){if(i=this.externalBuffers.get(o),i===void 0)throw new Error("previous buffer is not registered");if(t===o)return Ve("verbose",()=>`[WebGPU] GpuDataManager.registerExternalBuffer(size=${r}) => id=${i}, buffer is the same, skip.`),i;if(this.backend.capturedCommandList.has(this.backend.currentSessionId))throw new Error(`Registering a different external buffer under graph capture mode is not supported yet.\n             Please use the previous external buffer!`);this.externalBuffers.delete(o)}else i=ga();return this.storageCache.set(i,{gpuData:{id:i,type:0,buffer:t},originalSize:r}),this.externalBuffers.set(t,i),Ve("verbose",()=>`[WebGPU] GpuDataManager.registerExternalBuffer(size=${r}) => id=${i}, registered.`),i}unregisterExternalBuffer(t){let r=this.externalBuffers.get(t);r!==void 0&&(this.storageCache.delete(r),this.externalBuffers.delete(t),Ve("verbose",()=>`[WebGPU] GpuDataManager.unregisterExternalBuffer() => id=${r}`))}create(t,r=GPUBufferUsage.STORAGE|GPUBufferUsage.COPY_SRC|GPUBufferUsage.COPY_DST){let o=Cl(t),i,u=(r&GPUBufferUsage.STORAGE)===GPUBufferUsage.STORAGE,a=(r&GPUBufferUsage.UNIFORM)===GPUBufferUsage.UNIFORM;if(u||a){let h=(u?this.freeBuffers:this.freeUniformBuffers).get(o);h?h.length>0?i=h.pop():i=this.backend.device.createBuffer({size:o,usage:r}):i=this.backend.device.createBuffer({size:o,usage:r})}else i=this.backend.device.createBuffer({size:o,usage:r});let c={id:ga(),type:0,buffer:i};return this.storageCache.set(c.id,{gpuData:c,originalSize:t}),Ve("verbose",()=>`[WebGPU] GpuDataManager.create(size=${t}) => id=${c.id}`),c}get(t){return this.storageCache.get(t)?.gpuData}release(t){let r=this.storageCache.get(t);if(!r)throw new Error("releasing data does not exist");return Ve("verbose",()=>`[WebGPU] GpuDataManager.release(id=${t}), gpuDataId=${r.gpuData.id}`),this.storageCache.delete(t),this.buffersPending.push(r.gpuData.buffer),r.originalSize}async download(t,r){let o=this.storageCache.get(t);if(!o)throw new Error("data does not exist");await xo(this.backend,o.gpuData.buffer,o.originalSize,r)}refreshPendingBuffers(){for(let t of this.buffersForUploadingPending)t.destroy();if(this.buffersForUploadingPending=[],this.buffersPending.length!==0)if(this.backend.sessionStatus==="default"){for(let t of this.buffersPending){let r=ha.get(t.size);if((t.usage&GPUBufferUsage.STORAGE)===GPUBufferUsage.STORAGE){let o=this.freeBuffers.get(t.size)||[];r===void 0||o.length>=r?t.destroy():o.push(t)}else if((t.usage&GPUBufferUsage.UNIFORM)===GPUBufferUsage.UNIFORM){let o=this.freeUniformBuffers.get(t.size)||[];r===void 0||o.length>=r?t.destroy():o.push(t)}else t.destroy()}this.buffersPending=[]}else{let t=this.capturedPendingBuffers.get(this.backend.currentSessionId);t||(t=[],this.capturedPendingBuffers.set(this.backend.currentSessionId,t));for(let r of this.buffersPending)t.push(r);this.buffersPending=[]}}dispose(){this.freeBuffers.forEach(t=>{t.forEach(r=>{r.destroy()})}),this.freeUniformBuffers.forEach(t=>{t.forEach(r=>{r.destroy()})}),this.storageCache.forEach(t=>{t.gpuData.buffer.destroy()}),this.capturedPendingBuffers.forEach(t=>{t.forEach(r=>{r.destroy()})}),this.storageCache=new Map,this.freeBuffers=new Map,this.freeUniformBuffers=new Map,this.capturedPendingBuffers=new Map}onReleaseSession(t){let r=this.capturedPendingBuffers.get(t);r&&(r.forEach(o=>{o.destroy()}),this.capturedPendingBuffers.delete(t))}},ba=(...e)=>new So(...e)});var Co,ve,Ze=Y(()=>{"use strict";Co=class{constructor(t){Object.assign(this,t)}get cacheKey(){return this.key||(this.key=Object.getOwnPropertyNames(this).sort().map(t=>`${this[t]}`).join(";")),this.key}},ve=e=>new Co(e)});var Ao,It,M,nr,Sn,xn,Cn,Se=Y(()=>{"use strict";Ao=class{static calcMatMulShape(t,r){return t[1]!==r[0]?void 0:[t[0],r[1]]}},It=class{static calcShape(t,r,o=!1){let i=t.length,u=r.length;if(i===0)return r;if(u===0)return t;let a=Math.max(t.length,r.length),c=new Array(a);if(o){if(i<2||u<2)return;let p=Ao.calcMatMulShape([t[i-2],t[i-1]],[r[u-2],r[u-1]]);if(p===void 0)return;[c[a-2],c[a-1]]=p}for(let p=o?3:1;p<=a;p++){let h=i-p<0?1:t[i-p],d=u-p<0?1:r[u-p];if(h!==d&&h>1&&d>1)return;let y=Math.max(h,d);if(h&&d)c[a-p]=Math.max(h,d);else{if(y>1)return;c[a-p]=0}}return c}static isValidBroadcast(t,r){let o=t.length,i=r.length;if(o>i)return!1;for(let u=1;u<=o;u++)if(t[o-u]!==1&&t[o-u]!==r[i-u])return!1;return!0}},M=class e{static size(t){return e.getSizeFromDimensionRange(t,0,t.length)}static convertShape(t,r=4){let o=t.length;if(o===0)return[];let i=new Array(o),u=o-1;for(;u>=0;){if(t[u]%r===0){i[u]=t[u]/r;break}if(r%t[u]!==0)throw new Error("cannot convert shape");i[u]=1,r/=t[u],u--}for(u--;u>=0;u--)i[u]=t[u];return i}static sizeFromDimension(t,r){if(r<0||r>t.length)throw new Error(`invalid dimension of ${r} for sizeFromDimension as Tensor has ${t.length} dimensions.`);return e.getSizeFromDimensionRange(t,r,t.length)}static sizeToDimension(t,r){if(r<0||r>t.length)throw new Error(`invalid dimension of ${r} for sizeToDimension as Tensor has ${t.length} dimensions.`);return e.getSizeFromDimensionRange(t,0,r)}static getSizeFromDimensionRange(t,r,o){let i=1;for(let u=r;u<o;u++){if(t[u]<0)throw new Error("cannot get valid size from specified dimension range. Most likely the range contains negative values in them.");i*=t[u]}return i}static computeStrides(t){let r=t.length;if(r===0)return[];if(r===1)return[1];let o=new Array(r);o[r-1]=1,o[r-2]=t[r-1];for(let i=r-3;i>=0;--i)o[i]=o[i+1]*t[i+1];return o}static normalizeAxis(t,r){if(t<-r&&t>=r)throw new Error("unsupported axis for this operation.");return t<0?t+r:t}static normalizeAxes(t,r){return t.map(o=>this.normalizeAxis(o,r??t.length))}static sortBasedOnPerm(t,r){return r?r.map(o=>t[o]):t.slice().reverse()}static padShape(t,r){let o=t.length;return t.map((i,u)=>i+r[u]+r[u+o])}static areEqual(t,r){return t.length!==r.length?!1:t.every((o,i)=>o===r[i])}},nr=class e{static adjustPoolAttributes(t,r,o,i,u,a){if(!t&&o.length!==r.length-2)throw new Error("length of specified kernel shapes should be 2 less than length of input dimensions");if(t)for(let c=0;c<r.length-2;c++)c>=o.length?o.push(r[c+2]):o[c]=r[c+2];for(let c=0;c<o.length;c++)if(c<i.length){if(i[c]<0)throw new Error("strides should be greater than or equal to 1")}else i.push(1);for(let c=0;c<o.length;c++)if(c<u.length){if(u[c]<0)throw new Error("dilations should be greater than or equal to 1")}else u.push(1);for(let c=0;c<o.length*2;c++)if(c<a.length){if(a[c]<0)throw new Error("pad should be greater than or equal to 1")}else a.push(0);for(let c=0;c<o.length;c++){if(o[c]<=0)throw new Error("kernel shapes need to be greater than 0");if(a[c]>=o[c]||a[c+o.length]>=o[c])throw new Error("pads should be smaller than kernel")}}static adjustPadsBasedOnAutoPad(t,r,o,i,u,a,c){if(c){if(u.length!==2*(t.length-2))throw new Error("length of pads should be twice the length of data dimensions");if(r.length!==t.length-2)throw new Error("length of strides should be the length of data dimensions");if(i.length!==t.length-2)throw new Error("length of kernel shapes should be the length of data dimensions");for(let p=0;p<t.length-2;p++)e.adjustPadAndReturnShape(t[p+(a?1:2)],r[p],o[p],i[p],u,p,p+t.length-2,c)}}static computePoolOutputShape(t,r,o,i,u,a,c){if(r.length<=0)throw new Error("input shape must be of size greater than 0");let p=[r[0],r[1]];return e.computeShapeHelper(t,r,p,o,i,u,a,c),p}static computeConvOutputShape(t,r,o,i,u,a,c){if(t.length<=0||r.length<=0)throw new Error("invalid input tensor dims or invalid filter tensor dims");let p=[t[0],r[0]];return e.computeShapeHelper(!1,t,p,o,i,u,a,c),p}static computeShapeHelper(t,r,o,i,u,a,c,p){if(t)for(let h=0;h<r.length-2;h++)o.push(1);else for(let h=0;h<r.length-2;h++)o.push(e.adjustPadAndReturnShape(r[h+2],i[h],u[h],a[h],c,h,h+r.length-2,p))}static adjustPadAndReturnShape(t,r,o,i,u,a,c,p){let h=o*(i-1)+1;if(p&&p!=="NOTSET")switch(p){case"VALID":return u[a]=0,u[c]=0,Math.floor((t-h)/r+1);case"SAME_LOWER":case"SAME_UPPER":if(o!==1)throw new Error("Dilation not supported for SAME_UPPER or SAME_LOWER");{let y=((t+r-1)/r-1)*r+i-t;return u[a]=Math.floor(p==="SAME_LOWER"?(y+1)/2:y/2),u[c]=y-u[a],Math.floor((t+y-i)/r+1)}default:throw new Error("Unsupported AutoPad type")}else return Math.floor((t+u[a]+u[c]-h)/r+1)}},Sn=class{static getShapeOfGemmResult(t,r,o,i,u){if(t.length!==2||o.length!==2)throw new Error("shape need to be of size 2");let a,c,p;r?(a=t[1],c=t[0]):(a=t[0],c=t[1]);let h=-1;if(i?(p=o[0],h=1):(p=o[1],h=0),o[h]!==c)throw new Error("dimension mismatch");if(a<=0||p<=0||c<=0)throw new Error("invalid shape specified");if(u&&!It.isValidBroadcast(u,[a,p]))throw new Error("gemm: invalid bias shape for broadcast");return[a,p,c]}},xn=-34028234663852886e22,Cn=34028234663852886e22});var or,To,De,et,Z,Me,$t,ir,_t,fe,Eo,U,j,An,Io,va,_r,_e=Y(()=>{"use strict";ye();Se();or=64,To=(e,t)=>{if(t===3)throw new Error("vec3 has same alignment as vec4, use vec4 instead");switch(e){case 10:return t>1?`vec${t}<f16>`:"f16";case 1:return t>1?`vec${t}<f32>`:"f32";case 6:return t>1?`vec${t}<i32>`:"i32";case 12:return t>1?`vec${t}<u32>`:"u32";case 7:if(t>1)throw new Error("currently not supported vecX of uint64 yet");return["vec2<u32>","i32"];case 13:if(t>1)throw new Error("currently not supported vecX of uint64 yet");return["vec2<u32>","u32"];case 9:if(t!==4)throw new Error("bool must be vec4");return["u32","vec4<bool>"];default:throw new Error(`Unknown data type: ${e}`)}},De=(e,t=1)=>{let r=To(e,t);return typeof r=="string"?r:r[0]},et=(e,t=1)=>{let r=To(e,t);return typeof r=="string"?r:r[1]},Z=(...e)=>{let t=[];return e.forEach(r=>{r.length!==0&&t.push({type:12,data:r},{type:12,data:M.computeStrides(r)})}),t},Me=e=>e%4===0?4:e%2===0?2:1,$t=(e="f32",t,r="0")=>!t||t===1?`${e}(${r})`:`vec${t}<${e}>(${r})`,ir=(e,t,r)=>e==="f32"?r:t===1?`f32(${r})`:`vec${t}<f32>(${r})`,_t=(e,t)=>t===4?`(${e}.x + ${e}.y + ${e}.z + ${e}.w)`:t===2?`(${e}.x + ${e}.y)`:t===3?`(${e}.x + ${e}.y + ${e}.z)`:e,fe=(e,t,r,o)=>e.startsWith("uniforms.")&&r>4?typeof t=="string"?o==="f16"?`${e}[(${t}) / 8][(${t}) % 8 / 4][(${t}) % 8 % 4]`:`${e}[(${t}) / 4][(${t}) % 4]`:o==="f16"?`${e}[${Math.floor(t/8)}][${Math.floor(t%8/4)}][${t%8%4}]`:`${e}[${Math.floor(t/4)}][${t%4}]`:r>1?`${e}[${t}]`:e,Eo=(e,t,r,o,i)=>{let u=typeof r=="number",a=u?r:r.length,c=[...new Array(a).keys()],p=a<2?"u32":a<=4?`vec${a}<u32>`:`array<u32, ${a}>`,h=To(t,i),d=typeof h=="string"?h:h[1],y=typeof h=="string"?h:h[0],w={indices:p,value:d,storage:y,tensor:t},_=G=>typeof G=="string"?G:`${G}u`,v={offsetToIndices:!1,indicesToOffset:!1,broadcastedIndicesToOffset:!1,set:!1,setByIndices:!1,get:!1,getByIndices:!1},S=u?"uniforms.":"",A=`${S}${e}_shape`,I=`${S}${e}_strides`,x="";for(let G=0;G<a-1;G++)x+=`\n    let dim${G} = current / ${fe(I,G,a)};\n    let rest${G} = current % ${fe(I,G,a)};\n    indices[${G}] = dim${G};\n    current = rest${G};\n    `;x+=`indices[${a-1}] = current;`;let E=a<2?"":`\n  fn o2i_${e}(offset: u32) -> ${w.indices} {\n    var indices: ${w.indices};\n    var current = offset;\n    ${x}\n    return indices;\n  }`,P=G=>(v.offsetToIndices=!0,a<2?G:`o2i_${e}(${G})`),O=[];if(a>=2)for(let G=a-1;G>=0;G--)O.push(`${fe(I,G,a)} * (indices[${G}])`);let R=a<2?"":`\n  fn i2o_${e}(indices: ${w.indices}) -> u32 {\n    return ${O.join("+")};\n  }`,L=G=>(v.indicesToOffset=!0,a<2?G:`i2o_${e}(${G})`),N=(...G)=>a===0?"0u":`${w.indices}(${G.map(_).join(",")})`,K=(G,ne)=>a<2?`${G}`:`${fe(G,ne,a)}`,Q=(G,ne,xe)=>a<2?`${G}=${xe};`:`${fe(G,ne,a)}=${xe};`,he={},W=(G,ne)=>{v.broadcastedIndicesToOffset=!0;let xe=`${ne.name}broadcastedIndicesTo${e}Offset`;if(xe in he)return`${xe}(${G})`;let Ke=[];for(let Be=a-1;Be>=0;Be--){let Ge=ne.indicesGet("outputIndices",Be+ne.rank-a);Ke.push(`${K(I,Be)} * (${Ge} % ${K(A,Be)})`)}return he[xe]=`fn ${xe}(outputIndices: ${ne.type.indices}) -> u32 {\n             return ${Ke.length>0?Ke.join("+"):"0u"};\n           }`,`${xe}(${G})`},se=(G,ne)=>(()=>{if(w.storage===w.value)return`${e}[${G}]=${ne};`;if(w.storage==="vec2<u32>"&&w.value==="i32")return`${e}[${G}]=vec2<u32>(u32(${ne}), select(0u, 0xFFFFFFFFu, ${ne} < 0));`;if(w.storage==="vec2<u32>"&&w.value==="u32")return`${e}[${G}]=vec2<u32>(u32(${ne}), 0u);`;if(w.storage==="u32"&&w.value==="vec4<bool>")return`${e}[${G}]=dot(vec4<u32>(0x1, 0x100, 0x10000, 0x1000000), vec4<u32>(${ne}));`;throw new Error(`not supported combination of storage type ${w.storage} and value type ${w.value} yet`)})(),Ce=G=>(()=>{if(w.storage===w.value)return`${e}[${G}]`;if(w.storage==="vec2<u32>"&&w.value==="i32")return`i32(${e}[${G}].x)`;if(w.storage==="vec2<u32>"&&w.value==="u32")return`u32(${e}[${G}].x)`;if(w.storage==="u32"&&w.value==="vec4<bool>")return`vec4<bool>(bool(${e}[${G}] & 0xFFu), bool(${e}[${G}] & 0xFF00u), bool(${e}[${G}] & 0xFF0000u), bool(${e}[${G}] & 0xFF000000u))`;throw new Error(`not supported combination of storage type ${w.storage} and value type ${w.value} yet`)})(),We=a<2?"":`\n  fn get_${e}ByIndices(indices: ${w.indices}) -> ${d} {\n    return ${Ce(`i2o_${e}(indices)`)};\n  }`,ee=a<2?"":(()=>{let G=c.map(xe=>`d${xe}: u32`).join(", "),ne=c.map(xe=>`d${xe}`).join(", ");return`\n  fn get_${e}(${G}) -> ${d} {\n    return get_${e}ByIndices(${N(ne)});\n  }`})(),ae=(...G)=>{if(G.length!==a)throw new Error(`indices length must be ${a}`);let ne=G.map(_).join(",");return a===0?Ce("0u"):a===1?Ce(ne[0]):(v.get=!0,v.getByIndices=!0,v.indicesToOffset=!0,`get_${e}(${ne})`)},Ae=G=>a<2?Ce(G):(v.getByIndices=!0,v.indicesToOffset=!0,`get_${e}ByIndices(${G})`),me=a<2?"":`\n  fn set_${e}ByIndices(indices: ${w.indices}, value: ${d}) {\n    ${se(`i2o_${e}(indices)`,"value")}\n  }`,ie=a<2?"":(()=>{let G=c.map(xe=>`d${xe}: u32`).join(", "),ne=c.map(xe=>`d${xe}`).join(", ");return`\n  fn set_${e}(${G}, value: ${d}) {\n    set_${e}ByIndices(${N(ne)}, value);\n  }`})();return{impl:()=>{let G=[],ne=!1;return v.offsetToIndices&&(G.push(E),ne=!0),v.indicesToOffset&&(G.push(R),ne=!0),v.broadcastedIndicesToOffset&&(Object.values(he).forEach(xe=>G.push(xe)),ne=!0),v.set&&(G.push(ie),ne=!0),v.setByIndices&&(G.push(me),ne=!0),v.get&&(G.push(ee),ne=!0),v.getByIndices&&(G.push(We),ne=!0),!u&&ne&&G.unshift(`const ${A} = ${w.indices}(${r.join(",")});`,`const ${I} = ${w.indices}(${M.computeStrides(r).join(",")});`),G.join(`\n`)},type:w,offsetToIndices:P,indicesToOffset:L,broadcastedIndicesToOffset:W,indices:N,indicesGet:K,indicesSet:Q,set:(...G)=>{if(G.length!==a+1)throw new Error(`indices length must be ${a}`);let ne=G[a];if(typeof ne!="string")throw new Error("value must be string");let xe=G.slice(0,a).map(_).join(",");return a===0?se("0u",ne):a===1?se(xe[0],ne):(v.set=!0,v.setByIndices=!0,v.indicesToOffset=!0,`set_${e}(${xe}, ${ne})`)},setByOffset:se,setByIndices:(G,ne)=>a<2?se(G,ne):(v.setByIndices=!0,v.indicesToOffset=!0,`set_${e}ByIndices(${G}, ${ne});`),get:ae,getByOffset:Ce,getByIndices:Ae,usage:o,name:e,strides:I,shape:A,rank:a}},U=(e,t,r,o=1)=>Eo(e,t,r,"input",o),j=(e,t,r,o=1)=>Eo(e,t,r,"output",o),An=(e,t,r,o=1)=>Eo(e,t,r,"internal",o),Io=class{constructor(t,r){this.normalizedDispatchGroup=t;this.limits=r;this.internalVariables=[];this.variables=[];this.uniforms=[];this.variableIndex=0}guardAgainstOutOfBoundsWorkgroupSizes(t){return`if (global_idx >= ${typeof t=="number"?`${t}u`:t}) { return; }`}mainStart(t=or){let r=typeof t=="number"?t:t[0],o=typeof t=="number"?1:t[1],i=typeof t=="number"?1:t[2];if(r>this.limits.maxComputeWorkgroupSizeX||o>this.limits.maxComputeWorkgroupSizeY||i>this.limits.maxComputeWorkgroupSizeZ)throw new Error(`workgroup size [${r}, ${o}, ${i}] exceeds the maximum workgroup size [${this.limits.maxComputeWorkgroupSizeX}, ${this.limits.maxComputeWorkgroupSizeY}, ${this.limits.maxComputeWorkgroupSizeZ}].`);if(r*o*i>this.limits.maxComputeInvocationsPerWorkgroup)throw new Error(`workgroup size [${r}, ${o}, ${i}] exceeds the maximum workgroup invocations ${this.limits.maxComputeInvocationsPerWorkgroup}.`);let u=this.normalizedDispatchGroup[1]===1&&this.normalizedDispatchGroup[2]===1,a=u?`@builtin(global_invocation_id) global_id : vec3<u32>,\n    @builtin(workgroup_id) workgroup_id : vec3<u32>,\n    @builtin(local_invocation_id) local_id : vec3<u32>`:`@builtin(global_invocation_id) global_id : vec3<u32>,\n                                             @builtin(local_invocation_id) local_id : vec3<u32>,\n    @builtin(local_invocation_index) local_idx : u32,\n    @builtin(workgroup_id) workgroup_id : vec3<u32>,\n    @builtin(num_workgroups) num_workgroups : vec3<u32>`,c=u?"let global_idx = global_id.x; let local_idx = local_id.x;":`let global_idx = (workgroup_id.z * num_workgroups[0] * num_workgroups[1] +\n          workgroup_id.y * num_workgroups[0] + workgroup_id.x) * ${r*o*i}u + local_idx;`;return`@compute @workgroup_size(${r}, ${o}, ${i})\n  fn main(${a}) {\n    ${c}\n  `}appendVariableUniforms(t){t.rank!==0&&(t.shape.startsWith("uniforms.")&&this.uniforms.push({name:t.shape.replace("uniforms.",""),type:"u32",length:t.rank}),t.strides.startsWith("uniforms.")&&this.uniforms.push({name:t.strides.replace("uniforms.",""),type:"u32",length:t.rank}))}declareVariable(t,r){if(t.usage==="internal")throw new Error("cannot use internal variable with declareVariable(). use registerInternalVariables() instead.");this.variables.push(t),this.appendVariableUniforms(t);let o=t.usage==="input"?"read":"read_write",i=t.type.storage;return`@group(0) @binding(${r}) var<storage, ${o}> ${t.name}: array<${i}>;`}declareVariables(...t){return t.map(r=>this.declareVariable(r,this.variableIndex++)).join(`\n`)}registerInternalVariable(t){if(t.usage!=="internal")throw new Error("cannot use input or output variable with registerInternalVariable(). use declareVariables() instead.");this.internalVariables.push(t),this.appendVariableUniforms(t)}registerInternalVariables(...t){return t.forEach(r=>this.registerInternalVariable(r)),this}registerUniform(t,r,o=1){return this.uniforms.push({name:t,type:r,length:o}),this}registerUniforms(t){return this.uniforms=this.uniforms.concat(t),this}uniformDeclaration(){if(this.uniforms.length===0)return"";let t=[];for(let{name:r,type:o,length:i}of this.uniforms)if(i&&i>4)o==="f16"?t.push(`@align(16) ${r}:array<mat2x4<${o}>, ${Math.ceil(i/8)}>`):t.push(`${r}:array<vec4<${o}>, ${Math.ceil(i/4)}>`);else{let u=i==null||i===1?o:`vec${i}<${o}>`;t.push(`${r}:${u}`)}return`\n      struct Uniforms { ${t.join(", ")} };\n      @group(0) @binding(${this.variableIndex}) var<uniform> uniforms: Uniforms;`}get additionalImplementations(){return this.uniformDeclaration()+this.variables.map(t=>t.impl()).join(`\n`)+this.internalVariables.map(t=>t.impl()).join(`\n`)}get variablesInfo(){if(this.uniforms.length===0)return;let t=r=>[12,10,1,6][["u32","f16","f32","i32"].indexOf(r)];return this.uniforms.map(r=>[t(r.type),r.length??1])}},va=(e,t)=>new Io(e,t),_r=(e,t)=>{let r=e.length,o=[];for(let i=0;i<r;i++){let u=r-1-i,a=e[u]||1;(t[t.length-1-i]||1)>1&&a===1&&o.unshift(u)}return o}});var Il,$a,Tl,El,yt,_a,Sa,Sr=Y(()=>{"use strict";ye();Se();Ze();_e();Il=e=>{if(!e||e.length!==1)throw new Error("Transpose requires 1 input.")},$a=(e,t)=>t&&t.length!==e?[...new Array(e).keys()].reverse():t,Tl=(e,t)=>M.sortBasedOnPerm(e,$a(e.length,t)),El=(e,t,r,o)=>{let i=[];i.push(`fn perm(i: ${o.type.indices}) -> ${r.type.indices} {\n    var a: ${r.type.indices};`);for(let u=0;u<t;++u)i.push(r.indicesSet("a",e[u],`i[${u}]`));return i.push("return a;}"),i.join(`\n`)},yt=(e,t)=>{let r=e.dataType,o=e.dims.length,i=$a(o,t),u=Tl(e.dims,i),a=j("output",r,u.length),c=U("a",r,o),p=h=>`\n  ${h.registerUniform("output_size","u32").declareVariables(c,a)}\n\n  ${El(i,o,c,a)}\n\n  ${h.mainStart()}\n    ${h.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.output_size")}\n\n    let indices = ${a.offsetToIndices("global_idx")};\n    let aIndices = perm(indices);\n\n    ${a.setByOffset("global_idx",c.getByIndices("aIndices"))}\n  }`;return{name:"Transpose",shaderCache:{hint:`${t}`,inputDependencies:["rank"]},getRunData:h=>{let d=M.size(u);return{outputs:[{dims:u,dataType:h[0].dataType}],dispatchGroup:{x:Math.ceil(d/64)},programUniforms:[{type:12,data:d},...Z(h[0].dims,u)]}},getShaderSource:p}},_a=(e,t)=>{Il(e.inputs),e.compute(yt(e.inputs[0],t.perm))},Sa=e=>ve({perm:e.perm})});var Pl,kl,Ol,Rl,Bl,Dl,zl,Ml,Ul,Vl,Tt,xa,Ca,Aa,Ia,Ta,Ea,Pa,ka,Oa,Ra,Ba=Y(()=>{"use strict";ye();Se();_e();In();Sr();Pl={max:"select(bestValue, candidate, candidate > bestValue)",min:"select(bestValue, candidate, candidate < bestValue)",mean:"bestValue + candidate",sum:"bestValue + candidate",prod:"bestValue * candidate",sumSquare:"bestValue + candidate * candidate",logSumExp:"bestValue + exp(candidate)",l1:"bestValue + abs(candidate)",l2:"bestValue + candidate * candidate",logSum:"bestValue + candidate"},kl={max:"select(bestValue, candidate, candidate > bestValue)",min:"select(bestValue, candidate, candidate < bestValue)",mean:"bestValue + candidate",sum:"bestValue + candidate",prod:"bestValue * candidate",sumSquare:"bestValue + candidate",logSumExp:"bestValue + candidate",l1:"bestValue + candidate",l2:"bestValue + candidate",logSum:"bestValue + candidate"},Ol={max:"_A[offset]",min:"_A[offset]",mean:"0",sum:"0",prod:"1",sumSquare:"0",logSumExp:"0",l1:"0",l2:"0",logSum:"0"},Rl={max:"bestValue",min:"bestValue",sum:"bestValue",prod:"bestValue",sumSquare:"bestValue",logSumExp:"log(bestValue)",l1:"bestValue",l2:"sqrt(bestValue)",logSum:"log(bestValue)"},Bl=(e,t)=>{let r=[];for(let o=t-e;o<t;++o)r.push(o);return r},Dl=(e,t)=>{let r=[],o=e.length;for(let u=0;u<o;u++)t.indexOf(u)===-1&&r.push(e[u]);let i=t.map(u=>e[u]);return[r,i]},zl=(e,t)=>{let r=e.length+t.length,o=[],i=0;for(let u=0;u<r;u++)t.indexOf(u)===-1?o.push(e[i++]):o.push(1);return o},Ml=(e,t)=>{for(let r=0;r<e.length;++r)if(e[e.length-r-1]!==t-1-r)return!1;return!0},Ul=(e,t)=>{let r=[];if(!Ml(e,t)){for(let o=0;o<t;++o)e.indexOf(o)===-1&&r.push(o);e.forEach(o=>r.push(o))}return r},Vl=(e,t,r,o,i,u,a)=>{let c=r[0].dims,p=M.size(u),h=M.size(a),d=U("_A",r[0].dataType,c),y=j("output",i,u),w=32,_=`\n          var<workgroup> aBestValues : array<f32, ${w}>;\n       `;return{name:e,shaderCache:t,getShaderSource:S=>`\n        ${S.registerUniform("reduceSize","u32").declareVariables(d,y)}\n        ${_}\n        fn DIV_CEIL(a : u32, b : u32) -> u32 {\n          return ((a - 1u) / b + 1u);\n         }\n         ${S.mainStart(w)}\n\n          let outputIndex = global_idx / ${w};\n          let offset = outputIndex * uniforms.reduceSize;\n\n          var bestValue = f32(${Ol[o]});\n          let Length = uniforms.reduceSize;\n          for (var k = local_idx; k < Length; k = k + ${w}) {\n           let candidate = f32(${d.getByOffset("offset + k")});\n           bestValue = ${Pl[o]};\n          }\n          aBestValues[local_idx] = bestValue;\n          workgroupBarrier();\n\n         var reduceSize = min(Length, ${w}u);\n         for (var currentSize = reduceSize / 2u; reduceSize > 1u;\n             currentSize = reduceSize / 2u) {\n           let interval = DIV_CEIL(reduceSize, 2u);\n           if (local_idx < currentSize) {\n            let candidate = aBestValues[local_idx + interval];\n            bestValue = ${kl[o]};\n            aBestValues[local_idx] = bestValue;\n           }\n           reduceSize = interval;\n           workgroupBarrier();\n         }\n\n         if (local_idx == 0u) {\n          ${y.setByOffset("outputIndex",`${o==="mean"?`${y.type.storage}(bestValue / f32(uniforms.reduceSize))`:`${y.type.storage}(${Rl[o]})`}`)};\n         }\n        }`,getRunData:()=>({outputs:[{dims:u,dataType:i}],dispatchGroup:{x:p},programUniforms:[{type:12,data:h}]})}},Tt=(e,t,r,o)=>{let i=e.inputs.length===1?r:Po(e.inputs,r),u=i.axes;u.length===0&&!i.noopWithEmptyAxes&&(u=e.inputs[0].dims.map((_,v)=>v));let a=M.normalizeAxes(u,e.inputs[0].dims.length),c=a,p=e.inputs[0],h=Ul(c,e.inputs[0].dims.length);h.length>0&&(p=e.compute(yt(e.inputs[0],h),{inputs:[0],outputs:[-1]})[0],c=Bl(c.length,p.dims.length));let[d,y]=Dl(p.dims,c),w=d;i.keepDims&&(w=zl(d,a)),e.compute(Vl(t,{hint:i.cacheKey,inputDependencies:["type"]},[p],o,e.inputs[0].dataType,w,y),{inputs:[p]})},xa=(e,t)=>{Tt(e,"ReduceMeanShared",t,"mean")},Ca=(e,t)=>{Tt(e,"ReduceL1Shared",t,"l1")},Aa=(e,t)=>{Tt(e,"ReduceL2Shared",t,"l2")},Ia=(e,t)=>{Tt(e,"ReduceLogSumExpShared",t,"logSumExp")},Ta=(e,t)=>{Tt(e,"ReduceMaxShared",t,"max")},Ea=(e,t)=>{Tt(e,"ReduceMinShared",t,"min")},Pa=(e,t)=>{Tt(e,"ReduceProdShared",t,"prod")},ka=(e,t)=>{Tt(e,"ReduceSumShared",t,"sum")},Oa=(e,t)=>{Tt(e,"ReduceSumSquareShared",t,"sumSquare")},Ra=(e,t)=>{Tt(e,"ReduceLogSumShared",t,"logSum")}});var Et,Wl,Tn,Po,Pt,Nl,Gl,Hl,Ll,Fl,ql,jl,Kl,Yl,Zl,kt,Da,za,Ma,Ua,Va,Wa,Na,Ga,Ha,La,In=Y(()=>{"use strict";ye();Se();Ze();_e();Ba();Et=e=>{if(!e||e.length===0||e.length>2)throw new Error("Reduce op requires 1 or 2 inputs.");if(e.length===2&&e[1].dims.length!==1)throw new Error("Invalid axes input dims.")},Wl=e=>["","",`var value = ${e.getByIndices("input_indices")};`,""],Tn=(e,t,r,o,i,u,a=!1,c=!1)=>{let p=[],h=r[0].dims,d=h.length,y=M.normalizeAxes(i,d),w=!c&&y.length===0;h.forEach((A,I)=>{w||y.indexOf(I)>=0?a&&p.push(1):p.push(A)});let _=p.length,v=M.size(p);return{name:e,shaderCache:t,getShaderSource:A=>{let I=[],x=U("_A",r[0].dataType,d),E=j("output",u,_),P=o(x,E,y),O=P[2];for(let R=0,L=0;R<d;R++)w||y.indexOf(R)>=0?(a&&L++,O=`for(var j${R}: u32 = 0; j${R} < ${h[R]}; j${R}++) {\n                  ${P[2].includes("last_index")?`let last_index = j${R};`:""}\n                  ${x.indicesSet("input_indices",R,`j${R}`)}\n                  ${O}\n                }`):(I.push(`${x.indicesSet("input_indices",R,E.indicesGet("output_indices",L))};`),L++);return`\n\n        ${A.registerUniform("output_size","u32").declareVariables(x,E)}\n\n        ${A.mainStart()}\n          ${A.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.output_size")}\n          var input_indices: ${x.type.indices};\n          let output_indices = ${E.offsetToIndices("global_idx")};\n\n          ${I.join(`\n`)}\n          ${P[0]}       // init ops for reduce max/min\n          ${P[1]}\n          ${O}\n          ${P[3]}\n          ${P.length===4?E.setByOffset("global_idx","value"):P.slice(4).join(`\n`)}\n        }`},getRunData:()=>({outputs:[{dims:p,dataType:u}],dispatchGroup:{x:Math.ceil(v/64)},programUniforms:[{type:12,data:v},...Z(h,p)]})}},Po=(e,t)=>{let r=[];return e[1].dims[0]>0&&e[1].getBigInt64Array().forEach(o=>r.push(Number(o))),ve({axes:r,keepDims:t.keepDims,noopWithEmptyAxes:t.noopWithEmptyAxes})},Pt=(e,t,r,o)=>{let i=e.inputs,u=i.length===1?r:Po(i,r);e.compute(Tn(t,{hint:u.cacheKey,inputDependencies:["rank"]},[i[0]],u.noopWithEmptyAxes&&u.axes.length===0?Wl:o,u.axes,i[0].dataType,u.keepDims,u.noopWithEmptyAxes),{inputs:[0]})},Nl=(e,t)=>{Et(e.inputs),Pt(e,"ReduceLogSum",t,(o,i)=>[`var value = ${i.type.storage}(0);`,"",`value += ${o.getByIndices("input_indices")};`,"value = log(value);"])},Gl=(e,t)=>{Et(e.inputs),Pt(e,"ReduceL1",t,(o,i)=>[`var value = ${i.type.storage}(0);`,"",`value += abs(${o.getByIndices("input_indices")});`,""])},Hl=(e,t)=>{Et(e.inputs),Pt(e,"ReduceL2",t,(o,i)=>[`var t = ${i.type.value}(0); var value = ${i.type.value}(0);`,"",`t = ${o.getByIndices("input_indices")}; value += (t * t);`,"value = sqrt(value);"])},Ll=(e,t)=>{Et(e.inputs),Pt(e,"ReduceLogSumExp",t,(o,i)=>[`var value = ${i.type.storage}(0);`,"",`value += exp(${o.getByIndices("input_indices")});`,"value = log(value);"])},Fl=(e,t)=>{Et(e.inputs),Pt(e,"ReduceMax",t,(o,i,u)=>{let a=[];for(let c=0;c<o.rank;c++)(u.indexOf(c)>=0||u.length===0)&&a.push(o.indicesSet("input_indices",c,0));return[`${a.join(`\n`)}`,`var value = ${o.getByIndices("input_indices")};`,`value = max(value, ${o.getByIndices("input_indices")});`,""]})},ql=(e,t)=>{Et(e.inputs),Pt(e,"ReduceMean",t,(o,i,u)=>{let a=1;for(let c=0;c<o.rank;c++)(u.indexOf(c)>=0||u.length===0)&&(a*=e.inputs[0].dims[c]);return["var sum = f32(0);","",`sum += f32(${o.getByIndices("input_indices")});`,`let value = ${i.type.value}(sum / ${a});`]})},jl=(e,t)=>{Et(e.inputs),Pt(e,"ReduceMin",t,(o,i,u)=>{let a=[];for(let c=0;c<o.rank;c++)(u.indexOf(c)>=0||u.length===0)&&a.push(`input_indices[${c}] = 0;`);return[`${a.join(`\n`)}`,`var value = ${o.getByIndices("input_indices")};`,`value = min(value, ${o.getByIndices("input_indices")});`,""]})},Kl=(e,t)=>{Et(e.inputs),Pt(e,"ReduceProd",t,(o,i)=>[`var value = ${i.type.storage}(1);`,"",`value *= ${o.getByIndices("input_indices")};`,""])},Yl=(e,t)=>{Et(e.inputs),Pt(e,"ReduceSum",t,(o,i)=>[`var value = ${i.type.storage}(0);`,"",`value += ${o.getByIndices("input_indices")};`,""])},Zl=(e,t)=>{Et(e.inputs),Pt(e,"ReduceSumSquare",t,(o,i)=>[`var t = ${i.type.value}(0); var value = ${i.type.value}(0);`,"",`t = ${o.getByIndices("input_indices")}; value += t * t;`,""])},kt=(e,t,r)=>{if(t.length===0)return r;let o=1,i=1;for(let u=0;u<t.length;u++)t.indexOf(u)===-1?o*=e[u]:i*=e[u];return i<32&&o>1024},Da=(e,t)=>{kt(e.inputs[0].dims,t.axes,t.noopWithEmptyAxes)?ql(e,t):xa(e,t)},za=(e,t)=>{kt(e.inputs[0].dims,t.axes,t.noopWithEmptyAxes)?Gl(e,t):Ca(e,t)},Ma=(e,t)=>{kt(e.inputs[0].dims,t.axes,t.noopWithEmptyAxes)?Hl(e,t):Aa(e,t)},Ua=(e,t)=>{kt(e.inputs[0].dims,t.axes,t.noopWithEmptyAxes)?Ll(e,t):Ia(e,t)},Va=(e,t)=>{kt(e.inputs[0].dims,t.axes,t.noopWithEmptyAxes)?Fl(e,t):Ta(e,t)},Wa=(e,t)=>{kt(e.inputs[0].dims,t.axes,t.noopWithEmptyAxes)?jl(e,t):Ea(e,t)},Na=(e,t)=>{kt(e.inputs[0].dims,t.axes,t.noopWithEmptyAxes)?Kl(e,t):Pa(e,t)},Ga=(e,t)=>{kt(e.inputs[0].dims,t.axes,t.noopWithEmptyAxes)?Yl(e,t):ka(e,t)},Ha=(e,t)=>{kt(e.inputs[0].dims,t.axes,t.noopWithEmptyAxes)?Zl(e,t):Oa(e,t)},La=(e,t)=>{kt(e.inputs[0].dims,t.axes,t.noopWithEmptyAxes)?Nl(e,t):Ra(e,t)}});var Fa,qa,ja,ko,Ka=Y(()=>{"use strict";ye();Ze();In();Fa=e=>{if(!e||e.length===0||e.length>2)throw new Error("ArgMinMaxOp op requires 1 or 2 inputs.");if(e[0].dataType!==1)throw new Error("Invalid input type.")},qa=(e,t)=>{Fa(e.inputs);let r=(o,i,u)=>{let a=[];for(let c=0;c<o.rank;c++)(u.indexOf(c)>=0||u.length===0)&&a.push(`input_indices[${c}] = 0;`);return[`${a.join(`\n`)}`,`var value = ${o.getByIndices("input_indices")};\nvar best_index : i32 = 0;`,`if (${o.getByIndices("input_indices")} ${t.selectLastIndex>0?"<=":"<"} value) {\n         value = ${o.getByIndices("input_indices")};\n         best_index = i32(last_index);\n       }`,"",i.setByOffset("global_idx","best_index")]};e.compute(Tn("ArgMin",{hint:t.cacheKey,inputDependencies:["rank"]},[e.inputs[0]],r,[t.axis],7,t.keepDims),{inputs:[0]})},ja=(e,t)=>{Fa(e.inputs);let r=(o,i,u)=>{let a=[];for(let c=0;c<o.rank;c++)(u.indexOf(c)>=0||u.length===0)&&a.push(`input_indices[${c}] = 0;`);return[`${a.join(`\n`)}`,`var value = ${o.getByIndices("input_indices")};\nvar best_index : i32 = 0;`,`if (${o.getByIndices("input_indices")} ${t.selectLastIndex>0?">=":">"} value) {\n         value = ${o.getByIndices("input_indices")};\n         best_index = i32(last_index);\n       }`,"",i.setByOffset("global_idx","best_index")]};e.compute(Tn("argMax",{hint:t.cacheKey,inputDependencies:["rank"]},[e.inputs[0]],r,[t.axis],7,t.keepDims),{inputs:[0]})},ko=e=>ve(e)});var Xl,Ql,Jl,En,Ya,Za,Oo=Y(()=>{"use strict";ye();Se();Ze();_e();Xl=(e,t)=>{if(!e||e.length<1)throw new Error("too few inputs");let r=0,o=e[r],i=o.dataType,u=o.dims.length;e.forEach((a,c)=>{if(c!==r){if(a.dataType!==i)throw new Error("input tensors should be one type");if(a.dims.length!==u)throw new Error("input tensors should have the same shape");a.dims.forEach((p,h)=>{if(h!==t&&p!==o.dims[h])throw new Error("non concat dimensions must match")})}})},Ql=(e,t)=>`\n  fn calculateInputIndex(index: u32) -> u32 {\n    let sizeInConcatAxis = array<u32, ${e}u>(${t});\n    for (var i: u32 = 0u; i < ${e}; i += 1u ) {\n      if (index < sizeInConcatAxis[i]) {\n        return i;\n      }\n    }\n    return ${e}u;\n  }`,Jl=(e,t)=>{let r=e.length,o=[];for(let i=0;i<r;++i){let u=t.setByOffset("global_idx",e[i].getByIndices("indices"));r===1?o.push(u):i===0?o.push(`if (inputIndex == ${i}u) { ${u} }`):i===r-1?o.push(`else { ${u} }`):o.push(`else if (inputIndex == ${i}) { ${u} }`)}return o.join(`\n`)},En=(e,t,r,o)=>{let i=M.size(r),u=new Array(e.length),a=new Array(e.length),c=0,p=[],h=[],d=[{type:12,data:i}];for(let S=0;S<e.length;++S)c+=e[S].dims[t],u[S]=c,h.push(e[S].dims.length),a[S]=U(`input${S}`,o,h[S]),p.push("rank"),d.push({type:12,data:u[S]});for(let S=0;S<e.length;++S)d.push(...Z(e[S].dims));d.push(...Z(r));let y=j("output",o,r.length),w=y.indicesGet("indices",t),_=Array.from(Array(u.length).keys()).map(S=>`uniforms.sizeInConcatAxis${S}`).join(","),v=S=>`\n\n  ${(()=>{S.registerUniform("outputSize","u32");for(let A=0;A<e.length;A++)S.registerUniform(`sizeInConcatAxis${A}`,"u32");return S.declareVariables(...a,y)})()}\n\n  ${Ql(u.length,_)}\n\n  ${S.mainStart()}\n    ${S.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.outputSize")}\n\n    var indices = ${y.offsetToIndices("global_idx")};\n\n    let inputIndex = calculateInputIndex(${w});\n    if (inputIndex != 0u) {\n      let sizeInConcatAxis = array<u32, ${u.length}u>(${_});\n      ${w} -= sizeInConcatAxis[inputIndex - 1u];\n    }\n\n    ${Jl(a,y)}\n  }`;return{name:"Concat",shaderCache:{hint:`${t}`,inputDependencies:p},getRunData:()=>({outputs:[{dims:r,dataType:o}],dispatchGroup:{x:Math.ceil(i/64)},programUniforms:d}),getShaderSource:v}},Ya=(e,t)=>{let r=e.inputs,o=r[0].dims,i=M.normalizeAxis(t.axis,o.length);Xl(r,i);let u=o.slice();u[i]=r.reduce((c,p)=>c+(p.dims.length>i?p.dims[i]:0),0);let a=r.filter(c=>M.size(c.dims)>0);e.compute(En(a,i,u,r[0].dataType),{inputs:a})},Za=e=>ve({axis:e.axis})});var ec,tc,rc,nc,Pn,oc,Xa,Ro=Y(()=>{"use strict";ye();_n();_e();Oo();ec=(e,t)=>{let r=e[0],o=e[1],i=e[2],u=e[3],a=e[4],c=e[5];if(a&&c)throw new Error("Attention cannot have both past and relative_position_bias");if(r.dims.length!==3)throw new Error(\'Input "input" must have 3 dimensions\');let p=r.dims[0],h=r.dims[1],d=r.dims[2];if(i.dims.length!==1)throw new Error(\'Input "bias" is expected to have 1 dimensions\');if(o.dims.length!==2)throw new Error(\'Input "weights" is expected to have 2 dimensions\');if(o.dims[0]!==d)throw new Error("Input 1 dimension 0 should have same length as dimension 2 of input 0");if(i.dims[0]!==o.dims[1])throw new Error(\'Input "bias" dimension 0 should have same length as dimension 1 of input "weights"\');let y=i.dims[0]/3,w=y,_=w;if(t.qkvHiddenSizes.length>0){if(t.qkvHiddenSizes.length!==3)throw new Error("qkv_hidden_sizes attribute should have 3 elements");for(let E of t.qkvHiddenSizes)if(E%t.numHeads!==0)throw new Error("qkv_hidden_sizes should be divisible by num_heads");y=t.qkvHiddenSizes[0],w=t.qkvHiddenSizes[1],_=t.qkvHiddenSizes[2]}let v=h;if(y!==w)throw new Error("qkv_hidden_sizes first element should be same as the second");if(i.dims[0]!==y+w+_)throw new Error(\'Input "bias" dimension 0 should have same length as sum of Q/K/V hidden sizes\');let S=0;if(a){if(w!==_)throw new Error(\'Input "past" expect k_hidden_size == v_hidden_size\');if(a.dims.length!==5)throw new Error(\'Input "past" must have 5 dimensions\');if(a.dims[0]!==2)throw new Error(\'Input "past" first dimension must be 2\');if(a.dims[1]!==p)throw new Error(\'Input "past" second dimension must be batch_size\');if(a.dims[2]!==t.numHeads)throw new Error(\'Input "past" third dimension must be num_heads\');if(a.dims[4]!==w/t.numHeads)throw new Error(\'Input "past" fifth dimension must be k_hidden_size / num_heads\');t.pastPresentShareBuffer||(S=a.dims[3])}let A=v+S,I=-1,x=0;if(u)throw new Error("Mask not supported");if(a)throw new Error("past is not supported");return{batchSize:p,sequenceLength:h,pastSequenceLength:S,kvSequenceLength:v,totalSequenceLength:A,maxSequenceLength:I,inputHiddenSize:d,hiddenSize:y,vHiddenSize:_,headSize:Math.floor(y/t.numHeads),vHeadSize:Math.floor(_/t.numHeads),numHeads:t.numHeads,isUnidirectional:!1,pastPresentShareBuffer:!1,maskFilterValue:t.maskFilterValue,maskType:x,scale:t.scale,broadcastResPosBias:!1,passPastInKv:!1,qkvFormat:1}},tc=(e,t,r,o)=>{let i=Me(o),u=64,a=o/i;a<u?u=1:a/8<64&&(u=Math.ceil(a/8));let c=Math.ceil(o/i/u),p=[{type:t.dataType,data:1/o},{type:12,data:a},{type:12,data:c}],h=De(t.dataType,i),d=et(1,i),y=w=>{let _=j("x",t.dataType,t.dims,i),S=[{name:"d_inv",type:et(t.dataType)},{name:"d_comp",type:"u32"},{name:"elements_per_thread",type:"u32"}];return`\n  var<workgroup> thread_max: array<f32, ${u}>;\n  var<workgroup> thread_sum: array<f32, ${u}>;\n  ${w.registerUniforms(S).declareVariables(_)}\n  ${w.mainStart([u,1,1])}\n    let local_offset = local_idx * uniforms.elements_per_thread;\n    let offset = workgroup_id.x * uniforms.d_comp + local_offset;\n\n    var thread_max_vector = ${d}(-3.402823e+38f);\n    for (var i: u32 = 0; i < uniforms.elements_per_thread && i + local_offset < uniforms.d_comp; i++) {\n      thread_max_vector = max(${d}(x[offset + i]), thread_max_vector);\n    }\n    thread_max[local_idx] = ${(()=>{switch(i){case 1:return"thread_max_vector";case 2:return"max(thread_max_vector.x, thread_max_vector.y)";case 4:return"max(max(thread_max_vector.x, thread_max_vector.y), max(thread_max_vector.z, thread_max_vector.w))";default:throw new Error(`Unsupported components: ${i}`)}})()};\n    workgroupBarrier();\n\n    var max_value =  f32(-3.402823e+38f);\n    for (var i = 0u; i < ${u}; i++) {\n      max_value = max(thread_max[i], max_value);\n    }\n\n    var sum_vector = ${d}(0);\n    for (var i: u32 = 0; i < uniforms.elements_per_thread && i + local_offset < uniforms.d_comp; i++) {\n      sum_vector += exp(${d}(x[offset + i]) - max_value);\n    }\n    thread_sum[local_idx] = ${(()=>{switch(i){case 1:return"sum_vector";case 2:return"sum_vector.x + sum_vector.y";case 4:return"sum_vector.x + sum_vector.y + sum_vector.z + sum_vector.w";default:throw new Error(`Unsupported components: ${i}`)}})()};\n    workgroupBarrier();\n\n    var sum: f32 = 0;\n    for (var i = 0u; i < ${u}; i++) {\n      sum += thread_sum[i];\n    }\n\n    if (sum == 0) {\n      for (var i: u32 = 0; i < uniforms.elements_per_thread && i + local_offset < uniforms.d_comp; i++) {\n        x[offset + i] = ${_.type.value}(uniforms.d_inv);\n      }\n    } else {\n      for (var i: u32 = 0; i < uniforms.elements_per_thread && i + local_offset < uniforms.d_comp; i++) {\n        var f32input = ${d}(x[offset + i]);\n        x[offset + i] = ${_.type.value}(exp(f32input - max_value) / sum);\n      }\n    }\n  }`};return{name:"AttentionProbsSoftmax",shaderCache:{hint:`${u};${h};${i}`},getShaderSource:y,getRunData:()=>({outputs:[],dispatchGroup:{x:r},programUniforms:p})}},rc=(e,t,r,o,i,u,a)=>{let c=a+i.kvSequenceLength,p=[i.batchSize,i.numHeads,i.sequenceLength,c],h=u.scale===0?1/Math.sqrt(i.headSize):u.scale,d=Me(i.headSize),y=i.headSize/d,w=12,_={x:Math.ceil(c/w),y:Math.ceil(i.sequenceLength/w),z:i.batchSize*i.numHeads},v=[{type:12,data:i.sequenceLength},{type:12,data:y},{type:12,data:c},{type:12,data:i.numHeads},{type:1,data:h}],S=o?["type","type","type"]:["type","type"],A=I=>{let x=U("q",t.dataType,t.dims,d),E=U("key",r.dataType,r.dims,d),P=[x,E];o&&P.push(U("relative_position_bias",o.dataType,o.dims));let O=j("output",t.dataType,p),R=et(1,d),L=[{name:"M",type:"u32"},{name:"K",type:"u32"},{name:"N",type:"u32"},{name:"num_heads",type:"u32"},{name:"alpha",type:"f32"}];return`\n  const TILE_SIZE = ${w}u;\n\n  var<workgroup> tileQ: array<${x.type.storage}, ${w*w}>;\n  var<workgroup> tileK: array<${x.type.storage}, ${w*w}>;\n  ${I.registerUniforms(L).declareVariables(...P,O)}\n  ${I.mainStart([w,w,1])}\n    // x holds the N and y holds the M\n    let headIdx = workgroup_id.z;\n    let m = workgroup_id.y * TILE_SIZE;\n    let n = workgroup_id.x * TILE_SIZE;\n    let qOffset = uniforms.M * uniforms.K * headIdx + m * uniforms.K;\n    let kOffset = uniforms.N * uniforms.K * headIdx + n * uniforms.K;\n\n    var value = ${R}(0);\n    for (var w: u32 = 0u; w < uniforms.K; w += TILE_SIZE) {\n      if (global_id.y < uniforms.M && w + local_id.x < uniforms.K) {\n        tileQ[TILE_SIZE * local_id.y + local_id.x] = q[qOffset + local_id.y * uniforms.K + w + local_id.x];\n      }\n      if (n + local_id.y < uniforms.N && w + local_id.x < uniforms.K) {\n        tileK[TILE_SIZE * local_id.y + local_id.x] = key[kOffset + local_id.y * uniforms.K + w + local_id.x];\n      }\n      workgroupBarrier();\n\n      for (var k: u32 = 0u; k < TILE_SIZE && w+k < uniforms.K; k++) {\n        value += ${R}(tileQ[TILE_SIZE * local_id.y + k] * tileK[TILE_SIZE * local_id.x + k]);\n      }\n\n      workgroupBarrier();\n    }\n\n    let headOffset = headIdx * uniforms.M * uniforms.N;\n    if (global_id.y < uniforms.M && global_id.x < uniforms.N) {\n      let outputIdx = headOffset + global_id.y * uniforms.N + global_id.x;\n      var sum: f32 = ${(()=>{switch(d){case 1:return"value";case 2:return"value.x + value.y";case 4:return"value.x + value.y + value.z + value.w";default:throw new Error(`Unsupported components: ${d}`)}})()};\n        output[outputIdx] = ${O.type.value} (sum * uniforms.alpha) + ${o?"relative_position_bias[outputIdx]":"0.0"};\n    }\n  }`};return{name:"AttentionProbs",shaderCache:{hint:`${d}`,inputDependencies:S},getRunData:()=>({outputs:[{dims:p,dataType:t.dataType,gpuDataType:0}],dispatchGroup:_,programUniforms:v}),getShaderSource:A}},nc=(e,t,r,o,i)=>{let u=i+o.kvSequenceLength,a=[o.batchSize,o.sequenceLength,o.vHiddenSize],c=12,p={x:Math.ceil(o.vHeadSize/c),y:Math.ceil(o.sequenceLength/c),z:o.batchSize*o.numHeads},h=[{type:12,data:o.sequenceLength},{type:12,data:u},{type:12,data:o.vHeadSize},{type:12,data:o.numHeads},{type:12,data:o.vHiddenSize}];return{name:"AttentionScore",shaderCache:{inputDependencies:["type","type"]},getRunData:()=>({outputs:[{dims:a,dataType:t.dataType,gpuDataType:0}],dispatchGroup:p,programUniforms:h}),getShaderSource:w=>{let _=U("probs",t.dataType,t.dims),v=U("v",r.dataType,r.dims),S=j("output",t.dataType,a),A=[{name:"M",type:"u32"},{name:"K",type:"u32"},{name:"N",type:"u32"},{name:"num_heads",type:"u32"},{name:"v_hidden_size",type:"u32"}];return`\n  const TILE_SIZE = ${c}u;\n  var<workgroup> tileQ: array<${_.type.value}, ${c*c}>;\n  var<workgroup> tileK: array<${_.type.value}, ${c*c}>;\n  ${w.registerUniforms(A).declareVariables(_,v,S)}\n  ${w.mainStart([c,c,1])}\n   let headIdx = workgroup_id.z;\n   let m = global_id.y;\n   let n = global_id.x;\n\n   let offsetA = headIdx * (uniforms.M * uniforms.K) + m * uniforms.K;\n   let offsetB = headIdx * (uniforms.N * uniforms.K) + n;\n\n   var value = ${_.type.storage}(0);\n   for (var w: u32 = 0u; w < uniforms.K; w += TILE_SIZE) {\n     if (m < uniforms.M && w + local_id.x < uniforms.K) {\n       tileQ[TILE_SIZE * local_id.y + local_id.x] = probs[offsetA + w + local_id.x];\n     }\n     if (n < uniforms.N && w + local_id.y < uniforms.K) {\n       tileK[TILE_SIZE * local_id.y + local_id.x] = v[offsetB + (w + local_id.y) * uniforms.N];\n     }\n     workgroupBarrier();\n     for (var k: u32 = 0u; k < TILE_SIZE && w+k < uniforms.K; k++) {\n       value += tileQ[TILE_SIZE * local_id.y + k] * tileK[TILE_SIZE * k + local_id.x];\n     }\n     workgroupBarrier();\n   }\n\n   // we need to transpose output from BNSH_v to BSND_v\n   let batchIdx = workgroup_id.z / uniforms.num_heads;\n   let currentBatchHeadNumber = workgroup_id.z % uniforms.num_heads;\n   if (m < uniforms.M && n < uniforms.N) {\n     let outputIdx = batchIdx * uniforms.M * uniforms.v_hidden_size + m * uniforms.v_hidden_size\n       + currentBatchHeadNumber * uniforms.N + n;\n     output[outputIdx] = value;\n   }\n  }`}}},Pn=(e,t,r,o,i,u,a,c,p,h,d)=>{let y=e.outputCount>1,w=e.outputCount>2,_=y&&w?h.pastSequenceLength:0,v=_+h.kvSequenceLength,S=[h.batchSize,h.numHeads,v,h.headSize],A=a?[a,r]:[r],I=y?e.compute(En(A,2,S,r.dataType),{inputs:A,outputs:[1]})[0]:r,x=[h.batchSize,h.numHeads,v,h.headSize],E=c?[c,o]:[o],P=w?e.compute(En(E,2,x,o.dataType),{inputs:E,outputs:[2]})[0]:o,O=[t,I];p&&O.push(p);let R=e.compute(rc(e,t,I,p,h,d,_),{inputs:O,outputs:[-1]})[0];e.compute(tc(e,R,h.batchSize*h.numHeads*h.sequenceLength,v),{inputs:[R],outputs:[]});let L=[R,P];e.compute(nc(e,R,P,h,_),{inputs:L,outputs:[0]})},oc=(e,t)=>{let r=[t.batchSize,t.numHeads,t.sequenceLength,t.headSize],o=t.sequenceLength,i=t.inputHiddenSize,u=t.headSize,a=12,c={x:Math.ceil(t.headSize/a),y:Math.ceil(t.sequenceLength/a),z:t.batchSize*t.numHeads},p=[e.inputs[0],e.inputs[1],e.inputs[2]],h=[{type:12,data:o},{type:12,data:i},{type:12,data:u},{type:12,data:t.numHeads},{type:12,data:t.headSize},{type:12,data:t.hiddenSize},{type:12,data:t.hiddenSize+t.hiddenSize+t.vHiddenSize}],d=y=>{let w=j("output_q",p[0].dataType,r),_=j("output_k",p[0].dataType,r),v=j("output_v",p[0].dataType,r),S=U("input",p[0].dataType,p[0].dims),A=U("weight",p[1].dataType,p[1].dims),I=U("bias",p[2].dataType,p[2].dims),x=S.type.storage,E=[{name:"M",type:"u32"},{name:"K",type:"u32"},{name:"N",type:"u32"},{name:"num_heads",type:"u32"},{name:"head_size",type:"u32"},{name:"hidden_size",type:"u32"},{name:"ldb",type:"u32"}];return`\n  const TILE_SIZE = ${a}u;\n  var<workgroup> tileInput: array<${x}, ${a*a}>;\n  var<workgroup> tileWeightQ: array<${x}, ${a*a}>;\n  var<workgroup> tileWeightK: array<${x}, ${a*a}>;\n  var<workgroup> tileWeightV: array<${x}, ${a*a}>;\n  ${y.registerUniforms(E).declareVariables(S,A,I,w,_,v)}\n  ${y.mainStart([a,a,1])}\n    let batchIndex = workgroup_id.z / uniforms.num_heads;\n    let headNumber = workgroup_id.z % uniforms.num_heads;\n    let m = global_id.y;\n    let n = global_id.x;\n\n    let inputOffset = batchIndex * (uniforms.M * uniforms.K) + m * uniforms.K;\n    let biasOffsetQ = headNumber * uniforms.head_size;\n    let biasOffsetK = uniforms.hidden_size + biasOffsetQ;\n    let biasOffsetV = uniforms.hidden_size + biasOffsetK;\n\n    var valueQ = ${x}(0);\n    var valueK = ${x}(0);\n    var valueV = ${x}(0);\n    for (var w: u32 = 0u; w < uniforms.K; w += TILE_SIZE) {\n      if (m < uniforms.M && w + local_id.x < uniforms.K) {\n        tileInput[TILE_SIZE * local_id.y + local_id.x] = input[inputOffset + w + local_id.x];\n      }\n      if (n < uniforms.N && w + local_id.y < uniforms.K) {\n        let offset = n + (w + local_id.y) * uniforms.ldb;\n        tileWeightQ[TILE_SIZE * local_id.y + local_id.x] = weight[biasOffsetQ + offset];\n        tileWeightK[TILE_SIZE * local_id.y + local_id.x] = weight[biasOffsetK + offset];\n        tileWeightV[TILE_SIZE * local_id.y + local_id.x] = weight[biasOffsetV + offset];\n      }\n      workgroupBarrier();\n      for (var k: u32 = 0u; k<TILE_SIZE && w+k < uniforms.K; k++) {\n        let inputTileOffset = TILE_SIZE * local_id.y + k;\n        let weightTileOffset = TILE_SIZE * k + local_id.x;\n        valueQ += tileInput[inputTileOffset] * tileWeightQ[weightTileOffset];\n        valueK += tileInput[inputTileOffset] * tileWeightK[weightTileOffset];\n        valueV += tileInput[inputTileOffset] * tileWeightV[weightTileOffset];\n      }\n\n      workgroupBarrier();\n    }\n\n    let headOffset = (m * uniforms.N + n) % uniforms.head_size;\n    valueQ += bias[headOffset + biasOffsetQ];\n    valueK += bias[headOffset + biasOffsetK];\n    valueV += bias[headOffset + biasOffsetV];\n\n    let offset = workgroup_id.z * uniforms.M * uniforms.N;\n    if (m < uniforms.M && n < uniforms.N) {\n      let outputIdx = offset + m * uniforms.N + n;\n      output_q[outputIdx] = valueQ;\n      output_k[outputIdx] = valueK;\n      output_v[outputIdx] = valueV;\n    }\n  }`};return e.compute({name:"AttentionPrepare",shaderCache:{inputDependencies:["type","type","type"]},getRunData:()=>({outputs:[{dims:r,dataType:e.inputs[0].dataType,gpuDataType:0},{dims:r,dataType:e.inputs[0].dataType,gpuDataType:0},{dims:r,dataType:e.inputs[0].dataType,gpuDataType:0}],dispatchGroup:c,programUniforms:h}),getShaderSource:d},{inputs:p,outputs:[-1,-1,-1]})},Xa=(e,t)=>{let r=ec(e.inputs,t),[o,i,u]=oc(e,r);return Pn(e,o,i,u,e.inputs[4],void 0,void 0,void 0,e.inputs[5],r,t)}});var ic,ac,sc,Qa,Ja=Y(()=>{"use strict";$r();ye();Se();Ze();_e();ic=(e,t)=>{if(!e||e.length!==5)throw new Error("BatchNormalization requires 5 inputs");let r=(o,i,u)=>{let a=i.length;if(a!==o.length)throw new Error(`${u}: num dimensions != ${a}`);i.forEach((c,p)=>{if(c!==o[p])throw new Error(`${u}: dim[${p}] do not match`)})};if(e[0].dims.length>1){let o=t.format==="NHWC"?t.spatial?e[0].dims.slice(-1):e[0].dims.slice(-1).concat(e[0].dims.slice(1,e[0].dims.length-1)):e[0].dims.slice(1,t.spatial?2:void 0);r(e[1].dims,o,"Invalid input scale"),r(e[2].dims,o,"Invalid input B"),r(e[3].dims,o,"Invalid input mean"),r(e[4].dims,o,"Invalid input var")}else r(e[1].dims,[1],"Invalid input scale"),r(e[2].dims,[1],"Invalid input B"),r(e[3].dims,[1],"Invalid input mean"),r(e[4].dims,[1],"Invalid input var")},ac=(e,t)=>{let{epsilon:r,spatial:o,format:i}=t,u=e[0].dims,a=o?Me(u[u.length-1]):1,c=i==="NHWC"&&u.length>1?a:1,p=M.size(u)/a,h=o,d=h?u.length:u,y=U("x",e[0].dataType,e[0].dims,a),w=U("scale",e[1].dataType,e[1].dims,c),_=U("bias",e[2].dataType,e[2].dims,c),v=U("inputMean",e[3].dataType,e[3].dims,c),S=U("inputVar",e[4].dataType,e[4].dims,c),A=j("y",e[0].dataType,d,a),I=()=>{let E="";if(o)E=`let cOffset = ${u.length===1?"0u":i==="NHWC"?`outputIndices[${u.length-1}] / ${a}`:"outputIndices[1]"};`;else if(i==="NCHW")E=`\n            ${A.indicesSet("outputIndices","0","0")}\n            let cOffset = ${A.indicesToOffset("outputIndices")};`;else{E=`var cIndices = ${w.type.indices}(0);\n                       cIndices[0] = outputIndices[${u.length-1}];`;for(let P=1;P<w.rank;P++)E+=`cIndices[${P}] = outputIndices[${P}];`;E+=`let cOffset = ${w.indicesToOffset("cIndices")};`}return E},x=E=>`\n  const epsilon = ${r};\n  ${E.registerUniform("outputSize","u32").declareVariables(y,w,_,v,S,A)}\n  ${E.mainStart()}\n  ${E.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.outputSize")}\n    var outputIndices = ${A.offsetToIndices(`global_idx * ${a}`)};\n    ${I()}\n    let scale = ${w.getByOffset("cOffset")};\n    let bias = ${_.getByOffset("cOffset")};\n    let inputMean = ${v.getByOffset("cOffset")};\n    let inputVar = ${S.getByOffset("cOffset")};\n    let x = ${y.getByOffset("global_idx")};\n    let value = (x - inputMean) * inverseSqrt(inputVar + epsilon) * scale + bias;\n    ${A.setByOffset("global_idx","value")}\n  }`;return{name:"BatchNormalization",shaderCache:{hint:`${t.epsilon}_${t.format}_${o}_${a}`,inputDependencies:h?["rank","type","type","type","type"]:void 0},getShaderSource:x,getRunData:()=>({outputs:[{dims:e[0].dims,dataType:e[0].dataType}],dispatchGroup:{x:Math.ceil(p/64)},programUniforms:h?[{type:12,data:p},...Z(u)]:[{type:12,data:p}]})}},sc=e=>ve(e),Qa=(e,t)=>{let{inputs:r,outputCount:o}=e,i=sc({...t,outputCount:o});if(vr.webgpu.validateInputContent&&ic(r,i),t.trainingMode)throw new Error("BatchNormalization trainingMode is not supported yet.");e.compute(ac(r,i))}});var uc,dc,es,ts=Y(()=>{"use strict";Se();_e();uc=e=>{if(e[0].dims.length!==3)throw new Error("input should have 3 dimensions");if(![320,640,1280].includes(e[0].dims[2]))throw new Error("number of channels should be 320, 640 or 1280");if(e[1].dims.length!==1)throw new Error("bias is expected to have 1 dimensions");if(e[0].dims[2]!==e[1].dims[0])throw new Error("last dimension of input and bias are not the same")},dc=e=>{let t=e[0].dims,r=e[0].dims[2],o=M.size(t)/4,i=e[0].dataType,u=U("input",i,t,4),a=U("bias",i,[r],4),c=U("residual",i,t,4),p=j("output",i,t,4);return{name:"BiasAdd",getRunData:()=>({outputs:[{dims:t,dataType:e[0].dataType}],dispatchGroup:{x:Math.ceil(o/64)}}),getShaderSource:d=>`\n  const channels = ${r}u / 4;\n  ${d.declareVariables(u,a,c,p)}\n\n  ${d.mainStart()}\n    ${d.guardAgainstOutOfBoundsWorkgroupSizes(o)}\n    let value = ${u.getByOffset("global_idx")}\n      + ${a.getByOffset("global_idx % channels")} + ${c.getByOffset("global_idx")};\n    ${p.setByOffset("global_idx","value")}\n  }`}},es=e=>{uc(e.inputs),e.compute(dc(e.inputs))}});var lc,ke,rs,ns,os,is,as,ss,us,ds,ls,cc,cs,ps,ms,fs,kn,hs,On,gs,ys,bs,ws,vs,$s,_s,Ss,xs,Cs,As,Is,Ts,Es,Ps,ks,Os,Rs,Bo,Do,Bs,Ds,zs,Rn=Y(()=>{"use strict";ye();Se();Ze();_e();lc=(e,t,r,o,i,u)=>{let a=Math.ceil(t/4),c="";typeof i=="string"?c=`${i}(a)`:c=i("a");let p=U("inputData",r,[a],4),h=j("outputData",o,[a],4);return`\n      ${e.registerUniform("vec_size","u32").declareVariables(p,h)}\n\n  ${u??""}\n\n  ${e.mainStart()}\n    ${e.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.vec_size")}\n\n    let a = ${p.getByOffset("global_idx")};\n    ${h.setByOffset("global_idx",c)}\n  }`},ke=(e,t,r,o,i,u=e.dataType)=>({name:t,shaderCache:{hint:i,inputDependencies:["type"]},getShaderSource:a=>lc(a,M.size(e.dims),e.dataType,u,r,o),getRunData:a=>({outputs:[{dims:e.dims,dataType:u}],dispatchGroup:{x:Math.ceil(M.size(a[0].dims)/64/4)},programUniforms:[{type:12,data:Math.ceil(M.size(e.dims)/4)}]})}),rs=e=>{e.compute(ke(e.inputs[0],"Abs","abs"))},ns=e=>{e.compute(ke(e.inputs[0],"Acos","acos"))},os=e=>{e.compute(ke(e.inputs[0],"Acosh","acosh"))},is=e=>{e.compute(ke(e.inputs[0],"Asin","asin"))},as=e=>{e.compute(ke(e.inputs[0],"Asinh","asinh"))},ss=e=>{e.compute(ke(e.inputs[0],"Atan","atan"))},us=e=>{e.compute(ke(e.inputs[0],"Atanh","atanh"))},ds=e=>ve(e),ls=(e,t)=>{let r;switch(t.to){case 10:r="vec4<f16>";break;case 1:r="vec4<f32>";break;case 12:r="vec4<u32>";break;case 6:r="vec4<i32>";break;case 9:r="vec4<bool>";break;default:throw new RangeError(`not supported type (specified in attribute \'to\' from \'Cast\' operator): ${t.to}`)}e.compute(ke(e.inputs[0],"Cast",r,void 0,t.cacheKey,t.to))},cc=e=>{let t=e.length>=2&&e[1].data!==0?e[1].getFloat32Array()[0]:xn,r=e.length>=3&&e[2].data!==0?e[2].getFloat32Array()[0]:Cn;return ve({min:t,max:r})},cs=(e,t)=>{let r=e.inputs.length===1?t:cc(e.inputs),o=et(e.inputs[0].dataType);e.compute(ke(e.inputs[0],"Clip",i=>`clamp(${i}, clip_min_, clip_max_)`,`\n    const clip_min_: vec4<${o}> = vec4(${o}(${r.min}));\n    const clip_max_: vec4<${o}> = vec4(${o}(${r.max}));\n`,r.cacheKey),{inputs:[0]})},ps=e=>{e.compute(ke(e.inputs[0],"Ceil","ceil"))},ms=e=>{e.compute(ke(e.inputs[0],"Cos","cos"))},fs=e=>{e.compute(ke(e.inputs[0],"Cosh","cosh"))},kn=e=>ve(e),hs=(e,t)=>{let r=et(e.inputs[0].dataType);e.compute(ke(e.inputs[0],"Elu",o=>`elu_vf32(${o})`,`\n  const elu_alpha_ = ${r}(${t.alpha});\n\n  fn elu_f32(a: ${r}) -> ${r} {\n  return select((exp(a) - 1.0) * elu_alpha_, a, a >= 0.0);\n  }\n\n  fn elu_vf32(v: vec4<${r}>) -> vec4<${r}> {\n  return vec4(elu_f32(v.x), elu_f32(v.y), elu_f32(v.z), elu_f32(v.w));\n  }`,t.cacheKey))},On=(e="f32")=>`\nconst r0: ${e} = 0.3275911;\nconst r1: ${e} = 0.254829592;\nconst r2: ${e} = -0.284496736;\nconst r3: ${e} = 1.421413741;\nconst r4: ${e} = -1.453152027;\nconst r5: ${e} = 1.061405429;\n\nfn erf_vf32(v: vec4<${e}>) -> vec4<${e}> {\n  let absv = abs(v);\n  let x = 1.0 / (1.0 + r0 * absv);\n  return sign(v) * (1.0 - ((((r5 * x + r4) * x + r3) * x + r2) * x + r1) * x * exp(-absv * absv));\n}`,gs=e=>{let t=et(e.inputs[0].dataType);e.compute(ke(e.inputs[0],"Erf",r=>`erf_vf32(${r})`,On(t)))},ys=e=>{e.compute(ke(e.inputs[0],"Exp","exp"))},bs=e=>{e.compute(ke(e.inputs[0],"Floor","floor"))},ws=e=>{let t=et(e.inputs[0].dataType);e.compute(ke(e.inputs[0],"Gelu",r=>`0.5 * ${r} * (1.0 + erf_vf32(${r} * 0.7071067811865475))`,On(t)))},vs=(e,t)=>{let r=et(e.inputs[0].dataType);e.compute(ke(e.inputs[0],"LeakyRelu",o=>`select(leaky_relu_alpha_ * ${o}, ${o}, ${o} >= vec4<${r}>(0.0))`,`const leaky_relu_alpha_ = ${r}(${t.alpha});`,t.cacheKey))},$s=e=>{e.compute(ke(e.inputs[0],"Not",t=>`!${t}`))},_s=e=>{e.compute(ke(e.inputs[0],"Neg",t=>`-${t}`))},Ss=e=>{e.compute(ke(e.inputs[0],"Reciprocal",t=>`1.0/${t}`))},xs=e=>{let t=et(e.inputs[0].dataType);e.compute(ke(e.inputs[0],"Relu",r=>`select(vec4<${t}>(0.0), ${r}, ${r} > vec4<${t}>(0.0))`))},Cs=e=>{e.compute(ke(e.inputs[0],"Sigmoid",t=>`(1.0 / (1.0 + exp(-${t})))`))},As=e=>ve(e),Is=(e,t)=>{let r=et(e.inputs[0].dataType);e.compute(ke(e.inputs[0],"HardSigmoid",o=>`max(vec4<${r}>(0.0), min(vec4<${r}>(1.0), ${t.alpha} * ${o} + vec4<${r}>(${t.beta})))`,void 0,t.cacheKey))},Ts=e=>{e.compute(ke(e.inputs[0],"Sin","sin"))},Es=e=>{e.compute(ke(e.inputs[0],"Sinh","sinh"))},Ps=e=>{e.compute(ke(e.inputs[0],"Sqrt","sqrt"))},ks=e=>{e.compute(ke(e.inputs[0],"Tan","tan"))},Os=e=>`sign(${e}) * (1 - exp(-2 * abs(${e}))) / (1 + exp(-2 * abs(${e})))`,Rs=e=>{e.compute(ke(e.inputs[0],"Tanh",Os))},Bo=(e="f32")=>`\nconst fast_gelu_a: ${e} = 0.5;\nconst fast_gelu_b: ${e} = 0.7978845608028654;\nconst fast_gelu_c: ${e} = 0.035677408136300125;\n\nfn tanh_v(v: vec4<${e}>) -> vec4<${e}> {\n  return ${Os("v")};\n}\n`,Do=e=>`(fast_gelu_a + fast_gelu_a * tanh_v(${e} * (fast_gelu_c * ${e} * ${e} + fast_gelu_b))) * ${e}`,Bs=e=>{let t=et(e.inputs[0].dataType);e.compute(ke(e.inputs[0],"FastGelu",Do,Bo(t),void 0,e.inputs[0].dataType))},Ds=(e,t)=>{let r=et(e.inputs[0].dataType);return e.compute(ke(e.inputs[0],"ThresholdedRelu",o=>`select(vec4<${r}>(0.0), ${o}, ${o} > thresholded_relu_alpha_)`,`const thresholded_relu_alpha_ = vec4<${r}>(${t.alpha});`,t.cacheKey)),0},zs=e=>{e.compute(ke(e.inputs[0],"Log","log"))}});var pc,mc,Us,Vs=Y(()=>{"use strict";Se();_e();Rn();pc=e=>{if(e[0].dims.length!==3)throw new Error("input should have 3 dimensions");if(![2560,5120,10240].includes(e[0].dims[2]))throw new Error("hidden state should be 2560, 5120 or 10240");if(e[1].dims.length!==1)throw new Error("bias is expected to have 1 dimensions");if(e[0].dims[2]!==e[1].dims[0])throw new Error("last dimension of input and bias are not the same")},mc=e=>{let t=e[0].dims.slice();t[2]=t[2]/2;let r=U("input",e[0].dataType,e[0].dims,4),o=U("bias",e[0].dataType,[e[0].dims[2]],4),i=j("output",e[0].dataType,t,4),u=M.size(t)/4,a=De(e[0].dataType);return{name:"BiasSplitGelu",getRunData:()=>({outputs:[{dims:t,dataType:e[0].dataType}],dispatchGroup:{x:Math.ceil(u/64)}}),getShaderSource:p=>`\n  const M_SQRT2 = sqrt(2.0);\n  const halfChannels = ${e[0].dims[2]/4/2}u;\n\n  ${p.declareVariables(r,o,i)}\n\n  ${On(a)}\n\n  ${p.mainStart()}\n    ${p.guardAgainstOutOfBoundsWorkgroupSizes(u)}\n    let biasIdx = global_idx % halfChannels;\n    let batchIndex = global_idx / halfChannels;\n    let inputOffset = biasIdx + batchIndex * halfChannels * 2;\n    let valueLeft = input[inputOffset] + bias[biasIdx];\n    let valueRight = input[inputOffset + halfChannels] + bias[biasIdx + halfChannels];\n    let geluRight = valueRight * 0.5 * (erf_vf32(valueRight / M_SQRT2) + 1);\n\n    ${i.setByOffset("global_idx","valueLeft * geluRight")}\n  }`}},Us=e=>{pc(e.inputs),e.compute(mc(e.inputs))}});var fc,hc,Ot,Ws,Ns,Gs,Hs,Ls,Fs,qs,js,Ks,Ys,Zs=Y(()=>{"use strict";ye();Se();_e();fc=(e,t,r,o,i,u,a,c,p,h,d,y)=>{let w,_;typeof c=="string"?w=_=(x,E)=>`${c}((${x}),(${E}))`:typeof c=="function"?w=_=c:(w=c.scalar,_=c.vector);let v=j("outputData",d,o.length,4),S=U("aData",p,t.length,4),A=U("bData",h,r.length,4),I;if(i)if(u){let x=M.size(t)===1,E=M.size(r)===1,P=t.length>0&&t[t.length-1]%4===0,O=r.length>0&&r[r.length-1]%4===0;x||E?I=v.setByOffset("global_idx",_(x?`${S.type.value}(${S.getByOffset("0")}.x)`:S.getByOffset("global_idx"),E?`${A.type.value}(${A.getByOffset("0")}.x)`:A.getByOffset("global_idx"))):I=`\n            let outputIndices = ${v.offsetToIndices("global_idx * 4u")};\n            let offsetA = ${S.broadcastedIndicesToOffset("outputIndices",v)};\n            let offsetB = ${A.broadcastedIndicesToOffset("outputIndices",v)};\n            ${v.setByOffset("global_idx",_(a||P?S.getByOffset("offsetA / 4u"):`${S.type.value}(${S.getByOffset("offsetA / 4u")}[offsetA % 4u])`,a||O?A.getByOffset("offsetB / 4u"):`${A.type.value}(${A.getByOffset("offsetB / 4u")}[offsetB % 4u])`))}\n          `}else I=v.setByOffset("global_idx",_(S.getByOffset("global_idx"),A.getByOffset("global_idx")));else{if(!u)throw new Error("no necessary to use scalar implementation for element-wise binary op implementation.");let x=(E,P,O="")=>{let R=`aData[indexA${P}][componentA${P}]`,L=`bData[indexB${P}][componentB${P}]`;return`\n            let outputIndices${P} = ${v.offsetToIndices(`global_idx * 4u + ${P}u`)};\n            let offsetA${P} = ${S.broadcastedIndicesToOffset(`outputIndices${P}`,v)};\n            let offsetB${P} = ${A.broadcastedIndicesToOffset(`outputIndices${P}`,v)};\n            let indexA${P} = offsetA${P} / 4u;\n            let indexB${P} = offsetB${P} / 4u;\n            let componentA${P} = offsetA${P} % 4u;\n            let componentB${P} = offsetB${P} % 4u;\n            ${E}[${P}] = ${O}(${w(R,L)});\n          `};d===9?I=`\n            var data = vec4<u32>(0);\n            ${x("data",0,"u32")}\n            ${x("data",1,"u32")}\n            ${x("data",2,"u32")}\n            ${x("data",3,"u32")}\n            outputData[global_idx] = dot(vec4<u32>(0x1, 0x100, 0x10000, 0x1000000), vec4<u32>(data));`:I=`\n            ${x("outputData[global_idx]",0)}\n            ${x("outputData[global_idx]",1)}\n            ${x("outputData[global_idx]",2)}\n            ${x("outputData[global_idx]",3)}\n          `}return`\n        ${e.registerUniform("vec_size","u32").declareVariables(S,A,v)}\n\n        ${y??""}\n\n        ${e.mainStart()}\n        ${e.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.vec_size")}\n        ${I}\n      }`},hc=(e,t,r,o,i,u,a=r.dataType)=>{let c=!M.areEqual(r.dims,o.dims),p=r.dims,h=M.size(r.dims),d=!1,y=!1,w=[c];if(c){let _=It.calcShape(r.dims,o.dims,!1);if(!_)throw new Error("Can\'t perform binary op on the given tensors");p=_,h=M.size(p);let v=M.size(r.dims)===1,S=M.size(o.dims)===1,A=r.dims.length>0&&r.dims[r.dims.length-1]%4===0,I=o.dims.length>0&&o.dims[o.dims.length-1]%4===0;w.push(v),w.push(S),w.push(A),w.push(I);let x=1;for(let E=1;E<p.length;E++){let P=r.dims[r.dims.length-E]??1,O=o.dims[o.dims.length-E]??1;if(P===O)x*=P;else break}x%4===0?(y=!0,d=!0):(v||S||A||I)&&(d=!0)}else d=!0;return w.push(d),{name:e,shaderCache:{hint:t+w.map(_=>_.toString()).join("_"),inputDependencies:["rank","rank"]},getShaderSource:_=>fc(_,r.dims,o.dims,p,d,c,y,i,r.dataType,o.dataType,a,u),getRunData:()=>({outputs:[{dims:p,dataType:a}],dispatchGroup:{x:Math.ceil(h/64/4)},programUniforms:[{type:12,data:Math.ceil(M.size(p)/4)},...Z(r.dims,o.dims,p)]})}},Ot=(e,t,r,o,i,u)=>{e.compute(hc(t,i??"",e.inputs[0],e.inputs[1],r,o,u))},Ws=e=>{Ot(e,"Add",(t,r)=>`${t}+${r}`)},Ns=e=>{Ot(e,"Div",(t,r)=>`${t}/${r}`)},Gs=e=>{Ot(e,"Equal",{scalar:(t,r)=>`u32(${t}==${r})`,vector:(t,r)=>`vec4<u32>(${t}==${r})`},void 0,void 0,9)},Hs=e=>{Ot(e,"Mul",(t,r)=>`${t}*${r}`)},Ls=e=>{let t=U("input",e.inputs[0].dataType,e.inputs[0].dims).type.value;Ot(e,"Pow",{scalar:(o,i)=>`pow_custom(${o},${i})`,vector:(o,i)=>`pow_vector_custom(${o},${i})`},`\n    fn pow_custom(a : ${t}, b : ${t}) -> ${t} {\n      if (b == ${t}(0.0)) {\n        return ${t}(1.0);\n      } else if (a < ${t}(0.0) && f32(b) != floor(f32(b))) {\n        return ${t}(pow(f32(a), f32(b))); // NaN\n      }\n      return select(sign(a), ${t}(1.0), round(f32(abs(b) % ${t}(2.0))) != 1.0) * ${t}(${t==="i32"?"round":""}(pow(f32(abs(a)), f32(b))));\n    }\n    fn pow_vector_custom(a : vec4<${t}>, b : vec4<${t}>) -> vec4<${t}> {\n      // TODO: implement vectorized pow\n      return vec4<${t}>(pow_custom(a.x, b.x), pow_custom(a.y, b.y), pow_custom(a.z, b.z), pow_custom(a.w, b.w));\n    }\n      `)},Fs=e=>{Ot(e,"Sub",(t,r)=>`${t}-${r}`)},qs=e=>{Ot(e,"Greater",{scalar:(t,r)=>`u32(${t}>${r})`,vector:(t,r)=>`vec4<u32>(${t}>${r})`},void 0,void 0,9)},js=e=>{Ot(e,"Less",{scalar:(t,r)=>`u32(${t}<${r})`,vector:(t,r)=>`vec4<u32>(${t}<${r})`},void 0,void 0,9)},Ks=e=>{Ot(e,"GreaterOrEqual",{scalar:(t,r)=>`u32(${t}>=${r})`,vector:(t,r)=>`vec4<u32>(${t}>=${r})`},void 0,void 0,9)},Ys=e=>{Ot(e,"LessOrEqual",{scalar:(t,r)=>`u32(${t}<=${r})`,vector:(t,r)=>`vec4<u32>(${t}<=${r})`},void 0,void 0,9)}});var St,xt,Ct,Bn,Ft=Y(()=>{"use strict";ye();Se();St=(e,t,r="f32")=>{switch(e.activation){case"Relu":return`value = max(value, ${t}(0.0));`;case"Sigmoid":return`value = (${t}(1.0) / (${t}(1.0) + exp(-value)));`;case"Clip":return`value = clamp(value, ${t}(${r}(uniforms.clip_min)), ${t}(${r}(uniforms.clip_max)));`;case"HardSigmoid":return`value = max(${t}(0.0), min(${t}(1.0), ${r}(uniforms.alpha) * value + ${r}(uniforms.beta)));`;case"LeakyRelu":return`value = select(${r}(uniforms.alpha) * value, value, value >= ${t}(0.0));`;case"":return"";default:throw new Error(`Unsupported activation ${e.activation}`)}},xt=(e,t)=>{e.activation==="Clip"?t.push({type:1,data:e.clipMax},{type:1,data:e.clipMin}):e.activation==="HardSigmoid"?t.push({type:1,data:e.alpha},{type:1,data:e.beta}):e.activation==="LeakyRelu"&&t.push({type:1,data:e.alpha})},Ct=(e,t)=>{e.activation==="Clip"?t.push({name:"clip_max",type:"f32"},{name:"clip_min",type:"f32"}):e.activation==="HardSigmoid"?t.push({name:"alpha",type:"f32"},{name:"beta",type:"f32"}):e.activation==="LeakyRelu"&&t.push({name:"alpha",type:"f32"})},Bn=e=>{let t=e?.activation||"";if(t==="HardSigmoid"){let[r,o]=e?.activation_params||[.2,.5];return{activation:t,alpha:r,beta:o}}else if(t==="Clip"){let[r,o]=e?.activation_params||[xn,Cn];return{activation:t,clipMax:o,clipMin:r}}else if(t==="LeakyRelu"){let[r]=e?.activation_params||[.01];return{activation:t,alpha:r}}return{activation:t}}});var tt,Dn,zn=Y(()=>{"use strict";tt=(e,t)=>{switch(e){case 1:return t;case 2:return`vec2<${t}>`;case 3:return`vec3<${t}>`;case 4:return`vec4<${t}>`;default:throw new Error(`${e}-component is not supported.`)}},Dn=e=>`\n      ${e?"value = value + getBiasByOutputCoords(coords);":""}\n      `});var Mn,zo=Y(()=>{"use strict";Mn=e=>`\nfn getIndexFromCoords4D(coords : vec4<i32>, shape : vec4<i32>) -> i32 {\n  return dot(coords, vec4<i32>(\n      shape.y * shape.z * shape.w, shape.z * shape.w, shape.w, 1));\n}\nfn getOutputIndexFromCoords(coords : vec4<i32>) -> i32 {\n  return dot(coords, vec4<i32>(\n    i32(${e}.x), i32(${e}.y), i32(${e}.z), 1));\n}\n`});var yc,bc,Hr,Xs,wc,Lr,vc,Un,Fr=Y(()=>{"use strict";ye();Se();_e();Ft();zn();yc=(e,t)=>e?`\n        mm_Asub[inputRow][inputCol] = mm_readA(batch,\n          kStart + inputRow,\n          globalRowStart / innerElementSize + inputCol${t?", batchIndices":""});\n        `:`\n        mm_Asub[inputRow][inputCol] = mm_readA(batch,\n          globalRow + innerRow,\n          kStart / innerElementSize + inputCol${t?", batchIndices":""});\n        `,bc=(e,t)=>e?`\n        let ACached0 = mm_Asub[k * innerElementSize][localRow];\n        let ACached1 = mm_Asub[k * innerElementSize + 1][localRow];\n        let ACached2 = mm_Asub[k * innerElementSize + 2][localRow];\n        ${t===3?"":"let ACached3 = mm_Asub[k * innerElementSize + 3][localRow];"}\n        for (var i = 0; i < rowPerThread; i = i + 1) {\n          acc[i] = BCached0 * ACached0[i] + acc[i];\n          acc[i] = BCached1 * ACached1[i] + acc[i];\n          acc[i] = BCached2 * ACached2[i] + acc[i];\n          ${t===3?"":"acc[i] = BCached3 * ACached3[i] + acc[i];"}\n        }`:`\n        for (var i = 0; i < rowPerThread; i = i + 1) {\n          let ACached = mm_Asub[tileRow + i][k];\n          acc[i] = BCached0 * ACached.x + acc[i];\n          acc[i] = BCached1 * ACached.y + acc[i];\n          acc[i] = BCached2 * ACached.z + acc[i];\n          ${t===3?"":"acc[i] = BCached3 * ACached.w + acc[i];"}\n        }`,Hr=(e,t,r="f32",o,i=!1,u=32,a=!1,c=32)=>{let p=t[1]*e[1],h=t[0]*e[0],d=i?p:u,y=i?u:p,w=d/t[0],_=u/t[1];if(!((i&&w===4&&e[1]===4||!i&&(w===3||w===4))&&d%t[0]===0&&u%t[1]===0&&e[0]===4))throw new Error(`If transposeA ${i} is true, innerElementSize ${w} and workPerThread[1] ${e[1]} must be 4.\n      Otherwise, innerElementSize ${w} must be 3 or 4.\n  tileAWidth ${d} must be divisible by workgroupSize[0]${t[0]}. tileInner ${u} must be divisible by workgroupSize[1] ${t[1]}. colPerThread ${e[0]} must be 4.`);return`\nvar<workgroup> mm_Asub: array<array<vec${w}<${r}>, ${d/w}>, ${y}>;\nvar<workgroup> mm_Bsub: array<array<vec4<${r}>, ${h/e[0]}>, ${u}>;\n\nconst rowPerThread = ${e[1]};\nconst colPerThread = ${e[0]};\nconst innerElementSize = ${w};\nconst tileInner = ${u};\n\n@compute @workgroup_size(${t[0]}, ${t[1]}, ${t[2]})\nfn main(@builtin(local_invocation_id) localId : vec3<u32>,\n        @builtin(global_invocation_id) globalId : vec3<u32>,\n        @builtin(workgroup_id) workgroupId : vec3<u32>) {\n  let localRow = i32(localId.y);\n  let tileRow = localRow * rowPerThread;\n  let tileCol = i32(localId.x);\n\n  let globalRow =i32(globalId.y) * rowPerThread;\n  let globalCol = i32(globalId.x);\n  let batch = ${a?"0":"i32(globalId.z)"};\n  ${o?`let batchIndices = ${o.offsetToIndices("u32(batch)")};`:""}\n  let globalRowStart = i32(workgroupId.y) * ${p};\n\n  let num_tiles = ${a?`${Math.ceil(c/u)}`:"(uniforms.dim_inner - 1) / tileInner + 1"};\n  var kStart = ${a?`i32(globalId.z) * ${c}`:"0"};\n\n  var acc: array<vec4<${r}>, rowPerThread>;\n\n  // Loop over shared dimension.\n  let tileRowB = localRow * ${_};\n  for (var t = 0; t < num_tiles; t = t + 1) {\n      // Load one tile of A into local memory.\n      for (var innerRow = 0; innerRow < rowPerThread; innerRow = innerRow + 1) {\n          let inputRow = tileRow + innerRow;\n          let inputCol = tileCol;\n          ${yc(i,o)}\n      }\n\n      // Load one tile of B into local memory.\n      for (var innerRow = 0; innerRow < ${_}; innerRow = innerRow + 1) {\n          let inputRow = tileRowB + innerRow;\n          let inputCol = tileCol;\n          mm_Bsub[inputRow][inputCol] = mm_readB(batch, kStart + inputRow, globalCol${o?", batchIndices":""});\n      }\n      kStart = kStart + tileInner;\n      workgroupBarrier();\n\n      // Compute acc values for a single thread.\n      for (var k = 0; k < tileInner / innerElementSize; k = k + 1) {\n          let BCached0 = mm_Bsub[k * innerElementSize][tileCol];\n          let BCached1 = mm_Bsub[k * innerElementSize + 1][tileCol];\n          let BCached2 = mm_Bsub[k * innerElementSize + 2][tileCol];\n          ${w===3?"":"let BCached3 = mm_Bsub[k * innerElementSize + 3][tileCol];"}\n\n          ${bc(i,w)}\n      }\n\n      workgroupBarrier();\n  }\n\n  for (var innerRow = 0; innerRow < rowPerThread; innerRow = innerRow + 1) {\n      mm_write(batch, globalRow + innerRow, globalCol, acc[innerRow]);\n  }\n}`},Xs=(e,t)=>e?`\n            mm_Asub[inputRow][inputCol] = mm_readA(batch,\n              kStart + inputRow,\n              globalRowStart + inputCol${t?", batchIndices":""});\n            `:`\n            mm_Asub[inputRow][inputCol] = mm_readA(batch,\n              globalRowStart + inputRow,\n              kStart + inputCol${t?", batchIndices":""});\n            `,wc=e=>e?"let ACached = mm_Asub[k][tileRow + innerRow];":"let ACached = mm_Asub[tileRow + innerRow][k];",Lr=(e,t,r="f32",o,i=!1,u=32,a=!1,c=32,p=!1)=>{let h=e[1]*t[1],d=e[0]*t[0],y=i?h:u,w=i?u:h;if(!(w%t[1]===0&&y%t[0]===0&&u%t[1]===0))throw new Error(`tileAHight ${w} must be divisible by workgroupSize[1]${t[1]}, tileAWidth ${y} must be divisible by workgroupSize[0]${t[0]}, tileInner ${u} must be divisible by workgroupSize[1]${t[1]}`);let _=w/t[1],v=y/t[0],S=u/t[1],A=p?`\n    let localRow = i32(localId.y);\n    let localCol = i32(localId.x);\n    let globalRowStart = i32(workgroupId.y) * ${h};\n    let globalColStart = i32(workgroupId.x) * ${d};\n\n    // Loop over shared dimension.\n    for (var t = 0; t < num_tiles; t = t + 1) {\n      // Load one tile of A into local memory.\n      for (var inputRow = localRow; inputRow < ${w}; inputRow = inputRow + ${t[1]}) {\n        for (var inputCol = localCol; inputCol < ${y}; inputCol = inputCol + ${t[0]}) {\n          ${Xs(i,o)}\n        }\n      }\n      // Load one tile of B into local memory.\n      for (var inputRow = localRow; inputRow < ${u}; inputRow = inputRow + ${t[1]}) {\n            for (var inputCol = localCol; inputCol < ${d}; inputCol = inputCol + ${t[0]}) {\n          mm_Bsub[inputRow][inputCol] = mm_readB(batch,\n            kStart + inputRow,\n            globalColStart + inputCol${o?", batchIndices":""});\n        }\n      }\n      kStart = kStart + tileInner;\n      workgroupBarrier();\n\n      // Compute acc values for a single thread.\n      var BCached : array<${r}, colPerThread>;\n      for (var k = 0; k < tileInner; k = k + 1) {\n        for (var inner = 0; inner < colPerThread; inner = inner + 1) {\n          BCached[inner] = mm_Bsub[k][localCol + inner * ${t[0]}];\n        }\n        for (var innerRow = 0; innerRow < rowPerThread; innerRow = innerRow + 1) {\n          let ACached = ${i?`mm_Asub[k][localRow + innerRow * ${t[1]}];`:`mm_Asub[localRow + innerRow * ${t[1]}][k];`}\n          for (var innerCol = 0; innerCol < colPerThread; innerCol = innerCol + 1) {\n            acc[innerRow][innerCol] = acc[innerRow][innerCol] +\n                ACached * BCached[innerCol];\n          }\n        }\n      }\n      workgroupBarrier();\n    }\n    for (var innerRow = 0; innerRow < rowPerThread; innerRow = innerRow + 1) {\n      let gRow = globalRowStart + localRow + innerRow * ${t[1]};\n      for (var innerCol = 0; innerCol < colPerThread; innerCol = innerCol + 1) {\n        let gCol = globalColStart + localCol + innerCol * ${t[0]};\n        mm_write(batch, gRow, gCol, acc[innerRow][innerCol]);\n      }\n    }\n    `:`\nlet tileRow = i32(localId.y) * rowPerThread;\nlet tileCol = i32(localId.x) * colPerThread;\n\nlet globalRow = i32(globalId.y) * rowPerThread;\nlet globalCol = i32(globalId.x) * colPerThread;\nlet globalRowStart = i32(workgroupId.y) * ${h};\n\nlet tileRowA = i32(localId.y) * ${_};\nlet tileColA = i32(localId.x) * ${v};\nlet tileRowB = i32(localId.y) * ${S};\n// Loop over shared dimension.\nfor (var t = 0; t < num_tiles; t = t + 1) {\n  // Load one tile of A into local memory.\n  for (var innerRow = 0; innerRow < ${_}; innerRow = innerRow + 1) {\n    for (var innerCol = 0; innerCol < ${v}; innerCol = innerCol + 1) {\n      let inputRow = tileRowA + innerRow;\n      let inputCol = tileColA + innerCol;\n      ${Xs(i,o)}\n    }\n  }\n\n  // Load one tile of B into local memory.\n  for (var innerRow = 0; innerRow < ${S}; innerRow = innerRow + 1) {\n    for (var innerCol = 0; innerCol < colPerThread; innerCol = innerCol + 1) {\n      let inputRow = tileRowB + innerRow;\n      let inputCol = tileCol + innerCol;\n      mm_Bsub[inputRow][inputCol] = mm_readB(batch,\n        kStart + inputRow,\n        globalCol + innerCol${o?", batchIndices":""});\n    }\n  }\n  kStart = kStart + tileInner;\n  workgroupBarrier();\n\n  // Compute acc values for a single thread.\n  var BCached : array<${r}, colPerThread>;\n  for (var k = 0; k < tileInner; k = k + 1) {\n    for (var inner = 0; inner < colPerThread; inner = inner + 1) {\n      BCached[inner] = mm_Bsub[k][tileCol + inner];\n    }\n\n    for (var innerRow = 0; innerRow < rowPerThread; innerRow = innerRow + 1) {\n      ${wc(i)}\n      for (var innerCol = 0; innerCol < colPerThread; innerCol = innerCol + 1) {\n        acc[innerRow][innerCol] = acc[innerRow][innerCol] + ACached * BCached[innerCol];\n      }\n    }\n  }\n\n  workgroupBarrier();\n}\n\nfor (var innerRow = 0; innerRow < rowPerThread; innerRow = innerRow + 1) {\n  for (var innerCol = 0; innerCol < colPerThread; innerCol = innerCol + 1) {\n    mm_write(batch, globalRow + innerRow, globalCol + innerCol,\n        acc[innerRow][innerCol]);\n  }\n}\n`;return`\n  var<workgroup> mm_Asub : array<array<${r}, ${y}>, ${w}>;\n  var<workgroup> mm_Bsub : array<array<${r}, ${d}>, ${u}>;\n  const rowPerThread = ${e[1]};\n  const colPerThread = ${e[0]};\n  const tileInner = ${u};\n\n@compute @workgroup_size(${t[0]}, ${t[1]}, ${t[2]})\nfn main(@builtin(local_invocation_id) localId : vec3<u32>,\n        @builtin(global_invocation_id) globalId : vec3<u32>,\n        @builtin(workgroup_id) workgroupId : vec3<u32>) {\n    let batch = ${a?"0":"i32(globalId.z)"};\n    ${o?`let batchIndices = ${o.offsetToIndices("u32(batch)")};`:""}\n    let num_tiles = ${a?`${Math.ceil(c/u)}`:"(uniforms.dim_inner - 1) / tileInner + 1"};\n    var kStart = ${a?`i32(globalId.z) * ${c}`:"0"};\n\n    var acc : array<array<${r}, colPerThread>, rowPerThread>;\n\n    // Without this initialization strange values show up in acc.\n    for (var innerRow = 0; innerRow < rowPerThread; innerRow = innerRow + 1) {\n      for (var innerCol = 0; innerCol < colPerThread; innerCol = innerCol + 1) {\n        acc[innerRow][innerCol] = 0.0;\n      }\n    }\n    ${A}\n  }\n`},vc=(e,t,r,o,i,u=!1)=>{let[a,c,p]=i,[h,d,y,w]=o,_=_r(a,p),v=_r(c,p),S=De(o[0].type.tensor),A=()=>{let E=d.rank,P=h.rank,O=`var aIndices: ${d.type.indices};`;for(let R=E-2-1,L=P-1;R>=0;R--,L--)O+=`\naIndices[${R}] = ${P>1?`batchIndices[${L}]`:"batchIndices"};`;return _.forEach(R=>{O+=`\naIndices[${R}] = 0;`}),O+=`\naIndices[${E-2}] = u32(row);\n                   aIndices[${E-1}] = u32(colIn);`,O},I=()=>{let E=y.rank,P=h.rank,O=`var bIndices: ${y.type.indices};`;for(let R=E-2-1,L=P-1;R>=0;R--,L--)O+=`\nbIndices[${R}] = ${P>1?`batchIndices[${L}]`:"batchIndices"};`;return v.forEach(R=>{O+=`\nbIndices[${R}] = 0;`}),O+=`\nbIndices[${E-2}] = u32(row);\n                   bIndices[${E-1}] = u32(colIn);`,O};return`\n    fn mm_readA(batch: i32, row: i32, colIn: i32, batchIndices: ${h.type.indices}) -> ${tt(e,S)} {\n      var value = ${tt(e,S)}(0.0);\n      let col = colIn * ${e};\n      if(row < uniforms.dim_a_outer && col < uniforms.dim_inner)\n      {\n        ${A()}\n        value = ${d.getByIndices("aIndices")};\n      }\n      return value;\n    }\n\n    fn mm_readB(batch: i32, row: i32, colIn: i32, batchIndices: ${h.type.indices}) -> ${tt(e,S)} {\n      var value = ${tt(e,S)}(0.0);\n      let col = colIn * ${e};\n      if(row < uniforms.dim_inner && col < uniforms.dim_b_outer)\n      {\n        ${I()}\n        value = ${y.getByIndices("bIndices")};\n      }\n      return value;\n    }\n\n    fn mm_write(batch: i32, row: i32, colIn: i32, valueIn: ${tt(e,S)}) {\n      let col = colIn * ${e};\n      if (row < uniforms.dim_a_outer && col < uniforms.dim_b_outer) {\n        var value = valueIn;\n        let coords = vec3<i32>(batch, row, colIn);\n        ${t?`value = value + ${u?"bias[colIn]":`${tt(e,S)}(bias[row])`};`:""}\n        ${r}\n        ${w.setByIndices("vec3<u32>(coords)","value")}\n      }\n    }\n    `},Un=(e,t,r,o,i=!1)=>{let u=e[0].dims,a=e[1].dims,c=u.slice(0,-2),p=a.slice(0,-2),h=o?o.slice(0,-2):r.slice(0,-2),d=M.size(h),y=u[u.length-2],w=u[u.length-1],_=a[a.length-1],v=w%4===0&&_%4===0,S=y<=8?[4,1,1]:[4,4,1],A=[8,8,1],I=[Math.ceil(_/A[0]/S[0]),Math.ceil(y/A[1]/S[1]),Math.ceil(d/A[2]/S[2])],x=v?4:1,E=[...c,y,w/x],P=E.length,O=[...p,w,_/x],R=O.length,L=[d,y,_/x],N=[{type:6,data:y},{type:6,data:_},{type:6,data:w}];xt(t,N),N.push(...Z(h,E,O));let K=["rank","rank"],Q=e.length>2;Q&&(N.push(...Z(e[2].dims)),K.push("rank")),N.push(...Z(L));let he=W=>{let se=h.length,Ce=An("batchDims",e[0].dataType,se,1),We=De(e[0].dataType),ee=U("a",e[0].dataType,P,x),ae=U("b",e[1].dataType,R,x),Ae=j("result",e[0].dataType,L.length,x),me=[ee,ae];if(Q){let G=i?x:1;me.push(U("bias",e[2].dataType,e[2].dims.length,G))}let ie=[{name:"dim_a_outer",type:"i32"},{name:"dim_b_outer",type:"i32"},{name:"dim_inner",type:"i32"}];Ct(t,ie);let ue=De(Ae.type.tensor),le=St(t,Ae.type.value,ue),qe=vc(x,Q,le,[Ce,ee,ae,Ae],[c,p,h],i);return`\n  ${W.registerUniforms(ie).registerInternalVariables(Ce).declareVariables(...me,Ae)}\n  ${qe}\n  ${v?Hr(S,A,We,Ce):Lr(S,A,We,Ce)}\n                   `};return{name:"MatMul",shaderCache:{hint:`${S};${t.activation};${v};${i}`,inputDependencies:K},getRunData:()=>({outputs:[{dims:r,dataType:e[0].dataType}],dispatchGroup:{x:I[0],y:I[1],z:I[2]},programUniforms:N}),getShaderSource:he}}});var $c,Qs,Js=Y(()=>{"use strict";ye();Lt();_e();Ft();zn();zo();Fr();$c=(e,t,r,o,i=!1,u,a=4,c=4,p=4,h="f32")=>{let d=Q=>{switch(Q){case 1:return"resData = x[xIndex];";case 3:return`resData = vec3<${h}>(x[xIndex], x[xIndex + 1], x[xIndex + 2]);`;case 4:return"resData = x[xIndex / 4];";default:throw new Error(`innerElementSize ${Q} is not supported.`)}},y=Q=>{switch(Q){case 1:return"return w[row * i32(uniforms.w_shape[3]) + colIn];";case 4:return"return w[row * i32(uniforms.w_shape[3]) / 4 + colIn];";default:throw new Error(`innerElementSize ${Q} is not supported.`)}},w=e?`\n    let coord = vec4<i32>(batch, xRow, xCol, xCh);\n    `:`\n    let coord = vec4<i32>(batch, xCh, xRow, xCol);\n    `,_=e?`\n    let coords = vec4<i32>(\n      batch,\n      row / outWidth,\n      row % outWidth,\n      col);\n    `:`\n    let coords = vec4<i32>(\n      batch,\n      row,\n      col / outWidth,\n      col % outWidth);\n    `,v=e?"i32(uniforms.x_shape[1])":"i32(uniforms.x_shape[2])",S=e?"i32(uniforms.x_shape[2])":"i32(uniforms.x_shape[3])",A=e?"row":"col",I=e?"col":"row",x=`\n    let inChannels = i32(uniforms.w_shape[2]);\n    let outWidth = ${e?"i32(uniforms.result_shape[2])":"i32(uniforms.result_shape[3])"};\n    let outRow = ${A} / outWidth;\n    let outCol = ${A} % outWidth;\n\n    let WRow = ${I} / (i32(uniforms.w_shape[1]) * inChannels);\n    let WCol = ${I} / inChannels % i32(uniforms.w_shape[1]);\n    let xRow = outRow * uniforms.stride[0] + uniforms.dilation[0] * WRow - uniforms.pad[0];\n    let xCol = outCol * uniforms.stride[1] + uniforms.dilation[1] * WCol - uniforms.pad[1];\n    let xCh = ${I} % inChannels;\n    var resData = ${tt(a,h)}(0.0);\n    // The bounds checking is always needed since we use it to pad zero for\n    // the \'same\' padding type.\n    if (xRow >= 0 && xRow < ${v} && xCol >= 0 && xCol < ${S}) {\n      ${w}\n      let xIndex = getIndexFromCoords4D(coord, vec4<i32>(uniforms.x_shape));\n      ${d(a)}\n    }\n    return resData;`,E=e?t&&o?`\n    let col = colIn * ${a};\n    ${x}`:`\n    let col = colIn * ${a};\n    if (row < uniforms.dim_a_outer && col < uniforms.dim_inner) {\n      ${x}\n    }\n    return ${tt(a,h)}(0.0);`:o&&r?`\n    let col = colIn * ${a};\n    ${x}`:`\n    let col = colIn * ${a};\n    if (row < uniforms.dim_inner && col < uniforms.dim_b_outer) {\n      ${x}\n    }\n    return ${tt(a,h)}(0.0);`,P=`${y(c)}`,O=tt(p,h),R=e?tt(a,h):tt(c,h),L=e?tt(c,h):tt(a,h),N=St(u,O,h);return`\n    fn mm_readA(batch: i32, row : i32, colIn : i32) -> ${R} {\n      ${e?E:P}\n    }\n\n    fn mm_readB(batch: i32, row : i32, colIn : i32) -> ${L} {\n      ${e?P:E}\n    }\n\n    fn mm_write(batch: i32, row : i32, colIn : i32, valueIn : ${O}) {\n      let col = colIn * ${p};\n      if (row < uniforms.dim_a_outer && col < uniforms.dim_b_outer)\n      {\n      var value = valueIn;\n      let outWidth = ${e?"i32(uniforms.result_shape[2])":"i32(uniforms.result_shape[3])"};\n      ${_}\n      ${Dn(i)}\n      ${N}\n      setOutputAtCoords(coords[0], coords[1], coords[2], coords[3], value);\n      }\n    }`},Qs=(e,t,r,o,i,u,a,c)=>{let p=t.format==="NHWC",h=p?e[0].dims[3]:e[0].dims[1],d=r[0],y=p?r[2]:r[3],w=p?r[1]:r[2],_=p?r[3]:r[1],v=p&&(h%4===0||h%3===0)&&_%4===0,S=p?_:y*w,A=p?y*w:_,I=[8,8,1],x=o<=8?[4,1,1]:[4,4,1],E=[Math.ceil(S/I[0]/x[0]),Math.ceil(A/I[1]/x[1]),Math.ceil(d/I[2]/x[2])];Ve("verbose",()=>`[conv2d_mm_webgpu] dispatch = ${E}`);let P=v?p&&h%4!==0?3:4:1,O=I[1]*x[1],R=I[0]*x[0],L=Math.max(I[0]*P,I[1]),N=o%O===0,K=i%R===0,Q=u%L===0,he=v?[P,4,4]:[1,1,1],W=[{type:6,data:o},{type:6,data:i},{type:6,data:u},{type:6,data:[t.pads[0],t.pads[1]]},{type:6,data:t.strides},{type:6,data:t.dilations}];xt(t,W),W.push(...Z(e[0].dims,e[1].dims));let se=["rank","rank"];a&&(W.push(...Z(e[2].dims)),se.push("rank")),W.push(...Z(r));let Ce=We=>{let ee=[{name:"dim_a_outer",type:"i32"},{name:"dim_b_outer",type:"i32"},{name:"dim_inner",type:"i32"},{name:"pad",type:"i32",length:2},{name:"stride",type:"i32",length:2},{name:"dilation",type:"i32",length:2}];Ct(t,ee);let ae=v?4:1,Ae=De(e[0].dataType),me=`\n      fn setOutputAtIndex(flatIndex : i32, value : ${v?`vec4<${Ae}>`:Ae}) {\n        result[flatIndex] = ${v?`vec4<${Ae}>`:Ae}(value);\n      }\n      fn setOutputAtCoords(d0 : i32, d1 : i32, d2 : i32, d3 : i32, value : ${v?`vec4<${Ae}>`:Ae}) {\n        let flatIndex = getOutputIndexFromCoords(vec4<i32>(d0, d1, d2, d3));\n        setOutputAtIndex(flatIndex ${v?"/ 4":""}, value);\n      }`,ie=U("x",e[0].dataType,e[0].dims.length,P===3?1:P),ue=U("w",e[1].dataType,e[1].dims.length,ae),le=[ie,ue],qe=j("result",e[0].dataType,r.length,ae);if(a){let G=U("bias",e[2].dataType,e[2].dims.length,ae);le.push(G),me+=`\n        fn getBiasByOutputCoords(coords : vec4<i32>) -> ${v?`vec4<${Ae}>`:Ae} {\n          return bias[coords.${p?"w":"y"}${v?"/ 4":""}];\n        }`}return`\n        ${Mn("uniforms.result_strides")}\n        //struct Uniforms { xShape : vec4<i32>, wShape : vec4<i32>, outShape : vec4<i32>,\n        //  outShapeStrides: vec3<i32>, filterDims : vec2<i32>, pad : vec2<i32>, stride : vec2<i32>,\n        //  dilation : vec2<i32>, dimAOuter : i32, dimBOuter : i32, dimInner : i32 };\n        ${We.registerUniforms(ee).declareVariables(...le,qe)}\n        ${me}\n        ${$c(p,N,K,Q,a,t,he[0],he[1],he[2],Ae)}\n        ${v?Hr(x,I,Ae,void 0,!p,L):Lr(x,I,Ae,void 0,!p,L,!1,void 0,c)}`};return{name:"Conv2DMatMul",shaderCache:{hint:`${t.cacheKey};${P};${v};${N};${K};${Q};${O};${R};${L}`,inputDependencies:se},getRunData:()=>({outputs:[{dims:r,dataType:e[0].dataType}],dispatchGroup:{x:E[0],y:E[1],z:E[2]},programUniforms:W}),getShaderSource:Ce}}});var Mo,eu,tu=Y(()=>{"use strict";ye();Se();_e();Uo();Ft();Mo=(e,t,r)=>{let o=e.length>2,i=o?"value += b[output_channel];":"",u=e[0].dims,a=e[1].dims,c=a[0]/t.group,p=t.format==="NHWC",h=Vn(u,a,t.dilations,t.pads,t.strides,p),d=M.size(h),y=[{type:12,data:d},{type:12,data:t.dilations},{type:12,data:[t.strides[0],t.strides[1]]},{type:12,data:[t.pads[0],t.pads[1]]},{type:12,data:c}];xt(t,y),y.push(...Z(u,a));let w=["rank","rank"];o&&(y.push(...Z(e[2].dims)),w.push("rank")),y.push(...Z(h));let _=v=>{let S=j("output",e[0].dataType,h.length),A=De(S.type.tensor),I=St(t,S.type.value,A),x=U("x",e[0].dataType,u.length),E=U("w",e[1].dataType,a.length),P=[x,E];o&&P.push(U("b",e[2].dataType,e[2].dims.length));let O=[{name:"output_size",type:"u32"},{name:"dilations",type:"u32",length:t.dilations.length},{name:"strides",type:"u32",length:2},{name:"pads",type:"u32",length:2},{name:"output_channels_per_group",type:"u32"}];return Ct(t,O),`\n  ${v.registerUniforms(O).declareVariables(...P,S)}\n\n  ${v.mainStart()}\n    ${v.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.output_size")}\n\n    let outputIndices = ${S.offsetToIndices("global_idx")};\n    let batch: u32 = outputIndices[0];\n    let output_channel: u32 = outputIndices[${p?3:1}];\n    let xRCCorner: vec2<u32> = vec2<u32>(outputIndices[${p?1:2}], outputIndices[${p?2:3}]) * uniforms.strides - uniforms.pads;\n    let group_id: u32 = output_channel / uniforms.output_channels_per_group;\n\n    var value: ${S.type.value} = ${S.type.value}(0);\n    for (var wInChannel: u32 = 0u; wInChannel < uniforms.w_shape[1]; wInChannel++) {\n      let input_channel = group_id * uniforms.w_shape[1] + wInChannel;\n      for (var wHeight: u32 = 0u; wHeight < uniforms.w_shape[2]; wHeight++) {\n        let xHeight = xRCCorner.x + wHeight * uniforms.dilations[0];\n\n        if (xHeight < 0u || xHeight >= uniforms.x_shape[${p?1:2}]) {\n          continue;\n        }\n\n        for (var wWidth: u32 = 0u; wWidth < uniforms.w_shape[3]; wWidth++) {\n          let xWidth = xRCCorner.y + wWidth * uniforms.dilations[1];\n          if (xWidth < 0u || xWidth >= uniforms.x_shape[${p?2:3}]) {\n            continue;\n          }\n\n          let xVal = ${p?x.get("batch","xHeight","xWidth","input_channel"):x.get("batch","input_channel","xHeight","xWidth")};\n          let wVal = ${E.get("output_channel","wInChannel","wHeight","wWidth")};\n          value += xVal*wVal;\n        }\n      }\n    }\n    ${i}\n    ${I}\n    ${S.setByOffset("global_idx","value")}\n  }`};return{name:"GroupedConv",shaderCache:{hint:t.cacheKey,inputDependencies:w},getRunData:()=>({outputs:[{dims:r?r(h):h,dataType:e[0].dataType}],dispatchGroup:{x:Math.ceil(d/64)},programUniforms:y}),getShaderSource:_}},eu=(e,t,r)=>{let o=e.length>2,i=Me(r[3]),u=Me(r[2]),a=M.size(r)/i/u,c=[e[0].dims[0],e[0].dims[1],e[0].dims[2],e[0].dims[3]/i],p=[e[1].dims[0],e[1].dims[1],e[1].dims[2],e[1].dims[3]/i],h=[r[0],r[1],r[2],r[3]/i],d=[{type:12,data:a},{type:6,data:[t.strides[0],t.strides[1]]},{type:6,data:[t.pads[0],t.pads[1]]}];xt(t,d),d.push(...Z(c,p,h));let y=(u-1)*t.strides[1]+p[1],w=_=>{let v=j("output",e[0].dataType,h.length,i),S=De(v.type.tensor),A=St(t,v.type.value,S),I=U("x",e[0].dataType,c.length,i),x=U("w",e[1].dataType,p.length,i),E=[I,x];o&&E.push(U("b",e[2].dataType,e[2].dims,i));let P=o?"value += b[output_channel];":"",O=[{name:"output_size",type:"u32"},{name:"strides",type:"i32",length:2},{name:"pads",type:"i32",length:2}];return Ct(t,O),`\n  ${_.registerUniforms(O).declareVariables(...E,v)}\n  ${_.mainStart()}\n    ${_.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.output_size")}\n    let width0 = uniforms.output_shape[3];\n    let output_channel = global_idx % width0;\n    var index1 = global_idx / width0;\n    let width1 = uniforms.output_shape[2] / ${u}u;\n    let col = (index1 % width1) * ${u}u;\n    index1 = index1 / width1;\n    let row = index1 % uniforms.output_shape[1];\n    let batch = index1 / uniforms.output_shape[1];\n\n    let x_corner = vec2<i32>(i32(row), i32(col)) * uniforms.strides - uniforms.pads;\n\n    var x_vals: array<${I.type.value}, ${y}>;\n    var values: array<${v.type.value}, ${u}>;\n    let input_channel = output_channel;\n    // Use constant instead of uniform can give better performance for w\'s height/width.\n    for (var w_height: u32 = 0u; w_height < ${p[0]}; w_height++) {\n      let x_height = x_corner.x + i32(w_height);\n      if (x_height >= 0 && u32(x_height) < uniforms.x_shape[1]) {\n        for (var i = 0; i < ${y}; i++) {\n          let x_width = x_corner.y + i;\n          if (x_width >= 0 && u32(x_width) < uniforms.x_shape[2]) {\n            x_vals[i] = ${I.get("batch","u32(x_height)","u32(x_width)","input_channel")};\n          } else {\n            x_vals[i] = ${I.type.value}(0);\n          }\n        }\n        for (var w_width: u32 = 0u; w_width < ${p[1]}; w_width++) {\n          let w_val = ${x.get("w_height","w_width","0","output_channel")};\n          for (var i = 0u; i < ${u}u; i++) {\n            values[i] = fma(x_vals[i * u32(uniforms.strides[1]) + w_width], w_val, values[i]);\n          }\n        }\n      }\n    }\n\n    for (var i = 0u; i < ${u}u; i++) {\n      var value = values[i];\n      ${P}\n      ${A}\n      ${v.set("batch","row","col + i","output_channel","value")};\n    }\n  }`};return{name:"GroupedConv-Vectorize",shaderCache:{hint:`${t.cacheKey};${i};${u};${y};${p[0]};${p[1]}`,inputDependencies:o?["rank","rank","type"]:["rank","rank"]},getRunData:()=>({outputs:[{dims:r,dataType:e[0].dataType}],dispatchGroup:{x:Math.ceil(a/64)},programUniforms:d}),getShaderSource:w}}});var Vo,_c,ru,Wo=Y(()=>{"use strict";ye();Se();Fr();_e();Ft();Vo=(e,t,r,o,i=!1)=>{let u=e[0].dims,a=e[1].dims,c=u[u.length-2],p=a[a.length-1],h=u[u.length-1],d=Me(p),y=Me(h),w=Me(c),_=M.size(r)/d/w,v=e.length>2,S=o?o.slice(0,-2):r.slice(0,-2),I=[M.size(S),c,p],x=[{type:12,data:_},{type:12,data:c},{type:12,data:p},{type:12,data:h}];xt(t,x),x.push(...Z(S,u,a)),v&&x.push(...Z(e[2].dims)),x.push(...Z(I));let E=P=>{let O=An("batch_dims",e[0].dataType,S.length),R=U("a",e[0].dataType,u.length,y),L=U("b",e[1].dataType,a.length,d),N=j("output",e[0].dataType,I.length,d),K=De(N.type.tensor),Q=St(t,N.type.value,K),he=[R,L],W="";if(v){let ie=i?d:1;he.push(U("bias",e[2].dataType,e[2].dims.length,ie)),W=`${i?`value += bias[col / ${ie}];`:`value += ${N.type.value}(bias[row + i]);`}`}let se=u.slice(0,-2),Ce=a.slice(0,-2),We=_r(se,S),ee=_r(Ce,S),ae=[{name:"output_size",type:"u32"},{name:"M",type:"u32"},{name:"N",type:"u32"},{name:"K",type:"u32"}];Ct(t,ae);let Ae=(ie,ue)=>{let le=ie.rank,qe=ie.name;if(le===2)return`var ${qe}_indices = ${ie.type.indices}(0u, 0u);`;let G=O.rank,ne=`var ${qe}_indices: ${ie.type.indices};`;for(let xe=le-2-1,Ke=G-1;xe>=0;xe--,Ke--)ne+=`\n${qe}_indices[${xe}] = ${G>1?`batch_indices[${Ke}]`:"batch_indices"};`;return ue.forEach(xe=>{ne+=`\n${qe}_indices[${xe}] = 0;`}),ne+=`${qe}_indices[${le-2}] = 0u;\n                     ${qe}_indices[${le-1}] = 0u;`,ne},me=()=>{let ie=`var a_data: ${R.type.value};`;for(let ue=0;ue<y;ue++)ie+=`\n              let b_data${ue} = b[(b_offset + (k + ${ue}) * uniforms.N + col) / ${d}];`;for(let ue=0;ue<w;ue++){ie+=`a_data = a[(a_offset + (row + ${ue}) * uniforms.K + k) / ${y}];`;for(let le=0;le<y;le++)ie+=`\n            values[${ue}] = fma(${L.type.value}(a_data${y===1?"":`[${le}]`}), b_data${le}, values[${ue}]);\n`}return ie};return`\n  ${P.registerUniforms(ae).registerInternalVariables(O).declareVariables(...he,N)}\n  ${P.mainStart()}\n    ${P.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.output_size")}\n    let col = (global_idx % (uniforms.N / ${d})) * ${d};\n    var index1 = global_idx / (uniforms.N / ${d});\n    let stride1 = uniforms.M / ${w};\n    let row = (index1 % stride1) * ${w};\n    let batch = index1 / stride1;\n\n    ${r.length===2?"":`let batch_indices = ${O.offsetToIndices("batch")};`}\n    ${Ae(R,We)}\n    let a_offset = ${R.indicesToOffset("a_indices")};\n    ${Ae(L,ee)}\n    let b_offset = ${L.indicesToOffset("b_indices")};\n    var values: array<${N.type.value}, ${w}>;\n    for (var k: u32 = 0u; k < uniforms.K; k = k + ${y}) {\n      ${me()}\n    }\n    for (var i = 0u; i < ${w}u; i++) {\n      var value = values[i];\n      ${W}\n      ${Q}\n      let cur_indices = ${N.type.indices}(batch, row + i, col);\n      let offset = ${N.indicesToOffset("cur_indices")};\n      ${N.setByOffset(`offset / ${d}`,"value")};\n    }\n  }\n  `};return{name:"MatMulNaive",shaderCache:{hint:`${t.activation};${d};${y};${w};${i}`,inputDependencies:v?["rank","rank","rank"]:["rank","rank"]},getRunData:()=>({outputs:[{dims:r,dataType:e[0].dataType}],dispatchGroup:{x:Math.ceil(_/64)},programUniforms:x}),getShaderSource:E}},_c=e=>{if(!e||e.length!==2)throw new Error("MatMul requires 2 inputs.");if(e[0].dims[e[0].dims.length-1]!==e[1].dims[e[1].dims.length-2])throw new Error("shared dimension does not match.")},ru=e=>{_c(e.inputs);let t=It.calcShape(e.inputs[0].dims,e.inputs[1].dims,!0);if(!t)throw new Error("Can\'t use matmul on the given tensors");let r=t[t.length-1],o=e.inputs[0].dims[e.inputs[0].dims.length-1];r<8&&o<8?e.compute(Vo(e.inputs,{activation:""},t)):e.compute(Un(e.inputs,{activation:""},t))}});var Vn,No,Sc,nu,Go,xc,Cc,Ho,Uo=Y(()=>{"use strict";Se();Js();Fr();tu();Ft();Wo();Sr();Vn=(e,t,r,o,i,u)=>{let a=e[0],c=e.slice(u?1:2,u?3:4),p=c.length,h=t[0],y=t.slice(2).map((v,S)=>v+(v-1)*(r[S]-1)),_=c.map((v,S)=>v+o[S]+o[S+p]).map((v,S)=>Math.floor((v-y[S]+i[S])/i[S]));return _.splice(0,0,a),_.splice(u?3:1,0,h),_},No=[2,3,1,0],Sc=(e,t)=>{if(!e||e.length!==2&&e.length!==3)throw new Error("Conv requires 2 or 3 inputs");if(e[0].dims.length!==4&&e[0].dims.length!==3)throw new Error("currently only support conv 1D and 2D");if(e[0].dims.length!==e[1].dims.length)throw new Error("filter does not have same dimension as input");let r=e[0].dims[t.format==="NHWC"?e[0].dims.length-1:1],o=e[1].dims[1]*t.group;if(r!==o)throw new Error("FILTER_IN_CHANNEL should be equal to DATA_CHANNEL");if(e.length===3&&(e[2].dims.length!==1||e[1].dims[0]!==e[2].dims[0]))throw new Error("invalid bias");let i=e[0].dims.length-2;if(t.dilations.length!==i)throw new Error(`dilations should be ${i}D`);if(t.strides.length!==i)throw new Error(`strides should be ${i}D`);if(t.pads.length!==i*2)throw new Error(`pads should be ${i*2}D`);if(t.kernelShape.length!==0&&t.kernelShape.length!==e[1].dims.length-2)throw new Error("invalid kernel shape")},nu=(e,t)=>{let r=e.kernelShape.slice();for(let u=2;u<t[1].dims.length;++u)r[u-2]===0&&(r[u-2]=t[1].dims[u]);let o=e.pads.slice();nr.adjustPadsBasedOnAutoPad(t[0].dims,e.strides,e.dilations,r,o,e.format==="NHWC",e.autoPad);let i=Object.assign({},e);return Object.assign(i,{kernelShape:r,pads:o}),i},Go=e=>{let t=Bn(e),r=e.format,o=["NOTSET","VALID","SAME_UPPER","SAME_LOWER"][e.auto_pad],i=e.dilations,u=e.group,a=e.kernel_shape,c=e.pads,p=e.strides,h=e.w_is_const();return{autoPad:o,format:r,dilations:i,group:u,kernelShape:a,pads:c,strides:p,wIsConst:h,...t,cacheKey:`${e.format};${t.activation};`}},xc=(e,t,r)=>{let o=nu(r,t),i=r.format==="NHWC";if(r.group!==1){if(!e.adapterInfo.isArchitecture("ampere")&&i&&t[1].dims[0]===r.group&&t[1].dims[1]===1&&r.dilations[0]===1&&r.dilations[1]===1){let L=Vn(t[0].dims,t[1].dims,r.dilations,o.pads,r.strides,i),N=e.kernelCustomData.wT??e.compute(yt(t[1],No),{inputs:[1],outputs:[r.wIsConst?-2:-1]})[0];r.wIsConst&&!e.kernelCustomData.wT&&(e.kernelCustomData.wT=N);let K=[t[0],N];t.length===3&&K.push(t[2]),e.compute(eu(K,o,L),{inputs:K})}else e.compute(Mo(t,o));return}let u=t.length===3,a=t[0].dims[i?1:2],c=t[0].dims[i?2:3],p=t[0].dims[i?3:1],h=t[1].dims[2],d=t[1].dims[3],y=Vn(t[0].dims,t[1].dims,r.dilations,o.pads,r.strides,i),w=y[i?1:2],_=y[i?2:3],v=y[i?3:1],S=i&&h===a&&d===c&&r.pads[0]===0&&r.pads[1]===0;if(S||h===1&&d===1&&r.dilations[0]===1&&r.dilations[1]===1&&r.strides[0]===1&&r.strides[1]===1&&r.pads[0]===0&&r.pads[1]===0){let R=y[0],L,N,K,Q=[];if(i){let se=e.kernelCustomData.wT??e.compute(yt(t[1],No),{inputs:[1],outputs:[r.wIsConst?-2:-1]})[0];if(r.wIsConst&&!e.kernelCustomData.wT&&(e.kernelCustomData.wT=se),S){let Ce=a*c*p;L=t[0].reshape([1,R,Ce]),N=se.reshape([1,Ce,v]),K=[1,R,v]}else L=t[0].reshape([R,a*c,p]),N=se.reshape([1,p,v]),K=[R,w*_,v];Q.push(L),Q.push(N)}else L=t[0].reshape([R,p,a*c]),N=t[1].reshape([1,v,p]),K=[R,v,w*_],Q.push(N),Q.push(L);u&&Q.push(t[2]);let he=K[2],W=Q[0].dims[Q[0].dims.length-1];he<8&&W<8?e.compute(Vo(Q,o,y,K,i),{inputs:Q}):e.compute(Un(Q,o,y,K,i),{inputs:Q});return}let A=!0,I=e.kernelCustomData.wT??e.compute(yt(t[1],No),{inputs:[1],outputs:[r.wIsConst?-2:-1]})[0];r.wIsConst&&!e.kernelCustomData.wT&&(e.kernelCustomData.wT=I);let x=[t[0],I];u&&x.push(t[2]);let E=i?w*_:v,P=i?v:w*_,O=h*d*p;e.compute(Qs(x,o,y,E,P,O,u,A),{inputs:x})},Cc=(e,t)=>{let r=t.format==="NHWC",o=[e.inputs[0].reshape(r?[e.inputs[0].dims[0],1,e.inputs[0].dims[1],e.inputs[0].dims[2]]:[e.inputs[0].dims[0],e.inputs[0].dims[1],1,e.inputs[0].dims[2]]),e.inputs[1].reshape([e.inputs[1].dims[0],e.inputs[1].dims[1],1,e.inputs[1].dims[2]])];e.inputs.length===3&&o.push(e.inputs[2]);let i=[0,t.pads[0],0,t.pads[1]],u=[1].concat(t.strides),a=[1].concat(t.dilations),c=[1].concat(t.kernelShape),p=nu({...t,pads:i,strides:u,dilations:a,kernelShape:c},o);e.compute(Mo(o,p,h=>r?[h[0],h[2],h[3]]:[]))},Ho=(e,t)=>{Sc(e.inputs,t),e.inputs[0].dims.length===3?Cc(e,t):xc(e,e.inputs,t)}});var Ac,ou,iu=Y(()=>{"use strict";ye();Lt();_e();Ft();zn();zo();Fr();Ac=(e,t=!1,r,o,i=4)=>{let u=I=>{switch(I){case 1:return"return w[getIndexFromCoords4D(coord, vec4<i32>(uniforms.w_shape))];";case 4:return`\n            let coord1 = vec4<i32>(coordX, coordY, col + 1, rowInner);\n            let coord2 = vec4<i32>(coordX, coordY, col + 2, rowInner);\n            let coord3 = vec4<i32>(coordX, coordY, col + 3, rowInner);\n            let v0 = w[getIndexFromCoords4D(coord, vec4<i32>(uniforms.w_shape))];\n            let v1 = w[getIndexFromCoords4D(coord1, vec4<i32>(uniforms.w_shape))];\n            let v2 = w[getIndexFromCoords4D(coord2, vec4<i32>(uniforms.w_shape))];\n            let v3 = w[getIndexFromCoords4D(coord3, vec4<i32>(uniforms.w_shape))];\n            return ${o}(v0, v1, v2, v3);\n            `;default:throw new Error(`innerElementSize ${I} is not supported.`)}},a=e?`\n      let coord = vec4<i32>(batch, iXR, iXC, xCh);\n      `:`\n      let coord = vec4<i32>(batch, xCh, iXR, iXC);\n      `,c=e?`\n    let coords = vec4<i32>(\n      batch,\n      row / outWidth,\n      row % outWidth,\n      col);\n    `:`\n    let coords = vec4<i32>(\n      batch,\n      row,\n      col / outWidth,\n      col % outWidth);\n    `,p=e?"i32(uniforms.x_shape[1])":"i32(uniforms.x_shape[2])",h=e?"i32(uniforms.x_shape[2])":"i32(uniforms.x_shape[3])",d=e?"row":"col",y=e?"col":"row",w=`\n      let inChannels = ${e?"i32(uniforms.x_shape[3])":"i32(uniforms.x_shape[1])"};\n      let outWidth = ${e?"i32(uniforms.result_shape[2])":"i32(uniforms.result_shape[3])"};\n      let outRow = ${d} / outWidth;\n      let outCol = ${d} % outWidth;\n\n      let WRow = ${y} / (uniforms.filter_dims[1] * inChannels);\n      let WCol = ${y} / inChannels % uniforms.filter_dims[1];\n      let xR = f32(outRow - uniforms.pads[0] + uniforms.dilations[0] * WRow) / f32(uniforms.strides[0]);\n      let xC = f32(outCol - uniforms.pads[1] + uniforms.dilations[1] * WCol) / f32(uniforms.strides[1]);\n      if (xR < 0.0 || xR >= f32(${p}) || fract(xR) > 0.0) {\n        return ${o}(0.0);\n      }\n      if (xC < 0.0 || xC >= f32(${h}) || fract(xC) > 0.0) {\n        return ${o}(0.0);\n      }\n      let iXR = i32(xR);\n      let iXC = i32(xC);\n      let xCh = ${y} % inChannels;\n      ${a}\n      return x[getIndexFromCoords4D(coord, vec4<i32>(uniforms.x_shape))/${i}];`,_=e?`\n      let col = colIn * ${i};\n      if (row < uniforms.dim_a_outer && col < uniforms.dim_inner) {\n        ${w}\n      }\n      return ${o}(0.0);`:`\n      let col = colIn * ${i};\n      if (row < uniforms.dim_inner && col < uniforms.dim_b_outer) {\n        ${w}\n      }\n      return ${o}(0.0);`,v=`\n      let col = colIn * ${i};\n      let inChannels = ${e?"i32(uniforms.x_shape[3])":"i32(uniforms.x_shape[1])"};\n      let coordX = uniforms.filter_dims[0] - 1 - row / (uniforms.filter_dims[1] * inChannels);\n      let coordY = uniforms.filter_dims[1] - 1 - (row / inChannels) % uniforms.filter_dims[1];\n      if (${e?"row < uniforms.dim_inner && col < uniforms.dim_b_outer":"row < uniforms.dim_inner && col < uniforms.dim_a_outer"}  && coordX >= 0 && coordY >= 0) {\n        let rowInner = row % inChannels;\n        let coord = vec4<i32>(coordX, coordY, col, rowInner);\n        ${u(i)}\n      }\n      return ${o}(0.0);\n      `,S=St(r,o);return`\n  fn mm_readA(batch: i32, row : i32, colIn : i32) -> ${o} {\n    ${e?_:v}\n  }\n\n  fn mm_readB(batch: i32, row : i32, colIn : i32) -> ${o} {\n    ${e?v:_}\n  }\n\n  fn mm_write(batch: i32, row : i32, colIn : i32, valueInput : ${o}) {\n    let col = colIn * ${i};\n    if (row < uniforms.dim_a_outer && col < uniforms.dim_b_outer) {\n      var value = valueInput;\n      let outWidth = ${e?"i32(uniforms.result_shape[2])":"i32(uniforms.result_shape[3])"};\n      ${c}\n      ${Dn(t)}\n      ${S}\n      result[getIndexFromCoords4D(coords, vec4<i32>(uniforms.result_shape))/${i}] = value;\n    }\n  }`},ou=(e,t,r,o,i,u,a,c)=>{let p=t.format==="NHWC",h=p?e[0].dims[3]:e[0].dims[1],d=r[0],y=p?r[2]:r[3],w=p?r[1]:r[2],_=p?r[3]:r[1],v=p&&h%4===0&&h%3&&_%4===0,S=p?_:y*w,A=p?y*w:_,I=[8,8,1],x=o<=8?[4,1,1]:[4,4,1],E=[Math.ceil(S/I[0]/x[0]),Math.ceil(A/I[1]/x[1]),Math.ceil(d/I[2]/x[2])];Ve("verbose",()=>`[conv_backprop_mm_webgpu] dispatch = ${E}`);let P=v?4:1,O=Math.max(I[0]*P,I[1]),R=v?4:1,L=[t.kernelShape[p?1:2],t.kernelShape[p?2:3]],N=[L[0]+(t.dilations[0]<=1?0:(L[0]-1)*(t.dilations[0]-1)),L[1]+(t.dilations[1]<=1?0:(L[1]-1)*(t.dilations[1]-1))],K=[N[0]-1-Math.floor((t.pads[0]+t.pads[2])/2),N[1]-1-Math.floor((t.pads[1]+t.pads[3])/2)],Q=[{type:6,data:o},{type:6,data:i},{type:6,data:u},{type:6,data:t.strides},{type:6,data:t.dilations},{type:6,data:L},{type:6,data:K}];xt(t,Q),Q.push(...Z(e[0].dims,e[1].dims));let he=["rank","rank"];a&&(Q.push(...Z(e[2].dims)),he.push("rank")),Q.push(...Z(r));let W=se=>{let Ce=U("x",e[0].dataType,e[0].dims.length,R),We=U("w",e[1].dataType,e[1].dims.length,1),ee=j("result",e[0].dataType,r.length,R),ae=[Ce,We],Ae="";if(a){let ue=U("bias",e[2].dataType,e[2].dims.length,R);ae.push(ue),Ae+=`\n          fn getBiasByOutputCoords(coords : vec4<i32>) -> ${ue.type.value} {\n            return bias[coords.${p?"w":"y"}${v?"/ 4":""}];\n          }`}let me=[{name:"dim_a_outer",type:"i32"},{name:"dim_b_outer",type:"i32"},{name:"dim_inner",type:"i32"},{name:"strides",type:"i32",length:2},{name:"dilations",type:"i32",length:2},{name:"filter_dims",type:"i32",length:L.length},{name:"pads",type:"i32",length:K.length}];Ct(t,me);let ie=De(e[0].dataType,1);if(ie!=="f16"&&ie!=="f32")throw new Error(`elemType ${ie} is not supported.`);return`\n        ${Mn("uniforms.result_strides")}\n        ${se.registerUniforms(me).declareVariables(...ae,ee)};\n        ${Ae}\n        ${Ac(p,a,t,Ce.type.value,P)}\n        ${v?Hr(x,I,ie,void 0,!p,O):Lr(x,I,ie,void 0,!p,O,!1,void 0,c)}`};return{name:"Conv2DTransposeMatMul",shaderCache:{hint:`${t.cacheKey};${x};${I};${v}`,inputDependencies:he},getRunData:()=>({outputs:[{dims:r,dataType:e[0].dataType}],dispatchGroup:{x:E[0],y:E[1],z:E[2]},programUniforms:Q}),getShaderSource:W}}});var Ic,Lo,au=Y(()=>{"use strict";ye();Lt();Se();_e();Ic=(e,t,r,o,i,u=!1,a,c,p=!1)=>{let h=p?1:2,d=p?2:3,y=p?3:1,w=u?2:1,_=`\n  fn setOutputAtIndex(flatIndex : u32, value : ${u?`vec4<${a}>`:a}) {\n    result[flatIndex] = ${u?`vec4<${a}>`:a}(value);\n  }`;o&&(_+=`\n    fn getBiasByOutputCoords(coords : vec4<u32>) -> ${u?`vec4<${a}>`:a} {\n      return bias[coords.${p?"w":"y"}${u?"/ 4":""}];\n    }`);let v=u?4:1,S=U("W",t[1].dataType,t[1].dims.length,v),A=U("Dy",t[0].dataType,t[0].dims.length,v),I=[A,S];o&&I.push(U("bias",t[2].dataType,[r[y]].length,v));let x=j("result",t[0].dataType,r.length,v),E=`{\n        let batch: u32 = ${i?"global_id.z":"workgroup_id.z"} / uniforms.result_shape[1];\n        let r = ${i?"global_id.z":"workgroup_id.z"} % uniforms.result_shape[1];\n        let c = ${i?"global_id.y":"workgroup_id.y"} * ${w};\n        let d1: u32 = ${i?"global_id.x":"workgroup_id.x"} * 4;\n\n        let dyCorner = vec2<i32>(i32(r), i32(c)) - vec2<i32>(uniforms.pads);\n\n        // Convolve dy(?, ?, d2) with w(:, :, d1, d2) to compute dx(xR, xC, d1).\n        // ? = to be determined. : = across all values in that axis.\n        var dotProd: array<vec4<${a}>, ${w}>;\n        for (var i = 0; i < ${w}; i++) {\n          dotProd[i] = vec4<${a}>(0.0);\n        }\n        for (var wR: u32 = 0; wR < uniforms.filter_dims[0]; wR = wR + 1) {\n          var dyR = (${a}(dyCorner.x) + ${a}(wR)) / ${a}(uniforms.strides.x);\n          let wRPerm = uniforms.filter_dims[0] - 1 - wR;\n          if (dyR < 0.0 || dyR >= ${a}(uniforms.Dy_shape[1]) ||\n              fract(dyR) > 0.0 || wRPerm < 0) {\n            continue;\n          }\n          let idyR: u32 = u32(dyR);\n\n          for (var wC: u32 = 0; wC < uniforms.filter_dims[1]; wC = wC + 1) {\n            let dyC = (${a}(dyCorner.y) + ${a}(wC)) / ${a}(uniforms.strides.y);\n            let dyC2 = (${a}(dyCorner.y) + 1.0 + ${a}(wC)) / ${a}(uniforms.strides.y);\n            let wCPerm = uniforms.filter_dims[1] - 1 - wC;\n            if (wCPerm < 0) {\n              continue;\n            }\n            var bDyCVal = true;\n            var bDyCVal2 = true;\n            if (dyC < 0.0 || dyC >= ${a}(uniforms.Dy_shape[2]) ||\n                fract(dyC) > 0.0) {\n              bDyCVal = false;\n            }\n            if (dyC2 < 0.0 || dyC2 >= ${a}(uniforms.Dy_shape[2]) ||\n                fract(dyC2) > 0.0) {\n              bDyCVal2 = false;\n            }\n\n            let idyC: u32 = u32(dyC);\n            let idyC2: u32 = u32(dyC2);\n            if (bDyCVal && bDyCVal2) {\n              let d2Length = uniforms.Dy_shape[3];\n              for (var d2 :u32 = 0; d2 < d2Length; d2 = d2 + 4) {\n                let wValue0 = ${S.get("u32(wRPerm)","u32(wCPerm)","d1","d2")};\n                let wValue1 = ${S.get("u32(wRPerm)","u32(wCPerm)","d1 + 1","d2")};\n                let wValue2 = ${S.get("u32(wRPerm)","u32(wCPerm)","d1 + 2","d2")};\n                let wValue3 = ${S.get("u32(wRPerm)","u32(wCPerm)","d1 + 3","d2")};\n\n                var xValue = ${A.get("batch","idyR","idyC","d2")};\n                let tmpval = vec4<${a}>(dot(xValue, wValue0),\n                                      dot(xValue, wValue1),\n                                      dot(xValue, wValue2),\n                                      dot(xValue, wValue3));\n                dotProd[0] = dotProd[0] + tmpval;\n\n                xValue =  ${A.get("batch","idyR","idyC2","d2")};\n\n                dotProd[1] = dotProd[1] + vec4<${a}>(dot(xValue, wValue0),\n                                                    dot(xValue, wValue1),\n                                                    dot(xValue, wValue2),\n                                                    dot(xValue, wValue3));\n              }\n            } else if (bDyCVal) {\n              let d2Length = uniforms.Dy_shape[${y}];\n              for (var d2: u32 = 0; d2 < d2Length; d2 = d2 + 4) {\n                let wValue0 = ${S.get("u32(wRPerm)","u32(wCPerm)","d1","d2")};\n                let wValue1 = ${S.get("u32(wRPerm)","u32(wCPerm)","d1 + 1","d2")};\n                let wValue2 = ${S.get("u32(wRPerm)","u32(wCPerm)","d1 + 2","d2")};\n                let wValue3 = ${S.get("u32(wRPerm)","u32(wCPerm)","d1 + 3","d2")};\n\n                var xValue = ${A.get("batch","idyR","idyC","d2")};\n                let tmpval = vec4<${a}>(dot(xValue, wValue0),\n                                      dot(xValue, wValue1),\n                                      dot(xValue, wValue2),\n                                      dot(xValue, wValue3));\n                dotProd[0] = dotProd[0] + tmpval;\n              }\n            } else if (bDyCVal2) {\n              let d2Length = uniforms.Dy_shape[3];\n              for (var d2: u32 = 0; d2 < d2Length; d2 = d2 + 4) {\n                let wValue0 = ${S.get("u32(wRPerm)","u32(wCPerm)","d1","d2")};\n                let wValue1 = ${S.get("u32(wRPerm)","u32(wCPerm)","d1 + 1","d2")};\n                let wValue2 = ${S.get("u32(wRPerm)","u32(wCPerm)","d1 + 2","d2")};\n                let wValue3 = ${S.get("u32(wRPerm)","u32(wCPerm)","d1 + 3","d2")};\n\n                var xValue = ${A.get("batch","idyR","idyC2","d2")};\n                let tmpval = vec4<${a}>(dot(xValue, wValue0),\n                                      dot(xValue, wValue1),\n                                      dot(xValue, wValue2),\n                                      dot(xValue, wValue3));\n                dotProd[1] = dotProd[1] + tmpval;\n              }\n            }\n          }\n        }\n\n        for (var i: u32 = 0; i < ${w}; i = i + 1) {\n          let value = dotProd[i] + ${o?"bias[c+i]":`vec4<${a}>(0.0)`};\n          ${x.set("batch","r","c + i","d1","value")};\n        }\n      }`,P=`\n          let outputIndices = ${x.offsetToIndices("global_idx")};\n          let batch = ${x.indicesGet("outputIndices",0)};\n          let d1 = ${x.indicesGet("outputIndices",y)};\n          let r = ${x.indicesGet("outputIndices",h)};\n          let c = ${x.indicesGet("outputIndices",d)};\n          let dyCorner = vec2<i32>(i32(r), i32(c)) - uniforms.pads;\n          let dyRCorner = dyCorner.x;\n          let dyCCorner = dyCorner.y;\n          let groupId = d1 / uniforms.output_channels_per_group;\n          let wOutChannel = d1 - groupId * uniforms.output_channels_per_group;\n          // Convolve dy(?, ?, d2) with w(:, :, d1, d2) to compute dx(xR, xC, d1).\n          // ? = to be determined. : = across all values in that axis.\n          var dotProd = ${a}(0.0);\n          for (var wR: u32 = 0; wR < uniforms.effective_filter_dims.x; wR = wR + 1) {\n            if (wR % uniforms.dilations.x != 0) {\n              continue;\n            }\n            let dyR = (${a}(dyRCorner) + ${a}(wR)) / ${a}(uniforms.strides[0]);\n            let wRPerm = uniforms.filter_dims.x - 1 - wR / uniforms.dilations.x;\n            if (dyR < 0.0 || dyR >= ${a}(uniforms.Dy_shape[${h}]) || fract(dyR) > 0.0 ||\n                wRPerm < 0) {\n              continue;\n            }\n            let idyR: u32 = u32(dyR);\n\n            for (var wC: u32 = 0; wC < uniforms.effective_filter_dims.y; wC = wC + 1) {\n              if (wC % uniforms.dilations.y != 0) {\n                continue;\n              }\n              let dyC = (${a}(dyCCorner) + ${a}(wC)) / ${a}(uniforms.strides.y);\n              let wCPerm = uniforms.filter_dims.y - 1 - wC / uniforms.dilations.y;\n              if (dyC < 0.0 || dyC >= ${a}(uniforms.Dy_shape[${d}]) ||\n                  fract(dyC) > 0.0 || wCPerm < 0) {\n                continue;\n              }\n              let idyC: u32 = u32(dyC);\n              var inputChannel = groupId * uniforms.input_channels_per_group;\n              for (var d2: u32 = 0; d2 < uniforms.input_channels_per_group; d2 = d2 + 1) {\n                let xValue = ${p?A.get("batch","idyR","idyC","inputChannel"):A.get("batch","inputChannel","idyR","idyC")};\n                let wValue = ${S.get("inputChannel","wOutChannel","u32(wRPerm)","u32(wCPerm)")};\n                dotProd = dotProd + xValue * wValue;\n                inputChannel = inputChannel + 1;\n              }\n            }\n          }\n          let value = dotProd + ${o?"bias[d1]":`${a}(0.0)`};\n          ${x.setByOffset("global_idx","value")};\n        `;return`\n  ${e.registerUniforms(c).declareVariables(...I,x)}\n  ${_}\n\n    ${e.mainStart()}\n    ${e.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.output_size")};\n  ${u?E:P}}`},Lo=(e,t,r)=>{let o=e.length>2,i=t.outputShape,u=M.size(i),a=[Math.ceil(u/64),1,1];Ve("verbose",()=>`[conv2d_backprop_webgpu] dispatch = ${a}`);let c=t.format==="NHWC",p=["rank","rank"],h=[t.strides[0],t.strides[1]],d=[t.kernelShape[c?1:2],t.kernelShape[c?2:3]],y=[t.dilations[0],t.dilations[1]],w=[d[0]+(t.dilations[0]<=1?0:(t.kernelShape[c?1:2]-1)*(t.dilations[0]-1)),d[1]+(t.dilations[1]<=1?0:(t.kernelShape[c?2:3]-1)*(t.dilations[1]-1))],_=[w[0]-1-Math.floor((t.pads[0]+t.pads[2])/2),w[1]-1-Math.floor(t.pads[1]+t.pads[3])/2],v=!1,S=t.group,A=e[1].dims,I=A[0]/S,x=A[1],E=[{type:12,data:u},{type:12,data:h},{type:12,data:d},{type:12,data:y},{type:12,data:w},{type:6,data:_},{type:12,data:I},{type:12,data:x},...Z(e[0].dims,e[1].dims)];o&&(E.push(...Z(e[2].dims)),p.push("rank")),E.push(...Z(i));let P=a[1]===1&&a[2]===1,O=R=>{let L=[{name:"output_size",type:"u32"},{name:"strides",type:"u32",length:h.length},{name:"filter_dims",type:"u32",length:d.length},{name:"dilations",type:"u32",length:d.length},{name:"effective_filter_dims",type:"u32",length:w.length},{name:"pads",type:"i32",length:_.length},{name:"input_channels_per_group",type:"u32"},{name:"output_channels_per_group",type:"u32"}],N=De(e[0].dataType);return`${Ic(R,e,i,o,P,v,N,L,c)}`};return{name:"ConvTranspose2D",shaderCache:{hint:`${t.cacheKey};`,inputDependencies:p},getRunData:()=>({dispatchGroup:{x:a[0],y:a[1],z:a[2]},outputs:[{dims:r?r(i):i,dataType:e[0].dataType}],programUniforms:E}),getShaderSource:O}}});var Tc,Ec,Pc,su,uu,kc,Oc,Rc,Bc,du,lu=Y(()=>{"use strict";iu();au();Ft();Sr();Tc=(e,t,r,o,i,u)=>(e-1)*t+r+(o-1)*i+1-u,Ec=(e,t,r,o,i)=>{let u=Math.floor(e/2);t==="SAME_UPPER"?(r[o]=u,r[i]=e-u):t==="SAME_LOWER"&&(r[o]=e-u,r[i]=u)},Pc=(e,t,r,o,i,u,a,c,p,h)=>{let d=e.length-2,y=h.length===0;if(p.length===0)for(let v=0;v<d;++v)p.push(0);let w=e[0],_=t[c?3:1]*i;for(let v=0,S=e.length-d-(c?1:0);v<d;++v,++S){let A=e[S],I=y?A*a[v]:h[v],x=Tc(A,a[v],u[v],t[S],r[v],I);Ec(x,o,u,v,v+d),y&&h.push(a[v]*(A-1)+p[v]+(t[S]-1)*r[v]+1-u[v]-u[v+d])}h.splice(0,0,w),h.splice(c?3:1,0,_)},su=(e,t)=>{let r=e.kernelShape.slice();if(e.kernelShape.length===0||e.kernelShape.reduce((y,w)=>y*w,1)===0){r.length=0;for(let y=2;y<t[1].dims.length;++y)r.push(t[1].dims[y])}let o=e.format==="NHWC";r.splice(0,0,t[1].dims[0]),r.splice(o?3:1,0,t[1].dims[1]);let i=e.pads.slice(),u=e.outputShape.slice(),a=e.outputPadding.slice(),c=t[0].dims,p=e.dilations.slice();if(p.reduce((y,w)=>y+w,0)===0){let y=t[0].dims.length-2;p=new Array(y).fill(1)}let h=e.strides.slice();if(h.reduce((y,w)=>y+w,0)===0){let y=t[0].dims.length-2;h=new Array(y).fill(1)}Pc(c,r,p,e.autoPad,e.group,i,h,o,a,u);let d=Object.assign({},e);return Object.assign(d,{kernelShape:r,pads:i,outputPadding:a,outputShape:u,dilations:p,strides:h}),d},uu=e=>{let t=Bn(e),r=e.format,o=["NOTSET","VALID","SAME_UPPER","SAME_LOWER"][typeof e.autoPad>"u"?0:e.autoPad],i=e.dilations,u=e.group,a=e.kernelShape,c=e.pads,p=e.strides,h=e.wIsConst(),d=e.outputPadding,y=e.outputShape;return{autoPad:o,format:r,dilations:i,group:u,kernelShape:a,outputPadding:d,outputShape:y,pads:c,strides:p,wIsConst:h,...t,cacheKey:`${e.format};${t.activation};`}},kc=(e,t)=>{if(!e||e.length!==2&&e.length!==3)throw new Error("Conv requires 2 or 3 inputs");if(e[0].dims.length!==4&&e[0].dims.length!==3)throw new Error("currently only support 2-dimensional conv");if(e[0].dims.length!==e[1].dims.length)throw new Error("filter does not have same dimension as input");let r=e[0].dims[t.format==="NHWC"?e[0].dims.length-1:1],o=e[1].dims[0];if(r!==o)throw new Error("FILTER_IN_CHANNEL should be equal to DATA_CHANNEL");let i=e[1].dims[1]*t.group;if(e.length===3&&(e[2].dims.length!==1||e[2].dims[0]!==i))throw new Error("invalid bias");let u=e[0].dims.length-2;if(t.dilations.reduce((d,y)=>d+y,0)>0&&t.dilations.length!==u)throw new Error(`dilations should be ${u}D`);if(t.strides.reduce((d,y)=>d+y,0)>0&&t.strides.length!==u)throw new Error(`strides should be ${u}D`);if(t.pads.reduce((d,y)=>d+y,0)>0&&t.pads.length!==u*2)throw new Error(`pads should be ${u*2}D`);if(t.outputPadding.length!==u&&t.outputPadding.length!==0)throw new Error(`output_padding should be ${u}D`);if(t.kernelShape.reduce((d,y)=>d+y,0)>0&&t.kernelShape.length!==0&&t.kernelShape.length!==e[1].dims.length-2)throw new Error("invalid kernel shape");if(t.outputShape.length!==0&&t.outputShape.length!==e[0].dims.length-2)throw new Error("invalid output shape")},Oc=[2,3,1,0],Rc=(e,t,r)=>{let o=su(r,t),i=r.format==="NHWC",u=o.outputShape,a=u[i?3:1],c=t[0].dims[i?3:1];if(o.group!==1||a===1&&c===1){e.compute(Lo(t,o));return}let p=u[i?1:2],h=u[i?2:3],d=t[1].dims[2],y=t[1].dims[3],w=i?p*h:a,_=i?a:p*h,v=d*y*c,S=!0,A=e.kernelCustomData.wT??e.compute(yt(t[1],Oc),{inputs:[1],outputs:[r.wIsConst?-2:-1]})[0];r.wIsConst&&!e.kernelCustomData.wT&&(e.kernelCustomData.wT=A);let I=[t[0],A],x=t.length===3;x&&(!i&&t[2].dims.length===1?I.push(t[2].reshape([t[2].dims[0],1,1])):I.push(t[2])),e.compute(ou(I,o,u,w,_,v,x,S),{inputs:I})},Bc=(e,t)=>{let r=t.format==="NHWC",o=[e.inputs[0].reshape(r?[e.inputs[0].dims[0],1,e.inputs[0].dims[1],e.inputs[0].dims[2]]:[e.inputs[0].dims[0],e.inputs[0].dims[1],1,e.inputs[0].dims[2]]),e.inputs[1].reshape([e.inputs[1].dims[0],e.inputs[1].dims[1],1,e.inputs[1].dims[2]])];e.inputs.length===3&&o.push(e.inputs[2]);let i=t.kernelShape;(i.length===0||i[0]===0)&&(i=[e.inputs[1].dims[2]]);let u=t.dilations;(u.length===0||u[0]===0)&&(u=[1]);let a=t.strides;(a.length===0||a[0]===0)&&(a=[1]);let c=t.pads;c.length===0&&(c=[0,0]),c=[0,c[0],0,c[1]],a=[1].concat(a),u=[1].concat(u),i=[1].concat(i);let p=su({...t,pads:c,strides:a,dilations:u,kernelShape:i},o);e.compute(Lo(o,p,h=>r?[h[0],h[2],h[3]]:[h[0],h[1],h[3]]))},du=(e,t)=>{kc(e.inputs,t),e.inputs[0].dims.length===3?Bc(e,t):Rc(e,e.inputs,t)}});var Dc,cu,pu,mu=Y(()=>{"use strict";ye();Se();Ze();_e();Dc=(e,t,r,o)=>{let i=M.size(t),u=t.length,a=U("input",e,u),c=j("output",e,u),p=r.dataType===6?r.getInt32Array()[0]:Number(r.getBigInt64Array()[0]),h=M.normalizeAxis(p,u),d=y=>{let w=` i32(${a.indicesGet("inputIndices","uniforms.axis")}) `,_=fe("uniforms.input_shape","uniforms.axis",u),v=o.reverse?w+(o.exclusive?" + 1":""):"0",S=o.reverse?_:w+(o.exclusive?"":" + 1");return`\n                ${y.registerUniform("outputSize","u32").registerUniform("axis","u32").declareVariables(a,c)}\n                ${y.mainStart()}\n                  ${y.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.outputSize")}\n                  var inputIndices = ${c.offsetToIndices("global_idx")};\n                  var sum = ${c.type.value}(0);\n                  let first : i32 = ${v};\n                  let last : i32 = ${S};\n                  for (var i : i32 = first; i < last; i++) {\n                    ${a.indicesSet("inputIndices","uniforms.axis","u32(i)")};\n                    sum = sum + ${a.getByIndices("inputIndices")};\n                  }\n                  ${c.setByOffset("global_idx","sum")};\n                }`};return{name:"CumSum",shaderCache:{hint:o.cacheKey,inputDependencies:["rank"]},getRunData:()=>({outputs:[{dims:t,dataType:e}],dispatchGroup:{x:Math.ceil(i/64)},programUniforms:[{type:12,data:i},{type:12,data:h},...Z(t,t)]}),getShaderSource:d}},cu=(e,t)=>{let r=e.inputs[0].dims,o=e.inputs[0].dataType,i=e.inputs[1];e.compute(Dc(o,r,i,t),{inputs:[0]})},pu=e=>{let t=e.exclusive===1,r=e.reverse===1;return ve({exclusive:t,reverse:r})}});var zc,Mc,Uc,fu,hu,gu=Y(()=>{"use strict";ye();Se();Ze();_e();zc=e=>{if(!e||e.length!==1)throw new Error("DepthToSpace requires 1 input.");if(e[0].dims.length!==4)throw new Error("DepthToSpace requires 4D input.")},Mc=(e,t,r,o)=>{let i=[];i.push(`fn perm(i: ${o.type.indices}) -> ${r.type.indices} {\n    var a: ${r.type.indices};`);for(let u=0;u<t;++u)i.push(r.indicesSet("a",e[u],`i[${u}]`));return i.push("return a;}"),i.join(`\n`)},Uc=(e,t)=>{let r,o,i,u,a,c,p=t.format==="NHWC",h=t.blocksize,d=t.mode==="DCR";p?([r,o,i,u]=e.dims,a=d?[r,o,i,h,h,u/h**2]:[r,o,i,u/h**2,h,h],c=d?[0,1,3,2,4,5]:[0,1,4,2,5,3]):([r,o,i,u]=[e.dims[0],e.dims[2],e.dims[3],e.dims[1]],a=d?[r,h,h,u/h**2,o,i]:[r,u/h**2,h,h,o,i],c=d?[0,3,4,1,5,2]:[0,1,4,2,5,3]);let y=e.reshape(a),w=y.dims.length,_=e.dataType,v=U("a",_,w),S=j("output",_,w),A=I=>`\n  ${I.registerUniform("output_size","u32").declareVariables(v,S)}\n\n  ${Mc(c,w,v,S)}\n\n  ${I.mainStart()}\n    ${I.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.output_size")}\n\n    let indices = ${S.offsetToIndices("global_idx")};\n    let aIndices = perm(indices);\n\n    ${S.setByOffset("global_idx",v.getByIndices("aIndices"))}\n  }`;return{name:"DepthToSpace",shaderCache:{hint:`${e.dims};${t.blocksize};${t.mode}`,inputDependencies:["rank"]},getRunData:I=>{let x=p?[r,o*h,i*h,u/h**2]:[r,u/h**2,o*h,i*h],E=M.size(x),P=y.dims,O=M.sortBasedOnPerm(P,c);return{outputs:[{dims:x,dataType:I[0].dataType}],dispatchGroup:{x:Math.ceil(E/64)},programUniforms:[{type:12,data:E},...Z(P,O)]}},getShaderSource:A}},fu=(e,t)=>{zc(e.inputs),e.compute(Uc(e.inputs[0],t))},hu=e=>ve({blocksize:e.blocksize,mode:e.mode,format:e.format})});var Fo,Wn,yu,Vc,Wc,qo,jo,bu,Nc,wu,vu,$u=Y(()=>{"use strict";ye();Se();Ze();_e();Fo="[a-zA-Z]|\\\\.\\\\.\\\\.",Wn="("+Fo+")+",yu="^"+Wn+"$",Vc="("+Wn+",)*"+Wn,Wc="^"+Vc+"$",qo=class{constructor(t=-1){this.symbolToIndices=new Map,this.inputIndex=t}addSymbol(t,r){let o=this.symbolToIndices.get(t);o===void 0?o=[r]:o.push(r),this.symbolToIndices.set(t,o)}},jo=class{constructor(t,r){this.equation=r;this.hasEllipsis=!1,this.symbolToInfo=new Map,this.lhs=new Array,this.outputDims=[];let[o,i]=r.includes("->")?r.split("->",2):[r,""];if(!o.match(RegExp(Wc)))throw new Error("Invalid LHS term");if(o.split(",").forEach((c,p)=>{let h=t[p].dims.slice();if(!c.match(RegExp(yu)))throw new Error("Invalid LHS term");let d=this.processTerm(c,!0,h,p);this.lhs.push(d)}),i==="")i+=[...this.symbolToInfo.entries()].filter(([c,p])=>p.count===1||c==="...").map(([c])=>c).join("");else if(!i.match(RegExp(Wn)))throw new Error("Invalid RHS");i.match(RegExp(Fo,"g"))?.forEach(c=>{if(c==="...")this.outputDims=this.outputDims.concat(this.ellipsisDims);else{let p=this.symbolToInfo.get(c);if(p===void 0)throw new Error("Invalid RHS symbol");this.outputDims.push(p.dimValue)}}),this.rhs=this.processTerm(i,!1,this.outputDims)}addSymbol(t,r,o){let i=this.symbolToInfo.get(t);if(i!==void 0){if(i.dimValue!==r&&i.count!==1)throw new Error("Dimension mismatch");i.count++,i.inputIndices.push(o)}else i={count:1,dimValue:r,inputIndices:[o]};this.symbolToInfo.set(t,i)}processTerm(t,r,o,i=-1){let u=o.length,a=!1,c=[],p=0;if(!t.match(RegExp(yu))&&!r&&t!=="")throw new Error("Invalid LHS term");let h=t.match(RegExp(Fo,"g")),d=new qo(i);return h?.forEach((y,w)=>{if(y==="..."){if(a)throw new Error("Only one ellipsis is allowed per input term");a=!0;let _=u-h.length+1;if(_<0)throw new Error("Ellipsis out of bounds");if(c=o.slice(p,p+_),this.hasEllipsis){if(this.ellipsisDims.length!==c.length||this.ellipsisDims.toString()!==c.toString())throw new Error("Ellipsis dimensions mismatch")}else if(r)this.hasEllipsis=!0,this.ellipsisDims=c;else throw new Error("Ellipsis must be specified in the LHS");for(let v=0;v<c.length;v++){let S=String.fromCharCode("0".charCodeAt(0)+v);d.addSymbol(S,w+v),this.addSymbol(S,o[p++],i)}}else d.addSymbol(y,w+(this.hasEllipsis?this.ellipsisDims.length-1:0)),this.addSymbol(y,o[p++],i)}),d}},bu=e=>e+"_max",Nc=(e,t,r,o)=>{let u=e.map(d=>d.length).map((d,y)=>U(`input${y}`,t,d)),a=M.size(o),c=j("output",t,o.length),p=[...r.symbolToInfo.keys()].filter(d=>!r.rhs.symbolToIndices.has(d)),h=d=>{let y=[],w="var prod = 1.0;",_="var sum = 0.0;",v="sum += prod;",S=[],A=[],I=[],x=[],E=r.symbolToInfo.size===r.rhs.symbolToIndices.size;r.symbolToInfo.forEach((O,R)=>{if(r.rhs.symbolToIndices.has(R)){let L=r.rhs.symbolToIndices.get(R)?.[0];L!==void 0&&r.lhs.forEach((N,K)=>{if(O.inputIndices.includes(K)){let Q=N.symbolToIndices.get(R);if(Q===void 0)throw new Error("Invalid symbol error");Q.forEach(he=>{y.push(`${u[K].indicesSet(`input${K}Indices`,he,c.indicesGet("outputIndices",L))}`)})}})}else r.lhs.forEach((L,N)=>{if(O.inputIndices.includes(N)){let K=L.symbolToIndices.get(R);if(K===void 0)throw new Error("Invalid symbol error");K.forEach(Q=>{S.push(`${u[N].indicesSet(`input${N}Indices`,Q,`${R}`)}`)}),x.push(`prod *= ${u[N].getByIndices(`input${N}Indices`)};`)}}),A.push(`for(var ${R}: u32 = 0; ${R} < uniforms.${bu(R)}; ${R}++) {`),I.push("}")});let P=E?[...y,`let sum = ${u.map((O,R)=>O.getByIndices(`input${R}Indices`)).join(" * ")};`]:[...y,_,...A,...S,w,...x,v,...I];return`\n            ${d.registerUniforms(p.map(O=>({name:`${bu(O)}`,type:"u32"}))).registerUniform("outputSize","u32").declareVariables(...u,c)}\n\n            ${d.mainStart()}\n            ${d.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.outputSize")}\n            var outputIndices = ${c.offsetToIndices("global_idx")};\n            ${u.map((O,R)=>`var input${R}Indices: ${u[R].type.indices};`).join(`\n`)}\n            ${P.join(`\n`)};\n            ${c.setByOffset("global_idx","sum")};\n          }`};return{name:"Einsum",shaderCache:{hint:r.equation,inputDependencies:e.map(()=>"rank")},getRunData:()=>{let d=p.filter(w=>r.symbolToInfo.has(w)).map(w=>({type:12,data:r.symbolToInfo.get(w)?.dimValue||0}));d.push({type:12,data:a});let y=e.map((w,_)=>[...Z(w)]).reduce((w,_)=>w.concat(_),d);return y.push(...Z(o)),{outputs:[{dims:o,dataType:t}],dispatchGroup:{x:Math.ceil(a/64)},programUniforms:y}},getShaderSource:h}},wu=(e,t)=>{let r=new jo(e.inputs,t.equation),o=r.outputDims,i=e.inputs.map((u,a)=>u.dims);e.compute(Nc(i,e.inputs[0].dataType,r,o))},vu=e=>{let t=e.equation.replace(/\\s+/g,"");return ve({equation:t})}});var Gc,_u,Hc,Lc,Su,xu=Y(()=>{"use strict";ye();Se();_e();Gc=e=>{if(!e||e.length!==2)throw new Error("Expand requires 2 input.");let t=e[0].dims,r=Array.from(e[1].getBigInt64Array(),Number),o=r.length<t.length?0:r.length-t.length,i=t.length<r.length?0:t.length-r.length;for(;o<r.length&&i<t.length;++o,++i)if(r[o]!==t[i]&&r[o]!==1&&t[i]!==1)throw new Error("Expand requires shape to be broadcastable to input")},_u=(e,t)=>{let r=e.length-t.length,o=[];for(let i=0;i<r;++i)o.push(e[i]);for(let i=0;i<t.length;++i)o.push(t[i]===1?e[i+r]:t[i]);return o},Hc=(e,t)=>e.length>t.length?_u(e,t):_u(t,e),Lc=e=>{let t=e[0].dims,r=Array.from(e[1].getBigInt64Array(),Number),o=Hc(t,r),i=e[0].dataType,u=i===9?4:1,a=Math.ceil(M.size(o)/u),c=h=>{let d=U("input",i,t.length,u),y=j("output",i,o.length,u),w;if(i===9){let _=(v,S,A="")=>`\n          let outputIndices${S} = ${y.offsetToIndices(`outputOffset + ${S}u`)};\n          let offset${S} = ${d.broadcastedIndicesToOffset(`outputIndices${S}`,y)};\n          let index${S} = offset${S} / 4u;\n          let component${S} = offset${S} % 4u;\n          ${v}[${S}] = ${A}(${d.getByOffset(`index${S}`)}[component${S}]);\n        `;w=`\n        let outputOffset = global_idx * ${u};\n        var data = vec4<u32>(0);\n        ${_("data",0,"u32")}\n        ${_("data",1,"u32")}\n        ${_("data",2,"u32")}\n        ${_("data",3,"u32")}\n        ${y.setByOffset("global_idx","data")}\n      }`}else w=`\n        let outputIndices = ${y.offsetToIndices("global_idx")};\n        let inputOffset = ${d.broadcastedIndicesToOffset("outputIndices",y)};\n        ${y.setByOffset("global_idx",d.getByOffset("inputOffset"))}\n      }`;return`\n    ${h.registerUniform("vec_size","u32").declareVariables(d,y)}\n    ${h.mainStart()}\n    ${h.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.vec_size")}\n    ${w}`},p=[{type:12,data:a},...Z(t,o)];return{name:"Expand",shaderCache:{hint:`${o.length}`,inputDependencies:["rank"]},getShaderSource:c,getRunData:()=>({outputs:[{dims:o,dataType:e[0].dataType}],dispatchGroup:{x:Math.ceil(a/64)},programUniforms:p})}},Su=e=>{Gc(e.inputs),e.compute(Lc(e.inputs),{inputs:[0]})}});var Fc,Cu,Au=Y(()=>{"use strict";ye();Se();_e();Rn();Fc=e=>{let t=e[0].dataType,r=M.size(e[0].dims),o=M.size(e[1].dims),i=o%4===0,u=a=>{let c=U("x",t,[1],4),p=U("bias",t,[1],4),h=j("y",t,[1],4),d=[{name:"output_vec_size",type:"u32"},{name:"bias_size",type:"u32"}],y=_=>`\n      let bias${_}_offset: u32 = (global_idx * 4 + ${_}) % uniforms.bias_size;\n      let bias${_} = ${p.getByOffset(`bias${_}_offset / 4`)}[bias${_}_offset % 4];`,w=i?`\n      let bias = ${p.getByOffset("global_idx % (uniforms.bias_size / 4)")};`:`${y(0)}${y(1)}${y(2)}${y(3)}\n      let bias = ${c.type.value}(bias0, bias1, bias2, bias3);`;return`${a.registerUniforms(d).declareVariables(c,p,h)}\n\n    ${Bo(et(t))}\n\n    ${a.mainStart(or)}\n      ${a.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.output_vec_size")}\n\n      let x = ${c.getByOffset("global_idx")};\n      ${w}\n      let x_in = x + bias;\n      ${h.setByOffset("global_idx",Do("x_in"))}\n    }`};return{name:"FastGeluWithBias",shaderCache:{hint:`${i}`,inputDependencies:["type","type"]},getShaderSource:u,getRunData:a=>({outputs:[{dims:a[0].dims,dataType:a[0].dataType}],programUniforms:[{type:12,data:Math.ceil(r/4)},{type:12,data:o}],dispatchGroup:{x:Math.ceil(r/or/4)}})}},Cu=e=>{e.inputs.length<2||M.size(e.inputs[1].dims)===0?Bs(e):e.compute(Fc(e.inputs))}});var qc,jc,Iu,Tu,Eu=Y(()=>{"use strict";ye();Se();Ze();_e();qc=e=>{if(!e||e.length!==2)throw new Error("Gather requires 2 inputs.")},jc=(e,t)=>{let r=e[0].dims,o=e[1].dims,i=r.length,u=M.normalizeAxis(t.axis,i),a=r.slice(0);a.splice(u,1,...o);let c=r[u],p=e[0].dataType===9?4:1,h=Math.ceil(M.size(a)/p),d=[{type:12,data:h},{type:6,data:c},{type:12,data:u},...Z(e[0].dims,e[1].dims,a)],y=w=>{let _=U("data",e[0].dataType,e[0].dims.length,p),v=U("inputIndices",e[1].dataType,e[1].dims.length),S=j("output",e[0].dataType,a.length,p),A=x=>{let E=o.length,P=`var indicesIndices${x}  = ${v.type.indices}(0);`;for(let O=0;O<E;O++)P+=`${E>1?`indicesIndices${x}[${O}]`:`indicesIndices${x}`} = ${a.length>1?`outputIndices${x}[uniforms.axis + ${O}]`:`outputIndices${x}`};`;P+=`\n          var idx${x} = ${v.getByIndices(`indicesIndices${x}`)};\n          if (idx${x} < 0) {\n            idx${x} = idx${x} + uniforms.axisDimLimit;\n          }\n          var dataIndices${x} : ${_.type.indices};\n        `;for(let O=0,R=0;O<i;O++)O===u?(P+=`${i>1?`dataIndices${x}[${O}]`:`dataIndices${x}`} = u32(idx${x});`,R+=E):(P+=`${i>1?`dataIndices${x}[${O}]`:`dataIndices${x}`} = ${a.length>1?`outputIndices${x}[${R}]`:`outputIndices${x}`};`,R++);return P},I;if(e[0].dataType===9){let x=(E,P,O="")=>`\n          let outputIndices${P} = ${S.offsetToIndices(`outputOffset + ${P}u`)};\n          ${A(P)};\n          let offset${P} = ${_.indicesToOffset(`dataIndices${P}`)};\n          let index${P} = offset${P} / 4u;\n          let component${P} = offset${P} % 4u;\n          ${E}[${P}] = ${O}(${_.getByOffset(`index${P}`)}[component${P}]);\n        `;I=`\n        let outputOffset = global_idx * ${p};\n        var value = vec4<u32>(0);\n        ${x("value",0,"u32")}\n        ${x("value",1,"u32")}\n        ${x("value",2,"u32")}\n        ${x("value",3,"u32")}\n        ${S.setByOffset("global_idx","value")}\n      `}else I=`\n      let outputIndices = ${S.offsetToIndices("global_idx")};\n      ${A("")};\n      let value = ${_.getByIndices("dataIndices")};\n      ${S.setByOffset("global_idx","value")};\n      `;return`\n      ${w.registerUniform("outputSize","u32").registerUniform("axisDimLimit","i32").registerUniform("axis","u32").declareVariables(_,v,S)}\n      ${w.mainStart()}\n        ${w.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.outputSize")}\n        ${I}\n      }`};return{name:"Gather",shaderCache:{hint:t.cacheKey,inputDependencies:["rank","rank"]},getRunData:()=>({outputs:[{dims:a,dataType:e[0].dataType}],dispatchGroup:{x:Math.ceil(h/64)},programUniforms:d}),getShaderSource:y}},Iu=e=>ve({axis:e.axis}),Tu=(e,t)=>{let r=e.inputs;qc(r),e.compute(jc(e.inputs,t))}});var Kc,Yc,Pu,ku,Ou=Y(()=>{"use strict";ye();Se();Ze();_e();Kc=e=>{if(!e||e.length!==2)throw new Error("GatherElements requires 2 inputs.");if(e[0].dims.length<1)throw new Error("GatherElements requires that the data input be rank >= 1.");if(e[0].dims.length!==e[1].dims.length)throw new Error(`GatherElements requires that the data input and\n                     indices input tensors be of same rank.`)},Yc=(e,t)=>{let r=e[0].dims,o=e[0].dataType,i=r.length,u=e[1].dims,a=e[1].dataType,c=M.normalizeAxis(t.axis,i),p=r[c],h=u.slice(0),d=M.size(h),y=U("input",o,i),w=U("indicesInput",a,u.length),_=j("output",o,h.length),v=[{type:12,data:d},{type:6,data:p},{type:12,data:c}];return v.push(...Z(r,u,h)),{name:"GatherElements",shaderCache:{inputDependencies:["rank","rank"]},getRunData:()=>({outputs:[{dims:h,dataType:e[0].dataType}],dispatchGroup:{x:Math.ceil(d/64)},programUniforms:v}),getShaderSource:I=>`\n      ${I.registerUniform("outputSize","u32").registerUniform("axisDimLimit","i32").registerUniform("axis","u32").declareVariables(y,w,_)}\n      ${I.mainStart()}\n      ${I.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.outputSize")}\n\n      let outputIndices = ${_.offsetToIndices("global_idx")};\n\n      var idx = ${w.getByOffset("global_idx")};\n      if (idx < 0) {\n        idx = idx + uniforms.axisDimLimit;\n      }\n      var inputIndices = ${y.type.indices}(outputIndices);\n      ${y.indicesSet("inputIndices","uniforms.axis","u32(idx)")};\n      let value = ${y.getByIndices("inputIndices")};\n\n      ${_.setByOffset("global_idx","value")};\n  }`}},Pu=e=>ve({axis:e.axis}),ku=(e,t)=>{let r=e.inputs;Kc(r),e.compute(Yc(e.inputs,t))}});var Zc,Xc,Ru,Bu,Du=Y(()=>{"use strict";ye();Se();_e();Zc=e=>{if(!e)throw new Error("Input is missing");if(e.length<2||e.length>3)throw new Error("Invaid input number.");if(e.length===3&&e[2].dims.length>2)throw new Error("Invalid input shape of C");if(e[0].dataType!==e[1].dataType||e.length===3&&e[0].dataType!==e[2].dataType)throw new Error("Input types are mismatched")},Xc=(e,t)=>{let r=e[0].dims.slice(),o=e[1].dims.slice(),[i,u,a]=Sn.getShapeOfGemmResult(r,t.transA,o,t.transB,e.length===3?e[2].dims:void 0),c=[i,u];if(!c)throw new Error("Can\'t use gemm on the given tensors");let p=M.size(c),h=[{type:12,data:p},{type:12,data:i},{type:12,data:u},{type:12,data:a},{type:1,data:t.alpha},{type:1,data:t.beta}],d=["type","type"];e.length===3&&(h.push(...Z(e[2].dims)),d.push("rank")),h.push(...Z(c));let y=w=>{let _="";t.transA&&t.transB?_="value += a[k * uniforms.M + m] * b[n * uniforms.K + k];":t.transA&&!t.transB?_="value += a[k * uniforms.M + m] * b[k * uniforms.N + n];":!t.transA&&t.transB?_="value += a[m * uniforms.K + k] * b[n * uniforms.K + k];":!t.transA&&!t.transB&&(_="value += a[m * uniforms.K + k] * b[k * uniforms.N + n];");let v=t.alpha===1?"":"value *= uniforms.alpha;",S=U("a",e[0].dataType,e[0].dims),A=U("b",e[1].dataType,e[1].dims),I=S.type.value,x=null,E=[S,A];e.length===3&&(x=U("c",e[2].dataType,e[2].dims.length),E.push(x));let P=j("output",e[0].dataType,c.length);E.push(P);let O=[{name:"output_size",type:"u32"},{name:"M",type:"u32"},{name:"N",type:"u32"},{name:"K",type:"u32"},{name:"alpha",type:"f32"},{name:"beta",type:"f32"}];return`\n  ${w.registerUniforms(O).declareVariables(...E)}\n\n  ${w.mainStart()}\n    ${w.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.output_size")}\n\n    let m = global_idx / uniforms.N;\n    let n = global_idx % uniforms.N;\n\n    var value = ${I}(0);\n    for (var k: u32 = 0u; k < uniforms.K; k++) {\n      ${_}\n    }\n\n    ${v}\n    ${(()=>x!=null?`let cOffset = ${x.broadcastedIndicesToOffset("vec2(m, n)",P)}; value += ${I}(uniforms.beta) * ${x.getByOffset("cOffset")};`:"")()}\n    output[global_idx] = value;\n  }`};return{name:"Gemm",shaderCache:{hint:`${t.cacheKey}`,inputDependencies:d},getRunData:()=>({outputs:[{dims:c,dataType:e[0].dataType}],dispatchGroup:{x:Math.ceil(p/64)},programUniforms:h}),getShaderSource:y}},Ru=e=>{let t=e.transA,r=e.transB,o=e.alpha,i=e.beta;return{transA:t,transB:r,alpha:o,beta:i,cacheKey:`${e.transA};${e.transB};${e.alpha===1}`}},Bu=(e,t)=>{Zc(e.inputs),e.compute(Xc(e.inputs,t))}});var Qc,Jc,ep,zu,Mu=Y(()=>{"use strict";ye();Se();_e();Qc=(e,t)=>{let r=e[0].dims,o=r,i=2,u=M.sizeToDimension(r,i),a=M.sizeFromDimension(r,i),c=Me(a),p=a/c,h=[r[0],r[1],p],d=["rank","type","type"],y=[{type:12,data:a},{type:12,data:p}];y.push(...Z(h,h));let w=_=>{let v=U("x",e[0].dataType,h.length,c),S=U("scale",e[1].dataType,e[1].dims),A=U("bias",e[2].dataType,e[2].dims),I=j("output",e[0].dataType,h.length,c),x=[v,S,A,I],E=v.type.value,P=c===1?"f32":`vec${c}<f32>`,O=64,R=[{name:"normSize",type:"u32"},{name:"normPackedSize",type:"u32"}];return`\n  var<workgroup> meanShared : f32;\n  var<workgroup> squaredNormShared : f32;\n  var<workgroup> workgroupShared : array<${P}, ${O}>;\n  const workgroupSize = ${O}u;\n  ${_.registerUniforms(R).declareVariables(...x)}\n  ${_.mainStart(O)}\n    let norm = global_idx / workgroupSize;\n    let batch = norm / uniforms.x_shape[1];\n    let channel = norm % uniforms.x_shape[1];\n    let localIndex = local_id.x;\n\n    // initialize workgroup memory\n    var initial = ${P}(0);\n    for (var h = localIndex; h < uniforms.normPackedSize; h += workgroupSize) {\n      initial = initial + ${P}(${v.get("batch","channel","h")});\n    }\n    workgroupShared[localIndex] = initial;\n    workgroupBarrier();\n\n    // Calculate the mean of current channel data.\n    for (var currSize = workgroupSize >> 1;  currSize > 0; currSize = currSize >> 1) {\n      if (localIndex < currSize) {\n        workgroupShared[localIndex] = workgroupShared[localIndex] + workgroupShared[localIndex + currSize];\n      }\n      workgroupBarrier();\n    }\n    if (localIndex == 0) {\n      meanShared = ${_t("workgroupShared[0]",c)} / f32(uniforms.normSize);\n    }\n    workgroupBarrier();\n\n    // reinitialize workgroup memory.\n    initial = ${P}(0);\n    for (var h = localIndex; h < uniforms.normPackedSize; h += workgroupSize) {\n      let deviation =  ${P}(${v.get("batch","channel","h")}) - ${P}(meanShared);\n      initial = initial + deviation * deviation;\n    }\n    workgroupShared[localIndex] = initial;\n    workgroupBarrier();\n\n    // Calculate the sum of square of deviation of current channel data.\n    for (var currSize = workgroupSize >> 1;  currSize > 0; currSize = currSize >> 1) {\n      if (localIndex < currSize) {\n        workgroupShared[localIndex] = workgroupShared[localIndex] + workgroupShared[localIndex + currSize];\n      }\n      workgroupBarrier();\n    }\n    if (localIndex == 0) {\n      squaredNormShared = ${_t("workgroupShared[0]",c)};\n    }\n    workgroupBarrier();\n\n    let invStdDev = inverseSqrt(squaredNormShared / f32(uniforms.normSize) + f32(${t.epsilon}));\n    let channelScale = invStdDev * f32(${S.getByOffset("channel")});\n    let channelShift = f32(${A.getByOffset("channel")}) - meanShared * channelScale;\n    for (var h = localIndex; h < uniforms.normPackedSize; h += workgroupSize) {\n      let value = ${v.get("batch","channel","h")} * ${E}(${P}(channelScale)) + ${E}(${P}(channelShift));\n      ${I.set("batch","channel","h","value")};\n    }\n  }`};return{name:"InstanceNormalization",shaderCache:{hint:`${t.epsilon};${c}`,inputDependencies:d},getRunData:()=>({outputs:[{dims:o,dataType:e[0].dataType}],dispatchGroup:{x:u},programUniforms:y}),getShaderSource:w}},Jc=(e,t,r,o,i,u,a,c)=>{let p=Me(a),h=64,d=p===1?"vec2f":`mat2x${p}f`,y=p===1?"f32":`vec${p}f`,w=(R,L)=>`${d}(${R}, ${L})`,_=i*a/p,v=Math.ceil(u/h),S=["type"],A=[{type:12,data:v},{type:12,data:u},{type:12,data:Math.floor(a/p)},{type:12,data:Math.floor(u*a/p)}],I=R=>{let L=U("input",t.dataType,t.dims,p);return`\n  ${R.declareVariables(L)}\n  @group(0) @binding(1) var<storage, read_write> output : array<${d}>;\n  struct Uniforms {wg_size:u32, H:u32, C:u32, image_size:u32};\n  @group(0) @binding(2) var<uniform> uniforms: Uniforms;\n\n  ${R.mainStart(h)}\n    let currentImageNumber = global_idx / ${h} / uniforms.C;\n    let currentChannelNumber = (global_idx / ${h}) % uniforms.C;\n    let wgOffset = local_id.x * uniforms.wg_size;\n    if (wgOffset >= uniforms.H) {\n        return;\n    }\n    let wgMax = min(wgOffset + uniforms.wg_size, uniforms.H);\n\n    let offset = currentImageNumber * uniforms.image_size + currentChannelNumber;\n    var sum = ${$t("f32",p)};\n    var squaredSum = ${$t("f32",p)};\n    for (var i: u32 = wgOffset; i < wgMax; i++) {\n        let value = ${y}(input[offset + i * uniforms.C]);\n        sum += value;\n        squaredSum += value * value;\n    }\n    output[global_idx] = ${w("sum","squaredSum")};\n  }`},x=e.compute({name:"InstanceNormComputeMean",shaderCache:{hint:`${p}`,inputDependencies:S},getRunData:()=>({outputs:[{dims:[i,a,h,2],dataType:1}],dispatchGroup:{x:i*a/p},programUniforms:A}),getShaderSource:I},{inputs:[t],outputs:[-1]})[0],E=[{type:12,data:_},{type:12,data:u},{type:12,data:Math.floor(a/p)},{type:12,data:Math.floor(h*a/p)}],P=["type","type","type"],O=R=>{let L=U("scale",r.dataType,r.dims,p),N=U("bias",o.dataType,o.dims,p);return`\n  @group(0) @binding(0) var<storage, read> input : array<${d}>;\n  @group(0) @binding(1) var<storage, read> scale : array<${L.type.storage}>;\n  @group(0) @binding(2) var<storage, read> bias : array<${N.type.storage}>;\n  @group(0) @binding(3) var<storage, read_write> output : array<${d}>;\n  struct Uniforms {units_of_work : u32, H: u32, C : u32, image_size : u32};\n  @group(0) @binding(4) var<uniform> uniforms: Uniforms;\n\n  ${R.mainStart()}\n    ${R.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.units_of_work")}\n    let currentImageNumber = global_idx / uniforms.C;\n    let currentChannelNumber = global_idx % uniforms.C;\n\n    let offset = currentImageNumber * uniforms.image_size;\n    var sum = ${$t("f32",p)};\n    var squaredSum = ${$t("f32",p)};\n    for (var i: u32 = 0; i < min(${h}, uniforms.H); i++) {\n        let value = input[offset + i + currentChannelNumber * ${h}];\n        sum += value[0];\n        squaredSum += value[1];\n    }\n    sum = sum / f32(uniforms.H);\n    squaredSum = squaredSum / f32(uniforms.H);\n    let invStdDev = inverseSqrt(squaredSum - sum * sum + f32(${c}));\n    let channelScale = invStdDev * ${y}(scale[currentChannelNumber]);\n    let channelShift = ${y}(bias[currentChannelNumber]) - sum * channelScale;\n\n    output[global_idx] = ${w("channelScale","channelShift")};\n  }`};return e.compute({name:"InstanceNormComputeChannelScaleShift",shaderCache:{hint:`${p};${c}`,inputDependencies:P},getRunData:()=>({outputs:[{dims:[i,a,2],dataType:1}],dispatchGroup:{x:Math.ceil(_/64)},programUniforms:E}),getShaderSource:O},{inputs:[x,r,o],outputs:[-1]})[0]},ep=(e,t,r)=>{let o=t[0].dims,i=o,u=o[0],a=o[o.length-1],c=M.sizeFromDimension(o,1)/a,p=Me(a),h=M.size(i)/p,d=[{type:12,data:c},{type:12,data:Math.floor(a/p)}],y=["type","type"],w=Jc(e,t[0],t[1],t[2],u,c,a,r.epsilon),_=v=>{let S=De(t[0].dataType),A=p===1?"vec2f":`mat2x${p}f`,I=p===1?S:`vec${p}<${S}>`,x=U("input",t[0].dataType,t[0].dims,p),E=j("output",t[0].dataType,i,p);return`\n  @group(0) @binding(0) var<storage, read> input : array<${x.type.storage}>;\n  @group(0) @binding(1) var<storage, read> scaleInput : array<${A}>;\n  @group(0) @binding(2) var<storage, read_write> output : array<${E.type.storage}>;\n  struct Uniforms {H: u32, C : u32};\n  @group(0) @binding(3) var<uniform> uniforms: Uniforms;\n\n  ${v.mainStart()}\n    let currentImageNumber = global_idx / (uniforms.C * uniforms.H);\n    let currentChannelNumber = global_idx % uniforms.C;\n\n    let scaleOffset = currentImageNumber * uniforms.C + currentChannelNumber;\n    let scale = scaleInput[scaleOffset];\n    output[global_idx] = fma(input[global_idx], ${I}(scale[0]), ${I}(scale[1]));\n  }`};e.compute({name:"InstanceNormalizationNHWC",shaderCache:{hint:`${p}`,inputDependencies:y},getRunData:()=>({outputs:[{dims:i,dataType:t[0].dataType}],dispatchGroup:{x:Math.ceil(h/64)},programUniforms:d}),getShaderSource:_},{inputs:[t[0],w]})},zu=(e,t)=>{t.format==="NHWC"?ep(e,e.inputs,t):e.compute(Qc(e.inputs,t))}});var tp,rp,Uu,Vu=Y(()=>{"use strict";ye();Se();_e();tp=e=>{if(!e||e.length<2)throw new Error("layerNorm requires at least 2 inputs.")},rp=(e,t,r)=>{let o=t.simplified,i=e[0].dims,u=e[1],a=!o&&e[2],c=i,p=M.normalizeAxis(t.axis,i.length),h=M.sizeToDimension(i,p),d=M.sizeFromDimension(i,p),y=M.size(u.dims),w=a?M.size(a.dims):0;if(y!==d||a&&w!==d)throw new Error(`Size of X.shape()[axis:] == ${d}.\n       Size of scale and bias (if provided) must match this.\n       Got scale size of ${y} and bias size of ${w}`);let _=[];for(let O=0;O<i.length;++O)O<p?_.push(i[O]):_.push(1);let v=Me(d),S=["type","type"],A=[{type:12,data:h},{type:1,data:d},{type:12,data:Math.floor(d/v)},{type:1,data:t.epsilon}];a&&S.push("type");let I=r>1,x=r>2,E=O=>{let R=De(e[0].dataType),L=[U("x",e[0].dataType,e[0].dims,v),U("scale",u.dataType,u.dims,v)];a&&L.push(U("bias",a.dataType,a.dims,v)),L.push(j("output",e[0].dataType,c,v)),I&&L.push(j("mean_data_output",1,_)),x&&L.push(j("inv_std_output",1,_));let N=[{name:"norm_count",type:"u32"},{name:"norm_size",type:"f32"},{name:"norm_size_vectorized",type:"u32"},{name:"epsilon",type:"f32"}];return`\n  ${O.registerUniforms(N).declareVariables(...L)}\n  ${O.mainStart()}\n    ${O.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.norm_count")}\n    let offset = global_idx * uniforms.norm_size_vectorized;\n    var mean_vector = ${$t("f32",v)};\n    var mean_square_vector = ${$t("f32",v)};\n\n    for (var h: u32 = 0u; h < uniforms.norm_size_vectorized; h++) {\n      let value = ${ir(R,v,"x[h + offset]")};\n      mean_vector += value;\n      mean_square_vector += value * value;\n    }\n    let mean = ${_t("mean_vector",v)} / uniforms.norm_size;\n    let inv_std_dev = inverseSqrt(${_t("mean_square_vector",v)} / uniforms.norm_size ${o?"":"- mean * mean"} + uniforms.epsilon);\n\n    for (var j: u32 = 0; j < uniforms.norm_size_vectorized; j++) {\n      let f32input = ${ir(R,v,"x[j + offset]")};\n      let f32scale = ${ir(R,v,"scale[j]")};\n      output[j + offset] = ${L[0].type.value}((f32input ${o?"":"- mean"}) * inv_std_dev * f32scale\n        ${a?`+ ${ir(R,v,"bias[j]")}`:""}\n      );\n    }\n\n    ${I?"mean_data_output[global_idx] = mean":""};\n    ${x?"inv_std_output[global_idx] = inv_std_dev":""};\n  }`},P=[{dims:c,dataType:e[0].dataType}];return I&&P.push({dims:_,dataType:1}),x&&P.push({dims:_,dataType:1}),{name:"LayerNormalization",shaderCache:{hint:`${v};${r};${o}`,inputDependencies:S},getRunData:()=>({outputs:P,dispatchGroup:{x:Math.ceil(h/64)},programUniforms:A}),getShaderSource:E}},Uu=(e,t)=>{tp(e.inputs),e.compute(rp(e.inputs,t,e.outputCount))}});var np,op,Wu,Nu,Gu=Y(()=>{"use strict";ye();Se();Ze();_e();np=(e,t)=>{if(e.length<3||e.length>4)throw new Error("MatMulNBits requires 3 or 4 inputs");let r=e[0],o=r.dims.length;if(r.dims[o-1]!==t.k)throw new Error("The last dim of input shape does not match the k value");let i=Math.floor((t.k+t.blockSize-1)/t.blockSize),u=t.blockSize/8*t.bits,a=e[1];if(!M.areEqual(a.dims,[t.n,i,u]))throw new Error("The second inputs must be 3D tensor with shape N X nBlocksPerCol X blobSize");let p=e[2].dims;if(M.size(p)!==t.n*i)throw new Error("scales input size error.");if(e.length===4){let d=e[3].dims,y=t.bits>4?t.n*i:t.n*Math.floor((i+1)/2);if(M.size(d)!==y)throw new Error("zeroPoints input size error.")}},op=(e,t,r,o)=>{let i=e[0].dims,u=i.length,a=Math.floor((t.k+t.blockSize-1)/t.blockSize),c=i[u-2],p=t.k,h=t.n,d=i.slice(0,u-2),y=M.size(d),_=t.blockSize/8*t.bits/4,v=e[0].dataType,S=Me(c),A=Me(t.k),I=Me(_),x=tr(v),E=c*a*x,P=Math.floor(o/E),O=a<=r[0]&&P>0,R=!O||P>=4?Me(h):P>=2&&Me(h)>=2?2:1,L=d.concat([c,h]),N=M.size(L)/R/S,K=O?[]:[{type:12,data:N},{type:12,data:t.blockSize}],Q=[y,c,p/A],he=M.convertShape(e[1].dims).slice();he.splice(-1,1,_/I),K.push(...Z(Q)),K.push(...Z(he)),K.push(...Z(e[2].dims)),e.length===4&&K.push(...Z(M.convertShape(e[3].dims)));let W=[y,c,h/R];K.push(...Z(W));let se=Ce=>{let We=Q.length,ee=U("a",e[0].dataType,We,A),ae=U("b",12,he.length,I),Ae=U("scales",e[2].dataType,e[2].dims.length),me=[ee,ae,Ae],ie=e.length===4?U("zero_points",12,e[3].dims.length):void 0;ie&&me.push(ie);let ue=W.length,le=j("output",e[0].dataType,ue,R),qe=[{name:"output_size",type:"u32"},{name:"block_size",type:"u32"}],G=De(e[0].dataType),ne=(()=>{switch(A){case 1:return`array<${G}, 8>`;case 2:return`mat4x2<${G}>`;case 4:return`mat2x4<${G}>`;default:throw new Error(`${A}-component is not supported.`)}})(),xe=`\n        for (var word: u32 = 0; word < ${_}; word += ${I}) {\n          ${ae.indicesSet("b_indices","2","word")};\n          let b_data = ${ae.getByIndices("b_indices")};\n          for (var i: u32 = 0; i < ${I}; i++) {\n            let b_value: u32 = ${I===1?"b_data":"b_data[word + i]"};\n            let b_mask: u32 = 0x0F0F0F0Fu;\n            let b_value_lower: vec4<u32> = unpack4xU8(b_value & b_mask);\n            let b_value_upper: vec4<u32> = unpack4xU8((b_value >> 4) & b_mask);\n            let b_quantized_values = ${ne}(${Array.from({length:4},(Be,Ge)=>`${G}(b_value_lower[${Ge}]), ${G}(b_value_upper[${Ge}])`).join(", ")});\n            let b_dequantized_values = ${(()=>A===1?`${ne}(${Array.from({length:8},(Be,Ge)=>`(b_quantized_values[${Ge}] - zero_point) * scale`).join(", ")});`:`(b_quantized_values - ${ne}(${Array(8).fill("zero_point").join(",")})) * scale;`)()};\n            // Number of B elements per 32-bit word is 32/bits = 32/4 = 8\n            for (var m: u32 = 0; m < ${O?c:S}u; m++) {\n              ${ee.indicesSet("a_indices",We-2,O?"m":`row * ${S} + m`)};\n              ${ee.indicesSet("a_indices",We-1,"word_offset")};\n              var input_offset = ${ee.indicesToOffset("a_indices")};\n              var a_data: ${ne};\n              for (var j: u32 = 0; j < ${8/A}; j++) {\n                a_data[j] = ${ee.getByOffset("input_offset")};\n                input_offset++;\n              }\n              ${O?"workgroup_shared[workgroup_shared_offset + m]":"output_values[m]"}${R>1?"[c]":""} += ${Array.from({length:8/A},(Be,Ge)=>`${A===1?`a_data[${Ge}] * b_dequantized_values[${Ge}]`:`dot(a_data[${Ge}], b_dequantized_values[${Ge}])`}`).join(" + ")};\n            }\n            word_offset += ${8/A};\n          }\n        }`,Ke=ie?`\n          zero_point_offset += 4;\n          if (zero_point_offset == 32) {\n            zero_point_offset = 0;\n            zero_point_index++;\n            zero_point_word = ${ie.getByOffset("zero_point_index")};\n          }`:"";return O?`\n        var<workgroup> workgroup_shared: array<${le.type.value}, ${c*a}>;\n        ${Ce.declareVariables(...me,le)}\n        ${Ce.mainStart([a,1,1])}\n          var a_indices: ${ee.type.indices};\n          var block = local_id.x;\n          var col = workgroup_id.y;\n          var batch = workgroup_id.z;\n          ${ee.indicesSet("a_indices","0","batch")};\n          // Two zero points are packed into one byte when uniforms.bits is 4.\n          for (var c: u32 = 0; c < ${R}; c++) {\n            let col_times_components_plus_c = col * ${R} + c;\n              ${ie?`\n            var zero_point_bytes_per_col: u32 = (${a} + 1) / 2;\n            var zero_point_byte_count: u32 = col_times_components_plus_c * zero_point_bytes_per_col + (block >> 0x1u);\n            var zero_point_word_index: u32 = zero_point_byte_count >> 0x2u;\n            var zero_point_byte_offset: u32 = zero_point_byte_count & 0x3u;\n            var zero_point_nibble_offset: u32 = block & 0x1u;\n            var zero_point_bits_offset: u32 = (zero_point_byte_offset << 3) + (zero_point_nibble_offset << 2);\n            var zero_point_word: u32 = ${ie.getByOffset("zero_point_word_index")} >> zero_point_bits_offset;`:""}\n            var b_indices: ${ae.type.indices};\n            ${ae.indicesSet("b_indices","0","col_times_components_plus_c")};\n            // The scale and zero points are computed per block.\n            var scales_index = col_times_components_plus_c * ${a} + block;\n            let scale = ${Ae.getByOffset("scales_index")};\n            // The default zero point is 8 for unsigned 4-bit quantization.\n            let zero_point = ${G}(${ie?"(zero_point_word) & 0xFu":8});\n            ${ae.indicesSet("b_indices","1","block")};\n            var word_offset: u32 = block * ${t.blockSize/A};\n            var workgroup_shared_offset: u32 = block * ${c};\n            ${xe}\n          }\n          workgroupBarrier();\n          if (local_id.x == 0u) {\n            var output_indices: ${le.type.indices};\n            ${le.indicesSet("output_indices","0","batch")};\n            ${le.indicesSet("output_indices",ue-1,"col")};\n            ${le.indicesSet("output_indices",ue-2,"0")};\n            var output_offset = ${le.indicesToOffset("output_indices")};\n            for (var m: u32 = 0u; m < ${c}u; m++) {\n              var output_value: ${le.type.value} = ${le.type.value}(0);\n              var workgroup_shared_offset: u32 = m;\n              for (var b: u32 = 0u; b < ${a}u; b++) {\n                output_value += workgroup_shared[workgroup_shared_offset];\n                workgroup_shared_offset += ${c};\n              }\n              ${le.setByOffset("output_offset","output_value")};\n              output_offset += ${h/R};\n            }\n          }\n        }`:`\n        ${Ce.registerUniforms(qe).declareVariables(...me,le)}\n        ${Ce.mainStart()}\n          ${Ce.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.output_size")}\n          var output_values: array<${le.type.value}, ${S}>;\n          var output_indices = ${le.offsetToIndices("global_idx")};\n          var col = ${le.indicesGet("output_indices",ue-1)};\n          var row = ${le.indicesGet("output_indices",ue-2)};\n          var a_indices: ${ee.type.indices} = output_indices;\n          // Two zero points are packed into one byte because uniforms.bits <= 4.\n          // zero_point_offset is either 0 or 4. It is bit offset within one byte.\n          // TODO support zero_point_offset for bits > 4\n          ${ie?`\n          var zero_point_abs_offset = col * ${R} * ((${a} + 1) / 2);\n          var zero_point_index: u32 = zero_point_abs_offset / 4;\n          var zero_point_word: u32 = ${ie.getByOffset("zero_point_index")};\n          var zero_point_offset: u32 = (zero_point_abs_offset % 4) * 8;`:""}\n          var scale_index = col * ${a*R};\n          var b_indices: ${ae.type.indices};\n          for (var c: u32 = 0; c < ${R}; c++) {\n            ${ae.indicesSet("b_indices","0",`col * ${R} + c`)};\n            var block_offset: u32 = 0;\n            for (var block: u32 = 0; block < ${a}; block++) {\n              // The scale and zero points are computed per block.\n              let scale = ${Ae.getByOffset("scale_index")};\n              // The default zero point is 8 for unsigned 4-bit quantization.\n              let zero_point = ${G}(${ie?"extractBits(zero_point_word, zero_point_offset, 4)":8});\n              ${ae.indicesSet("b_indices","1","block")};\n              var word_offset: u32 = block_offset;\n              ${xe}\n              scale_index++;\n              ${Ke}\n              block_offset += uniforms.block_size / ${A};\n            }\n            // Drop the trailing 4 bits if the zero_poit_offset is not a byte boundary to align with the next byte.\n            ${ie?`if (zero_point_offset % 8 > 0) {\n                ${Ke}\n              }`:""}\n            }\n            for (var k: u32 = 0u; k < ${S}u; k++) {\n              ${le.indicesSet("output_indices",ue-2,`${S} * row + k`)};\n              ${le.setByIndices("output_indices","output_values[k]")}\n            }\n        }`};return{name:O?"BlockwiseMatMulNBits":"MatMulNBits",shaderCache:{hint:`${t.cacheKey};${c};${v};${e.length}`,inputDependencies:Array(e.length).fill("rank")},getRunData:()=>({outputs:[{dims:L,dataType:v}],name:O?"BlockwiseMatMulNBits":"MatMulNBits",dispatchGroup:O?{x:1,y:Math.ceil(h/R),z:y}:{x:Math.ceil(N/64)},programUniforms:K}),getShaderSource:se}},Wu=(e,t)=>{np(e.inputs,t);let r=e.getMaxComputeWorkgroupSizes(),o=e.getMaxComputeWorkgroupStoragesize();e.compute(op(e.inputs,t,r,o))},Nu=e=>ve(e)});var it,ip,Lu,Hu,ap,Ko,Fu,qu=Y(()=>{"use strict";ye();Se();Ze();_n();Ro();_e();Sr();it=(e,t)=>e.length>t&&e[t].dims.length>0&&M.size(e[t].dims)>0?e[t]:void 0,ip=(e,t)=>{let r=e[0],o=it(e,1),i=it(e,2),u=it(e,3),a=it(e,4),c=it(e,5),p=it(e,6),h=it(e,7);if(r.dims.length!==3&&r.dims.length!==5)throw new Error("Input query is expected to have 3 or 5 dimensions");let d=!1,y=r.dims[0],w=r.dims[1],_=r.dims.length===3?d?r.dims[2]/3:r.dims[2]:t.numHeads*r.dims[4],v=w,S=0,A=0,I=Math.floor(_/t.numHeads);if(p&&h){if(p.dims.length!==4)throw new Error(\'Input "past_key" is expected to have 4 dimensions\');if(p.dims[0]!==y||p.dims[1]!==t.numHeads||p.dims[3]!==I)throw new Error(\'Input "past_key" shape (batch_size, num_heads, past_sequence_length, head_size)\');if(h.dims[0]!==y||h.dims[1]!==t.numHeads||h.dims[3]!==I)throw new Error(\'Input "past_value" shape (batch_size, num_heads, past_sequence_length, head_size)\');if(p.dims[2]!==h.dims[2])throw new Error(\'Input "past_key" and "past_value" shall have same dim 2 (past_sequence_length)\');if(h.dims.length!==4)throw new Error(\'Input "past_value" is expected to have 4 dimensions\');S=p.dims[2],A=p.dims[2]}else if(p||h)throw new Error(\'Input "past_key" and "past_value" shall be both present or both absent\');let x;if(o){if(r.dims.length!==3)throw new Error(\'Input "query" is expected to have 3 dimensions when key is given\');if(o.dims.length<3||o.dims.length>5)throw new Error(\'Input "key" is expected to have 3, 4, or 5 dimensions\');if(r.dims[0]!==o.dims[0])throw new Error(\'Input "query" and "key" shall have same dim 0 (batch size)\');if(o.dims.length===3){if(o.dims[2]!==r.dims[2])throw new Error(\'Input "query" and "key" shall have same dim 2 (hidden_size)\');x=2,v=o.dims[1]}else if(o.dims.length===5){if(o.dims[2]!==t.numHeads||o.dims[3]!==2||o.dims[4]!==I)throw new Error(\'Expect "key" shape (batch_size, kv_sequence_length, num_heads, 2, head_size) for packed kv\');if(i)throw new Error(\'Expect "value" be none when "key" has packed kv format.\');x=5,v=o.dims[1]}else{if(o.dims[1]!==t.numHeads||o.dims[3]!==I)throw new Error(\'Expect "key" shape (batch_size, num_heads, kv_sequence_length, head_size) for past_key\');x=0,v=o.dims[2]}}else{if(r.dims.length!==3&&r.dims.length!==5)throw new Error(\'Input "query" is expected to have 3 or 5 dimensions when key is empty\');if(r.dims.length===5&&(r.dims[2]!==t.numHeads||r.dims[3]!==3))throw new Error(\'Expect "query" shape (batch_size, kv_sequence_length, num_heads, 3, head_size) for packed kv\');x=3}if(u){if(u.dims.length!==1)throw new Error(\'Input "bias" is expected to have 1 dimension\');if(i&&r.dims.length===5&&r.dims[3]===2)throw new Error("bias is not allowed for packed kv.")}let E=0;if(a){E=8;let N=a.dims;throw N.length===1?N[0]===y?E=1:N[0]===3*y+2&&(E=3):N.length===2&&N[0]===y&&N[1]===v&&(E=5),E===8?new Error(\'Input "key_padding_mask" shape shall be (batch_size) or (batch_size, kv_sequence_length)\'):new Error("Mask not supported")}let P=!1,O=_;if(i){if(i.dims.length!==3&&i.dims.length!==4)throw new Error(\'Input "value" is expected to have 3 or 4 dimensions\');if(r.dims[0]!==i.dims[0])throw new Error(\'Input "query" and "value" shall have same dim 0 (batch_size)\');if(i.dims.length===3){if(v!==i.dims[1])throw new Error(\'Input "key" and "value" shall have the same dim 1 (kv_sequence_length)\');O=i.dims[2]}else{if(v!==i.dims[2])throw new Error(\'Input "past_key" and "past_value" shall have the same dim 2 (kv_sequence_length)\');O=i.dims[1]*i.dims[3],P=!0}}let R=S+v,L=!1;if(a)throw new Error("Key padding mask is not supported");if(c){if(c.dims.length!==4)throw new Error(\'Input "relative_position_bias" is expected to have 4 dimensions\');if(c.dims[0]!==y&&c.dims[0]!==1||c.dims[1]!==t.numHeads||c.dims[2]!==w||c.dims[3]!==R)throw new Error(\'Input "relative_position_bias" shape (batch_size, 1, sequence_length, kv_sequence_length)\')}return{batchSize:y,sequenceLength:w,pastSequenceLength:S,kvSequenceLength:v,totalSequenceLength:R,maxSequenceLength:A,inputHiddenSize:0,hiddenSize:_,vHiddenSize:O,headSize:I,vHeadSize:Math.floor(O/t.numHeads),numHeads:t.numHeads,isUnidirectional:!1,pastPresentShareBuffer:!1,maskFilterValue:t.maskFilterValue,maskType:E,scale:t.scale,broadcastResPosBias:L,passPastInKv:P,qkvFormat:x}},Lu=e=>ve({...e}),Hu=ve({perm:[0,2,1,3]}),ap=(e,t,r,o,i,u,a)=>{let c=[o,i,u],p=M.size(c),h=[{type:12,data:p},{type:12,data:a},{type:12,data:u}],d=y=>{let w=j("qkv_with_bias",t.dataType,c),_=U("qkv",t.dataType,c),v=U("bias",r.dataType,c),S=[{name:"output_size",type:"u32"},{name:"bias_offset",type:"u32"},{name:"hidden_size",type:"u32"}];return`\n  ${y.registerUniforms(S).declareVariables(_,v,w)}\n  ${y.mainStart()}\n    ${y.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.output_size")}\n    let bias_offset_idx = (global_idx % uniforms.hidden_size) + uniforms.bias_offset;\n\n    qkv_with_bias[global_idx] = qkv[global_idx] + bias[bias_offset_idx];\n  }`};return e.compute({name:"MultiHeadAttentionAddBias",shaderCache:{inputDependencies:["type","type"]},getRunData:()=>({outputs:[{dims:c,dataType:t.dataType,gpuDataType:0}],dispatchGroup:{x:Math.ceil(p/64)},programUniforms:h}),getShaderSource:d},{inputs:[t,r],outputs:[-1]})[0]},Ko=(e,t,r,o,i,u,a,c)=>{let p=u;if(a){if(o===1)throw new Error("AddBiasReshape is not implemented. Please export your model with packed QKV or KV");return p=ap(e,u,a,t,o,r*i,c),p=p.reshape([t,o,r,i]),e.compute(yt(p,Hu.perm),{inputs:[p],outputs:[-1]})[0]}else return u.dims.length===3&&(p=u.reshape([t,o,r,i])),e.compute(yt(p,Hu.perm),{inputs:[p],outputs:[-1]})[0]},Fu=(e,t)=>{let r=ip(e.inputs,t),o=e.inputs[0],i=it(e.inputs,1),u=it(e.inputs,2),a=it(e.inputs,3),c=it(e.inputs,4),p=it(e.inputs,5),h=it(e.inputs,6),d=it(e.inputs,7);if(o.dims.length===5)throw new Error("Packed QKV is not implemented");if(i?.dims.length===5)throw new Error("Packed KV is not implemented");let y=i&&u&&i.dims.length===4&&u.dims.length===4,w=Ko(e,r.batchSize,r.numHeads,r.sequenceLength,r.headSize,o,a,0);if(y)return Pn(e,w,i,u,c,void 0,h,d,p,r,t);if(!i||!u)throw new Error("key and value must be provided");let _=Ko(e,r.batchSize,r.numHeads,r.kvSequenceLength,r.headSize,i,a,r.hiddenSize),v=Ko(e,r.batchSize,r.numHeads,r.kvSequenceLength,r.vHeadSize,u,a,2*r.hiddenSize);Pn(e,w,_,v,c,void 0,h,d,p,r,t)}});var sp,up,dp,lp,cp,pp,mp,fp,ju,Ku=Y(()=>{"use strict";ye();Se();_e();sp=e=>{if(!e||e.length<1)throw new Error("Too few inputs");if(e[0].dataType!==1&&e[0].dataType!==10)throw new Error("Input type must be float or float16.");if(e.length>=2){let t=e[0].dims.length*2===e[1].dims[0];if(e.length===4&&(t=e[3].dims[0]*2===e[1].dims[0]),!t)throw new Error("The pads should be a 1D tensor of shape [2 * input_rank] or [2 * num_axes].")}},up=(e,t,r)=>{let o="";for(let i=t-1;i>=0;--i)o+=`\n            k = i32(${e.indicesGet("indices",i)}) - ${fe("uniforms.pads",i,r)};\n            if (k < 0) {\n              break;\n            }\n            if (k >= i32(${fe("uniforms.x_shape",i,t)})) {\n              break;\n            }\n            offset += k * i32(${fe("uniforms.x_strides",i,t)});\n        `;return`\n          value = ${e.type.value}(uniforms.constant_value);\n          for (var i = 0; i < 1; i++) {\n            var offset = 0;\n            var k = 0;\n            ${o}\n            value = x[offset];\n          }\n      `},dp=(e,t,r)=>{let o="";for(let i=t-1;i>=0;--i)o+=`\n                k = i32(${e.indicesGet("indices",i)}) - ${fe("uniforms.pads",i,r)};\n                if (k < 0) {\n                  k = -k;\n                }\n                {\n                  let _2n_1 = 2 * (i32(${fe("uniforms.x_shape",i,t)}) - 1);\n                  k = k % _2n_1;\n                  if(k >= i32(${fe("uniforms.x_shape",i,t)})) {\n                    k = _2n_1 - k;\n                  }\n                }\n                offset += k * i32(${fe("uniforms.x_strides",i,t)});\n            `;return`\n              var offset = 0;\n              var k = 0;\n              ${o}\n              value = x[offset];\n          `},lp=(e,t,r)=>{let o="";for(let i=t-1;i>=0;--i)o+=`\n                k = i32(${e.indicesGet("indices",i)}) - ${fe("uniforms.pads",i,r)};\n                if (k < 0) {\n                  k = 0;\n                }\n                if (k >= i32(${fe("uniforms.x_shape",i,t)})) {\n                  k = i32(${fe("uniforms.x_shape",i,t)}) - 1;\n                }\n                offset += k * i32(${fe("uniforms.x_strides",i,t)});\n            `;return`\n              var offset = 0;\n              var k = 0;\n              ${o}\n              value = x[offset];\n          `},cp=(e,t,r)=>{let o="";for(let i=t-1;i>=0;--i)o+=`\n                k = i32(${e.indicesGet("indices",i)}) - ${fe("uniforms.pads",i,r)};\n                if (k < 0)  {\n                  k += i32(${fe("uniforms.x_shape",i,t)}]);\n                }\n                if (k >= i32(${fe("uniforms.x_shape",i,t)})) {\n                  k -= i32(${fe("uniforms.x_shape",i,t)});\n                }\n                offset += k * i32(${fe("uniforms.x_strides",i,t)});\n            `;return`\n              var offset = 0;\n              var k = 0;\n              ${o}\n              value = x[offset];\n          `},pp=(e,t,r)=>{switch(r.mode){case 0:return up(e,t,r.pads.length);case 1:return dp(e,t,r.pads.length);case 2:return lp(e,t,r.pads.length);case 3:return cp(e,t,r.pads.length);default:throw new Error("Invalid mode")}},mp=(e,t)=>{let r=M.padShape(e[0].dims.slice(),t.pads),o=e[0].dims,i=M.size(r),u=[{type:12,data:i},{type:6,data:t.pads}];t.mode===0&&u.push({type:e[0].dataType,data:t.value}),u.push(...Z(e[0].dims,r));let a=["rank"],c=p=>{let h=j("output",e[0].dataType,r.length),d=U("x",e[0].dataType,o.length),y=d.type.value,w=pp(h,o.length,t),_=[{name:"output_size",type:"u32"},{name:"pads",type:"i32",length:t.pads.length}];return t.mode===0&&_.push({name:"constant_value",type:y}),`\n            ${p.registerUniforms(_).declareVariables(d,h)}\n            ${p.mainStart()}\n            ${p.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.output_size")}\n\n            let indices = ${h.offsetToIndices("global_idx")};\n\n            var value = ${y}(0);\n            ${w}\n            output[global_idx] = value;\n        }`};return{name:"Pad",shaderCache:{hint:`${t.mode}`,inputDependencies:a},getRunData:()=>({outputs:[{dims:r,dataType:e[0].dataType}],dispatchGroup:{x:Math.ceil(M.size(r)/64)},programUniforms:u}),getShaderSource:c}},fp=(e,t)=>{if(e.length>1){let r=e[1].getBigInt64Array(),o=e.length>=3&&e[2].data?e[2].getFloat32Array()[0]:0,i=e[0].dims.length,u=new Int32Array(2*i).fill(0);if(e.length>=4){let c=e[3].getBigInt64Array();for(let p=0;p<c.length;p++)u[Number(c[p])]=Number(r[p]),u[Number(c[p])+i]=Number(r[p+c.length])}else r.forEach((c,p)=>u[Number(p)]=Number(c));let a=[];return u.forEach(c=>a.push(c)),{mode:t.mode,value:o,pads:a}}else return t},ju=(e,t)=>{sp(e.inputs);let r=fp(e.inputs,t);e.compute(mp(e.inputs,r),{inputs:[0]})}});var Nn,Yu,Zu,Xu,Qu,hp,gp,Ju,ed,td,rd,nd,od,id,ad,sd,ud,dd,ld,cd=Y(()=>{"use strict";$r();ye();Se();_e();Nn=e=>{if(vr.webgpu.validateInputContent&&(!e||e.length!==1))throw new Error("Pool ops requires 1 input.")},Yu=(e,t,r)=>{let o=t.format==="NHWC",i=e.dims.slice();o&&i.splice(1,0,i.pop());let u=Object.hasOwnProperty.call(t,"dilations"),a=t.kernelShape.slice(),c=t.strides.slice(),p=u?t.dilations.slice():[],h=t.pads.slice();nr.adjustPoolAttributes(r,i,a,c,p,h);let d=nr.computePoolOutputShape(r,i,c,p,a,h,t.autoPad),y=Object.assign({},t);u?Object.assign(y,{kernelShape:a,strides:c,pads:h,dilations:p,cacheKey:t.cacheKey}):Object.assign(y,{kernelShape:a,strides:c,pads:h,cacheKey:t.cacheKey});let w=d.slice();return w.push(w.splice(1,1)[0]),[y,o?w:d]},Zu=(e,t)=>{let r=t.format==="NHWC",o=M.size(e),i=M.size(t.kernelShape),u=[{type:12,data:o},{type:12,data:i}],a=[{name:"outputSize",type:"u32"},{name:"kernelSize",type:"u32"}];if(t.kernelShape.length<=2){let c=t.kernelShape[t.kernelShape.length-1],p=t.strides[t.strides.length-1],h=t.pads[t.pads.length/2-1],d=t.pads[t.pads.length-1],y=!!(h+d);u.push({type:12,data:c},{type:12,data:p},{type:12,data:h},{type:12,data:d}),a.push({name:"kw",type:"u32"},{name:"sw",type:"u32"},{name:"pwStart",type:"u32"},{name:"pwEnd",type:"u32"});let w=!1;if(t.kernelShape.length===2){let _=t.kernelShape[t.kernelShape.length-2],v=t.strides[t.strides.length-2],S=t.pads[t.pads.length/2-2],A=t.pads[t.pads.length-2];w=!!(S+A),u.push({type:12,data:_},{type:12,data:v},{type:12,data:S},{type:12,data:A}),a.push({name:"kh",type:"u32"},{name:"sh",type:"u32"},{name:"phStart",type:"u32"},{name:"phEnd",type:"u32"})}return[u,a,!0,y,w]}else{if(r)throw new Error("Pooling with kernelShape.length > 2 is not supported for NHWC format.");let c=M.computeStrides(t.kernelShape);u.push({type:12,data:c},{type:12,data:t.pads},{type:12,data:t.strides}),a.push({name:"kernelStrides",type:"u32",length:c.length},{name:"pads",type:"u32",length:t.pads.length},{name:"strides",type:"u32",length:t.strides.length});let p=t.pads.reduce((h,d)=>h+d);return[u,a,!!p,!1,!1]}},Xu=(e,t,r,o,i,u,a,c,p,h,d,y)=>{let w=i.format==="NHWC",_=t.type.value,v=j("output",t.type.tensor,o);if(i.kernelShape.length<=2){let S="",A="",I="",x=r-(w?2:1);if(d?S=`\n                for (var i: u32 = 0u; i < uniforms.kw; i++) {\n                  xIndices[${x}] = indices[${x}] * uniforms.sw - uniforms.pwStart + i;\n                  if (xIndices[${x}] < 0 || xIndices[${x}]\n                      >= uniforms.x_shape[${x}]) {\n                    pad++;\n                    continue;\n                  }\n                  let x_val = x[${t.indicesToOffset("xIndices")}];\n                  ${u}\n                }`:S=`\n                for (var i: u32 = 0u; i < uniforms.kw; i++) {\n                  xIndices[${x}] = indices[${x}] * uniforms.sw - uniforms.pwStart + i;\n                  let x_val = x[${t.indicesToOffset("xIndices")}];\n                  ${u}\n                }`,i.kernelShape.length===2){let P=r-(w?3:2);y?A=`\n                for (var j: u32 = 0u; j < uniforms.kh; j++) {\n                  xIndices[${P}] = indices[${P}] * uniforms.sh - uniforms.phStart + j;\n                  if (xIndices[${P}] < 0 || xIndices[${P}] >= uniforms.x_shape[${P}]) {\n                    pad += i32(uniforms.kw);\n                    continue;\n                  }\n              `:A=`\n                for (var j: u32 = 0u; j < uniforms.kh; j++) {\n                  xIndices[${P}] = indices[${P}] * uniforms.sh - uniforms.phStart + j;\n                `,I=`\n              }\n            `}return`\n            ${e.registerUniforms(p).declareVariables(t,v)}\n\n            ${e.mainStart()}\n              ${e.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.outputSize")}\n\n              let indices = ${v.offsetToIndices("global_idx")};\n              var xIndices = ${v.offsetToIndices("global_idx")};\n\n              var value = ${_}(${c});\n              var pad = 0;\n              ${A}\n              ${S}\n              ${I}\n              ${a}\n\n              output[global_idx] = value;\n            }`}else{if(w)throw new Error("Pooling with kernelShape.length > 2 is not supported for NHWC format.");let S=i.kernelShape.length,A=i.pads.length,I="";return h?I=`\n                if (xIndices[j] >= uniforms.x_shape[j]) {\n                  pad++;\n                  isPad = true;\n                  break;\n                }\n              }\n              if (!isPad) {\n                let x_val = x[${t.indicesToOffset("xIndices")}];\n                ${u}\n              }`:I=`\n              }\n              let x_val = x[${t.indicesToOffset("xIndices")}];\n              ${u}\n            `,`\n            ${e.registerUniforms(p).declareVariables(t,v)}\n\n            ${e.mainStart()}\n              ${e.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.outputSize")}\n              let indices = ${v.offsetToIndices("global_idx")};\n              var xIndices = ${v.offsetToIndices("global_idx")};\n\n              var offsets: array<u32, ${S}>;\n\n              var value = ${_}(${c});\n              var pad = 0;\n              var isPad = false;\n\n              for (var i: u32 = 0u; i < uniforms.kernelSize; i++) {\n                var offset = i;\n                for (var j = 0u; j < ${S-1}u; j++) {\n                  offsets[j] = offset / ${fe("uniforms.kernelStrides","j",S)};\n                  offset -= offsets[j] * ${fe("uniforms.kernelStrides","j",S)};\n                }\n                offsets[${S-1}] = offset;\n\n                isPad = false;\n                for (var j = ${r-S}u; j < ${r}u; j++) {\n                  xIndices[j] = indices[j] * ${fe("uniforms.strides",`j - ${r-S}u`,S)}\n                    + offsets[j - ${r-S}u] - ${fe("uniforms.pads","j - 2u",A)};\n                  ${I}\n              }\n              ${a}\n\n              output[global_idx] = value;\n            }`}},Qu=e=>`${e.format};${e.ceilMode};${e.autoPad};${e.kernelShape.length}`,hp=e=>`${Qu(e)};${e.countIncludePad}`,gp=e=>`${Qu(e)};${e.storageOrder};${e.dilations}`,Ju=e=>({format:e.format,autoPad:["NOTSET","VALID","SAME_UPPER","SAME_LOWER"][e.auto_pad],ceilMode:e.ceil_mode,kernelShape:e.kernel_shape,strides:e.strides,pads:e.pads}),ed=(e,t,r,o)=>{let[i,u]=Yu(t,o,r),a=U("x",t.dataType,t.dims.length),c=a.type.value,p="value += x_val;",h="";i.countIncludePad?h+=`value /= ${c}(uniforms.kernelSize);`:h+=`value /= ${c}(i32(uniforms.kernelSize) - pad);`;let[d,y,w,_,v]=Zu(u,i);d.push(...Z(t.dims,u));let S=["rank"];return{name:e,shaderCache:{hint:`${o.cacheKey};${w};${_};${v}`,inputDependencies:S},getRunData:()=>({outputs:[{dims:u,dataType:t.dataType}],dispatchGroup:{x:Math.ceil(M.size(u)/64)},programUniforms:d}),getShaderSource:A=>Xu(A,a,t.dims.length,u.length,i,p,h,0,y,w,_,v)}},td=e=>{let t=e.count_include_pad!==0,r=Ju(e);if(r.ceilMode!==0)throw new Error("using ceil() in shape computation is not yet supported for AveragePool");let o={countIncludePad:t,...r,cacheKey:""};return{...o,cacheKey:hp(o)}},rd=(e,t)=>{Nn(e.inputs),e.compute(ed("AveragePool",e.inputs[0],!1,t))},nd={autoPad:"",ceilMode:0,countIncludePad:!1,kernelShape:[],strides:[],pads:[],storageOrder:0,dilations:[]},od=e=>{let t=e.format;return{format:t,...nd,cacheKey:t}},id=(e,t)=>{Nn(e.inputs),e.compute(ed("GlobalAveragePool",e.inputs[0],!0,t))},ad=(e,t,r,o)=>{let[i,u]=Yu(t,o,r),a=`\n      value = max(x_val, value);\n    `,c="",p=U("x",t.dataType,t.dims.length),h=["rank"],[d,y,w,_,v]=Zu(u,i);return d.push(...Z(t.dims,u)),{name:e,shaderCache:{hint:`${o.cacheKey};${w};${_};${v}`,inputDependencies:h},getRunData:()=>({outputs:[{dims:u,dataType:t.dataType}],dispatchGroup:{x:Math.ceil(M.size(u)/64)},programUniforms:d}),getShaderSource:S=>Xu(S,p,t.dims.length,u.length,i,a,c,t.dataType===10?-65504:-1e5,y,w,_,v)}},sd=(e,t)=>{Nn(e.inputs),e.compute(ad("MaxPool",e.inputs[0],!1,t))},ud=e=>{let t=e.storage_order,r=e.dilations,o=Ju(e);if(t!==0)throw new Error("column major storage order is not yet supported for MaxPool");if(o.ceilMode!==0)throw new Error("using ceil() in shape computation is not yet supported for MaxPool");let i={storageOrder:t,dilations:r,...o,cacheKey:""};return{...i,cacheKey:gp(i)}},dd=e=>{let t=e.format;return{format:t,...nd,cacheKey:t}},ld=(e,t)=>{Nn(e.inputs),e.compute(ad("GlobalMaxPool",e.inputs[0],!0,t))}});var bp,wp,pd,md=Y(()=>{"use strict";$r();ye();_e();bp=(e,t,r)=>{let o=e===t,i=e<t&&r<0,u=e>t&&r>0;if(o||i||u)throw new Error("Range these inputs\' contents are invalid.")},wp=(e,t,r,o)=>{let i=Math.abs(Math.ceil((t-e)/r)),u=[i],a=i,c=[{type:12,data:a},{type:o,data:e},{type:o,data:r},...Z(u)],p=h=>{let d=j("output",o,u.length),y=d.type.value,w=[{name:"outputSize",type:"u32"},{name:"start",type:y},{name:"delta",type:y}];return`\n        ${h.registerUniforms(w).declareVariables(d)}\n        ${h.mainStart()}\n        ${h.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.outputSize")}\n        output[global_idx] = uniforms.start + ${y}(global_idx) * uniforms.delta;\n      }`};return{name:"Range",shaderCache:{hint:`${o}`},getShaderSource:p,getRunData:()=>({outputs:[{dims:u,dataType:o}],dispatchGroup:{x:Math.ceil(a/64)},programUniforms:c})}},pd=e=>{let t=0,r=0,o=0;e.inputs[0].dataType===6?(t=e.inputs[0].getInt32Array()[0],r=e.inputs[1].getInt32Array()[0],o=e.inputs[2].getInt32Array()[0]):e.inputs[0].dataType===1&&(t=e.inputs[0].getFloat32Array()[0],r=e.inputs[1].getFloat32Array()[0],o=e.inputs[2].getFloat32Array()[0]),vr.webgpu.validateInputContent&&bp(t,r,o),e.compute(wp(t,r,o,e.inputs[0].dataType),{inputs:[]})}});var vp,$p,_p,Sp,xp,Cp,Ap,Ip,Tp,Ep,Pp,fd,kp,Op,Rp,Bp,Dp,hd,gd,yd=Y(()=>{"use strict";ye();Se();Ze();_e();vp=(e,t)=>{if(e.every(r=>r>0||(()=>{throw new Error("Resize requires scales input values to be positive")})),e.length>0){if(t.mode==="linear"){if(!(e.length===2||e.length===3||e.length===4&&e[0]===1&&e[1]===1||e.length===4&&e[0]===1&&e[3]===1||e.length===5&&e[0]===1&&e[1]===1))throw new Error(`For linear mode, Resize requires scales to be 2D, 3D, 4D with either two outermost or one innermost and\n            one outermost scale values equal to 1, or 5D with two outermost scale values equal to 1`)}else if(t.mode==="cubic"&&!(e.length===2||e.length===4&&e[0]===1&&e[1]===1||e.length===4&&e[0]===1&&e[3]===1))throw new Error("Resize requires scales input size to be 2 or 4 for cubic mode")}},$p=(e,t,r)=>{t.every(i=>i>=0&&i<r||(()=>{throw new Error("Resize requires axes input values to be positive and less than rank")}));let o=new Array(r).fill(1);return t.forEach((i,u)=>o[i]=e[u]),o},_p=(e,t,r,o,i,u)=>{let[a,c,p]=r>10?[1,2,3]:[-1,e.length>1?1:-1,-1],h=e[0].dims.length;if(a>0&&e.length>a&&e[a].dims.length>0)e[a].getFloat32Array().forEach(d=>u.push(d));else if(t.coordinateTransformMode==="tf_crop_and_resize")throw new Error("Resize requires RoI input to be specified when coordinateTransformMode is tfCropAndResize");if(c>0&&e.length>c&&e[c].dims.length>0){if(e[c].getFloat32Array().forEach(d=>o.push(d)),o.length!==0&&o.length!==h&&r>=18&&o.length!==t.axes.length)throw new Error("Resize requires scales input size to be same as input rank or axes size for opset 18 and up");vp(o,t),t.axes.length>0&&$p(o,t.axes,h).forEach((d,y)=>o[y]=d)}if(p>0&&e.length>p&&(e[p].getBigInt64Array().forEach(d=>i.push(Number(d))),i.length!==h||r>=18&&i.length===t.axes.length))throw new Error("Resize requires sizes input size to be same as input rank or axes size for opset 18 and up");if(t.axes.length>0){if(o.length!==t.axes.length)throw new Error(\'Resize requires "scales" input size to be of axes rank when axes attributes is specified\');if(i.length!==t.axes.length)throw new Error(\'Resize requires "sizes" input size to be of rank axes rank when axes attributes is specified\')}if(typeof o<"u"&&typeof i<"u"&&o.length>0&&i.length>h)throw new Error("Resize requires only of scales or sizes to be specified")},Sp=(e,t)=>`fn getOriginalCoordinateFromResizedCoordinate(xResized: u32, xScale: f32, lengthResized: u32,\n     lengthOriginal: u32, roiStart: f32, roiEnd: f32) -> ${t} { `+(()=>{switch(e){case"asymmetric":return`return ${t}(xResized) / ${t}(xScale);`;case"pytorch_half_pixel":return`if (lengthResized > 1) {\n                    return (${t}(xResized) + 0.5) / ${t}(xScale) - 0.5;\n                  } else {\n                    return 0.0;\n                  }`;case"tf_half_pixel_for_nn":return`return (${t}(xResized) + 0.5) / ${t}(xScale);`;case"align_corners":return`if (lengthResized == 1) {\n                    return 0.0;\n                  } else {\n                    // The whole part and the fractional part are calculated separately due to inaccuracy of floating\n                    // point division. As an example, f32(21) / f32(7) may evaluate to 2.99... instead of 3, causing an\n                    // offset-by-one error later in floor().\n                    let whole = ${t}(xResized * (lengthOriginal - 1) / (lengthResized - 1));\n                    let fract =\n                        ${t}(xResized * (lengthOriginal - 1) % (lengthResized - 1)) / ${t}(lengthResized - 1);\n                    return whole + fract;\n                  }`;case"tf_crop_and_resize":return`if (lengthResized > 1) {\n                    return ${t}(roiStart) * ${t}(lengthOriginal - 1) +\n                        (${t}(xResized) * ${t}(roiEnd - roiStart) * ${t}(lengthOriginal - 1)) /\n                        ${t}(lengthResized - 1);\n                  } else {\n                    return 0.5 * ${t}(roiStart + roiEnd) * ${t}(lengthOriginal - 1);\n                  }`;case"half_pixel_symmetric":return`const outputWidth = ${t}xScale * ${t}(lengthResized);\n                  const adjustment = ${t}(lengthResized) / outputWidth;\n                  const center = ${t}(lengthOriginal) / 2;\n                  const offset = center * (1 - adjustment);\n                  return offset + ((${t}(xResized) + 0.5) / ${t}(xScale)) - 0.5;`;case"half_pixel":return`return ((${t}(xResized) + 0.5) / ${t}(xScale)) - 0.5;`;default:throw new Error(`Coordinate transform mode ${e} is not supported`)}})()+"}",xp=(e,t,r)=>`fn getNearestPixelFromOriginal(xOriginal: ${r}, isDownSample: bool) -> ${r} {`+(()=>{switch(e){case"round_prefer_ceil":return"if (fract(xOriginal) == 0.5) {             return ceil(xOriginal);           } else {             return round(xOriginal);           }";case"floor":return"return floor(xOriginal);";case"ceil":return"return ceil(xOriginal);";case"round_prefer_floor":return"if (fract(xOriginal) == 0.5) {                     return floor(xOriginal);                   } else {                     return round(xOriginal);                   }";case"simple":default:if(t<11)return"if (isDownSample)                     {                       return ceil(xOriginal);                     } else {                       return xOriginal;                     }";throw new Error(`Nearest mode ${e} is not supported`)}})()+"}",Cp=(e,t,r)=>{let o=new Array(r).fill(0).concat(new Array(r).fill(1)),i=e.length===0?o:e.slice();return t.length>0?(t.forEach((u,a)=>{o[u]=i[a],o[a+r]=i[t.length+a]}),o):i},Ap=(e,t,r,o)=>{let i=[];if(r.length>0)if(o.length>0){if(e.forEach(u=>i.push(u)),Math.max(...o)>e.length)throw new Error("axes is out of bound");o.forEach((u,a)=>i[u]=r[a])}else r.forEach(u=>i.push(u));else{if(t.length===0)throw new Error("Resize requires either scales or sizes.");i=e.map((u,a)=>Math.round(u*t[a]))}return i},Ip=(e,t,r)=>{let o=(()=>{switch(r.keepAspectRatioPolicy){case"not_larger":return r.axes.length>0?Math.min(...r.axes.map(u=>t[u]),Number.MAX_VALUE):Math.min(...t,Number.MAX_VALUE);case"not_smaller":return r.axes.length>0?Math.max(...r.axes.map(u=>t[u]),Number.MIN_VALUE):Math.max(...t,Number.MIN_VALUE);default:throw new Error(`Keep aspect ratio policy ${r.keepAspectRatioPolicy} is not supported`)}})();t.fill(1,0,t.length);let i=e.slice();return r.axes.length>0?(r.axes.forEach(u=>t[u]=o),r.axes.forEach(u=>i[u]=Math.round(e[u]*t[u]))):(t.fill(o,0,t.length),i.forEach((u,a)=>i[a]=Math.round(u*t[a]))),i},Tp=(e,t,r,o,i)=>`\n    fn calculateOriginalIndicesFromOutputIndices(output_indices: ${e.type.indices}) -> array<${e.type.value}, ${r.length}> {\n      var original_indices: array<${e.type.value}, ${r.length}>;\n      for (var i:u32 = 0; i < ${r.length}; i++) {\n        var output_index = ${e.indicesGet("output_indices","i")};\n        var scale = ${fe("uniforms.scales","i",o)};\n        var roi_low = ${fe("uniforms.roi","i",i)};\n        var roi_hi = ${fe("uniforms.roi",`i + ${t.length}`,i)};\n        if (scale == 1.0) {\n          original_indices[i] = ${e.type.value}(output_index);\n        } else {\n          var input_shape_i = ${fe("uniforms.input_shape","i",t.length)};\n          var output_shape_i = ${fe("uniforms.output_shape","i",r.length)};\n          original_indices[i] = getOriginalCoordinateFromResizedCoordinate(output_index, scale, output_shape_i,\n                                                                           input_shape_i, roi_low, roi_hi);\n        }\n      }\n      return original_indices;\n    }`,Ep=(e,t,r,o,i,u,a)=>`\n    fn calculateInputIndicesFromOutputIndices(output_indices: ${t.type.indices}) -> ${e.type.indices} {\n      var input_indices: ${e.type.indices};\n      for (var i:u32 = 0; i < ${o.length}; i++) {\n        var output_index = ${t.indicesGet("output_indices","i")};\n        var input_index: u32;\n        var scale = ${fe("uniforms.scales","i",i)};\n        if (scale == 1.0) {\n          input_index = output_index;\n        } else {\n          var roi_low = ${fe("uniforms.roi","i",u)};\n          var roi_hi = ${fe("uniforms.roi",`i + ${r.length}`,u)};\n          var input_shape_i = ${fe("uniforms.input_shape","i",r.length)};\n          var output_shape_i = ${fe("uniforms.output_shape","i",o.length)};\n          var original_idx = getOriginalCoordinateFromResizedCoordinate(output_index, scale, output_shape_i,\n                                                                        input_shape_i, roi_low, roi_hi);\n          if (!${a} || (original_idx >= 0 && original_idx < ${t.type.value}(input_shape_i))) {\n            if (original_idx < 0) {\n              input_index = 0;\n            } else if (original_idx > ${t.type.value}(input_shape_i - 1)) {\n              input_index = input_shape_i - 1;\n            } else {\n              input_index = u32(getNearestPixelFromOriginal(original_idx, scale < 1));\n            }\n          } else {\n            input_index = u32(original_idx);\n          }\n        }\n        ${e.indicesSet("input_indices","i"," input_index")}\n      }\n      return input_indices;\n    }`,Pp=(e,t)=>`\n    fn checkInputIndices(input_indices: ${e.type.indices}) -> bool {\n      for (var i:u32 = 0; i < ${t.length}; i++) {\n        var input_index = ${e.indicesGet("input_indices","i")};\n        if (input_index < 0 || input_index >= ${fe("uniforms.input_shape","i",t.length)}) {\n          return false;\n        }\n      }\n      return true;\n    }`,fd=(e,t,r,o)=>e.rank>o?`\n    ${e.indicesSet("input_indices",t,"channel")};\n    ${e.indicesSet("input_indices",r,"batch")};\n`:"",kp=(e,t,r,o,i)=>{let[a,c,p,h]=r.length===2?[-1,0,1,-1]:[0,2,3,1],d=e.type.value;return`\n    fn getInputValue(batch: u32, channel: u32, row: u32, col: u32) -> ${d} {\n      var input_indices: ${e.type.indices};\n      ${e.indicesSet("input_indices",c,`max(0, min(row, ${r[c]} - 1))`)};\n      ${e.indicesSet("input_indices",p,`max(0, min(col, ${r[p]} - 1))`)};\n      ${fd(e,h,a,2)}\n      return ${e.getByIndices("input_indices")};\n    }\n\n    fn bilinearInterpolation(output_indices: ${t.type.indices}) -> ${d} {\n      var originalIndices = calculateOriginalIndicesFromOutputIndices(output_indices);\n      var row:${d} = originalIndices[${c}];\n      var col:${d} = originalIndices[${p}];\n      ${o?`if (row < 0 || row > (${r[c]} - 1) || col < 0 || col > (${r[p]} - 1)) {\n        return ${i};\n      }`:""};\n      row = max(0, min(row, ${r[c]} - 1));\n      col = max(0, min(col, ${r[p]} - 1));\n      var row1: u32 = u32(row);\n      var col1: u32 = u32(col);\n      var row2: u32 = u32(row + 1);\n      var col2: u32 = u32(col + 1);\n      var channel: u32 = ${r.length>2?`u32(originalIndices[${h}])`:"0"};\n      var batch: u32 =  ${r.length>2?`u32(originalIndices[${a}])`:"0"};\n      var x11: ${d} = getInputValue(batch, channel, row1, col1);\n      var x12: ${d} = getInputValue(batch, channel, row1, col2);\n      var x21: ${d} = getInputValue(batch, channel, row2, col1);\n      var x22: ${d} = getInputValue(batch, channel, row2, col2);\n      var dx1: ${d} = abs(row - ${d}(row1));\n      var dx2: ${d} = abs(${d}(row2) - row);\n      var dy1: ${d} = abs(col - ${d}(col1));\n      var dy2: ${d} = abs(${d}(col2) - col);\n      if (row1 == row2) {\n        dx1 = 0.5;\n        dx2 = 0.5;\n      }\n      if (col1 == col2) {\n        dy1 = 0.5;\n        dy2 = 0.5;\n      }\n      return (x11 * dx2 * dy2 + x12 * dx2 * dy1 + x21 * dx1 * dy2 + x22 * dx1 * dy1);\n    }`},Op=(e,t,r,o,i,u,a,c,p,h)=>{let d=r.length===2,y=!0,[w,_]=d?[0,1]:y?[2,3]:[1,2],v=e.type.value,S=A=>{let I=A===w?"row":"col";return`\n      fn ${I}CubicInterpolation(input_indices: ${e.type.indices}, output_indices: ${t.type.indices}) -> ${v} {\n        var output_index = ${t.indicesGet("output_indices",A)};\n        var originalIdx: ${v} = getOriginalCoordinateFromResizedCoordinate(output_index, ${i[A]},\n        ${o[A]}, ${r[A]}, ${u[A]}, ${u[A]} + ${r.length});\n        var fractOriginalIdx: ${v} = originalIdx - floor(originalIdx);\n        var coefs = getCubicInterpolationCoefs(fractOriginalIdx);\n\n        if (${c} && (originalIdx < 0 || originalIdx > (${r[A]} - 1))) {\n          return ${p};\n        }\n        var data: array<${v}, 4> = array<${v}, 4>(0.0, 0.0, 0.0, 0.0);\n        for (var i: i32 = -1; i < 3; i++) {\n          var ${I}: ${v} = originalIdx + ${v}(i);\n          if (${I} < 0 || ${I} >= ${r[A]}) {\n            ${(()=>h?`coefs[i + 1] = 0.0;\n                        continue;`:c?`return ${p};`:`${I} = max(0, min(${I}, ${r[A]} - 1));`)()};\n          }\n        var input_indices_copy: ${e.type.indices} = input_indices;\n          ${e.indicesSet("input_indices_copy",A,`u32(${I})`)};\n          data[i + 1] = ${A===w?e.getByIndices("input_indices_copy"):"rowCubicInterpolation(input_indices_copy, output_indices)"};\n        }\n        return cubicInterpolation1D(data, coefs);\n      }`};return`\n    ${S(w)};\n    ${S(_)};\n  fn getCubicInterpolationCoefs(s: ${v}) -> array<${v}, 4> {\n    var absS = abs(s);\n    var coeffs: array<${v}, 4> = array<${v}, 4>(0.0, 0.0, 0.0, 0.0);\n    var oneMinusAbsS: ${v} = 1.0 - absS;\n    var twoMinusAbsS: ${v} = 2.0 - absS;\n    var onePlusAbsS: ${v} = 1.0 + absS;\n    coeffs[0] = ((${a} * onePlusAbsS - 5 * ${a}) * onePlusAbsS + 8 * ${a}) * onePlusAbsS - 4 * ${a};\n    coeffs[1] = ((${a} + 2) * absS - (${a} + 3)) * absS * absS + 1;\n    coeffs[2] = ((${a} + 2) * oneMinusAbsS - (${a} + 3)) * oneMinusAbsS * oneMinusAbsS + 1;\n    coeffs[3] = ((${a} * twoMinusAbsS - 5 * ${a}) * twoMinusAbsS + 8 * ${a}) * twoMinusAbsS - 4 * ${a};\n    return coeffs;\n  }\n\n  fn cubicInterpolation1D(x: array<${v}, 4>, coefs: array<${v}, 4>) -> ${v} {\n    var coefsSum: ${v} = coefs[0] + coefs[1] + coefs[2] + coefs[3];\n    return (x[0] * coefs[0] + x[1] * coefs[1]+ x[2] * coefs[2]+ x[3] * coefs[3]) / coefsSum;\n  }\n\n  fn bicubicInterpolation(output_indices: ${t.type.indices}) -> ${v} {\n    var input_indices: ${e.type.indices} = output_indices;\n    return colCubicInterpolation(input_indices, output_indices);\n  }\n    `},Rp=(e,t,r,o,i)=>{let[a,c,p,h,d]=r.length===3?[-1,0,1,2,-1]:[0,2,3,4,1],y=e.type.value;return`\n    fn getInputValue(batch: u32, channel: u32, depth:u32, height: u32, width: u32) -> ${y} {\n      var input_indices: ${e.type.indices};\n      ${e.indicesSet("input_indices",c,`max(0, min(depth, ${r[c]} - 1))`)};\n      ${e.indicesSet("input_indices",p,`max(0, min(height, ${r[p]} - 1))`)};\n      ${e.indicesSet("input_indices",h,`max(0, min(width, ${r[h]} - 1))`)};\n      ${fd(e,d,a,3)}\n      return ${e.getByIndices("input_indices")};\n    }\n\n    fn trilinearInterpolation(output_indices: ${t.type.indices}) -> ${y} {\n      var originalIndices = calculateOriginalIndicesFromOutputIndices(output_indices);\n      var depth:${y} = originalIndices[${c}];\n      var height:${y} = originalIndices[${p}];\n      var width:${y} = originalIndices[${h}];\n      ${o?`if (depth < 0 || depth > (${r[c]} - 1) || height < 0 || height > (${r[p]} - 1) || width < 0 || (width > ${r[h]} - 1)) {\n      return ${i};\n        }`:""};\n\n    depth = max(0, min(depth, ${r[c]} - 1));\n      height = max(0, min(height, ${r[p]} - 1));\n      width = max(0, min(width, ${r[h]} - 1));\n      var depth1: u32 = u32(depth);\n      var height1: u32 = u32(height);\n      var width1: u32 = u32(width);\n      var depth2: u32 = u32(depth + 1);\n      var height2: u32 = u32(height + 1);\n      var width2: u32 = u32(width + 1);\n      var channel: u32 = ${r.length>3?`u32(originalIndices[${d}])`:"0"};\n      var batch: u32 =  ${r.length>3?`u32(originalIndices[${a}])`:"0"};\n\n      var x111: ${y} = getInputValue(batch, channel, depth1, height1, width1);\n      var x112: ${y} = getInputValue(batch, channel, depth1, height1, width2);\n      var x121: ${y} = getInputValue(batch, channel, depth1, height2, width1);\n      var x122: ${y} = getInputValue(batch, channel, depth1, height2, width2);\n      var x211: ${y} = getInputValue(batch, channel, depth2, height1, width1);\n      var x212: ${y} = getInputValue(batch, channel, depth2, height1, width2);\n      var x221: ${y} = getInputValue(batch, channel, depth2, height2, width1);\n      var x222: ${y} = getInputValue(batch, channel, depth2, height2, width2);\n      var dx1: ${y} = abs(depth - ${y}(depth1));\n      var dx2: ${y} = abs(${y}(depth2) - depth);\n      var dy1: ${y} = abs(height - ${y}(height1));\n      var dy2: ${y} = abs(${y}(height2) - height);\n      var dz1: ${y} = abs(width - ${y}(width1));\n      var dz2: ${y} = abs(${y}(width2) - width);\n      if (depth1 == depth2) {\n        dx1 = 0.5;\n        dx2 = 0.5;\n      }\n      if (height1 == height2) {\n        dy1 = 0.5;\n        dy2 = 0.5;\n      }\n      if (width1 == width2) {\n        dz1 = 0.5;\n        dz2 = 0.5;\n      }\n      return (x111 * dx2 * dy2 * dz2 + x112 * dx2 * dy2 * dz1 + x121 * dx2 * dy1 *dz2 + x122 * dx2 * dy1 * dz1 +\n              x211 * dx1 * dy2 * dz2 + x212 * dx1 * dy2 * dz1 + x221 * dx1 * dy1 *dz2 + x222 * dx1 * dy1 * dz1);\n    }`},Bp=(e,t,r,o,i,u)=>{let a=e.dims,c=Cp(u,t.axes,a.length),p=Ap(a,o,i,t.axes),h=o.slice();o.length===0&&(h=a.map((x,E)=>x===0?1:p[E]/x),t.keepAspectRatioPolicy!=="stretch"&&(p=Ip(a,h,t)));let d=j("output",e.dataType,p.length),y=U("input",e.dataType,a.length),w=M.size(p),_=a.length===p.length&&a.every((x,E)=>x===p[E]),v=t.coordinateTransformMode==="tf_crop_and_resize",S=t.extrapolationValue,A=y.type.value,I=x=>`\n      ${_?"":`\n      ${Sp(t.coordinateTransformMode,A)};\n      ${(()=>{switch(t.mode){case"nearest":return`\n              ${Pp(y,a)};\n              ${xp(t.nearestMode,r,A)};\n              ${Ep(y,d,a,p,h.length,c.length,v)};\n              `;case"linear":return`\n              ${Tp(d,a,p,h.length,c.length)};\n              ${(()=>{if(a.length===2||a.length===4)return`${kp(y,d,a,v,S)}`;if(a.length===3||a.length===5)return`${Rp(y,d,a,v,S)}`;throw Error("Linear mode only supports input dims 2, 3, 4 and 5 are supported in linear mode.")})()};\n            `;case"cubic":return`\n            ${(()=>{if(a.length===2||a.length===4)return`${Op(y,d,a,p,h,c,t.cubicCoeffA,v,t.extrapolationValue,t.excludeOutside)}`;throw Error("Cubic mode only supports input dims 2 and 4 are supported in linear mode.")})()};\n            `;default:throw Error("Invalid resize mode")}})()};\n      `}\n      ${x.registerUniform("output_size","u32").registerUniform("scales","f32",h.length).registerUniform("roi","f32",c.length).declareVariables(y,d)}\n      ${x.mainStart()}\n        ${x.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.output_size")}\n        ${_?"output[global_idx] = input[global_idx];":`\n        let output_indices = ${d.offsetToIndices("global_idx")};\n        var input_indices: ${y.type.indices};\n        ${(()=>{switch(t.mode){case"nearest":return`input_indices = calculateInputIndicesFromOutputIndices(output_indices);\n                if (checkInputIndices(input_indices)) {\n                  output[global_idx] = ${y.getByIndices("input_indices")};\n                } else {\n                  output[global_idx] = ${t.extrapolationValue};\n                }`;case"linear":return`output[global_idx] = ${a.length===2||a.length===4?"bilinearInterpolation":"trilinearInterpolation"}(output_indices);`;case"cubic":return"output[global_idx] = bicubicInterpolation(output_indices);";default:throw Error(`Unsupported resize mode: ${t.mode}`)}})()};\n`}\n      }`;return{name:"Resize",shaderCache:{hint:`${t.cacheKey}|${r}|${h.length>0?h:""}|${i.length>0?i:""}|${c.length>0?c:""}|${_}|${a}`,inputDependencies:["rank"]},getShaderSource:I,getRunData:()=>({outputs:[{dims:p,dataType:e.dataType}],dispatchGroup:{x:Math.ceil(w/64)},programUniforms:[{type:12,data:w},{type:1,data:h},{type:1,data:c},...Z(a,p)]})}},Dp=e=>{let t=e.customDataBuffer;return new Uint32Array(t,t.byteOffset,1)[0]},hd=(e,t)=>{let r=[],o=[],i=[],u=Dp(e);if(t.antialias!==0)throw Error("Only default value (0) for Antialias attribute is supported");_p(e.inputs,t,u,r,o,i),e.compute(Bp(e.inputs[0],t,u,r,o,i),{inputs:[0]})},gd=e=>{let t=e.antialias,r=e.axes,o=e.coordinateTransformMode,i=e.cubicCoeffA,u=e.excludeOutside!==0,a=e.extrapolationValue,c=e.keepAspectRatioPolicy,p=e.mode,h=e.nearestMode===""?"simple":e.nearestMode;return ve({antialias:t,axes:r,coordinateTransformMode:o,cubicCoeffA:i,excludeOutside:u,extrapolationValue:a,keepAspectRatioPolicy:c,mode:p,nearestMode:h})}});var zp,Mp,bd,wd=Y(()=>{"use strict";ye();Se();Ze();_e();zp=(e,t)=>{let[r,o,i,u]=e,{numHeads:a,rotaryEmbeddingDim:c}=t;if(r.dims.length!==3&&r.dims.length!==4)throw new Error(`Input \'x\' is expected to have 3 or 4 dimensions, got ${r.dims.length}`);if(!M.areEqual(o.dims,[])&&!M.areEqual(o.dims,[1])&&o.dims.length!==2)throw new Error(`Input \'position_ids\' is expected to have 0, 1, or 2 dimensions, got ${o.dims.length}`);if(i.dims.length!==2)throw new Error(`Input \'cos_cache\' is expected to have 2 dimensions, got ${i.dims.length}`);if(u.dims.length!==2)throw new Error(`Input \'sin_cache\' is expected to have 2 dimensions, got ${u.dims.length}`);if(!M.areEqual(i.dims,u.dims))throw new Error("Inputs \'cos_cache\' and \'sin_cache\' are expected to have the same shape");if(c>0&&a===0)throw new Error("num_heads must be provided if rotary_embedding_dim is specified");let p=r.dims[0],h=r.dims[r.dims.length-2],d=i.dims[0],y=M.sizeFromDimension(r.dims,1)/h,w=c===0?i.dims[1]*2:y/a;if(c>w)throw new Error("rotary_embedding_dim must be less than or equal to head_size");if(o.dims.length===2){if(p!==o.dims[0])throw new Error(`Input \'position_ids\' dimension 0 should be of size batch_size, got ${o.dims[0]}`);if(h!==o.dims[1])throw new Error(`Input \'position_ids\' dimension 1 should be of size sequence_length, got ${o.dims[1]}`)}if(w/2!==i.dims[1]&&c/2!==i.dims[1])throw new Error(`Input \'cos_cache\' dimension 1 should be same as head_size / 2 or rotary_embedding_dim / 2, got ${i.dims[1]}`);if(h>d)throw new Error("Updating cos_cache and sin_cache in RotaryEmbedding is not currently supported")},Mp=(e,t)=>{let{interleaved:r,numHeads:o,rotaryEmbeddingDim:i,scale:u}=t,a=e[0].dims[0],c=M.sizeFromDimension(e[0].dims,1),p=e[0].dims[e[0].dims.length-2],h=c/p,d=e[2].dims[1],y=i===0?d*2:h/o,w=new Array(a,p,h/y,y-d),_=M.computeStrides(w),v=[{type:1,data:u},{type:12,data:w},{type:12,data:_},...e[0].dims.length===3?new Array({type:12,data:[c,h,y,1]}):[],...e[0].dims.length===4?new Array({type:12,data:[c,y,p*y,1]}):[],...Z(e[0].dims,e[1].dims,e[2].dims,e[3].dims,e[0].dims)],S=A=>{let I=U("input",e[0].dataType,e[0].dims.length),x=U("position_ids",e[1].dataType,e[1].dims.length),E=U("cos_cache",e[2].dataType,e[2].dims.length),P=U("sin_cache",e[3].dataType,e[3].dims.length),O=j("output",e[0].dataType,e[0].dims.length);return A.registerUniforms([{name:"scale",type:"f32"},{name:"global_shape",type:"u32",length:w.length},{name:"global_strides",type:"u32",length:_.length},{name:"input_output_strides",type:"u32",length:_.length}]),`\n        ${A.declareVariables(I,x,E,P,O)}\n\n        ${A.mainStart(or)}\n          let half_rotary_emb_dim = uniforms.${E.name}_shape[1];\n          let bsnh = global_idx / uniforms.global_strides % uniforms.global_shape;\n          let size = uniforms.global_shape[0] * uniforms.global_strides[0];\n          ${A.guardAgainstOutOfBoundsWorkgroupSizes("size")}\n\n          if (bsnh[3] < half_rotary_emb_dim) {\n            let position_ids_idx =\n                ${x.broadcastedIndicesToOffset("bsnh.xy",j("",x.type.tensor,2))};\n            let position_id =\n                u32(${x.getByOffset("position_ids_idx")}) + select(0, bsnh[1], position_ids_idx == 0);\n            let i = dot(bsnh, uniforms.input_output_strides) + select(0, bsnh[3], ${r});\n            let j = i + select(half_rotary_emb_dim, 1, ${r});\n            let re = ${I.getByOffset("i")} * ${E.get("position_id","bsnh[3]")} -\n                ${I.getByOffset("j")} * ${P.get("position_id","bsnh[3]")};\n            ${O.setByOffset("i","re")}\n            let im = ${I.getByOffset("i")} * ${P.get("position_id","bsnh[3]")} +\n                ${I.getByOffset("j")} * ${E.get("position_id","bsnh[3]")};\n            ${O.setByOffset("j","im")}\n          } else {\n            let k = dot(bsnh, uniforms.input_output_strides) + half_rotary_emb_dim;\n            ${O.setByOffset("k",I.getByOffset("k"))}\n          }\n        }`};return{name:"RotaryEmbedding",shaderCache:{hint:ve({interleaved:r}).cacheKey,inputDependencies:["rank","rank","rank","rank"]},getShaderSource:S,getRunData:()=>({outputs:[{dims:e[0].dims,dataType:e[0].dataType}],dispatchGroup:{x:Math.ceil(M.size(w)/or)},programUniforms:v})}},bd=(e,t)=>{zp(e.inputs,t),e.compute(Mp(e.inputs,t))}});var Up,Vp,vd,$d=Y(()=>{"use strict";ye();Se();_e();Up=e=>{if(!e||e.length<3)throw new Error("layerNorm requires at least 3 inputs.");let t=e[0],r=e[1],o=e[2];if(t.dataType!==r.dataType||t.dataType!==o.dataType)throw new Error("All inputs must have the same data type");if(t.dims.length!==3&&t.dims.length!==2)throw new Error("Input must be 2D or 3D");if(r.dims.length!==3&&r.dims.length!==2)throw new Error("Skip must be 2D or 3D");let i=t.dims[t.dims.length-1],u=t.dims[t.dims.length-2];if(r.dims[r.dims.length-1]!==i)throw new Error("Skip must have the same hidden size as input");if(r.dims[r.dims.length-2]!==u)throw new Error("Skip must have the same sequence length as input");if(o.dims.length!==1)throw new Error("Gamma must be 1D");if(o.dims[o.dims.length-1]!==i)throw new Error("Gamma must have the same hidden size as input");if(e.length>3){let a=e[3];if(a.dims.length!==1)throw new Error("Beta must be 1D");if(a.dims[a.dims.length-1]!==i)throw new Error("Beta must have the same hidden size as input")}if(e.length>4){let a=e[4];if(a.dims.length!==1)throw new Error("Bias must be 1D");if(a.dims[a.dims.length-1]!==i)throw new Error("Bias must have the same hidden size as input")}},Vp=(e,t,r,o)=>{let i=t.simplified,u=e[0].dims,a=M.size(u),c=u,p=a,h=u.slice(-1)[0],d=o?u.slice(0,-1).concat(1):[],y=!i&&e.length>3,w=e.length>4,_=o&&r>1,v=o&&r>2,S=r>3,A=Me(h),I=[{type:12,data:p},{type:12,data:A},{type:12,data:h},{type:1,data:t.epsilon}],x=P=>{let O=[{name:"output_size",type:"u32"},{name:"components",type:"u32"},{name:"hidden_size",type:"u32"},{name:"epsilon",type:"f32"}],R=[U("x",e[0].dataType,e[0].dims,A),U("skip",e[1].dataType,e[1].dims,A),U("gamma",e[2].dataType,e[2].dims,A)];y&&R.push(U("beta",e[3].dataType,e[3].dims,A)),w&&R.push(U("bias",e[4].dataType,e[4].dims,A)),R.push(j("output",e[0].dataType,c,A)),_&&R.push(j("mean_output",1,d)),v&&R.push(j("inv_std_output",1,d)),S&&R.push(j("input_skip_bias_sum",e[0].dataType,c,A));let L=De(e[0].dataType);return`\n\n      ${P.registerUniforms(O).declareVariables(...R)}\n\n      ${P.mainStart()}\n        ${P.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.output_size / uniforms.hidden_size")}\n        let hidden_size_vectorized: u32 = uniforms.hidden_size / uniforms.components;\n        let offset = global_idx * hidden_size_vectorized;\n        var sum = ${$t("f32",A)};\n        var squareSum = ${$t("f32",A)};\n        for (var i: u32 = 0; i < hidden_size_vectorized; i++) {\n          let skip_value = skip[offset + i];\n          let bias_value = ${w?"bias[i]":L+"(0.0)"};\n          let input_value = x[offset + i];\n          let value = input_value + skip_value + bias_value;\n          ${S?"input_skip_bias_sum[offset + i] = value;":""}\n          output[offset + i] = value;\n          let f32_value = ${ir(L,A,"value")};\n          sum += f32_value;\n          squareSum += f32_value * f32_value;\n        }\n        let mean = ${_t("sum",A)} / f32(uniforms.hidden_size);\n        let inv_std_dev = inverseSqrt(${_t("squareSum",A)} / f32(uniforms.hidden_size) ${i?"":"- mean * mean"} + uniforms.epsilon);\n        ${_?"mean_output[global_idx] = mean;":""}\n        ${v?"inv_std_output[global_idx] = inv_std_dev;":""}\n        for (var i: u32 = 0; i < hidden_size_vectorized; i++) {\n          output[offset + i] = (output[offset + i] ${i?"":`- ${L}(mean)`}) * ${L}(inv_std_dev) * gamma[i] ${y?"+ beta[i]":""};\n        }\n      }`},E=[{dims:c,dataType:e[0].dataType}];return r>1&&E.push({dims:d,dataType:1}),r>2&&E.push({dims:d,dataType:1}),r>3&&E.push({dims:u,dataType:e[0].dataType}),{name:"SkipLayerNormalization",shaderCache:{hint:`${A};${_};${v};${S}`,inputDependencies:e.map((P,O)=>"type")},getShaderSource:x,getRunData:()=>({outputs:E,dispatchGroup:{x:Math.ceil(p/h/64)},programUniforms:I})}},vd=(e,t)=>{Up(e.inputs);let o=[0];e.outputCount>1&&o.push(-3),e.outputCount>2&&o.push(-3),e.outputCount>3&&o.push(3),e.compute(Vp(e.inputs,t,e.outputCount,!1),{outputs:o})}});var Wp,Gn,Np,_d,Gp,Hp,Sd,xd,Cd=Y(()=>{"use strict";ye();Se();Ze();_e();Wp=(e,t)=>{if(!e||e.length<1)throw new Error("too few inputs");if(t.axes.length!==0){if(t.axes.length!==t.starts.length||t.axes.length!==t.ends.length)throw new Error("axes, starts and ends must have the same length")}else if(t.starts.length!==t.ends.length)throw new Error("starts and ends must have the same length");e.slice(1).forEach((r,o)=>{if(e[o+1].dataType!==6&&e[o+1].dataType!==7)throw new Error(`Input ${o} must be an array of int32 or int64`)})},Gn=(e,t)=>{let r=[];if(e.length>t)if(e[t].dataType===7)e[t].getBigInt64Array().forEach(o=>r.push(Number(o)));else if(e[t].dataType===6)e[t].getInt32Array().forEach(o=>r.push(Number(o)));else throw new Error(`Input ${t} must be an array of int32 or int64`);return r},Np=(e,t)=>{if(e.length>1){let r=Gn(e,1),o=Gn(e,2),i=Gn(e,3);return i.length===0&&(i=[...Array(e[0].dims.length).keys()]),ve({starts:r,ends:o,axes:i})}else return t},_d=(e,t,r,o,i)=>{let u=e;return e<0&&(u+=r[o[t]]),i[t]<0?Math.max(0,Math.min(u,r[o[t]]-1)):Math.max(0,Math.min(u,r[o[t]]))},Gp=(e,t,r)=>`fn calculateInputIndices(output_indices: ${t.type.indices}) -> ${e.type.indices} {\n          var input_indices: ${e.type.indices};\n          var carry = 0u;\n          for (var i = ${r.length}; i >= 0; i--) {\n            let input_shape_i = ${fe("uniforms.input_shape","i",r.length)};\n            let steps_i = ${fe("uniforms.steps","i",r.length)};\n            let signs_i = ${fe("uniforms.signs","i",r.length)};\n            let starts_i = ${fe("uniforms.starts","i",r.length)};\n            var output_index = ${t.indicesGet("output_indices","i")};\n            var input_index = output_index * steps_i + starts_i + carry;\n            carry = input_index / input_shape_i;\n            input_index = input_index % input_shape_i;\n            if (signs_i < 0) {\n              input_index = input_shape_i - input_index - 1u + starts_i;\n            }\n            ${e.indicesSet("input_indices","i","input_index")};\n          }\n          return input_indices;\n      }`,Hp=(e,t)=>{let r=e[0].dims,o=M.size(r),i=t.axes.length>0?M.normalizeAxes(t.axes,r.length):[...Array(r.length).keys()],u=Gn(e,4);u.forEach(I=>I!==0||(()=>{throw new Error("step cannot be 0")})),u.length===0&&(u=Array(i.length).fill(1));let a=t.starts.map((I,x)=>_d(I,x,r,i,u)),c=t.ends.map((I,x)=>_d(I,x,r,i,u));if(i.length!==a.length||i.length!==c.length)throw new Error("start, ends and axes should have the same number of elements");if(i.length!==r.length)for(let I=0;I<r.length;++I)i.includes(I)||(a.splice(I,0,0),c.splice(I,0,r[I]),u.splice(I,0,1));let p=u.map(I=>Math.sign(I));u.forEach((I,x,E)=>{if(I<0){let P=(c[x]-a[x])/I,O=a[x],R=O+P*u[x];a[x]=R,c[x]=O,E[x]=-I}});let h=r.slice(0);i.forEach((I,x)=>{h[I]=Math.ceil((c[I]-a[I])/u[I])});let d={dims:h,dataType:e[0].dataType},y=j("output",e[0].dataType,h.length),w=U("input",e[0].dataType,e[0].dims.length),_=M.size(h),v=[{name:"outputSize",type:"u32"},{name:"starts",type:"u32",length:a.length},{name:"signs",type:"i32",length:p.length},{name:"steps",type:"u32",length:u.length}],S=[{type:12,data:_},{type:12,data:a},{type:6,data:p},{type:12,data:u},...Z(e[0].dims,h)],A=I=>`\n      ${I.registerUniforms(v).declareVariables(w,y)}\n        ${Gp(w,y,r)}\n        ${I.mainStart()}\n          ${I.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.outputSize")}\n          let output_indices = ${y.offsetToIndices("global_idx")};\n          let input_indices = calculateInputIndices(output_indices);\n          ${y.setByOffset("global_idx",w.getByIndices("input_indices"))}\n      }`;return{name:"Slice",shaderCache:{hint:`${p.length}_${a.length}_${u.length}`,inputDependencies:["rank"]},getShaderSource:A,getRunData:()=>({outputs:[d],dispatchGroup:{x:Math.ceil(o/64)},programUniforms:S})}},Sd=(e,t)=>{Wp(e.inputs,t);let r=Np(e.inputs,t);e.compute(Hp(e.inputs,r),{inputs:[0]})},xd=e=>{let t=e.starts,r=e.ends,o=e.axes;return ve({starts:t,ends:r,axes:o})}});var Lp,Fp,Ad,Id,Td=Y(()=>{"use strict";ye();Se();Ze();_e();Lp=e=>{if(!e||e.length!==1)throw new Error("Softmax op requires 1 input.")},Fp=(e,t)=>{let r=e.dims,o=M.size(r),i=64,u=t.axis;if(u<0&&(u=r.length+u),u<r.length-1)throw new Error("softmax only supports last axis for now.");let a=r[u],c=o/a,p=Me(a),h=a/p,d=(A,I)=>I===4?`max(max(${A}.x, ${A}.y), max(${A}.z, ${A}.w))`:I===2?`max(${A}.x, ${A}.y)`:I===3?`max(max(${A}.x, ${A}.y), ${A}.z)`:A,y=U("x",e.dataType,e.dims,p),w=j("result",e.dataType,e.dims,p),_=y.type.value,v=De(e.dataType)==="f32"?`var threadMax = ${_}(-3.402823e+38f);`:`var threadMax = ${_}(-65504.0h);`,S=A=>`\n      var<workgroup> rowMaxShared : ${_};\n      var<workgroup> rowSumShared : ${_};\n      var<workgroup> threadShared : array<${_}, ${i}>;\n\n      fn getValue(row: i32, col: i32, row_stride: i32) -> ${_} {\n        let index = row * row_stride + col;\n        return x[index];\n      }\n\n      fn setValue(row: i32, col: i32, row_stride: i32, value: ${_}) {\n        let index = row * row_stride + col;\n        result[index] = value;\n      }\n      ${A.registerUniform("packedCols","i32").declareVariables(y,w)}\n      ${A.mainStart()}\n        let gindex = i32(global_idx);\n        let lindex = i32(local_idx);\n        const wg = ${i};\n        let row = gindex / wg;\n        let cols = uniforms.packedCols;\n        let row_stride : i32 = uniforms.packedCols;\n\n        // find the rows max\n        ${v}\n        for (var col = lindex; col < cols; col += wg) {\n          let value = getValue(row, col, row_stride);\n          threadMax = max(threadMax, value);\n        }\n        if (lindex < cols) {\n          threadShared[lindex] = threadMax;\n        }\n        workgroupBarrier();\n\n        var reduceSize = min(cols, wg);\n        for (var currSize = reduceSize >> 1;  currSize > 0; currSize = reduceSize >> 1) {\n          reduceSize = currSize + (reduceSize & 1);\n          if (lindex < currSize) {\n            threadShared[lindex] = max(threadShared[lindex], threadShared[lindex + reduceSize]);\n          }\n          workgroupBarrier();\n        }\n        if (lindex == 0) {\n          rowMaxShared = ${_}(${d("threadShared[0]",p)});\n        }\n        workgroupBarrier();\n\n        // find the rows sum\n        var threadSum = ${_}(0.0);\n        for (var col = lindex; col < cols; col += wg) {\n          let subExp = exp(getValue(row, col, row_stride) - rowMaxShared);\n          threadSum += subExp;\n        }\n        threadShared[lindex] = threadSum;\n        workgroupBarrier();\n\n        for (var currSize = wg >> 1;  currSize > 0; currSize = currSize >> 1) {\n          if (lindex < currSize) {\n            threadShared[lindex] = threadShared[lindex] + threadShared[lindex + currSize];\n          }\n          workgroupBarrier();\n        }\n        if (lindex == 0) {\n          rowSumShared = ${_}(${_t("threadShared[0]",p)});\n        }\n        workgroupBarrier();\n\n        // calculate final value for each element in the row\n        for (var col = lindex; col < cols; col += wg) {\n          let value = exp(getValue(row, col, row_stride) - rowMaxShared) / rowSumShared;\n          setValue(row, col, row_stride, value);\n        }\n      }`;return{name:"Softmax",shaderCache:{hint:`${p}`,inputDependencies:["type"]},getRunData:()=>({outputs:[{dims:r,dataType:e.dataType}],dispatchGroup:{x:c},programUniforms:[{type:6,data:h}]}),getShaderSource:S}},Ad=(e,t)=>{Lp(e.inputs),e.compute(Fp(e.inputs[0],t))},Id=e=>ve({axis:e.axis})});var qp,jp,Kp,Yp,Zp,Ed,Pd,kd=Y(()=>{"use strict";ye();Se();Ze();_e();qp=e=>{if(!e||e.length<1)throw new Error("too few inputs")},jp=(e,t)=>{let r=[],o=t.numOutputs;return e[1].dims[0]>0&&(e[1].getBigInt64Array().forEach(i=>r.push(Number(i))),o=r.length),ve({numOutputs:o,axis:t.axis,splitSizes:r})},Kp=e=>`\nfn calculateOutputIndex(index: u32) -> u32 {\n    for (var i: u32 = 0u; i < ${e}u; i += 1u ) {\n    if (index < ${fe("uniforms.size_in_split_axis","i",e)}) {\n        return i;\n    }\n    }\n    return ${e}u;\n}`,Yp=e=>{let t=e.length,r=[];for(let o=0;o<t;++o){let i=e[o].setByIndices("indices","input[global_idx]");t===1?r.push(i):o===0?r.push(`if (output_number == ${o}u) { ${i} }`):o===t-1?r.push(`else { ${i} }`):r.push(`else if (output_number == ${o}) { ${i} }`)}return`\n      fn writeBufferData(output_number: u32, indices: ${e[0].type.indices}, global_idx: u32) {\n        ${r.join(`\n`)}\n      }`},Zp=(e,t)=>{let r=e[0].dims,o=M.size(r),i=e[0].dataType,u=M.normalizeAxis(t.axis,r.length),a=new Array(t.numOutputs),c=U("input",i,r.length),p=new Array(t.numOutputs),h=[],d=[],y=0,w=[{type:12,data:o}];for(let v=0;v<t.numOutputs;v++){y+=t.splitSizes[v],p[v]=y;let S=r.slice();S[t.axis]=t.splitSizes[v],d.push(S),a[v]=j(`output${v}`,i,S.length),h.push({dims:d[v],dataType:e[0].dataType})}w.push({type:12,data:p},...Z(r,...d));let _=v=>`\n  ${v.registerUniform("input_size","u32").registerUniform("size_in_split_axis","u32",p.length).declareVariables(c,...a)}\n  ${Kp(p.length)}\n  ${Yp(a)}\n\n  ${v.mainStart()}\n    ${v.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.input_size")}\n\n    var indices = ${c.offsetToIndices("global_idx")};\n    var index = ${c.indicesGet("indices",u)};\n    let output_number = calculateOutputIndex(index);\n    if (output_number != 0) {\n      index -= ${fe("uniforms.size_in_split_axis","output_number - 1u",p.length)};\n      ${c.indicesSet("indices",u,"index")};\n    }\n    writeBufferData(output_number, indices, global_idx);\n  }`;return{name:"Split",shaderCache:{hint:t.cacheKey,inputDependencies:["rank"]},getShaderSource:_,getRunData:()=>({outputs:h,dispatchGroup:{x:Math.ceil(o/64)},programUniforms:w})}},Ed=(e,t)=>{qp(e.inputs);let r=e.inputs.length===1?t:jp(e.inputs,t);e.compute(Zp(e.inputs,r),{inputs:[0]})},Pd=e=>{let t=e.axis,r=e.splitSizes,o=e.numOutputs<0?r.length:e.numOutputs;if(o!==r.length)throw new Error("numOutputs and splitSizes lengh must be equal");return ve({axis:t,numOutputs:o,splitSizes:r})}});var Od,Xp,Qp,Jp,Rd,Bd=Y(()=>{"use strict";ye();Se();_e();Od=e=>Array.from(e.getBigInt64Array(),Number),Xp=e=>{if(!e||e.length!==2)throw new Error("Tile requires 2 inputs.");if(e[0].dataType!==1&&e[0].dataType!==6&&e[0].dataType!==12)throw new Error("Tile only support float, int32, and uint32 data types");if(e[1].dataType!==7)throw new Error("Tile `repeats` input should be of int64 data type");if(e[1].dims.length!==1)throw new Error("Tile `repeats` input should be 1-D");if(Od(e[1]).length!==e[0].dims.length)throw new Error("Tile `repeats` input should have same number of elements as rank of input data tensor")},Qp=(e,t)=>{let r=[];for(let o=0;o<e.length;++o)r.push(e[o]*t[o]);return r},Jp=e=>{let t=e[0].dims,r=Od(e[1]),o=Qp(t,r),i=M.size(o),u=e[0].dataType,a=U("input",u,t.length),c=j("output",u,o.length),p=h=>`\n      const inputShape = ${a.indices(...t)};\n      ${h.registerUniform("output_size","u32").declareVariables(a,c)}\n      ${h.mainStart()}\n      ${h.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.output_size")}\n      let output_indices = ${c.offsetToIndices("global_idx")};\n      var input_indices: ${a.type.indices};\n      for (var i = 0; i < ${t.length}; i++) {\n        let input_dim_i = ${a.indicesGet("uniforms.input_shape","i")};\n        let input_dim_value = ${c.indicesGet("output_indices","i")}  % input_dim_i;\n\n        ${a.indicesSet("input_indices","i","input_dim_value")}\n      }\n      ${c.setByOffset("global_idx",a.getByIndices("input_indices"))}\n    }`;return{name:"Tile",shaderCache:{hint:`${r}`,inputDependencies:["rank"]},getRunData:()=>({outputs:[{dims:o,dataType:e[0].dataType}],dispatchGroup:{x:Math.ceil(i/64)},programUniforms:[{type:12,data:i},...Z(e[0].dims,o)]}),getShaderSource:p}},Rd=e=>{Xp(e.inputs),e.compute(Jp(e.inputs),{inputs:[0]})}});var em,tm,Dd,zd=Y(()=>{"use strict";ye();Se();_e();em=(e,t,r,o,i)=>{let u=j("output_data",i,r.length,4),a=U("a_data",t[1].dataType,t[1].dims.length,4),c=U("b_data",t[2].dataType,t[2].dims.length,4),p=U("c_data",t[0].dataType,t[0].dims.length,4),h,d=(y,w,_)=>`select(${w}, ${y}, ${_})`;if(!o)h=u.setByOffset("global_idx",d(a.getByOffset("global_idx"),c.getByOffset("global_idx"),p.getByOffset("global_idx")));else{let y=(w,_,v="")=>{let S=`a_data[index_a${_}][component_a${_}]`,A=`b_data[index_b${_}][component_b${_}]`,I=`bool(c_data[index_c${_}] & (0xffu << (component_c${_} * 8)))`;return`\n            let output_indices${_} = ${u.offsetToIndices(`global_idx * 4u + ${_}u`)};\n            let offset_a${_} = ${a.broadcastedIndicesToOffset(`output_indices${_}`,u)};\n            let offset_b${_} = ${c.broadcastedIndicesToOffset(`output_indices${_}`,u)};\n            let offset_c${_} = ${p.broadcastedIndicesToOffset(`output_indices${_}`,u)};\n            let index_a${_} = offset_a${_} / 4u;\n            let index_b${_} = offset_b${_} / 4u;\n            let index_c${_} = offset_c${_} / 4u;\n            let component_a${_} = offset_a${_} % 4u;\n            let component_b${_} = offset_b${_} % 4u;\n            let component_c${_} = offset_c${_} % 4u;\n            ${w}[${_}] = ${v}(${d(S,A,I)});\n          `};i===9?h=`\n            var data = vec4<u32>(0);\n            ${y("data",0,"u32")}\n            ${y("data",1,"u32")}\n            ${y("data",2,"u32")}\n            ${y("data",3,"u32")}\n            output_data[global_idx] = dot(vec4<u32>(0x1, 0x100, 0x10000, 0x1000000), vec4<u32>(data));`:h=`\n            ${y("output_data[global_idx]",0)}\n            ${y("output_data[global_idx]",1)}\n            ${y("output_data[global_idx]",2)}\n            ${y("output_data[global_idx]",3)}\n          `}return`\n        ${e.registerUniform("vec_size","u32").declareVariables(p,a,c,u)}\n        ${e.mainStart()}\n        ${e.guardAgainstOutOfBoundsWorkgroupSizes("uniforms.vec_size")}\n        ${h}\n      }`},tm=e=>{let t=e[1].dims,r=e[2].dims,o=e[0].dims,i=e[1].dataType,u=!(M.areEqual(t,r)&&M.areEqual(r,o)),a=t,c=M.size(t);if(u){let h=It.calcShape(It.calcShape(t,r,!1),o,!1);if(!h)throw new Error("Can\'t perform where op on the given tensors");a=h,c=M.size(a)}let p=Math.ceil(c/4);return{name:"Where",shaderCache:{inputDependencies:["rank","rank","rank"]},getShaderSource:h=>em(h,e,a,u,i),getRunData:()=>({outputs:[{dims:a,dataType:i}],dispatchGroup:{x:Math.ceil(c/64/4)},programUniforms:[{type:12,data:p},...Z(o,t,r,a)]})}},Dd=e=>{e.compute(tm(e.inputs))}});var Md,Ud=Y(()=>{"use strict";Ka();Ro();Ja();ts();Vs();Zs();Oo();Uo();lu();mu();gu();$u();xu();Au();Eu();Ou();Du();Mu();Vu();Wo();Gu();qu();Ku();cd();md();In();yd();wd();$d();Cd();Td();kd();Bd();Sr();Rn();zd();Md=new Map([["Abs",[rs]],["Acos",[ns]],["Acosh",[os]],["Add",[Ws]],["ArgMax",[ja,ko]],["ArgMin",[qa,ko]],["Asin",[is]],["Asinh",[as]],["Atan",[ss]],["Atanh",[us]],["Attention",[Xa]],["AveragePool",[rd,td]],["BatchNormalization",[Qa]],["BiasAdd",[es]],["BiasSplitGelu",[Us]],["Cast",[ls,ds]],["Ceil",[ps]],["Clip",[cs]],["Concat",[Ya,Za]],["Conv",[Ho,Go]],["ConvTranspose",[du,uu]],["Cos",[ms]],["Cosh",[fs]],["CumSum",[cu,pu]],["DepthToSpace",[fu,hu]],["Div",[Ns]],["Einsum",[wu,vu]],["Elu",[hs,kn]],["Equal",[Gs]],["Erf",[gs]],["Exp",[ys]],["Expand",[Su]],["FastGelu",[Cu]],["Floor",[bs]],["FusedConv",[Ho,Go]],["Gather",[Tu,Iu]],["GatherElements",[ku,Pu]],["Gelu",[ws]],["Gemm",[Bu,Ru]],["GlobalAveragePool",[id,od]],["GlobalMaxPool",[ld,dd]],["Greater",[qs]],["GreaterOrEqual",[Ks]],["HardSigmoid",[Is,As]],["InstanceNormalization",[zu]],["LayerNormalization",[Uu]],["LeakyRelu",[vs,kn]],["Less",[js]],["LessOrEqual",[Ys]],["Log",[zs]],["MatMul",[ru]],["MatMulNBits",[Wu,Nu]],["MaxPool",[sd,ud]],["Mul",[Hs]],["MultiHeadAttention",[Fu,Lu]],["Neg",[_s]],["Not",[$s]],["Pad",[ju]],["Pow",[Ls]],["Range",[pd]],["Reciprocal",[Ss]],["ReduceMin",[Wa]],["ReduceMean",[Da]],["ReduceMax",[Va]],["ReduceSum",[Ga]],["ReduceProd",[Na]],["ReduceL1",[za]],["ReduceL2",[Ma]],["ReduceLogSum",[La]],["ReduceLogSumExp",[Ua]],["ReduceSumSquare",[Ha]],["Relu",[xs]],["Resize",[hd,gd]],["RotaryEmbedding",[bd]],["Sigmoid",[Cs]],["Sin",[Ts]],["Sinh",[Es]],["Slice",[Sd,xd]],["SkipLayerNormalization",[vd]],["Split",[Ed,Pd]],["Sqrt",[Ps]],["Softmax",[Ad,Id]],["Sub",[Fs]],["Tan",[ks]],["Tanh",[Rs]],["ThresholdedRelu",[Ds,kn]],["Tile",[Rd]],["Transpose",[_a,Sa]],["Where",[Dd]]])});var Hn,Vd=Y(()=>{"use strict";$r();Lt();_e();Hn=class{constructor(t){this.backend=t;this.repo=new Map,this.attributesBound=!1}getArtifact(t){return this.repo.get(t)}setArtifact(t,r){this.repo.set(t,r)}run(t,r,o,i,u){rr(t.programInfo.name);let a=this.backend.device,c=this.backend.getComputePassEncoder();this.backend.writeTimestamp(this.backend.pendingDispatchNumber*2);let p=[];for(let d of r)p.push({binding:p.length,resource:{buffer:d.buffer}});for(let d of o)p.push({binding:p.length,resource:{buffer:d.buffer}});u&&p.push({binding:p.length,resource:u});let h=a.createBindGroup({layout:t.computePipeline.getBindGroupLayout(0),entries:p,label:t.programInfo.name});if(this.backend.sessionStatus==="capturing"){let d={kernelId:this.backend.currentKernelId,computePipeline:t.computePipeline,bindGroup:h,dispatchGroup:i};this.backend.capturedCommandList.get(this.backend.currentSessionId).push(d)}c.setPipeline(t.computePipeline),c.setBindGroup(0,h),c.dispatchWorkgroups(...i),this.backend.writeTimestamp(this.backend.pendingDispatchNumber*2+1),this.backend.pendingDispatchNumber++,(this.backend.pendingDispatchNumber>=this.backend.maxDispatchNumber||this.backend.queryType==="at-passes")&&this.backend.endComputePass(),this.backend.pendingDispatchNumber>=this.backend.maxDispatchNumber&&this.backend.flush(),Ht(t.programInfo.name)}dispose(){}build(t,r){rr(t.name);let o=this.backend.device,i=[];o.features.has("shader-f16")&&i.push("enable f16;");let u=va(r,this.backend.device.limits),a=t.getShaderSource(u),c=`${i.join(`\n`)}\n${u.additionalImplementations}\n${a}`,p=o.createShaderModule({code:c,label:t.name});Ve("verbose",()=>`[WebGPU] ${t.name} shader code: ${c}`);let h=o.createComputePipeline({compute:{module:p,entryPoint:"main"},layout:"auto",label:t.name});return Ht(t.name),{programInfo:t,computePipeline:h,uniformVariablesInfo:u.variablesInfo}}normalizeDispatchGroupSize(t){let r=typeof t=="number"?t:t.x,o=typeof t=="number"?1:t.y||1,i=typeof t=="number"?1:t.z||1,u=this.backend.device.limits.maxComputeWorkgroupsPerDimension;if(r<=u&&o<=u&&i<=u)return[r,o,i];let a=r*o*i,c=Math.ceil(Math.sqrt(a));if(c>u){if(c=Math.ceil(Math.cbrt(a)),c>u)throw new Error("Total dispatch size exceeds WebGPU maximum.");return[c,c,c]}else return[c,c,1]}}});var rm,nm,Yo,Ln,Wd=Y(()=>{"use strict";$r();ye();Lt();fa();wa();Ud();Vd();rm=(e,t)=>{if(t.length!==e.length)throw new Error(`inputDependencies length ${t.length} is not equal to inputTensors length ${e.length}.`);let r=[];for(let o=0;o<e.length;++o){let i=e[o].dataType;switch(t[o]){case"none":{r.push("");break}case"type":{r.push(`${i}`);break}case"rank":{let u=e[o].dims.length;r.push(`${i};${u}`);break}case"dims":{let u=e[o].dims.join(",");r.push(`${i};${u}`);break}default:throw new Error(`unsupported input dependency: ${t[o]}`)}}return r.join("|")},nm=(e,t,r)=>{let o=e.name;return e.shaderCache?.hint&&(o+="["+e.shaderCache.hint+"]"),o+=":"+r+`:${rm(t,e.shaderCache?.inputDependencies??new Array(t.length).fill("dims"))}`,o},Yo=class{constructor(t){t&&(this.architecture=t.architecture,this.vendor=t.vendor)}isArchitecture(t){return this.architecture===t}isVendor(t){return this.vendor===t}},Ln=class{constructor(){this.currentSessionId=null;this.currentKernelId=null;this.commandEncoder=null;this.computePassEncoder=null;this.maxDispatchNumber=16;this.pendingDispatchNumber=0;this.pendingKernels=[];this.pendingQueries=new Map;this.sessionStatus="default";this.capturedCommandList=new Map;this.capturedPendingKernels=new Map;this.sessionExternalDataMapping=new Map}get currentKernelCustomData(){if(this.currentKernelId===null)throw new Error("currentKernelCustomData(): currentKernelId is null. (should not happen)");let t=this.kernelCustomData.get(this.currentKernelId);return t||(t={},this.kernelCustomData.set(this.currentKernelId,t)),t}async initialize(t,r){this.env=t;let o=[],i={requiredLimits:{maxComputeWorkgroupStorageSize:r.limits.maxComputeWorkgroupStorageSize,maxComputeWorkgroupsPerDimension:r.limits.maxComputeWorkgroupsPerDimension,maxStorageBufferBindingSize:r.limits.maxStorageBufferBindingSize,maxBufferSize:r.limits.maxBufferSize,maxComputeInvocationsPerWorkgroup:r.limits.maxComputeInvocationsPerWorkgroup,maxComputeWorkgroupSizeX:r.limits.maxComputeWorkgroupSizeX,maxComputeWorkgroupSizeY:r.limits.maxComputeWorkgroupSizeY,maxComputeWorkgroupSizeZ:r.limits.maxComputeWorkgroupSizeZ},requiredFeatures:o};r.features.has("chromium-experimental-timestamp-query-inside-passes")?o.push("chromium-experimental-timestamp-query-inside-passes"):r.features.has("timestamp-query")&&o.push("timestamp-query"),r.features.has("shader-f16")&&o.push("shader-f16"),this.device=await r.requestDevice(i),this.adapterInfo=new Yo(await r.requestAdapterInfo()),this.gpuDataManager=ba(this),this.programManager=new Hn(this),this.kernels=new Map,this.kernelPersistentData=new Map,this.kernelCustomData=new Map,pa(t.logLevel,!!t.debug),this.device.onuncapturederror=u=>{u.error instanceof GPUValidationError&&console.error(`An uncaught WebGPU validation error was raised: ${u.error.message}`)},Object.defineProperty(this.env.webgpu,"device",{value:this.device,writable:!1,enumerable:!0,configurable:!1}),Object.defineProperty(this.env.webgpu,"adapter",{value:r,writable:!1,enumerable:!0,configurable:!1}),this.setQueryType()}dispose(){typeof this.querySet<"u"&&this.querySet.destroy(),this.gpuDataManager.dispose()}getCommandEncoder(){return this.commandEncoder||(this.commandEncoder=this.device.createCommandEncoder()),this.commandEncoder}getComputePassEncoder(){if(!this.computePassEncoder){let t=this.getCommandEncoder(),r={};this.queryType==="at-passes"&&(r.timestampWrites={querySet:this.querySet,beginningOfPassWriteIndex:this.pendingDispatchNumber*2,endOfPassWriteIndex:this.pendingDispatchNumber*2+1}),this.computePassEncoder=t.beginComputePass(r)}return this.computePassEncoder}endComputePass(){this.computePassEncoder&&(this.computePassEncoder.end(),this.computePassEncoder=null)}flush(){if(!this.commandEncoder)return;rr(),this.endComputePass();let t;this.queryType!=="none"&&(this.commandEncoder.resolveQuerySet(this.querySet,0,this.pendingDispatchNumber*2,this.queryResolveBuffer,0),t=this.device.createBuffer({size:this.pendingDispatchNumber*2*8,usage:GPUBufferUsage.MAP_READ|GPUBufferUsage.COPY_DST}),this.pendingQueries.set(t,this.pendingKernels),this.pendingKernels=[],this.commandEncoder.copyBufferToBuffer(this.queryResolveBuffer,0,t,0,this.pendingDispatchNumber*2*8)),this.device.queue.submit([this.commandEncoder.finish()]),this.gpuDataManager.refreshPendingBuffers(),this.commandEncoder=null,this.pendingDispatchNumber=0,this.queryType!=="none"&&t.mapAsync(GPUMapMode.READ).then(()=>{let r=new BigUint64Array(t.getMappedRange()),o=this.pendingQueries.get(t);for(let i=0;i<r.length/2;i++){let u=o[i],a=u.kernelId,c=this.kernels.get(a),p=c.kernelType,h=c.kernelName,d=u.programName,y=u.inputTensorViews,w=u.outputTensorViews,_=r[i*2],v=r[i*2+1];typeof this.queryTimeBase>"u"&&(this.queryTimeBase=_);let S=Number(_-this.queryTimeBase),A=Number(v-this.queryTimeBase);if(!Number.isSafeInteger(S)||!Number.isSafeInteger(A))throw new RangeError("incorrect timestamp range");if(this.env.webgpu.profiling?.ondata)this.env.webgpu.profiling.ondata({version:1,inputsMetadata:y.map(I=>({dims:I.dims,dataType:Gt(I.dataType)})),outputsMetadata:w.map(I=>({dims:I.dims,dataType:Gt(I.dataType)})),kernelId:a,kernelType:p,kernelName:h,programName:d,startTime:S,endTime:A});else{let I="";y.forEach((E,P)=>{I+=`input[${P}]: [${E.dims}] | ${Gt(E.dataType)}, `});let x="";w.forEach((E,P)=>{x+=`output[${P}]: [${E.dims}] | ${Gt(E.dataType)}, `}),console.log(`[profiling] kernel "${a}|${p}|${h}|${d}" ${I}${x}execution time: ${A-S} ns`)}wo("GPU",`${d}::${_}::${v}`)}t.unmap(),this.pendingQueries.delete(t)}),Ht()}run(t,r,o,i,u,a){rr(t.name);let c=[];for(let E=0;E<r.length;++E){let P=r[E].data;if(P===0)continue;let O=this.gpuDataManager.get(P);if(!O)throw new Error(`no GPU data for input: ${P}`);c.push(O)}let{outputs:p,dispatchGroup:h,programUniforms:d}=t.getRunData(r),y=o.length===0?p.map((E,P)=>P):o;if(y.length!==p.length)throw new Error(`Output size ${y.length} must be equal to ${p.length}.`);let w=[],_=[];for(let E=0;E<p.length;++E){if(!Number.isInteger(y[E])||y[E]<-3||y[E]>=a)throw new Error(`Invalid output index: ${y[E]}`);if(y[E]===-3)continue;let P=y[E]===-1,O=y[E]===-2,R=P||O?u(p[E].dataType,p[E].dims):i(y[E],p[E].dataType,p[E].dims);if(w.push(R),R.data===0)continue;let L=this.gpuDataManager.get(R.data);if(!L)throw new Error(`no GPU data for output: ${R.data}`);if(P&&this.temporaryData.push(L),O){let N=this.kernelPersistentData.get(this.currentKernelId);N||(N=[],this.kernelPersistentData.set(this.currentKernelId,N)),N.push(L)}_.push(L)}if(c.length!==r.length||_.length!==w.length){if(_.length===0)return Ht(t.name),w;throw new Error(`Program ${t.name} has zero-sized tensor(s) in inputs or outputs. This is not supported now.`)}let v;if(d){let E=0,P=[];d.forEach(N=>{let K=typeof N.data=="number"?[N.data]:N.data;if(K.length===0)return;let Q=N.type===10?2:4,he,W;N.type===10?(W=K.length>4?16:K.length>2?8:K.length*Q,he=K.length>4?16:Q*K.length):(W=K.length<=2?K.length*Q:16,he=16),E=Math.ceil(E/W)*W,P.push(E);let se=N.type===10?8:4;E+=K.length>4?Math.ceil(K.length/se)*he:K.length*Q});let O=16;E=Math.ceil(E/O)*O;let R=new ArrayBuffer(E);d.forEach((N,K)=>{let Q=P[K],he=typeof N.data=="number"?[N.data]:N.data;if(N.type===6)new Int32Array(R,Q,he.length).set(he);else if(N.type===12)new Uint32Array(R,Q,he.length).set(he);else if(N.type===10)new Uint16Array(R,Q,he.length).set(he);else if(N.type===1)new Float32Array(R,Q,he.length).set(he);else throw new Error(`Unsupported uniform type: ${Gt(N.type)}`)});let L=this.gpuDataManager.create(E,GPUBufferUsage.COPY_DST|GPUBufferUsage.UNIFORM);this.device.queue.writeBuffer(L.buffer,0,R,0,E),this.gpuDataManager.release(L.id),v={offset:0,size:E,buffer:L.buffer}}let S=this.programManager.normalizeDispatchGroupSize(h),A=S[1]===1&&S[2]===1,I=nm(t,r,A),x=this.programManager.getArtifact(I);if(x||(x=this.programManager.build(t,S),this.programManager.setArtifact(I,x),Ve("info",()=>`[artifact] key: ${I}, programName: ${t.name}`)),d&&x.uniformVariablesInfo){if(d.length!==x.uniformVariablesInfo.length)throw new Error(`Uniform variables count mismatch: expect ${x.uniformVariablesInfo.length}, got ${d.length} in program "${x.programInfo.name}".`);for(let E=0;E<d.length;E++){let P=d[E],O=P.type,R=typeof P.data=="number"?1:P.data.length,[L,N]=x.uniformVariablesInfo[E];if(O!==L||R!==N)throw new Error(`Uniform variable ${E} mismatch: expect type ${L} with size ${N}, got type ${O} with size ${R} in program "${x.programInfo.name}".`)}}if(Ve("info",()=>`[ProgramManager] run "${t.name}" (key=${I}) with ${S[0]}x${S[1]}x${S[2]}`),this.queryType!=="none"||this.sessionStatus==="capturing"){let E={kernelId:this.currentKernelId,programName:x.programInfo.name,inputTensorViews:r,outputTensorViews:w};this.pendingKernels.push(E),this.sessionStatus==="capturing"&&this.capturedPendingKernels.get(this.currentSessionId).push(E)}return this.programManager.run(x,c,_,S,v),Ht(t.name),w}upload(t,r){this.gpuDataManager.upload(t,r)}memcpy(t,r){this.gpuDataManager.memcpy(t,r)}async download(t,r){await this.gpuDataManager.download(t,r)}alloc(t){return this.gpuDataManager.create(t).id}free(t){return this.gpuDataManager.release(t)}createKernel(t,r,o,i){let u=Md.get(t);if(!u)throw new Error(`kernel not implemented: ${t}`);let a={kernelType:t,kernelName:i,kernelEntry:u[0],attributes:[u[1],o]};this.kernels.set(r,a)}releaseKernel(t){let r=this.kernelPersistentData.get(t);if(r){for(let o of r)this.gpuDataManager.release(o.id);this.kernelPersistentData.delete(t)}this.kernelCustomData.delete(t),this.kernels.delete(t)}computeKernel(t,r,o){let i=this.kernels.get(t);if(!i)throw new Error(`kernel not created: ${t}`);let u=i.kernelType,a=i.kernelName,c=i.kernelEntry,p=i.attributes;if(this.currentKernelId!==null)throw new Error(`kernel "[${u}] ${a}" is not allowed to be called recursively`);this.currentKernelId=t,p[0]&&(p[1]=p[0](p[1]),p[0]=void 0),Ve("info",()=>`[WebGPU] Start to run kernel "[${u}] ${a}"...`);let h=this.env.debug;this.temporaryData=[];try{return h&&this.device.pushErrorScope("validation"),c(r,p[1]),0}catch(d){return o.push(Promise.resolve(`[WebGPU] Kernel "[${u}] ${a}" failed. ${d}`)),1}finally{h&&o.push(this.device.popErrorScope().then(d=>d?`GPU validation error for kernel "[${u}] ${a}": ${d.message}`:null));for(let d of this.temporaryData)this.gpuDataManager.release(d.id);this.temporaryData=[],this.currentKernelId=null}}registerBuffer(t,r,o,i){let u=this.sessionExternalDataMapping.get(t);u||(u=new Map,this.sessionExternalDataMapping.set(t,u));let a=u.get(r),c=this.gpuDataManager.registerExternalBuffer(o,i,a?.[1]);return u.set(r,[c,o]),c}unregisterBuffers(t){let r=this.sessionExternalDataMapping.get(t);r&&(r.forEach(o=>this.gpuDataManager.unregisterExternalBuffer(o[1])),this.sessionExternalDataMapping.delete(t))}getBuffer(t){let r=this.gpuDataManager.get(t);if(!r)throw new Error(`no GPU data for buffer: ${t}`);return r.buffer}createDownloader(t,r,o){return async()=>{let i=await xo(this,t,r);return ma(i.buffer,o)}}writeTimestamp(t){this.queryType==="inside-passes"&&this.computePassEncoder.writeTimestamp(this.querySet,t)}setQueryType(){this.queryType="none",(this.env.webgpu.profiling?.mode==="default"||(typeof this.env.trace>"u"?this.env.wasm.trace:this.env.trace))&&(this.device.features.has("chromium-experimental-timestamp-query-inside-passes")?this.queryType="inside-passes":this.device.features.has("timestamp-query")&&(this.queryType="at-passes"),this.queryType!=="none"&&typeof this.querySet>"u"&&(this.querySet=this.device.createQuerySet({type:"timestamp",count:this.maxDispatchNumber*2}),this.queryResolveBuffer=this.device.createBuffer({size:this.maxDispatchNumber*2*8,usage:GPUBufferUsage.COPY_SRC|GPUBufferUsage.QUERY_RESOLVE})))}captureBegin(){Ve("info","captureBegin"),this.capturedCommandList.get(this.currentSessionId)||this.capturedCommandList.set(this.currentSessionId,[]),this.capturedPendingKernels.get(this.currentSessionId)||this.capturedPendingKernels.set(this.currentSessionId,[]),this.flush(),this.sessionStatus="capturing"}captureEnd(){Ve("info","captureEnd"),this.flush(),this.sessionStatus="default"}replay(){Ve("info","replay"),this.sessionStatus="replaying";let t=this.capturedCommandList.get(this.currentSessionId),r=this.capturedPendingKernels.get(this.currentSessionId),o=t.length;this.pendingKernels=[];for(let i=0;i<o;i++){let u=this.getComputePassEncoder(),a=t[i];this.writeTimestamp(this.pendingDispatchNumber*2),u.setPipeline(a.computePipeline),u.setBindGroup(0,a.bindGroup),u.dispatchWorkgroups(...a.dispatchGroup),this.writeTimestamp(this.pendingDispatchNumber*2+1),this.pendingDispatchNumber++,this.queryType!=="none"&&this.pendingKernels.push(r[i]),(this.pendingDispatchNumber>=this.maxDispatchNumber||this.queryType==="at-passes")&&this.endComputePass(),this.pendingDispatchNumber>=this.maxDispatchNumber&&this.flush()}this.flush(),this.sessionStatus="default"}onReleaseSession(t){this.unregisterBuffers(t),this.capturedCommandList.has(t)&&this.capturedCommandList.delete(t),this.capturedPendingKernels.has(t)&&this.capturedPendingKernels.delete(t),this.gpuDataManager.onReleaseSession(t)}onRunStart(t){this.currentSessionId=t,this.setQueryType()}}});var Nd={};gn(Nd,{init:()=>om});var qr,Zo,om,Gd=Y(()=>{"use strict";ye();Wd();Lt();Se();qr=class e{constructor(t,r,o,i){this.module=t;this.dataType=r;this.data=o;this.dims=i}getFloat32Array(){if(this.dataType!==1)throw new Error("Invalid data type");let t=M.size(this.dims);return t===0?new Float32Array:new Float32Array(this.module.HEAP8.buffer,this.data,t)}getBigInt64Array(){if(this.dataType!==7)throw new Error("Invalid data type");let t=M.size(this.dims);return t===0?new BigInt64Array:new BigInt64Array(this.module.HEAP8.buffer,this.data,t)}getInt32Array(){if(this.dataType!==6)throw new Error("Invalid data type");let t=M.size(this.dims);return t===0?new Int32Array:new Int32Array(this.module.HEAP8.buffer,this.data,t)}reshape(t){if(M.size(t)!==M.size(this.dims))throw new Error("Invalid new shape");return new e(this.module,this.dataType,this.data,t)}},Zo=class{constructor(t,r,o){this.module=t;this.backend=r;this.customDataOffset=0;this.customDataSize=0;this.adapterInfo=r.adapterInfo;let i=t.HEAPU32,u=o>>>2;this.opKernelContext=i[u++];let a=i[u++];this.outputCount=i[u++],this.customDataOffset=i[u++],this.customDataSize=i[u++];let c=[];for(let p=0;p<a;p++){let h=i[u++],d=i[u++],y=i[u++],w=[];for(let _=0;_<y;_++)w.push(i[u++]);c.push(new qr(t,h,d,w))}this.inputs=c}get kernelCustomData(){return this.backend.currentKernelCustomData}get customDataBuffer(){return this.module.HEAPU8.subarray(this.customDataOffset,this.customDataOffset+this.customDataSize)}getMaxComputeWorkgroupSizes(){return[this.backend.device.limits.maxComputeWorkgroupSizeX,this.backend.device.limits.maxComputeWorkgroupSizeY,this.backend.device.limits.maxComputeWorkgroupSizeZ]}getMaxComputeWorkgroupStoragesize(){return this.backend.device.limits.maxComputeWorkgroupStorageSize}compute(t,r){let o=r?.inputs?.map(c=>typeof c=="number"?this.inputs[c]:c)??this.inputs,i=r?.outputs??[],u=(c,p,h)=>new qr(this.module,p,this.output(c,h),h),a=(c,p)=>{let h=tr(c);if(!h)throw new Error(`Unsupported data type: ${c}`);let d=h*M.size(p),y=d>0?this.backend.gpuDataManager.create(d).id:0;return new qr(this.module,c,y,p)};return this.backend.run(t,o,i,u,a,this.outputCount)}output(t,r){let o=this.module.stackSave();try{let i=this.module.stackAlloc((1+r.length)*4),u=i>>2;this.module.HEAPU32[u++]=r.length;for(let a=0;a<r.length;a++)this.module.HEAPU32[u++]=r[a];return this.module._JsepOutput(this.opKernelContext,t,i)}catch(i){throw new Error(`Failed to generate kernel\'s output[${t}] with dims [${r}]. If you are running with pre-allocated output, please make sure the output type/dims are correct. Error: ${i}`)}finally{this.module.stackRestore(o)}}},om=async(e,t,r,o)=>{let i=t.jsepInit;if(!i)throw new Error("Failed to initialize JSEP. The WebAssembly module is not built with JSEP support.");if(e==="webgpu"){let u=new Ln;await u.initialize(r,o),i("webgpu",[u,a=>u.alloc(a),a=>u.free(a),(a,c,p,h=!1)=>{if(h)Ve("verbose",()=>`[WebGPU] jsepCopyGpuToGpu: src=${a}, dst=${c}, size=${p}`),u.memcpy(a,c);else{Ve("verbose",()=>`[WebGPU] jsepCopyCpuToGpu: dataOffset=${a}, gpuDataId=${c}, size=${p}`);let d=t.HEAPU8.subarray(a>>>0,(a>>>0)+p);u.upload(c,d)}},async(a,c,p)=>{Ve("verbose",()=>`[WebGPU] jsepCopyGpuToCpu: gpuDataId=${a}, dataOffset=${c}, size=${p}`),await u.download(a,()=>t.HEAPU8.subarray(c>>>0,(c>>>0)+p))},(a,c,p)=>u.createKernel(a,c,p,t.UTF8ToString(t._JsepGetNodeName(c))),a=>u.releaseKernel(a),(a,c,p,h)=>{Ve("verbose",()=>`[WebGPU] jsepRun: sessionHandle=${p}, kernel=${a}, contextDataOffset=${c}`);let d=new Zo(t,u,c);return u.computeKernel(a,d,h)},()=>u.captureBegin(),()=>u.captureEnd(),()=>u.replay()])}else i("webnn")}});var Vi;Vi=Ei();var pl=zi(),fo,ho=!1,yn=!1,Ui=!1,ml=e=>{if(e===1)return!1;if(typeof SharedArrayBuffer>"u")return typeof self<"u"&&!self.crossOriginIsolated&&console.warn("env.wasm.numThreads is set to "+e+", but this will not work unless you enable crossOriginIsolated mode. See https://web.dev/cross-origin-isolation-guide/ for more info."),!1;typeof process<"u"&&process.versions&&process.versions.node&&console.warn("env.wasm.numThreads is set to "+e+", however, currently onnxruntime-web does not support multi-threads in Node.js. Please consider using onnxruntime-node for performance critical scenarios.");try{return typeof MessageChannel<"u"&&new MessageChannel().port1.postMessage(new SharedArrayBuffer(1)),WebAssembly.validate(new Uint8Array([0,97,115,109,1,0,0,0,1,4,1,96,0,0,3,2,1,0,5,4,1,3,1,1,10,11,1,9,0,65,0,254,16,2,0,26,11]))}catch{return!1}},fl=()=>{try{return WebAssembly.validate(new Uint8Array([0,97,115,109,1,0,0,0,1,4,1,96,0,0,3,2,1,0,10,30,1,28,0,65,0,253,15,253,12,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,253,186,1,26,11]))}catch{return!1}},hl=(e,t)=>e?t?"ort-wasm-simd-threaded.wasm":"ort-wasm-simd.wasm":t?"ort-wasm-threaded.wasm":"ort-wasm.wasm",Wi=async e=>{if(ho)return Promise.resolve();if(yn)throw new Error("multiple calls to \'initializeWebAssembly()\' detected.");if(Ui)throw new Error("previous call to \'initializeWebAssembly()\' failed.");yn=!0;let t=e.initTimeout,r=e.numThreads,o=e.simd,i=ml(r),u=o&&fl(),a=e.wasmPaths,c=typeof a=="string"?a:void 0,p=hl(u,i),h=typeof a=="object"?a[p]:void 0,d=!1,y=[];if(t>0&&y.push(new Promise(w=>{setTimeout(()=>{d=!0,w()},t)})),y.push(new Promise((w,_)=>{let v=i?pl:Vi,S={locateFile:(A,I)=>{if(i&&A.endsWith(".worker.js")&&typeof Blob<"u")return URL.createObjectURL(new Blob([Mi()],{type:"text/javascript"}));if(A.endsWith(".wasm")){if(h)return h;let x=c??I;return p==="ort-wasm-simd.wasm"?x+"ort-wasm-simd.jsep.wasm":p==="ort-wasm-simd-threaded.wasm"?x+"ort-wasm-simd-threaded.jsep.wasm":x+p}return I+A}};if(i)if(S.numThreads=r,typeof Blob>"u")S.mainScriptUrlOrBlob=(void 0)(__dirname,"ort-wasm-threaded.js");else{let A=`var ortWasmThreaded=${v.toString()};`;S.mainScriptUrlOrBlob=new Blob([A],{type:"text/javascript"})}v(S).then(A=>{yn=!1,ho=!0,fo=A,w()},A=>{yn=!1,Ui=!0,_(A)})})),await Promise.race(y),d)throw new Error(`WebAssembly backend initializing failed due to timeout: ${t}ms`)},Le=()=>{if(ho&&fo)return fo;throw new Error("WebAssembly is not initialized yet.")};var Fe=(e,t)=>{let r=Le(),o=r.lengthBytesUTF8(e)+1,i=r._malloc(o);return r.stringToUTF8(e,i,o),t.push(i),i},Nr=(e,t,r,o)=>{if(typeof e=="object"&&e!==null){if(r.has(e))throw new Error("Circular reference in options");r.add(e)}Object.entries(e).forEach(([i,u])=>{let a=t?t+i:i;if(typeof u=="object")Nr(u,a+".",r,o);else if(typeof u=="string"||typeof u=="number")o(a,u.toString());else if(typeof u=="boolean")o(a,u?"1":"0");else throw new Error(`Can\'t handle extra config type: ${typeof u}`)})},Ue=e=>{let t=Le(),r=t.stackSave();try{let o=t.stackAlloc(8);t._OrtGetLastError(o,o+4);let i=t.HEAP32[o/4],u=t.HEAPU32[o/4+1],a=u?t.UTF8ToString(u):"";throw new Error(`${e} ERROR_CODE: ${i}, ERROR_MESSAGE: ${a}`)}finally{t.stackRestore(r)}};var Ni=e=>{let t=Le(),r=0,o=[],i=e||{};try{if(e?.logSeverityLevel===void 0)i.logSeverityLevel=2;else if(typeof e.logSeverityLevel!="number"||!Number.isInteger(e.logSeverityLevel)||e.logSeverityLevel<0||e.logSeverityLevel>4)throw new Error(`log serverity level is not valid: ${e.logSeverityLevel}`);if(e?.logVerbosityLevel===void 0)i.logVerbosityLevel=0;else if(typeof e.logVerbosityLevel!="number"||!Number.isInteger(e.logVerbosityLevel))throw new Error(`log verbosity level is not valid: ${e.logVerbosityLevel}`);e?.terminate===void 0&&(i.terminate=!1);let u=0;return e?.tag!==void 0&&(u=Fe(e.tag,o)),r=t._OrtCreateRunOptions(i.logSeverityLevel,i.logVerbosityLevel,!!i.terminate,u),r===0&&Ue("Can\'t create run options."),e?.extra!==void 0&&Nr(e.extra,"",new WeakSet,(a,c)=>{let p=Fe(a,o),h=Fe(c,o);t._OrtAddRunConfigEntry(r,p,h)!==0&&Ue(`Can\'t set a run config entry: ${a} - ${c}.`)}),[r,o]}catch(u){throw r!==0&&t._OrtReleaseRunOptions(r),o.forEach(a=>t._free(a)),u}};var gl=e=>{switch(e){case"disabled":return 0;case"basic":return 1;case"extended":return 2;case"all":return 99;default:throw new Error(`unsupported graph optimization level: ${e}`)}},yl=e=>{switch(e){case"sequential":return 0;case"parallel":return 1;default:throw new Error(`unsupported execution mode: ${e}`)}},bl=e=>{e.extra||(e.extra={}),e.extra.session||(e.extra.session={});let t=e.extra.session;t.use_ort_model_bytes_directly||(t.use_ort_model_bytes_directly="1"),e.executionProviders&&e.executionProviders.some(r=>(typeof r=="string"?r:r.name)==="webgpu")&&(e.enableMemPattern=!1)},wl=(e,t,r)=>{for(let o of t){let i=typeof o=="string"?o:o.name;switch(i){case"webnn":if(i="WEBNN",typeof o!="string"){let a=o;if(a?.deviceType){let c=Fe("deviceType",r),p=Fe(a.deviceType,r);Le()._OrtAddSessionConfigEntry(e,c,p)!==0&&Ue(`Can\'t set a session config entry: \'deviceType\' - ${a.deviceType}.`)}if(a?.numThreads){let c=a.numThreads;(typeof c!="number"||!Number.isInteger(c)||c<0)&&(c=0);let p=Fe("numThreads",r),h=Fe(c.toString(),r);Le()._OrtAddSessionConfigEntry(e,p,h)!==0&&Ue(`Can\'t set a session config entry: \'numThreads\' - ${a.numThreads}.`)}if(a?.powerPreference){let c=Fe("powerPreference",r),p=Fe(a.powerPreference,r);Le()._OrtAddSessionConfigEntry(e,c,p)!==0&&Ue(`Can\'t set a session config entry: \'powerPreference\' - ${a.powerPreference}.`)}}break;case"webgpu":if(i="JS",typeof o!="string"){let a=o;if(a?.preferredLayout){if(a.preferredLayout!=="NCHW"&&a.preferredLayout!=="NHWC")throw new Error(`preferredLayout must be either \'NCHW\' or \'NHWC\': ${a.preferredLayout}`);let c=Fe("preferredLayout",r),p=Fe(a.preferredLayout,r);Le()._OrtAddSessionConfigEntry(e,c,p)!==0&&Ue(`Can\'t set a session config entry: \'preferredLayout\' - ${a.preferredLayout}.`)}}break;case"wasm":case"cpu":continue;default:throw new Error(`not supported execution provider: ${i}`)}let u=Fe(i,r);Le()._OrtAppendExecutionProvider(e,u)!==0&&Ue(`Can\'t append execution provider: ${i}.`)}},Gi=e=>{let t=Le(),r=0,o=[],i=e||{};bl(i);try{let u=gl(i.graphOptimizationLevel??"all"),a=yl(i.executionMode??"sequential"),c=typeof i.logId=="string"?Fe(i.logId,o):0,p=i.logSeverityLevel??2;if(!Number.isInteger(p)||p<0||p>4)throw new Error(`log serverity level is not valid: ${p}`);let h=i.logVerbosityLevel??0;if(!Number.isInteger(h)||h<0||h>4)throw new Error(`log verbosity level is not valid: ${h}`);let d=typeof i.optimizedModelFilePath=="string"?Fe(i.optimizedModelFilePath,o):0;if(r=t._OrtCreateSessionOptions(u,!!i.enableCpuMemArena,!!i.enableMemPattern,a,!!i.enableProfiling,0,c,p,h,d),r===0&&Ue("Can\'t create session options."),i.executionProviders&&wl(r,i.executionProviders,o),i.enableGraphCapture!==void 0){if(typeof i.enableGraphCapture!="boolean")throw new Error(`enableGraphCapture must be a boolean value: ${i.enableGraphCapture}`);let y=Fe("enableGraphCapture",o),w=Fe(i.enableGraphCapture.toString(),o);t._OrtAddSessionConfigEntry(r,y,w)!==0&&Ue(`Can\'t set a session config entry: \'enableGraphCapture\' - ${i.enableGraphCapture}.`)}if(i.freeDimensionOverrides)for(let[y,w]of Object.entries(i.freeDimensionOverrides)){if(typeof y!="string")throw new Error(`free dimension override name must be a string: ${y}`);if(typeof w!="number"||!Number.isInteger(w)||w<0)throw new Error(`free dimension override value must be a non-negative integer: ${w}`);let _=Fe(y,o);t._OrtAddFreeDimensionOverride(r,_,w)!==0&&Ue(`Can\'t set a free dimension override: ${y} - ${w}.`)}return i.extra!==void 0&&Nr(i.extra,"",new WeakSet,(y,w)=>{let _=Fe(y,o),v=Fe(w,o);t._OrtAddSessionConfigEntry(r,_,v)!==0&&Ue(`Can\'t set a session config entry: ${y} - ${w}.`)}),[r,o]}catch(u){throw r!==0&&t._OrtReleaseSessionOptions(r),o.forEach(a=>t._free(a)),u}};ye();var Li=async e=>{if(typeof e=="string")if(typeof process<"u"&&process.versions&&process.versions.node)try{return new Uint8Array(await(void 0)(e))}catch(t){if(t.code==="ERR_FS_FILE_TOO_LARGE"){let r=(void 0)(e),o=[];for await(let i of r)o.push(i);return new Uint8Array(Buffer.concat(o))}throw t}else{let t=await fetch(e);if(!t.ok)throw new Error(`failed to load external data file: ${e}`);let r=t.headers.get("Content-Length"),o=r?parseInt(r,10):0;if(o<1073741824)return new Uint8Array(await t.arrayBuffer());{if(!t.body)throw new Error(`failed to load external data file: ${e}, no response body.`);let i=t.body.getReader(),u;try{u=new ArrayBuffer(o)}catch(c){if(c instanceof RangeError){let p=Math.ceil(o/65536);u=new WebAssembly.Memory({initial:p,maximum:p}).buffer}else throw c}let a=0;for(;;){let{done:c,value:p}=await i.read();if(c)break;let h=p.byteLength;new Uint8Array(u,a,h).set(p),a+=h}return new Uint8Array(u,0,o)}}else return e instanceof Blob?new Uint8Array(await e.arrayBuffer()):e instanceof Uint8Array?e:new Uint8Array(e)};var im=(e,t)=>{Le()._OrtInit(e,t)!==0&&Ue("Can\'t initialize onnxruntime.")},Ld=async e=>{im(e.wasm.numThreads,Gr(e.logLevel))},Fd=async(e,t)=>{{let r=(Gd(),wr(Nd)).init;if(t==="webgpu"){if(typeof navigator>"u"||!navigator.gpu)throw new Error("WebGPU is not supported in current environment");let o=e.webgpu.adapter;if(o){if(typeof o.limits!="object"||typeof o.features!="object"||typeof o.requestDevice!="function")throw new Error("Invalid GPU adapter set in `env.webgpu.adapter`. It must be a GPUAdapter object.")}else{let i=e.webgpu.powerPreference;if(i!==void 0&&i!=="low-power"&&i!=="high-performance")throw new Error(`Invalid powerPreference setting: "${i}"`);let u=e.webgpu.forceFallbackAdapter;if(u!==void 0&&typeof u!="boolean")throw new Error(`Invalid forceFallbackAdapter setting: "${u}"`);if(o=await navigator.gpu.requestAdapter({powerPreference:i,forceFallbackAdapter:u}),!o)throw new Error(\'Failed to get GPU adapter. You may need to enable flag "--enable-unsafe-webgpu" if you are using Chrome.\')}if(!e.wasm.simd)throw new Error("Not supported for WebGPU=ON and SIMD=OFF. Please set `env.wasm.simd` to true when using `webgpu` EP");await r("webgpu",Le(),e,o)}if(t==="webnn"){if(typeof navigator>"u"||!navigator.ml)throw new Error("WebNN is not supported in current environment");await r("webnn",Le(),e)}}},ar=new Map,am=e=>{let t=Le(),r=t.stackSave();try{let o=t.stackAlloc(8);return t._OrtGetInputOutputCount(e,o,o+4)!==0&&Ue("Can\'t get session input/output count."),[t.HEAP32[o/4],t.HEAP32[o/4+1]]}finally{t.stackRestore(r)}},Xo=e=>{let t=Le(),r=t._malloc(e.byteLength);if(r===0)throw new Error(`Can\'t create a session. failed to allocate a buffer of size ${e.byteLength}.`);return t.HEAPU8.set(e,r),[r,e.byteLength]},qd=async(e,t)=>{let r,o,i=Le();Array.isArray(e)?[r,o]=e:e.buffer===i.HEAPU8.buffer?[r,o]=[e.byteOffset,e.byteLength]:[r,o]=Xo(e);let u=0,a=0,c=0,p=[],h=[],d=[];try{if([a,p]=Gi(t),t?.externalData&&i.mountExternalData){let x=[];for(let E of t.externalData){let P=typeof E=="string"?E:E.path;x.push(Li(typeof E=="string"?E:E.data).then(O=>{i.mountExternalData(P,O)}))}await Promise.all(x)}u=await i._OrtCreateSession(r,o,a),u===0&&Ue("Can\'t create a session.");let[y,w]=am(u),_=!!t?.enableGraphCapture,v=[],S=[],A=[];for(let x=0;x<y;x++){let E=i._OrtGetInputName(u,x);E===0&&Ue("Can\'t get an input name."),h.push(E),v.push(i.UTF8ToString(E))}for(let x=0;x<w;x++){let E=i._OrtGetOutputName(u,x);E===0&&Ue("Can\'t get an output name."),d.push(E);let P=i.UTF8ToString(E);S.push(P);{if(_&&t?.preferredOutputLocation===void 0){A.push("gpu-buffer");continue}let O=typeof t?.preferredOutputLocation=="string"?t.preferredOutputLocation:t?.preferredOutputLocation?.[P]??"cpu";if(O!=="cpu"&&O!=="cpu-pinned"&&O!=="gpu-buffer")throw new Error(`Not supported preferred output location: ${O}.`);if(_&&O!=="gpu-buffer")throw new Error(`Not supported preferred output location: ${O}. Only \'gpu-buffer\' location is supported when enableGraphCapture is true.`);A.push(O)}}let I=null;return A.some(x=>x==="gpu-buffer")&&(c=i._OrtCreateBinding(u),c===0&&Ue("Can\'t create IO binding."),I={handle:c,outputPreferredLocations:A,outputPreferredLocationsEncoded:A.map(x=>yo(x))}),ar.set(u,[u,h,d,I,_,!1]),[u,v,S]}catch(y){throw h.forEach(w=>i._OrtFree(w)),d.forEach(w=>i._OrtFree(w)),c!==0&&i._OrtReleaseBinding(c),u!==0&&i._OrtReleaseSession(u),y}finally{i._free(r),a!==0&&i._OrtReleaseSessionOptions(a),p.forEach(y=>i._free(y)),i.unmountExternalData?.()}},jd=e=>{let t=Le(),r=ar.get(e);if(!r)throw new Error(`cannot release session. invalid session id: ${e}`);let[o,i,u,a,c]=r;a&&(c&&t._OrtClearBoundOutputs(a.handle),t._OrtReleaseBinding(a.handle)),t.jsepOnReleaseSession?.(e),i.forEach(p=>t._OrtFree(p)),u.forEach(p=>t._OrtFree(p)),t._OrtReleaseSession(o),ar.delete(e)},Hd=(e,t,r,o,i,u=!1)=>{if(!e){t.push(0);return}let a=Le(),c=e[0],p=e[1],h=e[3],d,y;if(c==="string"&&h==="gpu-buffer")throw new Error("String tensor is not supported on GPU.");if(u&&h!=="gpu-buffer")throw new Error(`External buffer must be provided for input/output index ${i} when enableGraphCapture is true.`);if(h==="gpu-buffer"){let v=e[2].gpuBuffer,S=tr(go(c));y=p.reduce((I,x)=>I*x,1)*S;let A=a.jsepRegisterBuffer;if(!A)throw new Error(\'Tensor location "gpu-buffer" is not supported without using WebGPU.\');d=A(o,i,v,y)}else{let v=e[2];if(Array.isArray(v)){y=4*v.length,d=a._malloc(y),r.push(d);let S=d/4;for(let A=0;A<v.length;A++){if(typeof v[A]!="string")throw new TypeError(`tensor data at index ${A} is not a string`);a.HEAPU32[S++]=Fe(v[A],r)}}else y=v.byteLength,d=a._malloc(y),r.push(d),a.HEAPU8.set(new Uint8Array(v.buffer,v.byteOffset,y),d)}let w=a.stackSave(),_=a.stackAlloc(4*p.length);try{let v=_/4;p.forEach(A=>a.HEAP32[v++]=A);let S=a._OrtCreateTensor(go(c),d,y,_,p.length,yo(h));S===0&&Ue(`Can\'t create tensor for input/output. session=${o}, index=${i}.`),t.push(S)}finally{a.stackRestore(w)}},Kd=async(e,t,r,o,i,u)=>{let a=Le(),c=ar.get(e);if(!c)throw new Error(`cannot run inference. invalid session id: ${e}`);let p=c[0],h=c[1],d=c[2],y=c[3],w=c[4],_=c[5],v=t.length,S=o.length,A=0,I=[],x=[],E=[],P=[],O=a.stackSave(),R=a.stackAlloc(v*4),L=a.stackAlloc(v*4),N=a.stackAlloc(S*4),K=a.stackAlloc(S*4);try{[A,I]=Ni(u);for(let ee=0;ee<v;ee++)Hd(r[ee],x,P,e,t[ee],w);for(let ee=0;ee<S;ee++)Hd(i[ee],E,P,e,v+o[ee],w);let Q=R/4,he=L/4,W=N/4,se=K/4;for(let ee=0;ee<v;ee++)a.HEAPU32[Q++]=x[ee],a.HEAPU32[he++]=h[t[ee]];for(let ee=0;ee<S;ee++)a.HEAPU32[W++]=E[ee],a.HEAPU32[se++]=d[o[ee]];if(y&&!_){let{handle:ee,outputPreferredLocations:ae,outputPreferredLocationsEncoded:Ae}=y;if(h.length!==v)throw new Error(`input count from feeds (${v}) is expected to be always equal to model\'s input count (${h.length}).`);for(let me=0;me<v;me++){let ie=t[me];await a._OrtBindInput(ee,h[ie],x[me])!==0&&Ue(`Can\'t bind input[${me}] for session=${e}.`)}for(let me=0;me<S;me++){let ie=o[me];i[me]?.[3]?a._OrtBindOutput(ee,d[ie],E[me],0)!==0&&Ue(`Can\'t bind pre-allocated output[${me}] for session=${e}.`):a._OrtBindOutput(ee,d[ie],0,Ae[ie])!==0&&Ue(`Can\'t bind output[${me}] to ${ae[me]} for session=${e}.`)}ar.set(e,[p,h,d,y,w,!0])}a.jsepOnRunStart?.(p);let Ce;y?Ce=await a._OrtRunWithBinding(p,y.handle,S,N,A):Ce=await a._OrtRun(p,L,R,v,K,S,N,A),Ce!==0&&Ue("failed to call OrtRun().");let We=[];for(let ee=0;ee<S;ee++){let ae=a.HEAPU32[N/4+ee];if(ae===E[ee]){We.push(i[ee]);continue}let Ae=a.stackSave(),me=a.stackAlloc(4*4),ie=!1,ue,le=0;try{a._OrtGetTensorData(ae,me,me+4,me+8,me+12)!==0&&Ue(`Can\'t access output tensor data on index ${ee}.`);let G=me/4,ne=a.HEAPU32[G++];le=a.HEAPU32[G++];let xe=a.HEAPU32[G++],Ke=a.HEAPU32[G++],Be=[];for(let Ne=0;Ne<Ke;Ne++)Be.push(a.HEAPU32[xe/4+Ne]);a._OrtFree(xe);let Ge=Be.reduce((Ne,Ye)=>Ne*Ye,1);ue=Gt(ne);let Ut=y?.outputPreferredLocations[o[ee]];if(ue==="string"){if(Ut==="gpu-buffer")throw new Error("String tensor is not supported on GPU.");let Ne=[],Ye=le/4;for(let mt=0;mt<Ge;mt++){let Rt=a.HEAPU32[Ye++],qt=mt===Ge-1?void 0:a.HEAPU32[Ye]-Rt;Ne.push(a.UTF8ToString(Rt,qt))}We.push([ue,Be,Ne,"cpu"])}else if(Ut==="gpu-buffer"&&Ge>0){let Ne=a.jsepGetBuffer;if(!Ne)throw new Error(\'preferredLocation "gpu-buffer" is not supported without using WebGPU.\');let Ye=Ne(le),mt=tr(ne);if(mt===void 0||!Hi(ue))throw new Error(`Unsupported data type: ${ue}`);ie=!0,We.push([ue,Be,{gpuBuffer:Ye,download:a.jsepCreateDownloader(Ye,Ge*mt,ue),dispose:()=>{a._OrtReleaseTensor(ae)}},"gpu-buffer"])}else{let Ne=bn(ue),Ye=new Ne(Ge);new Uint8Array(Ye.buffer,Ye.byteOffset,Ye.byteLength).set(a.HEAPU8.subarray(le,le+Ye.byteLength)),We.push([ue,Be,Ye,"cpu"])}}finally{a.stackRestore(Ae),ue==="string"&&le&&a._free(le),ie||a._OrtReleaseTensor(ae)}}return y&&!w&&(a._OrtClearBoundOutputs(y.handle),ar.set(e,[p,h,d,y,w,!1])),We}finally{a.stackRestore(O),x.forEach(Q=>a._OrtReleaseTensor(Q)),E.forEach(Q=>a._OrtReleaseTensor(Q)),P.forEach(Q=>a._free(Q)),A!==0&&a._OrtReleaseRunOptions(A),I.forEach(Q=>a._free(Q))}},Yd=e=>{let t=Le(),r=ar.get(e);if(!r)throw new Error("invalid session id");let o=r[0],i=t._OrtEndProfiling(o);i===0&&Ue("Can\'t get an profile file name."),t._OrtFree(i)},Zd=e=>{let t=[];for(let r of e){let o=r[2];!Array.isArray(o)&&"buffer"in o&&t.push(o.buffer)}return t};self.onmessage=e=>{let{type:t,in:r}=e.data;try{switch(t){case"init-wasm":Wi(r.wasm).then(()=>{Ld(r).then(()=>{postMessage({type:t})},o=>{postMessage({type:t,err:o})})},o=>{postMessage({type:t,err:o})});break;case"init-ep":{let{epName:o,env:i}=r;Fd(i,o).then(()=>{postMessage({type:t})},u=>{postMessage({type:t,err:u})});break}case"copy-from":{let{buffer:o}=r,i=Xo(o);postMessage({type:t,out:i});break}case"create":{let{model:o,options:i}=r;qd(o,i).then(u=>{postMessage({type:t,out:u})},u=>{postMessage({type:t,err:u})});break}case"release":jd(r),postMessage({type:t});break;case"run":{let{sessionId:o,inputIndices:i,inputs:u,outputIndices:a,options:c}=r;Kd(o,i,u,a,new Array(a.length).fill(null),c).then(p=>{p.some(h=>h[3]!=="cpu")?postMessage({type:t,err:"Proxy does not support non-cpu tensor location."}):postMessage({type:t,out:p},Zd([...u,...p]))},p=>{postMessage({type:t,err:p})});break}case"end-profiling":Yd(r),postMessage({type:t});break;default:}}catch(o){postMessage({type:t,err:o})}};})();\n/**\n * @license\n * Copyright 2021 Google LLC. All Rights Reserved.\n * Licensed under the Apache License, Version 2.0 (the "License");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n * http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an "AS IS" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n * =============================================================================\n */\n/**\n * @license\n * Copyright 2020 Google LLC. All Rights Reserved.\n * Licensed under the Apache License, Version 2.0 (the "License");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n * http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an "AS IS" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n * =============================================================================\n */\n/**\n * @license\n * Copyright 2019 Google LLC. All Rights Reserved.\n * Licensed under the Apache License, Version 2.0 (the "License");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n * http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an "AS IS" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n * =============================================================================\n */\n'}),gr,St,sn,pi,mi,Co,Io,zr,Br,pf,ci,Wd,Nd,Vd,Hd,Gd,Ld,Fd,To=j(()=>{var d;_t(),Md(),Or(),gr=()=>!!ke.wasm.proxy&&typeof document<"u",sn=!1,pi=!1,mi=!1,Io=new Map,zr=(g,b)=>{let et=Io.get(g);et?et.push(b):Io.set(g,[b])},Br=()=>{if(sn||!pi||mi||!St)throw new Error("worker not ready")},pf=g=>{switch(g.data.type){case"init-wasm":sn=!1,g.data.err?(mi=!0,Co[1](g.data.err)):(pi=!0,Co[0]());break;case"init-ep":case"copy-from":case"create":case"release":case"run":case"end-profiling":{let b=Io.get(g.data.type);g.data.err?b.shift()[1](g.data.err):b.shift()[0](g.data.out);break}}},ci=typeof document<"u"?(d=document==null?void 0:document.currentScript)==null?void 0:d.src:void 0,Wd=async()=>{if(!pi){if(sn)throw new Error("multiple calls to 'initWasm()' detected.");if(mi)throw new Error("previous call to 'initWasm()' failed.");if(sn=!0,gr())return ke.wasm.wasmPaths===void 0&&ci&&ci.indexOf("blob:")!==0&&(ke.wasm.wasmPaths=ci.substr(0,+ci.lastIndexOf("/")+1)),new Promise((g,b)=>{St==null||St.terminate();let et=URL.createObjectURL(new Blob([Ud()],{type:"text/javascript"}));St=new Worker(et,{name:"ort-wasm-proxy-worker"}),St.onerror=at=>b(at),St.onmessage=pf,URL.revokeObjectURL(et),Co=[g,b];let st={type:"init-wasm",in:ke};St.postMessage(st)});try{await Fa(ke.wasm),await kd(ke),pi=!0}catch(g){throw mi=!0,g}finally{sn=!1}}},Nd=async g=>{if(gr())return Br(),new Promise((b,et)=>{zr("init-ep",[b,et]);let st={type:"init-ep",in:{epName:g,env:ke}};St.postMessage(st)});await Od(ke,g)},Vd=async g=>gr()?(Br(),new Promise((b,et)=>{zr("copy-from",[b,et]);let st={type:"copy-from",in:{buffer:g}};St.postMessage(st,[g.buffer])})):So(g),Hd=async(g,b)=>{if(gr()){if(b!=null&&b.preferredOutputLocation)throw new Error('session option "preferredOutputLocation" is not supported for proxy.');return Br(),new Promise((et,st)=>{zr("create",[et,st]);let at={type:"create",in:{model:g,options:{...b}}},vt=[];g instanceof Uint8Array&&vt.push(g.buffer),St.postMessage(at,vt)})}else return Pd(g,b)},Gd=async g=>{if(gr())return Br(),new Promise((b,et)=>{zr("release",[b,et]);let st={type:"release",in:g};St.postMessage(st)});Rd(g)},Ld=async(g,b,et,st,at,vt)=>{if(gr()){if(et.some(Tt=>Tt[3]!=="cpu"))throw new Error("input tensor on GPU is not supported for proxy.");if(at.some(Tt=>Tt))throw new Error("pre-allocated output tensor is not supported for proxy.");return Br(),new Promise((Tt,Ct)=>{zr("run",[Tt,Ct]);let pt=et,wt={type:"run",in:{sessionId:g,inputIndices:b,inputs:pt,outputIndices:st,options:vt}};St.postMessage(wt,Dd(pt))})}else return zd(g,b,et,st,at,vt)},Fd=async g=>{if(gr())return Br(),new Promise((b,et)=>{zr("end-profiling",[b,et]);let st={type:"end-profiling",in:g};St.postMessage(st)});Bd(g)}}),qd,mf,fi,jd=j(()=>{_t(),To(),ye(),qi(),qd=(d,g)=>{switch(d.location){case"cpu":return[d.type,d.dims,d.data,"cpu"];case"gpu-buffer":return[d.type,d.dims,{gpuBuffer:d.gpuBuffer},"gpu-buffer"];default:throw new Error(`invalid data location: ${d.location} for ${g()}`)}},mf=d=>{switch(d[3]){case"cpu":return new tt(d[0],d[2],d[1]);case"gpu-buffer":{let g=d[0];if(!Vn(g))throw new Error(`not supported data type: ${g} for deserializing GPU tensor`);let{gpuBuffer:b,download:et,dispose:st}=d[2];return tt.fromGpuBuffer(b,{dataType:g,dims:d[1],download:et,dispose:st})}default:throw new Error(`invalid data location: ${d[3]}`)}},fi=class{async fetchModelAndCopyToWasmMemory(d){return Vd(await tn(d))}async loadModel(d,g){yt();let b;typeof d=="string"?typeof process<"u"&&process.versions&&process.versions.node?b=await tn(d):b=await this.fetchModelAndCopyToWasmMemory(d):b=d,[this.sessionId,this.inputNames,this.outputNames]=await Hd(b,g),ut()}async dispose(){return Gd(this.sessionId)}async run(d,g,b){yt();let et=[],st=[];Object.entries(d).forEach($t=>{let Lt=$t[0],jt=$t[1],Ft=this.inputNames.indexOf(Lt);if(Ft===-1)throw new Error(`invalid input '${Lt}'`);et.push(jt),st.push(Ft)});let at=[],vt=[];Object.entries(g).forEach($t=>{let Lt=$t[0],jt=$t[1],Ft=this.outputNames.indexOf(Lt);if(Ft===-1)throw new Error(`invalid output '${Lt}'`);at.push(jt),vt.push(Ft)});let Tt=et.map(($t,Lt)=>qd($t,()=>`input "${this.inputNames[st[Lt]]}"`)),Ct=at.map(($t,Lt)=>$t?qd($t,()=>`output "${this.outputNames[vt[Lt]]}"`):null),pt=await Ld(this.sessionId,st,Tt,vt,Ct,b),wt={};for(let $t=0;$t<pt.length;$t++)wt[this.outputNames[vt[$t]]]=at[$t]??mf(pt[$t]);return ut(),wt}startProfiling(){}endProfiling(){Fd(this.sessionId)}}}),ff,hi,Kd=j(()=>{_t(),To(),jd(),ff=()=>{if((typeof ke.wasm.initTimeout!="number"||ke.wasm.initTimeout<0)&&(ke.wasm.initTimeout=0),typeof ke.wasm.simd!="boolean"&&(ke.wasm.simd=!0),typeof ke.wasm.proxy!="boolean"&&(ke.wasm.proxy=!1),typeof ke.wasm.trace!="boolean"&&(ke.wasm.trace=!1),typeof ke.wasm.numThreads!="number"||!Number.isInteger(ke.wasm.numThreads)||ke.wasm.numThreads<=0){(typeof self<"u"&&!self.crossOriginIsolated||typeof process<"u"&&process.versions&&process.versions.node)&&(ke.wasm.numThreads=1);let d=typeof navigator>"u"?(void 0)().length:navigator.hardwareConcurrency;ke.wasm.numThreads=Math.min(4,Math.ceil((d||1)/2))}},hi=class{async init(d){ff(),await Wd(),await Nd(d)}async createInferenceSessionHandler(d,g){let b=new fi;return await b.loadModel(d,g),Promise.resolve(b)}}}),Yd={};kr(Yd,{wasmBackend:()=>hf});var hf,Xd=j(()=>{Kd(),hf=new hi});_t();_t();_t();var ka="1.18.0",h$=Bi;{let d=(Xd(),sr(Yd)).wasmBackend;lr("webgpu",d,5),lr("webnn",d,5),lr("cpu",d,10),lr("wasm",d,10)}Object.defineProperty(ke.versions,"web",{value:ka,enumerable:!0});/**
* @license
* Copyright 2021 Google LLC. All Rights Reserved.
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
* http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
* =============================================================================
*//**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 *//**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ort_gpu=Object.freeze(Object.defineProperty({__proto__:null,get InferenceSession(){return uc},get TRACE(){return Bn},get TRACE_FUNC_BEGIN(){return yt},get TRACE_FUNC_END(){return ut},get Tensor(){return tt},get TrainingSession(){return dc},default:h$,get env(){return ke},get registerBackend(){return lr}},Symbol.toStringTag,{value:"Module"}));var __create=Object.create,__defProp=Object.defineProperty,__getOwnPropDesc=Object.getOwnPropertyDescriptor,__getOwnPropNames=Object.getOwnPropertyNames,__getProtoOf=Object.getPrototypeOf,__hasOwnProp=Object.prototype.hasOwnProperty,__commonJS=(d,g)=>function(){return g||(0,d[__getOwnPropNames(d)[0]])((g={exports:{}}).exports,g),g.exports},__copyProps=(d,g,b,et)=>{if(g&&typeof g=="object"||typeof g=="function")for(let st of __getOwnPropNames(g))!__hasOwnProp.call(d,st)&&st!==b&&__defProp(d,st,{get:()=>g[st],enumerable:!(et=__getOwnPropDesc(g,st))||et.enumerable});return d},__toESM=(d,g,b)=>(b=d!=null?__create(__getProtoOf(d)):{},__copyProps(!d||!d.__esModule?__defProp(b,"default",{value:d,enumerable:!0}):b,d)),require_lodash=__commonJS({"../../node_modules/lodash/lodash.js"(d,g){(function(){var b,et="4.17.21",st=200,at="Unsupported core-js use. Try https://npms.io/search?q=ponyfill.",vt="Expected a function",Tt="Invalid `variable` option passed into `_.template`",Ct="__lodash_hash_undefined__",pt=500,wt="__lodash_placeholder__",$t=1,Lt=2,jt=4,Ft=1,Gt=2,Ht=1,qt=2,Kt=4,rr=8,ir=16,or=32,jr=64,qr=128,Yr=256,vn=512,ko=30,Xo="...",zo=800,t0=16,Uo=1,No=2,_n=3,Kr=1/0,e0=9007199254740991,Zr=17976931348623157e292,Ro=NaN,Sn=4294967295,Tn=Sn-1,n0=Sn>>>1,Go=[["ary",qr],["bind",Ht],["bindKey",qt],["curry",rr],["curryRight",ir],["flip",vn],["partial",or],["partialRight",jr],["rearg",Yr]],An="[object Arguments]",a0="[object Array]",u0="[object AsyncFunction]",d0="[object Boolean]",f0="[object Date]",y0="[object DOMException]",b0="[object Error]",O0="[object Function]",C0="[object GeneratorFunction]",v0="[object Map]",k0="[object Number]",N0="[object Null]",w0="[object Object]",r0="[object Promise]",p0="[object Proxy]",$0="[object RegExp]",A0="[object Set]",g0="[object String]",E0="[object Symbol]",F0="[object Undefined]",K0="[object WeakMap]",l1="[object WeakSet]",n1="[object ArrayBuffer]",x1="[object DataView]",u1="[object Float32Array]",P1="[object Float64Array]",i1="[object Int8Array]",v1="[object Int16Array]",_1="[object Int32Array]",X1="[object Uint8Array]",t1="[object Uint8ClampedArray]",cv="[object Uint16Array]",S1="[object Uint32Array]",ev=/\b__p \+= '';/g,c0=/\b(__p \+=) '' \+/g,P0=/(__e\(.*?\)|\b__t\)) \+\n'';/g,R0=/&(?:amp|lt|gt|quot|#39);/g,B0=/[&<>"']/g,W0=RegExp(R0.source),s1=RegExp(B0.source),E1=/<%-([\s\S]+?)%>/g,Q1=/<%([\s\S]+?)%>/g,K1=/<%=([\s\S]+?)%>/g,W1=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,nv=/^\w*$/,Nv=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,pv=/[\\^$.*+?()[\]{}|]/g,j0=RegExp(pv.source),N1=/^\s+/,T0=/\s/,c1=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/,O1=/\{\n\/\* \[wrapped with (.+)\] \*/,T1=/,? & /,d1=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g,lv=/[()=,{}\[\]\/\s]/,iv=/\\(\\)?/g,dv=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,uv=/\w*$/,Rv=/^[-+]0x[0-9a-f]+$/i,wv=/^0b[01]+$/i,Uv=/^\[object .+?Constructor\]$/,_v=/^0o[0-7]+$/i,iy=/^(?:0|[1-9]\d*)$/,Sy=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,Sv=/($^)/,Av=/['\n\r\u2028\u2029\\]/g,Qv="\\ud800-\\udfff",Ey="\\u0300-\\u036f",Lv="\\ufe20-\\ufe2f",Ky="\\u20d0-\\u20ff",hv=Ey+Lv+Ky,Ty="\\u2700-\\u27bf",py="a-z\\xdf-\\xf6\\xf8-\\xff",Pv="\\xac\\xb1\\xd7\\xf7",Cy="\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf",mv="\\u2000-\\u206f",Ev=" \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",oy="A-Z\\xc0-\\xd6\\xd8-\\xde",Zy="\\ufe0e\\ufe0f",Qy=Pv+Cy+mv+Ev,Oy="[']",d$="["+Qv+"]",Jy="["+Qy+"]",Ay="["+hv+"]",b1="\\d+",Fy="["+Ty+"]",w1="["+py+"]",Py="[^"+Qv+Qy+b1+Ty+py+oy+"]",jv="\\ud83c[\\udffb-\\udfff]",yv="(?:"+Ay+"|"+jv+")",hy="[^"+Qv+"]",ay="(?:\\ud83c[\\udde6-\\uddff]){2}",my="[\\ud800-\\udbff][\\udc00-\\udfff]",Tv="["+oy+"]",ky="\\u200d",kv="(?:"+w1+"|"+Py+")",Dv="(?:"+Tv+"|"+Py+")",gy="(?:"+Oy+"(?:d|ll|m|re|s|t|ve))?",Vv="(?:"+Oy+"(?:D|LL|M|RE|S|T|VE))?",Mo=yv+"?",Ir="["+Zy+"]?",Xr="(?:"+ky+"(?:"+[hy,ay,my].join("|")+")"+Ir+Mo+")*",In="\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",Qo="\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])",s0=Ir+Mo+Xr,x0="(?:"+[Fy,ay,my].join("|")+")"+s0,H0="(?:"+[hy+Ay+"?",Ay,ay,my,d$].join("|")+")",Z0=RegExp(Oy,"g"),r1=RegExp(Ay,"g"),e1=RegExp(jv+"(?="+jv+")|"+H0+s0,"g"),$1=RegExp([Tv+"?"+w1+"+"+gy+"(?="+[Jy,Tv,"$"].join("|")+")",Dv+"+"+Vv+"(?="+[Jy,Tv+kv,"$"].join("|")+")",Tv+"?"+kv+"+"+gy,Tv+"+"+Vv,Qo,In,b1,x0].join("|"),"g"),B1=RegExp("["+ky+Qv+hv+Zy+"]"),L0=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,M0=["Array","Buffer","DataView","Date","Error","Float32Array","Float64Array","Function","Int8Array","Int16Array","Int32Array","Map","Math","Object","Promise","RegExp","Set","String","Symbol","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","WeakMap","_","clearTimeout","isFinite","parseInt","setTimeout"],f1=-1,p1={};p1[u1]=p1[P1]=p1[i1]=p1[v1]=p1[_1]=p1[X1]=p1[t1]=p1[cv]=p1[S1]=!0,p1[An]=p1[a0]=p1[n1]=p1[d0]=p1[x1]=p1[f0]=p1[b0]=p1[O0]=p1[v0]=p1[k0]=p1[w0]=p1[$0]=p1[A0]=p1[g0]=p1[K0]=!1;var z1={};z1[An]=z1[a0]=z1[n1]=z1[x1]=z1[d0]=z1[f0]=z1[u1]=z1[P1]=z1[i1]=z1[v1]=z1[_1]=z1[v0]=z1[k0]=z1[w0]=z1[$0]=z1[A0]=z1[g0]=z1[E0]=z1[X1]=z1[t1]=z1[cv]=z1[S1]=!0,z1[b0]=z1[O0]=z1[K0]=!1;var Iy={:"A",:"A",:"A",:"A",:"A",:"A",:"a",:"a",:"a",:"a",:"a",:"a",:"C",:"c",:"D",:"d",:"E",:"E",:"E",:"E",:"e",:"e",:"e",:"e",:"I",:"I",:"I",:"I",:"i",:"i",:"i",:"i",:"N",:"n",:"O",:"O",:"O",:"O",:"O",:"O",:"o",:"o",:"o",:"o",:"o",:"o",:"U",:"U",:"U",:"U",:"u",:"u",:"u",:"u",:"Y",:"y",:"y",:"Ae",:"ae",:"Th",:"th",:"ss",:"A",:"A",:"A",:"a",:"a",:"a",:"C",:"C",:"C",:"C",:"c",:"c",:"c",:"c",:"D",:"D",:"d",:"d",:"E",:"E",:"E",:"E",:"E",:"e",:"e",:"e",:"e",:"e",:"G",:"G",:"G",:"G",:"g",:"g",:"g",:"g",:"H",:"H",:"h",:"h",:"I",:"I",:"I",:"I",:"I",:"i",:"i",:"i",:"i",:"i",:"J",:"j",:"K",:"k",:"k",:"L",:"L",:"L",:"L",:"L",:"l",:"l",:"l",:"l",:"l",:"N",:"N",:"N",:"N",:"n",:"n",:"n",:"n",:"O",:"O",:"O",:"o",:"o",:"o",:"R",:"R",:"R",:"r",:"r",:"r",:"S",:"S",:"S",:"S",:"s",:"s",:"s",:"s",:"T",:"T",:"T",:"t",:"t",:"t",:"U",:"U",:"U",:"U",:"U",:"U",:"u",:"u",:"u",:"u",:"u",:"u",:"W",:"w",:"Y",:"y",:"Y",:"Z",:"Z",:"Z",:"z",:"z",:"z",:"IJ",:"ij",:"Oe",:"oe",:"'n",:"s"},Kx={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},Zx={"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"},Qx={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"},Jx=parseFloat,hx=parseInt,mx=typeof global=="object"&&global&&global.Object===Object&&global,gx=typeof self=="object"&&self&&self.Object===Object&&self,bv=mx||gx||Function("return this")(),O$=typeof d=="object"&&d&&!d.nodeType&&d,By=O$&&typeof g=="object"&&g&&!g.nodeType&&g,vx=By&&By.exports===O$,z$=vx&&mx.process,Wv=function(){try{var I0=By&&By.require&&By.require("util").types;return I0||z$&&z$.binding&&z$.binding("util")}catch{}}(),yx=Wv&&Wv.isArrayBuffer,e2=Wv&&Wv.isDate,bx=Wv&&Wv.isMap,$x=Wv&&Wv.isRegExp,xx=Wv&&Wv.isSet,t2=Wv&&Wv.isTypedArray;function Hv(I0,G0,z0){switch(z0.length){case 0:return I0.call(G0);case 1:return I0.call(G0,z0[0]);case 2:return I0.call(G0,z0[0],z0[1]);case 3:return I0.call(G0,z0[0],z0[1],z0[2])}return I0.apply(G0,z0)}function r2(I0,G0,z0,m1){for(var D1=-1,J1=I0==null?0:I0.length;++D1<J1;){var Cv=I0[D1];G0(m1,Cv,z0(Cv),I0)}return m1}function Gv(I0,G0){for(var z0=-1,m1=I0==null?0:I0.length;++z0<m1&&G0(I0[z0],z0,I0)!==!1;);return I0}function U$(I0,G0){for(var z0=I0==null?0:I0.length;z0--&&G0(I0[z0],z0,I0)!==!1;);return I0}function n2(I0,G0){for(var z0=-1,m1=I0==null?0:I0.length;++z0<m1;)if(!G0(I0[z0],z0,I0))return!1;return!0}function zy(I0,G0){for(var z0=-1,m1=I0==null?0:I0.length,D1=0,J1=[];++z0<m1;){var Cv=I0[z0];G0(Cv,z0,I0)&&(J1[D1++]=Cv)}return J1}function g1(I0,G0){var z0=I0==null?0:I0.length;return!!z0&&Uy(I0,G0,0)>-1}function V$(I0,G0,z0){for(var m1=-1,D1=I0==null?0:I0.length;++m1<D1;)if(z0(G0,I0[m1]))return!0;return!1}function ov(I0,G0){for(var z0=-1,m1=I0==null?0:I0.length,D1=Array(m1);++z0<m1;)D1[z0]=G0(I0[z0],z0,I0);return D1}function sy(I0,G0){for(var z0=-1,m1=G0.length,D1=I0.length;++z0<m1;)I0[D1+z0]=G0[z0];return I0}function Jv(I0,G0,z0,m1){var D1=-1,J1=I0==null?0:I0.length;for(m1&&J1&&(z0=I0[++D1]);++D1<J1;)z0=G0(z0,I0[D1],D1,I0);return z0}function i2(I0,G0,z0,m1){var D1=I0==null?0:I0.length;for(m1&&D1&&(z0=I0[--D1]);D1--;)z0=G0(z0,I0[D1],D1,I0);return z0}function W$(I0,G0){for(var z0=-1,m1=I0==null?0:I0.length;++z0<m1;)if(G0(I0[z0],z0,I0))return!0;return!1}var wx=H$("length");function _x(I0){return I0.split("")}function o2(I0){return I0.match(d1)||[]}function Sx(I0,G0,z0){var m1;return z0(I0,function(D1,J1,Cv){if(G0(D1,J1,Cv))return m1=J1,!1}),m1}function e$(I0,G0,z0,m1){for(var D1=I0.length,J1=z0+(m1?1:-1);m1?J1--:++J1<D1;)if(G0(I0[J1],J1,I0))return J1;return-1}function Uy(I0,G0,z0){return G0===G0?KS(I0,G0,z0):e$(I0,Tx,z0)}function Ex(I0,G0,z0,m1){for(var D1=z0-1,J1=I0.length;++D1<J1;)if(m1(I0[D1],G0))return D1;return-1}function Tx(I0){return I0!==I0}function Cx(I0,G0){var z0=I0==null?0:I0.length;return z0?f$(I0,G0)/z0:Ro}function H$(I0){return function(G0){return G0==null?b:G0[I0]}}function G$(I0){return function(G0){return I0==null?b:I0[G0]}}function Ox(I0,G0,z0,m1,D1){return D1(I0,function(J1,Cv,sv){z0=m1?(m1=!1,J1):G0(z0,J1,Cv,sv)}),z0}function G2(I0,G0){var z0=I0.length;for(I0.sort(G0);z0--;)I0[z0]=I0[z0].value;return I0}function f$(I0,G0){for(var z0,m1=-1,D1=I0.length;++m1<D1;){var J1=G0(I0[m1]);J1!==b&&(z0=z0===b?J1:z0+J1)}return z0}function q$(I0,G0){for(var z0=-1,m1=Array(I0);++z0<I0;)m1[z0]=G0(z0);return m1}function Hr(I0,G0){return ov(G0,function(z0){return[z0,I0[z0]]})}function xn(I0){return I0&&I0.slice(0,Hw(I0)+1).replace(N1,"")}function Bo(I0){return function(G0){return I0(G0)}}function i0(I0,G0){return ov(G0,function(z0){return I0[z0]})}function h0(I0,G0){return I0.has(G0)}function S0(I0,G0){for(var z0=-1,m1=I0.length;++z0<m1&&Uy(G0,I0[z0],0)>-1;);return z0}function V0(I0,G0){for(var z0=I0.length;z0--&&Uy(G0,I0[z0],0)>-1;);return z0}function J0(I0,G0){for(var z0=I0.length,m1=0;z0--;)I0[z0]===G0&&++m1;return m1}var h1=G$(Iy),o1=G$(Kx);function C1(I0){return"\\"+Qx[I0]}function Z1(I0,G0){return I0==null?b:I0[G0]}function q1(I0){return B1.test(I0)}function U0(I0){return L0.test(I0)}function R1(I0){for(var G0,z0=[];!(G0=I0.next()).done;)z0.push(G0.value);return z0}function H1(I0){var G0=-1,z0=Array(I0.size);return I0.forEach(function(m1,D1){z0[++G0]=[D1,m1]}),z0}function Vy(I0,G0){return function(z0){return I0(G0(z0))}}function Ry(I0,G0){for(var z0=-1,m1=I0.length,D1=0,J1=[];++z0<m1;){var Cv=I0[z0];(Cv===G0||Cv===wt)&&(I0[z0]=wt,J1[D1++]=z0)}return J1}function a2(I0){var G0=-1,z0=Array(I0.size);return I0.forEach(function(m1){z0[++G0]=m1}),z0}function XS(I0){var G0=-1,z0=Array(I0.size);return I0.forEach(function(m1){z0[++G0]=[m1,m1]}),z0}function KS(I0,G0,z0){for(var m1=z0-1,D1=I0.length;++m1<D1;)if(I0[m1]===G0)return m1;return-1}function ZS(I0,G0,z0){for(var m1=z0+1;m1--;)if(I0[m1]===G0)return m1;return m1}function Y$(I0){return q1(I0)?JS(I0):wx(I0)}function Dy(I0){return q1(I0)?eE(I0):_x(I0)}function Hw(I0){for(var G0=I0.length;G0--&&T0.test(I0.charAt(G0)););return G0}var QS=G$(Zx);function JS(I0){for(var G0=e1.lastIndex=0;e1.test(I0);)++G0;return G0}function eE(I0){return I0.match(e1)||[]}function tE(I0){return I0.match($1)||[]}var rE=function I0(G0){G0=G0==null?bv:p$.defaults(bv.Object(),G0,p$.pick(bv,M0));var z0=G0.Array,m1=G0.Date,D1=G0.Error,J1=G0.Function,Cv=G0.Math,sv=G0.Object,q2=G0.RegExp,nE=G0.String,vy=G0.TypeError,s2=z0.prototype,iE=J1.prototype,X$=sv.prototype,l2=G0["__core-js_shared__"],u2=iE.toString,av=X$.hasOwnProperty,oE=0,Gw=function(){var tr=/[^.]+$/.exec(l2&&l2.keys&&l2.keys.IE_PROTO||"");return tr?"Symbol(src)_1."+tr:""}(),c2=X$.toString,aE=u2.call(sv),sE=bv._,lE=q2("^"+u2.call(av).replace(pv,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),d2=vx?G0.Buffer:b,m$=G0.Symbol,f2=G0.Uint8Array,qw=d2?d2.allocUnsafe:b,p2=Vy(sv.getPrototypeOf,sv),Yw=sv.create,Xw=X$.propertyIsEnumerable,h2=s2.splice,Kw=m$?m$.isConcatSpreadable:b,Ax=m$?m$.iterator:b,A$=m$?m$.toStringTag:b,m2=function(){try{var tr=D$(sv,"defineProperty");return tr({},"",{}),tr}catch{}}(),uE=G0.clearTimeout!==bv.clearTimeout&&G0.clearTimeout,cE=m1&&m1.now!==bv.Date.now&&m1.now,dE=G0.setTimeout!==bv.setTimeout&&G0.setTimeout,g2=Cv.ceil,v2=Cv.floor,Y2=sv.getOwnPropertySymbols,fE=d2?d2.isBuffer:b,Zw=G0.isFinite,pE=s2.join,hE=Vy(sv.keys,sv),Ov=Cv.max,Fv=Cv.min,mE=m1.now,gE=G0.parseInt,Qw=Cv.random,vE=s2.reverse,X2=D$(G0,"DataView"),Px=D$(G0,"Map"),K2=D$(G0,"Promise"),K$=D$(G0,"Set"),kx=D$(G0,"WeakMap"),Ix=D$(sv,"create"),y2=kx&&new kx,Z$={},yE=M$(X2),bE=M$(Px),$E=M$(K2),xE=M$(K$),wE=M$(kx),b2=m$?m$.prototype:b,Rx=b2?b2.valueOf:b,Jw=b2?b2.toString:b;function o0(tr){if(gv(tr)&&!M1(tr)&&!(tr instanceof G1)){if(tr instanceof yy)return tr;if(av.call(tr,"__wrapped__"))return eS(tr)}return new yy(tr)}var Q$=function(){function tr(){}return function(nr){if(!fv(nr))return{};if(Yw)return Yw(nr);tr.prototype=nr;var Lr=new tr;return tr.prototype=b,Lr}}();function $2(){}function yy(tr,nr){this.__wrapped__=tr,this.__actions__=[],this.__chain__=!!nr,this.__index__=0,this.__values__=b}o0.templateSettings={escape:E1,evaluate:Q1,interpolate:K1,variable:"",imports:{_:o0}},o0.prototype=$2.prototype,o0.prototype.constructor=o0,yy.prototype=Q$($2.prototype),yy.prototype.constructor=yy;function G1(tr){this.__wrapped__=tr,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=Sn,this.__views__=[]}function _E(){var tr=new G1(this.__wrapped__);return tr.__actions__=ey(this.__actions__),tr.__dir__=this.__dir__,tr.__filtered__=this.__filtered__,tr.__iteratees__=ey(this.__iteratees__),tr.__takeCount__=this.__takeCount__,tr.__views__=ey(this.__views__),tr}function SE(){if(this.__filtered__){var tr=new G1(this);tr.__dir__=-1,tr.__filtered__=!0}else tr=this.clone(),tr.__dir__*=-1;return tr}function EE(){var tr=this.__wrapped__.value(),nr=this.__dir__,Lr=M1(tr),wn=nr<0,_g=Lr?tr.length:0,l0=L3(0,_g,this.__views__),m0=l0.start,_0=l0.end,D0=_0-m0,q0=wn?_0:m0-1,Y0=this.__iteratees__,Q0=Y0.length,a1=0,y1=Fv(D0,this.__takeCount__);if(!Lr||!wn&&_g==D0&&y1==D0)return __(tr,this.__actions__);var k1=[];e:for(;D0--&&a1<y1;){q0+=nr;for(var j1=-1,I1=tr[q0];++j1<Q0;){var V1=Y0[j1],Y1=V1.iteratee,cy=V1.type,Xv=Y1(I1);if(cy==No)I1=Xv;else if(!Xv){if(cy==Uo)continue e;break e}}k1[a1++]=I1}return k1}G1.prototype=Q$($2.prototype),G1.prototype.constructor=G1;function P$(tr){var nr=-1,Lr=tr==null?0:tr.length;for(this.clear();++nr<Lr;){var wn=tr[nr];this.set(wn[0],wn[1])}}function TE(){this.__data__=Ix?Ix(null):{},this.size=0}function CE(tr){var nr=this.has(tr)&&delete this.__data__[tr];return this.size-=nr?1:0,nr}function OE(tr){var nr=this.__data__;if(Ix){var Lr=nr[tr];return Lr===Ct?b:Lr}return av.call(nr,tr)?nr[tr]:b}function AE(tr){var nr=this.__data__;return Ix?nr[tr]!==b:av.call(nr,tr)}function PE(tr,nr){var Lr=this.__data__;return this.size+=this.has(tr)?0:1,Lr[tr]=Ix&&nr===b?Ct:nr,this}P$.prototype.clear=TE,P$.prototype.delete=CE,P$.prototype.get=OE,P$.prototype.has=AE,P$.prototype.set=PE;function t$(tr){var nr=-1,Lr=tr==null?0:tr.length;for(this.clear();++nr<Lr;){var wn=tr[nr];this.set(wn[0],wn[1])}}function kE(){this.__data__=[],this.size=0}function IE(tr){var nr=this.__data__,Lr=x2(nr,tr);if(Lr<0)return!1;var wn=nr.length-1;return Lr==wn?nr.pop():h2.call(nr,Lr,1),--this.size,!0}function RE(tr){var nr=this.__data__,Lr=x2(nr,tr);return Lr<0?b:nr[Lr][1]}function DE(tr){return x2(this.__data__,tr)>-1}function ME(tr,nr){var Lr=this.__data__,wn=x2(Lr,tr);return wn<0?(++this.size,Lr.push([tr,nr])):Lr[wn][1]=nr,this}t$.prototype.clear=kE,t$.prototype.delete=IE,t$.prototype.get=RE,t$.prototype.has=DE,t$.prototype.set=ME;function r$(tr){var nr=-1,Lr=tr==null?0:tr.length;for(this.clear();++nr<Lr;){var wn=tr[nr];this.set(wn[0],wn[1])}}function NE(){this.size=0,this.__data__={hash:new P$,map:new(Px||t$),string:new P$}}function LE(tr){var nr=R2(this,tr).delete(tr);return this.size-=nr?1:0,nr}function jE(tr){return R2(this,tr).get(tr)}function FE(tr){return R2(this,tr).has(tr)}function BE(tr,nr){var Lr=R2(this,tr),wn=Lr.size;return Lr.set(tr,nr),this.size+=Lr.size==wn?0:1,this}r$.prototype.clear=NE,r$.prototype.delete=LE,r$.prototype.get=jE,r$.prototype.has=FE,r$.prototype.set=BE;function k$(tr){var nr=-1,Lr=tr==null?0:tr.length;for(this.__data__=new r$;++nr<Lr;)this.add(tr[nr])}function zE(tr){return this.__data__.set(tr,Ct),this}function UE(tr){return this.__data__.has(tr)}k$.prototype.add=k$.prototype.push=zE,k$.prototype.has=UE;function My(tr){var nr=this.__data__=new t$(tr);this.size=nr.size}function VE(){this.__data__=new t$,this.size=0}function WE(tr){var nr=this.__data__,Lr=nr.delete(tr);return this.size=nr.size,Lr}function HE(tr){return this.__data__.get(tr)}function GE(tr){return this.__data__.has(tr)}function qE(tr,nr){var Lr=this.__data__;if(Lr instanceof t$){var wn=Lr.__data__;if(!Px||wn.length<st-1)return wn.push([tr,nr]),this.size=++Lr.size,this;Lr=this.__data__=new r$(wn)}return Lr.set(tr,nr),this.size=Lr.size,this}My.prototype.clear=VE,My.prototype.delete=WE,My.prototype.get=HE,My.prototype.has=GE,My.prototype.set=qE;function e_(tr,nr){var Lr=M1(tr),wn=!Lr&&N$(tr),_g=!Lr&&!wn&&$$(tr),l0=!Lr&&!wn&&!_g&&rx(tr),m0=Lr||wn||_g||l0,_0=m0?q$(tr.length,nE):[],D0=_0.length;for(var q0 in tr)(nr||av.call(tr,q0))&&!(m0&&(q0=="length"||_g&&(q0=="offset"||q0=="parent")||l0&&(q0=="buffer"||q0=="byteLength"||q0=="byteOffset")||a$(q0,D0)))&&_0.push(q0);return _0}function t_(tr){var nr=tr.length;return nr?tr[sw(0,nr-1)]:b}function YE(tr,nr){return D2(ey(tr),I$(nr,0,tr.length))}function XE(tr){return D2(ey(tr))}function Z2(tr,nr,Lr){(Lr!==b&&!Ny(tr[nr],Lr)||Lr===b&&!(nr in tr))&&n$(tr,nr,Lr)}function Dx(tr,nr,Lr){var wn=tr[nr];(!(av.call(tr,nr)&&Ny(wn,Lr))||Lr===b&&!(nr in tr))&&n$(tr,nr,Lr)}function x2(tr,nr){for(var Lr=tr.length;Lr--;)if(Ny(tr[Lr][0],nr))return Lr;return-1}function KE(tr,nr,Lr,wn){return g$(tr,function(_g,l0,m0){nr(wn,_g,Lr(_g),m0)}),wn}function r_(tr,nr){return tr&&Hy(nr,Iv(nr),tr)}function ZE(tr,nr){return tr&&Hy(nr,ry(nr),tr)}function n$(tr,nr,Lr){nr=="__proto__"&&m2?m2(tr,nr,{configurable:!0,enumerable:!0,value:Lr,writable:!0}):tr[nr]=Lr}function Q2(tr,nr){for(var Lr=-1,wn=nr.length,_g=z0(wn),l0=tr==null;++Lr<wn;)_g[Lr]=l0?b:Iw(tr,nr[Lr]);return _g}function I$(tr,nr,Lr){return tr===tr&&(Lr!==b&&(tr=tr<=Lr?tr:Lr),nr!==b&&(tr=tr>=nr?tr:nr)),tr}function by(tr,nr,Lr,wn,_g,l0){var m0,_0=nr&$t,D0=nr&Lt,q0=nr&jt;if(Lr&&(m0=_g?Lr(tr,wn,_g,l0):Lr(tr)),m0!==b)return m0;if(!fv(tr))return tr;var Y0=M1(tr);if(Y0){if(m0=F3(tr),!_0)return ey(tr,m0)}else{var Q0=Bv(tr),a1=Q0==O0||Q0==C0;if($$(tr))return T_(tr,_0);if(Q0==w0||Q0==An||a1&&!_g){if(m0=D0||a1?{}:H_(tr),!_0)return D0?O3(tr,ZE(m0,tr)):C3(tr,r_(m0,tr))}else{if(!z1[Q0])return _g?tr:{};m0=B3(tr,Q0,_0)}}l0||(l0=new My);var y1=l0.get(tr);if(y1)return y1;l0.set(tr,m0),$S(tr)?tr.forEach(function(I1){m0.add(by(I1,nr,Lr,I1,tr,l0))}):yS(tr)&&tr.forEach(function(I1,V1){m0.set(V1,by(I1,nr,Lr,V1,tr,l0))});var k1=q0?D0?yw:vw:D0?ry:Iv,j1=Y0?b:k1(tr);return Gv(j1||tr,function(I1,V1){j1&&(V1=I1,I1=tr[V1]),Dx(m0,V1,by(I1,nr,Lr,V1,tr,l0))}),m0}function QE(tr){var nr=Iv(tr);return function(Lr){return n_(Lr,tr,nr)}}function n_(tr,nr,Lr){var wn=Lr.length;if(tr==null)return!wn;for(tr=sv(tr);wn--;){var _g=Lr[wn],l0=nr[_g],m0=tr[_g];if(m0===b&&!(_g in tr)||!l0(m0))return!1}return!0}function i_(tr,nr,Lr){if(typeof tr!="function")throw new vy(vt);return zx(function(){tr.apply(b,Lr)},nr)}function Mx(tr,nr,Lr,wn){var _g=-1,l0=g1,m0=!0,_0=tr.length,D0=[],q0=nr.length;if(!_0)return D0;Lr&&(nr=ov(nr,Bo(Lr))),wn?(l0=V$,m0=!1):nr.length>=st&&(l0=h0,m0=!1,nr=new k$(nr));e:for(;++_g<_0;){var Y0=tr[_g],Q0=Lr==null?Y0:Lr(Y0);if(Y0=wn||Y0!==0?Y0:0,m0&&Q0===Q0){for(var a1=q0;a1--;)if(nr[a1]===Q0)continue e;D0.push(Y0)}else l0(nr,Q0,wn)||D0.push(Y0)}return D0}var g$=k_(Wy),o_=k_(ew,!0);function JE(tr,nr){var Lr=!0;return g$(tr,function(wn,_g,l0){return Lr=!!nr(wn,_g,l0),Lr}),Lr}function w2(tr,nr,Lr){for(var wn=-1,_g=tr.length;++wn<_g;){var l0=tr[wn],m0=nr(l0);if(m0!=null&&(_0===b?m0===m0&&!uy(m0):Lr(m0,_0)))var _0=m0,D0=l0}return D0}function e3(tr,nr,Lr,wn){var _g=tr.length;for(Lr=L1(Lr),Lr<0&&(Lr=-Lr>_g?0:_g+Lr),wn=wn===b||wn>_g?_g:L1(wn),wn<0&&(wn+=_g),wn=Lr>wn?0:wS(wn);Lr<wn;)tr[Lr++]=nr;return tr}function a_(tr,nr){var Lr=[];return g$(tr,function(wn,_g,l0){nr(wn,_g,l0)&&Lr.push(wn)}),Lr}function Mv(tr,nr,Lr,wn,_g){var l0=-1,m0=tr.length;for(Lr||(Lr=U3),_g||(_g=[]);++l0<m0;){var _0=tr[l0];nr>0&&Lr(_0)?nr>1?Mv(_0,nr-1,Lr,wn,_g):sy(_g,_0):wn||(_g[_g.length]=_0)}return _g}var J2=I_(),s_=I_(!0);function Wy(tr,nr){return tr&&J2(tr,nr,Iv)}function ew(tr,nr){return tr&&s_(tr,nr,Iv)}function _2(tr,nr){return zy(nr,function(Lr){return s$(tr[Lr])})}function R$(tr,nr){nr=y$(nr,tr);for(var Lr=0,wn=nr.length;tr!=null&&Lr<wn;)tr=tr[Gy(nr[Lr++])];return Lr&&Lr==wn?tr:b}function l_(tr,nr,Lr){var wn=nr(tr);return M1(tr)?wn:sy(wn,Lr(tr))}function qv(tr){return tr==null?tr===b?F0:N0:A$&&A$ in sv(tr)?N3(tr):X3(tr)}function tw(tr,nr){return tr>nr}function t3(tr,nr){return tr!=null&&av.call(tr,nr)}function r3(tr,nr){return tr!=null&&nr in sv(tr)}function n3(tr,nr,Lr){return tr>=Fv(nr,Lr)&&tr<Ov(nr,Lr)}function rw(tr,nr,Lr){for(var wn=Lr?V$:g1,_g=tr[0].length,l0=tr.length,m0=l0,_0=z0(l0),D0=1/0,q0=[];m0--;){var Y0=tr[m0];m0&&nr&&(Y0=ov(Y0,Bo(nr))),D0=Fv(Y0.length,D0),_0[m0]=!Lr&&(nr||_g>=120&&Y0.length>=120)?new k$(m0&&Y0):b}Y0=tr[0];var Q0=-1,a1=_0[0];e:for(;++Q0<_g&&q0.length<D0;){var y1=Y0[Q0],k1=nr?nr(y1):y1;if(y1=Lr||y1!==0?y1:0,!(a1?h0(a1,k1):wn(q0,k1,Lr))){for(m0=l0;--m0;){var j1=_0[m0];if(!(j1?h0(j1,k1):wn(tr[m0],k1,Lr)))continue e}a1&&a1.push(k1),q0.push(y1)}}return q0}function i3(tr,nr,Lr,wn){return Wy(tr,function(_g,l0,m0){nr(wn,Lr(_g),l0,m0)}),wn}function Nx(tr,nr,Lr){nr=y$(nr,tr),tr=X_(tr,nr);var wn=tr==null?tr:tr[Gy(xy(nr))];return wn==null?b:Hv(wn,tr,Lr)}function u_(tr){return gv(tr)&&qv(tr)==An}function o3(tr){return gv(tr)&&qv(tr)==n1}function a3(tr){return gv(tr)&&qv(tr)==f0}function Lx(tr,nr,Lr,wn,_g){return tr===nr?!0:tr==null||nr==null||!gv(tr)&&!gv(nr)?tr!==tr&&nr!==nr:s3(tr,nr,Lr,wn,Lx,_g)}function s3(tr,nr,Lr,wn,_g,l0){var m0=M1(tr),_0=M1(nr),D0=m0?a0:Bv(tr),q0=_0?a0:Bv(nr);D0=D0==An?w0:D0,q0=q0==An?w0:q0;var Y0=D0==w0,Q0=q0==w0,a1=D0==q0;if(a1&&$$(tr)){if(!$$(nr))return!1;m0=!0,Y0=!1}if(a1&&!Y0)return l0||(l0=new My),m0||rx(tr)?U_(tr,nr,Lr,wn,_g,l0):D3(tr,nr,D0,Lr,wn,_g,l0);if(!(Lr&Ft)){var y1=Y0&&av.call(tr,"__wrapped__"),k1=Q0&&av.call(nr,"__wrapped__");if(y1||k1){var j1=y1?tr.value():tr,I1=k1?nr.value():nr;return l0||(l0=new My),_g(j1,I1,Lr,wn,l0)}}return a1?(l0||(l0=new My),M3(tr,nr,Lr,wn,_g,l0)):!1}function l3(tr){return gv(tr)&&Bv(tr)==v0}function nw(tr,nr,Lr,wn){var _g=Lr.length,l0=_g,m0=!wn;if(tr==null)return!l0;for(tr=sv(tr);_g--;){var _0=Lr[_g];if(m0&&_0[2]?_0[1]!==tr[_0[0]]:!(_0[0]in tr))return!1}for(;++_g<l0;){_0=Lr[_g];var D0=_0[0],q0=tr[D0],Y0=_0[1];if(m0&&_0[2]){if(q0===b&&!(D0 in tr))return!1}else{var Q0=new My;if(wn)var a1=wn(q0,Y0,D0,tr,nr,Q0);if(!(a1===b?Lx(Y0,q0,Ft|Gt,wn,Q0):a1))return!1}}return!0}function c_(tr){if(!fv(tr)||W3(tr))return!1;var nr=s$(tr)?lE:Uv;return nr.test(M$(tr))}function u3(tr){return gv(tr)&&qv(tr)==$0}function c3(tr){return gv(tr)&&Bv(tr)==A0}function d3(tr){return gv(tr)&&B2(tr.length)&&!!p1[qv(tr)]}function d_(tr){return typeof tr=="function"?tr:tr==null?ny:typeof tr=="object"?M1(tr)?h_(tr[0],tr[1]):p_(tr):RS(tr)}function iw(tr){if(!Bx(tr))return hE(tr);var nr=[];for(var Lr in sv(tr))av.call(tr,Lr)&&Lr!="constructor"&&nr.push(Lr);return nr}function f3(tr){if(!fv(tr))return Y3(tr);var nr=Bx(tr),Lr=[];for(var wn in tr)wn=="constructor"&&(nr||!av.call(tr,wn))||Lr.push(wn);return Lr}function ow(tr,nr){return tr<nr}function f_(tr,nr){var Lr=-1,wn=ty(tr)?z0(tr.length):[];return g$(tr,function(_g,l0,m0){wn[++Lr]=nr(_g,l0,m0)}),wn}function p_(tr){var nr=$w(tr);return nr.length==1&&nr[0][2]?q_(nr[0][0],nr[0][1]):function(Lr){return Lr===tr||nw(Lr,tr,nr)}}function h_(tr,nr){return ww(tr)&&G_(nr)?q_(Gy(tr),nr):function(Lr){var wn=Iw(Lr,tr);return wn===b&&wn===nr?Rw(Lr,tr):Lx(nr,wn,Ft|Gt)}}function S2(tr,nr,Lr,wn,_g){tr!==nr&&J2(nr,function(l0,m0){if(_g||(_g=new My),fv(l0))p3(tr,nr,m0,Lr,S2,wn,_g);else{var _0=wn?wn(Sw(tr,m0),l0,m0+"",tr,nr,_g):b;_0===b&&(_0=l0),Z2(tr,m0,_0)}},ry)}function p3(tr,nr,Lr,wn,_g,l0,m0){var _0=Sw(tr,Lr),D0=Sw(nr,Lr),q0=m0.get(D0);if(q0){Z2(tr,Lr,q0);return}var Y0=l0?l0(_0,D0,Lr+"",tr,nr,m0):b,Q0=Y0===b;if(Q0){var a1=M1(D0),y1=!a1&&$$(D0),k1=!a1&&!y1&&rx(D0);Y0=D0,a1||y1||k1?M1(_0)?Y0=_0:$v(_0)?Y0=ey(_0):y1?(Q0=!1,Y0=T_(D0,!0)):k1?(Q0=!1,Y0=C_(D0,!0)):Y0=[]:Ux(D0)||N$(D0)?(Y0=_0,N$(_0)?Y0=_S(_0):(!fv(_0)||s$(_0))&&(Y0=H_(D0))):Q0=!1}Q0&&(m0.set(D0,Y0),_g(Y0,D0,wn,l0,m0),m0.delete(D0)),Z2(tr,Lr,Y0)}function m_(tr,nr){var Lr=tr.length;if(Lr)return nr+=nr<0?Lr:0,a$(nr,Lr)?tr[nr]:b}function g_(tr,nr,Lr){nr.length?nr=ov(nr,function(l0){return M1(l0)?function(m0){return R$(m0,l0.length===1?l0[0]:l0)}:l0}):nr=[ny];var wn=-1;nr=ov(nr,Bo(A1()));var _g=f_(tr,function(l0,m0,_0){var D0=ov(nr,function(q0){return q0(l0)});return{criteria:D0,index:++wn,value:l0}});return G2(_g,function(l0,m0){return T3(l0,m0,Lr)})}function h3(tr,nr){return v_(tr,nr,function(Lr,wn){return Rw(tr,wn)})}function v_(tr,nr,Lr){for(var wn=-1,_g=nr.length,l0={};++wn<_g;){var m0=nr[wn],_0=R$(tr,m0);Lr(_0,m0)&&jx(l0,y$(m0,tr),_0)}return l0}function m3(tr){return function(nr){return R$(nr,tr)}}function aw(tr,nr,Lr,wn){var _g=wn?Ex:Uy,l0=-1,m0=nr.length,_0=tr;for(tr===nr&&(nr=ey(nr)),Lr&&(_0=ov(tr,Bo(Lr)));++l0<m0;)for(var D0=0,q0=nr[l0],Y0=Lr?Lr(q0):q0;(D0=_g(_0,Y0,D0,wn))>-1;)_0!==tr&&h2.call(_0,D0,1),h2.call(tr,D0,1);return tr}function y_(tr,nr){for(var Lr=tr?nr.length:0,wn=Lr-1;Lr--;){var _g=nr[Lr];if(Lr==wn||_g!==l0){var l0=_g;a$(_g)?h2.call(tr,_g,1):cw(tr,_g)}}return tr}function sw(tr,nr){return tr+v2(Qw()*(nr-tr+1))}function g3(tr,nr,Lr,wn){for(var _g=-1,l0=Ov(g2((nr-tr)/(Lr||1)),0),m0=z0(l0);l0--;)m0[wn?l0:++_g]=tr,tr+=Lr;return m0}function lw(tr,nr){var Lr="";if(!tr||nr<1||nr>e0)return Lr;do nr%2&&(Lr+=tr),nr=v2(nr/2),nr&&(tr+=tr);while(nr);return Lr}function U1(tr,nr){return Ew(Y_(tr,nr,ny),tr+"")}function v3(tr){return t_(nx(tr))}function y3(tr,nr){var Lr=nx(tr);return D2(Lr,I$(nr,0,Lr.length))}function jx(tr,nr,Lr,wn){if(!fv(tr))return tr;nr=y$(nr,tr);for(var _g=-1,l0=nr.length,m0=l0-1,_0=tr;_0!=null&&++_g<l0;){var D0=Gy(nr[_g]),q0=Lr;if(D0==="__proto__"||D0==="constructor"||D0==="prototype")return tr;if(_g!=m0){var Y0=_0[D0];q0=wn?wn(Y0,D0,_0):b,q0===b&&(q0=fv(Y0)?Y0:a$(nr[_g+1])?[]:{})}Dx(_0,D0,q0),_0=_0[D0]}return tr}var b_=y2?function(tr,nr){return y2.set(tr,nr),tr}:ny,b3=m2?function(tr,nr){return m2(tr,"toString",{configurable:!0,enumerable:!1,value:Mw(nr),writable:!0})}:ny;function $3(tr){return D2(nx(tr))}function $y(tr,nr,Lr){var wn=-1,_g=tr.length;nr<0&&(nr=-nr>_g?0:_g+nr),Lr=Lr>_g?_g:Lr,Lr<0&&(Lr+=_g),_g=nr>Lr?0:Lr-nr>>>0,nr>>>=0;for(var l0=z0(_g);++wn<_g;)l0[wn]=tr[wn+nr];return l0}function x3(tr,nr){var Lr;return g$(tr,function(wn,_g,l0){return Lr=nr(wn,_g,l0),!Lr}),!!Lr}function E2(tr,nr,Lr){var wn=0,_g=tr==null?wn:tr.length;if(typeof nr=="number"&&nr===nr&&_g<=n0){for(;wn<_g;){var l0=wn+_g>>>1,m0=tr[l0];m0!==null&&!uy(m0)&&(Lr?m0<=nr:m0<nr)?wn=l0+1:_g=l0}return _g}return uw(tr,nr,ny,Lr)}function uw(tr,nr,Lr,wn){var _g=0,l0=tr==null?0:tr.length;if(l0===0)return 0;nr=Lr(nr);for(var m0=nr!==nr,_0=nr===null,D0=uy(nr),q0=nr===b;_g<l0;){var Y0=v2((_g+l0)/2),Q0=Lr(tr[Y0]),a1=Q0!==b,y1=Q0===null,k1=Q0===Q0,j1=uy(Q0);if(m0)var I1=wn||k1;else q0?I1=k1&&(wn||a1):_0?I1=k1&&a1&&(wn||!y1):D0?I1=k1&&a1&&!y1&&(wn||!j1):y1||j1?I1=!1:I1=wn?Q0<=nr:Q0<nr;I1?_g=Y0+1:l0=Y0}return Fv(l0,Tn)}function $_(tr,nr){for(var Lr=-1,wn=tr.length,_g=0,l0=[];++Lr<wn;){var m0=tr[Lr],_0=nr?nr(m0):m0;if(!Lr||!Ny(_0,D0)){var D0=_0;l0[_g++]=m0===0?0:m0}}return l0}function x_(tr){return typeof tr=="number"?tr:uy(tr)?Ro:+tr}function ly(tr){if(typeof tr=="string")return tr;if(M1(tr))return ov(tr,ly)+"";if(uy(tr))return Jw?Jw.call(tr):"";var nr=tr+"";return nr=="0"&&1/tr==-Kr?"-0":nr}function v$(tr,nr,Lr){var wn=-1,_g=g1,l0=tr.length,m0=!0,_0=[],D0=_0;if(Lr)m0=!1,_g=V$;else if(l0>=st){var q0=nr?null:I3(tr);if(q0)return a2(q0);m0=!1,_g=h0,D0=new k$}else D0=nr?[]:_0;e:for(;++wn<l0;){var Y0=tr[wn],Q0=nr?nr(Y0):Y0;if(Y0=Lr||Y0!==0?Y0:0,m0&&Q0===Q0){for(var a1=D0.length;a1--;)if(D0[a1]===Q0)continue e;nr&&D0.push(Q0),_0.push(Y0)}else _g(D0,Q0,Lr)||(D0!==_0&&D0.push(Q0),_0.push(Y0))}return _0}function cw(tr,nr){return nr=y$(nr,tr),tr=X_(tr,nr),tr==null||delete tr[Gy(xy(nr))]}function w_(tr,nr,Lr,wn){return jx(tr,nr,Lr(R$(tr,nr)),wn)}function T2(tr,nr,Lr,wn){for(var _g=tr.length,l0=wn?_g:-1;(wn?l0--:++l0<_g)&&nr(tr[l0],l0,tr););return Lr?$y(tr,wn?0:l0,wn?l0+1:_g):$y(tr,wn?l0+1:0,wn?_g:l0)}function __(tr,nr){var Lr=tr;return Lr instanceof G1&&(Lr=Lr.value()),Jv(nr,function(wn,_g){return _g.func.apply(_g.thisArg,sy([wn],_g.args))},Lr)}function dw(tr,nr,Lr){var wn=tr.length;if(wn<2)return wn?v$(tr[0]):[];for(var _g=-1,l0=z0(wn);++_g<wn;)for(var m0=tr[_g],_0=-1;++_0<wn;)_0!=_g&&(l0[_g]=Mx(l0[_g]||m0,tr[_0],nr,Lr));return v$(Mv(l0,1),nr,Lr)}function S_(tr,nr,Lr){for(var wn=-1,_g=tr.length,l0=nr.length,m0={};++wn<_g;){var _0=wn<l0?nr[wn]:b;Lr(m0,tr[wn],_0)}return m0}function fw(tr){return $v(tr)?tr:[]}function pw(tr){return typeof tr=="function"?tr:ny}function y$(tr,nr){return M1(tr)?tr:ww(tr,nr)?[tr]:J_(tv(tr))}var w3=U1;function b$(tr,nr,Lr){var wn=tr.length;return Lr=Lr===b?wn:Lr,!nr&&Lr>=wn?tr:$y(tr,nr,Lr)}var E_=uE||function(tr){return bv.clearTimeout(tr)};function T_(tr,nr){if(nr)return tr.slice();var Lr=tr.length,wn=qw?qw(Lr):new tr.constructor(Lr);return tr.copy(wn),wn}function hw(tr){var nr=new tr.constructor(tr.byteLength);return new f2(nr).set(new f2(tr)),nr}function _3(tr,nr){var Lr=nr?hw(tr.buffer):tr.buffer;return new tr.constructor(Lr,tr.byteOffset,tr.byteLength)}function S3(tr){var nr=new tr.constructor(tr.source,uv.exec(tr));return nr.lastIndex=tr.lastIndex,nr}function E3(tr){return Rx?sv(Rx.call(tr)):{}}function C_(tr,nr){var Lr=nr?hw(tr.buffer):tr.buffer;return new tr.constructor(Lr,tr.byteOffset,tr.length)}function O_(tr,nr){if(tr!==nr){var Lr=tr!==b,wn=tr===null,_g=tr===tr,l0=uy(tr),m0=nr!==b,_0=nr===null,D0=nr===nr,q0=uy(nr);if(!_0&&!q0&&!l0&&tr>nr||l0&&m0&&D0&&!_0&&!q0||wn&&m0&&D0||!Lr&&D0||!_g)return 1;if(!wn&&!l0&&!q0&&tr<nr||q0&&Lr&&_g&&!wn&&!l0||_0&&Lr&&_g||!m0&&_g||!D0)return-1}return 0}function T3(tr,nr,Lr){for(var wn=-1,_g=tr.criteria,l0=nr.criteria,m0=_g.length,_0=Lr.length;++wn<m0;){var D0=O_(_g[wn],l0[wn]);if(D0){if(wn>=_0)return D0;var q0=Lr[wn];return D0*(q0=="desc"?-1:1)}}return tr.index-nr.index}function A_(tr,nr,Lr,wn){for(var _g=-1,l0=tr.length,m0=Lr.length,_0=-1,D0=nr.length,q0=Ov(l0-m0,0),Y0=z0(D0+q0),Q0=!wn;++_0<D0;)Y0[_0]=nr[_0];for(;++_g<m0;)(Q0||_g<l0)&&(Y0[Lr[_g]]=tr[_g]);for(;q0--;)Y0[_0++]=tr[_g++];return Y0}function P_(tr,nr,Lr,wn){for(var _g=-1,l0=tr.length,m0=-1,_0=Lr.length,D0=-1,q0=nr.length,Y0=Ov(l0-_0,0),Q0=z0(Y0+q0),a1=!wn;++_g<Y0;)Q0[_g]=tr[_g];for(var y1=_g;++D0<q0;)Q0[y1+D0]=nr[D0];for(;++m0<_0;)(a1||_g<l0)&&(Q0[y1+Lr[m0]]=tr[_g++]);return Q0}function ey(tr,nr){var Lr=-1,wn=tr.length;for(nr||(nr=z0(wn));++Lr<wn;)nr[Lr]=tr[Lr];return nr}function Hy(tr,nr,Lr,wn){var _g=!Lr;Lr||(Lr={});for(var l0=-1,m0=nr.length;++l0<m0;){var _0=nr[l0],D0=wn?wn(Lr[_0],tr[_0],_0,Lr,tr):b;D0===b&&(D0=tr[_0]),_g?n$(Lr,_0,D0):Dx(Lr,_0,D0)}return Lr}function C3(tr,nr){return Hy(tr,xw(tr),nr)}function O3(tr,nr){return Hy(tr,V_(tr),nr)}function C2(tr,nr){return function(Lr,wn){var _g=M1(Lr)?r2:KE,l0=nr?nr():{};return _g(Lr,tr,A1(wn,2),l0)}}function J$(tr){return U1(function(nr,Lr){var wn=-1,_g=Lr.length,l0=_g>1?Lr[_g-1]:b,m0=_g>2?Lr[2]:b;for(l0=tr.length>3&&typeof l0=="function"?(_g--,l0):b,m0&&Yv(Lr[0],Lr[1],m0)&&(l0=_g<3?b:l0,_g=1),nr=sv(nr);++wn<_g;){var _0=Lr[wn];_0&&tr(nr,_0,wn,l0)}return nr})}function k_(tr,nr){return function(Lr,wn){if(Lr==null)return Lr;if(!ty(Lr))return tr(Lr,wn);for(var _g=Lr.length,l0=nr?_g:-1,m0=sv(Lr);(nr?l0--:++l0<_g)&&wn(m0[l0],l0,m0)!==!1;);return Lr}}function I_(tr){return function(nr,Lr,wn){for(var _g=-1,l0=sv(nr),m0=wn(nr),_0=m0.length;_0--;){var D0=m0[tr?_0:++_g];if(Lr(l0[D0],D0,l0)===!1)break}return nr}}function A3(tr,nr,Lr){var wn=nr&Ht,_g=Fx(tr);function l0(){var m0=this&&this!==bv&&this instanceof l0?_g:tr;return m0.apply(wn?Lr:this,arguments)}return l0}function R_(tr){return function(nr){nr=tv(nr);var Lr=q1(nr)?Dy(nr):b,wn=Lr?Lr[0]:nr.charAt(0),_g=Lr?b$(Lr,1).join(""):nr.slice(1);return wn[tr]()+_g}}function ex(tr){return function(nr){return Jv(kS(PS(nr).replace(Z0,"")),tr,"")}}function Fx(tr){return function(){var nr=arguments;switch(nr.length){case 0:return new tr;case 1:return new tr(nr[0]);case 2:return new tr(nr[0],nr[1]);case 3:return new tr(nr[0],nr[1],nr[2]);case 4:return new tr(nr[0],nr[1],nr[2],nr[3]);case 5:return new tr(nr[0],nr[1],nr[2],nr[3],nr[4]);case 6:return new tr(nr[0],nr[1],nr[2],nr[3],nr[4],nr[5]);case 7:return new tr(nr[0],nr[1],nr[2],nr[3],nr[4],nr[5],nr[6])}var Lr=Q$(tr.prototype),wn=tr.apply(Lr,nr);return fv(wn)?wn:Lr}}function P3(tr,nr,Lr){var wn=Fx(tr);function _g(){for(var l0=arguments.length,m0=z0(l0),_0=l0,D0=tx(_g);_0--;)m0[_0]=arguments[_0];var q0=l0<3&&m0[0]!==D0&&m0[l0-1]!==D0?[]:Ry(m0,D0);if(l0-=q0.length,l0<Lr)return j_(tr,nr,O2,_g.placeholder,b,m0,q0,b,b,Lr-l0);var Y0=this&&this!==bv&&this instanceof _g?wn:tr;return Hv(Y0,this,m0)}return _g}function D_(tr){return function(nr,Lr,wn){var _g=sv(nr);if(!ty(nr)){var l0=A1(Lr,3);nr=Iv(nr),Lr=function(_0){return l0(_g[_0],_0,_g)}}var m0=tr(nr,Lr,wn);return m0>-1?_g[l0?nr[m0]:m0]:b}}function M_(tr){return o$(function(nr){var Lr=nr.length,wn=Lr,_g=yy.prototype.thru;for(tr&&nr.reverse();wn--;){var l0=nr[wn];if(typeof l0!="function")throw new vy(vt);if(_g&&!m0&&I2(l0)=="wrapper")var m0=new yy([],!0)}for(wn=m0?wn:Lr;++wn<Lr;){l0=nr[wn];var _0=I2(l0),D0=_0=="wrapper"?bw(l0):b;D0&&_w(D0[0])&&D0[1]==(qr|rr|or|Yr)&&!D0[4].length&&D0[9]==1?m0=m0[I2(D0[0])].apply(m0,D0[3]):m0=l0.length==1&&_w(l0)?m0[_0]():m0.thru(l0)}return function(){var q0=arguments,Y0=q0[0];if(m0&&q0.length==1&&M1(Y0))return m0.plant(Y0).value();for(var Q0=0,a1=Lr?nr[Q0].apply(this,q0):Y0;++Q0<Lr;)a1=nr[Q0].call(this,a1);return a1}})}function O2(tr,nr,Lr,wn,_g,l0,m0,_0,D0,q0){var Y0=nr&qr,Q0=nr&Ht,a1=nr&qt,y1=nr&(rr|ir),k1=nr&vn,j1=a1?b:Fx(tr);function I1(){for(var V1=arguments.length,Y1=z0(V1),cy=V1;cy--;)Y1[cy]=arguments[cy];if(y1)var Xv=tx(I1),dy=J0(Y1,Xv);if(wn&&(Y1=A_(Y1,wn,_g,y1)),l0&&(Y1=P_(Y1,l0,m0,y1)),V1-=dy,y1&&V1<q0){var xv=Ry(Y1,Xv);return j_(tr,nr,O2,I1.placeholder,Lr,Y1,xv,_0,D0,q0-V1)}var Ly=Q0?Lr:this,u$=a1?Ly[tr]:tr;return V1=Y1.length,_0?Y1=K3(Y1,_0):k1&&V1>1&&Y1.reverse(),Y0&&D0<V1&&(Y1.length=D0),this&&this!==bv&&this instanceof I1&&(u$=j1||Fx(u$)),u$.apply(Ly,Y1)}return I1}function N_(tr,nr){return function(Lr,wn){return i3(Lr,tr,nr(wn),{})}}function A2(tr,nr){return function(Lr,wn){var _g;if(Lr===b&&wn===b)return nr;if(Lr!==b&&(_g=Lr),wn!==b){if(_g===b)return wn;typeof Lr=="string"||typeof wn=="string"?(Lr=ly(Lr),wn=ly(wn)):(Lr=x_(Lr),wn=x_(wn)),_g=tr(Lr,wn)}return _g}}function mw(tr){return o$(function(nr){return nr=ov(nr,Bo(A1())),U1(function(Lr){var wn=this;return tr(nr,function(_g){return Hv(_g,wn,Lr)})})})}function P2(tr,nr){nr=nr===b?" ":ly(nr);var Lr=nr.length;if(Lr<2)return Lr?lw(nr,tr):nr;var wn=lw(nr,g2(tr/Y$(nr)));return q1(nr)?b$(Dy(wn),0,tr).join(""):wn.slice(0,tr)}function k3(tr,nr,Lr,wn){var _g=nr&Ht,l0=Fx(tr);function m0(){for(var _0=-1,D0=arguments.length,q0=-1,Y0=wn.length,Q0=z0(Y0+D0),a1=this&&this!==bv&&this instanceof m0?l0:tr;++q0<Y0;)Q0[q0]=wn[q0];for(;D0--;)Q0[q0++]=arguments[++_0];return Hv(a1,_g?Lr:this,Q0)}return m0}function L_(tr){return function(nr,Lr,wn){return wn&&typeof wn!="number"&&Yv(nr,Lr,wn)&&(Lr=wn=b),nr=l$(nr),Lr===b?(Lr=nr,nr=0):Lr=l$(Lr),wn=wn===b?nr<Lr?1:-1:l$(wn),g3(nr,Lr,wn,tr)}}function k2(tr){return function(nr,Lr){return typeof nr=="string"&&typeof Lr=="string"||(nr=wy(nr),Lr=wy(Lr)),tr(nr,Lr)}}function j_(tr,nr,Lr,wn,_g,l0,m0,_0,D0,q0){var Y0=nr&rr,Q0=Y0?m0:b,a1=Y0?b:m0,y1=Y0?l0:b,k1=Y0?b:l0;nr|=Y0?or:jr,nr&=~(Y0?jr:or),nr&Kt||(nr&=~(Ht|qt));var j1=[tr,nr,_g,y1,Q0,k1,a1,_0,D0,q0],I1=Lr.apply(b,j1);return _w(tr)&&K_(I1,j1),I1.placeholder=wn,Z_(I1,tr,nr)}function gw(tr){var nr=Cv[tr];return function(Lr,wn){if(Lr=wy(Lr),wn=wn==null?0:Fv(L1(wn),292),wn&&Zw(Lr)){var _g=(tv(Lr)+"e").split("e"),l0=nr(_g[0]+"e"+(+_g[1]+wn));return _g=(tv(l0)+"e").split("e"),+(_g[0]+"e"+(+_g[1]-wn))}return nr(Lr)}}var I3=K$&&1/a2(new K$([,-0]))[1]==Kr?function(tr){return new K$(tr)}:jw;function F_(tr){return function(nr){var Lr=Bv(nr);return Lr==v0?H1(nr):Lr==A0?XS(nr):Hr(nr,tr(nr))}}function i$(tr,nr,Lr,wn,_g,l0,m0,_0){var D0=nr&qt;if(!D0&&typeof tr!="function")throw new vy(vt);var q0=wn?wn.length:0;if(q0||(nr&=~(or|jr),wn=_g=b),m0=m0===b?m0:Ov(L1(m0),0),_0=_0===b?_0:L1(_0),q0-=_g?_g.length:0,nr&jr){var Y0=wn,Q0=_g;wn=_g=b}var a1=D0?b:bw(tr),y1=[tr,nr,Lr,wn,_g,Y0,Q0,l0,m0,_0];if(a1&&q3(y1,a1),tr=y1[0],nr=y1[1],Lr=y1[2],wn=y1[3],_g=y1[4],_0=y1[9]=y1[9]===b?D0?0:tr.length:Ov(y1[9]-q0,0),!_0&&nr&(rr|ir)&&(nr&=~(rr|ir)),!nr||nr==Ht)var k1=A3(tr,nr,Lr);else nr==rr||nr==ir?k1=P3(tr,nr,_0):(nr==or||nr==(Ht|or))&&!_g.length?k1=k3(tr,nr,Lr,wn):k1=O2.apply(b,y1);var j1=a1?b_:K_;return Z_(j1(k1,y1),tr,nr)}function B_(tr,nr,Lr,wn){return tr===b||Ny(tr,X$[Lr])&&!av.call(wn,Lr)?nr:tr}function z_(tr,nr,Lr,wn,_g,l0){return fv(tr)&&fv(nr)&&(l0.set(nr,tr),S2(tr,nr,b,z_,l0),l0.delete(nr)),tr}function R3(tr){return Ux(tr)?b:tr}function U_(tr,nr,Lr,wn,_g,l0){var m0=Lr&Ft,_0=tr.length,D0=nr.length;if(_0!=D0&&!(m0&&D0>_0))return!1;var q0=l0.get(tr),Y0=l0.get(nr);if(q0&&Y0)return q0==nr&&Y0==tr;var Q0=-1,a1=!0,y1=Lr&Gt?new k$:b;for(l0.set(tr,nr),l0.set(nr,tr);++Q0<_0;){var k1=tr[Q0],j1=nr[Q0];if(wn)var I1=m0?wn(j1,k1,Q0,nr,tr,l0):wn(k1,j1,Q0,tr,nr,l0);if(I1!==b){if(I1)continue;a1=!1;break}if(y1){if(!W$(nr,function(V1,Y1){if(!h0(y1,Y1)&&(k1===V1||_g(k1,V1,Lr,wn,l0)))return y1.push(Y1)})){a1=!1;break}}else if(!(k1===j1||_g(k1,j1,Lr,wn,l0))){a1=!1;break}}return l0.delete(tr),l0.delete(nr),a1}function D3(tr,nr,Lr,wn,_g,l0,m0){switch(Lr){case x1:if(tr.byteLength!=nr.byteLength||tr.byteOffset!=nr.byteOffset)return!1;tr=tr.buffer,nr=nr.buffer;case n1:return!(tr.byteLength!=nr.byteLength||!l0(new f2(tr),new f2(nr)));case d0:case f0:case k0:return Ny(+tr,+nr);case b0:return tr.name==nr.name&&tr.message==nr.message;case $0:case g0:return tr==nr+"";case v0:var _0=H1;case A0:var D0=wn&Ft;if(_0||(_0=a2),tr.size!=nr.size&&!D0)return!1;var q0=m0.get(tr);if(q0)return q0==nr;wn|=Gt,m0.set(tr,nr);var Y0=U_(_0(tr),_0(nr),wn,_g,l0,m0);return m0.delete(tr),Y0;case E0:if(Rx)return Rx.call(tr)==Rx.call(nr)}return!1}function M3(tr,nr,Lr,wn,_g,l0){var m0=Lr&Ft,_0=vw(tr),D0=_0.length,q0=vw(nr),Y0=q0.length;if(D0!=Y0&&!m0)return!1;for(var Q0=D0;Q0--;){var a1=_0[Q0];if(!(m0?a1 in nr:av.call(nr,a1)))return!1}var y1=l0.get(tr),k1=l0.get(nr);if(y1&&k1)return y1==nr&&k1==tr;var j1=!0;l0.set(tr,nr),l0.set(nr,tr);for(var I1=m0;++Q0<D0;){a1=_0[Q0];var V1=tr[a1],Y1=nr[a1];if(wn)var cy=m0?wn(Y1,V1,a1,nr,tr,l0):wn(V1,Y1,a1,tr,nr,l0);if(!(cy===b?V1===Y1||_g(V1,Y1,Lr,wn,l0):cy)){j1=!1;break}I1||(I1=a1=="constructor")}if(j1&&!I1){var Xv=tr.constructor,dy=nr.constructor;Xv!=dy&&"constructor"in tr&&"constructor"in nr&&!(typeof Xv=="function"&&Xv instanceof Xv&&typeof dy=="function"&&dy instanceof dy)&&(j1=!1)}return l0.delete(tr),l0.delete(nr),j1}function o$(tr){return Ew(Y_(tr,b,nS),tr+"")}function vw(tr){return l_(tr,Iv,xw)}function yw(tr){return l_(tr,ry,V_)}var bw=y2?function(tr){return y2.get(tr)}:jw;function I2(tr){for(var nr=tr.name+"",Lr=Z$[nr],wn=av.call(Z$,nr)?Lr.length:0;wn--;){var _g=Lr[wn],l0=_g.func;if(l0==null||l0==tr)return _g.name}return nr}function tx(tr){var nr=av.call(o0,"placeholder")?o0:tr;return nr.placeholder}function A1(){var tr=o0.iteratee||Nw;return tr=tr===Nw?d_:tr,arguments.length?tr(arguments[0],arguments[1]):tr}function R2(tr,nr){var Lr=tr.__data__;return V3(nr)?Lr[typeof nr=="string"?"string":"hash"]:Lr.map}function $w(tr){for(var nr=Iv(tr),Lr=nr.length;Lr--;){var wn=nr[Lr],_g=tr[wn];nr[Lr]=[wn,_g,G_(_g)]}return nr}function D$(tr,nr){var Lr=Z1(tr,nr);return c_(Lr)?Lr:b}function N3(tr){var nr=av.call(tr,A$),Lr=tr[A$];try{tr[A$]=b;var wn=!0}catch{}var _g=c2.call(tr);return wn&&(nr?tr[A$]=Lr:delete tr[A$]),_g}var xw=Y2?function(tr){return tr==null?[]:(tr=sv(tr),zy(Y2(tr),function(nr){return Xw.call(tr,nr)}))}:Fw,V_=Y2?function(tr){for(var nr=[];tr;)sy(nr,xw(tr)),tr=p2(tr);return nr}:Fw,Bv=qv;(X2&&Bv(new X2(new ArrayBuffer(1)))!=x1||Px&&Bv(new Px)!=v0||K2&&Bv(K2.resolve())!=r0||K$&&Bv(new K$)!=A0||kx&&Bv(new kx)!=K0)&&(Bv=function(tr){var nr=qv(tr),Lr=nr==w0?tr.constructor:b,wn=Lr?M$(Lr):"";if(wn)switch(wn){case yE:return x1;case bE:return v0;case $E:return r0;case xE:return A0;case wE:return K0}return nr});function L3(tr,nr,Lr){for(var wn=-1,_g=Lr.length;++wn<_g;){var l0=Lr[wn],m0=l0.size;switch(l0.type){case"drop":tr+=m0;break;case"dropRight":nr-=m0;break;case"take":nr=Fv(nr,tr+m0);break;case"takeRight":tr=Ov(tr,nr-m0);break}}return{start:tr,end:nr}}function j3(tr){var nr=tr.match(O1);return nr?nr[1].split(T1):[]}function W_(tr,nr,Lr){nr=y$(nr,tr);for(var wn=-1,_g=nr.length,l0=!1;++wn<_g;){var m0=Gy(nr[wn]);if(!(l0=tr!=null&&Lr(tr,m0)))break;tr=tr[m0]}return l0||++wn!=_g?l0:(_g=tr==null?0:tr.length,!!_g&&B2(_g)&&a$(m0,_g)&&(M1(tr)||N$(tr)))}function F3(tr){var nr=tr.length,Lr=new tr.constructor(nr);return nr&&typeof tr[0]=="string"&&av.call(tr,"index")&&(Lr.index=tr.index,Lr.input=tr.input),Lr}function H_(tr){return typeof tr.constructor=="function"&&!Bx(tr)?Q$(p2(tr)):{}}function B3(tr,nr,Lr){var wn=tr.constructor;switch(nr){case n1:return hw(tr);case d0:case f0:return new wn(+tr);case x1:return _3(tr,Lr);case u1:case P1:case i1:case v1:case _1:case X1:case t1:case cv:case S1:return C_(tr,Lr);case v0:return new wn;case k0:case g0:return new wn(tr);case $0:return S3(tr);case A0:return new wn;case E0:return E3(tr)}}function z3(tr,nr){var Lr=nr.length;if(!Lr)return tr;var wn=Lr-1;return nr[wn]=(Lr>1?"& ":"")+nr[wn],nr=nr.join(Lr>2?", ":" "),tr.replace(c1,`{
/* [wrapped with `+nr+`] */
`)}function U3(tr){return M1(tr)||N$(tr)||!!(Kw&&tr&&tr[Kw])}function a$(tr,nr){var Lr=typeof tr;return nr=nr??e0,!!nr&&(Lr=="number"||Lr!="symbol"&&iy.test(tr))&&tr>-1&&tr%1==0&&tr<nr}function Yv(tr,nr,Lr){if(!fv(Lr))return!1;var wn=typeof nr;return(wn=="number"?ty(Lr)&&a$(nr,Lr.length):wn=="string"&&nr in Lr)?Ny(Lr[nr],tr):!1}function ww(tr,nr){if(M1(tr))return!1;var Lr=typeof tr;return Lr=="number"||Lr=="symbol"||Lr=="boolean"||tr==null||uy(tr)?!0:nv.test(tr)||!W1.test(tr)||nr!=null&&tr in sv(nr)}function V3(tr){var nr=typeof tr;return nr=="string"||nr=="number"||nr=="symbol"||nr=="boolean"?tr!=="__proto__":tr===null}function _w(tr){var nr=I2(tr),Lr=o0[nr];if(typeof Lr!="function"||!(nr in G1.prototype))return!1;if(tr===Lr)return!0;var wn=bw(Lr);return!!wn&&tr===wn[0]}function W3(tr){return!!Gw&&Gw in tr}var H3=l2?s$:Bw;function Bx(tr){var nr=tr&&tr.constructor,Lr=typeof nr=="function"&&nr.prototype||X$;return tr===Lr}function G_(tr){return tr===tr&&!fv(tr)}function q_(tr,nr){return function(Lr){return Lr==null?!1:Lr[tr]===nr&&(nr!==b||tr in sv(Lr))}}function G3(tr){var nr=j2(tr,function(wn){return Lr.size===pt&&Lr.clear(),wn}),Lr=nr.cache;return nr}function q3(tr,nr){var Lr=tr[1],wn=nr[1],_g=Lr|wn,l0=_g<(Ht|qt|qr),m0=wn==qr&&Lr==rr||wn==qr&&Lr==Yr&&tr[7].length<=nr[8]||wn==(qr|Yr)&&nr[7].length<=nr[8]&&Lr==rr;if(!(l0||m0))return tr;wn&Ht&&(tr[2]=nr[2],_g|=Lr&Ht?0:Kt);var _0=nr[3];if(_0){var D0=tr[3];tr[3]=D0?A_(D0,_0,nr[4]):_0,tr[4]=D0?Ry(tr[3],wt):nr[4]}return _0=nr[5],_0&&(D0=tr[5],tr[5]=D0?P_(D0,_0,nr[6]):_0,tr[6]=D0?Ry(tr[5],wt):nr[6]),_0=nr[7],_0&&(tr[7]=_0),wn&qr&&(tr[8]=tr[8]==null?nr[8]:Fv(tr[8],nr[8])),tr[9]==null&&(tr[9]=nr[9]),tr[0]=nr[0],tr[1]=_g,tr}function Y3(tr){var nr=[];if(tr!=null)for(var Lr in sv(tr))nr.push(Lr);return nr}function X3(tr){return c2.call(tr)}function Y_(tr,nr,Lr){return nr=Ov(nr===b?tr.length-1:nr,0),function(){for(var wn=arguments,_g=-1,l0=Ov(wn.length-nr,0),m0=z0(l0);++_g<l0;)m0[_g]=wn[nr+_g];_g=-1;for(var _0=z0(nr+1);++_g<nr;)_0[_g]=wn[_g];return _0[nr]=Lr(m0),Hv(tr,this,_0)}}function X_(tr,nr){return nr.length<2?tr:R$(tr,$y(nr,0,-1))}function K3(tr,nr){for(var Lr=tr.length,wn=Fv(nr.length,Lr),_g=ey(tr);wn--;){var l0=nr[wn];tr[wn]=a$(l0,Lr)?_g[l0]:b}return tr}function Sw(tr,nr){if(!(nr==="constructor"&&typeof tr[nr]=="function")&&nr!="__proto__")return tr[nr]}var K_=Q_(b_),zx=dE||function(tr,nr){return bv.setTimeout(tr,nr)},Ew=Q_(b3);function Z_(tr,nr,Lr){var wn=nr+"";return Ew(tr,z3(wn,Z3(j3(wn),Lr)))}function Q_(tr){var nr=0,Lr=0;return function(){var wn=mE(),_g=t0-(wn-Lr);if(Lr=wn,_g>0){if(++nr>=zo)return arguments[0]}else nr=0;return tr.apply(b,arguments)}}function D2(tr,nr){var Lr=-1,wn=tr.length,_g=wn-1;for(nr=nr===b?wn:nr;++Lr<nr;){var l0=sw(Lr,_g),m0=tr[l0];tr[l0]=tr[Lr],tr[Lr]=m0}return tr.length=nr,tr}var J_=G3(function(tr){var nr=[];return tr.charCodeAt(0)===46&&nr.push(""),tr.replace(Nv,function(Lr,wn,_g,l0){nr.push(_g?l0.replace(iv,"$1"):wn||Lr)}),nr});function Gy(tr){if(typeof tr=="string"||uy(tr))return tr;var nr=tr+"";return nr=="0"&&1/tr==-Kr?"-0":nr}function M$(tr){if(tr!=null){try{return u2.call(tr)}catch{}try{return tr+""}catch{}}return""}function Z3(tr,nr){return Gv(Go,function(Lr){var wn="_."+Lr[0];nr&Lr[1]&&!g1(tr,wn)&&tr.push(wn)}),tr.sort()}function eS(tr){if(tr instanceof G1)return tr.clone();var nr=new yy(tr.__wrapped__,tr.__chain__);return nr.__actions__=ey(tr.__actions__),nr.__index__=tr.__index__,nr.__values__=tr.__values__,nr}function Q3(tr,nr,Lr){(Lr?Yv(tr,nr,Lr):nr===b)?nr=1:nr=Ov(L1(nr),0);var wn=tr==null?0:tr.length;if(!wn||nr<1)return[];for(var _g=0,l0=0,m0=z0(g2(wn/nr));_g<wn;)m0[l0++]=$y(tr,_g,_g+=nr);return m0}function J3(tr){for(var nr=-1,Lr=tr==null?0:tr.length,wn=0,_g=[];++nr<Lr;){var l0=tr[nr];l0&&(_g[wn++]=l0)}return _g}function eT(){var tr=arguments.length;if(!tr)return[];for(var nr=z0(tr-1),Lr=arguments[0],wn=tr;wn--;)nr[wn-1]=arguments[wn];return sy(M1(Lr)?ey(Lr):[Lr],Mv(nr,1))}var tT=U1(function(tr,nr){return $v(tr)?Mx(tr,Mv(nr,1,$v,!0)):[]}),rT=U1(function(tr,nr){var Lr=xy(nr);return $v(Lr)&&(Lr=b),$v(tr)?Mx(tr,Mv(nr,1,$v,!0),A1(Lr,2)):[]}),nT=U1(function(tr,nr){var Lr=xy(nr);return $v(Lr)&&(Lr=b),$v(tr)?Mx(tr,Mv(nr,1,$v,!0),b,Lr):[]});function iT(tr,nr,Lr){var wn=tr==null?0:tr.length;return wn?(nr=Lr||nr===b?1:L1(nr),$y(tr,nr<0?0:nr,wn)):[]}function oT(tr,nr,Lr){var wn=tr==null?0:tr.length;return wn?(nr=Lr||nr===b?1:L1(nr),nr=wn-nr,$y(tr,0,nr<0?0:nr)):[]}function aT(tr,nr){return tr&&tr.length?T2(tr,A1(nr,3),!0,!0):[]}function sT(tr,nr){return tr&&tr.length?T2(tr,A1(nr,3),!0):[]}function lT(tr,nr,Lr,wn){var _g=tr==null?0:tr.length;return _g?(Lr&&typeof Lr!="number"&&Yv(tr,nr,Lr)&&(Lr=0,wn=_g),e3(tr,nr,Lr,wn)):[]}function tS(tr,nr,Lr){var wn=tr==null?0:tr.length;if(!wn)return-1;var _g=Lr==null?0:L1(Lr);return _g<0&&(_g=Ov(wn+_g,0)),e$(tr,A1(nr,3),_g)}function rS(tr,nr,Lr){var wn=tr==null?0:tr.length;if(!wn)return-1;var _g=wn-1;return Lr!==b&&(_g=L1(Lr),_g=Lr<0?Ov(wn+_g,0):Fv(_g,wn-1)),e$(tr,A1(nr,3),_g,!0)}function nS(tr){var nr=tr==null?0:tr.length;return nr?Mv(tr,1):[]}function uT(tr){var nr=tr==null?0:tr.length;return nr?Mv(tr,Kr):[]}function cT(tr,nr){var Lr=tr==null?0:tr.length;return Lr?(nr=nr===b?1:L1(nr),Mv(tr,nr)):[]}function dT(tr){for(var nr=-1,Lr=tr==null?0:tr.length,wn={};++nr<Lr;){var _g=tr[nr];wn[_g[0]]=_g[1]}return wn}function iS(tr){return tr&&tr.length?tr[0]:b}function fT(tr,nr,Lr){var wn=tr==null?0:tr.length;if(!wn)return-1;var _g=Lr==null?0:L1(Lr);return _g<0&&(_g=Ov(wn+_g,0)),Uy(tr,nr,_g)}function pT(tr){var nr=tr==null?0:tr.length;return nr?$y(tr,0,-1):[]}var hT=U1(function(tr){var nr=ov(tr,fw);return nr.length&&nr[0]===tr[0]?rw(nr):[]}),mT=U1(function(tr){var nr=xy(tr),Lr=ov(tr,fw);return nr===xy(Lr)?nr=b:Lr.pop(),Lr.length&&Lr[0]===tr[0]?rw(Lr,A1(nr,2)):[]}),gT=U1(function(tr){var nr=xy(tr),Lr=ov(tr,fw);return nr=typeof nr=="function"?nr:b,nr&&Lr.pop(),Lr.length&&Lr[0]===tr[0]?rw(Lr,b,nr):[]});function vT(tr,nr){return tr==null?"":pE.call(tr,nr)}function xy(tr){var nr=tr==null?0:tr.length;return nr?tr[nr-1]:b}function yT(tr,nr,Lr){var wn=tr==null?0:tr.length;if(!wn)return-1;var _g=wn;return Lr!==b&&(_g=L1(Lr),_g=_g<0?Ov(wn+_g,0):Fv(_g,wn-1)),nr===nr?ZS(tr,nr,_g):e$(tr,Tx,_g,!0)}function bT(tr,nr){return tr&&tr.length?m_(tr,L1(nr)):b}var $T=U1(oS);function oS(tr,nr){return tr&&tr.length&&nr&&nr.length?aw(tr,nr):tr}function xT(tr,nr,Lr){return tr&&tr.length&&nr&&nr.length?aw(tr,nr,A1(Lr,2)):tr}function wT(tr,nr,Lr){return tr&&tr.length&&nr&&nr.length?aw(tr,nr,b,Lr):tr}var _T=o$(function(tr,nr){var Lr=tr==null?0:tr.length,wn=Q2(tr,nr);return y_(tr,ov(nr,function(_g){return a$(_g,Lr)?+_g:_g}).sort(O_)),wn});function ST(tr,nr){var Lr=[];if(!(tr&&tr.length))return Lr;var wn=-1,_g=[],l0=tr.length;for(nr=A1(nr,3);++wn<l0;){var m0=tr[wn];nr(m0,wn,tr)&&(Lr.push(m0),_g.push(wn))}return y_(tr,_g),Lr}function Tw(tr){return tr==null?tr:vE.call(tr)}function ET(tr,nr,Lr){var wn=tr==null?0:tr.length;return wn?(Lr&&typeof Lr!="number"&&Yv(tr,nr,Lr)?(nr=0,Lr=wn):(nr=nr==null?0:L1(nr),Lr=Lr===b?wn:L1(Lr)),$y(tr,nr,Lr)):[]}function TT(tr,nr){return E2(tr,nr)}function CT(tr,nr,Lr){return uw(tr,nr,A1(Lr,2))}function OT(tr,nr){var Lr=tr==null?0:tr.length;if(Lr){var wn=E2(tr,nr);if(wn<Lr&&Ny(tr[wn],nr))return wn}return-1}function AT(tr,nr){return E2(tr,nr,!0)}function PT(tr,nr,Lr){return uw(tr,nr,A1(Lr,2),!0)}function kT(tr,nr){var Lr=tr==null?0:tr.length;if(Lr){var wn=E2(tr,nr,!0)-1;if(Ny(tr[wn],nr))return wn}return-1}function IT(tr){return tr&&tr.length?$_(tr):[]}function RT(tr,nr){return tr&&tr.length?$_(tr,A1(nr,2)):[]}function DT(tr){var nr=tr==null?0:tr.length;return nr?$y(tr,1,nr):[]}function MT(tr,nr,Lr){return tr&&tr.length?(nr=Lr||nr===b?1:L1(nr),$y(tr,0,nr<0?0:nr)):[]}function NT(tr,nr,Lr){var wn=tr==null?0:tr.length;return wn?(nr=Lr||nr===b?1:L1(nr),nr=wn-nr,$y(tr,nr<0?0:nr,wn)):[]}function LT(tr,nr){return tr&&tr.length?T2(tr,A1(nr,3),!1,!0):[]}function jT(tr,nr){return tr&&tr.length?T2(tr,A1(nr,3)):[]}var FT=U1(function(tr){return v$(Mv(tr,1,$v,!0))}),BT=U1(function(tr){var nr=xy(tr);return $v(nr)&&(nr=b),v$(Mv(tr,1,$v,!0),A1(nr,2))}),zT=U1(function(tr){var nr=xy(tr);return nr=typeof nr=="function"?nr:b,v$(Mv(tr,1,$v,!0),b,nr)});function UT(tr){return tr&&tr.length?v$(tr):[]}function VT(tr,nr){return tr&&tr.length?v$(tr,A1(nr,2)):[]}function WT(tr,nr){return nr=typeof nr=="function"?nr:b,tr&&tr.length?v$(tr,b,nr):[]}function Cw(tr){if(!(tr&&tr.length))return[];var nr=0;return tr=zy(tr,function(Lr){if($v(Lr))return nr=Ov(Lr.length,nr),!0}),q$(nr,function(Lr){return ov(tr,H$(Lr))})}function aS(tr,nr){if(!(tr&&tr.length))return[];var Lr=Cw(tr);return nr==null?Lr:ov(Lr,function(wn){return Hv(nr,b,wn)})}var HT=U1(function(tr,nr){return $v(tr)?Mx(tr,nr):[]}),GT=U1(function(tr){return dw(zy(tr,$v))}),qT=U1(function(tr){var nr=xy(tr);return $v(nr)&&(nr=b),dw(zy(tr,$v),A1(nr,2))}),YT=U1(function(tr){var nr=xy(tr);return nr=typeof nr=="function"?nr:b,dw(zy(tr,$v),b,nr)}),XT=U1(Cw);function KT(tr,nr){return S_(tr||[],nr||[],Dx)}function ZT(tr,nr){return S_(tr||[],nr||[],jx)}var QT=U1(function(tr){var nr=tr.length,Lr=nr>1?tr[nr-1]:b;return Lr=typeof Lr=="function"?(tr.pop(),Lr):b,aS(tr,Lr)});function sS(tr){var nr=o0(tr);return nr.__chain__=!0,nr}function JT(tr,nr){return nr(tr),tr}function M2(tr,nr){return nr(tr)}var eC=o$(function(tr){var nr=tr.length,Lr=nr?tr[0]:0,wn=this.__wrapped__,_g=function(l0){return Q2(l0,tr)};return nr>1||this.__actions__.length||!(wn instanceof G1)||!a$(Lr)?this.thru(_g):(wn=wn.slice(Lr,+Lr+(nr?1:0)),wn.__actions__.push({func:M2,args:[_g],thisArg:b}),new yy(wn,this.__chain__).thru(function(l0){return nr&&!l0.length&&l0.push(b),l0}))});function tC(){return sS(this)}function rC(){return new yy(this.value(),this.__chain__)}function nC(){this.__values__===b&&(this.__values__=xS(this.value()));var tr=this.__index__>=this.__values__.length,nr=tr?b:this.__values__[this.__index__++];return{done:tr,value:nr}}function iC(){return this}function oC(tr){for(var nr,Lr=this;Lr instanceof $2;){var wn=eS(Lr);wn.__index__=0,wn.__values__=b,nr?_g.__wrapped__=wn:nr=wn;var _g=wn;Lr=Lr.__wrapped__}return _g.__wrapped__=tr,nr}function aC(){var tr=this.__wrapped__;if(tr instanceof G1){var nr=tr;return this.__actions__.length&&(nr=new G1(this)),nr=nr.reverse(),nr.__actions__.push({func:M2,args:[Tw],thisArg:b}),new yy(nr,this.__chain__)}return this.thru(Tw)}function sC(){return __(this.__wrapped__,this.__actions__)}var lC=C2(function(tr,nr,Lr){av.call(tr,Lr)?++tr[Lr]:n$(tr,Lr,1)});function uC(tr,nr,Lr){var wn=M1(tr)?n2:JE;return Lr&&Yv(tr,nr,Lr)&&(nr=b),wn(tr,A1(nr,3))}function cC(tr,nr){var Lr=M1(tr)?zy:a_;return Lr(tr,A1(nr,3))}var dC=D_(tS),fC=D_(rS);function pC(tr,nr){return Mv(N2(tr,nr),1)}function hC(tr,nr){return Mv(N2(tr,nr),Kr)}function mC(tr,nr,Lr){return Lr=Lr===b?1:L1(Lr),Mv(N2(tr,nr),Lr)}function lS(tr,nr){var Lr=M1(tr)?Gv:g$;return Lr(tr,A1(nr,3))}function uS(tr,nr){var Lr=M1(tr)?U$:o_;return Lr(tr,A1(nr,3))}var gC=C2(function(tr,nr,Lr){av.call(tr,Lr)?tr[Lr].push(nr):n$(tr,Lr,[nr])});function vC(tr,nr,Lr,wn){tr=ty(tr)?tr:nx(tr),Lr=Lr&&!wn?L1(Lr):0;var _g=tr.length;return Lr<0&&(Lr=Ov(_g+Lr,0)),z2(tr)?Lr<=_g&&tr.indexOf(nr,Lr)>-1:!!_g&&Uy(tr,nr,Lr)>-1}var yC=U1(function(tr,nr,Lr){var wn=-1,_g=typeof nr=="function",l0=ty(tr)?z0(tr.length):[];return g$(tr,function(m0){l0[++wn]=_g?Hv(nr,m0,Lr):Nx(m0,nr,Lr)}),l0}),bC=C2(function(tr,nr,Lr){n$(tr,Lr,nr)});function N2(tr,nr){var Lr=M1(tr)?ov:f_;return Lr(tr,A1(nr,3))}function $C(tr,nr,Lr,wn){return tr==null?[]:(M1(nr)||(nr=nr==null?[]:[nr]),Lr=wn?b:Lr,M1(Lr)||(Lr=Lr==null?[]:[Lr]),g_(tr,nr,Lr))}var xC=C2(function(tr,nr,Lr){tr[Lr?0:1].push(nr)},function(){return[[],[]]});function wC(tr,nr,Lr){var wn=M1(tr)?Jv:Ox,_g=arguments.length<3;return wn(tr,A1(nr,4),Lr,_g,g$)}function _C(tr,nr,Lr){var wn=M1(tr)?i2:Ox,_g=arguments.length<3;return wn(tr,A1(nr,4),Lr,_g,o_)}function SC(tr,nr){var Lr=M1(tr)?zy:a_;return Lr(tr,F2(A1(nr,3)))}function EC(tr){var nr=M1(tr)?t_:v3;return nr(tr)}function TC(tr,nr,Lr){(Lr?Yv(tr,nr,Lr):nr===b)?nr=1:nr=L1(nr);var wn=M1(tr)?YE:y3;return wn(tr,nr)}function CC(tr){var nr=M1(tr)?XE:$3;return nr(tr)}function OC(tr){if(tr==null)return 0;if(ty(tr))return z2(tr)?Y$(tr):tr.length;var nr=Bv(tr);return nr==v0||nr==A0?tr.size:iw(tr).length}function AC(tr,nr,Lr){var wn=M1(tr)?W$:x3;return Lr&&Yv(tr,nr,Lr)&&(nr=b),wn(tr,A1(nr,3))}var PC=U1(function(tr,nr){if(tr==null)return[];var Lr=nr.length;return Lr>1&&Yv(tr,nr[0],nr[1])?nr=[]:Lr>2&&Yv(nr[0],nr[1],nr[2])&&(nr=[nr[0]]),g_(tr,Mv(nr,1),[])}),L2=cE||function(){return bv.Date.now()};function kC(tr,nr){if(typeof nr!="function")throw new vy(vt);return tr=L1(tr),function(){if(--tr<1)return nr.apply(this,arguments)}}function cS(tr,nr,Lr){return nr=Lr?b:nr,nr=tr&&nr==null?tr.length:nr,i$(tr,qr,b,b,b,b,nr)}function dS(tr,nr){var Lr;if(typeof nr!="function")throw new vy(vt);return tr=L1(tr),function(){return--tr>0&&(Lr=nr.apply(this,arguments)),tr<=1&&(nr=b),Lr}}var Ow=U1(function(tr,nr,Lr){var wn=Ht;if(Lr.length){var _g=Ry(Lr,tx(Ow));wn|=or}return i$(tr,wn,nr,Lr,_g)}),fS=U1(function(tr,nr,Lr){var wn=Ht|qt;if(Lr.length){var _g=Ry(Lr,tx(fS));wn|=or}return i$(nr,wn,tr,Lr,_g)});function pS(tr,nr,Lr){nr=Lr?b:nr;var wn=i$(tr,rr,b,b,b,b,b,nr);return wn.placeholder=pS.placeholder,wn}function hS(tr,nr,Lr){nr=Lr?b:nr;var wn=i$(tr,ir,b,b,b,b,b,nr);return wn.placeholder=hS.placeholder,wn}function mS(tr,nr,Lr){var wn,_g,l0,m0,_0,D0,q0=0,Y0=!1,Q0=!1,a1=!0;if(typeof tr!="function")throw new vy(vt);nr=wy(nr)||0,fv(Lr)&&(Y0=!!Lr.leading,Q0="maxWait"in Lr,l0=Q0?Ov(wy(Lr.maxWait)||0,nr):l0,a1="trailing"in Lr?!!Lr.trailing:a1);function y1(xv){var Ly=wn,u$=_g;return wn=_g=b,q0=xv,m0=tr.apply(u$,Ly),m0}function k1(xv){return q0=xv,_0=zx(V1,nr),Y0?y1(xv):m0}function j1(xv){var Ly=xv-D0,u$=xv-q0,DS=nr-Ly;return Q0?Fv(DS,l0-u$):DS}function I1(xv){var Ly=xv-D0,u$=xv-q0;return D0===b||Ly>=nr||Ly<0||Q0&&u$>=l0}function V1(){var xv=L2();if(I1(xv))return Y1(xv);_0=zx(V1,j1(xv))}function Y1(xv){return _0=b,a1&&wn?y1(xv):(wn=_g=b,m0)}function cy(){_0!==b&&E_(_0),q0=0,wn=D0=_g=_0=b}function Xv(){return _0===b?m0:Y1(L2())}function dy(){var xv=L2(),Ly=I1(xv);if(wn=arguments,_g=this,D0=xv,Ly){if(_0===b)return k1(D0);if(Q0)return E_(_0),_0=zx(V1,nr),y1(D0)}return _0===b&&(_0=zx(V1,nr)),m0}return dy.cancel=cy,dy.flush=Xv,dy}var IC=U1(function(tr,nr){return i_(tr,1,nr)}),RC=U1(function(tr,nr,Lr){return i_(tr,wy(nr)||0,Lr)});function DC(tr){return i$(tr,vn)}function j2(tr,nr){if(typeof tr!="function"||nr!=null&&typeof nr!="function")throw new vy(vt);var Lr=function(){var wn=arguments,_g=nr?nr.apply(this,wn):wn[0],l0=Lr.cache;if(l0.has(_g))return l0.get(_g);var m0=tr.apply(this,wn);return Lr.cache=l0.set(_g,m0)||l0,m0};return Lr.cache=new(j2.Cache||r$),Lr}j2.Cache=r$;function F2(tr){if(typeof tr!="function")throw new vy(vt);return function(){var nr=arguments;switch(nr.length){case 0:return!tr.call(this);case 1:return!tr.call(this,nr[0]);case 2:return!tr.call(this,nr[0],nr[1]);case 3:return!tr.call(this,nr[0],nr[1],nr[2])}return!tr.apply(this,nr)}}function MC(tr){return dS(2,tr)}var NC=w3(function(tr,nr){nr=nr.length==1&&M1(nr[0])?ov(nr[0],Bo(A1())):ov(Mv(nr,1),Bo(A1()));var Lr=nr.length;return U1(function(wn){for(var _g=-1,l0=Fv(wn.length,Lr);++_g<l0;)wn[_g]=nr[_g].call(this,wn[_g]);return Hv(tr,this,wn)})}),Aw=U1(function(tr,nr){var Lr=Ry(nr,tx(Aw));return i$(tr,or,b,nr,Lr)}),gS=U1(function(tr,nr){var Lr=Ry(nr,tx(gS));return i$(tr,jr,b,nr,Lr)}),LC=o$(function(tr,nr){return i$(tr,Yr,b,b,b,nr)});function jC(tr,nr){if(typeof tr!="function")throw new vy(vt);return nr=nr===b?nr:L1(nr),U1(tr,nr)}function FC(tr,nr){if(typeof tr!="function")throw new vy(vt);return nr=nr==null?0:Ov(L1(nr),0),U1(function(Lr){var wn=Lr[nr],_g=b$(Lr,0,nr);return wn&&sy(_g,wn),Hv(tr,this,_g)})}function BC(tr,nr,Lr){var wn=!0,_g=!0;if(typeof tr!="function")throw new vy(vt);return fv(Lr)&&(wn="leading"in Lr?!!Lr.leading:wn,_g="trailing"in Lr?!!Lr.trailing:_g),mS(tr,nr,{leading:wn,maxWait:nr,trailing:_g})}function zC(tr){return cS(tr,1)}function UC(tr,nr){return Aw(pw(nr),tr)}function VC(){if(!arguments.length)return[];var tr=arguments[0];return M1(tr)?tr:[tr]}function WC(tr){return by(tr,jt)}function HC(tr,nr){return nr=typeof nr=="function"?nr:b,by(tr,jt,nr)}function GC(tr){return by(tr,$t|jt)}function qC(tr,nr){return nr=typeof nr=="function"?nr:b,by(tr,$t|jt,nr)}function YC(tr,nr){return nr==null||n_(tr,nr,Iv(nr))}function Ny(tr,nr){return tr===nr||tr!==tr&&nr!==nr}var XC=k2(tw),KC=k2(function(tr,nr){return tr>=nr}),N$=u_(function(){return arguments}())?u_:function(tr){return gv(tr)&&av.call(tr,"callee")&&!Xw.call(tr,"callee")},M1=z0.isArray,ZC=yx?Bo(yx):o3;function ty(tr){return tr!=null&&B2(tr.length)&&!s$(tr)}function $v(tr){return gv(tr)&&ty(tr)}function QC(tr){return tr===!0||tr===!1||gv(tr)&&qv(tr)==d0}var $$=fE||Bw,JC=e2?Bo(e2):a3;function eO(tr){return gv(tr)&&tr.nodeType===1&&!Ux(tr)}function tO(tr){if(tr==null)return!0;if(ty(tr)&&(M1(tr)||typeof tr=="string"||typeof tr.splice=="function"||$$(tr)||rx(tr)||N$(tr)))return!tr.length;var nr=Bv(tr);if(nr==v0||nr==A0)return!tr.size;if(Bx(tr))return!iw(tr).length;for(var Lr in tr)if(av.call(tr,Lr))return!1;return!0}function rO(tr,nr){return Lx(tr,nr)}function nO(tr,nr,Lr){Lr=typeof Lr=="function"?Lr:b;var wn=Lr?Lr(tr,nr):b;return wn===b?Lx(tr,nr,b,Lr):!!wn}function Pw(tr){if(!gv(tr))return!1;var nr=qv(tr);return nr==b0||nr==y0||typeof tr.message=="string"&&typeof tr.name=="string"&&!Ux(tr)}function iO(tr){return typeof tr=="number"&&Zw(tr)}function s$(tr){if(!fv(tr))return!1;var nr=qv(tr);return nr==O0||nr==C0||nr==u0||nr==p0}function vS(tr){return typeof tr=="number"&&tr==L1(tr)}function B2(tr){return typeof tr=="number"&&tr>-1&&tr%1==0&&tr<=e0}function fv(tr){var nr=typeof tr;return tr!=null&&(nr=="object"||nr=="function")}function gv(tr){return tr!=null&&typeof tr=="object"}var yS=bx?Bo(bx):l3;function oO(tr,nr){return tr===nr||nw(tr,nr,$w(nr))}function aO(tr,nr,Lr){return Lr=typeof Lr=="function"?Lr:b,nw(tr,nr,$w(nr),Lr)}function sO(tr){return bS(tr)&&tr!=+tr}function lO(tr){if(H3(tr))throw new D1(at);return c_(tr)}function uO(tr){return tr===null}function cO(tr){return tr==null}function bS(tr){return typeof tr=="number"||gv(tr)&&qv(tr)==k0}function Ux(tr){if(!gv(tr)||qv(tr)!=w0)return!1;var nr=p2(tr);if(nr===null)return!0;var Lr=av.call(nr,"constructor")&&nr.constructor;return typeof Lr=="function"&&Lr instanceof Lr&&u2.call(Lr)==aE}var kw=$x?Bo($x):u3;function dO(tr){return vS(tr)&&tr>=-e0&&tr<=e0}var $S=xx?Bo(xx):c3;function z2(tr){return typeof tr=="string"||!M1(tr)&&gv(tr)&&qv(tr)==g0}function uy(tr){return typeof tr=="symbol"||gv(tr)&&qv(tr)==E0}var rx=t2?Bo(t2):d3;function fO(tr){return tr===b}function pO(tr){return gv(tr)&&Bv(tr)==K0}function hO(tr){return gv(tr)&&qv(tr)==l1}var mO=k2(ow),gO=k2(function(tr,nr){return tr<=nr});function xS(tr){if(!tr)return[];if(ty(tr))return z2(tr)?Dy(tr):ey(tr);if(Ax&&tr[Ax])return R1(tr[Ax]());var nr=Bv(tr),Lr=nr==v0?H1:nr==A0?a2:nx;return Lr(tr)}function l$(tr){if(!tr)return tr===0?tr:0;if(tr=wy(tr),tr===Kr||tr===-Kr){var nr=tr<0?-1:1;return nr*Zr}return tr===tr?tr:0}function L1(tr){var nr=l$(tr),Lr=nr%1;return nr===nr?Lr?nr-Lr:nr:0}function wS(tr){return tr?I$(L1(tr),0,Sn):0}function wy(tr){if(typeof tr=="number")return tr;if(uy(tr))return Ro;if(fv(tr)){var nr=typeof tr.valueOf=="function"?tr.valueOf():tr;tr=fv(nr)?nr+"":nr}if(typeof tr!="string")return tr===0?tr:+tr;tr=xn(tr);var Lr=wv.test(tr);return Lr||_v.test(tr)?hx(tr.slice(2),Lr?2:8):Rv.test(tr)?Ro:+tr}function _S(tr){return Hy(tr,ry(tr))}function vO(tr){return tr?I$(L1(tr),-e0,e0):tr===0?tr:0}function tv(tr){return tr==null?"":ly(tr)}var yO=J$(function(tr,nr){if(Bx(nr)||ty(nr)){Hy(nr,Iv(nr),tr);return}for(var Lr in nr)av.call(nr,Lr)&&Dx(tr,Lr,nr[Lr])}),SS=J$(function(tr,nr){Hy(nr,ry(nr),tr)}),U2=J$(function(tr,nr,Lr,wn){Hy(nr,ry(nr),tr,wn)}),bO=J$(function(tr,nr,Lr,wn){Hy(nr,Iv(nr),tr,wn)}),$O=o$(Q2);function xO(tr,nr){var Lr=Q$(tr);return nr==null?Lr:r_(Lr,nr)}var wO=U1(function(tr,nr){tr=sv(tr);var Lr=-1,wn=nr.length,_g=wn>2?nr[2]:b;for(_g&&Yv(nr[0],nr[1],_g)&&(wn=1);++Lr<wn;)for(var l0=nr[Lr],m0=ry(l0),_0=-1,D0=m0.length;++_0<D0;){var q0=m0[_0],Y0=tr[q0];(Y0===b||Ny(Y0,X$[q0])&&!av.call(tr,q0))&&(tr[q0]=l0[q0])}return tr}),_O=U1(function(tr){return tr.push(b,z_),Hv(ES,b,tr)});function SO(tr,nr){return Sx(tr,A1(nr,3),Wy)}function EO(tr,nr){return Sx(tr,A1(nr,3),ew)}function TO(tr,nr){return tr==null?tr:J2(tr,A1(nr,3),ry)}function CO(tr,nr){return tr==null?tr:s_(tr,A1(nr,3),ry)}function OO(tr,nr){return tr&&Wy(tr,A1(nr,3))}function AO(tr,nr){return tr&&ew(tr,A1(nr,3))}function PO(tr){return tr==null?[]:_2(tr,Iv(tr))}function kO(tr){return tr==null?[]:_2(tr,ry(tr))}function Iw(tr,nr,Lr){var wn=tr==null?b:R$(tr,nr);return wn===b?Lr:wn}function IO(tr,nr){return tr!=null&&W_(tr,nr,t3)}function Rw(tr,nr){return tr!=null&&W_(tr,nr,r3)}var RO=N_(function(tr,nr,Lr){nr!=null&&typeof nr.toString!="function"&&(nr=c2.call(nr)),tr[nr]=Lr},Mw(ny)),DO=N_(function(tr,nr,Lr){nr!=null&&typeof nr.toString!="function"&&(nr=c2.call(nr)),av.call(tr,nr)?tr[nr].push(Lr):tr[nr]=[Lr]},A1),MO=U1(Nx);function Iv(tr){return ty(tr)?e_(tr):iw(tr)}function ry(tr){return ty(tr)?e_(tr,!0):f3(tr)}function NO(tr,nr){var Lr={};return nr=A1(nr,3),Wy(tr,function(wn,_g,l0){n$(Lr,nr(wn,_g,l0),wn)}),Lr}function LO(tr,nr){var Lr={};return nr=A1(nr,3),Wy(tr,function(wn,_g,l0){n$(Lr,_g,nr(wn,_g,l0))}),Lr}var FO=J$(function(tr,nr,Lr){S2(tr,nr,Lr)}),ES=J$(function(tr,nr,Lr,wn){S2(tr,nr,Lr,wn)}),BO=o$(function(tr,nr){var Lr={};if(tr==null)return Lr;var wn=!1;nr=ov(nr,function(l0){return l0=y$(l0,tr),wn||(wn=l0.length>1),l0}),Hy(tr,yw(tr),Lr),wn&&(Lr=by(Lr,$t|Lt|jt,R3));for(var _g=nr.length;_g--;)cw(Lr,nr[_g]);return Lr});function zO(tr,nr){return TS(tr,F2(A1(nr)))}var UO=o$(function(tr,nr){return tr==null?{}:h3(tr,nr)});function TS(tr,nr){if(tr==null)return{};var Lr=ov(yw(tr),function(wn){return[wn]});return nr=A1(nr),v_(tr,Lr,function(wn,_g){return nr(wn,_g[0])})}function VO(tr,nr,Lr){nr=y$(nr,tr);var wn=-1,_g=nr.length;for(_g||(_g=1,tr=b);++wn<_g;){var l0=tr==null?b:tr[Gy(nr[wn])];l0===b&&(wn=_g,l0=Lr),tr=s$(l0)?l0.call(tr):l0}return tr}function WO(tr,nr,Lr){return tr==null?tr:jx(tr,nr,Lr)}function HO(tr,nr,Lr,wn){return wn=typeof wn=="function"?wn:b,tr==null?tr:jx(tr,nr,Lr,wn)}var CS=F_(Iv),OS=F_(ry);function GO(tr,nr,Lr){var wn=M1(tr),_g=wn||$$(tr)||rx(tr);if(nr=A1(nr,4),Lr==null){var l0=tr&&tr.constructor;_g?Lr=wn?new l0:[]:fv(tr)?Lr=s$(l0)?Q$(p2(tr)):{}:Lr={}}return(_g?Gv:Wy)(tr,function(m0,_0,D0){return nr(Lr,m0,_0,D0)}),Lr}function qO(tr,nr){return tr==null?!0:cw(tr,nr)}function YO(tr,nr,Lr){return tr==null?tr:w_(tr,nr,pw(Lr))}function XO(tr,nr,Lr,wn){return wn=typeof wn=="function"?wn:b,tr==null?tr:w_(tr,nr,pw(Lr),wn)}function nx(tr){return tr==null?[]:i0(tr,Iv(tr))}function KO(tr){return tr==null?[]:i0(tr,ry(tr))}function ZO(tr,nr,Lr){return Lr===b&&(Lr=nr,nr=b),Lr!==b&&(Lr=wy(Lr),Lr=Lr===Lr?Lr:0),nr!==b&&(nr=wy(nr),nr=nr===nr?nr:0),I$(wy(tr),nr,Lr)}function QO(tr,nr,Lr){return nr=l$(nr),Lr===b?(Lr=nr,nr=0):Lr=l$(Lr),tr=wy(tr),n3(tr,nr,Lr)}function JO(tr,nr,Lr){if(Lr&&typeof Lr!="boolean"&&Yv(tr,nr,Lr)&&(nr=Lr=b),Lr===b&&(typeof nr=="boolean"?(Lr=nr,nr=b):typeof tr=="boolean"&&(Lr=tr,tr=b)),tr===b&&nr===b?(tr=0,nr=1):(tr=l$(tr),nr===b?(nr=tr,tr=0):nr=l$(nr)),tr>nr){var wn=tr;tr=nr,nr=wn}if(Lr||tr%1||nr%1){var _g=Qw();return Fv(tr+_g*(nr-tr+Jx("1e-"+((_g+"").length-1))),nr)}return sw(tr,nr)}var eA=ex(function(tr,nr,Lr){return nr=nr.toLowerCase(),tr+(Lr?AS(nr):nr)});function AS(tr){return Dw(tv(tr).toLowerCase())}function PS(tr){return tr=tv(tr),tr&&tr.replace(Sy,h1).replace(r1,"")}function tA(tr,nr,Lr){tr=tv(tr),nr=ly(nr);var wn=tr.length;Lr=Lr===b?wn:I$(L1(Lr),0,wn);var _g=Lr;return Lr-=nr.length,Lr>=0&&tr.slice(Lr,_g)==nr}function rA(tr){return tr=tv(tr),tr&&s1.test(tr)?tr.replace(B0,o1):tr}function nA(tr){return tr=tv(tr),tr&&j0.test(tr)?tr.replace(pv,"\\$&"):tr}var iA=ex(function(tr,nr,Lr){return tr+(Lr?"-":"")+nr.toLowerCase()}),oA=ex(function(tr,nr,Lr){return tr+(Lr?" ":"")+nr.toLowerCase()}),aA=R_("toLowerCase");function sA(tr,nr,Lr){tr=tv(tr),nr=L1(nr);var wn=nr?Y$(tr):0;if(!nr||wn>=nr)return tr;var _g=(nr-wn)/2;return P2(v2(_g),Lr)+tr+P2(g2(_g),Lr)}function lA(tr,nr,Lr){tr=tv(tr),nr=L1(nr);var wn=nr?Y$(tr):0;return nr&&wn<nr?tr+P2(nr-wn,Lr):tr}function uA(tr,nr,Lr){tr=tv(tr),nr=L1(nr);var wn=nr?Y$(tr):0;return nr&&wn<nr?P2(nr-wn,Lr)+tr:tr}function cA(tr,nr,Lr){return Lr||nr==null?nr=0:nr&&(nr=+nr),gE(tv(tr).replace(N1,""),nr||0)}function dA(tr,nr,Lr){return(Lr?Yv(tr,nr,Lr):nr===b)?nr=1:nr=L1(nr),lw(tv(tr),nr)}function fA(){var tr=arguments,nr=tv(tr[0]);return tr.length<3?nr:nr.replace(tr[1],tr[2])}var pA=ex(function(tr,nr,Lr){return tr+(Lr?"_":"")+nr.toLowerCase()});function hA(tr,nr,Lr){return Lr&&typeof Lr!="number"&&Yv(tr,nr,Lr)&&(nr=Lr=b),Lr=Lr===b?Sn:Lr>>>0,Lr?(tr=tv(tr),tr&&(typeof nr=="string"||nr!=null&&!kw(nr))&&(nr=ly(nr),!nr&&q1(tr))?b$(Dy(tr),0,Lr):tr.split(nr,Lr)):[]}var mA=ex(function(tr,nr,Lr){return tr+(Lr?" ":"")+Dw(nr)});function gA(tr,nr,Lr){return tr=tv(tr),Lr=Lr==null?0:I$(L1(Lr),0,tr.length),nr=ly(nr),tr.slice(Lr,Lr+nr.length)==nr}function vA(tr,nr,Lr){var wn=o0.templateSettings;Lr&&Yv(tr,nr,Lr)&&(nr=b),tr=tv(tr),nr=U2({},nr,wn,B_);var _g=U2({},nr.imports,wn.imports,B_),l0=Iv(_g),m0=i0(_g,l0),_0,D0,q0=0,Y0=nr.interpolate||Sv,Q0="__p += '",a1=q2((nr.escape||Sv).source+"|"+Y0.source+"|"+(Y0===K1?dv:Sv).source+"|"+(nr.evaluate||Sv).source+"|$","g"),y1="//# sourceURL="+(av.call(nr,"sourceURL")?(nr.sourceURL+"").replace(/\s/g," "):"lodash.templateSources["+ ++f1+"]")+`
`;tr.replace(a1,function(I1,V1,Y1,cy,Xv,dy){return Y1||(Y1=cy),Q0+=tr.slice(q0,dy).replace(Av,C1),V1&&(_0=!0,Q0+=`' +
__e(`+V1+`) +
'`),Xv&&(D0=!0,Q0+=`';
`+Xv+`;
__p += '`),Y1&&(Q0+=`' +
((__t = (`+Y1+`)) == null ? '' : __t) +
'`),q0=dy+I1.length,I1}),Q0+=`';
`;var k1=av.call(nr,"variable")&&nr.variable;if(!k1)Q0=`with (obj) {
`+Q0+`
}
`;else if(lv.test(k1))throw new D1(Tt);Q0=(D0?Q0.replace(ev,""):Q0).replace(c0,"$1").replace(P0,"$1;"),Q0="function("+(k1||"obj")+`) {
`+(k1?"":`obj || (obj = {});
`)+"var __t, __p = ''"+(_0?", __e = _.escape":"")+(D0?`, __j = Array.prototype.join;
function print() { __p += __j.call(arguments, '') }
`:`;
`)+Q0+`return __p
}`;var j1=IS(function(){return J1(l0,y1+"return "+Q0).apply(b,m0)});if(j1.source=Q0,Pw(j1))throw j1;return j1}function yA(tr){return tv(tr).toLowerCase()}function bA(tr){return tv(tr).toUpperCase()}function $A(tr,nr,Lr){if(tr=tv(tr),tr&&(Lr||nr===b))return xn(tr);if(!tr||!(nr=ly(nr)))return tr;var wn=Dy(tr),_g=Dy(nr),l0=S0(wn,_g),m0=V0(wn,_g)+1;return b$(wn,l0,m0).join("")}function xA(tr,nr,Lr){if(tr=tv(tr),tr&&(Lr||nr===b))return tr.slice(0,Hw(tr)+1);if(!tr||!(nr=ly(nr)))return tr;var wn=Dy(tr),_g=V0(wn,Dy(nr))+1;return b$(wn,0,_g).join("")}function wA(tr,nr,Lr){if(tr=tv(tr),tr&&(Lr||nr===b))return tr.replace(N1,"");if(!tr||!(nr=ly(nr)))return tr;var wn=Dy(tr),_g=S0(wn,Dy(nr));return b$(wn,_g).join("")}function _A(tr,nr){var Lr=ko,wn=Xo;if(fv(nr)){var _g="separator"in nr?nr.separator:_g;Lr="length"in nr?L1(nr.length):Lr,wn="omission"in nr?ly(nr.omission):wn}tr=tv(tr);var l0=tr.length;if(q1(tr)){var m0=Dy(tr);l0=m0.length}if(Lr>=l0)return tr;var _0=Lr-Y$(wn);if(_0<1)return wn;var D0=m0?b$(m0,0,_0).join(""):tr.slice(0,_0);if(_g===b)return D0+wn;if(m0&&(_0+=D0.length-_0),kw(_g)){if(tr.slice(_0).search(_g)){var q0,Y0=D0;for(_g.global||(_g=q2(_g.source,tv(uv.exec(_g))+"g")),_g.lastIndex=0;q0=_g.exec(Y0);)var Q0=q0.index;D0=D0.slice(0,Q0===b?_0:Q0)}}else if(tr.indexOf(ly(_g),_0)!=_0){var a1=D0.lastIndexOf(_g);a1>-1&&(D0=D0.slice(0,a1))}return D0+wn}function SA(tr){return tr=tv(tr),tr&&W0.test(tr)?tr.replace(R0,QS):tr}var EA=ex(function(tr,nr,Lr){return tr+(Lr?" ":"")+nr.toUpperCase()}),Dw=R_("toUpperCase");function kS(tr,nr,Lr){return tr=tv(tr),nr=Lr?b:nr,nr===b?U0(tr)?tE(tr):o2(tr):tr.match(nr)||[]}var IS=U1(function(tr,nr){try{return Hv(tr,b,nr)}catch(Lr){return Pw(Lr)?Lr:new D1(Lr)}}),TA=o$(function(tr,nr){return Gv(nr,function(Lr){Lr=Gy(Lr),n$(tr,Lr,Ow(tr[Lr],tr))}),tr});function CA(tr){var nr=tr==null?0:tr.length,Lr=A1();return tr=nr?ov(tr,function(wn){if(typeof wn[1]!="function")throw new vy(vt);return[Lr(wn[0]),wn[1]]}):[],U1(function(wn){for(var _g=-1;++_g<nr;){var l0=tr[_g];if(Hv(l0[0],this,wn))return Hv(l0[1],this,wn)}})}function OA(tr){return QE(by(tr,$t))}function Mw(tr){return function(){return tr}}function AA(tr,nr){return tr==null||tr!==tr?nr:tr}var PA=M_(),kA=M_(!0);function ny(tr){return tr}function Nw(tr){return d_(typeof tr=="function"?tr:by(tr,$t))}function IA(tr){return p_(by(tr,$t))}function RA(tr,nr){return h_(tr,by(nr,$t))}var DA=U1(function(tr,nr){return function(Lr){return Nx(Lr,tr,nr)}}),MA=U1(function(tr,nr){return function(Lr){return Nx(tr,Lr,nr)}});function Lw(tr,nr,Lr){var wn=Iv(nr),_g=_2(nr,wn);Lr==null&&!(fv(nr)&&(_g.length||!wn.length))&&(Lr=nr,nr=tr,tr=this,_g=_2(nr,Iv(nr)));var l0=!(fv(Lr)&&"chain"in Lr)||!!Lr.chain,m0=s$(tr);return Gv(_g,function(_0){var D0=nr[_0];tr[_0]=D0,m0&&(tr.prototype[_0]=function(){var q0=this.__chain__;if(l0||q0){var Y0=tr(this.__wrapped__),Q0=Y0.__actions__=ey(this.__actions__);return Q0.push({func:D0,args:arguments,thisArg:tr}),Y0.__chain__=q0,Y0}return D0.apply(tr,sy([this.value()],arguments))})}),tr}function NA(){return bv._===this&&(bv._=sE),this}function jw(){}function LA(tr){return tr=L1(tr),U1(function(nr){return m_(nr,tr)})}var jA=mw(ov),FA=mw(n2),BA=mw(W$);function RS(tr){return ww(tr)?H$(Gy(tr)):m3(tr)}function zA(tr){return function(nr){return tr==null?b:R$(tr,nr)}}var UA=L_(),VA=L_(!0);function Fw(){return[]}function Bw(){return!1}function WA(){return{}}function HA(){return""}function GA(){return!0}function qA(tr,nr){if(tr=L1(tr),tr<1||tr>e0)return[];var Lr=Sn,wn=Fv(tr,Sn);nr=A1(nr),tr-=Sn;for(var _g=q$(wn,nr);++Lr<tr;)nr(Lr);return _g}function YA(tr){return M1(tr)?ov(tr,Gy):uy(tr)?[tr]:ey(J_(tv(tr)))}function XA(tr){var nr=++oE;return tv(tr)+nr}var KA=A2(function(tr,nr){return tr+nr},0),ZA=gw("ceil"),QA=A2(function(tr,nr){return tr/nr},1),JA=gw("floor");function e4(tr){return tr&&tr.length?w2(tr,ny,tw):b}function t4(tr,nr){return tr&&tr.length?w2(tr,A1(nr,2),tw):b}function r4(tr){return Cx(tr,ny)}function n4(tr,nr){return Cx(tr,A1(nr,2))}function i4(tr){return tr&&tr.length?w2(tr,ny,ow):b}function o4(tr,nr){return tr&&tr.length?w2(tr,A1(nr,2),ow):b}var a4=A2(function(tr,nr){return tr*nr},1),s4=gw("round"),l4=A2(function(tr,nr){return tr-nr},0);function u4(tr){return tr&&tr.length?f$(tr,ny):0}function c4(tr,nr){return tr&&tr.length?f$(tr,A1(nr,2)):0}return o0.after=kC,o0.ary=cS,o0.assign=yO,o0.assignIn=SS,o0.assignInWith=U2,o0.assignWith=bO,o0.at=$O,o0.before=dS,o0.bind=Ow,o0.bindAll=TA,o0.bindKey=fS,o0.castArray=VC,o0.chain=sS,o0.chunk=Q3,o0.compact=J3,o0.concat=eT,o0.cond=CA,o0.conforms=OA,o0.constant=Mw,o0.countBy=lC,o0.create=xO,o0.curry=pS,o0.curryRight=hS,o0.debounce=mS,o0.defaults=wO,o0.defaultsDeep=_O,o0.defer=IC,o0.delay=RC,o0.difference=tT,o0.differenceBy=rT,o0.differenceWith=nT,o0.drop=iT,o0.dropRight=oT,o0.dropRightWhile=aT,o0.dropWhile=sT,o0.fill=lT,o0.filter=cC,o0.flatMap=pC,o0.flatMapDeep=hC,o0.flatMapDepth=mC,o0.flatten=nS,o0.flattenDeep=uT,o0.flattenDepth=cT,o0.flip=DC,o0.flow=PA,o0.flowRight=kA,o0.fromPairs=dT,o0.functions=PO,o0.functionsIn=kO,o0.groupBy=gC,o0.initial=pT,o0.intersection=hT,o0.intersectionBy=mT,o0.intersectionWith=gT,o0.invert=RO,o0.invertBy=DO,o0.invokeMap=yC,o0.iteratee=Nw,o0.keyBy=bC,o0.keys=Iv,o0.keysIn=ry,o0.map=N2,o0.mapKeys=NO,o0.mapValues=LO,o0.matches=IA,o0.matchesProperty=RA,o0.memoize=j2,o0.merge=FO,o0.mergeWith=ES,o0.method=DA,o0.methodOf=MA,o0.mixin=Lw,o0.negate=F2,o0.nthArg=LA,o0.omit=BO,o0.omitBy=zO,o0.once=MC,o0.orderBy=$C,o0.over=jA,o0.overArgs=NC,o0.overEvery=FA,o0.overSome=BA,o0.partial=Aw,o0.partialRight=gS,o0.partition=xC,o0.pick=UO,o0.pickBy=TS,o0.property=RS,o0.propertyOf=zA,o0.pull=$T,o0.pullAll=oS,o0.pullAllBy=xT,o0.pullAllWith=wT,o0.pullAt=_T,o0.range=UA,o0.rangeRight=VA,o0.rearg=LC,o0.reject=SC,o0.remove=ST,o0.rest=jC,o0.reverse=Tw,o0.sampleSize=TC,o0.set=WO,o0.setWith=HO,o0.shuffle=CC,o0.slice=ET,o0.sortBy=PC,o0.sortedUniq=IT,o0.sortedUniqBy=RT,o0.split=hA,o0.spread=FC,o0.tail=DT,o0.take=MT,o0.takeRight=NT,o0.takeRightWhile=LT,o0.takeWhile=jT,o0.tap=JT,o0.throttle=BC,o0.thru=M2,o0.toArray=xS,o0.toPairs=CS,o0.toPairsIn=OS,o0.toPath=YA,o0.toPlainObject=_S,o0.transform=GO,o0.unary=zC,o0.union=FT,o0.unionBy=BT,o0.unionWith=zT,o0.uniq=UT,o0.uniqBy=VT,o0.uniqWith=WT,o0.unset=qO,o0.unzip=Cw,o0.unzipWith=aS,o0.update=YO,o0.updateWith=XO,o0.values=nx,o0.valuesIn=KO,o0.without=HT,o0.words=kS,o0.wrap=UC,o0.xor=GT,o0.xorBy=qT,o0.xorWith=YT,o0.zip=XT,o0.zipObject=KT,o0.zipObjectDeep=ZT,o0.zipWith=QT,o0.entries=CS,o0.entriesIn=OS,o0.extend=SS,o0.extendWith=U2,Lw(o0,o0),o0.add=KA,o0.attempt=IS,o0.camelCase=eA,o0.capitalize=AS,o0.ceil=ZA,o0.clamp=ZO,o0.clone=WC,o0.cloneDeep=GC,o0.cloneDeepWith=qC,o0.cloneWith=HC,o0.conformsTo=YC,o0.deburr=PS,o0.defaultTo=AA,o0.divide=QA,o0.endsWith=tA,o0.eq=Ny,o0.escape=rA,o0.escapeRegExp=nA,o0.every=uC,o0.find=dC,o0.findIndex=tS,o0.findKey=SO,o0.findLast=fC,o0.findLastIndex=rS,o0.findLastKey=EO,o0.floor=JA,o0.forEach=lS,o0.forEachRight=uS,o0.forIn=TO,o0.forInRight=CO,o0.forOwn=OO,o0.forOwnRight=AO,o0.get=Iw,o0.gt=XC,o0.gte=KC,o0.has=IO,o0.hasIn=Rw,o0.head=iS,o0.identity=ny,o0.includes=vC,o0.indexOf=fT,o0.inRange=QO,o0.invoke=MO,o0.isArguments=N$,o0.isArray=M1,o0.isArrayBuffer=ZC,o0.isArrayLike=ty,o0.isArrayLikeObject=$v,o0.isBoolean=QC,o0.isBuffer=$$,o0.isDate=JC,o0.isElement=eO,o0.isEmpty=tO,o0.isEqual=rO,o0.isEqualWith=nO,o0.isError=Pw,o0.isFinite=iO,o0.isFunction=s$,o0.isInteger=vS,o0.isLength=B2,o0.isMap=yS,o0.isMatch=oO,o0.isMatchWith=aO,o0.isNaN=sO,o0.isNative=lO,o0.isNil=cO,o0.isNull=uO,o0.isNumber=bS,o0.isObject=fv,o0.isObjectLike=gv,o0.isPlainObject=Ux,o0.isRegExp=kw,o0.isSafeInteger=dO,o0.isSet=$S,o0.isString=z2,o0.isSymbol=uy,o0.isTypedArray=rx,o0.isUndefined=fO,o0.isWeakMap=pO,o0.isWeakSet=hO,o0.join=vT,o0.kebabCase=iA,o0.last=xy,o0.lastIndexOf=yT,o0.lowerCase=oA,o0.lowerFirst=aA,o0.lt=mO,o0.lte=gO,o0.max=e4,o0.maxBy=t4,o0.mean=r4,o0.meanBy=n4,o0.min=i4,o0.minBy=o4,o0.stubArray=Fw,o0.stubFalse=Bw,o0.stubObject=WA,o0.stubString=HA,o0.stubTrue=GA,o0.multiply=a4,o0.nth=bT,o0.noConflict=NA,o0.noop=jw,o0.now=L2,o0.pad=sA,o0.padEnd=lA,o0.padStart=uA,o0.parseInt=cA,o0.random=JO,o0.reduce=wC,o0.reduceRight=_C,o0.repeat=dA,o0.replace=fA,o0.result=VO,o0.round=s4,o0.runInContext=I0,o0.sample=EC,o0.size=OC,o0.snakeCase=pA,o0.some=AC,o0.sortedIndex=TT,o0.sortedIndexBy=CT,o0.sortedIndexOf=OT,o0.sortedLastIndex=AT,o0.sortedLastIndexBy=PT,o0.sortedLastIndexOf=kT,o0.startCase=mA,o0.startsWith=gA,o0.subtract=l4,o0.sum=u4,o0.sumBy=c4,o0.template=vA,o0.times=qA,o0.toFinite=l$,o0.toInteger=L1,o0.toLength=wS,o0.toLower=yA,o0.toNumber=wy,o0.toSafeInteger=vO,o0.toString=tv,o0.toUpper=bA,o0.trim=$A,o0.trimEnd=xA,o0.trimStart=wA,o0.truncate=_A,o0.unescape=SA,o0.uniqueId=XA,o0.upperCase=EA,o0.upperFirst=Dw,o0.each=lS,o0.eachRight=uS,o0.first=iS,Lw(o0,function(){var tr={};return Wy(o0,function(nr,Lr){av.call(o0.prototype,Lr)||(tr[Lr]=nr)}),tr}(),{chain:!1}),o0.VERSION=et,Gv(["bind","bindKey","curry","curryRight","partial","partialRight"],function(tr){o0[tr].placeholder=o0}),Gv(["drop","take"],function(tr,nr){G1.prototype[tr]=function(Lr){Lr=Lr===b?1:Ov(L1(Lr),0);var wn=this.__filtered__&&!nr?new G1(this):this.clone();return wn.__filtered__?wn.__takeCount__=Fv(Lr,wn.__takeCount__):wn.__views__.push({size:Fv(Lr,Sn),type:tr+(wn.__dir__<0?"Right":"")}),wn},G1.prototype[tr+"Right"]=function(Lr){return this.reverse()[tr](Lr).reverse()}}),Gv(["filter","map","takeWhile"],function(tr,nr){var Lr=nr+1,wn=Lr==Uo||Lr==_n;G1.prototype[tr]=function(_g){var l0=this.clone();return l0.__iteratees__.push({iteratee:A1(_g,3),type:Lr}),l0.__filtered__=l0.__filtered__||wn,l0}}),Gv(["head","last"],function(tr,nr){var Lr="take"+(nr?"Right":"");G1.prototype[tr]=function(){return this[Lr](1).value()[0]}}),Gv(["initial","tail"],function(tr,nr){var Lr="drop"+(nr?"":"Right");G1.prototype[tr]=function(){return this.__filtered__?new G1(this):this[Lr](1)}}),G1.prototype.compact=function(){return this.filter(ny)},G1.prototype.find=function(tr){return this.filter(tr).head()},G1.prototype.findLast=function(tr){return this.reverse().find(tr)},G1.prototype.invokeMap=U1(function(tr,nr){return typeof tr=="function"?new G1(this):this.map(function(Lr){return Nx(Lr,tr,nr)})}),G1.prototype.reject=function(tr){return this.filter(F2(A1(tr)))},G1.prototype.slice=function(tr,nr){tr=L1(tr);var Lr=this;return Lr.__filtered__&&(tr>0||nr<0)?new G1(Lr):(tr<0?Lr=Lr.takeRight(-tr):tr&&(Lr=Lr.drop(tr)),nr!==b&&(nr=L1(nr),Lr=nr<0?Lr.dropRight(-nr):Lr.take(nr-tr)),Lr)},G1.prototype.takeRightWhile=function(tr){return this.reverse().takeWhile(tr).reverse()},G1.prototype.toArray=function(){return this.take(Sn)},Wy(G1.prototype,function(tr,nr){var Lr=/^(?:filter|find|map|reject)|While$/.test(nr),wn=/^(?:head|last)$/.test(nr),_g=o0[wn?"take"+(nr=="last"?"Right":""):nr],l0=wn||/^find/.test(nr);_g&&(o0.prototype[nr]=function(){var m0=this.__wrapped__,_0=wn?[1]:arguments,D0=m0 instanceof G1,q0=_0[0],Y0=D0||M1(m0),Q0=function(V1){var Y1=_g.apply(o0,sy([V1],_0));return wn&&a1?Y1[0]:Y1};Y0&&Lr&&typeof q0=="function"&&q0.length!=1&&(D0=Y0=!1);var a1=this.__chain__,y1=!!this.__actions__.length,k1=l0&&!a1,j1=D0&&!y1;if(!l0&&Y0){m0=j1?m0:new G1(this);var I1=tr.apply(m0,_0);return I1.__actions__.push({func:M2,args:[Q0],thisArg:b}),new yy(I1,a1)}return k1&&j1?tr.apply(this,_0):(I1=this.thru(Q0),k1?wn?I1.value()[0]:I1.value():I1)})}),Gv(["pop","push","shift","sort","splice","unshift"],function(tr){var nr=s2[tr],Lr=/^(?:push|sort|unshift)$/.test(tr)?"tap":"thru",wn=/^(?:pop|shift)$/.test(tr);o0.prototype[tr]=function(){var _g=arguments;if(wn&&!this.__chain__){var l0=this.value();return nr.apply(M1(l0)?l0:[],_g)}return this[Lr](function(m0){return nr.apply(M1(m0)?m0:[],_g)})}}),Wy(G1.prototype,function(tr,nr){var Lr=o0[nr];if(Lr){var wn=Lr.name+"";av.call(Z$,wn)||(Z$[wn]=[]),Z$[wn].push({name:nr,func:Lr})}}),Z$[O2(b,qt).name]=[{name:"wrapper",func:b}],G1.prototype.clone=_E,G1.prototype.reverse=SE,G1.prototype.value=EE,o0.prototype.at=eC,o0.prototype.chain=tC,o0.prototype.commit=rC,o0.prototype.next=nC,o0.prototype.plant=oC,o0.prototype.reverse=aC,o0.prototype.toJSON=o0.prototype.valueOf=o0.prototype.value=sC,o0.prototype.first=o0.prototype.head,Ax&&(o0.prototype[Ax]=iC),o0},p$=rE();typeof define=="function"&&typeof define.amd=="object"&&define.amd?(bv._=p$,define(function(){return p$})):By?((By.exports=p$)._=p$,O$._=p$):bv._=p$}).call(d)}}),import_lodash=__toESM(require_lodash());async function imageDecode(d){const g=MimeType.fromString(d.type);switch(g.type){case"image/x-alpha8":{const b=parseInt(g.params.width),et=parseInt(g.params.height);return ndarray4(new Uint8Array(await d.arrayBuffer()),[et,b,1])}case"image/x-rgba8":{const b=parseInt(g.params.width),et=parseInt(g.params.height);return ndarray4(new Uint8Array(await d.arrayBuffer()),[et,b,4])}case"application/octet-stream":case"image/png":case"image/jpeg":case"image/jpg":case"image/webp":{const b=await createImageBitmap(d),et=imageBitmapToImageData(b);return ndarray4(new Uint8Array(et.data),[et.height,et.width,4])}default:throw new Error(`Invalid format: ${g.type} with params: ${g.params}`)}}async function imageEncode(d,g=.8,b="image/png"){const[et,st,at]=d.shape;switch(b){case"image/x-alpha8":case"image/x-rgba8":{const Ct=MimeType.create(b,{width:st.toString(),height:et.toString()});return new Blob([d.data],{type:Ct.toString()})}case"image/png":case"image/jpeg":case"image/webp":{const Ct=new ImageData(new Uint8ClampedArray(d.data),st,et);var vt=createCanvas(Ct.width,Ct.height),Tt=vt.getContext("2d");return Tt.putImageData(Ct,0,0),vt.convertToBlob({quality:g,type:b})}default:throw new Error(`Invalid format: ${b}`)}}var MimeType=class Ww{constructor(g,b){this.type="application/octet-stream",this.params={},this.type=g,this.params=b}toString(){const g=[];for(const b in this.params){const et=this.params[b];g.push(`${b}=${et}`)}return[this.type,...g].join(";")}static create(g,b){return new Ww(g,b)}isIdentical(g){return this.type===g.type&&this.params===g.params}isEqual(g){return this.type===g.type}static fromString(g){const[b,...et]=g.split(";"),st={};for(const at of et){const[vt,Tt]=at.split("=");st[vt.trim()]=Tt.trim()}return new Ww(b,st)}};function isAbsoluteURI(d){return new RegExp("^(?:[a-z+]+:)?//","i").test(d)}function ensureAbsoluteURI(d,g){return isAbsoluteURI(d)?d:new URL(d,g).href}function imageBitmapToImageData(d){var g=createCanvas(d.width,d.height),b=g.getContext("2d");return b.drawImage(d,0,0),b.getImageData(0,0,g.width,g.height)}function createTypeArray(d){if(typeof Uint8Array<"u")return new Uint8Array(d);if(typeof Uint8ClampedArray<"u")return new Uint8ClampedArray(d);if(typeof Uint16Array<"u")return new Uint16Array(d);if(typeof Uint32Array<"u")return new Uint32Array(d);if(typeof Float32Array<"u")return new Float32Array(d);if(typeof Float64Array<"u")return new Float64Array(d);throw new Error("TypedArray not supported")}function tensorResizeBilinear(d,g,b,et=!1){const[st,at,vt]=d.shape;let Tt=at/g,Ct=st/b;et&&(Tt=Ct=Math.max(Tt,Ct)>1?Math.max(Tt,Ct):Math.min(Tt,Ct));const pt=ndarray4(createTypeArray(vt*g*b),[b,g,vt]);for(let wt=0;wt<b;wt++)for(let $t=0;$t<g;$t++){const Lt=$t*Tt,jt=wt*Ct,Ft=Math.max(Math.floor(Lt),0),Gt=Math.min(Math.ceil(Lt),at-1),Ht=Math.max(Math.floor(jt),0),qt=Math.min(Math.ceil(jt),st-1),Kt=Lt-Ft,rr=jt-Ht;for(let ir=0;ir<vt;ir++){const or=d.get(Ht,Ft,ir),jr=d.get(Ht,Gt,ir),qr=d.get(qt,Ft,ir),Yr=d.get(qt,Gt,ir),vn=(1-Kt)*(1-rr)*or+Kt*(1-rr)*jr+(1-Kt)*rr*qr+Kt*rr*Yr;pt.set(wt,$t,ir,vn)}}return pt}function tensorHWCtoBCHW(d,g=[128,128,128],b=[256,256,256]){var et=d.data;const[st,at,vt]=d.shape,Tt=st*at,Ct=new Float32Array(3*Tt);for(let pt=0,wt=0;pt<et.length;pt+=4,wt+=1)Ct[wt]=(et[pt]-g[0])/b[0],Ct[wt+Tt]=(et[pt+1]-g[1])/b[1],Ct[wt+Tt+Tt]=(et[pt+2]-g[2])/b[2];return ndarray4(Ct,[1,3,st,at])}async function imageSourceToImageData(d,g){return typeof d=="string"&&(d=ensureAbsoluteURI(d,g.publicPath),d=new URL(d)),d instanceof URL&&(d=await(await fetch(d,{})).blob()),(d instanceof ArrayBuffer||ArrayBuffer.isView(d))&&(d=new Blob([d])),d instanceof Blob&&(d=await imageDecode(d)),d}function convertFloat32ToUint8(d){const g=new Uint8Array(d.data.length);for(let b=0;b<d.data.length;b++)g[b]=d.data[b]*255;return ndarray4(g,d.shape)}function createCanvas(d,g){let b;if(typeof OffscreenCanvas<"u"?b=new OffscreenCanvas(d,g):b=document.createElement("canvas"),!b)throw new Error("Canvas nor OffscreenCanvas are available in the current context.");return b}async function loadAsUrl(d,g){return URL.createObjectURL(await loadAsBlob(d,g))}async function loadAsBlob(d,g){const b=new URL("resources.json",g.publicPath),et=await fetch(b);if(!et.ok)throw new Error("Resource metadata not found. Ensure that the config.publicPath is configured correctly.");const at=(await et.json())[d];if(!at)throw new Error(`Resource ${d} not found. Ensure that the config.publicPath is configured correctly.`);const vt=at.chunks;let Tt=0;const Ct=vt.map(async $t=>{const Lt=$t.offsets[1]-$t.offsets[0],jt=g.publicPath?new URL($t.hash,g.publicPath).toString():$t.hash,Gt=await(await fetch(jt,g.fetchArgs)).blob();if(Lt!==Gt.size)throw new Error(`Failed to fetch ${d} with size ${Lt} but got ${Gt.size}`);return g.progress&&(Tt+=Lt,g.progress(`fetch:${d}`,Tt,at.size)),Gt}),pt=await Promise.all(Ct),wt=new Blob(pt,{type:at.mime});if(wt.size!==at.size)throw new Error(`Failed to fetch ${d} with size ${at.size} but got ${wt.size}`);return wt}var simd=()=>WebAssembly.validate(new Uint8Array([0,97,115,109,1,0,0,0,1,5,1,96,0,1,123,3,2,1,0,10,10,1,8,0,65,0,253,15,253,98,11])),threads=()=>(async d=>{try{return typeof MessageChannel<"u"&&new MessageChannel().port1.postMessage(new SharedArrayBuffer(1)),WebAssembly.validate(d)}catch{return!1}})(new Uint8Array([0,97,115,109,1,0,0,0,1,4,1,96,0,0,3,2,1,0,5,4,1,3,1,1,10,11,1,9,0,65,0,254,16,2,0,26,11])),webgpu=()=>navigator.gpu!==void 0,maxNumThreads=()=>navigator.hardwareConcurrency??4;async function createOnnxSession(d,g){const b=g.device==="gpu",et=await threads(),st=simd(),at=g.proxyToWorker,vt=[b?"webgpu":"wasm"],Tt=b?ort_gpu:ort_cpu;g.debug&&(console.debug("	Using Threads:",et),console.debug("	Using SIMD:",st),console.debug("	Using WebGPU:",b),console.debug("	Proxy to Worker:",at),Tt.env.debug=!0,Tt.env.logLevel="verbose"),Tt.env.wasm.numThreads=maxNumThreads(),Tt.env.wasm.simd=simd(),Tt.env.wasm.proxy=at;const Ct={"ort-wasm-simd-threaded.wasm":et&&st,"ort-wasm-simd.wasm":!et&&st,"ort-wasm-threaded.wasm":!b&&et&&!st,"ort-wasm.wasm":!b&&!et&&!st},pt={};for(const[Lt,jt]of Object.entries(Ct))if(jt){const Ft=b&&Lt.includes("simd")?`/onnxruntime-web/${Lt.replace(".wasm",".jsep.wasm")}`:`/onnxruntime-web/${Lt}`;pt[Lt]=await loadAsUrl(Ft,g)}Tt.env.wasm.wasmPaths=pt,g.debug&&console.debug("ort.env.wasm:",Tt.env.wasm);const wt={executionProviders:vt,graphOptimizationLevel:"all",executionMode:"parallel",enableCpuMemArena:!0};return await Tt.InferenceSession.create(d,wt).catch(Lt=>{throw new Error(`Failed to create session: "${Lt}". Please check if the publicPath is set correctly.`)})}async function runOnnxSession(d,g,b,et){const at=et.device==="gpu"?ort_gpu:ort_cpu,vt={};for(const[pt,wt]of g)vt[pt]=new at.Tensor("float32",new Float32Array(wt.data),wt.shape);const Tt=await d.run(vt,{}),Ct=[];for(const pt of b){const wt=Tt[pt],$t=wt.dims,Lt=wt.data,jt=ndarray4(Lt,$t);Ct.push(jt)}return Ct}var package_default={name:"@imgly/background-removal",version:"1.5.3",description:"Background Removal in the Browser",keywords:["background-removal","client-side","data-privacy","image-segmentation","image-matting","onnx"],repository:{type:"git",url:"git+https://github.com/imgly/background-removal-js.git"},license:"SEE LICENSE IN LICENSE.md",author:{name:"IMG.LY GmbH",email:"support@img.ly",url:"https://img.ly"},bugs:{email:"support@img.ly"},source:"./src/index.ts",main:"./dist/index.cjs",module:"./dist/index.mjs",types:"./dist/src/index.d.ts",exports:{".":{require:"./dist/index.cjs",import:"./dist/index.mjs",types:"./dist/src/index.d.ts"}},homepage:"https://img.ly/showcases/cesdk/web/background-removal",files:["LICENSE.md","README.md","CHANGELOG.md","ThirdPartyLicenses.json","dist/","bin/"],scripts:{start:"npm run watch",clean:"npx rimraf dist",test:"true",resources:"node ../../scripts/package-resources.mjs","changelog:create":"node ../../scripts/changelog/changelog-create.mjs","changelog:generate":"node ../../scripts/changelog/changelog-generate.mjs",build:"npm run clean && npm run types && npm run resources && npm run changelog:generate && node scripts/build.mjs",types:" npx tsc --declaration --emitDeclarationOnly --declarationDir dist --declarationMap",watch:"npm run clean && npm run resources && npm run changelog:generate && node scripts/watch.mjs","publish:latest":"npm publish --tag latest --access public","publish:next":"npm publish --tag next --access public","package:pack":"npm pack . --pack-destination ../../releases",lint:"npx prettier --write ."},dependencies:{"@types/lodash-es":"^4.17.12","@types/ndarray":"~1.0.14","@types/node":"~20.3.0","lodash-es":"^4.17.21",ndarray:"~1.0.0","onnxruntime-web":"~1.18.0",zod:"^3.23.8"},devDependencies:{assert:"~2.0.0",esbuild:"~0.18.0",glob:"~10.3.0","npm-dts":"~1.3.0",process:"~0.11.0","ts-loader":"~9.4.0",tslib:"~2.5.0",typescript:"~5.1.0",util:"~0.12.0",webpack:"~5.85.0","webpack-cli":"~5.1.0"},bundleDependencies:[]},ConfigSchema=z$1.object({publicPath:z$1.string().optional().describe("The public path to the wasm files and the onnx model.").default("https://staticimgly.com/@imgly/background-removal-data/${PACKAGE_VERSION}/dist/").transform(d=>d.replace("${PACKAGE_NAME}",package_default.name).replace("${PACKAGE_VERSION}",package_default.version)),debug:z$1.boolean().default(!1).describe("Whether to enable debug logging."),rescale:z$1.boolean().default(!0).describe("Whether to rescale the image."),device:z$1.enum(["cpu","gpu"]).default("cpu").describe("The device to run the model on."),proxyToWorker:z$1.boolean().default(!0).describe("Whether to proxy inference to a web worker."),fetchArgs:z$1.any().default({}).describe("Arguments to pass to fetch when loading the model."),progress:z$1.function().args(z$1.string(),z$1.number(),z$1.number()).returns(z$1.void()).describe("Progress callback.").optional(),model:z$1.preprocess(d=>{switch(d){case"large":return"isnet";case"small":return"isnet_quint8";case"medium":return"isnet_fp16";default:return d}},z$1.enum(["isnet","isnet_fp16","isnet_quint8"])).default("medium"),output:z$1.object({format:z$1.enum(["image/png","image/jpeg","image/webp","image/x-rgba8","image/x-alpha8"]).default("image/png"),quality:z$1.number().default(.8)}).default({})}).default({}).transform(d=>(d.debug&&console.log("Config:",d),d.debug&&!d.progress&&(d.progress=d.progress??((g,b,et)=>{console.debug(`Downloading ${g}: ${b} of ${et}`)}),crossOriginIsolated||d.debug&&console.debug("Cross-Origin-Isolated is not enabled. Performance will be degraded. Please see  https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/SharedArrayBuffer.")),d.device=="gpu"&&(webgpu()||(d.debug&&console.debug("Switching to CPU for GPU not supported."),d.device="cpu")),d));function validateConfig(d){return ConfigSchema.parse(d??{})}async function initBase(d){d.debug&&console.debug("Loading model...",d.model);const g=d.model,et=await(await loadAsBlob(`/models/${g}`,d)).arrayBuffer();return await createOnnxSession(et,d)}async function initInference(d){d=validateConfig(d);const g=await initBase(d);return{config:d,session:{base:g}}}async function runInference(d,g,b){const[st,at,vt]=d.shape,Tt=!1;let Ct=tensorResizeBilinear(d,1024,1024,Tt);const pt=tensorHWCtoBCHW(Ct);let wt=await runOnnxSession(b.base,[["input",pt]],["output"],g),$t=ndarray4(wt[0].data,[1024,1024,1]),Lt=convertFloat32ToUint8($t);return g.rescale?(Lt=tensorResizeBilinear(Lt,at,st,Tt),[Lt,d]):[Lt,Ct]}var init=(0,import_lodash.memoize)(initInference,d=>JSON.stringify(d));async function removeBackground(d,g){var Lt,jt,Ft,Gt;const{config:b,session:et}=await init(g);b.progress&&b.progress("compute:decode",0,4);const st=await imageSourceToImageData(d,b);(Lt=b.progress)==null||Lt.call(b,"compute:inference",1,4);const[at,vt]=await runInference(st,b,et);(jt=b.progress)==null||jt.call(b,"compute:mask",2,4);const Tt=vt,[Ct,pt]=Tt.shape,wt=Ct*pt;for(let Ht=0;Ht<wt;Ht+=1)Tt.data[4*Ht+3]=at.data[Ht];(Ft=b.progress)==null||Ft.call(b,"compute:encode",3,4);const $t=await imageEncode(Tt,b.output.quality,b.output.format);return(Gt=b.progress)==null||Gt.call(b,"compute:encode",4,4),$t}/*! Bundled license information:

lodash/lodash.js:
  (**
   * @license
   * Lodash <https://lodash.com/>
   * Copyright OpenJS Foundation and other contributors <https://openjsf.org/>
   * Released under MIT license <https://lodash.com/license>
   * Based on Underscore.js 1.8.3 <http://underscorejs.org/LICENSE>
   * Copyright Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors
   *)
*/const TOOLBAR_HEIGHT=200,COMPARE_SLIDER_DURATION_MS=300,DELTA_FRAME=50,hexToRgba=d=>{d=d.replace("#","");const g=parseInt(d.substring(0,2),16),b=parseInt(d.substring(2,4),16),et=parseInt(d.substring(4,6),16),st=parseInt(d.substring(6,8),16)/255;return`rgba(${g}, ${b}, ${et}, ${st})`},config={debug:!0,rescale:!0,device:"cpu",output:{quality:.8,format:"image/png"}},Editor=React.forwardRef(({fabricRef:d,file:g},b)=>{if(typeof b=="function")throw new Error("Only React Refs that are created with createRef or useRef are supported");const{toast:et}=useToast(),[st,at,vt,Tt,Ct,pt,wt,$t,Lt,jt,Ft,Gt,Ht,qt,Kt,rr,ir,or,jr,qr,Yr,vn,ko,Xo,zo]=useStore(T0=>[T0.disableShortCuts,T0.windowSize,T0.isInpainting,T0.imageWidth,T0.imageHeight,T0.settings,T0.serverConfig.enableAutoSaving,T0.setImageSize,T0.setBaseBrushSize,T0.interactiveSegState,T0.updateInteractiveSegState,T0.handleCanvasMouseDown,T0.handleSaveState,T0.handleCanvasMouseMove,T0.undo,T0.redo,T0.undoDisabled(),T0.redoDisabled(),T0.getIsProcessing(),T0.updateAppState,T0.runMannually(),T0.runInpainting,T0.isCropperExtenderResizing,T0.decreaseBaseBrushSize,T0.increaseBaseBrushSize]),t0=useStore(T0=>T0.editorState.baseBrushSize),Uo=useStore(T0=>T0.getBrushSize()),No=useStore(T0=>T0.editorState.renders),_n=useStore(T0=>T0.editorState.extraMasks);useStore(T0=>T0.editorState.temporaryMasks),useStore(T0=>T0.editorState.lineGroups),useStore(T0=>T0.editorState.curLineGroup);const Kr=useStore(T0=>T0.editorState.currCanvasGroups),[e0,Zr]=reactExports.useState(!1),[Ro,Sn]=useImage(g),[Tn,n0]=reactExports.useState();reactExports.useState(),reactExports.useState(null);const[{x:Go,y:An},a0]=reactExports.useState({x:-1,y:-1}),[u0,d0]=reactExports.useState(!1),[f0,y0]=reactExports.useState(!1),[b0,O0]=reactExports.useState(!1),[C0,v0]=reactExports.useState(1),[k0,N0]=reactExports.useState(!1),[w0,r0]=reactExports.useState(1),p0=at.width/2,$0=at.height/2,A0=reactExports.useRef(null),[g0,E0]=reactExports.useState(!1),[F0,K0]=reactExports.useState(!1);reactExports.useState(!1),reactExports.useState(null);const[l1,n1]=reactExports.useState(0),[x1,u1]=reactExports.useState(!1),P1=reactExports.useRef(null),i1=reactExports.useRef(null),v1=reactExports.useRef(null),_1=reactExports.useRef(null),X1=reactExports.useCallback(()=>Kr.length!==0,[Kr]),t1=reactExports.useCallback(()=>{if(console.log("save state"),d.current){const T0=d.current.toJSON();Ht(JSON.stringify(T0))}},[d.current]),cv=(T0,c1)=>{const O1=c1.target;console.log(O1),removeBackground(O1.src,config).then(T1=>{const d1=URL.createObjectURL(T1),lv=new Image;loadImage$1(lv,d1).then(()=>{console.log(lv);const iv=O1.canvas;iv==null||iv.remove(O1);const dv=new fabric.fabric.Image(lv,{left:0,top:0});iv==null||iv.add(dv),iv==null||iv.requestRenderAll()})})};function S1(){var lv;if(!d.current||!v1.current||!_1.current)return;console.log(v1.current),console.log(_1.current);let T0=parseInt(v1.current.height*v1.current.scaleY),c1=parseInt(v1.current.width*v1.current.scaleX),O1=v1.current.top,T1=v1.current.left;O1<_1.current.top&&(console.log("case top < rectangular"),T0=T0-(_1.current.top-O1),O1=_1.current.top,console.log(O1)),T1<_1.current.left&&(console.log("case left < rectangular"),c1=c1-(_1.current.left-T1),T1=_1.current.left,console.log(T1)),O1+T0>_1.current.top+_1.current.height*_1.current.scaleY&&(console.log("trim case 1"),T0=_1.current.top+_1.current.height*_1.current.scaleY-O1),T1+c1>_1.current.left+_1.current.width*_1.current.scaleX&&(console.log("trim case 2"),c1=_1.current.left+_1.current.width*_1.current.scaleX-T1);var d1=new fabric.fabric.Canvas(i1.current,{});(lv=d.current)==null||lv.remove(_1.current),_1.current=null,fabric.fabric.Image.fromURL(d.current.toDataURL("png"),function(iv){iv.set("left",-T1),iv.set("top",-O1),d1.add(iv),d1.setHeight(T0),d1.setWidth(c1),d1.renderAll(),fabric.fabric.Image.fromURL(d1.toDataURL("png"),function(dv){var uv,Rv;dv.set("left",T1),dv.set("top",O1),(uv=d.current)==null||uv.remove(v1.current),v1.current=null,(Rv=d.current)==null||Rv.add(dv).renderAll()})})}const ev=(T0,c1)=>{const O1=c1.target,T1=O1.canvas;T1==null||T1.remove(O1),T1==null||T1.requestRenderAll()},c0=(T0,c1)=>{var lv,iv,dv,uv,Rv,wv,Uv,_v;const O1=c1.target,T1=new fabric.fabric.Rect({fill:"rgba(0,0,0,0)",originX:"left",originY:"top",stroke:"#ccc",hasBorders:!0,lockMovementX:!0,lockMovementY:!0,strokeWidth:5,width:1,height:1,borderColor:"yellow",cornerColor:"green",hasRotatingPoint:!1,selectable:!0}),d1=O1.canvas;v1.current=d1==null?void 0:d1.getActiveObject(),T1.left=(lv=d1==null?void 0:d1.getActiveObject())==null?void 0:lv.left,(iv=d1==null?void 0:d1.getActiveObject())==null||iv.left,(dv=d1==null?void 0:d1.getActiveObject())==null||dv.top,T1.top=(uv=d1==null?void 0:d1.getActiveObject())==null?void 0:uv.top,T1.width=((Rv=d1==null?void 0:d1.getActiveObject())==null?void 0:Rv.width)*((wv=d1==null?void 0:d1.getActiveObject())==null?void 0:wv.scaleX),T1.height=((Uv=d1==null?void 0:d1.getActiveObject())==null?void 0:Uv.height)*((_v=d1==null?void 0:d1.getActiveObject())==null?void 0:_v.scaleY),_1.current=T1,d1==null||d1.add(T1),d1==null||d1.setActiveObject(T1)};reactExports.useEffect(()=>{const T0=()=>new fabric.fabric.Canvas(P1.current,{fireMiddleClick:!0});d.current=T0(),d.current.isDrawingMode=pt.showDrawing,d.current.freeDrawingBrush.width=DEFAULT_BRUSH_SIZE,d.current.freeDrawingBrush.color=hexToRgba(BRUSH_COLOR),fabric.fabric.Object.prototype.transparentCorners=!1,fabric.fabric.Object.prototype.cornerColor="yellow",fabric.fabric.Object.prototype.cornerStyle="circle";const c1='data:image/svg+xml,%3Csvg height="200px" width="200px" version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 512 512" xml:space="preserve" fill="%23000000"%3E%3Cg id="SVGRepo_bgCarrier" stroke-width="0"%3E%3C/g%3E%3Cg id="SVGRepo_tracerCarrier" stroke-linecap="round" stroke-linejoin="round"%3E%3C/g%3E%3Cg id="SVGRepo_iconCarrier"%3E%3Cg transform="translate(0 1)"%3E%3Cpolygon style="fill:%233D83F3;" points="34.712,502.322 477.288,502.322 477.288,7.678 34.712,7.678 "%3E%3C/polygon%3E%3Cpolygon style="fill:%23315ED8;" points="477.288,502.322 503.322,502.322 503.322,7.678 477.288,7.678 "%3E%3C/polygon%3E%3Cpolygon style="fill:%23FFFFFF;" points="8.678,502.322 34.712,502.322 34.712,7.678 8.678,7.678 "%3E%3C/polygon%3E%3Cpath d="M512,511H0V120.492c0-5.207,3.471-8.678,8.678-8.678s8.678,3.471,8.678,8.678v373.153h477.288v-78.102 c0-5.207,3.471-8.678,8.678-8.678c5.207,0,8.678,3.471,8.678,8.678V511z"%3E%3C/path%3E%3Cpath d="M503.322,346.119c-5.207,0-8.678-3.471-8.678-8.678V16.356H17.356v34.712c0,5.207-3.471,8.678-8.678,8.678 S0,56.275,0,51.068V-1h512v338.441C512,342.647,508.529,346.119,503.322,346.119z"%3E%3C/path%3E%3Cpath d="M17.356,85.78c0-5.207-3.471-8.678-8.678-8.678S0,80.573,0,85.78c0,5.207,3.471,8.678,8.678,8.678 S17.356,90.986,17.356,85.78"%3E%3C/path%3E%3Cpath d="M503.322,389.508c-5.207,0-8.678-3.471-8.678-8.678v-8.678c0-5.207,3.471-8.678,8.678-8.678 c5.207,0,8.678,3.471,8.678,8.678v8.678C512,386.037,508.529,389.508,503.322,389.508z"%3E%3C/path%3E%3Cpath style="fill:%23FFE100;" d="M395.715,178.634L303.729,85.78c-8.678-8.678-22.563-8.678-31.241,0L69.424,288.844 c-8.678,8.678-8.678,22.563,0,31.241l73.763,72.895l56.407,13.885l196.122-196.99C404.393,201.197,404.393,187.312,395.715,178.634 "%3E%3C/path%3E%3Cpath style="fill:%23FF8800;" d="M395.715,178.634c8.678,8.678,8.678,22.563,0,31.241l-196.122,196.99h27.77l183.105-183.105 c8.678-8.678,8.678-22.563,0-31.241L395.715,178.634z"%3E%3C/path%3E%3Cpath d="M308.936,333.969c-2.603,0-4.339-0.868-6.075-2.603L167.485,195.99c-3.471-3.471-3.471-8.678,0-12.149 c3.471-3.471,8.678-3.471,12.149,0L315.01,319.217c3.471,3.471,3.471,8.678,0,12.149 C313.275,333.102,311.539,333.969,308.936,333.969z"%3E%3C/path%3E%3Cpath d="M230.834,415.542h-76.366L66.82,327.895c-6.075-6.075-8.678-13.885-8.678-21.695s3.471-15.62,8.678-21.695L269.017,83.176 c12.149-12.149,31.241-12.149,43.39,0l104.136,104.136c6.075,6.075,8.678,13.885,8.678,21.695s-3.471,15.62-8.678,21.695 L230.834,415.542z M161.41,398.186h62.481l180.502-180.502c2.603-2.603,3.471-6.075,3.471-9.546c0-3.471-1.736-6.942-3.471-9.546 l0,0L300.258,94.458c-5.207-5.207-13.885-5.207-19.092,0L78.969,297.522c-2.603,2.603-3.471,6.075-3.471,9.546 c0,3.471,1.736,6.942,3.471,9.546L161.41,398.186z"%3E%3C/path%3E%3Cpath d="M433.898,415.542H286.373c-5.207,0-8.678-3.471-8.678-8.678s3.471-8.678,8.678-8.678h147.525 c5.207,0,8.678,3.471,8.678,8.678S439.105,415.542,433.898,415.542z"%3E%3C/path%3E%3C/g%3E%3C/g%3E%3C/svg%3E',O1=document.createElement("img");O1.src=c1;const T1="data:image/svg+xml,%3Csvg height='200px' width='200px' version='1.1' id='Layer_1' xmlns='http://www.w3.org/2000/svg' xmlns:xlink='http://www.w3.org/1999/xlink' viewBox='0 0 512.002 512.002' xml:space='preserve' fill='%23000000'%3E%3Cg id='SVGRepo_bgCarrier' stroke-width='0'%3E%3C/g%3E%3Cg id='SVGRepo_tracerCarrier' stroke-linecap='round' stroke-linejoin='round'%3E%3C/g%3E%3Cg id='SVGRepo_iconCarrier'%3E%3Cpath style='fill:%23E6E6E6;' d='M330.391,299.581l-64.844,40.281l-139.48-224.536C103.82,79.513,114.818,32.447,150.63,10.2l0,0 L330.391,299.581z'%3E%3C/path%3E%3Cpath style='fill:%23E8655A;' d='M330.196,299.702l-64.65,40.16l78.278,126.013c22.18,35.706,69.105,46.669,104.809,24.49l0,0 c35.706-22.18,46.669-69.105,24.49-104.809l-38.118-61.362C412.826,288.488,365.901,277.523,330.196,299.702z M436.024,402.695 c10.36,16.678,5.239,38.596-11.439,48.955l0,0c-16.678,10.36-38.596,5.239-48.956-11.439l-32.824-52.841 c-10.36-16.678-5.239-38.596,11.439-48.955l0,0c16.678-10.36,38.596-5.239,48.955,11.439L436.024,402.695z'%3E%3C/path%3E%3Cpath style='fill:%23E6E6E6;' d='M181.61,299.581l64.844,40.281l139.48-224.536C408.18,79.513,397.183,32.447,361.37,10.2l0,0 L181.61,299.581z'%3E%3C/path%3E%3Cpath style='fill:%23E8655A;' d='M76.995,324.192l-38.118,61.362c-22.18,35.706-11.215,82.63,24.49,104.809l0,0 c35.706,22.18,82.63,11.215,104.809-24.49l78.278-126.013l-64.65-40.16C146.1,277.523,99.174,288.488,76.995,324.192z M108.801,349.855c10.36-16.678,32.278-21.799,48.956-11.439l0,0c16.678,10.36,21.799,32.278,11.439,48.955l-32.824,52.841 c-10.36,16.678-32.278,21.799-48.956,11.439l0,0c-16.678-10.36-21.799-32.278-11.439-48.955L108.801,349.855z'%3E%3C/path%3E%3Cg%3E%3Cpath style='fill:%23603813;' d='M218.398,160.423l-3.71-5.971c-2.97-4.784-9.259-6.254-14.046-3.281 c-4.785,2.973-6.254,9.261-3.281,14.046l3.71,5.971c1.932,3.109,5.263,4.818,8.674,4.818c1.837,0,3.697-0.497,5.373-1.537 C219.902,171.496,221.37,165.207,218.398,160.423z'%3E%3C/path%3E%3Cpath style='fill:%23603813;' d='M481.787,380.172l-38.118-61.362c-23.248-37.425-70.666-50.855-109.652-32.721l-21.076-33.929 l81.657-131.452c25.179-40.533,12.687-93.992-27.846-119.172c-2.297-1.427-5.067-1.883-7.703-1.268 c-2.635,0.616-4.915,2.252-6.343,4.55L256,160.497L159.294,4.818c-1.427-2.298-3.709-3.934-6.343-4.55 c-2.634-0.616-5.406-0.159-7.703,1.268c-40.532,25.179-53.024,78.639-27.846,119.172l81.658,131.453l-21.076,33.929 c-38.986-18.135-86.405-4.705-109.652,32.721l-38.118,61.362C5.102,420.599,17.56,473.917,57.986,499.029 c14.142,8.785,29.862,12.972,45.402,12.972c28.878,0,57.129-14.461,73.455-40.744l78.277-126.012l0.882-1.421l0.882,1.421 l78.277,126.012c16.328,26.285,44.574,40.744,73.455,40.744c15.536,0,31.26-4.188,45.401-12.972 C494.441,473.916,506.899,420.598,481.787,380.172z M316.344,296.299l-38.522,23.93l-8.993,5.586l-0.821-1.322l32.926-53.004 L316.344,296.299z M134.731,109.944c-10.809-17.401-12.527-37.917-6.473-55.971l50.651,81.539c1.932,3.11,5.263,4.819,8.674,4.819 c1.837,0,3.696-0.497,5.372-1.537c4.785-2.973,6.256-9.261,3.282-14.046l-56.73-91.324c2.461-3.045,5.216-5.897,8.255-8.509 l96.23,154.913l-32.926,53.004L134.731,109.944z M364.238,24.915c3.039,2.613,5.795,5.464,8.255,8.509l-38.222,61.53 c-2.973,4.785-1.503,11.074,3.282,14.046c1.676,1.041,3.535,1.537,5.372,1.537c3.411,0,6.742-1.709,8.674-4.819l32.144-51.746 c6.055,18.054,4.336,38.57-6.473,55.971L243.171,325.815l-47.515-29.516L364.238,24.915z M159.513,460.492 c-12.469,20.072-34.04,31.116-56.094,31.114c-11.864,0-23.872-3.198-34.67-9.906c-30.87-19.177-40.383-59.892-21.207-90.763 l38.118-61.362c19.177-30.871,59.892-40.384,90.763-21.207l55.985,34.777L159.513,460.492z M443.252,481.7 c-30.873,19.177-71.589,9.661-90.764-21.207l-72.894-117.348l55.985-34.777c30.871-19.177,71.587-9.662,90.763,21.207 l38.118,61.362C483.634,421.807,474.121,462.523,443.252,481.7z'%3E%3C/path%3E%3Cpath style='fill:%23603813;' d='M411.864,344.472c-6.448-10.38-16.553-17.628-28.452-20.409c-11.899-2.781-24.169-0.761-34.55,5.687 c-21.429,13.312-28.032,41.575-14.721,63.002l32.824,52.841c8.655,13.933,23.628,21.598,38.937,21.597 c8.235,0,16.57-2.219,24.065-6.876c21.429-13.312,28.032-41.575,14.721-63.002L411.864,344.472z M419.203,442.986 c-11.874,7.375-27.532,3.718-34.911-8.158l-32.824-52.841c-7.374-11.874-3.717-27.533,8.157-34.909 c4.067-2.526,8.657-3.826,13.328-3.826c1.935,0,3.885,0.223,5.816,0.674c6.593,1.541,12.192,5.557,15.765,11.309l32.825,52.841 C434.735,419.951,431.077,435.611,419.203,442.986z'%3E%3C/path%3E%3Cpath style='fill:%23603813;' d='M163.138,329.751c-10.379-6.447-22.649-8.469-34.55-5.687c-11.899,2.78-22.003,10.028-28.451,20.408 l-32.825,52.841C54,418.74,60.605,447.003,82.033,460.315c7.497,4.656,15.829,6.876,24.065,6.876 c15.308,0,30.282-7.666,38.937-21.597l32.824-52.841C191.171,371.325,184.566,343.063,163.138,329.751z M160.531,381.988 l-32.824,52.841c-7.377,11.876-23.037,15.532-34.911,8.158c-11.874-7.375-15.532-23.035-8.157-34.909l32.825-52.841l0,0 c3.573-5.752,9.172-9.767,15.765-11.308c1.933-0.451,3.881-0.674,5.816-0.674c4.671,0,9.261,1.299,13.328,3.826 C164.247,354.456,167.906,370.116,160.531,381.988z'%3E%3C/path%3E%3Cpath style='fill:%23603813;' d='M257.295,266.804c5.632,0,10.2-4.566,10.2-10.2v-9.115c0-5.633-4.568-10.2-10.2-10.2 c-5.632,0-10.2,4.566-10.2,10.2v9.115C247.095,262.237,251.663,266.804,257.295,266.804z'%3E%3C/path%3E%3C/g%3E%3C/g%3E%3C/svg%3E",d1=document.createElement("img");d1.src=T1;const lv="data:image/svg+xml,%3Csvg viewBox='0 0 1024 1024' class='icon' version='1.1' xmlns='http://www.w3.org/2000/svg' fill='%23000000'%3E%3Cg id='SVGRepo_bgCarrier' stroke-width='0'%3E%3C/g%3E%3Cg id='SVGRepo_tracerCarrier' stroke-linecap='round' stroke-linejoin='round'%3E%3C/g%3E%3Cg id='SVGRepo_iconCarrier'%3E%3Cpath d='M724.3 198H296.1l54.1-146.6h320z' fill='%23FAFCFB'%3E%3C/path%3E%3Cpath d='M724.3 216.5H296.1c-6.1 0-11.7-3-15.2-7.9-3.5-5-4.3-11.3-2.2-17L332.8 45c2.7-7.3 9.6-12.1 17.4-12.1h320c7.7 0 14.7 4.8 17.4 12.1l54.1 146.6c2.1 5.7 1.3 12-2.2 17-3.5 4.9-9.2 7.9-15.2 7.9z m-401.6-37h375.1L657.3 69.9H363.1l-40.4 109.6z' fill='%230F0F0F'%3E%3C/path%3E%3Cpath d='M664.3 981.6H339.7c-54.2 0-98.5-43.3-99.6-97.5L223.7 235h572.9l-32.8 651.4c-2.3 53.2-46.1 95.2-99.5 95.2z' fill='%239DC6AF'%3E%3C/path%3E%3Cpath d='M664.3 995H339.7c-29.7 0-57.8-11.4-79-32.2-21.2-20.8-33.3-48.6-34-78.3L210 221.6h600.7L777.2 887c-2.6 60.5-52.2 108-112.9 108zM237.4 248.3l16 635.5c0.5 22.7 9.7 44 25.9 59.8 16.2 15.9 37.7 24.6 60.4 24.6h324.6c46.3 0 84.2-36.2 86.2-82.5l32.1-637.4H237.4z' fill='%23191919'%3E%3C/path%3E%3Cpath d='M827.1 239.5H193.3c-22.2 0-40.4-18.2-40.4-40.4v-2.2c0-22.2 18.2-40.4 40.4-40.4h633.8c22.2 0 40.4 18.2 40.4 40.4v2.2c0 22.2-18.2 40.4-40.4 40.4z' fill='%23D39E33'%3E%3C/path%3E%3Cpath d='M826 252.9H194.4c-30.3 0-54.9-24.6-54.9-54.9 0-30.3 24.6-54.9 54.9-54.9H826c30.3 0 54.9 24.6 54.9 54.9s-24.7 54.9-54.9 54.9z m-631.6-83.1c-15.5 0-28.2 12.6-28.2 28.2s12.6 28.2 28.2 28.2H826c15.5 0 28.2-12.6 28.2-28.2 0-15.5-12.6-28.2-28.2-28.2H194.4z' fill='%23111111'%3E%3C/path%3E%3Cpath d='M354.6 430.3v369.6' fill='%23FAFCFB'%3E%3C/path%3E%3Cpath d='M354.6 813.3c-7.4 0-13.4-6-13.4-13.4V430.3c0-7.4 6-13.4 13.4-13.4s13.4 6 13.4 13.4v369.6c-0.1 7.4-6 13.4-13.4 13.4z' fill='%230F0F0F'%3E%3C/path%3E%3Cpath d='M458.3 430.3v369.6' fill='%23FAFCFB'%3E%3C/path%3E%3Cpath d='M458.3 813.3c-7.4 0-13.4-6-13.4-13.4V430.3c0-7.4 6-13.4 13.4-13.4s13.4 6 13.4 13.4v369.6c0 7.4-6 13.4-13.4 13.4z' fill='%230F0F0F'%3E%3C/path%3E%3Cpath d='M562.1 430.3v369.6' fill='%23FAFCFB'%3E%3C/path%3E%3Cpath d='M562.1 813.3c-7.4 0-13.4-6-13.4-13.4V430.3c0-7.4 6-13.4 13.4-13.4s13.4 6 13.4 13.4v369.6c-0.1 7.4-6.1 13.4-13.4 13.4z' fill='%230F0F0F'%3E%3C/path%3E%3Cpath d='M665.8 430.3v369.6' fill='%23FAFCFB'%3E%3C/path%3E%3Cpath d='M665.8 813.3c-7.4 0-13.4-6-13.4-13.4V430.3c0-7.4 6-13.4 13.4-13.4s13.4 6 13.4 13.4v369.6c0 7.4-6 13.4-13.4 13.4z' fill='%230F0F0F'%3E%3C/path%3E%3C/g%3E%3C/svg%3E",iv=document.createElement("img");iv.src=lv;function dv(uv){return function(wv,Uv,_v,iy,Sy){var Sv=this.cornerSize;wv.save(),wv.translate(Uv,_v),wv.rotate(fabric.fabric.util.degreesToRadians(Sy.angle)),wv.drawImage(uv,-Sv/2,-Sv/2,Sv,Sv),wv.restore()}}return fabric.fabric.Object.prototype.controls.removeBg=new fabric.fabric.Control({x:-.48,y:-.41,offsetY:16,cursorStyle:"pointer",mouseUpHandler:cv,render:dv(O1),cornerSize:60}),fabric.fabric.Object.prototype.controls.crop=new fabric.fabric.Control({x:-.48,y:-.48,offsetY:16,cursorStyle:"pointer",mouseUpHandler:c0,render:dv(d1),cornerSize:60}),fabric.fabric.Object.prototype.controls.delete=new fabric.fabric.Control({x:.5,y:-.48,offsetY:16,cursorStyle:"pointer",mouseUpHandler:ev,render:dv(iv),cornerSize:60}),d.current.on("mouse:up",uv=>{isMidClick(uv)&&O0(!1)}),d.current.on("mouse:down",uv=>{isMidClick(uv)&&O0(!0)}),d.current.on("path:created",()=>{console.log("paht created"),t1()}),()=>{var uv;(uv=d.current)==null||uv.dispose(),d.current=null}},[]),reactExports.useEffect(()=>{if(!Sn||!d.current)return;const[T0,c1]=R0();(T0!==Tt||c1!==Ct)&&$t(T0,c1),d.current.setWidth(T0+DELTA_FRAME),d.current.setHeight(c1+DELTA_FRAME);const O1=new fabric.fabric.Image(Ro,{left:0,top:0});d.current.add(O1),d.current.renderAll()},[Ro,Sn]),reactExports.useEffect(()=>{if(!d.current)return;const T0=No[No.length-1],c1=new fabric.fabric.Image(T0,{left:0,top:0});d.current.clear(),d.current.add(c1),t1(),d.current.renderAll()},[No]),reactExports.useEffect(()=>{if(!d.current||Kr.length===0)return;const T0=JSON.parse(Kr[Kr.length-1]);d.current.loadFromJSON(T0,d.current.renderAll.bind(d.current))},[Kr]),reactExports.useEffect(()=>{d.current&&(d.current.freeDrawingBrush.width=t0)},[t0]),reactExports.useCallback(async()=>{let T0=g;if(No.length>0){const c1=No[No.length-1];T0=await srcToFile(c1.currentSrc,g.name,g.type)}return T0},[g,No]);const P0=()=>No.length!==0,R0=reactExports.useCallback(()=>{let T0=512,c1=512;return Sn?(No.length===0?(T0=Ro.naturalWidth,c1=Ro.naturalHeight):No.length!==0&&(T0=No[No.length-1].width,c1=No[No.length-1].height),[T0,c1]):[T0,c1]},[Ro,Sn,No]);reactExports.useEffect(()=>{var lv;if(!Sn)return;const[T0,c1]=R0();(T0!==Tt||c1!==Ct)&&$t(T0,c1);const O1=at.width/T0,T1=(at.height-TOOLBAR_HEIGHT)/c1;let d1=1;(O1<1||T1<1)&&(d1=Math.min(O1,T1)),r0(d1),v0(d1),console.log(`[on file load] image size: ${T0}x${c1}, scale: ${d1}, initialCentered: ${g0}`),g0&&t1(),Tn!=null&&Tn.canvas&&(console.log("[on file load] set canvas size"),T0!=Tn.canvas.width&&(Tn.canvas.width=T0),c1!=Tn.canvas.height&&(Tn.canvas.height=c1)),g0||((lv=A0.current)==null||lv.centerView(d1,1),console.log("[on file load] centerView"),E0(!0))},[A0,Ct,Tt,Ro,Sn,at,g0,R0]),reactExports.useEffect(()=>{var T0;console.log("[useEffect] centerView"),(T0=A0==null?void 0:A0.current)==null||T0.centerView(w0,1)},[Ct,Tt,A0,w0]);const B0=reactExports.useCallback(()=>{if(!w0||!at)return;const T0=A0.current;if(!T0)return;const c1=(at.width-Tt*w0)/2,O1=(at.height-Ct*w0)/2;T0.setTransform(c1,O1,w0,200,"easeOutQuad"),T0.instance.transformState.scale&&(T0.instance.transformState.scale=w0),v0(w0),N0(!1)},[A0,at,Ct,Tt,at.height,w0]);reactExports.useEffect(()=>(window.addEventListener("resize",()=>{B0()}),()=>{window.removeEventListener("resize",()=>{B0()})}),[at,B0]),useHotKey("Escape",()=>{jr||(F0?K0(!1):B0())},[F0,vt,B0]);const s1=()=>{Kt()};useHotKey("meta+z,ctrl+z",s1);const E1=T0=>{T0.preventDefault(),rr()};useHotKey("shift+ctrl+z,shift+meta+z",E1),useKeyPressEvent("Tab",T0=>{T0==null||T0.preventDefault(),T0==null||T0.stopPropagation(),P0()&&Zr(()=>(window.setTimeout(()=>{n1(100)},10),!0))},T0=>{T0==null||T0.preventDefault(),T0==null||T0.stopPropagation(),P0()&&(window.setTimeout(()=>{n1(0)},10),window.setTimeout(()=>{Zr(!1)},COMPARE_SLIDER_DURATION_MS))});const Q1=(T0,c1,O1)=>{T0.getObjects().forEach(d1=>d1.set({visible:!1})),c1.forEach(d1=>d1.set({visible:!0})),T0.renderAll();const T1=document.createElement("a");T1.href=T0.toDataURL({format:"png"}),T1.download=O1,T1.click(),T0.getObjects().forEach(d1=>d1.set({visible:!0})),T0.renderAll()},K1=()=>{const T0=d.current;if(T0){const c1=T0.getObjects().filter(O1=>O1.type==="image");Q1(T0,c1,"image.png")}};useHotKey("meta+s,ctrl+s",K1),reactExports.useCallback(()=>{if(jr)return"default";if(b0)return"grab";if(u0)return"none"},[u0,b0,jr]),useHotKey("[",()=>{Xo()},[Xo]),useHotKey("]",()=>{zo()},[zo]),useHotKey("ctrl+c,meta+c",async()=>{await askWritePermission()&&No.length>0&&Tn!=null&&Tn.canvas&&(await copyCanvasImage(Tn==null?void 0:Tn.canvas),et({title:"Copy inpainting result to clipboard"}))},[No,Tn]),useKeyPressEvent(" ",T0=>{st||(T0==null||T0.preventDefault(),T0==null||T0.stopPropagation(),d0(!1),O0(!0))},T0=>{st||(T0==null||T0.preventDefault(),T0==null||T0.stopPropagation(),d0(!0),O0(!1))}),useKeyPressEvent("Alt",T0=>{st||(T0==null||T0.preventDefault(),T0==null||T0.stopPropagation(),u1(!0))},T0=>{st||(T0==null||T0.preventDefault(),T0==null||T0.stopPropagation(),u1(!1))});const W1=()=>{var c1,O1,T1,d1;let T0=w0;return((O1=(c1=A0.current)==null?void 0:c1.instance)==null?void 0:O1.transformState.scale)!==void 0&&(T0=(d1=(T1=A0.current)==null?void 0:T1.instance)==null?void 0:d1.transformState.scale),T0},nv=(T0,c1)=>{const O1=W1();return{width:`${Uo*O1}px`,height:`${Uo*O1}px`,left:`${T0}px`,top:`${c1}px`,transform:"translate(-50%, -50%)"}},Nv=T0=>jsxRuntimeExports.jsx("div",{className:"absolute rounded-[50%] border-[1px] border-[solid] border-[#ffcc00] pointer-events-none bg-[#ffcc00bb]",style:T0}),pv=T0=>{Lt(T0),f0||(y0(!0),window.setTimeout(()=>{y0(!1)},1e4))},j0=()=>jsxRuntimeExports.jsx("div",{className:"absolute h-[20px] w-[20px] pointer-events-none rounded-[50%] bg-[rgba(21,_215,_121,_0.936)] [box-shadow:0_0_0_0_rgba(21,_215,_121,_0.936)] animate-pulse",style:{left:`${Go}px`,top:`${An}px`,transform:"translate(-50%, -50%)"},children:jsxRuntimeExports.jsx(ForwardRef,{})}),N1=()=>jsxRuntimeExports.jsx(TransformWrapper,{ref:T0=>{T0&&(A0.current=T0)},panning:{disabled:!b0,velocityDisabled:!0},wheel:{step:.05,wheelDisabled:x1},centerZoomedOut:!0,alignmentAnimation:{disabled:!0},centerOnInit:!0,limitToBounds:!1,doubleClick:{disabled:!0},initialScale:w0,minScale:w0*.3,onPanning:()=>{k0||N0(!0)},onZoom:T0=>{v0(T0.state.scale)},children:jsxRuntimeExports.jsxs(TransformComponent,{contentStyle:{visibility:g0?"visible":"hidden"},children:[jsxRuntimeExports.jsxs("div",{className:"relative",children:[jsxRuntimeExports.jsx("canvas",{className:cn$1(jr?"pointer-events-none animate-pulse duration-600":""),ref:P1,style:{clipPath:`inset(0 ${l1}% 0 0)`,transition:`clip-path ${COMPARE_SLIDER_DURATION_MS}ms`,border:"1px solid white"}}),jsxRuntimeExports.jsx("div",{className:"pointer-events-none absolute top-0",style:{width:`${Tt}px`,height:`${Ct}px`},children:e0&&jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx("div",{className:"absolute top-0 z-10 bg-primary h-full w-[6px] justify-self-end",style:{marginRight:`${l1}%`,transition:`margin-right ${COMPARE_SLIDER_DURATION_MS}ms`}}),jsxRuntimeExports.jsx("img",{className:"absolute ",src:Ro.src,alt:"original",style:{width:`${Tt}px`,height:`${Ct}px`}})]})})]}),jsxRuntimeExports.jsx(Cropper,{maxHeight:Ct,maxWidth:Tt,minHeight:Math.min(512,Ct),minWidth:Math.min(512,Tt),scale:W1(),show:pt.showCropper}),jsxRuntimeExports.jsx(Extender,{minHeight:Math.min(512,Ct),minWidth:Math.min(512,Tt),scale:W1(),show:pt.showExtender}),jt.isInteractiveSeg?jsxRuntimeExports.jsx(InteractiveSegPoints,{}):jsxRuntimeExports.jsx(jsxRuntimeExports.Fragment,{})]})});return jsxRuntimeExports.jsxs("div",{className:"flex w-screen h-screen justify-center items-center","aria-hidden":"true",children:[N1(),u0&&!vt&&!b0&&(jt.isInteractiveSeg?j0():Nv(nv(Go,An))),f0&&Nv(nv(p0,$0)),jsxRuntimeExports.jsxs("div",{className:"fixed flex bottom-5 border px-4 py-2 rounded-[3rem] gap-8 items-center justify-center backdrop-filter backdrop-blur-md bg-background/70",children:[jsxRuntimeExports.jsx(Slider,{className:"w-48",defaultValue:[50],min:MIN_BRUSH_SIZE,max:MAX_BRUSH_SIZE,step:1,tabIndex:-1,value:[t0],onValueChange:T0=>pv(T0[0]),onClick:()=>y0(!1)}),jsxRuntimeExports.jsxs("div",{className:"flex gap-2",children:[jsxRuntimeExports.jsx(IconButton,{tooltip:"Reset zoom & pan",disabled:C0===w0&&k0===!1,onClick:B0,children:jsxRuntimeExports.jsx(Expand,{})}),jsxRuntimeExports.jsx(IconButton,{tooltip:"Undo",onClick:s1,disabled:ir,children:jsxRuntimeExports.jsx(Undo,{})}),jsxRuntimeExports.jsx(IconButton,{tooltip:"Redo",onClick:E1,disabled:or,children:jsxRuntimeExports.jsx(Redo,{})}),jsxRuntimeExports.jsx(IconButton,{tooltip:"Show original image",onPointerDown:T0=>{T0.preventDefault(),Zr(()=>(window.setTimeout(()=>{n1(100)},10),!0))},onPointerUp:()=>{window.setTimeout(()=>{n1(0)},10),window.setTimeout(()=>{Zr(!1)},COMPARE_SLIDER_DURATION_MS)},disabled:No.length===0,children:jsxRuntimeExports.jsx(Eye,{})}),jsxRuntimeExports.jsx(IconButton,{tooltip:"Save Image",onClick:K1,children:jsxRuntimeExports.jsx(Download,{})}),jsxRuntimeExports.jsx(IconButton,{tooltip:"Run Inpainting",disabled:jr||!X1()&&_n.length===0,onClick:()=>{vn("lama")},children:jsxRuntimeExports.jsx(Eraser,{})}),jsxRuntimeExports.jsx(IconButton,{tooltip:"CUT IMAGE",onClick:()=>{S1()},children:jsxRuntimeExports.jsx(Eraser,{})})]})]})]})}),Sheet=$5d3850c4d0b4e6c7$export$be92b6f5f03c0fe9,SheetTrigger=$5d3850c4d0b4e6c7$export$41fb9f06171c75f4,SheetPortal=$5d3850c4d0b4e6c7$export$602eac185826482c,SheetOverlay=reactExports.forwardRef(({className:d,...g},b)=>jsxRuntimeExports.jsx($5d3850c4d0b4e6c7$export$c6fdb837b070b4ff,{className:cn$1("fixed inset-0 bg-background/80 backdrop-blur-sm data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",d),...g,ref:b}));SheetOverlay.displayName=$5d3850c4d0b4e6c7$export$c6fdb837b070b4ff.displayName;const sheetVariants=cva("fixed gap-4 bg-background p-6 shadow-lg transition ease-in-out data-[state=closed]:duration-200 data-[state=open]:duration-300",{variants:{side:{top:"inset-x-0 top-0 border-b data-[state=closed]:slide-out-to-top data-[state=open]:slide-in-from-top",bottom:"inset-x-0 bottom-0 border-t data-[state=closed]:slide-out-to-bottom data-[state=open]:slide-in-from-bottom",left:"inset-y-0 left-0 h-full w-3/4 border-r data-[state=closed]:slide-out-to-left data-[state=open]:slide-in-from-left sm:max-w-sm",right:"inset-y-0 right-0 h-full w-3/4 border-l data-[state=closed]:slide-out-to-right data-[state=open]:slide-in-from-right sm:max-w-sm"}},defaultVariants:{side:"right"}}),SheetContent=reactExports.forwardRef(({side:d="right",className:g,children:b,...et},st)=>jsxRuntimeExports.jsxs(SheetPortal,{children:[jsxRuntimeExports.jsx(SheetOverlay,{}),jsxRuntimeExports.jsx($5d3850c4d0b4e6c7$export$7c6e2c02157bb7d2,{ref:st,className:cn$1(sheetVariants({side:d}),g),...et,children:b})]}));SheetContent.displayName=$5d3850c4d0b4e6c7$export$7c6e2c02157bb7d2.displayName;const SheetHeader=({className:d,...g})=>jsxRuntimeExports.jsx("div",{className:cn$1("flex flex-col space-y-2 text-center sm:text-left",d),...g});SheetHeader.displayName="SheetHeader";const SheetTitle=reactExports.forwardRef(({className:d,...g},b)=>jsxRuntimeExports.jsx($5d3850c4d0b4e6c7$export$f99233281efd08a0,{ref:b,className:cn$1("text-lg font-semibold text-foreground",d),...g}));SheetTitle.displayName=$5d3850c4d0b4e6c7$export$f99233281efd08a0.displayName;const SheetDescription=reactExports.forwardRef(({className:d,...g},b)=>jsxRuntimeExports.jsx($5d3850c4d0b4e6c7$export$393edc798c47379d,{ref:b,className:cn$1("text-sm text-muted-foreground",d),...g}));SheetDescription.displayName=$5d3850c4d0b4e6c7$export$393edc798c47379d.displayName;const RowContainer$1=({children:d})=>jsxRuntimeExports.jsx("div",{className:"flex justify-between items-center pr-2",children:d}),LabelTitle$1=({text:d,toolTip:g="",url:b,htmlFor:et,disabled:st=!1})=>jsxRuntimeExports.jsxs(Tooltip,{children:[jsxRuntimeExports.jsx(TooltipTrigger,{asChild:!0,children:jsxRuntimeExports.jsx(Label,{htmlFor:et||d.toLowerCase().replace(" ","-"),className:"font-medium",disabled:st,children:d})}),g||b?jsxRuntimeExports.jsxs(TooltipContent,{className:"flex flex-col max-w-xs text-sm",side:"left",children:[jsxRuntimeExports.jsx("p",{children:g}),b?jsxRuntimeExports.jsx(Button,{variant:"link",className:"justify-end",children:jsxRuntimeExports.jsx("a",{href:b,target:"_blank",children:"More info"})}):jsxRuntimeExports.jsx(jsxRuntimeExports.Fragment,{})]}):jsxRuntimeExports.jsx(jsxRuntimeExports.Fragment,{})]}),LDMOptions=()=>{const[d,g]=useStore(b=>[b.settings,b.updateSettings]);return jsxRuntimeExports.jsxs("div",{className:"flex flex-col gap-4 mt-4",children:[jsxRuntimeExports.jsxs("div",{className:"flex flex-col gap-1",children:[jsxRuntimeExports.jsx(LabelTitle$1,{htmlFor:"steps",text:"Steps",toolTip:"The number of denoising steps. More denoising steps usually lead to a higher quality image at the expense of slower inference."}),jsxRuntimeExports.jsxs(RowContainer$1,{children:[jsxRuntimeExports.jsx(Slider,{className:"w-[180px]",defaultValue:[30],min:1,max:100,step:1,value:[Math.floor(d.ldmSteps)],onValueChange:b=>g({ldmSteps:b[0]})}),jsxRuntimeExports.jsx(NumberInput,{id:"steps",className:"w-[60px] rounded-full",numberValue:d.ldmSteps,allowFloat:!1,onNumberValueChange:b=>{g({ldmSteps:b})}})]})]}),jsxRuntimeExports.jsxs(RowContainer$1,{children:[jsxRuntimeExports.jsx(LabelTitle$1,{text:"Sampler"}),jsxRuntimeExports.jsxs(Select,{value:d.ldmSampler,onValueChange:b=>{g({ldmSampler:b})},children:[jsxRuntimeExports.jsx(SelectTrigger,{className:"w-[100px]",children:jsxRuntimeExports.jsx(SelectValue,{placeholder:"Select sampler"})}),jsxRuntimeExports.jsx(SelectContent,{align:"end",children:jsxRuntimeExports.jsx(SelectGroup,{children:Object.values(LDMSampler).map(b=>jsxRuntimeExports.jsx(SelectItem,{value:b,children:b},b))})})]})]})]})},ExtenderButton=({text:d,onClick:g})=>{const[b]=useStore(et=>[et.settings.showExtender]);return jsxRuntimeExports.jsx(Button,{variant:"outline",className:"p-1 h-8",disabled:!b,onClick:g,children:jsxRuntimeExports.jsx("div",{className:"flex items-center gap-1",children:d})})},DiffusionOptions=()=>{const[d,g,b,et,st,at,vt,Tt,Ct,pt,wt]=useStore(Kr=>[Kr.serverConfig.samplers,Kr.settings,Kr.paintByExampleFile,Kr.getIsProcessing(),Kr.updateSettings,Kr.runInpainting,Kr.updateAppState,Kr.updateExtenderByBuiltIn,Kr.updateExtenderDirection,Kr.adjustMask,Kr.clearMask]),[$t,Lt]=useImage(b),jt=reactExports.useRef(null),{t:Ft}=useTranslation();useClickAway(jt,()=>{jt!=null&&jt.current&&jt.current.blur()});const Gt=Kr=>{Kr.key==="Enter"&&Kr.ctrlKey&&g.prompt.length!==0&&at()},Ht=()=>jsxRuntimeExports.jsxs(RowContainer$1,{children:[jsxRuntimeExports.jsx(LabelTitle$1,{text:Ft("Cropper"),toolTip:"Inpainting on part of image, improve inference speed and reduce memory usage."}),jsxRuntimeExports.jsx(Switch,{id:"cropper",checked:g.showCropper,onCheckedChange:Kr=>{st({showCropper:Kr}),Kr&&st({showExtender:!1})}})]}),qt=()=>g.model.support_controlnet?jsxRuntimeExports.jsxs("div",{className:"flex flex-col gap-4",children:[jsxRuntimeExports.jsxs("div",{className:"flex flex-col gap-4",children:[jsxRuntimeExports.jsxs("div",{className:"flex justify-between items-center pr-2",children:[jsxRuntimeExports.jsx(LabelTitle$1,{text:"ControlNet",toolTip:"Using an additional conditioning image to control how an image is generated",url:"https://huggingface.co/docs/diffusers/main/en/using-diffusers/inpaint#controlnet"}),jsxRuntimeExports.jsx(Switch,{id:"controlnet",checked:g.enableControlnet,onCheckedChange:Kr=>{st({enableControlnet:Kr})}})]}),jsxRuntimeExports.jsx("div",{className:"flex flex-col gap-1",children:jsxRuntimeExports.jsxs(RowContainer$1,{children:[jsxRuntimeExports.jsx(Slider,{className:"w-[180px]",defaultValue:[100],min:1,max:100,step:1,disabled:!g.enableControlnet,value:[Math.floor(g.controlnetConditioningScale*100)],onValueChange:Kr=>st({controlnetConditioningScale:Kr[0]/100})}),jsxRuntimeExports.jsx(NumberInput,{id:"controlnet-weight",className:"w-[60px] rounded-full",disabled:!g.enableControlnet,numberValue:g.controlnetConditioningScale,allowFloat:!1,onNumberValueChange:Kr=>{st({controlnetConditioningScale:Kr})}})]})}),jsxRuntimeExports.jsx("div",{className:"pr-2",children:jsxRuntimeExports.jsxs(Select,{defaultValue:g.controlnetMethod,value:g.controlnetMethod,onValueChange:Kr=>{st({controlnetMethod:Kr})},disabled:!g.enableControlnet,children:[jsxRuntimeExports.jsx(SelectTrigger,{children:jsxRuntimeExports.jsx(SelectValue,{placeholder:"Select control method"})}),jsxRuntimeExports.jsx(SelectContent,{align:"end",children:jsxRuntimeExports.jsx(SelectGroup,{children:Object.values(g.model.controlnets).map(Kr=>jsxRuntimeExports.jsx(SelectItem,{value:Kr,children:Kr.split("/")[1]},Kr))})})]})})]}),jsxRuntimeExports.jsx(Separator,{})]}):null,Kt=()=>g.model.support_lcm_lora?jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsxs(RowContainer$1,{children:[jsxRuntimeExports.jsx(LabelTitle$1,{text:"LCM LoRA",url:"https://huggingface.co/docs/diffusers/main/en/using-diffusers/inference_with_lcm_lora",toolTip:"Enable quality image generation in typically 2-4 steps. Suggest disabling guidance_scale by setting it to 0. You can also try values between 1.0 and 2.0. When LCM Lora is enabled, LCMSampler will be used automatically."}),jsxRuntimeExports.jsx(Switch,{id:"lcm-lora",checked:g.enableLCMLora,onCheckedChange:Kr=>{st({enableLCMLora:Kr})}})]}),jsxRuntimeExports.jsx(Separator,{})]}):null,rr=()=>g.model.support_freeu?jsxRuntimeExports.jsxs("div",{className:"flex flex-col gap-4",children:[jsxRuntimeExports.jsxs("div",{className:"flex justify-between items-center pr-2",children:[jsxRuntimeExports.jsx(LabelTitle$1,{text:"FreeU",toolTip:"FreeU is a technique for improving image quality. Different models may require different FreeU-specific hyperparameters, which can be viewed in the more info section.",url:"https://huggingface.co/docs/diffusers/main/en/using-diffusers/freeu"}),jsxRuntimeExports.jsx(Switch,{id:"freeu",checked:g.enableFreeu,onCheckedChange:Kr=>{st({enableFreeu:Kr})}})]}),jsxRuntimeExports.jsxs("div",{className:"flex flex-col gap-4",children:[jsxRuntimeExports.jsxs("div",{className:"flex justify-center gap-6",children:[jsxRuntimeExports.jsxs("div",{className:"flex gap-2 items-center justify-center",children:[jsxRuntimeExports.jsx(LabelTitle$1,{htmlFor:"freeu-s1",text:"s1",disabled:!g.enableFreeu}),jsxRuntimeExports.jsx(NumberInput,{id:"freeu-s1",className:"w-14",disabled:!g.enableFreeu,numberValue:g.freeuConfig.s1,allowFloat:!0,onNumberValueChange:Kr=>{st({freeuConfig:{...g.freeuConfig,s1:Kr}})}})]}),jsxRuntimeExports.jsxs("div",{className:"flex gap-2 items-center justify-center",children:[jsxRuntimeExports.jsx(LabelTitle$1,{htmlFor:"freeu-s2",text:"s2",disabled:!g.enableFreeu}),jsxRuntimeExports.jsx(NumberInput,{id:"freeu-s2",className:"w-14",disabled:!g.enableFreeu,numberValue:g.freeuConfig.s2,allowFloat:!0,onNumberValueChange:Kr=>{st({freeuConfig:{...g.freeuConfig,s2:Kr}})}})]})]}),jsxRuntimeExports.jsxs("div",{className:"flex justify-center gap-6",children:[jsxRuntimeExports.jsxs("div",{className:"flex gap-2 items-center justify-center",children:[jsxRuntimeExports.jsx(LabelTitle$1,{htmlFor:"freeu-b1",text:"b1",disabled:!g.enableFreeu}),jsxRuntimeExports.jsx(NumberInput,{id:"freeu-b1",className:"w-14",disabled:!g.enableFreeu,numberValue:g.freeuConfig.b1,allowFloat:!0,onNumberValueChange:Kr=>{st({freeuConfig:{...g.freeuConfig,b1:Kr}})}})]}),jsxRuntimeExports.jsxs("div",{className:"flex gap-2 items-center justify-center",children:[jsxRuntimeExports.jsx(LabelTitle$1,{htmlFor:"freeu-b2",text:"b2",disabled:!g.enableFreeu}),jsxRuntimeExports.jsx(NumberInput,{id:"freeu-b2",className:"w-14",disabled:!g.enableFreeu,numberValue:g.freeuConfig.b2,allowFloat:!0,onNumberValueChange:Kr=>{st({freeuConfig:{...g.freeuConfig,b2:Kr}})}})]})]})]}),jsxRuntimeExports.jsx(Separator,{})]}):null,ir=()=>g.model.need_prompt?jsxRuntimeExports.jsxs("div",{className:"flex flex-col gap-4",children:[jsxRuntimeExports.jsx(LabelTitle$1,{text:"Negative prompt",url:"https://huggingface.co/docs/diffusers/main/en/using-diffusers/inpaint#negative-prompt",toolTip:"Negative prompt guides the model away from generating certain things in an image"}),jsxRuntimeExports.jsx("div",{className:"pl-2 pr-4",children:jsxRuntimeExports.jsx(Textarea,{ref:jt,rows:4,onKeyUp:Gt,className:"max-h-[8rem] overflow-y-auto mb-2",placeholder:"",id:"negative-prompt",value:g.negativePrompt,onInput:Kr=>{Kr.preventDefault(),Kr.stopPropagation();const e0=Kr.target;st({negativePrompt:e0.value})}})})]}):null,or=()=>g.model.name!==PAINT_BY_EXAMPLE?null:jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsxs(RowContainer$1,{children:[jsxRuntimeExports.jsx(LabelTitle$1,{text:"Example Image",toolTip:"An example image to guide image generation."}),jsxRuntimeExports.jsx(ImageUploadButton,{tooltip:"Upload example image",onFileUpload:Kr=>{vt({paintByExampleFile:Kr})},children:jsxRuntimeExports.jsx(Upload,{})})]}),Lt?jsxRuntimeExports.jsx("div",{className:"flex justify-center items-center",children:jsxRuntimeExports.jsx("img",{src:$t.src,alt:"example",className:"max-w-[200px] max-h-[200px] m-3"})}):jsxRuntimeExports.jsx(jsxRuntimeExports.Fragment,{}),jsxRuntimeExports.jsx(Button,{variant:"default",className:"w-full",disabled:et||!Lt,onClick:()=>{at("Fantasy-Studio/Paint-by-Example")},children:"Paint"})]}),jr=()=>g.model.name!==INSTRUCT_PIX2PIX?null:jsxRuntimeExports.jsxs("div",{className:"flex flex-col gap-1",children:[jsxRuntimeExports.jsx(LabelTitle$1,{text:"Image guidance scale",toolTip:"Push the generated image towards the inital image. Higher image guidance scale encourages generated images that are closely linked to the source image, usually at the expense of lower image quality.",url:"https://huggingface.co/docs/diffusers/main/en/api/pipelines/pix2pix"}),jsxRuntimeExports.jsxs(RowContainer$1,{children:[jsxRuntimeExports.jsx(Slider,{className:"w-[180px]",defaultValue:[150],min:100,max:1e3,step:1,value:[Math.floor(g.p2pImageGuidanceScale*100)],onValueChange:Kr=>st({p2pImageGuidanceScale:Kr[0]/100})}),jsxRuntimeExports.jsx(NumberInput,{id:"image-guidance-scale",className:"w-[60px] rounded-full",numberValue:g.p2pImageGuidanceScale,allowFloat:!0,onNumberValueChange:Kr=>{st({p2pImageGuidanceScale:Kr})}})]})]}),qr=()=>g.model.support_strength?jsxRuntimeExports.jsxs("div",{className:"flex flex-col gap-1",children:[jsxRuntimeExports.jsx(LabelTitle$1,{text:"Strength",url:"https://huggingface.co/docs/diffusers/main/en/using-diffusers/inpaint#strength",toolTip:"Strength is a measure of how much noise is added to the base image, which influences how similar the output is to the base image. Higher value means more noise and more different from the base image"}),jsxRuntimeExports.jsxs(RowContainer$1,{children:[jsxRuntimeExports.jsx(Slider,{className:"w-[180px]",defaultValue:[100],min:10,max:100,step:1,value:[Math.floor(g.sdStrength*100)],onValueChange:Kr=>st({sdStrength:Kr[0]/100})}),jsxRuntimeExports.jsx(NumberInput,{id:"strength",className:"w-[60px] rounded-full",numberValue:g.sdStrength,allowFloat:!0,onNumberValueChange:Kr=>{st({sdStrength:Kr})}})]})]}):null,Yr=()=>g.model.support_outpainting?jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsxs("div",{className:"flex flex-col gap-4",children:[jsxRuntimeExports.jsxs(RowContainer$1,{children:[jsxRuntimeExports.jsx(LabelTitle$1,{text:"Extender",toolTip:"Perform outpainting on images to expand it's content."}),jsxRuntimeExports.jsx(Switch,{id:"extender",checked:g.showExtender,onCheckedChange:Kr=>{st({showExtender:Kr}),Kr&&st({showCropper:!1})}})]}),jsxRuntimeExports.jsxs(RowContainer$1,{children:[jsxRuntimeExports.jsxs(Select,{defaultValue:g.extenderDirection,value:g.extenderDirection,onValueChange:Kr=>{Ct(Kr)},children:[jsxRuntimeExports.jsx(SelectTrigger,{className:"w-[65px] h-7",disabled:!g.showExtender,children:jsxRuntimeExports.jsx(SelectValue,{placeholder:"Select axis"})}),jsxRuntimeExports.jsx(SelectContent,{align:"end",children:jsxRuntimeExports.jsx(SelectGroup,{children:Object.values(ExtenderDirection).map(Kr=>jsxRuntimeExports.jsx(SelectItem,{value:Kr,children:Kr},Kr))})})]}),jsxRuntimeExports.jsxs("div",{className:"flex gap-1 justify-center mt-0",children:[jsxRuntimeExports.jsx(ExtenderButton,{text:"1.25x",onClick:()=>Tt(g.extenderDirection,1.25)}),jsxRuntimeExports.jsx(ExtenderButton,{text:"1.5x",onClick:()=>Tt(g.extenderDirection,1.5)}),jsxRuntimeExports.jsx(ExtenderButton,{text:"1.75x",onClick:()=>Tt(g.extenderDirection,1.75)}),jsxRuntimeExports.jsx(ExtenderButton,{text:"2.0x",onClick:()=>Tt(g.extenderDirection,2)})]})]})]}),jsxRuntimeExports.jsx(Separator,{})]}):null,vn=()=>g.model.name!==POWERPAINT?null:jsxRuntimeExports.jsxs(RowContainer$1,{children:[jsxRuntimeExports.jsx(LabelTitle$1,{text:"Task",toolTip:"PowerPaint task. When using extender, image-outpainting task will be auto used. For object-removal and image-outpainting, it is recommended to set the guidance_scale at 10 or above."}),jsxRuntimeExports.jsxs(Select,{defaultValue:g.powerpaintTask,value:g.powerpaintTask,onValueChange:Kr=>{st({powerpaintTask:Kr})},disabled:g.showExtender,children:[jsxRuntimeExports.jsx(SelectTrigger,{className:"w-[140px]",children:jsxRuntimeExports.jsx(SelectValue,{placeholder:"Select task"})}),jsxRuntimeExports.jsx(SelectContent,{align:"end",children:jsxRuntimeExports.jsx(SelectGroup,{children:[PowerPaintTask.text_guided,PowerPaintTask.object_remove,PowerPaintTask.shape_guided].map(Kr=>jsxRuntimeExports.jsx(SelectItem,{value:Kr,children:Kr},Kr))})})]})]}),ko=()=>jsxRuntimeExports.jsxs("div",{className:"flex flex-col gap-1",children:[jsxRuntimeExports.jsx(LabelTitle$1,{htmlFor:"steps",text:"Steps",toolTip:"The number of denoising steps. More denoising steps usually lead to a higher quality image at the expense of slower inference."}),jsxRuntimeExports.jsxs(RowContainer$1,{children:[jsxRuntimeExports.jsx(Slider,{className:"w-[180px]",defaultValue:[30],min:1,max:100,step:1,value:[Math.floor(g.sdSteps)],onValueChange:Kr=>st({sdSteps:Kr[0]})}),jsxRuntimeExports.jsx(NumberInput,{id:"steps",className:"w-[60px] rounded-full",numberValue:g.sdSteps,allowFloat:!1,onNumberValueChange:Kr=>{st({sdSteps:Kr})}})]})]}),Xo=()=>jsxRuntimeExports.jsxs("div",{className:"flex flex-col gap-1",children:[jsxRuntimeExports.jsx(LabelTitle$1,{text:"Guidance scale",url:"https://huggingface.co/docs/diffusers/main/en/using-diffusers/inpaint#guidance-scale",toolTip:"Guidance scale affects how aligned the text prompt and generated image are. Higher value means the prompt and generated image are closely aligned, so the output is a stricter interpretation of the prompt"}),jsxRuntimeExports.jsxs(RowContainer$1,{children:[jsxRuntimeExports.jsx(Slider,{className:"w-[180px]",defaultValue:[750],min:0,max:1500,step:1,value:[Math.floor(g.sdGuidanceScale*100)],onValueChange:Kr=>st({sdGuidanceScale:Kr[0]/100})}),jsxRuntimeExports.jsx(NumberInput,{id:"guidance-scale",className:"w-[60px] rounded-full",numberValue:g.sdGuidanceScale,allowFloat:!0,onNumberValueChange:Kr=>{st({sdGuidanceScale:Kr})}})]})]}),zo=()=>g.model.name===ANYTEXT?null:jsxRuntimeExports.jsxs(RowContainer$1,{children:[jsxRuntimeExports.jsx(LabelTitle$1,{text:"Sampler"}),jsxRuntimeExports.jsxs(Select,{defaultValue:g.sdSampler,value:g.sdSampler,onValueChange:Kr=>{st({sdSampler:Kr})},children:[jsxRuntimeExports.jsx(SelectTrigger,{className:"w-[175px] text-xs",children:jsxRuntimeExports.jsx(SelectValue,{placeholder:"Select sampler"})}),jsxRuntimeExports.jsx(SelectContent,{align:"end",children:jsxRuntimeExports.jsx(SelectGroup,{children:d.map(Kr=>jsxRuntimeExports.jsx(SelectItem,{value:Kr,className:"text-xs",children:Kr},Kr))})})]})]}),t0=()=>jsxRuntimeExports.jsxs(RowContainer$1,{children:[jsxRuntimeExports.jsx(LabelTitle$1,{text:"Seed",toolTip:"Using same parameters and a fixed seed can generate same result image."}),jsxRuntimeExports.jsxs("div",{className:"flex gap-2 justify-center items-center",children:[jsxRuntimeExports.jsx(Switch,{id:"seed",checked:g.seedFixed,onCheckedChange:Kr=>{st({seedFixed:Kr})}}),jsxRuntimeExports.jsx(NumberInput,{id:"seed",className:"w-[100px]",disabled:!g.seedFixed,numberValue:g.seed,allowFloat:!1,onNumberValueChange:Kr=>{st({seed:Kr})}})]})]}),Uo=()=>jsxRuntimeExports.jsxs("div",{className:"flex flex-col gap-1",children:[jsxRuntimeExports.jsx(LabelTitle$1,{text:"Mask blur",toolTip:"How much to blur the mask before processing, in pixels. Make the generated inpainting boundaries appear more natural."}),jsxRuntimeExports.jsxs(RowContainer$1,{children:[jsxRuntimeExports.jsx(Slider,{className:"w-[180px]",defaultValue:[g.sdMaskBlur],min:0,max:96,step:1,value:[Math.floor(g.sdMaskBlur)],onValueChange:Kr=>st({sdMaskBlur:Kr[0]})}),jsxRuntimeExports.jsx(NumberInput,{id:"mask-blur",className:"w-[60px] rounded-full",numberValue:g.sdMaskBlur,allowFloat:!1,onNumberValueChange:Kr=>{st({sdMaskBlur:Kr})}})]})]}),No=()=>jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsxs(RowContainer$1,{children:[jsxRuntimeExports.jsx(LabelTitle$1,{text:"Match histograms",toolTip:"Match the inpainting result histogram to the source image histogram",url:"https://github.com/Sanster/lama-cleaner/pull/143#issuecomment-1325859307"}),jsxRuntimeExports.jsx(Switch,{id:"match-histograms",checked:g.sdMatchHistograms,onCheckedChange:Kr=>{st({sdMatchHistograms:Kr})}})]}),jsxRuntimeExports.jsx(Separator,{})]}),_n=()=>jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsxs("div",{className:"flex flex-col gap-1",children:[jsxRuntimeExports.jsx(LabelTitle$1,{htmlFor:"adjustMaskKernelSize",text:Ft("Adjust Mask"),toolTip:"Expand or shrink mask. Using the slider to adjust the kernel size for dilation or erosion."}),jsxRuntimeExports.jsxs(RowContainer$1,{children:[jsxRuntimeExports.jsx(Slider,{className:"w-[180px]",defaultValue:[12],min:1,max:100,step:1,value:[Math.floor(g.adjustMaskKernelSize)],onValueChange:Kr=>st({adjustMaskKernelSize:Kr[0]})}),jsxRuntimeExports.jsx(NumberInput,{id:"adjustMaskKernelSize",className:"w-[60px] rounded-full",numberValue:g.adjustMaskKernelSize,allowFloat:!1,onNumberValueChange:Kr=>{st({adjustMaskKernelSize:Kr})}})]}),jsxRuntimeExports.jsxs(RowContainer$1,{children:[jsxRuntimeExports.jsxs("div",{className:"flex gap-1 justify-start",children:[jsxRuntimeExports.jsx(Button,{variant:"outline",className:"p-1 h-8",onClick:()=>pt("expand"),disabled:et,children:jsxRuntimeExports.jsx("div",{className:"flex items-center gap-1 select-none",children:Ft("Expand")})}),jsxRuntimeExports.jsx(Button,{variant:"outline",className:"p-1 h-8",onClick:()=>pt("shrink"),disabled:et,children:jsxRuntimeExports.jsx("div",{className:"flex items-center gap-1 select-none",children:Ft("Shrink")})}),jsxRuntimeExports.jsx(Button,{variant:"outline",className:"p-1 h-8",onClick:()=>pt("reverse"),disabled:et,children:jsxRuntimeExports.jsx("div",{className:"flex items-center gap-1 select-none",children:Ft("Reverse")})})]}),jsxRuntimeExports.jsx(Button,{variant:"outline",className:"p-1 h-8 justify-self-end",onClick:wt,disabled:et,children:jsxRuntimeExports.jsx("div",{className:"flex items-center gap-1 select-none",children:Ft("Clear")})})]})]}),jsxRuntimeExports.jsx(Separator,{})]});return jsxRuntimeExports.jsxs("div",{className:"flex flex-col gap-4 mt-4",children:[Ht(),Yr(),_n(),vn(),ko(),Xo(),jr(),qr(),zo(),t0(),ir(),jsxRuntimeExports.jsx(Separator,{}),qt(),Kt(),Uo(),No(),rr(),or()]})},CV2Options=()=>{const[d,g]=useStore(b=>[b.settings,b.updateSettings]);return jsxRuntimeExports.jsxs("div",{className:"flex flex-col gap-4 mt-4",children:[jsxRuntimeExports.jsxs(RowContainer$1,{children:[jsxRuntimeExports.jsx(LabelTitle$1,{text:"CV2 Flag",url:"https://docs.opencv.org/4.8.0/d7/d8b/group__photo__inpaint.html#gga8002a65f5a3328fbf15df81b842d3c3ca892824c38e258feb5e72f308a358d52e"}),jsxRuntimeExports.jsxs(Select,{value:d.cv2Flag,onValueChange:b=>{g({cv2Flag:b})},children:[jsxRuntimeExports.jsx(SelectTrigger,{className:"w-[160px]",children:jsxRuntimeExports.jsx(SelectValue,{placeholder:"Select flag"})}),jsxRuntimeExports.jsx(SelectContent,{align:"end",children:jsxRuntimeExports.jsx(SelectGroup,{children:Object.values(CV2Flag).map(b=>jsxRuntimeExports.jsx(SelectItem,{value:b,children:b},b))})})]})]}),jsxRuntimeExports.jsx(LabelTitle$1,{text:"CV2 Radius",url:"https://docs.opencv.org/4.8.0/d7/d8b/group__photo__inpaint.html#gga8002a65f5a3328fbf15df81b842d3c3ca892824c38e258feb5e72f308a358d52e"}),jsxRuntimeExports.jsxs(RowContainer$1,{children:[jsxRuntimeExports.jsx(Slider,{className:"w-[180px]",defaultValue:[5],min:1,max:100,step:1,value:[Math.floor(d.cv2Radius)],onValueChange:b=>g({cv2Radius:b[0]})}),jsxRuntimeExports.jsx(NumberInput,{id:"cv2-radius",className:"w-[60px] rounded-full",numberValue:d.cv2Radius,allowFloat:!1,onNumberValueChange:b=>{g({cv2Radius:b})}})]})]})},RightSidePanel=()=>{const[d,g]=useStore(at=>[at.settings,at.windowSize]),[b,et]=useToggle(!0);if(useHotKey("c",()=>{et()}),d.model.name!==LDM&&d.model.name!==CV2&&d.model.model_type===MODEL_TYPE_INPAINT)return null;const st=()=>d.model.name===LDM?jsxRuntimeExports.jsx(LDMOptions,{}):d.model.name===CV2?jsxRuntimeExports.jsx(CV2Options,{}):jsxRuntimeExports.jsx(DiffusionOptions,{});return jsxRuntimeExports.jsxs(Sheet,{open:b,modal:!1,children:[jsxRuntimeExports.jsx(SheetTrigger,{tabIndex:-1,className:"z-10 outline-none absolute top-[68px] right-6 rounded-lg border bg-background",hidden:b,children:jsxRuntimeExports.jsx(Button,{variant:"ghost",size:"icon",asChild:!0,className:"p-1.5",onClick:et,children:jsxRuntimeExports.jsx(ChevronLeft,{strokeWidth:1})})}),jsxRuntimeExports.jsxs(SheetContent,{side:"right",className:"w-[300px] mt-[60px] outline-none pl-4 pr-1",onOpenAutoFocus:at=>at.preventDefault(),onPointerDownOutside:at=>at.preventDefault(),children:[jsxRuntimeExports.jsxs(SheetHeader,{children:[jsxRuntimeExports.jsxs(RowContainer$1,{children:[jsxRuntimeExports.jsx("div",{className:"overflow-hidden mr-8",children:d.model.name.split("/")[d.model.name.split("/").length-1]}),jsxRuntimeExports.jsx(Button,{variant:"ghost",size:"icon",className:"border h-6 w-6",onClick:et,children:jsxRuntimeExports.jsx(ChevronRight,{strokeWidth:1})})]}),jsxRuntimeExports.jsx(Separator,{})]}),jsxRuntimeExports.jsx(ScrollArea,{style:{height:g.height-160},className:"pr-3",children:st()})]})]})},RowContainer=({children:d})=>jsxRuntimeExports.jsx("div",{className:"flex justify-between items-center pr-2",children:d}),LabelTitle=({text:d,toolTip:g="",url:b,htmlFor:et,disabled:st=!1})=>jsxRuntimeExports.jsxs(Tooltip,{children:[jsxRuntimeExports.jsx(TooltipTrigger,{asChild:!0,children:jsxRuntimeExports.jsx(Label,{htmlFor:et||d.toLowerCase().replace(" ","-"),className:"font-medium",disabled:st,children:d})}),g||b?jsxRuntimeExports.jsxs(TooltipContent,{className:"flex flex-col max-w-xs text-sm",side:"left",children:[jsxRuntimeExports.jsx("p",{children:g}),b?jsxRuntimeExports.jsx(Button,{variant:"link",className:"justify-end",children:jsxRuntimeExports.jsx("a",{href:b,target:"_blank",children:"More info"})}):jsxRuntimeExports.jsx(jsxRuntimeExports.Fragment,{})]}):jsxRuntimeExports.jsx(jsxRuntimeExports.Fragment,{})]}),CanvasOptions=({fabricRef:d})=>{const[g,b,et,st,at,vt,Tt,Ct,pt,wt,$t]=useStore(ir=>[ir.serverConfig.samplers,ir.settings,ir.paintByExampleFile,ir.getIsProcessing(),ir.updateSettings,ir.runInpainting,ir.updateAppState,ir.updateExtenderByBuiltIn,ir.updateExtenderDirection,ir.adjustMask,ir.clearMask]),[Lt,jt]=useImage(et),{t:Ft}=useTranslation(),Gt=ir=>{console.log(ir);const or=d.current;or&&(console.log("here"),or.isDrawingMode=ir)},Ht=()=>jsxRuntimeExports.jsxs(RowContainer,{children:[jsxRuntimeExports.jsx(LabelTitle,{text:Ft("Broche"),toolTip:"Activa la brocha para dibujar mask en la imagen."}),jsxRuntimeExports.jsx(Switch,{id:"cropper",checked:b.showDrawing,onCheckedChange:ir=>{at({showDrawing:ir}),Gt(ir),ir&&at({showSelectable:!1})}})]}),qt=()=>jsxRuntimeExports.jsxs("div",{children:[jsxRuntimeExports.jsxs(RowContainer,{children:[jsxRuntimeExports.jsx(LabelTitle,{text:"Example Image",toolTip:"An example image to guide image generation."}),jsxRuntimeExports.jsx(ImageUploadButton,{tooltip:"Upload example image",onFileUpload:ir=>{Tt({paintByExampleFile:ir})},children:jsxRuntimeExports.jsx(Upload,{})})]}),jt?jsxRuntimeExports.jsx("div",{className:"flex justify-center items-center",children:jsxRuntimeExports.jsx("img",{src:Lt.src,alt:"example",className:"max-w-[200px] max-h-[200px] m-3"})}):jsxRuntimeExports.jsx(jsxRuntimeExports.Fragment,{}),jsxRuntimeExports.jsx(Button,{variant:"default",className:"w-full",disabled:st||!jt,onClick:()=>{vt("Fantasy-Studio/Paint-by-Example")},children:"EJECUTAR ACCION"})]}),Kt=ir=>{const or=d.current;if(or){const jr=or==null?void 0:or.getActiveObject();if(!jr)return;switch(ir){case"toFront":or.bringToFront(jr);break;case"toBack":or.sendToBack(jr);break;case"toForward":or.bringForward(jr);break;case"toBackward":or.sendBackwards(jr)}or.discardActiveObject(),or.renderAll()}},rr=()=>{const ir=[{label:"toForward",icon:jsxRuntimeExports.jsx(ArrowUpIcon,{className:"h-4 w-4"}),tooltip:"Forward"},{label:"toFront",icon:jsxRuntimeExports.jsx(DoubleArrowUpIcon,{className:"h-4 w-4"}),tooltip:"To front"},{label:"toBackward",icon:jsxRuntimeExports.jsx(ArrowDownIcon,{className:"h-4 w-4"}),tooltip:"Backward"},{label:"toBack",icon:jsxRuntimeExports.jsx(DoubleArrowDownIcon,{className:"h-4 w-4"}),tooltip:"To back"}];return jsxRuntimeExports.jsx(RowContainer,{children:ir.map(({label:or,icon:jr,tooltip:qr})=>jsxRuntimeExports.jsx(IconButton,{tooltip:qr,onClick:()=>Kt(or),children:jr},or))})};return jsxRuntimeExports.jsxs("div",{className:"flex flex-col gap-4 mt-4",children:[Ht(),rr(),jsxRuntimeExports.jsx(Separator,{}),qt()]})},LeftSidePanel=({fabricRef:d})=>{const[g,b]=useStore(at=>[at.settings,at.windowSize]),[et,st]=useToggle(!0);return useHotKey("c",()=>{st()}),jsxRuntimeExports.jsxs(Sheet,{open:et,modal:!1,children:[jsxRuntimeExports.jsx(SheetTrigger,{tabIndex:-1,className:"z-10 outline-none absolute top-[68px] left-6 rounded-lg border bg-background",hidden:et,children:jsxRuntimeExports.jsx(Button,{variant:"ghost",size:"icon",asChild:!0,className:"p-1.5",onClick:st,children:jsxRuntimeExports.jsx(ChevronRight,{strokeWidth:1})})}),jsxRuntimeExports.jsxs(SheetContent,{side:"left",className:"w-[300px] mt-[60px] outline-none pl-4 pr-1",onOpenAutoFocus:at=>at.preventDefault(),onPointerDownOutside:at=>at.preventDefault(),children:[jsxRuntimeExports.jsxs(SheetHeader,{children:[jsxRuntimeExports.jsxs(RowContainer,{children:[jsxRuntimeExports.jsx("div",{className:"overflow-hidden mr-8",children:"OPTIONS"}),jsxRuntimeExports.jsx(Button,{variant:"ghost",size:"icon",className:"border h-6 w-6",onClick:st,children:jsxRuntimeExports.jsx(ChevronLeft,{strokeWidth:1})})]}),jsxRuntimeExports.jsx(Separator,{})]}),jsxRuntimeExports.jsx(ScrollArea,{style:{height:b.height-160},className:"pr-3",children:jsxRuntimeExports.jsx(CanvasOptions,{fabricRef:d})})]})]})},model={name:"Fantasy-Studio/Paint-by-Example",path:"Fantasy-Studio/Paint-by-Example",model_type:"diffusers_other",is_single_file_diffusers:!1,need_prompt:!1,controlnets:[],support_strength:!1,support_outpainting:!1,support_lcm_lora:!1,support_controlnet:!1,support_freeu:!1},Workspace=()=>{const d=React.useRef(null),g=React.useRef(null),[b,et]=useStore(st=>[st.file,st.updateSettings]);return reactExports.useEffect(()=>{et({model})},[]),jsxRuntimeExports.jsxs(jsxRuntimeExports.Fragment,{children:[jsxRuntimeExports.jsx("div",{className:"flex gap-3 absolute top-[68px] left-[24px] items-center"}),jsxRuntimeExports.jsx(LeftSidePanel,{fabricRef:d}),jsxRuntimeExports.jsx(RightSidePanel,{}),b?jsxRuntimeExports.jsx(Editor,{fabricRef:d,file:b,ref:g}):jsxRuntimeExports.jsx(jsxRuntimeExports.Fragment,{})]})},useResolution=()=>{const[d,g]=reactExports.useState(window.innerWidth),b=reactExports.useCallback(()=>{g(window.innerWidth)},[]);if(reactExports.useEffect(()=>(window.addEventListener("resize",b),()=>{window.removeEventListener("resize",b)})),d<768)return"mobile";if(d>=768&&d<1224)return"tablet";if(d>=1224)return"desktop"};function _mergeNamespaces$1(d,g){return g.forEach(function(b){b&&typeof b!="string"&&!Array.isArray(b)&&Object.keys(b).forEach(function(et){if(et!=="default"&&!(et in d)){var st=Object.getOwnPropertyDescriptor(b,et);Object.defineProperty(d,et,st.get?st:{enumerable:!0,get:function(){return b[et]}})}})}),Object.freeze(d)}function copyExifWithoutOrientation(d,g){return new Promise(function(b,et){let st;return getApp1Segment(d).then(function(at){try{return st=at,b(new Blob([g.slice(0,2),st,g.slice(2)],{type:"image/jpeg"}))}catch(vt){return et(vt)}},et)})}const getApp1Segment=d=>new Promise((g,b)=>{const et=new FileReader;et.addEventListener("load",({target:{result:st}})=>{const at=new DataView(st);let vt=0;if(at.getUint16(vt)!==65496)return b("not a valid JPEG");for(vt+=2;;){const Tt=at.getUint16(vt);if(Tt===65498)break;const Ct=at.getUint16(vt+2);if(Tt===65505&&at.getUint32(vt+4)===1165519206){const pt=vt+10;let wt;switch(at.getUint16(pt)){case 18761:wt=!0;break;case 19789:wt=!1;break;default:return b("TIFF header contains invalid endian")}if(at.getUint16(pt+2,wt)!==42)return b("TIFF header contains invalid version");const $t=at.getUint32(pt+4,wt),Lt=pt+$t+2+12*at.getUint16(pt+$t,wt);for(let jt=pt+$t+2;jt<Lt;jt+=12)if(at.getUint16(jt,wt)==274){if(at.getUint16(jt+2,wt)!==3)return b("Orientation data type is invalid");if(at.getUint32(jt+4,wt)!==1)return b("Orientation data count is invalid");at.setUint16(jt+8,1,wt);break}return g(st.slice(vt,vt+2+Ct))}vt+=2+Ct}return g(new Blob)}),et.readAsArrayBuffer(d)});var e={},t={get exports(){return e},set exports(d){e=d}};(function(d){var g,b,et={};t.exports=et,et.parse=function(st,at){for(var vt=et.bin.readUshort,Tt=et.bin.readUint,Ct=0,pt={},wt=new Uint8Array(st),$t=wt.length-4;Tt(wt,$t)!=101010256;)$t--;Ct=$t,Ct+=4;var Lt=vt(wt,Ct+=4);vt(wt,Ct+=2);var jt=Tt(wt,Ct+=2),Ft=Tt(wt,Ct+=4);Ct+=4,Ct=Ft;for(var Gt=0;Gt<Lt;Gt++){Tt(wt,Ct),Ct+=4,Ct+=4,Ct+=4,Tt(wt,Ct+=4),jt=Tt(wt,Ct+=4);var Ht=Tt(wt,Ct+=4),qt=vt(wt,Ct+=4),Kt=vt(wt,Ct+2),rr=vt(wt,Ct+4);Ct+=6;var ir=Tt(wt,Ct+=8);Ct+=4,Ct+=qt+Kt+rr,et._readLocal(wt,ir,pt,jt,Ht,at)}return pt},et._readLocal=function(st,at,vt,Tt,Ct,pt){var wt=et.bin.readUshort,$t=et.bin.readUint;$t(st,at),wt(st,at+=4),wt(st,at+=2);var Lt=wt(st,at+=2);$t(st,at+=2),$t(st,at+=4),at+=4;var jt=wt(st,at+=8),Ft=wt(st,at+=2);at+=2;var Gt=et.bin.readUTF8(st,at,jt);if(at+=jt,at+=Ft,pt)vt[Gt]={size:Ct,csize:Tt};else{var Ht=new Uint8Array(st.buffer,at);if(Lt==0)vt[Gt]=new Uint8Array(Ht.buffer.slice(at,at+Tt));else{if(Lt!=8)throw"unknown compression method: "+Lt;var qt=new Uint8Array(Ct);et.inflateRaw(Ht,qt),vt[Gt]=qt}}},et.inflateRaw=function(st,at){return et.F.inflate(st,at)},et.inflate=function(st,at){return st[0],st[1],et.inflateRaw(new Uint8Array(st.buffer,st.byteOffset+2,st.length-6),at)},et.deflate=function(st,at){at==null&&(at={level:6});var vt=0,Tt=new Uint8Array(50+Math.floor(1.1*st.length));Tt[vt]=120,Tt[vt+1]=156,vt+=2,vt=et.F.deflateRaw(st,Tt,vt,at.level);var Ct=et.adler(st,0,st.length);return Tt[vt+0]=Ct>>>24&255,Tt[vt+1]=Ct>>>16&255,Tt[vt+2]=Ct>>>8&255,Tt[vt+3]=Ct>>>0&255,new Uint8Array(Tt.buffer,0,vt+4)},et.deflateRaw=function(st,at){at==null&&(at={level:6});var vt=new Uint8Array(50+Math.floor(1.1*st.length)),Tt=et.F.deflateRaw(st,vt,Tt,at.level);return new Uint8Array(vt.buffer,0,Tt)},et.encode=function(st,at){at==null&&(at=!1);var vt=0,Tt=et.bin.writeUint,Ct=et.bin.writeUshort,pt={};for(var wt in st){var $t=!et._noNeed(wt)&&!at,Lt=st[wt],jt=et.crc.crc(Lt,0,Lt.length);pt[wt]={cpr:$t,usize:Lt.length,crc:jt,file:$t?et.deflateRaw(Lt):Lt}}for(var wt in pt)vt+=pt[wt].file.length+30+46+2*et.bin.sizeUTF8(wt);vt+=22;var Ft=new Uint8Array(vt),Gt=0,Ht=[];for(var wt in pt){var qt=pt[wt];Ht.push(Gt),Gt=et._writeHeader(Ft,Gt,wt,qt,0)}var Kt=0,rr=Gt;for(var wt in pt)qt=pt[wt],Ht.push(Gt),Gt=et._writeHeader(Ft,Gt,wt,qt,1,Ht[Kt++]);var ir=Gt-rr;return Tt(Ft,Gt,101010256),Gt+=4,Ct(Ft,Gt+=4,Kt),Ct(Ft,Gt+=2,Kt),Tt(Ft,Gt+=2,ir),Tt(Ft,Gt+=4,rr),Gt+=4,Gt+=2,Ft.buffer},et._noNeed=function(st){var at=st.split(".").pop().toLowerCase();return"png,jpg,jpeg,zip".indexOf(at)!=-1},et._writeHeader=function(st,at,vt,Tt,Ct,pt){var wt=et.bin.writeUint,$t=et.bin.writeUshort,Lt=Tt.file;return wt(st,at,Ct==0?67324752:33639248),at+=4,Ct==1&&(at+=2),$t(st,at,20),$t(st,at+=2,0),$t(st,at+=2,Tt.cpr?8:0),wt(st,at+=2,0),wt(st,at+=4,Tt.crc),wt(st,at+=4,Lt.length),wt(st,at+=4,Tt.usize),$t(st,at+=4,et.bin.sizeUTF8(vt)),$t(st,at+=2,0),at+=2,Ct==1&&(at+=2,at+=2,wt(st,at+=6,pt),at+=4),at+=et.bin.writeUTF8(st,at,vt),Ct==0&&(st.set(Lt,at),at+=Lt.length),at},et.crc={table:function(){for(var st=new Uint32Array(256),at=0;at<256;at++){for(var vt=at,Tt=0;Tt<8;Tt++)1&vt?vt=3988292384^vt>>>1:vt>>>=1;st[at]=vt}return st}(),update:function(st,at,vt,Tt){for(var Ct=0;Ct<Tt;Ct++)st=et.crc.table[255&(st^at[vt+Ct])]^st>>>8;return st},crc:function(st,at,vt){return 4294967295^et.crc.update(4294967295,st,at,vt)}},et.adler=function(st,at,vt){for(var Tt=1,Ct=0,pt=at,wt=at+vt;pt<wt;){for(var $t=Math.min(pt+5552,wt);pt<$t;)Ct+=Tt+=st[pt++];Tt%=65521,Ct%=65521}return Ct<<16|Tt},et.bin={readUshort:function(st,at){return st[at]|st[at+1]<<8},writeUshort:function(st,at,vt){st[at]=255&vt,st[at+1]=vt>>8&255},readUint:function(st,at){return 16777216*st[at+3]+(st[at+2]<<16|st[at+1]<<8|st[at])},writeUint:function(st,at,vt){st[at]=255&vt,st[at+1]=vt>>8&255,st[at+2]=vt>>16&255,st[at+3]=vt>>24&255},readASCII:function(st,at,vt){for(var Tt="",Ct=0;Ct<vt;Ct++)Tt+=String.fromCharCode(st[at+Ct]);return Tt},writeASCII:function(st,at,vt){for(var Tt=0;Tt<vt.length;Tt++)st[at+Tt]=vt.charCodeAt(Tt)},pad:function(st){return st.length<2?"0"+st:st},readUTF8:function(st,at,vt){for(var Tt,Ct="",pt=0;pt<vt;pt++)Ct+="%"+et.bin.pad(st[at+pt].toString(16));try{Tt=decodeURIComponent(Ct)}catch{return et.bin.readASCII(st,at,vt)}return Tt},writeUTF8:function(st,at,vt){for(var Tt=vt.length,Ct=0,pt=0;pt<Tt;pt++){var wt=vt.charCodeAt(pt);if(!(4294967168&wt))st[at+Ct]=wt,Ct++;else if(!(4294965248&wt))st[at+Ct]=192|wt>>6,st[at+Ct+1]=128|wt>>0&63,Ct+=2;else if(!(4294901760&wt))st[at+Ct]=224|wt>>12,st[at+Ct+1]=128|wt>>6&63,st[at+Ct+2]=128|wt>>0&63,Ct+=3;else{if(4292870144&wt)throw"e";st[at+Ct]=240|wt>>18,st[at+Ct+1]=128|wt>>12&63,st[at+Ct+2]=128|wt>>6&63,st[at+Ct+3]=128|wt>>0&63,Ct+=4}}return Ct},sizeUTF8:function(st){for(var at=st.length,vt=0,Tt=0;Tt<at;Tt++){var Ct=st.charCodeAt(Tt);if(!(4294967168&Ct))vt++;else if(!(4294965248&Ct))vt+=2;else if(!(4294901760&Ct))vt+=3;else{if(4292870144&Ct)throw"e";vt+=4}}return vt}},et.F={},et.F.deflateRaw=function(st,at,vt,Tt){var Ct=[[0,0,0,0,0],[4,4,8,4,0],[4,5,16,8,0],[4,6,16,16,0],[4,10,16,32,0],[8,16,32,32,0],[8,16,128,128,0],[8,32,128,256,0],[32,128,258,1024,1],[32,258,258,4096,1]][Tt],pt=et.F.U,wt=et.F._goodIndex;et.F._hash;var $t=et.F._putsE,Lt=0,jt=vt<<3,Ft=0,Gt=st.length;if(Tt==0){for(;Lt<Gt;)$t(at,jt,Lt+(Xo=Math.min(65535,Gt-Lt))==Gt?1:0),jt=et.F._copyExact(st,Lt,Xo,at,jt+8),Lt+=Xo;return jt>>>3}var Ht=pt.lits,qt=pt.strt,Kt=pt.prev,rr=0,ir=0,or=0,jr=0,qr=0,Yr=0;for(Gt>2&&(qt[Yr=et.F._hash(st,0)]=0),Lt=0;Lt<Gt;Lt++){if(qr=Yr,Lt+1<Gt-2){Yr=et.F._hash(st,Lt+1);var vn=Lt+1&32767;Kt[vn]=qt[Yr],qt[Yr]=vn}if(Ft<=Lt){(rr>14e3||ir>26697)&&Gt-Lt>100&&(Ft<Lt&&(Ht[rr]=Lt-Ft,rr+=2,Ft=Lt),jt=et.F._writeBlock(Lt==Gt-1||Ft==Gt?1:0,Ht,rr,jr,st,or,Lt-or,at,jt),rr=ir=jr=0,or=Lt);var ko=0;Lt<Gt-2&&(ko=et.F._bestMatch(st,Lt,Kt,qr,Math.min(Ct[2],Gt-Lt),Ct[3]));var Xo=ko>>>16,zo=65535&ko;if(ko!=0){zo=65535&ko;var t0=wt(Xo=ko>>>16,pt.of0);pt.lhst[257+t0]++;var Uo=wt(zo,pt.df0);pt.dhst[Uo]++,jr+=pt.exb[t0]+pt.dxb[Uo],Ht[rr]=Xo<<23|Lt-Ft,Ht[rr+1]=zo<<16|t0<<8|Uo,rr+=2,Ft=Lt+Xo}else pt.lhst[st[Lt]]++;ir++}}for(or==Lt&&st.length!=0||(Ft<Lt&&(Ht[rr]=Lt-Ft,rr+=2,Ft=Lt),jt=et.F._writeBlock(1,Ht,rr,jr,st,or,Lt-or,at,jt),rr=0,ir=0,rr=ir=jr=0,or=Lt);7&jt;)jt++;return jt>>>3},et.F._bestMatch=function(st,at,vt,Tt,Ct,pt){var wt=32767&at,$t=vt[wt],Lt=wt-$t+32768&32767;if($t==wt||Tt!=et.F._hash(st,at-Lt))return 0;for(var jt=0,Ft=0,Gt=Math.min(32767,at);Lt<=Gt&&--pt!=0&&$t!=wt;){if(jt==0||st[at+jt]==st[at+jt-Lt]){var Ht=et.F._howLong(st,at,Lt);if(Ht>jt){if(Ft=Lt,(jt=Ht)>=Ct)break;Lt+2<Ht&&(Ht=Lt+2);for(var qt=0,Kt=0;Kt<Ht-2;Kt++){var rr=at-Lt+Kt+32768&32767,ir=rr-vt[rr]+32768&32767;ir>qt&&(qt=ir,$t=rr)}}}Lt+=(wt=$t)-($t=vt[wt])+32768&32767}return jt<<16|Ft},et.F._howLong=function(st,at,vt){if(st[at]!=st[at-vt]||st[at+1]!=st[at+1-vt]||st[at+2]!=st[at+2-vt])return 0;var Tt=at,Ct=Math.min(st.length,at+258);for(at+=3;at<Ct&&st[at]==st[at-vt];)at++;return at-Tt},et.F._hash=function(st,at){return(st[at]<<8|st[at+1])+(st[at+2]<<4)&65535},et.saved=0,et.F._writeBlock=function(st,at,vt,Tt,Ct,pt,wt,$t,Lt){var jt,Ft,Gt,Ht,qt,Kt,rr,ir,or,jr=et.F.U,qr=et.F._putsF,Yr=et.F._putsE;jr.lhst[256]++,Ft=(jt=et.F.getTrees())[0],Gt=jt[1],Ht=jt[2],qt=jt[3],Kt=jt[4],rr=jt[5],ir=jt[6],or=jt[7];var vn=32+(Lt+3&7?8-(Lt+3&7):0)+(wt<<3),ko=Tt+et.F.contSize(jr.fltree,jr.lhst)+et.F.contSize(jr.fdtree,jr.dhst),Xo=Tt+et.F.contSize(jr.ltree,jr.lhst)+et.F.contSize(jr.dtree,jr.dhst);Xo+=14+3*rr+et.F.contSize(jr.itree,jr.ihst)+(2*jr.ihst[16]+3*jr.ihst[17]+7*jr.ihst[18]);for(var zo=0;zo<286;zo++)jr.lhst[zo]=0;for(zo=0;zo<30;zo++)jr.dhst[zo]=0;for(zo=0;zo<19;zo++)jr.ihst[zo]=0;var t0=vn<ko&&vn<Xo?0:ko<Xo?1:2;if(qr($t,Lt,st),qr($t,Lt+1,t0),Lt+=3,t0==0){for(;7&Lt;)Lt++;Lt=et.F._copyExact(Ct,pt,wt,$t,Lt)}else{var Uo,No;if(t0==1&&(Uo=jr.fltree,No=jr.fdtree),t0==2){et.F.makeCodes(jr.ltree,Ft),et.F.revCodes(jr.ltree,Ft),et.F.makeCodes(jr.dtree,Gt),et.F.revCodes(jr.dtree,Gt),et.F.makeCodes(jr.itree,Ht),et.F.revCodes(jr.itree,Ht),Uo=jr.ltree,No=jr.dtree,Yr($t,Lt,qt-257),Yr($t,Lt+=5,Kt-1),Yr($t,Lt+=5,rr-4),Lt+=4;for(var _n=0;_n<rr;_n++)Yr($t,Lt+3*_n,jr.itree[1+(jr.ordr[_n]<<1)]);Lt+=3*rr,Lt=et.F._codeTiny(ir,jr.itree,$t,Lt),Lt=et.F._codeTiny(or,jr.itree,$t,Lt)}for(var Kr=pt,e0=0;e0<vt;e0+=2){for(var Zr=at[e0],Ro=Zr>>>23,Sn=Kr+(8388607&Zr);Kr<Sn;)Lt=et.F._writeLit(Ct[Kr++],Uo,$t,Lt);if(Ro!=0){var Tn=at[e0+1],n0=Tn>>16,Go=Tn>>8&255,An=255&Tn;Yr($t,Lt=et.F._writeLit(257+Go,Uo,$t,Lt),Ro-jr.of0[Go]),Lt+=jr.exb[Go],qr($t,Lt=et.F._writeLit(An,No,$t,Lt),n0-jr.df0[An]),Lt+=jr.dxb[An],Kr+=Ro}}Lt=et.F._writeLit(256,Uo,$t,Lt)}return Lt},et.F._copyExact=function(st,at,vt,Tt,Ct){var pt=Ct>>>3;return Tt[pt]=vt,Tt[pt+1]=vt>>>8,Tt[pt+2]=255-Tt[pt],Tt[pt+3]=255-Tt[pt+1],pt+=4,Tt.set(new Uint8Array(st.buffer,at,vt),pt),Ct+(vt+4<<3)},et.F.getTrees=function(){for(var st=et.F.U,at=et.F._hufTree(st.lhst,st.ltree,15),vt=et.F._hufTree(st.dhst,st.dtree,15),Tt=[],Ct=et.F._lenCodes(st.ltree,Tt),pt=[],wt=et.F._lenCodes(st.dtree,pt),$t=0;$t<Tt.length;$t+=2)st.ihst[Tt[$t]]++;for($t=0;$t<pt.length;$t+=2)st.ihst[pt[$t]]++;for(var Lt=et.F._hufTree(st.ihst,st.itree,7),jt=19;jt>4&&st.itree[1+(st.ordr[jt-1]<<1)]==0;)jt--;return[at,vt,Lt,Ct,wt,jt,Tt,pt]},et.F.getSecond=function(st){for(var at=[],vt=0;vt<st.length;vt+=2)at.push(st[vt+1]);return at},et.F.nonZero=function(st){for(var at="",vt=0;vt<st.length;vt+=2)st[vt+1]!=0&&(at+=(vt>>1)+",");return at},et.F.contSize=function(st,at){for(var vt=0,Tt=0;Tt<at.length;Tt++)vt+=at[Tt]*st[1+(Tt<<1)];return vt},et.F._codeTiny=function(st,at,vt,Tt){for(var Ct=0;Ct<st.length;Ct+=2){var pt=st[Ct],wt=st[Ct+1];Tt=et.F._writeLit(pt,at,vt,Tt);var $t=pt==16?2:pt==17?3:7;pt>15&&(et.F._putsE(vt,Tt,wt,$t),Tt+=$t)}return Tt},et.F._lenCodes=function(st,at){for(var vt=st.length;vt!=2&&st[vt-1]==0;)vt-=2;for(var Tt=0;Tt<vt;Tt+=2){var Ct=st[Tt+1],pt=Tt+3<vt?st[Tt+3]:-1,wt=Tt+5<vt?st[Tt+5]:-1,$t=Tt==0?-1:st[Tt-1];if(Ct==0&&pt==Ct&&wt==Ct){for(var Lt=Tt+5;Lt+2<vt&&st[Lt+2]==Ct;)Lt+=2;(jt=Math.min(Lt+1-Tt>>>1,138))<11?at.push(17,jt-3):at.push(18,jt-11),Tt+=2*jt-2}else if(Ct==$t&&pt==Ct&&wt==Ct){for(Lt=Tt+5;Lt+2<vt&&st[Lt+2]==Ct;)Lt+=2;var jt=Math.min(Lt+1-Tt>>>1,6);at.push(16,jt-3),Tt+=2*jt-2}else at.push(Ct,0)}return vt>>>1},et.F._hufTree=function(st,at,vt){var Tt=[],Ct=st.length,pt=at.length,wt=0;for(wt=0;wt<pt;wt+=2)at[wt]=0,at[wt+1]=0;for(wt=0;wt<Ct;wt++)st[wt]!=0&&Tt.push({lit:wt,f:st[wt]});var $t=Tt.length,Lt=Tt.slice(0);if($t==0)return 0;if($t==1){var jt=Tt[0].lit;return Lt=jt==0?1:0,at[1+(jt<<1)]=1,at[1+(Lt<<1)]=1,1}Tt.sort(function(ir,or){return ir.f-or.f});var Ft=Tt[0],Gt=Tt[1],Ht=0,qt=1,Kt=2;for(Tt[0]={lit:-1,f:Ft.f+Gt.f,l:Ft,r:Gt,d:0};qt!=$t-1;)Ft=Ht!=qt&&(Kt==$t||Tt[Ht].f<Tt[Kt].f)?Tt[Ht++]:Tt[Kt++],Gt=Ht!=qt&&(Kt==$t||Tt[Ht].f<Tt[Kt].f)?Tt[Ht++]:Tt[Kt++],Tt[qt++]={lit:-1,f:Ft.f+Gt.f,l:Ft,r:Gt};var rr=et.F.setDepth(Tt[qt-1],0);for(rr>vt&&(et.F.restrictDepth(Lt,vt,rr),rr=vt),wt=0;wt<$t;wt++)at[1+(Lt[wt].lit<<1)]=Lt[wt].d;return rr},et.F.setDepth=function(st,at){return st.lit!=-1?(st.d=at,at):Math.max(et.F.setDepth(st.l,at+1),et.F.setDepth(st.r,at+1))},et.F.restrictDepth=function(st,at,vt){var Tt=0,Ct=1<<vt-at,pt=0;for(st.sort(function($t,Lt){return Lt.d==$t.d?$t.f-Lt.f:Lt.d-$t.d}),Tt=0;Tt<st.length&&st[Tt].d>at;Tt++){var wt=st[Tt].d;st[Tt].d=at,pt+=Ct-(1<<vt-wt)}for(pt>>>=vt-at;pt>0;)(wt=st[Tt].d)<at?(st[Tt].d++,pt-=1<<at-wt-1):Tt++;for(;Tt>=0;Tt--)st[Tt].d==at&&pt<0&&(st[Tt].d--,pt++);pt!=0&&console.log("debt left")},et.F._goodIndex=function(st,at){var vt=0;return at[16|vt]<=st&&(vt|=16),at[8|vt]<=st&&(vt|=8),at[4|vt]<=st&&(vt|=4),at[2|vt]<=st&&(vt|=2),at[1|vt]<=st&&(vt|=1),vt},et.F._writeLit=function(st,at,vt,Tt){return et.F._putsF(vt,Tt,at[st<<1]),Tt+at[1+(st<<1)]},et.F.inflate=function(st,at){var vt=Uint8Array;if(st[0]==3&&st[1]==0)return at||new vt(0);var Tt=et.F,Ct=Tt._bitsF,pt=Tt._bitsE,wt=Tt._decodeTiny,$t=Tt.makeCodes,Lt=Tt.codes2map,jt=Tt._get17,Ft=Tt.U,Gt=at==null;Gt&&(at=new vt(st.length>>>2<<3));for(var Ht,qt,Kt=0,rr=0,ir=0,or=0,jr=0,qr=0,Yr=0,vn=0,ko=0;Kt==0;)if(Kt=Ct(st,ko,1),rr=Ct(st,ko+1,2),ko+=3,rr!=0){if(Gt&&(at=et.F._check(at,vn+(1<<17))),rr==1&&(Ht=Ft.flmap,qt=Ft.fdmap,qr=511,Yr=31),rr==2){ir=pt(st,ko,5)+257,or=pt(st,ko+5,5)+1,jr=pt(st,ko+10,4)+4,ko+=14;for(var Xo=0;Xo<38;Xo+=2)Ft.itree[Xo]=0,Ft.itree[Xo+1]=0;var zo=1;for(Xo=0;Xo<jr;Xo++){var t0=pt(st,ko+3*Xo,3);Ft.itree[1+(Ft.ordr[Xo]<<1)]=t0,t0>zo&&(zo=t0)}ko+=3*jr,$t(Ft.itree,zo),Lt(Ft.itree,zo,Ft.imap),Ht=Ft.lmap,qt=Ft.dmap,ko=wt(Ft.imap,(1<<zo)-1,ir+or,st,ko,Ft.ttree);var Uo=Tt._copyOut(Ft.ttree,0,ir,Ft.ltree);qr=(1<<Uo)-1;var No=Tt._copyOut(Ft.ttree,ir,or,Ft.dtree);Yr=(1<<No)-1,$t(Ft.ltree,Uo),Lt(Ft.ltree,Uo,Ht),$t(Ft.dtree,No),Lt(Ft.dtree,No,qt)}for(;;){var _n=Ht[jt(st,ko)&qr];ko+=15&_n;var Kr=_n>>>4;if(!(Kr>>>8))at[vn++]=Kr;else{if(Kr==256)break;var e0=vn+Kr-254;if(Kr>264){var Zr=Ft.ldef[Kr-257];e0=vn+(Zr>>>3)+pt(st,ko,7&Zr),ko+=7&Zr}var Ro=qt[jt(st,ko)&Yr];ko+=15&Ro;var Sn=Ro>>>4,Tn=Ft.ddef[Sn],n0=(Tn>>>4)+Ct(st,ko,15&Tn);for(ko+=15&Tn,Gt&&(at=et.F._check(at,vn+(1<<17)));vn<e0;)at[vn]=at[vn++-n0],at[vn]=at[vn++-n0],at[vn]=at[vn++-n0],at[vn]=at[vn++-n0];vn=e0}}}else{7&ko&&(ko+=8-(7&ko));var Go=4+(ko>>>3),An=st[Go-4]|st[Go-3]<<8;Gt&&(at=et.F._check(at,vn+An)),at.set(new vt(st.buffer,st.byteOffset+Go,An),vn),ko=Go+An<<3,vn+=An}return at.length==vn?at:at.slice(0,vn)},et.F._check=function(st,at){var vt=st.length;if(at<=vt)return st;var Tt=new Uint8Array(Math.max(vt<<1,at));return Tt.set(st,0),Tt},et.F._decodeTiny=function(st,at,vt,Tt,Ct,pt){for(var wt=et.F._bitsE,$t=et.F._get17,Lt=0;Lt<vt;){var jt=st[$t(Tt,Ct)&at];Ct+=15&jt;var Ft=jt>>>4;if(Ft<=15)pt[Lt]=Ft,Lt++;else{var Gt=0,Ht=0;Ft==16?(Ht=3+wt(Tt,Ct,2),Ct+=2,Gt=pt[Lt-1]):Ft==17?(Ht=3+wt(Tt,Ct,3),Ct+=3):Ft==18&&(Ht=11+wt(Tt,Ct,7),Ct+=7);for(var qt=Lt+Ht;Lt<qt;)pt[Lt]=Gt,Lt++}}return Ct},et.F._copyOut=function(st,at,vt,Tt){for(var Ct=0,pt=0,wt=Tt.length>>>1;pt<vt;){var $t=st[pt+at];Tt[pt<<1]=0,Tt[1+(pt<<1)]=$t,$t>Ct&&(Ct=$t),pt++}for(;pt<wt;)Tt[pt<<1]=0,Tt[1+(pt<<1)]=0,pt++;return Ct},et.F.makeCodes=function(st,at){for(var vt,Tt,Ct,pt,wt=et.F.U,$t=st.length,Lt=wt.bl_count,jt=0;jt<=at;jt++)Lt[jt]=0;for(jt=1;jt<$t;jt+=2)Lt[st[jt]]++;var Ft=wt.next_code;for(vt=0,Lt[0]=0,Tt=1;Tt<=at;Tt++)vt=vt+Lt[Tt-1]<<1,Ft[Tt]=vt;for(Ct=0;Ct<$t;Ct+=2)(pt=st[Ct+1])!=0&&(st[Ct]=Ft[pt],Ft[pt]++)},et.F.codes2map=function(st,at,vt){for(var Tt=st.length,Ct=et.F.U.rev15,pt=0;pt<Tt;pt+=2)if(st[pt+1]!=0)for(var wt=pt>>1,$t=st[pt+1],Lt=wt<<4|$t,jt=at-$t,Ft=st[pt]<<jt,Gt=Ft+(1<<jt);Ft!=Gt;)vt[Ct[Ft]>>>15-at]=Lt,Ft++},et.F.revCodes=function(st,at){for(var vt=et.F.U.rev15,Tt=15-at,Ct=0;Ct<st.length;Ct+=2){var pt=st[Ct]<<at-st[Ct+1];st[Ct]=vt[pt]>>>Tt}},et.F._putsE=function(st,at,vt){vt<<=7&at;var Tt=at>>>3;st[Tt]|=vt,st[Tt+1]|=vt>>>8},et.F._putsF=function(st,at,vt){vt<<=7&at;var Tt=at>>>3;st[Tt]|=vt,st[Tt+1]|=vt>>>8,st[Tt+2]|=vt>>>16},et.F._bitsE=function(st,at,vt){return(st[at>>>3]|st[1+(at>>>3)]<<8)>>>(7&at)&(1<<vt)-1},et.F._bitsF=function(st,at,vt){return(st[at>>>3]|st[1+(at>>>3)]<<8|st[2+(at>>>3)]<<16)>>>(7&at)&(1<<vt)-1},et.F._get17=function(st,at){return(st[at>>>3]|st[1+(at>>>3)]<<8|st[2+(at>>>3)]<<16)>>>(7&at)},et.F._get25=function(st,at){return(st[at>>>3]|st[1+(at>>>3)]<<8|st[2+(at>>>3)]<<16|st[3+(at>>>3)]<<24)>>>(7&at)},et.F.U=(g=Uint16Array,b=Uint32Array,{next_code:new g(16),bl_count:new g(16),ordr:[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],of0:[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,999,999,999],exb:[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0],ldef:new g(32),df0:[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,65535,65535],dxb:[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0],ddef:new b(32),flmap:new g(512),fltree:[],fdmap:new g(32),fdtree:[],lmap:new g(32768),ltree:[],ttree:[],dmap:new g(32768),dtree:[],imap:new g(512),itree:[],rev15:new g(32768),lhst:new b(286),dhst:new b(30),ihst:new b(19),lits:new b(15e3),strt:new g(65536),prev:new g(32768)}),function(){for(var st=et.F.U,at=0;at<32768;at++){var vt=at;vt=(4278255360&(vt=(4042322160&(vt=(3435973836&(vt=(2863311530&vt)>>>1|(1431655765&vt)<<1))>>>2|(858993459&vt)<<2))>>>4|(252645135&vt)<<4))>>>8|(16711935&vt)<<8,st.rev15[at]=(vt>>>16|vt<<16)>>>17}function Tt(Ct,pt,wt){for(;pt--!=0;)Ct.push(0,wt)}for(at=0;at<32;at++)st.ldef[at]=st.of0[at]<<3|st.exb[at],st.ddef[at]=st.df0[at]<<4|st.dxb[at];Tt(st.fltree,144,8),Tt(st.fltree,112,9),Tt(st.fltree,24,7),Tt(st.fltree,8,8),et.F.makeCodes(st.fltree,9),et.F.codes2map(st.fltree,9,st.flmap),et.F.revCodes(st.fltree,9),Tt(st.fdtree,32,5),et.F.makeCodes(st.fdtree,5),et.F.codes2map(st.fdtree,5,st.fdmap),et.F.revCodes(st.fdtree,5),Tt(st.itree,19,0),Tt(st.ltree,286,0),Tt(st.dtree,30,0),Tt(st.ttree,320,0)}()})();var UZIP=_mergeNamespaces$1({__proto__:null,default:e},[e]);const UPNG=function(){var d={nextZero(wt,$t){for(;wt[$t]!=0;)$t++;return $t},readUshort:(wt,$t)=>wt[$t]<<8|wt[$t+1],writeUshort(wt,$t,Lt){wt[$t]=Lt>>8&255,wt[$t+1]=255&Lt},readUint:(wt,$t)=>16777216*wt[$t]+(wt[$t+1]<<16|wt[$t+2]<<8|wt[$t+3]),writeUint(wt,$t,Lt){wt[$t]=Lt>>24&255,wt[$t+1]=Lt>>16&255,wt[$t+2]=Lt>>8&255,wt[$t+3]=255&Lt},readASCII(wt,$t,Lt){let jt="";for(let Ft=0;Ft<Lt;Ft++)jt+=String.fromCharCode(wt[$t+Ft]);return jt},writeASCII(wt,$t,Lt){for(let jt=0;jt<Lt.length;jt++)wt[$t+jt]=Lt.charCodeAt(jt)},readBytes(wt,$t,Lt){const jt=[];for(let Ft=0;Ft<Lt;Ft++)jt.push(wt[$t+Ft]);return jt},pad:wt=>wt.length<2?`0${wt}`:wt,readUTF8(wt,$t,Lt){let jt,Ft="";for(let Gt=0;Gt<Lt;Gt++)Ft+=`%${d.pad(wt[$t+Gt].toString(16))}`;try{jt=decodeURIComponent(Ft)}catch{return d.readASCII(wt,$t,Lt)}return jt}};function g(wt,$t,Lt,jt){const Ft=$t*Lt,Gt=at(jt),Ht=Math.ceil($t*Gt/8),qt=new Uint8Array(4*Ft),Kt=new Uint32Array(qt.buffer),{ctype:rr}=jt,{depth:ir}=jt,or=d.readUshort;if(rr==6){const Zr=Ft<<2;if(ir==8)for(var jr=0;jr<Zr;jr+=4)qt[jr]=wt[jr],qt[jr+1]=wt[jr+1],qt[jr+2]=wt[jr+2],qt[jr+3]=wt[jr+3];if(ir==16)for(jr=0;jr<Zr;jr++)qt[jr]=wt[jr<<1]}else if(rr==2){const Zr=jt.tabs.tRNS;if(Zr==null){if(ir==8)for(jr=0;jr<Ft;jr++){var qr=3*jr;Kt[jr]=255<<24|wt[qr+2]<<16|wt[qr+1]<<8|wt[qr]}if(ir==16)for(jr=0;jr<Ft;jr++)qr=6*jr,Kt[jr]=255<<24|wt[qr+4]<<16|wt[qr+2]<<8|wt[qr]}else{var Yr=Zr[0];const Ro=Zr[1],Sn=Zr[2];if(ir==8)for(jr=0;jr<Ft;jr++){var vn=jr<<2;qr=3*jr,Kt[jr]=255<<24|wt[qr+2]<<16|wt[qr+1]<<8|wt[qr],wt[qr]==Yr&&wt[qr+1]==Ro&&wt[qr+2]==Sn&&(qt[vn+3]=0)}if(ir==16)for(jr=0;jr<Ft;jr++)vn=jr<<2,qr=6*jr,Kt[jr]=255<<24|wt[qr+4]<<16|wt[qr+2]<<8|wt[qr],or(wt,qr)==Yr&&or(wt,qr+2)==Ro&&or(wt,qr+4)==Sn&&(qt[vn+3]=0)}}else if(rr==3){const Zr=jt.tabs.PLTE,Ro=jt.tabs.tRNS,Sn=Ro?Ro.length:0;if(ir==1)for(var ko=0;ko<Lt;ko++){var Xo=ko*Ht,zo=ko*$t;for(jr=0;jr<$t;jr++){vn=zo+jr<<2;var t0=3*(Uo=wt[Xo+(jr>>3)]>>7-((7&jr)<<0)&1);qt[vn]=Zr[t0],qt[vn+1]=Zr[t0+1],qt[vn+2]=Zr[t0+2],qt[vn+3]=Uo<Sn?Ro[Uo]:255}}if(ir==2)for(ko=0;ko<Lt;ko++)for(Xo=ko*Ht,zo=ko*$t,jr=0;jr<$t;jr++)vn=zo+jr<<2,t0=3*(Uo=wt[Xo+(jr>>2)]>>6-((3&jr)<<1)&3),qt[vn]=Zr[t0],qt[vn+1]=Zr[t0+1],qt[vn+2]=Zr[t0+2],qt[vn+3]=Uo<Sn?Ro[Uo]:255;if(ir==4)for(ko=0;ko<Lt;ko++)for(Xo=ko*Ht,zo=ko*$t,jr=0;jr<$t;jr++)vn=zo+jr<<2,t0=3*(Uo=wt[Xo+(jr>>1)]>>4-((1&jr)<<2)&15),qt[vn]=Zr[t0],qt[vn+1]=Zr[t0+1],qt[vn+2]=Zr[t0+2],qt[vn+3]=Uo<Sn?Ro[Uo]:255;if(ir==8)for(jr=0;jr<Ft;jr++){var Uo;vn=jr<<2,t0=3*(Uo=wt[jr]),qt[vn]=Zr[t0],qt[vn+1]=Zr[t0+1],qt[vn+2]=Zr[t0+2],qt[vn+3]=Uo<Sn?Ro[Uo]:255}}else if(rr==4){if(ir==8)for(jr=0;jr<Ft;jr++){vn=jr<<2;var No=wt[_n=jr<<1];qt[vn]=No,qt[vn+1]=No,qt[vn+2]=No,qt[vn+3]=wt[_n+1]}if(ir==16)for(jr=0;jr<Ft;jr++){var _n;vn=jr<<2,No=wt[_n=jr<<2],qt[vn]=No,qt[vn+1]=No,qt[vn+2]=No,qt[vn+3]=wt[_n+2]}}else if(rr==0)for(Yr=jt.tabs.tRNS?jt.tabs.tRNS:-1,ko=0;ko<Lt;ko++){const Zr=ko*Ht,Ro=ko*$t;if(ir==1)for(var Kr=0;Kr<$t;Kr++){var e0=(No=255*(wt[Zr+(Kr>>>3)]>>>7-(7&Kr)&1))==255*Yr?0:255;Kt[Ro+Kr]=e0<<24|No<<16|No<<8|No}else if(ir==2)for(Kr=0;Kr<$t;Kr++)e0=(No=85*(wt[Zr+(Kr>>>2)]>>>6-((3&Kr)<<1)&3))==85*Yr?0:255,Kt[Ro+Kr]=e0<<24|No<<16|No<<8|No;else if(ir==4)for(Kr=0;Kr<$t;Kr++)e0=(No=17*(wt[Zr+(Kr>>>1)]>>>4-((1&Kr)<<2)&15))==17*Yr?0:255,Kt[Ro+Kr]=e0<<24|No<<16|No<<8|No;else if(ir==8)for(Kr=0;Kr<$t;Kr++)e0=(No=wt[Zr+Kr])==Yr?0:255,Kt[Ro+Kr]=e0<<24|No<<16|No<<8|No;else if(ir==16)for(Kr=0;Kr<$t;Kr++)No=wt[Zr+(Kr<<1)],e0=or(wt,Zr+(Kr<<1))==Yr?0:255,Kt[Ro+Kr]=e0<<24|No<<16|No<<8|No}return qt}function b(wt,$t,Lt,jt){const Ft=at(wt),Gt=Math.ceil(Lt*Ft/8),Ht=new Uint8Array((Gt+1+wt.interlace)*jt);return $t=wt.tabs.CgBI?st($t,Ht):et($t,Ht),wt.interlace==0?$t=vt($t,wt,0,Lt,jt):wt.interlace==1&&($t=function(Kt,rr){const ir=rr.width,or=rr.height,jr=at(rr),qr=jr>>3,Yr=Math.ceil(ir*jr/8),vn=new Uint8Array(or*Yr);let ko=0;const Xo=[0,0,4,0,2,0,1],zo=[0,4,0,2,0,1,0],t0=[8,8,8,4,4,2,2],Uo=[8,8,4,4,2,2,1];let No=0;for(;No<7;){const Kr=t0[No],e0=Uo[No];let Zr=0,Ro=0,Sn=Xo[No];for(;Sn<or;)Sn+=Kr,Ro++;let Tn=zo[No];for(;Tn<ir;)Tn+=e0,Zr++;const n0=Math.ceil(Zr*jr/8);vt(Kt,rr,ko,Zr,Ro);let Go=0,An=Xo[No];for(;An<or;){let a0=zo[No],u0=ko+Go*n0<<3;for(;a0<ir;){var _n;if(jr==1&&(_n=(_n=Kt[u0>>3])>>7-(7&u0)&1,vn[An*Yr+(a0>>3)]|=_n<<7-((7&a0)<<0)),jr==2&&(_n=(_n=Kt[u0>>3])>>6-(7&u0)&3,vn[An*Yr+(a0>>2)]|=_n<<6-((3&a0)<<1)),jr==4&&(_n=(_n=Kt[u0>>3])>>4-(7&u0)&15,vn[An*Yr+(a0>>1)]|=_n<<4-((1&a0)<<2)),jr>=8){const d0=An*Yr+a0*qr;for(let f0=0;f0<qr;f0++)vn[d0+f0]=Kt[(u0>>3)+f0]}u0+=jr,a0+=e0}Go++,An+=Kr}Zr*Ro!=0&&(ko+=Ro*(1+n0)),No+=1}return vn}($t,wt)),$t}function et(wt,$t){return st(new Uint8Array(wt.buffer,2,wt.length-6),$t)}var st=function(){const wt={H:{}};return wt.H.N=function($t,Lt){const jt=Uint8Array;let Ft,Gt,Ht=0,qt=0,Kt=0,rr=0,ir=0,or=0,jr=0,qr=0,Yr=0;if($t[0]==3&&$t[1]==0)return Lt||new jt(0);const vn=wt.H,ko=vn.b,Xo=vn.e,zo=vn.R,t0=vn.n,Uo=vn.A,No=vn.Z,_n=vn.m,Kr=Lt==null;for(Kr&&(Lt=new jt($t.length>>>2<<5));Ht==0;)if(Ht=ko($t,Yr,1),qt=ko($t,Yr+1,2),Yr+=3,qt!=0){if(Kr&&(Lt=wt.H.W(Lt,qr+(1<<17))),qt==1&&(Ft=_n.J,Gt=_n.h,or=511,jr=31),qt==2){Kt=Xo($t,Yr,5)+257,rr=Xo($t,Yr+5,5)+1,ir=Xo($t,Yr+10,4)+4,Yr+=14;let Zr=1;for(var e0=0;e0<38;e0+=2)_n.Q[e0]=0,_n.Q[e0+1]=0;for(e0=0;e0<ir;e0++){const Tn=Xo($t,Yr+3*e0,3);_n.Q[1+(_n.X[e0]<<1)]=Tn,Tn>Zr&&(Zr=Tn)}Yr+=3*ir,t0(_n.Q,Zr),Uo(_n.Q,Zr,_n.u),Ft=_n.w,Gt=_n.d,Yr=zo(_n.u,(1<<Zr)-1,Kt+rr,$t,Yr,_n.v);const Ro=vn.V(_n.v,0,Kt,_n.C);or=(1<<Ro)-1;const Sn=vn.V(_n.v,Kt,rr,_n.D);jr=(1<<Sn)-1,t0(_n.C,Ro),Uo(_n.C,Ro,Ft),t0(_n.D,Sn),Uo(_n.D,Sn,Gt)}for(;;){const Zr=Ft[No($t,Yr)&or];Yr+=15&Zr;const Ro=Zr>>>4;if(!(Ro>>>8))Lt[qr++]=Ro;else{if(Ro==256)break;{let Sn=qr+Ro-254;if(Ro>264){const a0=_n.q[Ro-257];Sn=qr+(a0>>>3)+Xo($t,Yr,7&a0),Yr+=7&a0}const Tn=Gt[No($t,Yr)&jr];Yr+=15&Tn;const n0=Tn>>>4,Go=_n.c[n0],An=(Go>>>4)+ko($t,Yr,15&Go);for(Yr+=15&Go;qr<Sn;)Lt[qr]=Lt[qr++-An],Lt[qr]=Lt[qr++-An],Lt[qr]=Lt[qr++-An],Lt[qr]=Lt[qr++-An];qr=Sn}}}}else{7&Yr&&(Yr+=8-(7&Yr));const Zr=4+(Yr>>>3),Ro=$t[Zr-4]|$t[Zr-3]<<8;Kr&&(Lt=wt.H.W(Lt,qr+Ro)),Lt.set(new jt($t.buffer,$t.byteOffset+Zr,Ro),qr),Yr=Zr+Ro<<3,qr+=Ro}return Lt.length==qr?Lt:Lt.slice(0,qr)},wt.H.W=function($t,Lt){const jt=$t.length;if(Lt<=jt)return $t;const Ft=new Uint8Array(jt<<1);return Ft.set($t,0),Ft},wt.H.R=function($t,Lt,jt,Ft,Gt,Ht){const qt=wt.H.e,Kt=wt.H.Z;let rr=0;for(;rr<jt;){const ir=$t[Kt(Ft,Gt)&Lt];Gt+=15&ir;const or=ir>>>4;if(or<=15)Ht[rr]=or,rr++;else{let jr=0,qr=0;or==16?(qr=3+qt(Ft,Gt,2),Gt+=2,jr=Ht[rr-1]):or==17?(qr=3+qt(Ft,Gt,3),Gt+=3):or==18&&(qr=11+qt(Ft,Gt,7),Gt+=7);const Yr=rr+qr;for(;rr<Yr;)Ht[rr]=jr,rr++}}return Gt},wt.H.V=function($t,Lt,jt,Ft){let Gt=0,Ht=0;const qt=Ft.length>>>1;for(;Ht<jt;){const Kt=$t[Ht+Lt];Ft[Ht<<1]=0,Ft[1+(Ht<<1)]=Kt,Kt>Gt&&(Gt=Kt),Ht++}for(;Ht<qt;)Ft[Ht<<1]=0,Ft[1+(Ht<<1)]=0,Ht++;return Gt},wt.H.n=function($t,Lt){const jt=wt.H.m,Ft=$t.length;let Gt,Ht,qt,Kt;const rr=jt.j;for(var ir=0;ir<=Lt;ir++)rr[ir]=0;for(ir=1;ir<Ft;ir+=2)rr[$t[ir]]++;const or=jt.K;for(Gt=0,rr[0]=0,Ht=1;Ht<=Lt;Ht++)Gt=Gt+rr[Ht-1]<<1,or[Ht]=Gt;for(qt=0;qt<Ft;qt+=2)Kt=$t[qt+1],Kt!=0&&($t[qt]=or[Kt],or[Kt]++)},wt.H.A=function($t,Lt,jt){const Ft=$t.length,Gt=wt.H.m.r;for(let Ht=0;Ht<Ft;Ht+=2)if($t[Ht+1]!=0){const qt=Ht>>1,Kt=$t[Ht+1],rr=qt<<4|Kt,ir=Lt-Kt;let or=$t[Ht]<<ir;const jr=or+(1<<ir);for(;or!=jr;)jt[Gt[or]>>>15-Lt]=rr,or++}},wt.H.l=function($t,Lt){const jt=wt.H.m.r,Ft=15-Lt;for(let Gt=0;Gt<$t.length;Gt+=2){const Ht=$t[Gt]<<Lt-$t[Gt+1];$t[Gt]=jt[Ht]>>>Ft}},wt.H.M=function($t,Lt,jt){jt<<=7&Lt;const Ft=Lt>>>3;$t[Ft]|=jt,$t[Ft+1]|=jt>>>8},wt.H.I=function($t,Lt,jt){jt<<=7&Lt;const Ft=Lt>>>3;$t[Ft]|=jt,$t[Ft+1]|=jt>>>8,$t[Ft+2]|=jt>>>16},wt.H.e=function($t,Lt,jt){return($t[Lt>>>3]|$t[1+(Lt>>>3)]<<8)>>>(7&Lt)&(1<<jt)-1},wt.H.b=function($t,Lt,jt){return($t[Lt>>>3]|$t[1+(Lt>>>3)]<<8|$t[2+(Lt>>>3)]<<16)>>>(7&Lt)&(1<<jt)-1},wt.H.Z=function($t,Lt){return($t[Lt>>>3]|$t[1+(Lt>>>3)]<<8|$t[2+(Lt>>>3)]<<16)>>>(7&Lt)},wt.H.i=function($t,Lt){return($t[Lt>>>3]|$t[1+(Lt>>>3)]<<8|$t[2+(Lt>>>3)]<<16|$t[3+(Lt>>>3)]<<24)>>>(7&Lt)},wt.H.m=function(){const $t=Uint16Array,Lt=Uint32Array;return{K:new $t(16),j:new $t(16),X:[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],S:[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,999,999,999],T:[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0],q:new $t(32),p:[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,65535,65535],z:[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0],c:new Lt(32),J:new $t(512),_:[],h:new $t(32),$:[],w:new $t(32768),C:[],v:[],d:new $t(32768),D:[],u:new $t(512),Q:[],r:new $t(32768),s:new Lt(286),Y:new Lt(30),a:new Lt(19),t:new Lt(15e3),k:new $t(65536),g:new $t(32768)}}(),function(){const $t=wt.H.m;for(var Lt=0;Lt<32768;Lt++){let Ft=Lt;Ft=(2863311530&Ft)>>>1|(1431655765&Ft)<<1,Ft=(3435973836&Ft)>>>2|(858993459&Ft)<<2,Ft=(4042322160&Ft)>>>4|(252645135&Ft)<<4,Ft=(4278255360&Ft)>>>8|(16711935&Ft)<<8,$t.r[Lt]=(Ft>>>16|Ft<<16)>>>17}function jt(Ft,Gt,Ht){for(;Gt--!=0;)Ft.push(0,Ht)}for(Lt=0;Lt<32;Lt++)$t.q[Lt]=$t.S[Lt]<<3|$t.T[Lt],$t.c[Lt]=$t.p[Lt]<<4|$t.z[Lt];jt($t._,144,8),jt($t._,112,9),jt($t._,24,7),jt($t._,8,8),wt.H.n($t._,9),wt.H.A($t._,9,$t.J),wt.H.l($t._,9),jt($t.$,32,5),wt.H.n($t.$,5),wt.H.A($t.$,5,$t.h),wt.H.l($t.$,5),jt($t.Q,19,0),jt($t.C,286,0),jt($t.D,30,0),jt($t.v,320,0)}(),wt.H.N}();function at(wt){return[1,null,3,1,2,null,4][wt.ctype]*wt.depth}function vt(wt,$t,Lt,jt,Ft){let Gt=at($t);const Ht=Math.ceil(jt*Gt/8);let qt,Kt;Gt=Math.ceil(Gt/8);let rr=wt[Lt],ir=0;if(rr>1&&(wt[Lt]=[0,0,1][rr-2]),rr==3)for(ir=Gt;ir<Ht;ir++)wt[ir+1]=wt[ir+1]+(wt[ir+1-Gt]>>>1)&255;for(let or=0;or<Ft;or++)if(qt=Lt+or*Ht,Kt=qt+or+1,rr=wt[Kt-1],ir=0,rr==0)for(;ir<Ht;ir++)wt[qt+ir]=wt[Kt+ir];else if(rr==1){for(;ir<Gt;ir++)wt[qt+ir]=wt[Kt+ir];for(;ir<Ht;ir++)wt[qt+ir]=wt[Kt+ir]+wt[qt+ir-Gt]}else if(rr==2)for(;ir<Ht;ir++)wt[qt+ir]=wt[Kt+ir]+wt[qt+ir-Ht];else if(rr==3){for(;ir<Gt;ir++)wt[qt+ir]=wt[Kt+ir]+(wt[qt+ir-Ht]>>>1);for(;ir<Ht;ir++)wt[qt+ir]=wt[Kt+ir]+(wt[qt+ir-Ht]+wt[qt+ir-Gt]>>>1)}else{for(;ir<Gt;ir++)wt[qt+ir]=wt[Kt+ir]+Tt(0,wt[qt+ir-Ht],0);for(;ir<Ht;ir++)wt[qt+ir]=wt[Kt+ir]+Tt(wt[qt+ir-Gt],wt[qt+ir-Ht],wt[qt+ir-Gt-Ht])}return wt}function Tt(wt,$t,Lt){const jt=wt+$t-Lt,Ft=jt-wt,Gt=jt-$t,Ht=jt-Lt;return Ft*Ft<=Gt*Gt&&Ft*Ft<=Ht*Ht?wt:Gt*Gt<=Ht*Ht?$t:Lt}function Ct(wt,$t,Lt){Lt.width=d.readUint(wt,$t),$t+=4,Lt.height=d.readUint(wt,$t),$t+=4,Lt.depth=wt[$t],$t++,Lt.ctype=wt[$t],$t++,Lt.compress=wt[$t],$t++,Lt.filter=wt[$t],$t++,Lt.interlace=wt[$t],$t++}function pt(wt,$t,Lt,jt,Ft,Gt,Ht,qt,Kt){const rr=Math.min($t,Ft),ir=Math.min(Lt,Gt);let or=0,jr=0;for(let No=0;No<ir;No++)for(let _n=0;_n<rr;_n++)if(Ht>=0&&qt>=0?(or=No*$t+_n<<2,jr=(qt+No)*Ft+Ht+_n<<2):(or=(-qt+No)*$t-Ht+_n<<2,jr=No*Ft+_n<<2),Kt==0)jt[jr]=wt[or],jt[jr+1]=wt[or+1],jt[jr+2]=wt[or+2],jt[jr+3]=wt[or+3];else if(Kt==1){var qr=wt[or+3]*.00392156862745098,Yr=wt[or]*qr,vn=wt[or+1]*qr,ko=wt[or+2]*qr,Xo=jt[jr+3]*(1/255),zo=jt[jr]*Xo,t0=jt[jr+1]*Xo,Uo=jt[jr+2]*Xo;const Kr=1-qr,e0=qr+Xo*Kr,Zr=e0==0?0:1/e0;jt[jr+3]=255*e0,jt[jr+0]=(Yr+zo*Kr)*Zr,jt[jr+1]=(vn+t0*Kr)*Zr,jt[jr+2]=(ko+Uo*Kr)*Zr}else if(Kt==2)qr=wt[or+3],Yr=wt[or],vn=wt[or+1],ko=wt[or+2],Xo=jt[jr+3],zo=jt[jr],t0=jt[jr+1],Uo=jt[jr+2],qr==Xo&&Yr==zo&&vn==t0&&ko==Uo?(jt[jr]=0,jt[jr+1]=0,jt[jr+2]=0,jt[jr+3]=0):(jt[jr]=Yr,jt[jr+1]=vn,jt[jr+2]=ko,jt[jr+3]=qr);else if(Kt==3){if(qr=wt[or+3],Yr=wt[or],vn=wt[or+1],ko=wt[or+2],Xo=jt[jr+3],zo=jt[jr],t0=jt[jr+1],Uo=jt[jr+2],qr==Xo&&Yr==zo&&vn==t0&&ko==Uo)continue;if(qr<220&&Xo>20)return!1}return!0}return{decode:function($t){const Lt=new Uint8Array($t);let jt=8;const Ft=d,Gt=Ft.readUshort,Ht=Ft.readUint,qt={tabs:{},frames:[]},Kt=new Uint8Array(Lt.length);let rr,ir=0,or=0;const jr=[137,80,78,71,13,10,26,10];for(var qr=0;qr<8;qr++)if(Lt[qr]!=jr[qr])throw"The input is not a PNG file!";for(;jt<Lt.length;){const No=Ft.readUint(Lt,jt);jt+=4;const _n=Ft.readASCII(Lt,jt,4);if(jt+=4,_n=="IHDR")Ct(Lt,jt,qt);else if(_n=="iCCP"){for(var Yr=jt;Lt[Yr]!=0;)Yr++;Ft.readASCII(Lt,jt,Yr-jt),Lt[Yr+1];const Kr=Lt.slice(Yr+2,jt+No);let e0=null;try{e0=et(Kr)}catch{e0=st(Kr)}qt.tabs[_n]=e0}else if(_n=="CgBI")qt.tabs[_n]=Lt.slice(jt,jt+4);else if(_n=="IDAT"){for(qr=0;qr<No;qr++)Kt[ir+qr]=Lt[jt+qr];ir+=No}else if(_n=="acTL")qt.tabs[_n]={num_frames:Ht(Lt,jt),num_plays:Ht(Lt,jt+4)},rr=new Uint8Array(Lt.length);else if(_n=="fcTL"){or!=0&&((Uo=qt.frames[qt.frames.length-1]).data=b(qt,rr.slice(0,or),Uo.rect.width,Uo.rect.height),or=0);const Kr={x:Ht(Lt,jt+12),y:Ht(Lt,jt+16),width:Ht(Lt,jt+4),height:Ht(Lt,jt+8)};let e0=Gt(Lt,jt+22);e0=Gt(Lt,jt+20)/(e0==0?100:e0);const Zr={rect:Kr,delay:Math.round(1e3*e0),dispose:Lt[jt+24],blend:Lt[jt+25]};qt.frames.push(Zr)}else if(_n=="fdAT"){for(qr=0;qr<No-4;qr++)rr[or+qr]=Lt[jt+qr+4];or+=No-4}else if(_n=="pHYs")qt.tabs[_n]=[Ft.readUint(Lt,jt),Ft.readUint(Lt,jt+4),Lt[jt+8]];else if(_n=="cHRM")for(qt.tabs[_n]=[],qr=0;qr<8;qr++)qt.tabs[_n].push(Ft.readUint(Lt,jt+4*qr));else if(_n=="tEXt"||_n=="zTXt"){qt.tabs[_n]==null&&(qt.tabs[_n]={});var vn=Ft.nextZero(Lt,jt),ko=Ft.readASCII(Lt,jt,vn-jt),Xo=jt+No-vn-1;if(_n=="tEXt")t0=Ft.readASCII(Lt,vn+1,Xo);else{var zo=et(Lt.slice(vn+2,vn+2+Xo));t0=Ft.readUTF8(zo,0,zo.length)}qt.tabs[_n][ko]=t0}else if(_n=="iTXt"){qt.tabs[_n]==null&&(qt.tabs[_n]={}),vn=0,Yr=jt,vn=Ft.nextZero(Lt,Yr),ko=Ft.readASCII(Lt,Yr,vn-Yr);const Kr=Lt[Yr=vn+1];var t0;Lt[Yr+1],Yr+=2,vn=Ft.nextZero(Lt,Yr),Ft.readASCII(Lt,Yr,vn-Yr),Yr=vn+1,vn=Ft.nextZero(Lt,Yr),Ft.readUTF8(Lt,Yr,vn-Yr),Xo=No-((Yr=vn+1)-jt),Kr==0?t0=Ft.readUTF8(Lt,Yr,Xo):(zo=et(Lt.slice(Yr,Yr+Xo)),t0=Ft.readUTF8(zo,0,zo.length)),qt.tabs[_n][ko]=t0}else if(_n=="PLTE")qt.tabs[_n]=Ft.readBytes(Lt,jt,No);else if(_n=="hIST"){const Kr=qt.tabs.PLTE.length/3;for(qt.tabs[_n]=[],qr=0;qr<Kr;qr++)qt.tabs[_n].push(Gt(Lt,jt+2*qr))}else if(_n=="tRNS")qt.ctype==3?qt.tabs[_n]=Ft.readBytes(Lt,jt,No):qt.ctype==0?qt.tabs[_n]=Gt(Lt,jt):qt.ctype==2&&(qt.tabs[_n]=[Gt(Lt,jt),Gt(Lt,jt+2),Gt(Lt,jt+4)]);else if(_n=="gAMA")qt.tabs[_n]=Ft.readUint(Lt,jt)/1e5;else if(_n=="sRGB")qt.tabs[_n]=Lt[jt];else if(_n=="bKGD")qt.ctype==0||qt.ctype==4?qt.tabs[_n]=[Gt(Lt,jt)]:qt.ctype==2||qt.ctype==6?qt.tabs[_n]=[Gt(Lt,jt),Gt(Lt,jt+2),Gt(Lt,jt+4)]:qt.ctype==3&&(qt.tabs[_n]=Lt[jt]);else if(_n=="IEND")break;jt+=No,Ft.readUint(Lt,jt),jt+=4}var Uo;return or!=0&&((Uo=qt.frames[qt.frames.length-1]).data=b(qt,rr.slice(0,or),Uo.rect.width,Uo.rect.height)),qt.data=b(qt,Kt,qt.width,qt.height),delete qt.compress,delete qt.interlace,delete qt.filter,qt},toRGBA8:function($t){const Lt=$t.width,jt=$t.height;if($t.tabs.acTL==null)return[g($t.data,Lt,jt,$t).buffer];const Ft=[];$t.frames[0].data==null&&($t.frames[0].data=$t.data);const Gt=Lt*jt*4,Ht=new Uint8Array(Gt),qt=new Uint8Array(Gt),Kt=new Uint8Array(Gt);for(let ir=0;ir<$t.frames.length;ir++){const or=$t.frames[ir],jr=or.rect.x,qr=or.rect.y,Yr=or.rect.width,vn=or.rect.height,ko=g(or.data,Yr,vn,$t);if(ir!=0)for(var rr=0;rr<Gt;rr++)Kt[rr]=Ht[rr];if(or.blend==0?pt(ko,Yr,vn,Ht,Lt,jt,jr,qr,0):or.blend==1&&pt(ko,Yr,vn,Ht,Lt,jt,jr,qr,1),Ft.push(Ht.buffer.slice(0)),or.dispose!=0){if(or.dispose==1)pt(qt,Yr,vn,Ht,Lt,jt,jr,qr,0);else if(or.dispose==2)for(rr=0;rr<Gt;rr++)Ht[rr]=Kt[rr]}}return Ft},_paeth:Tt,_copyTile:pt,_bin:d}}();(function(){const{_copyTile:d}=UPNG,{_bin:g}=UPNG,b=UPNG._paeth;var et={table:function(){const Yr=new Uint32Array(256);for(let vn=0;vn<256;vn++){let ko=vn;for(let Xo=0;Xo<8;Xo++)1&ko?ko=3988292384^ko>>>1:ko>>>=1;Yr[vn]=ko}return Yr}(),update(Yr,vn,ko,Xo){for(let zo=0;zo<Xo;zo++)Yr=et.table[255&(Yr^vn[ko+zo])]^Yr>>>8;return Yr},crc:(Yr,vn,ko)=>4294967295^et.update(4294967295,Yr,vn,ko)};function st(Yr,vn,ko,Xo){vn[ko]+=Yr[0]*Xo>>4,vn[ko+1]+=Yr[1]*Xo>>4,vn[ko+2]+=Yr[2]*Xo>>4,vn[ko+3]+=Yr[3]*Xo>>4}function at(Yr){return Math.max(0,Math.min(255,Yr))}function vt(Yr,vn){const ko=Yr[0]-vn[0],Xo=Yr[1]-vn[1],zo=Yr[2]-vn[2],t0=Yr[3]-vn[3];return ko*ko+Xo*Xo+zo*zo+t0*t0}function Tt(Yr,vn,ko,Xo,zo,t0,Uo){Uo==null&&(Uo=1);const No=Xo.length,_n=[];for(var Kr=0;Kr<No;Kr++){const An=Xo[Kr];_n.push([An>>>0&255,An>>>8&255,An>>>16&255,An>>>24&255])}for(Kr=0;Kr<No;Kr++){let An=4294967295;for(var e0=0,Zr=0;Zr<No;Zr++){var Ro=vt(_n[Kr],_n[Zr]);Zr!=Kr&&Ro<An&&(An=Ro,e0=Zr)}}const Sn=new Uint32Array(zo.buffer),Tn=new Int16Array(vn*ko*4),n0=[0,8,2,10,12,4,14,6,3,11,1,9,15,7,13,5];for(Kr=0;Kr<n0.length;Kr++)n0[Kr]=255*((n0[Kr]+.5)/16-.5);for(let An=0;An<ko;An++)for(let a0=0;a0<vn;a0++){var Go;Kr=4*(An*vn+a0),Uo!=2?Go=[at(Yr[Kr]+Tn[Kr]),at(Yr[Kr+1]+Tn[Kr+1]),at(Yr[Kr+2]+Tn[Kr+2]),at(Yr[Kr+3]+Tn[Kr+3])]:(Ro=n0[4*(3&An)+(3&a0)],Go=[at(Yr[Kr]+Ro),at(Yr[Kr+1]+Ro),at(Yr[Kr+2]+Ro),at(Yr[Kr+3]+Ro)]),e0=0;let u0=16777215;for(Zr=0;Zr<No;Zr++){const y0=vt(Go,_n[Zr]);y0<u0&&(u0=y0,e0=Zr)}const d0=_n[e0],f0=[Go[0]-d0[0],Go[1]-d0[1],Go[2]-d0[2],Go[3]-d0[3]];Uo==1&&(a0!=vn-1&&st(f0,Tn,Kr+4,7),An!=ko-1&&(a0!=0&&st(f0,Tn,Kr+4*vn-4,3),st(f0,Tn,Kr+4*vn,5),a0!=vn-1&&st(f0,Tn,Kr+4*vn+4,1))),t0[Kr>>2]=e0,Sn[Kr>>2]=Xo[e0]}}function Ct(Yr,vn,ko,Xo,zo){zo==null&&(zo={});const{crc:t0}=et,Uo=g.writeUint,No=g.writeUshort,_n=g.writeASCII;let Kr=8;const e0=Yr.frames.length>1;let Zr,Ro=!1,Sn=33+(e0?20:0);if(zo.sRGB!=null&&(Sn+=13),zo.pHYs!=null&&(Sn+=21),zo.iCCP!=null&&(Zr=pako.deflate(zo.iCCP),Sn+=21+Zr.length+4),Yr.ctype==3){for(var Tn=Yr.plte.length,n0=0;n0<Tn;n0++)Yr.plte[n0]>>>24!=255&&(Ro=!0);Sn+=8+3*Tn+4+(Ro?8+1*Tn+4:0)}for(var Go=0;Go<Yr.frames.length;Go++)e0&&(Sn+=38),Sn+=(d0=Yr.frames[Go]).cimg.length+12,Go!=0&&(Sn+=4);Sn+=12;const An=new Uint8Array(Sn),a0=[137,80,78,71,13,10,26,10];for(n0=0;n0<8;n0++)An[n0]=a0[n0];if(Uo(An,Kr,13),Kr+=4,_n(An,Kr,"IHDR"),Kr+=4,Uo(An,Kr,vn),Kr+=4,Uo(An,Kr,ko),Kr+=4,An[Kr]=Yr.depth,Kr++,An[Kr]=Yr.ctype,Kr++,An[Kr]=0,Kr++,An[Kr]=0,Kr++,An[Kr]=0,Kr++,Uo(An,Kr,t0(An,Kr-17,17)),Kr+=4,zo.sRGB!=null&&(Uo(An,Kr,1),Kr+=4,_n(An,Kr,"sRGB"),Kr+=4,An[Kr]=zo.sRGB,Kr++,Uo(An,Kr,t0(An,Kr-5,5)),Kr+=4),zo.iCCP!=null){const f0=13+Zr.length;Uo(An,Kr,f0),Kr+=4,_n(An,Kr,"iCCP"),Kr+=4,_n(An,Kr,"ICC profile"),Kr+=11,Kr+=2,An.set(Zr,Kr),Kr+=Zr.length,Uo(An,Kr,t0(An,Kr-(f0+4),f0+4)),Kr+=4}if(zo.pHYs!=null&&(Uo(An,Kr,9),Kr+=4,_n(An,Kr,"pHYs"),Kr+=4,Uo(An,Kr,zo.pHYs[0]),Kr+=4,Uo(An,Kr,zo.pHYs[1]),Kr+=4,An[Kr]=zo.pHYs[2],Kr++,Uo(An,Kr,t0(An,Kr-13,13)),Kr+=4),e0&&(Uo(An,Kr,8),Kr+=4,_n(An,Kr,"acTL"),Kr+=4,Uo(An,Kr,Yr.frames.length),Kr+=4,Uo(An,Kr,zo.loop!=null?zo.loop:0),Kr+=4,Uo(An,Kr,t0(An,Kr-12,12)),Kr+=4),Yr.ctype==3){for(Uo(An,Kr,3*(Tn=Yr.plte.length)),Kr+=4,_n(An,Kr,"PLTE"),Kr+=4,n0=0;n0<Tn;n0++){const f0=3*n0,y0=Yr.plte[n0],b0=255&y0,O0=y0>>>8&255,C0=y0>>>16&255;An[Kr+f0+0]=b0,An[Kr+f0+1]=O0,An[Kr+f0+2]=C0}if(Kr+=3*Tn,Uo(An,Kr,t0(An,Kr-3*Tn-4,3*Tn+4)),Kr+=4,Ro){for(Uo(An,Kr,Tn),Kr+=4,_n(An,Kr,"tRNS"),Kr+=4,n0=0;n0<Tn;n0++)An[Kr+n0]=Yr.plte[n0]>>>24&255;Kr+=Tn,Uo(An,Kr,t0(An,Kr-Tn-4,Tn+4)),Kr+=4}}let u0=0;for(Go=0;Go<Yr.frames.length;Go++){var d0=Yr.frames[Go];e0&&(Uo(An,Kr,26),Kr+=4,_n(An,Kr,"fcTL"),Kr+=4,Uo(An,Kr,u0++),Kr+=4,Uo(An,Kr,d0.rect.width),Kr+=4,Uo(An,Kr,d0.rect.height),Kr+=4,Uo(An,Kr,d0.rect.x),Kr+=4,Uo(An,Kr,d0.rect.y),Kr+=4,No(An,Kr,Xo[Go]),Kr+=2,No(An,Kr,1e3),Kr+=2,An[Kr]=d0.dispose,Kr++,An[Kr]=d0.blend,Kr++,Uo(An,Kr,t0(An,Kr-30,30)),Kr+=4);const f0=d0.cimg;Uo(An,Kr,(Tn=f0.length)+(Go==0?0:4)),Kr+=4;const y0=Kr;_n(An,Kr,Go==0?"IDAT":"fdAT"),Kr+=4,Go!=0&&(Uo(An,Kr,u0++),Kr+=4),An.set(f0,Kr),Kr+=Tn,Uo(An,Kr,t0(An,y0,Kr-y0)),Kr+=4}return Uo(An,Kr,0),Kr+=4,_n(An,Kr,"IEND"),Kr+=4,Uo(An,Kr,t0(An,Kr-4,4)),Kr+=4,An.buffer}function pt(Yr,vn,ko){for(let Xo=0;Xo<Yr.frames.length;Xo++){const zo=Yr.frames[Xo];zo.rect.width;const t0=zo.rect.height,Uo=new Uint8Array(t0*zo.bpl+t0);zo.cimg=jt(zo.img,t0,zo.bpp,zo.bpl,Uo,vn,ko)}}function wt(Yr,vn,ko,Xo,zo){const t0=zo[0],Uo=zo[1],No=zo[2],_n=zo[3],Kr=zo[4],e0=zo[5];let Zr=6,Ro=8,Sn=255;for(var Tn=0;Tn<Yr.length;Tn++){const N0=new Uint8Array(Yr[Tn]);for(var n0=N0.length,Go=0;Go<n0;Go+=4)Sn&=N0[Go+3]}const An=Sn!=255,a0=function(w0,r0,p0,$0,A0,g0){const E0=[];for(var F0=0;F0<w0.length;F0++){const P1=new Uint8Array(w0[F0]),i1=new Uint32Array(P1.buffer);var K0;let v1=0,_1=0,X1=r0,t1=p0,cv=$0?1:0;if(F0!=0){const S1=g0||$0||F0==1||E0[F0-2].dispose!=0?1:2;let ev=0,c0=1e9;for(let P0=0;P0<S1;P0++){var l1=new Uint8Array(w0[F0-1-P0]);const R0=new Uint32Array(w0[F0-1-P0]);let B0=r0,W0=p0,s1=-1,E1=-1;for(let K1=0;K1<p0;K1++)for(let W1=0;W1<r0;W1++)i1[x1=K1*r0+W1]!=R0[x1]&&(W1<B0&&(B0=W1),W1>s1&&(s1=W1),K1<W0&&(W0=K1),K1>E1&&(E1=K1));s1==-1&&(B0=W0=s1=E1=0),A0&&((1&B0)==1&&B0--,(1&W0)==1&&W0--);const Q1=(s1-B0+1)*(E1-W0+1);Q1<c0&&(c0=Q1,ev=P0,v1=B0,_1=W0,X1=s1-B0+1,t1=E1-W0+1)}l1=new Uint8Array(w0[F0-1-ev]),ev==1&&(E0[F0-1].dispose=2),K0=new Uint8Array(X1*t1*4),d(l1,r0,p0,K0,X1,t1,-v1,-_1,0),cv=d(P1,r0,p0,K0,X1,t1,-v1,-_1,3)?1:0,cv==1?Lt(P1,r0,p0,K0,{x:v1,y:_1,width:X1,height:t1}):d(P1,r0,p0,K0,X1,t1,-v1,-_1,0)}else K0=P1.slice(0);E0.push({rect:{x:v1,y:_1,width:X1,height:t1},img:K0,blend:cv,dispose:0})}if($0)for(F0=0;F0<E0.length;F0++){if((u1=E0[F0]).blend==1)continue;const P1=u1.rect,i1=E0[F0-1].rect,v1=Math.min(P1.x,i1.x),_1=Math.min(P1.y,i1.y),X1={x:v1,y:_1,width:Math.max(P1.x+P1.width,i1.x+i1.width)-v1,height:Math.max(P1.y+P1.height,i1.y+i1.height)-_1};E0[F0-1].dispose=1,F0-1!=0&&$t(w0,r0,p0,E0,F0-1,X1,A0),$t(w0,r0,p0,E0,F0,X1,A0)}let n1=0;if(w0.length!=1)for(var x1=0;x1<E0.length;x1++){var u1;n1+=(u1=E0[x1]).rect.width*u1.rect.height}return E0}(Yr,vn,ko,t0,Uo,No),u0={},d0=[],f0=[];if(Xo!=0){const N0=[];for(Go=0;Go<a0.length;Go++)N0.push(a0[Go].img.buffer);const w0=function(A0){let g0=0;for(var E0=0;E0<A0.length;E0++)g0+=A0[E0].byteLength;const F0=new Uint8Array(g0);let K0=0;for(E0=0;E0<A0.length;E0++){const l1=new Uint8Array(A0[E0]),n1=l1.length;for(let x1=0;x1<n1;x1+=4){let u1=l1[x1],P1=l1[x1+1],i1=l1[x1+2];const v1=l1[x1+3];v1==0&&(u1=P1=i1=0),F0[K0+x1]=u1,F0[K0+x1+1]=P1,F0[K0+x1+2]=i1,F0[K0+x1+3]=v1}K0+=n1}return F0.buffer}(N0),r0=Gt(w0,Xo);for(Go=0;Go<r0.plte.length;Go++)d0.push(r0.plte[Go].est.rgba);let p0=0;for(Go=0;Go<a0.length;Go++){const $0=(b0=a0[Go]).img.length;var y0=new Uint8Array(r0.inds.buffer,p0>>2,$0>>2);f0.push(y0);const A0=new Uint8Array(r0.abuf,p0,$0);e0&&Tt(b0.img,b0.rect.width,b0.rect.height,d0,A0,y0),b0.img.set(A0),p0+=$0}}else for(Tn=0;Tn<a0.length;Tn++){var b0=a0[Tn];const N0=new Uint32Array(b0.img.buffer);var O0=b0.rect.width;for(n0=N0.length,y0=new Uint8Array(n0),f0.push(y0),Go=0;Go<n0;Go++){const w0=N0[Go];if(Go!=0&&w0==N0[Go-1])y0[Go]=y0[Go-1];else if(Go>O0&&w0==N0[Go-O0])y0[Go]=y0[Go-O0];else{let r0=u0[w0];if(r0==null&&(u0[w0]=r0=d0.length,d0.push(w0),d0.length>=300))break;y0[Go]=r0}}}const C0=d0.length;for(C0<=256&&Kr==0&&(Ro=C0<=2?1:C0<=4?2:C0<=16?4:8,Ro=Math.max(Ro,_n)),Tn=0;Tn<a0.length;Tn++){(b0=a0[Tn]).rect.x,b0.rect.y,O0=b0.rect.width;const N0=b0.rect.height;let w0=b0.img;new Uint32Array(w0.buffer);let r0=4*O0,p0=4;if(C0<=256&&Kr==0){r0=Math.ceil(Ro*O0/8);var v0=new Uint8Array(r0*N0);const $0=f0[Tn];for(let A0=0;A0<N0;A0++){Go=A0*r0;const g0=A0*O0;if(Ro==8)for(var k0=0;k0<O0;k0++)v0[Go+k0]=$0[g0+k0];else if(Ro==4)for(k0=0;k0<O0;k0++)v0[Go+(k0>>1)]|=$0[g0+k0]<<4-4*(1&k0);else if(Ro==2)for(k0=0;k0<O0;k0++)v0[Go+(k0>>2)]|=$0[g0+k0]<<6-2*(3&k0);else if(Ro==1)for(k0=0;k0<O0;k0++)v0[Go+(k0>>3)]|=$0[g0+k0]<<7-1*(7&k0)}w0=v0,Zr=3,p0=1}else if(An==0&&a0.length==1){v0=new Uint8Array(O0*N0*3);const $0=O0*N0;for(Go=0;Go<$0;Go++){const A0=3*Go,g0=4*Go;v0[A0]=w0[g0],v0[A0+1]=w0[g0+1],v0[A0+2]=w0[g0+2]}w0=v0,Zr=2,p0=3,r0=3*O0}b0.img=w0,b0.bpl=r0,b0.bpp=p0}return{ctype:Zr,depth:Ro,plte:d0,frames:a0}}function $t(Yr,vn,ko,Xo,zo,t0,Uo){const No=Uint8Array,_n=Uint32Array,Kr=new No(Yr[zo-1]),e0=new _n(Yr[zo-1]),Zr=zo+1<Yr.length?new No(Yr[zo+1]):null,Ro=new No(Yr[zo]),Sn=new _n(Ro.buffer);let Tn=vn,n0=ko,Go=-1,An=-1;for(let u0=0;u0<t0.height;u0++)for(let d0=0;d0<t0.width;d0++){const f0=t0.x+d0,y0=t0.y+u0,b0=y0*vn+f0,O0=Sn[b0];O0==0||Xo[zo-1].dispose==0&&e0[b0]==O0&&(Zr==null||Zr[4*b0+3]!=0)||(f0<Tn&&(Tn=f0),f0>Go&&(Go=f0),y0<n0&&(n0=y0),y0>An&&(An=y0))}Go==-1&&(Tn=n0=Go=An=0),Uo&&((1&Tn)==1&&Tn--,(1&n0)==1&&n0--),t0={x:Tn,y:n0,width:Go-Tn+1,height:An-n0+1};const a0=Xo[zo];a0.rect=t0,a0.blend=1,a0.img=new Uint8Array(t0.width*t0.height*4),Xo[zo-1].dispose==0?(d(Kr,vn,ko,a0.img,t0.width,t0.height,-t0.x,-t0.y,0),Lt(Ro,vn,ko,a0.img,t0)):d(Ro,vn,ko,a0.img,t0.width,t0.height,-t0.x,-t0.y,0)}function Lt(Yr,vn,ko,Xo,zo){d(Yr,vn,ko,Xo,zo.width,zo.height,-zo.x,-zo.y,2)}function jt(Yr,vn,ko,Xo,zo,t0,Uo){const No=[];let _n,Kr=[0,1,2,3,4];t0!=-1?Kr=[t0]:(vn*Xo>5e5||ko==1)&&(Kr=[0]),Uo&&(_n={level:0});const e0=UZIP;for(var Zr=0;Zr<Kr.length;Zr++){for(let Tn=0;Tn<vn;Tn++)Ft(zo,Yr,Tn,Xo,ko,Kr[Zr]);No.push(e0.deflate(zo,_n))}let Ro,Sn=1e9;for(Zr=0;Zr<No.length;Zr++)No[Zr].length<Sn&&(Ro=Zr,Sn=No[Zr].length);return No[Ro]}function Ft(Yr,vn,ko,Xo,zo,t0){const Uo=ko*Xo;let No=Uo+ko;if(Yr[No]=t0,No++,t0==0)if(Xo<500)for(var _n=0;_n<Xo;_n++)Yr[No+_n]=vn[Uo+_n];else Yr.set(new Uint8Array(vn.buffer,Uo,Xo),No);else if(t0==1){for(_n=0;_n<zo;_n++)Yr[No+_n]=vn[Uo+_n];for(_n=zo;_n<Xo;_n++)Yr[No+_n]=vn[Uo+_n]-vn[Uo+_n-zo]+256&255}else if(ko==0){for(_n=0;_n<zo;_n++)Yr[No+_n]=vn[Uo+_n];if(t0==2)for(_n=zo;_n<Xo;_n++)Yr[No+_n]=vn[Uo+_n];if(t0==3)for(_n=zo;_n<Xo;_n++)Yr[No+_n]=vn[Uo+_n]-(vn[Uo+_n-zo]>>1)+256&255;if(t0==4)for(_n=zo;_n<Xo;_n++)Yr[No+_n]=vn[Uo+_n]-b(vn[Uo+_n-zo],0,0)+256&255}else{if(t0==2)for(_n=0;_n<Xo;_n++)Yr[No+_n]=vn[Uo+_n]+256-vn[Uo+_n-Xo]&255;if(t0==3){for(_n=0;_n<zo;_n++)Yr[No+_n]=vn[Uo+_n]+256-(vn[Uo+_n-Xo]>>1)&255;for(_n=zo;_n<Xo;_n++)Yr[No+_n]=vn[Uo+_n]+256-(vn[Uo+_n-Xo]+vn[Uo+_n-zo]>>1)&255}if(t0==4){for(_n=0;_n<zo;_n++)Yr[No+_n]=vn[Uo+_n]+256-b(0,vn[Uo+_n-Xo],0)&255;for(_n=zo;_n<Xo;_n++)Yr[No+_n]=vn[Uo+_n]+256-b(vn[Uo+_n-zo],vn[Uo+_n-Xo],vn[Uo+_n-zo-Xo])&255}}}function Gt(Yr,vn){const ko=new Uint8Array(Yr),Xo=ko.slice(0),zo=new Uint32Array(Xo.buffer),t0=Ht(Xo,vn),Uo=t0[0],No=t0[1],_n=ko.length,Kr=new Uint8Array(_n>>2);let e0;if(ko.length<2e7)for(var Zr=0;Zr<_n;Zr+=4)e0=qt(Uo,Ro=ko[Zr]*(1/255),Sn=ko[Zr+1]*(1/255),Tn=ko[Zr+2]*(1/255),n0=ko[Zr+3]*(1/255)),Kr[Zr>>2]=e0.ind,zo[Zr>>2]=e0.est.rgba;else for(Zr=0;Zr<_n;Zr+=4){var Ro=ko[Zr]*.00392156862745098,Sn=ko[Zr+1]*(1/255),Tn=ko[Zr+2]*(1/255),n0=ko[Zr+3]*(1/255);for(e0=Uo;e0.left;)e0=Kt(e0.est,Ro,Sn,Tn,n0)<=0?e0.left:e0.right;Kr[Zr>>2]=e0.ind,zo[Zr>>2]=e0.est.rgba}return{abuf:Xo.buffer,inds:Kr,plte:No}}function Ht(Yr,vn,ko){ko==null&&(ko=1e-4);const Xo=new Uint32Array(Yr.buffer),zo={i0:0,i1:Yr.length,bst:null,est:null,tdst:0,left:null,right:null};zo.bst=or(Yr,zo.i0,zo.i1),zo.est=jr(zo.bst);const t0=[zo];for(;t0.length<vn;){let No=0,_n=0;for(var Uo=0;Uo<t0.length;Uo++)t0[Uo].est.L>No&&(No=t0[Uo].est.L,_n=Uo);if(No<ko)break;const Kr=t0[_n],e0=rr(Yr,Xo,Kr.i0,Kr.i1,Kr.est.e,Kr.est.eMq255);if(Kr.i0>=e0||Kr.i1<=e0){Kr.est.L=0;continue}const Zr={i0:Kr.i0,i1:e0,bst:null,est:null,tdst:0,left:null,right:null};Zr.bst=or(Yr,Zr.i0,Zr.i1),Zr.est=jr(Zr.bst);const Ro={i0:e0,i1:Kr.i1,bst:null,est:null,tdst:0,left:null,right:null};for(Ro.bst={R:[],m:[],N:Kr.bst.N-Zr.bst.N},Uo=0;Uo<16;Uo++)Ro.bst.R[Uo]=Kr.bst.R[Uo]-Zr.bst.R[Uo];for(Uo=0;Uo<4;Uo++)Ro.bst.m[Uo]=Kr.bst.m[Uo]-Zr.bst.m[Uo];Ro.est=jr(Ro.bst),Kr.left=Zr,Kr.right=Ro,t0[_n]=Zr,t0.push(Ro)}for(t0.sort((No,_n)=>_n.bst.N-No.bst.N),Uo=0;Uo<t0.length;Uo++)t0[Uo].ind=Uo;return[zo,t0]}function qt(Yr,vn,ko,Xo,zo){if(Yr.left==null)return Yr.tdst=function(Zr,Ro,Sn,Tn,n0){const Go=Ro-Zr[0],An=Sn-Zr[1],a0=Tn-Zr[2],u0=n0-Zr[3];return Go*Go+An*An+a0*a0+u0*u0}(Yr.est.q,vn,ko,Xo,zo),Yr;const t0=Kt(Yr.est,vn,ko,Xo,zo);let Uo=Yr.left,No=Yr.right;t0>0&&(Uo=Yr.right,No=Yr.left);const _n=qt(Uo,vn,ko,Xo,zo);if(_n.tdst<=t0*t0)return _n;const Kr=qt(No,vn,ko,Xo,zo);return Kr.tdst<_n.tdst?Kr:_n}function Kt(Yr,vn,ko,Xo,zo){const{e:t0}=Yr;return t0[0]*vn+t0[1]*ko+t0[2]*Xo+t0[3]*zo-Yr.eMq}function rr(Yr,vn,ko,Xo,zo,t0){for(Xo-=4;ko<Xo;){for(;ir(Yr,ko,zo)<=t0;)ko+=4;for(;ir(Yr,Xo,zo)>t0;)Xo-=4;if(ko>=Xo)break;const Uo=vn[ko>>2];vn[ko>>2]=vn[Xo>>2],vn[Xo>>2]=Uo,ko+=4,Xo-=4}for(;ir(Yr,ko,zo)>t0;)ko-=4;return ko+4}function ir(Yr,vn,ko){return Yr[vn]*ko[0]+Yr[vn+1]*ko[1]+Yr[vn+2]*ko[2]+Yr[vn+3]*ko[3]}function or(Yr,vn,ko){const Xo=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],zo=[0,0,0,0],t0=ko-vn>>2;for(let Uo=vn;Uo<ko;Uo+=4){const No=Yr[Uo]*.00392156862745098,_n=Yr[Uo+1]*(1/255),Kr=Yr[Uo+2]*(1/255),e0=Yr[Uo+3]*(1/255);zo[0]+=No,zo[1]+=_n,zo[2]+=Kr,zo[3]+=e0,Xo[0]+=No*No,Xo[1]+=No*_n,Xo[2]+=No*Kr,Xo[3]+=No*e0,Xo[5]+=_n*_n,Xo[6]+=_n*Kr,Xo[7]+=_n*e0,Xo[10]+=Kr*Kr,Xo[11]+=Kr*e0,Xo[15]+=e0*e0}return Xo[4]=Xo[1],Xo[8]=Xo[2],Xo[9]=Xo[6],Xo[12]=Xo[3],Xo[13]=Xo[7],Xo[14]=Xo[11],{R:Xo,m:zo,N:t0}}function jr(Yr){const{R:vn}=Yr,{m:ko}=Yr,{N:Xo}=Yr,zo=ko[0],t0=ko[1],Uo=ko[2],No=ko[3],_n=Xo==0?0:1/Xo,Kr=[vn[0]-zo*zo*_n,vn[1]-zo*t0*_n,vn[2]-zo*Uo*_n,vn[3]-zo*No*_n,vn[4]-t0*zo*_n,vn[5]-t0*t0*_n,vn[6]-t0*Uo*_n,vn[7]-t0*No*_n,vn[8]-Uo*zo*_n,vn[9]-Uo*t0*_n,vn[10]-Uo*Uo*_n,vn[11]-Uo*No*_n,vn[12]-No*zo*_n,vn[13]-No*t0*_n,vn[14]-No*Uo*_n,vn[15]-No*No*_n],e0=Kr,Zr=qr;let Ro=[Math.random(),Math.random(),Math.random(),Math.random()],Sn=0,Tn=0;if(Xo!=0)for(let Go=0;Go<16&&(Ro=Zr.multVec(e0,Ro),Tn=Math.sqrt(Zr.dot(Ro,Ro)),Ro=Zr.sml(1/Tn,Ro),!(Go!=0&&Math.abs(Tn-Sn)<1e-9));Go++)Sn=Tn;const n0=[zo*_n,t0*_n,Uo*_n,No*_n];return{Cov:Kr,q:n0,e:Ro,L:Sn,eMq255:Zr.dot(Zr.sml(255,n0),Ro),eMq:Zr.dot(Ro,n0),rgba:(Math.round(255*n0[3])<<24|Math.round(255*n0[2])<<16|Math.round(255*n0[1])<<8|Math.round(255*n0[0])<<0)>>>0}}var qr={multVec:(Yr,vn)=>[Yr[0]*vn[0]+Yr[1]*vn[1]+Yr[2]*vn[2]+Yr[3]*vn[3],Yr[4]*vn[0]+Yr[5]*vn[1]+Yr[6]*vn[2]+Yr[7]*vn[3],Yr[8]*vn[0]+Yr[9]*vn[1]+Yr[10]*vn[2]+Yr[11]*vn[3],Yr[12]*vn[0]+Yr[13]*vn[1]+Yr[14]*vn[2]+Yr[15]*vn[3]],dot:(Yr,vn)=>Yr[0]*vn[0]+Yr[1]*vn[1]+Yr[2]*vn[2]+Yr[3]*vn[3],sml:(Yr,vn)=>[Yr*vn[0],Yr*vn[1],Yr*vn[2],Yr*vn[3]]};UPNG.encode=function(vn,ko,Xo,zo,t0,Uo,No){zo==null&&(zo=0),No==null&&(No=!1);const _n=wt(vn,ko,Xo,zo,[!1,!1,!1,0,No,!1]);return pt(_n,-1),Ct(_n,ko,Xo,t0,Uo)},UPNG.encodeLL=function(vn,ko,Xo,zo,t0,Uo,No,_n){const Kr={ctype:0+(zo==1?0:2)+(t0==0?0:4),depth:Uo,frames:[]},e0=(zo+t0)*Uo,Zr=e0*ko;for(let Ro=0;Ro<vn.length;Ro++)Kr.frames.push({rect:{x:0,y:0,width:ko,height:Xo},img:new Uint8Array(vn[Ro]),blend:0,dispose:1,bpp:Math.ceil(e0/8),bpl:Math.ceil(Zr/8)});return pt(Kr,0,!0),Ct(Kr,ko,Xo,No,_n)},UPNG.encode.compress=wt,UPNG.encode.dither=Tt,UPNG.quantize=Gt,UPNG.quantize.getKDtree=Ht,UPNG.quantize.getNearest=qt})();const r={toArrayBuffer(d,g){const b=d.width,et=d.height,st=b<<2,at=d.getContext("2d").getImageData(0,0,b,et),vt=new Uint32Array(at.data.buffer),Tt=(32*b+31)/32<<2,Ct=Tt*et,pt=122+Ct,wt=new ArrayBuffer(pt),$t=new DataView(wt),Lt=1<<20;let jt,Ft,Gt,Ht,qt=Lt,Kt=0,rr=0,ir=0;function or(Yr){$t.setUint16(rr,Yr,!0),rr+=2}function jr(Yr){$t.setUint32(rr,Yr,!0),rr+=4}function qr(Yr){rr+=Yr}or(19778),jr(pt),qr(4),jr(122),jr(108),jr(b),jr(-et>>>0),or(1),or(32),jr(3),jr(Ct),jr(2835),jr(2835),qr(8),jr(16711680),jr(65280),jr(255),jr(4278190080),jr(1466527264),function Yr(){for(;Kt<et&&qt>0;){for(Ht=122+Kt*Tt,jt=0;jt<st;)qt--,Ft=vt[ir++],Gt=Ft>>>24,$t.setUint32(Ht+jt,Ft<<8|Gt),jt+=4;Kt++}ir<vt.length?(qt=Lt,setTimeout(Yr,r._dly)):g(wt)}()},toBlob(d,g){this.toArrayBuffer(d,b=>{g(new Blob([b],{type:"image/bmp"}))})},_dly:9};var i={CHROME:"CHROME",FIREFOX:"FIREFOX",DESKTOP_SAFARI:"DESKTOP_SAFARI",IE:"IE",IOS:"IOS",ETC:"ETC"},o={[i.CHROME]:16384,[i.FIREFOX]:11180,[i.DESKTOP_SAFARI]:16384,[i.IE]:8192,[i.IOS]:4096,[i.ETC]:8192};const a=typeof window<"u",s=typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope,f=a&&window.cordova&&window.cordova.require&&window.cordova.require("cordova/modulemapper"),CustomFile=(a||s)&&(f&&f.getOriginalSymbol(window,"File")||typeof File<"u"&&File),CustomFileReader=(a||s)&&(f&&f.getOriginalSymbol(window,"FileReader")||typeof FileReader<"u"&&FileReader);function getFilefromDataUrl(d,g,b=Date.now()){return new Promise(et=>{const st=d.split(","),at=st[0].match(/:(.*?);/)[1],vt=globalThis.atob(st[1]);let Tt=vt.length;const Ct=new Uint8Array(Tt);for(;Tt--;)Ct[Tt]=vt.charCodeAt(Tt);const pt=new Blob([Ct],{type:at});pt.name=g,pt.lastModified=b,et(pt)})}function getDataUrlFromFile(d){return new Promise((g,b)=>{const et=new CustomFileReader;et.onload=()=>g(et.result),et.onerror=st=>b(st),et.readAsDataURL(d)})}function loadImage(d){return new Promise((g,b)=>{const et=new Image;et.onload=()=>g(et),et.onerror=st=>b(st),et.src=d})}function getBrowserName(){if(getBrowserName.cachedResult!==void 0)return getBrowserName.cachedResult;let d=i.ETC;const{userAgent:g}=navigator;return/Chrom(e|ium)/i.test(g)?d=i.CHROME:/iP(ad|od|hone)/i.test(g)&&/WebKit/i.test(g)?d=i.IOS:/Safari/i.test(g)?d=i.DESKTOP_SAFARI:/Firefox/i.test(g)?d=i.FIREFOX:(/MSIE/i.test(g)||document.documentMode)&&(d=i.IE),getBrowserName.cachedResult=d,getBrowserName.cachedResult}function approximateBelowMaximumCanvasSizeOfBrowser(d,g){const b=getBrowserName(),et=o[b];let st=d,at=g,vt=st*at;const Tt=st>at?at/st:st/at;for(;vt>et*et;){const Ct=(et+st)/2,pt=(et+at)/2;Ct<pt?(at=pt,st=pt*Tt):(at=Ct*Tt,st=Ct),vt=st*at}return{width:st,height:at}}function getNewCanvasAndCtx(d,g){let b,et;try{if(b=new OffscreenCanvas(d,g),et=b.getContext("2d"),et===null)throw new Error("getContext of OffscreenCanvas returns null")}catch{b=document.createElement("canvas"),et=b.getContext("2d")}return b.width=d,b.height=g,[b,et]}function drawImageInCanvas(d,g){const{width:b,height:et}=approximateBelowMaximumCanvasSizeOfBrowser(d.width,d.height),[st,at]=getNewCanvasAndCtx(b,et);return g&&/jpe?g/.test(g)&&(at.fillStyle="white",at.fillRect(0,0,st.width,st.height)),at.drawImage(d,0,0,st.width,st.height),st}function isIOS(){return isIOS.cachedResult!==void 0||(isIOS.cachedResult=["iPad Simulator","iPhone Simulator","iPod Simulator","iPad","iPhone","iPod"].includes(navigator.platform)||navigator.userAgent.includes("Mac")&&typeof document<"u"&&"ontouchend"in document),isIOS.cachedResult}function drawFileInCanvas(d,g={}){return new Promise(function(b,et){let st,at;var vt=function(){try{return at=drawImageInCanvas(st,g.fileType||d.type),b([st,at])}catch(Ct){return et(Ct)}},Tt=function(Ct){try{var pt=function(wt){try{throw wt}catch($t){return et($t)}};try{let wt;return getDataUrlFromFile(d).then(function($t){try{return wt=$t,loadImage(wt).then(function(Lt){try{return st=Lt,function(){try{return vt()}catch(jt){return et(jt)}}()}catch(jt){return pt(jt)}},pt)}catch(Lt){return pt(Lt)}},pt)}catch(wt){pt(wt)}}catch(wt){return et(wt)}};try{if(isIOS()||[i.DESKTOP_SAFARI,i.MOBILE_SAFARI].includes(getBrowserName()))throw new Error("Skip createImageBitmap on IOS and Safari");return createImageBitmap(d).then(function(Ct){try{return st=Ct,vt()}catch{return Tt()}},Tt)}catch{Tt()}})}function canvasToFile(d,g,b,et,st=1){return new Promise(function(at,vt){let Tt;if(g==="image/png"){let $t,Lt,jt;return $t=d.getContext("2d"),{data:Lt}=$t.getImageData(0,0,d.width,d.height),jt=UPNG.encode([Lt.buffer],d.width,d.height,4096*st),Tt=new Blob([jt],{type:g}),Tt.name=b,Tt.lastModified=et,Ct.call(this)}{let $t=function(){return Ct.call(this)};var pt=$t;if(g==="image/bmp")return new Promise(Lt=>r.toBlob(d,Lt)).then((function(Lt){try{return Tt=Lt,Tt.name=b,Tt.lastModified=et,$t.call(this)}catch(jt){return vt(jt)}}).bind(this),vt);{let Lt=function(){return $t.call(this)};var wt=Lt;if(typeof OffscreenCanvas=="function"&&d instanceof OffscreenCanvas)return d.convertToBlob({type:g,quality:st}).then((function(jt){try{return Tt=jt,Tt.name=b,Tt.lastModified=et,Lt.call(this)}catch(Ft){return vt(Ft)}}).bind(this),vt);{let jt;return jt=d.toDataURL(g,st),getFilefromDataUrl(jt,b,et).then((function(Ft){try{return Tt=Ft,Lt.call(this)}catch(Gt){return vt(Gt)}}).bind(this),vt)}}}function Ct(){return at(Tt)}})}function cleanupCanvasMemory(d){d.width=0,d.height=0}function isAutoOrientationInBrowser(){return new Promise(function(d,g){let b,et,st,at;return isAutoOrientationInBrowser.cachedResult!==void 0?d(isAutoOrientationInBrowser.cachedResult):getFilefromDataUrl("data:image/jpeg;base64,/9j/4QAiRXhpZgAATU0AKgAAAAgAAQESAAMAAAABAAYAAAAAAAD/2wCEAAEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAf/AABEIAAEAAgMBEQACEQEDEQH/xABKAAEAAAAAAAAAAAAAAAAAAAALEAEAAAAAAAAAAAAAAAAAAAAAAQEAAAAAAAAAAAAAAAAAAAAAEQEAAAAAAAAAAAAAAAAAAAAA/9oADAMBAAIRAxEAPwA/8H//2Q==","test.jpg",Date.now()).then(function(vt){try{return b=vt,drawFileInCanvas(b).then(function(Tt){try{return et=Tt[1],canvasToFile(et,b.type,b.name,b.lastModified).then(function(Ct){try{return st=Ct,cleanupCanvasMemory(et),drawFileInCanvas(st).then(function(pt){try{return at=pt[0],isAutoOrientationInBrowser.cachedResult=at.width===1&&at.height===2,d(isAutoOrientationInBrowser.cachedResult)}catch(wt){return g(wt)}},g)}catch(pt){return g(pt)}},g)}catch(Ct){return g(Ct)}},g)}catch(Tt){return g(Tt)}},g)})}function getExifOrientation(d){return new Promise((g,b)=>{const et=new CustomFileReader;et.onload=st=>{const at=new DataView(st.target.result);if(at.getUint16(0,!1)!=65496)return g(-2);const vt=at.byteLength;let Tt=2;for(;Tt<vt;){if(at.getUint16(Tt+2,!1)<=8)return g(-1);const Ct=at.getUint16(Tt,!1);if(Tt+=2,Ct==65505){if(at.getUint32(Tt+=2,!1)!=1165519206)return g(-1);const pt=at.getUint16(Tt+=6,!1)==18761;Tt+=at.getUint32(Tt+4,pt);const wt=at.getUint16(Tt,pt);Tt+=2;for(let $t=0;$t<wt;$t++)if(at.getUint16(Tt+12*$t,pt)==274)return g(at.getUint16(Tt+12*$t+8,pt))}else{if((65280&Ct)!=65280)break;Tt+=at.getUint16(Tt,!1)}}return g(-1)},et.onerror=st=>b(st),et.readAsArrayBuffer(d)})}function handleMaxWidthOrHeight(d,g){const{width:b}=d,{height:et}=d,{maxWidthOrHeight:st}=g;let at,vt=d;return isFinite(st)&&(b>st||et>st)&&([vt,at]=getNewCanvasAndCtx(b,et),b>et?(vt.width=st,vt.height=et/b*st):(vt.width=b/et*st,vt.height=st),at.drawImage(d,0,0,vt.width,vt.height),cleanupCanvasMemory(d)),vt}function followExifOrientation(d,g){const{width:b}=d,{height:et}=d,[st,at]=getNewCanvasAndCtx(b,et);switch(g>4&&g<9?(st.width=et,st.height=b):(st.width=b,st.height=et),g){case 2:at.transform(-1,0,0,1,b,0);break;case 3:at.transform(-1,0,0,-1,b,et);break;case 4:at.transform(1,0,0,-1,0,et);break;case 5:at.transform(0,1,1,0,0,0);break;case 6:at.transform(0,1,-1,0,et,0);break;case 7:at.transform(0,-1,-1,0,et,b);break;case 8:at.transform(0,-1,1,0,0,b)}return at.drawImage(d,0,0,b,et),cleanupCanvasMemory(d),st}function compress(d,g,b=0){return new Promise(function(et,st){let at,vt,Tt,Ct,pt,wt,$t,Lt,jt,Ft,Gt,Ht,qt,Kt,rr,ir,or,jr,qr,Yr;function vn(Xo=5){if(g.signal&&g.signal.aborted)throw g.signal.reason;at+=Xo,g.onProgress(Math.min(at,100))}function ko(Xo){if(g.signal&&g.signal.aborted)throw g.signal.reason;at=Math.min(Math.max(Xo,at),100),g.onProgress(at)}return at=b,vt=g.maxIteration||10,Tt=1024*g.maxSizeMB*1024,vn(),drawFileInCanvas(d,g).then((function(Xo){try{return[,Ct]=Xo,vn(),pt=handleMaxWidthOrHeight(Ct,g),vn(),new Promise(function(zo,t0){var Uo;if(!(Uo=g.exifOrientation))return getExifOrientation(d).then((function(_n){try{return Uo=_n,No.call(this)}catch(Kr){return t0(Kr)}}).bind(this),t0);function No(){return zo(Uo)}return No.call(this)}).then((function(zo){try{return wt=zo,vn(),isAutoOrientationInBrowser().then((function(t0){try{return $t=t0?pt:followExifOrientation(pt,wt),vn(),Lt=g.initialQuality||1,jt=g.fileType||d.type,canvasToFile($t,jt,d.name,d.lastModified,Lt).then((function(Uo){try{{let e0=function(){if(vt--&&(rr>Tt||rr>qt)){let Ro,Sn;return Ro=Yr?.95*qr.width:qr.width,Sn=Yr?.95*qr.height:qr.height,[or,jr]=getNewCanvasAndCtx(Ro,Sn),jr.drawImage(qr,0,0,Ro,Sn),Lt*=jt==="image/png"?.85:.95,canvasToFile(or,jt,d.name,d.lastModified,Lt).then(function(Tn){try{return ir=Tn,cleanupCanvasMemory(qr),qr=or,rr=ir.size,ko(Math.min(99,Math.floor((Kt-rr)/(Kt-Tt)*100))),e0}catch(n0){return st(n0)}},st)}return[1]},Zr=function(){return cleanupCanvasMemory(qr),cleanupCanvasMemory(or),cleanupCanvasMemory(pt),cleanupCanvasMemory($t),cleanupCanvasMemory(Ct),ko(100),et(ir)};var _n=e0,Kr=Zr;if(Ft=Uo,vn(),Gt=Ft.size>Tt,Ht=Ft.size>d.size,!Gt&&!Ht)return ko(100),et(Ft);var No;return qt=d.size,Kt=Ft.size,rr=Kt,qr=$t,Yr=!g.alwaysKeepResolution&&Gt,(No=(function(Ro){for(;Ro;){if(Ro.then)return void Ro.then(No,st);try{if(Ro.pop){if(Ro.length)return Ro.pop()?Zr.call(this):Ro;Ro=e0}else Ro=Ro.call(this)}catch(Sn){return st(Sn)}}}).bind(this))(e0)}}catch(e0){return st(e0)}}).bind(this),st)}catch(Uo){return st(Uo)}}).bind(this),st)}catch(t0){return st(t0)}}).bind(this),st)}catch(zo){return st(zo)}}).bind(this),st)})}const l=`
let scriptImported = false
self.addEventListener('message', async (e) => {
  const { file, id, imageCompressionLibUrl, options } = e.data
  options.onProgress = (progress) => self.postMessage({ progress, id })
  try {
    if (!scriptImported) {
      // console.log('[worker] importScripts', imageCompressionLibUrl)
      self.importScripts(imageCompressionLibUrl)
      scriptImported = true
    }
    // console.log('[worker] self', self)
    const compressedFile = await imageCompression(file, options)
    self.postMessage({ file: compressedFile, id })
  } catch (e) {
    // console.error('[worker] error', e)
    self.postMessage({ error: e.message + '\\n' + e.stack, id })
  }
})
`;let c;function compressOnWebWorker(d,g){return new Promise((b,et)=>{c||(c=function(vt){const Tt=[];return Tt.push(vt),URL.createObjectURL(new Blob(Tt))}(l));const st=new Worker(c);st.addEventListener("message",function(vt){if(g.signal&&g.signal.aborted)st.terminate();else if(vt.data.progress===void 0){if(vt.data.error)return et(new Error(vt.data.error)),void st.terminate();b(vt.data.file),st.terminate()}else g.onProgress(vt.data.progress)}),st.addEventListener("error",et),g.signal&&g.signal.addEventListener("abort",()=>{et(g.signal.reason),st.terminate()}),st.postMessage({file:d,imageCompressionLibUrl:g.libURL,options:{...g,onProgress:void 0,signal:void 0}})})}function imageCompression(d,g){return new Promise(function(b,et){let st,at,vt,Tt,Ct,pt;if(st={...g},vt=0,{onProgress:Tt}=st,st.maxSizeMB=st.maxSizeMB||Number.POSITIVE_INFINITY,Ct=typeof st.useWebWorker!="boolean"||st.useWebWorker,delete st.useWebWorker,st.onProgress=jt=>{vt=jt,typeof Tt=="function"&&Tt(vt)},!(d instanceof Blob||d instanceof CustomFile))return et(new Error("The file given is not an instance of Blob or File"));if(!/^image/.test(d.type))return et(new Error("The file given is not an image"));if(pt=typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope,!Ct||typeof Worker!="function"||pt)return compress(d,st).then((function(jt){try{return at=jt,Lt.call(this)}catch(Ft){return et(Ft)}}).bind(this),et);var wt=(function(){try{return Lt.call(this)}catch(jt){return et(jt)}}).bind(this),$t=function(jt){try{return compress(d,st).then(function(Ft){try{return at=Ft,wt()}catch(Gt){return et(Gt)}},et)}catch(Ft){return et(Ft)}};try{return st.libURL=st.libURL||"https://cdn.jsdelivr.net/npm/browser-image-compression@2.0.2/dist/browser-image-compression.js",compressOnWebWorker(d,st).then(function(jt){try{return at=jt,wt()}catch{return $t()}},$t)}catch{$t()}function Lt(){try{at.name=d.name,at.lastModified=d.lastModified}catch{}try{st.preserveExif&&d.type==="image/jpeg"&&(!st.fileType||st.fileType&&st.fileType===d.type)&&(at=copyExifWithoutOrientation(d,at))}catch{}return b(at)}})}imageCompression.getDataUrlFromFile=getDataUrlFromFile,imageCompression.getFilefromDataUrl=getFilefromDataUrl,imageCompression.loadImage=loadImage,imageCompression.drawImageInCanvas=drawImageInCanvas,imageCompression.drawFileInCanvas=drawFileInCanvas,imageCompression.canvasToFile=canvasToFile,imageCompression.getExifOrientation=getExifOrientation,imageCompression.handleMaxWidthOrHeight=handleMaxWidthOrHeight,imageCompression.followExifOrientation=followExifOrientation,imageCompression.cleanupCanvasMemory=cleanupCanvasMemory,imageCompression.isAutoOrientationInBrowser=isAutoOrientationInBrowser,imageCompression.approximateBelowMaximumCanvasSizeOfBrowser=approximateBelowMaximumCanvasSizeOfBrowser,imageCompression.copyExifWithoutOrientation=copyExifWithoutOrientation,imageCompression.getBrowserName=getBrowserName,imageCompression.version="2.0.2";function FileSelect(d){const{onSelection:g}=d,{t:b}=useTranslation(),[et]=reactExports.useState(`file-upload-${Math.random().toString()}`),st=useResolution(),at=async vt=>{if(!(!vt||!vt.type.match("image.*")))try{if(vt.size>20*1024*1024)throw new Error("file too large");const pt=await imageCompression(vt,{maxWidthOrHeight:1536,useWebWorker:!0});g(pt)}catch(Ct){alert(`error: ${Ct.message}`)}};return jsxRuntimeExports.jsx("div",{className:"absolute flex w-screen h-screen justify-center items-center pointer-events-none",children:jsxRuntimeExports.jsx("label",{htmlFor:et,className:"grid bg-background border-[2px] border-[dashed] rounded-lg min-w-[600px] hover:bg-primary hover:text-primary-foreground pointer-events-auto",children:jsxRuntimeExports.jsxs("div",{className:"grid p-16 w-full h-full",onDragOver:vt=>{vt.stopPropagation(),vt.preventDefault()},children:[jsxRuntimeExports.jsx("input",{className:"hidden",id:et,name:et,type:"file",onChange:vt=>{var Ct;const Tt=(Ct=vt.currentTarget.files)==null?void 0:Ct[0];Tt&&at(Tt)},accept:"image/png, image/jpeg"}),jsxRuntimeExports.jsx("p",{className:"text-center",children:st==="desktop"?b("Image load"):"Tap here to load your picture"})]})})})}const SUPPORTED_FILE_TYPE=["image/jpeg","image/png","image/webp","image/bmp","image/tiff"];function Home(){const[d,g,b,et]=useStore($t=>[$t.file,$t.updateAppState,$t.setServerConfig,$t.setFile]),st=useWindowSize();reactExports.useEffect(()=>{g({windowSize:st})},[st]);const at=reactExports.useRef(0),vt=reactExports.useCallback($t=>{$t.preventDefault(),$t.stopPropagation()},[]),Tt=reactExports.useCallback($t=>{$t.preventDefault(),$t.stopPropagation(),at.current+=1},[]),Ct=reactExports.useCallback($t=>{$t.preventDefault(),$t.stopPropagation(),at.current-=1,at.current>0},[]),pt=reactExports.useCallback($t=>{if($t.preventDefault(),$t.stopPropagation(),$t.dataTransfer.files&&$t.dataTransfer.files.length>0){if(!($t.dataTransfer.files.length>1)){const Lt=$t.dataTransfer.files[0],jt=Lt.type;SUPPORTED_FILE_TYPE.includes(jt)&&et(Lt)}$t.dataTransfer.clearData()}},[]),wt=reactExports.useCallback($t=>{if(!$t.clipboardData)return;const Lt=$t.clipboardData.items,jt=[].slice.call(Lt).filter(Ht=>Ht.type.indexOf("image")!==-1);if(jt.length===0)return;$t.preventDefault(),$t.stopPropagation();const Gt=jt[0].getAsFile();Gt&&et(Gt)},[]);return reactExports.useEffect(()=>(window.addEventListener("dragenter",Tt),window.addEventListener("dragleave",Ct),window.addEventListener("dragover",vt),window.addEventListener("drop",pt),window.addEventListener("paste",wt),function(){window.removeEventListener("dragenter",Tt),window.removeEventListener("dragleave",Ct),window.removeEventListener("dragover",vt),window.removeEventListener("drop",pt),window.removeEventListener("paste",wt)})),jsxRuntimeExports.jsxs("main",{className:"flex min-h-screen flex-col items-center justify-between w-full bg-[radial-gradient(circle_at_1px_1px,_#8e8e8e8e_1px,_transparent_0)] [background-size:20px_20px] bg-repeat",children:[jsxRuntimeExports.jsx(Toaster,{}),jsxRuntimeExports.jsx(Header,{}),jsxRuntimeExports.jsx(Workspace,{}),d?jsxRuntimeExports.jsx(jsxRuntimeExports.Fragment,{}):jsxRuntimeExports.jsx(FileSelect,{onSelection:async $t=>{et($t)}})]})}var P=["light","dark"],E="(prefers-color-scheme: dark)",Q=typeof window>"u",L=reactExports.createContext(void 0),z=d=>reactExports.useContext(L)?d.children:reactExports.createElement(O,{...d}),N=["light","dark"],O=({forcedTheme:d,disableTransitionOnChange:g=!1,enableSystem:b=!0,enableColorScheme:et=!0,storageKey:st="theme",themes:at=N,defaultTheme:vt=b?"system":"light",attribute:Tt="data-theme",value:Ct,children:pt,nonce:wt})=>{let[$t,Lt]=reactExports.useState(()=>M(st,vt)),[jt,Ft]=reactExports.useState(()=>M(st)),Gt=Ct?Object.values(Ct):at,Ht=reactExports.useCallback(ir=>{let or=ir;if(!or)return;ir==="system"&&b&&(or=T());let jr=Ct?Ct[or]:or,qr=g?_():null,Yr=document.documentElement;if(Tt==="class"?(Yr.classList.remove(...Gt),jr&&Yr.classList.add(jr)):jr?Yr.setAttribute(Tt,jr):Yr.removeAttribute(Tt),et){let vn=P.includes(vt)?vt:null,ko=P.includes(or)?or:vn;Yr.style.colorScheme=ko}qr==null||qr()},[]),qt=reactExports.useCallback(ir=>{let or=typeof ir=="function"?ir(ir):ir;Lt(or);try{localStorage.setItem(st,or)}catch{}},[d]),Kt=reactExports.useCallback(ir=>{let or=T(ir);Ft(or),$t==="system"&&b&&!d&&Ht("system")},[$t,d]);reactExports.useEffect(()=>{let ir=window.matchMedia(E);return ir.addListener(Kt),Kt(ir),()=>ir.removeListener(Kt)},[Kt]),reactExports.useEffect(()=>{let ir=or=>{if(or.key!==st)return;let jr=or.newValue||vt;qt(jr)};return window.addEventListener("storage",ir),()=>window.removeEventListener("storage",ir)},[qt]),reactExports.useEffect(()=>{Ht(d??$t)},[d,$t]);let rr=reactExports.useMemo(()=>({theme:$t,setTheme:qt,forcedTheme:d,resolvedTheme:$t==="system"?jt:$t,themes:b?[...at,"system"]:at,systemTheme:b?jt:void 0}),[$t,qt,d,jt,b,at]);return reactExports.createElement(L.Provider,{value:rr},reactExports.createElement(U,{forcedTheme:d,disableTransitionOnChange:g,enableSystem:b,enableColorScheme:et,storageKey:st,themes:at,defaultTheme:vt,attribute:Tt,value:Ct,children:pt,attrs:Gt,nonce:wt}),pt)},U=reactExports.memo(({forcedTheme:d,storageKey:g,attribute:b,enableSystem:et,enableColorScheme:st,defaultTheme:at,value:vt,attrs:Tt,nonce:Ct})=>{let pt=at==="system",wt=b==="class"?`var d=document.documentElement,c=d.classList;${`c.remove(${Tt.map(Ft=>`'${Ft}'`).join(",")})`};`:`var d=document.documentElement,n='${b}',s='setAttribute';`,$t=st?P.includes(at)&&at?`if(e==='light'||e==='dark'||!e)d.style.colorScheme=e||'${at}'`:"if(e==='light'||e==='dark')d.style.colorScheme=e":"",Lt=(Ft,Gt=!1,Ht=!0)=>{let qt=vt?vt[Ft]:Ft,Kt=Gt?Ft+"|| ''":`'${qt}'`,rr="";return st&&Ht&&!Gt&&P.includes(Ft)&&(rr+=`d.style.colorScheme = '${Ft}';`),b==="class"?Gt||qt?rr+=`c.add(${Kt})`:rr+="null":qt&&(rr+=`d[s](n,${Kt})`),rr},jt=d?`!function(){${wt}${Lt(d)}}()`:et?`!function(){try{${wt}var e=localStorage.getItem('${g}');if('system'===e||(!e&&${pt})){var t='${E}',m=window.matchMedia(t);if(m.media!==t||m.matches){${Lt("dark")}}else{${Lt("light")}}}else if(e){${vt?`var x=${JSON.stringify(vt)};`:""}${Lt(vt?"x[e]":"e",!0)}}${pt?"":"else{"+Lt(at,!1,!1)+"}"}${$t}}catch(e){}}()`:`!function(){try{${wt}var e=localStorage.getItem('${g}');if(e){${vt?`var x=${JSON.stringify(vt)};`:""}${Lt(vt?"x[e]":"e",!0)}}else{${Lt(at,!1,!1)};}${$t}}catch(t){}}();`;return reactExports.createElement("script",{nonce:Ct,dangerouslySetInnerHTML:{__html:jt}})}),M=(d,g)=>{if(Q)return;let b;try{b=localStorage.getItem(d)||void 0}catch{}return b||g},_=()=>{let d=document.createElement("style");return d.appendChild(document.createTextNode("*{-webkit-transition:none!important;-moz-transition:none!important;-o-transition:none!important;-ms-transition:none!important;transition:none!important}")),document.head.appendChild(d),()=>{window.getComputedStyle(document.body),setTimeout(()=>{document.head.removeChild(d)},1)}},T=d=>(d||(d=window.matchMedia(E)),d.matches?"dark":"light");const consoleLogger={type:"logger",log(d){this.output("log",d)},warn(d){this.output("warn",d)},error(d){this.output("error",d)},output(d,g){console&&console[d]&&console[d].apply(console,g)}};class Logger{constructor(g){let b=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};this.init(g,b)}init(g){let b=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};this.prefix=b.prefix||"i18next:",this.logger=g||consoleLogger,this.options=b,this.debug=b.debug}log(){for(var g=arguments.length,b=new Array(g),et=0;et<g;et++)b[et]=arguments[et];return this.forward(b,"log","",!0)}warn(){for(var g=arguments.length,b=new Array(g),et=0;et<g;et++)b[et]=arguments[et];return this.forward(b,"warn","",!0)}error(){for(var g=arguments.length,b=new Array(g),et=0;et<g;et++)b[et]=arguments[et];return this.forward(b,"error","")}deprecate(){for(var g=arguments.length,b=new Array(g),et=0;et<g;et++)b[et]=arguments[et];return this.forward(b,"warn","WARNING DEPRECATED: ",!0)}forward(g,b,et,st){return st&&!this.debug?null:(typeof g[0]=="string"&&(g[0]=`${et}${this.prefix} ${g[0]}`),this.logger[b](g))}create(g){return new Logger(this.logger,{prefix:`${this.prefix}:${g}:`,...this.options})}clone(g){return g=g||this.options,g.prefix=g.prefix||this.prefix,new Logger(this.logger,g)}}var baseLogger=new Logger;class EventEmitter{constructor(){this.observers={}}on(g,b){return g.split(" ").forEach(et=>{this.observers[et]||(this.observers[et]=new Map);const st=this.observers[et].get(b)||0;this.observers[et].set(b,st+1)}),this}off(g,b){if(this.observers[g]){if(!b){delete this.observers[g];return}this.observers[g].delete(b)}}emit(g){for(var b=arguments.length,et=new Array(b>1?b-1:0),st=1;st<b;st++)et[st-1]=arguments[st];this.observers[g]&&Array.from(this.observers[g].entries()).forEach(vt=>{let[Tt,Ct]=vt;for(let pt=0;pt<Ct;pt++)Tt(...et)}),this.observers["*"]&&Array.from(this.observers["*"].entries()).forEach(vt=>{let[Tt,Ct]=vt;for(let pt=0;pt<Ct;pt++)Tt.apply(Tt,[g,...et])})}}function defer(){let d,g;const b=new Promise((et,st)=>{d=et,g=st});return b.resolve=d,b.reject=g,b}function makeString(d){return d==null?"":""+d}function copy(d,g,b){d.forEach(et=>{g[et]&&(b[et]=g[et])})}const lastOfPathSeparatorRegExp=/###/g;function getLastOfPath(d,g,b){function et(Tt){return Tt&&Tt.indexOf("###")>-1?Tt.replace(lastOfPathSeparatorRegExp,"."):Tt}function st(){return!d||typeof d=="string"}const at=typeof g!="string"?g:g.split(".");let vt=0;for(;vt<at.length-1;){if(st())return{};const Tt=et(at[vt]);!d[Tt]&&b&&(d[Tt]=new b),Object.prototype.hasOwnProperty.call(d,Tt)?d=d[Tt]:d={},++vt}return st()?{}:{obj:d,k:et(at[vt])}}function setPath(d,g,b){const{obj:et,k:st}=getLastOfPath(d,g,Object);if(et!==void 0||g.length===1){et[st]=b;return}let at=g[g.length-1],vt=g.slice(0,g.length-1),Tt=getLastOfPath(d,vt,Object);for(;Tt.obj===void 0&&vt.length;)at=`${vt[vt.length-1]}.${at}`,vt=vt.slice(0,vt.length-1),Tt=getLastOfPath(d,vt,Object),Tt&&Tt.obj&&typeof Tt.obj[`${Tt.k}.${at}`]<"u"&&(Tt.obj=void 0);Tt.obj[`${Tt.k}.${at}`]=b}function pushPath(d,g,b,et){const{obj:st,k:at}=getLastOfPath(d,g,Object);st[at]=st[at]||[],st[at].push(b)}function getPath(d,g){const{obj:b,k:et}=getLastOfPath(d,g);if(b)return b[et]}function getPathWithDefaults(d,g,b){const et=getPath(d,b);return et!==void 0?et:getPath(g,b)}function deepExtend(d,g,b){for(const et in g)et!=="__proto__"&&et!=="constructor"&&(et in d?typeof d[et]=="string"||d[et]instanceof String||typeof g[et]=="string"||g[et]instanceof String?b&&(d[et]=g[et]):deepExtend(d[et],g[et],b):d[et]=g[et]);return d}function regexEscape(d){return d.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&")}var _entityMap={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#x2F;"};function escape(d){return typeof d=="string"?d.replace(/[&<>"'\/]/g,g=>_entityMap[g]):d}class RegExpCache{constructor(g){this.capacity=g,this.regExpMap=new Map,this.regExpQueue=[]}getRegExp(g){const b=this.regExpMap.get(g);if(b!==void 0)return b;const et=new RegExp(g);return this.regExpQueue.length===this.capacity&&this.regExpMap.delete(this.regExpQueue.shift()),this.regExpMap.set(g,et),this.regExpQueue.push(g),et}}const chars=[" ",",","?","!",";"],looksLikeObjectPathRegExpCache=new RegExpCache(20);function looksLikeObjectPath(d,g,b){g=g||"",b=b||"";const et=chars.filter(vt=>g.indexOf(vt)<0&&b.indexOf(vt)<0);if(et.length===0)return!0;const st=looksLikeObjectPathRegExpCache.getRegExp(`(${et.map(vt=>vt==="?"?"\\?":vt).join("|")})`);let at=!st.test(d);if(!at){const vt=d.indexOf(b);vt>0&&!st.test(d.substring(0,vt))&&(at=!0)}return at}function deepFind(d,g){let b=arguments.length>2&&arguments[2]!==void 0?arguments[2]:".";if(!d)return;if(d[g])return d[g];const et=g.split(b);let st=d;for(let at=0;at<et.length;){if(!st||typeof st!="object")return;let vt,Tt="";for(let Ct=at;Ct<et.length;++Ct)if(Ct!==at&&(Tt+=b),Tt+=et[Ct],vt=st[Tt],vt!==void 0){if(["string","number","boolean"].indexOf(typeof vt)>-1&&Ct<et.length-1)continue;at+=Ct-at+1;break}st=vt}return st}function getCleanedCode(d){return d&&d.indexOf("_")>0?d.replace("_","-"):d}class ResourceStore extends EventEmitter{constructor(g){let b=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{ns:["translation"],defaultNS:"translation"};super(),this.data=g||{},this.options=b,this.options.keySeparator===void 0&&(this.options.keySeparator="."),this.options.ignoreJSONStructure===void 0&&(this.options.ignoreJSONStructure=!0)}addNamespaces(g){this.options.ns.indexOf(g)<0&&this.options.ns.push(g)}removeNamespaces(g){const b=this.options.ns.indexOf(g);b>-1&&this.options.ns.splice(b,1)}getResource(g,b,et){let st=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{};const at=st.keySeparator!==void 0?st.keySeparator:this.options.keySeparator,vt=st.ignoreJSONStructure!==void 0?st.ignoreJSONStructure:this.options.ignoreJSONStructure;let Tt;g.indexOf(".")>-1?Tt=g.split("."):(Tt=[g,b],et&&(Array.isArray(et)?Tt.push(...et):typeof et=="string"&&at?Tt.push(...et.split(at)):Tt.push(et)));const Ct=getPath(this.data,Tt);return!Ct&&!b&&!et&&g.indexOf(".")>-1&&(g=Tt[0],b=Tt[1],et=Tt.slice(2).join(".")),Ct||!vt||typeof et!="string"?Ct:deepFind(this.data&&this.data[g]&&this.data[g][b],et,at)}addResource(g,b,et,st){let at=arguments.length>4&&arguments[4]!==void 0?arguments[4]:{silent:!1};const vt=at.keySeparator!==void 0?at.keySeparator:this.options.keySeparator;let Tt=[g,b];et&&(Tt=Tt.concat(vt?et.split(vt):et)),g.indexOf(".")>-1&&(Tt=g.split("."),st=b,b=Tt[1]),this.addNamespaces(b),setPath(this.data,Tt,st),at.silent||this.emit("added",g,b,et,st)}addResources(g,b,et){let st=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{silent:!1};for(const at in et)(typeof et[at]=="string"||Array.isArray(et[at]))&&this.addResource(g,b,at,et[at],{silent:!0});st.silent||this.emit("added",g,b,et)}addResourceBundle(g,b,et,st,at){let vt=arguments.length>5&&arguments[5]!==void 0?arguments[5]:{silent:!1,skipCopy:!1},Tt=[g,b];g.indexOf(".")>-1&&(Tt=g.split("."),st=et,et=b,b=Tt[1]),this.addNamespaces(b);let Ct=getPath(this.data,Tt)||{};vt.skipCopy||(et=JSON.parse(JSON.stringify(et))),st?deepExtend(Ct,et,at):Ct={...Ct,...et},setPath(this.data,Tt,Ct),vt.silent||this.emit("added",g,b,et)}removeResourceBundle(g,b){this.hasResourceBundle(g,b)&&delete this.data[g][b],this.removeNamespaces(b),this.emit("removed",g,b)}hasResourceBundle(g,b){return this.getResource(g,b)!==void 0}getResourceBundle(g,b){return b||(b=this.options.defaultNS),this.options.compatibilityAPI==="v1"?{...this.getResource(g,b)}:this.getResource(g,b)}getDataByLanguage(g){return this.data[g]}hasLanguageSomeTranslations(g){const b=this.getDataByLanguage(g);return!!(b&&Object.keys(b)||[]).find(st=>b[st]&&Object.keys(b[st]).length>0)}toJSON(){return this.data}}var postProcessor={processors:{},addPostProcessor(d){this.processors[d.name]=d},handle(d,g,b,et,st){return d.forEach(at=>{this.processors[at]&&(g=this.processors[at].process(g,b,et,st))}),g}};const checkedLoadedFor={};class Translator extends EventEmitter{constructor(g){let b=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};super(),copy(["resourceStore","languageUtils","pluralResolver","interpolator","backendConnector","i18nFormat","utils"],g,this),this.options=b,this.options.keySeparator===void 0&&(this.options.keySeparator="."),this.logger=baseLogger.create("translator")}changeLanguage(g){g&&(this.language=g)}exists(g){let b=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{interpolation:{}};if(g==null)return!1;const et=this.resolve(g,b);return et&&et.res!==void 0}extractFromKey(g,b){let et=b.nsSeparator!==void 0?b.nsSeparator:this.options.nsSeparator;et===void 0&&(et=":");const st=b.keySeparator!==void 0?b.keySeparator:this.options.keySeparator;let at=b.ns||this.options.defaultNS||[];const vt=et&&g.indexOf(et)>-1,Tt=!this.options.userDefinedKeySeparator&&!b.keySeparator&&!this.options.userDefinedNsSeparator&&!b.nsSeparator&&!looksLikeObjectPath(g,et,st);if(vt&&!Tt){const Ct=g.match(this.interpolator.nestingRegexp);if(Ct&&Ct.length>0)return{key:g,namespaces:at};const pt=g.split(et);(et!==st||et===st&&this.options.ns.indexOf(pt[0])>-1)&&(at=pt.shift()),g=pt.join(st)}return typeof at=="string"&&(at=[at]),{key:g,namespaces:at}}translate(g,b,et){if(typeof b!="object"&&this.options.overloadTranslationOptionHandler&&(b=this.options.overloadTranslationOptionHandler(arguments)),typeof b=="object"&&(b={...b}),b||(b={}),g==null)return"";Array.isArray(g)||(g=[String(g)]);const st=b.returnDetails!==void 0?b.returnDetails:this.options.returnDetails,at=b.keySeparator!==void 0?b.keySeparator:this.options.keySeparator,{key:vt,namespaces:Tt}=this.extractFromKey(g[g.length-1],b),Ct=Tt[Tt.length-1],pt=b.lng||this.language,wt=b.appendNamespaceToCIMode||this.options.appendNamespaceToCIMode;if(pt&&pt.toLowerCase()==="cimode"){if(wt){const ir=b.nsSeparator||this.options.nsSeparator;return st?{res:`${Ct}${ir}${vt}`,usedKey:vt,exactUsedKey:vt,usedLng:pt,usedNS:Ct,usedParams:this.getUsedParamsDetails(b)}:`${Ct}${ir}${vt}`}return st?{res:vt,usedKey:vt,exactUsedKey:vt,usedLng:pt,usedNS:Ct,usedParams:this.getUsedParamsDetails(b)}:vt}const $t=this.resolve(g,b);let Lt=$t&&$t.res;const jt=$t&&$t.usedKey||vt,Ft=$t&&$t.exactUsedKey||vt,Gt=Object.prototype.toString.apply(Lt),Ht=["[object Number]","[object Function]","[object RegExp]"],qt=b.joinArrays!==void 0?b.joinArrays:this.options.joinArrays,Kt=!this.i18nFormat||this.i18nFormat.handleAsObject;if(Kt&&Lt&&(typeof Lt!="string"&&typeof Lt!="boolean"&&typeof Lt!="number")&&Ht.indexOf(Gt)<0&&!(typeof qt=="string"&&Array.isArray(Lt))){if(!b.returnObjects&&!this.options.returnObjects){this.options.returnedObjectHandler||this.logger.warn("accessing an object - but returnObjects options is not enabled!");const ir=this.options.returnedObjectHandler?this.options.returnedObjectHandler(jt,Lt,{...b,ns:Tt}):`key '${vt} (${this.language})' returned an object instead of string.`;return st?($t.res=ir,$t.usedParams=this.getUsedParamsDetails(b),$t):ir}if(at){const ir=Array.isArray(Lt),or=ir?[]:{},jr=ir?Ft:jt;for(const qr in Lt)if(Object.prototype.hasOwnProperty.call(Lt,qr)){const Yr=`${jr}${at}${qr}`;or[qr]=this.translate(Yr,{...b,joinArrays:!1,ns:Tt}),or[qr]===Yr&&(or[qr]=Lt[qr])}Lt=or}}else if(Kt&&typeof qt=="string"&&Array.isArray(Lt))Lt=Lt.join(qt),Lt&&(Lt=this.extendTranslation(Lt,g,b,et));else{let ir=!1,or=!1;const jr=b.count!==void 0&&typeof b.count!="string",qr=Translator.hasDefaultValue(b),Yr=jr?this.pluralResolver.getSuffix(pt,b.count,b):"",vn=b.ordinal&&jr?this.pluralResolver.getSuffix(pt,b.count,{ordinal:!1}):"",ko=jr&&!b.ordinal&&b.count===0&&this.pluralResolver.shouldUseIntlApi(),Xo=ko&&b[`defaultValue${this.options.pluralSeparator}zero`]||b[`defaultValue${Yr}`]||b[`defaultValue${vn}`]||b.defaultValue;!this.isValidLookup(Lt)&&qr&&(ir=!0,Lt=Xo),this.isValidLookup(Lt)||(or=!0,Lt=vt);const t0=(b.missingKeyNoValueFallbackToKey||this.options.missingKeyNoValueFallbackToKey)&&or?void 0:Lt,Uo=qr&&Xo!==Lt&&this.options.updateMissing;if(or||ir||Uo){if(this.logger.log(Uo?"updateKey":"missingKey",pt,Ct,vt,Uo?Xo:Lt),at){const e0=this.resolve(vt,{...b,keySeparator:!1});e0&&e0.res&&this.logger.warn("Seems the loaded translations were in flat JSON format instead of nested. Either set keySeparator: false on init or make sure your translations are published in nested format.")}let No=[];const _n=this.languageUtils.getFallbackCodes(this.options.fallbackLng,b.lng||this.language);if(this.options.saveMissingTo==="fallback"&&_n&&_n[0])for(let e0=0;e0<_n.length;e0++)No.push(_n[e0]);else this.options.saveMissingTo==="all"?No=this.languageUtils.toResolveHierarchy(b.lng||this.language):No.push(b.lng||this.language);const Kr=(e0,Zr,Ro)=>{const Sn=qr&&Ro!==Lt?Ro:t0;this.options.missingKeyHandler?this.options.missingKeyHandler(e0,Ct,Zr,Sn,Uo,b):this.backendConnector&&this.backendConnector.saveMissing&&this.backendConnector.saveMissing(e0,Ct,Zr,Sn,Uo,b),this.emit("missingKey",e0,Ct,Zr,Lt)};this.options.saveMissing&&(this.options.saveMissingPlurals&&jr?No.forEach(e0=>{const Zr=this.pluralResolver.getSuffixes(e0,b);ko&&b[`defaultValue${this.options.pluralSeparator}zero`]&&Zr.indexOf(`${this.options.pluralSeparator}zero`)<0&&Zr.push(`${this.options.pluralSeparator}zero`),Zr.forEach(Ro=>{Kr([e0],vt+Ro,b[`defaultValue${Ro}`]||Xo)})}):Kr(No,vt,Xo))}Lt=this.extendTranslation(Lt,g,b,$t,et),or&&Lt===vt&&this.options.appendNamespaceToMissingKey&&(Lt=`${Ct}:${vt}`),(or||ir)&&this.options.parseMissingKeyHandler&&(this.options.compatibilityAPI!=="v1"?Lt=this.options.parseMissingKeyHandler(this.options.appendNamespaceToMissingKey?`${Ct}:${vt}`:vt,ir?Lt:void 0):Lt=this.options.parseMissingKeyHandler(Lt))}return st?($t.res=Lt,$t.usedParams=this.getUsedParamsDetails(b),$t):Lt}extendTranslation(g,b,et,st,at){var vt=this;if(this.i18nFormat&&this.i18nFormat.parse)g=this.i18nFormat.parse(g,{...this.options.interpolation.defaultVariables,...et},et.lng||this.language||st.usedLng,st.usedNS,st.usedKey,{resolved:st});else if(!et.skipInterpolation){et.interpolation&&this.interpolator.init({...et,interpolation:{...this.options.interpolation,...et.interpolation}});const pt=typeof g=="string"&&(et&&et.interpolation&&et.interpolation.skipOnVariables!==void 0?et.interpolation.skipOnVariables:this.options.interpolation.skipOnVariables);let wt;if(pt){const Lt=g.match(this.interpolator.nestingRegexp);wt=Lt&&Lt.length}let $t=et.replace&&typeof et.replace!="string"?et.replace:et;if(this.options.interpolation.defaultVariables&&($t={...this.options.interpolation.defaultVariables,...$t}),g=this.interpolator.interpolate(g,$t,et.lng||this.language,et),pt){const Lt=g.match(this.interpolator.nestingRegexp),jt=Lt&&Lt.length;wt<jt&&(et.nest=!1)}!et.lng&&this.options.compatibilityAPI!=="v1"&&st&&st.res&&(et.lng=st.usedLng),et.nest!==!1&&(g=this.interpolator.nest(g,function(){for(var Lt=arguments.length,jt=new Array(Lt),Ft=0;Ft<Lt;Ft++)jt[Ft]=arguments[Ft];return at&&at[0]===jt[0]&&!et.context?(vt.logger.warn(`It seems you are nesting recursively key: ${jt[0]} in key: ${b[0]}`),null):vt.translate(...jt,b)},et)),et.interpolation&&this.interpolator.reset()}const Tt=et.postProcess||this.options.postProcess,Ct=typeof Tt=="string"?[Tt]:Tt;return g!=null&&Ct&&Ct.length&&et.applyPostProcessor!==!1&&(g=postProcessor.handle(Ct,g,b,this.options&&this.options.postProcessPassResolved?{i18nResolved:{...st,usedParams:this.getUsedParamsDetails(et)},...et}:et,this)),g}resolve(g){let b=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},et,st,at,vt,Tt;return typeof g=="string"&&(g=[g]),g.forEach(Ct=>{if(this.isValidLookup(et))return;const pt=this.extractFromKey(Ct,b),wt=pt.key;st=wt;let $t=pt.namespaces;this.options.fallbackNS&&($t=$t.concat(this.options.fallbackNS));const Lt=b.count!==void 0&&typeof b.count!="string",jt=Lt&&!b.ordinal&&b.count===0&&this.pluralResolver.shouldUseIntlApi(),Ft=b.context!==void 0&&(typeof b.context=="string"||typeof b.context=="number")&&b.context!=="",Gt=b.lngs?b.lngs:this.languageUtils.toResolveHierarchy(b.lng||this.language,b.fallbackLng);$t.forEach(Ht=>{this.isValidLookup(et)||(Tt=Ht,!checkedLoadedFor[`${Gt[0]}-${Ht}`]&&this.utils&&this.utils.hasLoadedNamespace&&!this.utils.hasLoadedNamespace(Tt)&&(checkedLoadedFor[`${Gt[0]}-${Ht}`]=!0,this.logger.warn(`key "${st}" for languages "${Gt.join(", ")}" won't get resolved as namespace "${Tt}" was not yet loaded`,"This means something IS WRONG in your setup. You access the t function before i18next.init / i18next.loadNamespace / i18next.changeLanguage was done. Wait for the callback or Promise to resolve before accessing it!!!")),Gt.forEach(qt=>{if(this.isValidLookup(et))return;vt=qt;const Kt=[wt];if(this.i18nFormat&&this.i18nFormat.addLookupKeys)this.i18nFormat.addLookupKeys(Kt,wt,qt,Ht,b);else{let ir;Lt&&(ir=this.pluralResolver.getSuffix(qt,b.count,b));const or=`${this.options.pluralSeparator}zero`,jr=`${this.options.pluralSeparator}ordinal${this.options.pluralSeparator}`;if(Lt&&(Kt.push(wt+ir),b.ordinal&&ir.indexOf(jr)===0&&Kt.push(wt+ir.replace(jr,this.options.pluralSeparator)),jt&&Kt.push(wt+or)),Ft){const qr=`${wt}${this.options.contextSeparator}${b.context}`;Kt.push(qr),Lt&&(Kt.push(qr+ir),b.ordinal&&ir.indexOf(jr)===0&&Kt.push(qr+ir.replace(jr,this.options.pluralSeparator)),jt&&Kt.push(qr+or))}}let rr;for(;rr=Kt.pop();)this.isValidLookup(et)||(at=rr,et=this.getResource(qt,Ht,rr,b))}))})}),{res:et,usedKey:st,exactUsedKey:at,usedLng:vt,usedNS:Tt}}isValidLookup(g){return g!==void 0&&!(!this.options.returnNull&&g===null)&&!(!this.options.returnEmptyString&&g==="")}getResource(g,b,et){let st=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{};return this.i18nFormat&&this.i18nFormat.getResource?this.i18nFormat.getResource(g,b,et,st):this.resourceStore.getResource(g,b,et,st)}getUsedParamsDetails(){let g=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const b=["defaultValue","ordinal","context","replace","lng","lngs","fallbackLng","ns","keySeparator","nsSeparator","returnObjects","returnDetails","joinArrays","postProcess","interpolation"],et=g.replace&&typeof g.replace!="string";let st=et?g.replace:g;if(et&&typeof g.count<"u"&&(st.count=g.count),this.options.interpolation.defaultVariables&&(st={...this.options.interpolation.defaultVariables,...st}),!et){st={...st};for(const at of b)delete st[at]}return st}static hasDefaultValue(g){const b="defaultValue";for(const et in g)if(Object.prototype.hasOwnProperty.call(g,et)&&b===et.substring(0,b.length)&&g[et]!==void 0)return!0;return!1}}function capitalize(d){return d.charAt(0).toUpperCase()+d.slice(1)}class LanguageUtil{constructor(g){this.options=g,this.supportedLngs=this.options.supportedLngs||!1,this.logger=baseLogger.create("languageUtils")}getScriptPartFromCode(g){if(g=getCleanedCode(g),!g||g.indexOf("-")<0)return null;const b=g.split("-");return b.length===2||(b.pop(),b[b.length-1].toLowerCase()==="x")?null:this.formatLanguageCode(b.join("-"))}getLanguagePartFromCode(g){if(g=getCleanedCode(g),!g||g.indexOf("-")<0)return g;const b=g.split("-");return this.formatLanguageCode(b[0])}formatLanguageCode(g){if(typeof g=="string"&&g.indexOf("-")>-1){const b=["hans","hant","latn","cyrl","cans","mong","arab"];let et=g.split("-");return this.options.lowerCaseLng?et=et.map(st=>st.toLowerCase()):et.length===2?(et[0]=et[0].toLowerCase(),et[1]=et[1].toUpperCase(),b.indexOf(et[1].toLowerCase())>-1&&(et[1]=capitalize(et[1].toLowerCase()))):et.length===3&&(et[0]=et[0].toLowerCase(),et[1].length===2&&(et[1]=et[1].toUpperCase()),et[0]!=="sgn"&&et[2].length===2&&(et[2]=et[2].toUpperCase()),b.indexOf(et[1].toLowerCase())>-1&&(et[1]=capitalize(et[1].toLowerCase())),b.indexOf(et[2].toLowerCase())>-1&&(et[2]=capitalize(et[2].toLowerCase()))),et.join("-")}return this.options.cleanCode||this.options.lowerCaseLng?g.toLowerCase():g}isSupportedCode(g){return(this.options.load==="languageOnly"||this.options.nonExplicitSupportedLngs)&&(g=this.getLanguagePartFromCode(g)),!this.supportedLngs||!this.supportedLngs.length||this.supportedLngs.indexOf(g)>-1}getBestMatchFromCodes(g){if(!g)return null;let b;return g.forEach(et=>{if(b)return;const st=this.formatLanguageCode(et);(!this.options.supportedLngs||this.isSupportedCode(st))&&(b=st)}),!b&&this.options.supportedLngs&&g.forEach(et=>{if(b)return;const st=this.getLanguagePartFromCode(et);if(this.isSupportedCode(st))return b=st;b=this.options.supportedLngs.find(at=>{if(at===st)return at;if(!(at.indexOf("-")<0&&st.indexOf("-")<0)&&(at.indexOf("-")>0&&st.indexOf("-")<0&&at.substring(0,at.indexOf("-"))===st||at.indexOf(st)===0&&st.length>1))return at})}),b||(b=this.getFallbackCodes(this.options.fallbackLng)[0]),b}getFallbackCodes(g,b){if(!g)return[];if(typeof g=="function"&&(g=g(b)),typeof g=="string"&&(g=[g]),Array.isArray(g))return g;if(!b)return g.default||[];let et=g[b];return et||(et=g[this.getScriptPartFromCode(b)]),et||(et=g[this.formatLanguageCode(b)]),et||(et=g[this.getLanguagePartFromCode(b)]),et||(et=g.default),et||[]}toResolveHierarchy(g,b){const et=this.getFallbackCodes(b||this.options.fallbackLng||[],g),st=[],at=vt=>{vt&&(this.isSupportedCode(vt)?st.push(vt):this.logger.warn(`rejecting language code not found in supportedLngs: ${vt}`))};return typeof g=="string"&&(g.indexOf("-")>-1||g.indexOf("_")>-1)?(this.options.load!=="languageOnly"&&at(this.formatLanguageCode(g)),this.options.load!=="languageOnly"&&this.options.load!=="currentOnly"&&at(this.getScriptPartFromCode(g)),this.options.load!=="currentOnly"&&at(this.getLanguagePartFromCode(g))):typeof g=="string"&&at(this.formatLanguageCode(g)),et.forEach(vt=>{st.indexOf(vt)<0&&at(this.formatLanguageCode(vt))}),st}}let sets=[{lngs:["ach","ak","am","arn","br","fil","gun","ln","mfe","mg","mi","oc","pt","pt-BR","tg","tl","ti","tr","uz","wa"],nr:[1,2],fc:1},{lngs:["af","an","ast","az","bg","bn","ca","da","de","dev","el","en","eo","es","et","eu","fi","fo","fur","fy","gl","gu","ha","hi","hu","hy","ia","it","kk","kn","ku","lb","mai","ml","mn","mr","nah","nap","nb","ne","nl","nn","no","nso","pa","pap","pms","ps","pt-PT","rm","sco","se","si","so","son","sq","sv","sw","ta","te","tk","ur","yo"],nr:[1,2],fc:2},{lngs:["ay","bo","cgg","fa","ht","id","ja","jbo","ka","km","ko","ky","lo","ms","sah","su","th","tt","ug","vi","wo","zh"],nr:[1],fc:3},{lngs:["be","bs","cnr","dz","hr","ru","sr","uk"],nr:[1,2,5],fc:4},{lngs:["ar"],nr:[0,1,2,3,11,100],fc:5},{lngs:["cs","sk"],nr:[1,2,5],fc:6},{lngs:["csb","pl"],nr:[1,2,5],fc:7},{lngs:["cy"],nr:[1,2,3,8],fc:8},{lngs:["fr"],nr:[1,2],fc:9},{lngs:["ga"],nr:[1,2,3,7,11],fc:10},{lngs:["gd"],nr:[1,2,3,20],fc:11},{lngs:["is"],nr:[1,2],fc:12},{lngs:["jv"],nr:[0,1],fc:13},{lngs:["kw"],nr:[1,2,3,4],fc:14},{lngs:["lt"],nr:[1,2,10],fc:15},{lngs:["lv"],nr:[1,2,0],fc:16},{lngs:["mk"],nr:[1,2],fc:17},{lngs:["mnk"],nr:[0,1,2],fc:18},{lngs:["mt"],nr:[1,2,11,20],fc:19},{lngs:["or"],nr:[2,1],fc:2},{lngs:["ro"],nr:[1,2,20],fc:20},{lngs:["sl"],nr:[5,1,2,3],fc:21},{lngs:["he","iw"],nr:[1,2,20,21],fc:22}],_rulesPluralsTypes={1:function(d){return+(d>1)},2:function(d){return+(d!=1)},3:function(d){return 0},4:function(d){return d%10==1&&d%100!=11?0:d%10>=2&&d%10<=4&&(d%100<10||d%100>=20)?1:2},5:function(d){return d==0?0:d==1?1:d==2?2:d%100>=3&&d%100<=10?3:d%100>=11?4:5},6:function(d){return d==1?0:d>=2&&d<=4?1:2},7:function(d){return d==1?0:d%10>=2&&d%10<=4&&(d%100<10||d%100>=20)?1:2},8:function(d){return d==1?0:d==2?1:d!=8&&d!=11?2:3},9:function(d){return+(d>=2)},10:function(d){return d==1?0:d==2?1:d<7?2:d<11?3:4},11:function(d){return d==1||d==11?0:d==2||d==12?1:d>2&&d<20?2:3},12:function(d){return+(d%10!=1||d%100==11)},13:function(d){return+(d!==0)},14:function(d){return d==1?0:d==2?1:d==3?2:3},15:function(d){return d%10==1&&d%100!=11?0:d%10>=2&&(d%100<10||d%100>=20)?1:2},16:function(d){return d%10==1&&d%100!=11?0:d!==0?1:2},17:function(d){return d==1||d%10==1&&d%100!=11?0:1},18:function(d){return d==0?0:d==1?1:2},19:function(d){return d==1?0:d==0||d%100>1&&d%100<11?1:d%100>10&&d%100<20?2:3},20:function(d){return d==1?0:d==0||d%100>0&&d%100<20?1:2},21:function(d){return d%100==1?1:d%100==2?2:d%100==3||d%100==4?3:0},22:function(d){return d==1?0:d==2?1:(d<0||d>10)&&d%10==0?2:3}};const nonIntlVersions=["v1","v2","v3"],intlVersions=["v4"],suffixesOrder={zero:0,one:1,two:2,few:3,many:4,other:5};function createRules(){const d={};return sets.forEach(g=>{g.lngs.forEach(b=>{d[b]={numbers:g.nr,plurals:_rulesPluralsTypes[g.fc]}})}),d}class PluralResolver{constructor(g){let b=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};this.languageUtils=g,this.options=b,this.logger=baseLogger.create("pluralResolver"),(!this.options.compatibilityJSON||intlVersions.includes(this.options.compatibilityJSON))&&(typeof Intl>"u"||!Intl.PluralRules)&&(this.options.compatibilityJSON="v3",this.logger.error("Your environment seems not to be Intl API compatible, use an Intl.PluralRules polyfill. Will fallback to the compatibilityJSON v3 format handling.")),this.rules=createRules()}addRule(g,b){this.rules[g]=b}getRule(g){let b=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(this.shouldUseIntlApi())try{return new Intl.PluralRules(getCleanedCode(g==="dev"?"en":g),{type:b.ordinal?"ordinal":"cardinal"})}catch{return}return this.rules[g]||this.rules[this.languageUtils.getLanguagePartFromCode(g)]}needsPlural(g){let b=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const et=this.getRule(g,b);return this.shouldUseIntlApi()?et&&et.resolvedOptions().pluralCategories.length>1:et&&et.numbers.length>1}getPluralFormsOfKey(g,b){let et=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return this.getSuffixes(g,et).map(st=>`${b}${st}`)}getSuffixes(g){let b=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const et=this.getRule(g,b);return et?this.shouldUseIntlApi()?et.resolvedOptions().pluralCategories.sort((st,at)=>suffixesOrder[st]-suffixesOrder[at]).map(st=>`${this.options.prepend}${b.ordinal?`ordinal${this.options.prepend}`:""}${st}`):et.numbers.map(st=>this.getSuffix(g,st,b)):[]}getSuffix(g,b){let et=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};const st=this.getRule(g,et);return st?this.shouldUseIntlApi()?`${this.options.prepend}${et.ordinal?`ordinal${this.options.prepend}`:""}${st.select(b)}`:this.getSuffixRetroCompatible(st,b):(this.logger.warn(`no plural rule found for: ${g}`),"")}getSuffixRetroCompatible(g,b){const et=g.noAbs?g.plurals(b):g.plurals(Math.abs(b));let st=g.numbers[et];this.options.simplifyPluralSuffix&&g.numbers.length===2&&g.numbers[0]===1&&(st===2?st="plural":st===1&&(st=""));const at=()=>this.options.prepend&&st.toString()?this.options.prepend+st.toString():st.toString();return this.options.compatibilityJSON==="v1"?st===1?"":typeof st=="number"?`_plural_${st.toString()}`:at():this.options.compatibilityJSON==="v2"||this.options.simplifyPluralSuffix&&g.numbers.length===2&&g.numbers[0]===1?at():this.options.prepend&&et.toString()?this.options.prepend+et.toString():et.toString()}shouldUseIntlApi(){return!nonIntlVersions.includes(this.options.compatibilityJSON)}}function deepFindWithDefaults(d,g,b){let et=arguments.length>3&&arguments[3]!==void 0?arguments[3]:".",st=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!0,at=getPathWithDefaults(d,g,b);return!at&&st&&typeof b=="string"&&(at=deepFind(d,b,et),at===void 0&&(at=deepFind(g,b,et))),at}class Interpolator{constructor(){let g=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this.logger=baseLogger.create("interpolator"),this.options=g,this.format=g.interpolation&&g.interpolation.format||(b=>b),this.init(g)}init(){let g=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};g.interpolation||(g.interpolation={escapeValue:!0});const{escape:b,escapeValue:et,useRawValueToEscape:st,prefix:at,prefixEscaped:vt,suffix:Tt,suffixEscaped:Ct,formatSeparator:pt,unescapeSuffix:wt,unescapePrefix:$t,nestingPrefix:Lt,nestingPrefixEscaped:jt,nestingSuffix:Ft,nestingSuffixEscaped:Gt,nestingOptionsSeparator:Ht,maxReplaces:qt,alwaysFormat:Kt}=g.interpolation;this.escape=b!==void 0?b:escape,this.escapeValue=et!==void 0?et:!0,this.useRawValueToEscape=st!==void 0?st:!1,this.prefix=at?regexEscape(at):vt||"{{",this.suffix=Tt?regexEscape(Tt):Ct||"}}",this.formatSeparator=pt||",",this.unescapePrefix=wt?"":$t||"-",this.unescapeSuffix=this.unescapePrefix?"":wt||"",this.nestingPrefix=Lt?regexEscape(Lt):jt||regexEscape("$t("),this.nestingSuffix=Ft?regexEscape(Ft):Gt||regexEscape(")"),this.nestingOptionsSeparator=Ht||",",this.maxReplaces=qt||1e3,this.alwaysFormat=Kt!==void 0?Kt:!1,this.resetRegExp()}reset(){this.options&&this.init(this.options)}resetRegExp(){const g=(b,et)=>b&&b.source===et?(b.lastIndex=0,b):new RegExp(et,"g");this.regexp=g(this.regexp,`${this.prefix}(.+?)${this.suffix}`),this.regexpUnescape=g(this.regexpUnescape,`${this.prefix}${this.unescapePrefix}(.+?)${this.unescapeSuffix}${this.suffix}`),this.nestingRegexp=g(this.nestingRegexp,`${this.nestingPrefix}(.+?)${this.nestingSuffix}`)}interpolate(g,b,et,st){let at,vt,Tt;const Ct=this.options&&this.options.interpolation&&this.options.interpolation.defaultVariables||{};function pt(Ft){return Ft.replace(/\$/g,"$$$$")}const wt=Ft=>{if(Ft.indexOf(this.formatSeparator)<0){const Kt=deepFindWithDefaults(b,Ct,Ft,this.options.keySeparator,this.options.ignoreJSONStructure);return this.alwaysFormat?this.format(Kt,void 0,et,{...st,...b,interpolationkey:Ft}):Kt}const Gt=Ft.split(this.formatSeparator),Ht=Gt.shift().trim(),qt=Gt.join(this.formatSeparator).trim();return this.format(deepFindWithDefaults(b,Ct,Ht,this.options.keySeparator,this.options.ignoreJSONStructure),qt,et,{...st,...b,interpolationkey:Ht})};this.resetRegExp();const $t=st&&st.missingInterpolationHandler||this.options.missingInterpolationHandler,Lt=st&&st.interpolation&&st.interpolation.skipOnVariables!==void 0?st.interpolation.skipOnVariables:this.options.interpolation.skipOnVariables;return[{regex:this.regexpUnescape,safeValue:Ft=>pt(Ft)},{regex:this.regexp,safeValue:Ft=>this.escapeValue?pt(this.escape(Ft)):pt(Ft)}].forEach(Ft=>{for(Tt=0;at=Ft.regex.exec(g);){const Gt=at[1].trim();if(vt=wt(Gt),vt===void 0)if(typeof $t=="function"){const qt=$t(g,at,st);vt=typeof qt=="string"?qt:""}else if(st&&Object.prototype.hasOwnProperty.call(st,Gt))vt="";else if(Lt){vt=at[0];continue}else this.logger.warn(`missed to pass in variable ${Gt} for interpolating ${g}`),vt="";else typeof vt!="string"&&!this.useRawValueToEscape&&(vt=makeString(vt));const Ht=Ft.safeValue(vt);if(g=g.replace(at[0],Ht),Lt?(Ft.regex.lastIndex+=vt.length,Ft.regex.lastIndex-=at[0].length):Ft.regex.lastIndex=0,Tt++,Tt>=this.maxReplaces)break}}),g}nest(g,b){let et=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},st,at,vt;function Tt(Ct,pt){const wt=this.nestingOptionsSeparator;if(Ct.indexOf(wt)<0)return Ct;const $t=Ct.split(new RegExp(`${wt}[ ]*{`));let Lt=`{${$t[1]}`;Ct=$t[0],Lt=this.interpolate(Lt,vt);const jt=Lt.match(/'/g),Ft=Lt.match(/"/g);(jt&&jt.length%2===0&&!Ft||Ft.length%2!==0)&&(Lt=Lt.replace(/'/g,'"'));try{vt=JSON.parse(Lt),pt&&(vt={...pt,...vt})}catch(Gt){return this.logger.warn(`failed parsing options string in nesting for key ${Ct}`,Gt),`${Ct}${wt}${Lt}`}return vt.defaultValue&&vt.defaultValue.indexOf(this.prefix)>-1&&delete vt.defaultValue,Ct}for(;st=this.nestingRegexp.exec(g);){let Ct=[];vt={...et},vt=vt.replace&&typeof vt.replace!="string"?vt.replace:vt,vt.applyPostProcessor=!1,delete vt.defaultValue;let pt=!1;if(st[0].indexOf(this.formatSeparator)!==-1&&!/{.*}/.test(st[1])){const wt=st[1].split(this.formatSeparator).map($t=>$t.trim());st[1]=wt.shift(),Ct=wt,pt=!0}if(at=b(Tt.call(this,st[1].trim(),vt),vt),at&&st[0]===g&&typeof at!="string")return at;typeof at!="string"&&(at=makeString(at)),at||(this.logger.warn(`missed to resolve ${st[1]} for nesting ${g}`),at=""),pt&&(at=Ct.reduce((wt,$t)=>this.format(wt,$t,et.lng,{...et,interpolationkey:st[1].trim()}),at.trim())),g=g.replace(st[0],at),this.regexp.lastIndex=0}return g}}function parseFormatStr(d){let g=d.toLowerCase().trim();const b={};if(d.indexOf("(")>-1){const et=d.split("(");g=et[0].toLowerCase().trim();const st=et[1].substring(0,et[1].length-1);g==="currency"&&st.indexOf(":")<0?b.currency||(b.currency=st.trim()):g==="relativetime"&&st.indexOf(":")<0?b.range||(b.range=st.trim()):st.split(";").forEach(vt=>{if(vt){const[Tt,...Ct]=vt.split(":"),pt=Ct.join(":").trim().replace(/^'+|'+$/g,""),wt=Tt.trim();b[wt]||(b[wt]=pt),pt==="false"&&(b[wt]=!1),pt==="true"&&(b[wt]=!0),isNaN(pt)||(b[wt]=parseInt(pt,10))}})}return{formatName:g,formatOptions:b}}function createCachedFormatter(d){const g={};return function(et,st,at){const vt=st+JSON.stringify(at);let Tt=g[vt];return Tt||(Tt=d(getCleanedCode(st),at),g[vt]=Tt),Tt(et)}}class Formatter{constructor(){let g=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this.logger=baseLogger.create("formatter"),this.options=g,this.formats={number:createCachedFormatter((b,et)=>{const st=new Intl.NumberFormat(b,{...et});return at=>st.format(at)}),currency:createCachedFormatter((b,et)=>{const st=new Intl.NumberFormat(b,{...et,style:"currency"});return at=>st.format(at)}),datetime:createCachedFormatter((b,et)=>{const st=new Intl.DateTimeFormat(b,{...et});return at=>st.format(at)}),relativetime:createCachedFormatter((b,et)=>{const st=new Intl.RelativeTimeFormat(b,{...et});return at=>st.format(at,et.range||"day")}),list:createCachedFormatter((b,et)=>{const st=new Intl.ListFormat(b,{...et});return at=>st.format(at)})},this.init(g)}init(g){const et=(arguments.length>1&&arguments[1]!==void 0?arguments[1]:{interpolation:{}}).interpolation;this.formatSeparator=et.formatSeparator?et.formatSeparator:et.formatSeparator||","}add(g,b){this.formats[g.toLowerCase().trim()]=b}addCached(g,b){this.formats[g.toLowerCase().trim()]=createCachedFormatter(b)}format(g,b,et){let st=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{};return b.split(this.formatSeparator).reduce((Tt,Ct)=>{const{formatName:pt,formatOptions:wt}=parseFormatStr(Ct);if(this.formats[pt]){let $t=Tt;try{const Lt=st&&st.formatParams&&st.formatParams[st.interpolationkey]||{},jt=Lt.locale||Lt.lng||st.locale||st.lng||et;$t=this.formats[pt](Tt,jt,{...wt,...st,...Lt})}catch(Lt){this.logger.warn(Lt)}return $t}else this.logger.warn(`there was no format function for ${pt}`);return Tt},g)}}function removePending(d,g){d.pending[g]!==void 0&&(delete d.pending[g],d.pendingCount--)}class Connector extends EventEmitter{constructor(g,b,et){let st=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{};super(),this.backend=g,this.store=b,this.services=et,this.languageUtils=et.languageUtils,this.options=st,this.logger=baseLogger.create("backendConnector"),this.waitingReads=[],this.maxParallelReads=st.maxParallelReads||10,this.readingCalls=0,this.maxRetries=st.maxRetries>=0?st.maxRetries:5,this.retryTimeout=st.retryTimeout>=1?st.retryTimeout:350,this.state={},this.queue=[],this.backend&&this.backend.init&&this.backend.init(et,st.backend,st)}queueLoad(g,b,et,st){const at={},vt={},Tt={},Ct={};return g.forEach(pt=>{let wt=!0;b.forEach($t=>{const Lt=`${pt}|${$t}`;!et.reload&&this.store.hasResourceBundle(pt,$t)?this.state[Lt]=2:this.state[Lt]<0||(this.state[Lt]===1?vt[Lt]===void 0&&(vt[Lt]=!0):(this.state[Lt]=1,wt=!1,vt[Lt]===void 0&&(vt[Lt]=!0),at[Lt]===void 0&&(at[Lt]=!0),Ct[$t]===void 0&&(Ct[$t]=!0)))}),wt||(Tt[pt]=!0)}),(Object.keys(at).length||Object.keys(vt).length)&&this.queue.push({pending:vt,pendingCount:Object.keys(vt).length,loaded:{},errors:[],callback:st}),{toLoad:Object.keys(at),pending:Object.keys(vt),toLoadLanguages:Object.keys(Tt),toLoadNamespaces:Object.keys(Ct)}}loaded(g,b,et){const st=g.split("|"),at=st[0],vt=st[1];b&&this.emit("failedLoading",at,vt,b),et&&this.store.addResourceBundle(at,vt,et,void 0,void 0,{skipCopy:!0}),this.state[g]=b?-1:2;const Tt={};this.queue.forEach(Ct=>{pushPath(Ct.loaded,[at],vt),removePending(Ct,g),b&&Ct.errors.push(b),Ct.pendingCount===0&&!Ct.done&&(Object.keys(Ct.loaded).forEach(pt=>{Tt[pt]||(Tt[pt]={});const wt=Ct.loaded[pt];wt.length&&wt.forEach($t=>{Tt[pt][$t]===void 0&&(Tt[pt][$t]=!0)})}),Ct.done=!0,Ct.errors.length?Ct.callback(Ct.errors):Ct.callback())}),this.emit("loaded",Tt),this.queue=this.queue.filter(Ct=>!Ct.done)}read(g,b,et){let st=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0,at=arguments.length>4&&arguments[4]!==void 0?arguments[4]:this.retryTimeout,vt=arguments.length>5?arguments[5]:void 0;if(!g.length)return vt(null,{});if(this.readingCalls>=this.maxParallelReads){this.waitingReads.push({lng:g,ns:b,fcName:et,tried:st,wait:at,callback:vt});return}this.readingCalls++;const Tt=(pt,wt)=>{if(this.readingCalls--,this.waitingReads.length>0){const $t=this.waitingReads.shift();this.read($t.lng,$t.ns,$t.fcName,$t.tried,$t.wait,$t.callback)}if(pt&&wt&&st<this.maxRetries){setTimeout(()=>{this.read.call(this,g,b,et,st+1,at*2,vt)},at);return}vt(pt,wt)},Ct=this.backend[et].bind(this.backend);if(Ct.length===2){try{const pt=Ct(g,b);pt&&typeof pt.then=="function"?pt.then(wt=>Tt(null,wt)).catch(Tt):Tt(null,pt)}catch(pt){Tt(pt)}return}return Ct(g,b,Tt)}prepareLoading(g,b){let et=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},st=arguments.length>3?arguments[3]:void 0;if(!this.backend)return this.logger.warn("No backend was added via i18next.use. Will not load resources."),st&&st();typeof g=="string"&&(g=this.languageUtils.toResolveHierarchy(g)),typeof b=="string"&&(b=[b]);const at=this.queueLoad(g,b,et,st);if(!at.toLoad.length)return at.pending.length||st(),null;at.toLoad.forEach(vt=>{this.loadOne(vt)})}load(g,b,et){this.prepareLoading(g,b,{},et)}reload(g,b,et){this.prepareLoading(g,b,{reload:!0},et)}loadOne(g){let b=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"";const et=g.split("|"),st=et[0],at=et[1];this.read(st,at,"read",void 0,void 0,(vt,Tt)=>{vt&&this.logger.warn(`${b}loading namespace ${at} for language ${st} failed`,vt),!vt&&Tt&&this.logger.log(`${b}loaded namespace ${at} for language ${st}`,Tt),this.loaded(g,vt,Tt)})}saveMissing(g,b,et,st,at){let vt=arguments.length>5&&arguments[5]!==void 0?arguments[5]:{},Tt=arguments.length>6&&arguments[6]!==void 0?arguments[6]:()=>{};if(this.services.utils&&this.services.utils.hasLoadedNamespace&&!this.services.utils.hasLoadedNamespace(b)){this.logger.warn(`did not save key "${et}" as the namespace "${b}" was not yet loaded`,"This means something IS WRONG in your setup. You access the t function before i18next.init / i18next.loadNamespace / i18next.changeLanguage was done. Wait for the callback or Promise to resolve before accessing it!!!");return}if(!(et==null||et==="")){if(this.backend&&this.backend.create){const Ct={...vt,isUpdate:at},pt=this.backend.create.bind(this.backend);if(pt.length<6)try{let wt;pt.length===5?wt=pt(g,b,et,st,Ct):wt=pt(g,b,et,st),wt&&typeof wt.then=="function"?wt.then($t=>Tt(null,$t)).catch(Tt):Tt(null,wt)}catch(wt){Tt(wt)}else pt(g,b,et,st,Tt,Ct)}!g||!g[0]||this.store.addResource(g[0],b,et,st)}}}function get(){return{debug:!1,initImmediate:!0,ns:["translation"],defaultNS:["translation"],fallbackLng:["dev"],fallbackNS:!1,supportedLngs:!1,nonExplicitSupportedLngs:!1,load:"all",preload:!1,simplifyPluralSuffix:!0,keySeparator:".",nsSeparator:":",pluralSeparator:"_",contextSeparator:"_",partialBundledLanguages:!1,saveMissing:!1,updateMissing:!1,saveMissingTo:"fallback",saveMissingPlurals:!0,missingKeyHandler:!1,missingInterpolationHandler:!1,postProcess:!1,postProcessPassResolved:!1,returnNull:!1,returnEmptyString:!0,returnObjects:!1,joinArrays:!1,returnedObjectHandler:!1,parseMissingKeyHandler:!1,appendNamespaceToMissingKey:!1,appendNamespaceToCIMode:!1,overloadTranslationOptionHandler:function(g){let b={};if(typeof g[1]=="object"&&(b=g[1]),typeof g[1]=="string"&&(b.defaultValue=g[1]),typeof g[2]=="string"&&(b.tDescription=g[2]),typeof g[2]=="object"||typeof g[3]=="object"){const et=g[3]||g[2];Object.keys(et).forEach(st=>{b[st]=et[st]})}return b},interpolation:{escapeValue:!0,format:d=>d,prefix:"{{",suffix:"}}",formatSeparator:",",unescapePrefix:"-",nestingPrefix:"$t(",nestingSuffix:")",nestingOptionsSeparator:",",maxReplaces:1e3,skipOnVariables:!0}}}function transformOptions(d){return typeof d.ns=="string"&&(d.ns=[d.ns]),typeof d.fallbackLng=="string"&&(d.fallbackLng=[d.fallbackLng]),typeof d.fallbackNS=="string"&&(d.fallbackNS=[d.fallbackNS]),d.supportedLngs&&d.supportedLngs.indexOf("cimode")<0&&(d.supportedLngs=d.supportedLngs.concat(["cimode"])),d}function noop(){}function bindMemberFunctions(d){Object.getOwnPropertyNames(Object.getPrototypeOf(d)).forEach(b=>{typeof d[b]=="function"&&(d[b]=d[b].bind(d))})}class I18n extends EventEmitter{constructor(){let g=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},b=arguments.length>1?arguments[1]:void 0;if(super(),this.options=transformOptions(g),this.services={},this.logger=baseLogger,this.modules={external:[]},bindMemberFunctions(this),b&&!this.isInitialized&&!g.isClone){if(!this.options.initImmediate)return this.init(g,b),this;setTimeout(()=>{this.init(g,b)},0)}}init(){var g=this;let b=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},et=arguments.length>1?arguments[1]:void 0;this.isInitializing=!0,typeof b=="function"&&(et=b,b={}),!b.defaultNS&&b.defaultNS!==!1&&b.ns&&(typeof b.ns=="string"?b.defaultNS=b.ns:b.ns.indexOf("translation")<0&&(b.defaultNS=b.ns[0]));const st=get();this.options={...st,...this.options,...transformOptions(b)},this.options.compatibilityAPI!=="v1"&&(this.options.interpolation={...st.interpolation,...this.options.interpolation}),b.keySeparator!==void 0&&(this.options.userDefinedKeySeparator=b.keySeparator),b.nsSeparator!==void 0&&(this.options.userDefinedNsSeparator=b.nsSeparator);function at(wt){return wt?typeof wt=="function"?new wt:wt:null}if(!this.options.isClone){this.modules.logger?baseLogger.init(at(this.modules.logger),this.options):baseLogger.init(null,this.options);let wt;this.modules.formatter?wt=this.modules.formatter:typeof Intl<"u"&&(wt=Formatter);const $t=new LanguageUtil(this.options);this.store=new ResourceStore(this.options.resources,this.options);const Lt=this.services;Lt.logger=baseLogger,Lt.resourceStore=this.store,Lt.languageUtils=$t,Lt.pluralResolver=new PluralResolver($t,{prepend:this.options.pluralSeparator,compatibilityJSON:this.options.compatibilityJSON,simplifyPluralSuffix:this.options.simplifyPluralSuffix}),wt&&(!this.options.interpolation.format||this.options.interpolation.format===st.interpolation.format)&&(Lt.formatter=at(wt),Lt.formatter.init(Lt,this.options),this.options.interpolation.format=Lt.formatter.format.bind(Lt.formatter)),Lt.interpolator=new Interpolator(this.options),Lt.utils={hasLoadedNamespace:this.hasLoadedNamespace.bind(this)},Lt.backendConnector=new Connector(at(this.modules.backend),Lt.resourceStore,Lt,this.options),Lt.backendConnector.on("*",function(jt){for(var Ft=arguments.length,Gt=new Array(Ft>1?Ft-1:0),Ht=1;Ht<Ft;Ht++)Gt[Ht-1]=arguments[Ht];g.emit(jt,...Gt)}),this.modules.languageDetector&&(Lt.languageDetector=at(this.modules.languageDetector),Lt.languageDetector.init&&Lt.languageDetector.init(Lt,this.options.detection,this.options)),this.modules.i18nFormat&&(Lt.i18nFormat=at(this.modules.i18nFormat),Lt.i18nFormat.init&&Lt.i18nFormat.init(this)),this.translator=new Translator(this.services,this.options),this.translator.on("*",function(jt){for(var Ft=arguments.length,Gt=new Array(Ft>1?Ft-1:0),Ht=1;Ht<Ft;Ht++)Gt[Ht-1]=arguments[Ht];g.emit(jt,...Gt)}),this.modules.external.forEach(jt=>{jt.init&&jt.init(this)})}if(this.format=this.options.interpolation.format,et||(et=noop),this.options.fallbackLng&&!this.services.languageDetector&&!this.options.lng){const wt=this.services.languageUtils.getFallbackCodes(this.options.fallbackLng);wt.length>0&&wt[0]!=="dev"&&(this.options.lng=wt[0])}!this.services.languageDetector&&!this.options.lng&&this.logger.warn("init: no languageDetector is used and no lng is defined"),["getResource","hasResourceBundle","getResourceBundle","getDataByLanguage"].forEach(wt=>{this[wt]=function(){return g.store[wt](...arguments)}}),["addResource","addResources","addResourceBundle","removeResourceBundle"].forEach(wt=>{this[wt]=function(){return g.store[wt](...arguments),g}});const Ct=defer(),pt=()=>{const wt=($t,Lt)=>{this.isInitializing=!1,this.isInitialized&&!this.initializedStoreOnce&&this.logger.warn("init: i18next is already initialized. You should call init just once!"),this.isInitialized=!0,this.options.isClone||this.logger.log("initialized",this.options),this.emit("initialized",this.options),Ct.resolve(Lt),et($t,Lt)};if(this.languages&&this.options.compatibilityAPI!=="v1"&&!this.isInitialized)return wt(null,this.t.bind(this));this.changeLanguage(this.options.lng,wt)};return this.options.resources||!this.options.initImmediate?pt():setTimeout(pt,0),Ct}loadResources(g){let et=arguments.length>1&&arguments[1]!==void 0?arguments[1]:noop;const st=typeof g=="string"?g:this.language;if(typeof g=="function"&&(et=g),!this.options.resources||this.options.partialBundledLanguages){if(st&&st.toLowerCase()==="cimode"&&(!this.options.preload||this.options.preload.length===0))return et();const at=[],vt=Tt=>{if(!Tt||Tt==="cimode")return;this.services.languageUtils.toResolveHierarchy(Tt).forEach(pt=>{pt!=="cimode"&&at.indexOf(pt)<0&&at.push(pt)})};st?vt(st):this.services.languageUtils.getFallbackCodes(this.options.fallbackLng).forEach(Ct=>vt(Ct)),this.options.preload&&this.options.preload.forEach(Tt=>vt(Tt)),this.services.backendConnector.load(at,this.options.ns,Tt=>{!Tt&&!this.resolvedLanguage&&this.language&&this.setResolvedLanguage(this.language),et(Tt)})}else et(null)}reloadResources(g,b,et){const st=defer();return g||(g=this.languages),b||(b=this.options.ns),et||(et=noop),this.services.backendConnector.reload(g,b,at=>{st.resolve(),et(at)}),st}use(g){if(!g)throw new Error("You are passing an undefined module! Please check the object you are passing to i18next.use()");if(!g.type)throw new Error("You are passing a wrong module! Please check the object you are passing to i18next.use()");return g.type==="backend"&&(this.modules.backend=g),(g.type==="logger"||g.log&&g.warn&&g.error)&&(this.modules.logger=g),g.type==="languageDetector"&&(this.modules.languageDetector=g),g.type==="i18nFormat"&&(this.modules.i18nFormat=g),g.type==="postProcessor"&&postProcessor.addPostProcessor(g),g.type==="formatter"&&(this.modules.formatter=g),g.type==="3rdParty"&&this.modules.external.push(g),this}setResolvedLanguage(g){if(!(!g||!this.languages)&&!(["cimode","dev"].indexOf(g)>-1))for(let b=0;b<this.languages.length;b++){const et=this.languages[b];if(!(["cimode","dev"].indexOf(et)>-1)&&this.store.hasLanguageSomeTranslations(et)){this.resolvedLanguage=et;break}}}changeLanguage(g,b){var et=this;this.isLanguageChangingTo=g;const st=defer();this.emit("languageChanging",g);const at=Ct=>{this.language=Ct,this.languages=this.services.languageUtils.toResolveHierarchy(Ct),this.resolvedLanguage=void 0,this.setResolvedLanguage(Ct)},vt=(Ct,pt)=>{pt?(at(pt),this.translator.changeLanguage(pt),this.isLanguageChangingTo=void 0,this.emit("languageChanged",pt),this.logger.log("languageChanged",pt)):this.isLanguageChangingTo=void 0,st.resolve(function(){return et.t(...arguments)}),b&&b(Ct,function(){return et.t(...arguments)})},Tt=Ct=>{!g&&!Ct&&this.services.languageDetector&&(Ct=[]);const pt=typeof Ct=="string"?Ct:this.services.languageUtils.getBestMatchFromCodes(Ct);pt&&(this.language||at(pt),this.translator.language||this.translator.changeLanguage(pt),this.services.languageDetector&&this.services.languageDetector.cacheUserLanguage&&this.services.languageDetector.cacheUserLanguage(pt)),this.loadResources(pt,wt=>{vt(wt,pt)})};return!g&&this.services.languageDetector&&!this.services.languageDetector.async?Tt(this.services.languageDetector.detect()):!g&&this.services.languageDetector&&this.services.languageDetector.async?this.services.languageDetector.detect.length===0?this.services.languageDetector.detect().then(Tt):this.services.languageDetector.detect(Tt):Tt(g),st}getFixedT(g,b,et){var st=this;const at=function(vt,Tt){let Ct;if(typeof Tt!="object"){for(var pt=arguments.length,wt=new Array(pt>2?pt-2:0),$t=2;$t<pt;$t++)wt[$t-2]=arguments[$t];Ct=st.options.overloadTranslationOptionHandler([vt,Tt].concat(wt))}else Ct={...Tt};Ct.lng=Ct.lng||at.lng,Ct.lngs=Ct.lngs||at.lngs,Ct.ns=Ct.ns||at.ns,Ct.keyPrefix=Ct.keyPrefix||et||at.keyPrefix;const Lt=st.options.keySeparator||".";let jt;return Ct.keyPrefix&&Array.isArray(vt)?jt=vt.map(Ft=>`${Ct.keyPrefix}${Lt}${Ft}`):jt=Ct.keyPrefix?`${Ct.keyPrefix}${Lt}${vt}`:vt,st.t(jt,Ct)};return typeof g=="string"?at.lng=g:at.lngs=g,at.ns=b,at.keyPrefix=et,at}t(){return this.translator&&this.translator.translate(...arguments)}exists(){return this.translator&&this.translator.exists(...arguments)}setDefaultNamespace(g){this.options.defaultNS=g}hasLoadedNamespace(g){let b=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(!this.isInitialized)return this.logger.warn("hasLoadedNamespace: i18next was not initialized",this.languages),!1;if(!this.languages||!this.languages.length)return this.logger.warn("hasLoadedNamespace: i18n.languages were undefined or empty",this.languages),!1;const et=b.lng||this.resolvedLanguage||this.languages[0],st=this.options?this.options.fallbackLng:!1,at=this.languages[this.languages.length-1];if(et.toLowerCase()==="cimode")return!0;const vt=(Tt,Ct)=>{const pt=this.services.backendConnector.state[`${Tt}|${Ct}`];return pt===-1||pt===2};if(b.precheck){const Tt=b.precheck(this,vt);if(Tt!==void 0)return Tt}return!!(this.hasResourceBundle(et,g)||!this.services.backendConnector.backend||this.options.resources&&!this.options.partialBundledLanguages||vt(et,g)&&(!st||vt(at,g)))}loadNamespaces(g,b){const et=defer();return this.options.ns?(typeof g=="string"&&(g=[g]),g.forEach(st=>{this.options.ns.indexOf(st)<0&&this.options.ns.push(st)}),this.loadResources(st=>{et.resolve(),b&&b(st)}),et):(b&&b(),Promise.resolve())}loadLanguages(g,b){const et=defer();typeof g=="string"&&(g=[g]);const st=this.options.preload||[],at=g.filter(vt=>st.indexOf(vt)<0&&this.services.languageUtils.isSupportedCode(vt));return at.length?(this.options.preload=st.concat(at),this.loadResources(vt=>{et.resolve(),b&&b(vt)}),et):(b&&b(),Promise.resolve())}dir(g){if(g||(g=this.resolvedLanguage||(this.languages&&this.languages.length>0?this.languages[0]:this.language)),!g)return"rtl";const b=["ar","shu","sqr","ssh","xaa","yhd","yud","aao","abh","abv","acm","acq","acw","acx","acy","adf","ads","aeb","aec","afb","ajp","apc","apd","arb","arq","ars","ary","arz","auz","avl","ayh","ayl","ayn","ayp","bbz","pga","he","iw","ps","pbt","pbu","pst","prp","prd","ug","ur","ydd","yds","yih","ji","yi","hbo","men","xmn","fa","jpr","peo","pes","prs","dv","sam","ckb"],et=this.services&&this.services.languageUtils||new LanguageUtil(get());return b.indexOf(et.getLanguagePartFromCode(g))>-1||g.toLowerCase().indexOf("-arab")>1?"rtl":"ltr"}static createInstance(){let g=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},b=arguments.length>1?arguments[1]:void 0;return new I18n(g,b)}cloneInstance(){let g=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},b=arguments.length>1&&arguments[1]!==void 0?arguments[1]:noop;const et=g.forkResourceStore;et&&delete g.forkResourceStore;const st={...this.options,...g,isClone:!0},at=new I18n(st);return(g.debug!==void 0||g.prefix!==void 0)&&(at.logger=at.logger.clone(g)),["store","services","language"].forEach(Tt=>{at[Tt]=this[Tt]}),at.services={...this.services},at.services.utils={hasLoadedNamespace:at.hasLoadedNamespace.bind(at)},et&&(at.store=new ResourceStore(this.store.data,st),at.services.resourceStore=at.store),at.translator=new Translator(at.services,st),at.translator.on("*",function(Tt){for(var Ct=arguments.length,pt=new Array(Ct>1?Ct-1:0),wt=1;wt<Ct;wt++)pt[wt-1]=arguments[wt];at.emit(Tt,...pt)}),at.init(st,b),at.translator.options=st,at.translator.backendConnector.services.utils={hasLoadedNamespace:at.hasLoadedNamespace.bind(at)},at}toJSON(){return{options:this.options,store:this.store,language:this.language,languages:this.languages,resolvedLanguage:this.resolvedLanguage}}}const instance=I18n.createInstance();instance.createInstance=I18n.createInstance;instance.createInstance;instance.dir;instance.init;instance.loadResources;instance.reloadResources;instance.use;instance.changeLanguage;instance.getFixedT;instance.t;instance.exists;instance.setDefaultNamespace;instance.hasLoadedNamespace;instance.loadNamespaces;instance.loadLanguages;const{slice,forEach}=[];function defaults(d){return forEach.call(slice.call(arguments,1),g=>{if(g)for(const b in g)d[b]===void 0&&(d[b]=g[b])}),d}const fieldContentRegExp=/^[\u0009\u0020-\u007e\u0080-\u00ff]+$/,serializeCookie=(d,g,b)=>{const et=b||{};et.path=et.path||"/";const st=encodeURIComponent(g);let at=`${d}=${st}`;if(et.maxAge>0){const vt=et.maxAge-0;if(Number.isNaN(vt))throw new Error("maxAge should be a Number");at+=`; Max-Age=${Math.floor(vt)}`}if(et.domain){if(!fieldContentRegExp.test(et.domain))throw new TypeError("option domain is invalid");at+=`; Domain=${et.domain}`}if(et.path){if(!fieldContentRegExp.test(et.path))throw new TypeError("option path is invalid");at+=`; Path=${et.path}`}if(et.expires){if(typeof et.expires.toUTCString!="function")throw new TypeError("option expires is invalid");at+=`; Expires=${et.expires.toUTCString()}`}if(et.httpOnly&&(at+="; HttpOnly"),et.secure&&(at+="; Secure"),et.sameSite)switch(typeof et.sameSite=="string"?et.sameSite.toLowerCase():et.sameSite){case!0:at+="; SameSite=Strict";break;case"lax":at+="; SameSite=Lax";break;case"strict":at+="; SameSite=Strict";break;case"none":at+="; SameSite=None";break;default:throw new TypeError("option sameSite is invalid")}return at},cookie={create(d,g,b,et){let st=arguments.length>4&&arguments[4]!==void 0?arguments[4]:{path:"/",sameSite:"strict"};b&&(st.expires=new Date,st.expires.setTime(st.expires.getTime()+b*60*1e3)),et&&(st.domain=et),document.cookie=serializeCookie(d,encodeURIComponent(g),st)},read(d){const g=`${d}=`,b=document.cookie.split(";");for(let et=0;et<b.length;et++){let st=b[et];for(;st.charAt(0)===" ";)st=st.substring(1,st.length);if(st.indexOf(g)===0)return st.substring(g.length,st.length)}return null},remove(d){this.create(d,"",-1)}};var cookie$1={name:"cookie",lookup(d){let{lookupCookie:g}=d;if(g&&typeof document<"u")return cookie.read(g)||void 0},cacheUserLanguage(d,g){let{lookupCookie:b,cookieMinutes:et,cookieDomain:st,cookieOptions:at}=g;b&&typeof document<"u"&&cookie.create(b,d,et,st,at)}},querystring={name:"querystring",lookup(d){var et;let{lookupQuerystring:g}=d,b;if(typeof window<"u"){let{search:st}=window.location;!window.location.search&&((et=window.location.hash)==null?void 0:et.indexOf("?"))>-1&&(st=window.location.hash.substring(window.location.hash.indexOf("?")));const vt=st.substring(1).split("&");for(let Tt=0;Tt<vt.length;Tt++){const Ct=vt[Tt].indexOf("=");Ct>0&&vt[Tt].substring(0,Ct)===g&&(b=vt[Tt].substring(Ct+1))}}return b}};let hasLocalStorageSupport=null;const localStorageAvailable=()=>{if(hasLocalStorageSupport!==null)return hasLocalStorageSupport;try{hasLocalStorageSupport=window!=="undefined"&&window.localStorage!==null;const d="i18next.translate.boo";window.localStorage.setItem(d,"foo"),window.localStorage.removeItem(d)}catch{hasLocalStorageSupport=!1}return hasLocalStorageSupport};var localStorage$1={name:"localStorage",lookup(d){let{lookupLocalStorage:g}=d;if(g&&localStorageAvailable())return window.localStorage.getItem(g)||void 0},cacheUserLanguage(d,g){let{lookupLocalStorage:b}=g;b&&localStorageAvailable()&&window.localStorage.setItem(b,d)}};let hasSessionStorageSupport=null;const sessionStorageAvailable=()=>{if(hasSessionStorageSupport!==null)return hasSessionStorageSupport;try{hasSessionStorageSupport=window!=="undefined"&&window.sessionStorage!==null;const d="i18next.translate.boo";window.sessionStorage.setItem(d,"foo"),window.sessionStorage.removeItem(d)}catch{hasSessionStorageSupport=!1}return hasSessionStorageSupport};var sessionStorage={name:"sessionStorage",lookup(d){let{lookupSessionStorage:g}=d;if(g&&sessionStorageAvailable())return window.sessionStorage.getItem(g)||void 0},cacheUserLanguage(d,g){let{lookupSessionStorage:b}=g;b&&sessionStorageAvailable()&&window.sessionStorage.setItem(b,d)}},navigator$1={name:"navigator",lookup(d){const g=[];if(typeof navigator<"u"){const{languages:b,userLanguage:et,language:st}=navigator;if(b)for(let at=0;at<b.length;at++)g.push(b[at]);et&&g.push(et),st&&g.push(st)}return g.length>0?g:void 0}},htmlTag={name:"htmlTag",lookup(d){let{htmlTag:g}=d,b;const et=g||(typeof document<"u"?document.documentElement:null);return et&&typeof et.getAttribute=="function"&&(b=et.getAttribute("lang")),b}},path={name:"path",lookup(d){var st;let{lookupFromPathIndex:g}=d;if(typeof window>"u")return;const b=window.location.pathname.match(/\/([a-zA-Z-]*)/g);return Array.isArray(b)?(st=b[typeof g=="number"?g:0])==null?void 0:st.replace("/",""):void 0}},subdomain={name:"subdomain",lookup(d){var st,at;let{lookupFromSubdomainIndex:g}=d;const b=typeof g=="number"?g+1:1,et=typeof window<"u"&&((at=(st=window.location)==null?void 0:st.hostname)==null?void 0:at.match(/^(\w{2,5})\.(([a-z0-9-]{1,63}\.[a-z]{2,6})|localhost)/i));if(et)return et[b]}};function getDefaults(){return{order:["querystring","cookie","localStorage","sessionStorage","navigator","htmlTag"],lookupQuerystring:"lng",lookupCookie:"i18next",lookupLocalStorage:"i18nextLng",lookupSessionStorage:"i18nextLng",caches:["localStorage"],excludeCacheFor:["cimode"],convertDetectedLanguage:d=>d}}let Browser$1=class{constructor(g){let b=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};this.type="languageDetector",this.detectors={},this.init(g,b)}init(g){let b=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},et=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};this.services=g||{languageUtils:{}},this.options=defaults(b,this.options||{},getDefaults()),typeof this.options.convertDetectedLanguage=="string"&&this.options.convertDetectedLanguage.indexOf("15897")>-1&&(this.options.convertDetectedLanguage=st=>st.replace("-","_")),this.options.lookupFromUrlIndex&&(this.options.lookupFromPathIndex=this.options.lookupFromUrlIndex),this.i18nOptions=et,this.addDetector(cookie$1),this.addDetector(querystring),this.addDetector(localStorage$1),this.addDetector(sessionStorage),this.addDetector(navigator$1),this.addDetector(htmlTag),this.addDetector(path),this.addDetector(subdomain)}addDetector(g){return this.detectors[g.name]=g,this}detect(g){g||(g=this.options.order);let b=[];return g.forEach(et=>{if(this.detectors[et]){let st=this.detectors[et].lookup(this.options);st&&typeof st=="string"&&(st=[st]),st&&(b=b.concat(st))}}),b=b.map(et=>this.options.convertDetectedLanguage(et)),this.services.languageUtils.getBestMatchFromCodes?b:b.length>0?b[0]:null}cacheUserLanguage(g,b){b||(b=this.options.caches),b&&(this.options.excludeCacheFor&&this.options.excludeCacheFor.indexOf(g)>-1||b.forEach(et=>{this.detectors[et]&&this.detectors[et].cacheUserLanguage(g,this.options)}))}};Browser$1.type="languageDetector";const translation$1={"Image load":"Click here or drag an image file",Pan:"Pan","Reset Zoom/Pan":"Reset Zoom/Pan","Decrease Brush Size":"Decrease Brush Size","Increase Brush Size":"Increase Brush Size","View Original Image":"View Original Image",Undo:"Undo",Redo:"Redo","Copy Result":"Copy Result","Paste Image":"Paste Image","Trigger Manually Inpainting":"Trigger Manually Inpainting","Toggle Hotkeys Dialog":"Toggle Hotkeys Dialog","Toggle Settings Dialog":"Toggle Settings Dialog","Toggle File Manager":"Toggle File Manager",Broche:"Pincel",Cropper:"Cropper","Adjust Mask":"Adjust Mask",Expand:"Expand",Shrink:"Shrink",Reverse:"Reverse",Clear:"Clear"},enJSON={translation:translation$1},translation={"Image load":"Click aqui o arrastra una imagen",Pan:"Acercar o alejar zoom","Reset Zoom/Pan":"Resetear Zoom/Pan","Decrease Brush Size":"Disminuir pincel","Increase Brush Size":"Incrementar pincel","View Original Image":"Ver imagen original",Undo:"Deshacer",Redo:"Rehacer","Copy Result":"Copiar resultado","Paste Image":"Pegar imagen","Trigger Manually Inpainting":"Activar Inpainting manualmente","Toggle Hotkeys Dialog":"Activar dialogo de instrucciones de teclas","Toggle Settings Dialog":"Acivar dialogo de parametros","Toggle File Manager":"Activar dialogo de gestor de archivos",Broche:"Brocha",Cropper:"Recortar imagen","Adjust Mask":"Ajustar mascara",Expand:"Expandir",Shrink:"Disminuir",Reverse:"Reversar",Clear:"Borrar"},espJSON={translation},resources={en:{...enJSON},es:{...espJSON}};instance.use(Browser$1).use(initReactI18next).init({resources,fallbackLng:"es",interpolation:{escapeValue:!1}});const queryClient=new QueryClient;client.createRoot(document.getElementById("root")).render(jsxRuntimeExports.jsx(React.StrictMode,{children:jsxRuntimeExports.jsx(QueryClientProvider,{client:queryClient,children:jsxRuntimeExports.jsx(z,{defaultTheme:"dark",disableTransitionOnChange:!0,children:jsxRuntimeExports.jsx(TooltipProvider,{children:jsxRuntimeExports.jsx(Home,{})})})})}));
